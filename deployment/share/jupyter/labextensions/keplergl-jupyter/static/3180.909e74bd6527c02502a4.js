/*! For license information please see 3180.909e74bd6527c02502a4.js.LICENSE.txt */
(self.webpackChunkkeplergl_jupyter=self.webpackChunkkeplergl_jupyter||[]).push([[3180,2189,3607],{41972:t=>{t.exports=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t},t.exports.__esModule=!0,t.exports.default=t.exports},79092:t=>{function e(t,e,n,r,i,o,s){try{var a=t[o](s),l=a.value}catch(t){return void n(t)}a.done?e(l):Promise.resolve(l).then(r,i)}t.exports=function(t){return function(){var n=this,r=arguments;return new Promise((function(i,o){var s=t.apply(n,r);function a(t){e(s,i,o,a,l,"next",t)}function l(t){e(s,i,o,a,l,"throw",t)}a(void 0)}))}},t.exports.__esModule=!0,t.exports.default=t.exports},16193:t=>{function e(){return t.exports=e=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},t.exports.__esModule=!0,t.exports.default=t.exports,e.apply(null,arguments)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports},96220:(t,e,n)=>{var r=n(16495);function i(){return t.exports=i="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var i=r(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},t.exports.__esModule=!0,t.exports.default=t.exports,i.apply(null,arguments)}t.exports=i,t.exports.__esModule=!0,t.exports.default=t.exports},18337:t=>{function e(n){return t.exports=e=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},t.exports.__esModule=!0,t.exports.default=t.exports,e(n)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports},56994:(t,e,n)=>{var r=n(67197);t.exports=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&r(t,e)},t.exports.__esModule=!0,t.exports.default=t.exports},65611:(t,e,n)=>{var r=n(85735).default,i=n(41972);t.exports=function(t,e){if(e&&("object"==r(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return i(t)},t.exports.__esModule=!0,t.exports.default=t.exports},67197:t=>{function e(n,r){return t.exports=e=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},t.exports.__esModule=!0,t.exports.default=t.exports,e(n,r)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports},16495:(t,e,n)=>{var r=n(18337);t.exports=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=r(t)););return t},t.exports.__esModule=!0,t.exports.default=t.exports},72189:t=>{t.exports=function(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))},t.exports.__esModule=!0,t.exports.default=t.exports},31874:(t,e,n)=>{"use strict";n.r(e),n.d(e,{AGGREGATION_OPERATION:()=>p,CPUGridLayer:()=>kt,ContourLayer:()=>Ue,GPUGridLayer:()=>Ke,GridLayer:()=>Qe,HeatmapLayer:()=>cn,HexagonLayer:()=>Gt,ScreenGridLayer:()=>Et,_AggregationLayer:()=>K,_BinSorter:()=>dt,_CPUAggregator:()=>Rt,_GPUGridAggregator:()=>k});var r=n(67136),i=n(26820),o=n(38404),s=n(77325),a=n(8282),l=n(27968),u=n(76694),c=n(65079),h=n(98589),d=n(49605),f=n(79464);const p={SUM:1,MEAN:2,MIN:3,MAX:4};function g(t,e){return t+e}function y(t,e){return e>t?e:t}function m(t,e){return e<t?e:t}function v(t,e,n){const r=p[t]||p.SUM;switch(e=function(t,e={}){return Number.isFinite(t)?t:n=>(e.index=n.index,t(n.source,e))}(e,n),r){case p.MIN:return t=>function(t,e){if(Number.isFinite(e))return t.length?e:null;const n=t.map(e).filter(Number.isFinite);return n.length?n.reduce(m,1/0):null}(t,e);case p.SUM:return t=>function(t,e){if(Number.isFinite(e))return t.length?t.length*e:null;const n=t.map(e).filter(Number.isFinite);return n.length?n.reduce(g,0):null}(t,e);case p.MEAN:return t=>function(t,e){if(Number.isFinite(e))return t.length?e:null;const n=t.map(e).filter(Number.isFinite);return n.length?n.reduce(g,0)/n.length:null}(t,e);case p.MAX:return t=>function(t,e){if(Number.isFinite(e))return t.length?e:null;const n=t.map(e).filter(Number.isFinite);return n.length?n.reduce(y,-1/0):null}(t,e);default:return null}}function b(t,e={}){return n=>(e.indices=n.map((t=>t.index)),t(n.map((t=>t.source)),e))}const _={projectPoints:!1,viewport:null,createBufferObjects:!0,moduleSettings:{}},A=3402823466e29,x=[32775,32774],w=[32776,32774],C=[32776,32775],S={[p.SUM]:32774,[p.MEAN]:32774,[p.MIN]:x,[p.MAX]:w},E={size:1,operation:p.SUM,needMin:!1,needMax:!1,combineMaxMin:!1};var M=n(26107),P=n(80606);const T={10240:9728,10241:9728};function O(t,e={}){const{width:n=1,height:r=1,data:i=null,unpackFlipY:o=!0,parameters:s=T}=e;return new M.A(t,{data:i,format:(0,a.C6)(t)?34836:6408,type:5126,border:0,mipmaps:!1,parameters:s,dataFormat:6408,width:n,height:r,unpackFlipY:o})}function I(t,e){const{id:n,width:r=1,height:i=1,texture:o}=e;return new P.A(t,{id:n,width:r,height:i,attachments:{36064:o}})}const R=["aggregationBuffer","maxMinBuffer","minBuffer","maxBuffer"],B={maxData:"maxBuffer",minData:"minBuffer",maxMinData:"maxMinBuffer"},L=[o.G.WEBGL2,o.G.COLOR_ATTACHMENT_RGBA32F,o.G.BLEND_EQUATION_MINMAX,o.G.FLOAT_BLEND,o.G.TEXTURE_FLOAT];class k{static getAggregationData({aggregationData:t,maxData:e,minData:n,maxMinData:r,pixelIndex:i}){const o=4*i,s={};return t&&(s.cellCount=t[o+3],s.cellWeight=t[o]),r?(s.maxCellWieght=r[0],s.minCellWeight=r[3]):(e&&(s.maxCellWieght=e[0],s.totalCount=e[3]),n&&(s.minCellWeight=n[0],s.totalCount=e[3])),s}static getCellData({countsData:t,size:e=1}){const n=t.length/4,r=new Float32Array(n*e),i=new Uint32Array(n);for(let o=0;o<n;o++){for(let n=0;n<e;n++)r[o*e+n]=t[4*o+n];i[o]=t[4*o+3]}return{cellCounts:i,cellWeights:r}}static isSupported(t){return(0,s.QN)(t,L)}constructor(t,e={}){this.id=e.id||"gpu-grid-aggregator",this.gl=t,this.state={weightAttributes:{},textures:{},meanTextures:{},buffers:{},framebuffers:{},maxMinFramebuffers:{},minFramebuffers:{},maxFramebuffers:{},equations:{},resources:{},results:{}},this._hasGPUSupport=(0,a.C6)(t)&&(0,s.QN)(this.gl,o.G.BLEND_EQUATION_MINMAX,o.G.COLOR_ATTACHMENT_RGBA32F,o.G.TEXTURE_FLOAT),this._hasGPUSupport&&this._setupModels()}delete(){const{gridAggregationModel:t,allAggregationModel:e,meanTransform:n}=this,{textures:r,framebuffers:i,maxMinFramebuffers:o,minFramebuffers:s,maxFramebuffers:a,meanTextures:l,resources:u}=this.state;null==t||t.delete(),null==e||e.delete(),null==n||n.delete(),function(t){(t=Array.isArray(t)?t:[t]).forEach((t=>{for(const e in t)t[e].delete()}))}([i,r,o,s,a,l,u])}run(t={}){this.setState({results:{}});const e=this._normalizeAggregationParams(t);return this._hasGPUSupport||i.A.log(1,"GPUGridAggregator: not supported")(),this._runAggregation(e)}getData(t){const e={},n=this.state.results;n[t].aggregationData||(n[t].aggregationData=n[t].aggregationBuffer.getData()),e.aggregationData=n[t].aggregationData;for(const r in B){const i=B[r];(n[t][r]||n[t][i])&&(n[t][r]=n[t][r]||n[t][i].getData(),e[r]=n[t][r])}return e}updateShaders(t={}){this.setState({shaderOptions:t,modelDirty:!0})}_normalizeAggregationParams(t){const e={..._,...t},{weights:n}=e;return n&&(e.weights=function(t){const e={};for(const n in t)e[n]={...E,...t[n]};return e}(n)),e}setState(t){Object.assign(this.state,t)}_getAggregateData(t){const e={},{textures:n,framebuffers:r,maxMinFramebuffers:i,minFramebuffers:o,maxFramebuffers:s,resources:a}=this.state,{weights:u}=t;for(const t in u){e[t]={};const{needMin:c,needMax:h,combineMaxMin:d}=u[t];e[t].aggregationTexture=n[t],e[t].aggregationBuffer=(0,l.fY)(r[t],{target:u[t].aggregationBuffer,sourceType:5126}),c&&h&&d?(e[t].maxMinBuffer=(0,l.fY)(i[t],{target:u[t].maxMinBuffer,sourceType:5126}),e[t].maxMinTexture=a["".concat(t,"-maxMinTexture")]):(c&&(e[t].minBuffer=(0,l.fY)(o[t],{target:u[t].minBuffer,sourceType:5126}),e[t].minTexture=a["".concat(t,"-minTexture")]),h&&(e[t].maxBuffer=(0,l.fY)(s[t],{target:u[t].maxBuffer,sourceType:5126}),e[t].maxTexture=a["".concat(t,"-maxTexture")]))}return this._trackGPUResultBuffers(e,u),e}_renderAggregateData(t){const{cellSize:e,projectPoints:n,attributes:r,moduleSettings:i,numCol:o,numRow:s,weights:a,translation:l,scaling:u}=t,{maxMinFramebuffers:c,minFramebuffers:h,maxFramebuffers:d}=this.state,f=[o,s],p={blend:!0,depthTest:!1,blendFunc:[1,1]},g={cellSize:e,gridSize:f,projectPoints:n,translation:l,scaling:u};for(const t in a){const{needMin:e,needMax:n}=a[t],o=e&&n&&a[t].combineMaxMin;this._renderToWeightsTexture({id:t,parameters:p,moduleSettings:i,uniforms:g,gridSize:f,attributes:r,weights:a}),o?this._renderToMaxMinTexture({id:t,parameters:{...p,blendEquation:C},gridSize:f,minOrMaxFb:c[t],clearParams:{clearColor:[0,0,0,A]},combineMaxMin:o}):(e&&this._renderToMaxMinTexture({id:t,parameters:{...p,blendEquation:x},gridSize:f,minOrMaxFb:h[t],clearParams:{clearColor:[A,A,A,0]},combineMaxMin:o}),n&&this._renderToMaxMinTexture({id:t,parameters:{...p,blendEquation:w},gridSize:f,minOrMaxFb:d[t],clearParams:{clearColor:[0,0,0,0]},combineMaxMin:o}))}}_renderToMaxMinTexture(t){const{id:e,parameters:n,gridSize:r,minOrMaxFb:i,combineMaxMin:o,clearParams:s={}}=t,{framebuffers:l}=this.state,{gl:u,allAggregationModel:c}=this;(0,a.zv)(u,{...s,framebuffer:i,viewport:[0,0,r[0],r[1]]},(()=>{u.clear(16384),c.draw({parameters:n,uniforms:{uSampler:l[e].texture,gridSize:r,combineMaxMin:o}})}))}_renderToWeightsTexture(t){const{id:e,parameters:n,moduleSettings:r,uniforms:i,gridSize:o,weights:s}=t,{framebuffers:l,equations:u,weightAttributes:h}=this.state,{gl:d,gridAggregationModel:f}=this,{operation:g}=s[e],y=g===p.MIN?[A,A,A,0]:[0,0,0,0];if((0,a.zv)(d,{framebuffer:l[e],viewport:[0,0,o[0],o[1]],clearColor:y},(()=>{d.clear(16384);const t={weights:h[e]};f.draw({parameters:{...n,blendEquation:u[e]},moduleSettings:r,uniforms:i,attributes:t})})),g===p.MEAN){const{meanTextures:t,textures:n}=this.state,r={_sourceTextures:{aggregationValues:t[e]},_targetTexture:n[e],elementCount:n[e].width*n[e].height};this.meanTransform?this.meanTransform.update(r):this.meanTransform=function(t,e){return new c.A(t,{vs:"#define SHADER_NAME gpu-aggregation-transform-mean-vs\nattribute vec4 aggregationValues;\nvarying vec4 meanValues;\n\nvoid main()\n{\n  bool isCellValid = bool(aggregationValues.w > 0.);\n  meanValues.xyz = isCellValid ? aggregationValues.xyz/aggregationValues.w : vec3(0, 0, 0);\n  meanValues.w = aggregationValues.w;\n  gl_PointSize = 1.0;\n}\n",_targetTextureVarying:"meanValues",...e})}(d,r),this.meanTransform.run({parameters:{blend:!1,depthTest:!1}}),l[e].attach({36064:n[e]})}}_runAggregation(t){this._updateModels(t),this._setupFramebuffers(t),this._renderAggregateData(t);const e=this._getAggregateData(t);return this.setState({results:e}),e}_setupFramebuffers(t){const{textures:e,framebuffers:n,maxMinFramebuffers:r,minFramebuffers:i,maxFramebuffers:o,meanTextures:s,equations:a}=this.state,{weights:l}=t,{numCol:u,numRow:c}=t,h={width:u,height:c};for(const t in l){const{needMin:d,needMax:f,combineMaxMin:g,operation:y}=l[t];e[t]=l[t].aggregationTexture||e[t]||O(this.gl,{id:"".concat(t,"-texture"),width:u,height:c}),e[t].resize(h);let m=e[t];y===p.MEAN&&(s[t]=s[t]||O(this.gl,{id:"".concat(t,"-mean-texture"),width:u,height:c}),s[t].resize(h),m=s[t]),n[t]?n[t].attach({36064:m}):n[t]=I(this.gl,{id:"".concat(t,"-fb"),width:u,height:c,texture:m}),n[t].resize(h),a[t]=S[y]||S.SUM,(d||f)&&(d&&f&&g?r[t]||(m=l[t].maxMinTexture||this._getMinMaxTexture("".concat(t,"-maxMinTexture")),r[t]=I(this.gl,{id:"".concat(t,"-maxMinFb"),texture:m})):(d&&(i[t]||(m=l[t].minTexture||this._getMinMaxTexture("".concat(t,"-minTexture")),i[t]=I(this.gl,{id:"".concat(t,"-minFb"),texture:m}))),f&&(o[t]||(m=l[t].maxTexture||this._getMinMaxTexture("".concat(t,"-maxTexture")),o[t]=I(this.gl,{id:"".concat(t,"-maxFb"),texture:m})))))}}_getMinMaxTexture(t){const{resources:e}=this.state;return e[t]||(e[t]=O(this.gl,{id:"resourceName"})),e[t]}_setupModels({numCol:t=0,numRow:e=0}={}){var n;const{gl:r}=this,{shaderOptions:i}=this.state;if(null===(n=this.gridAggregationModel)||void 0===n||n.delete(),this.gridAggregationModel=function(t,e){const n=(0,d.n)({vs:"#define SHADER_NAME gpu-aggregation-to-grid-vs\n\nattribute vec3 positions;\nattribute vec3 positions64Low;\nattribute vec3 weights;\nuniform vec2 cellSize;\nuniform vec2 gridSize;\nuniform bool projectPoints;\nuniform vec2 translation;\nuniform vec3 scaling;\n\nvarying vec3 vWeights;\n\nvec2 project_to_pixel(vec4 pos) {\n  vec4 result;\n  pos.xy = pos.xy/pos.w;\n  result = pos + vec4(translation, 0., 0.);\n  result.xy = scaling.z > 0. ? result.xy * scaling.xy : result.xy;\n  return result.xy;\n}\n\nvoid main(void) {\n\n  vWeights = weights;\n\n  vec4 windowPos = vec4(positions, 1.);\n  if (projectPoints) {\n    windowPos = project_position_to_clipspace(positions, positions64Low, vec3(0));\n  }\n\n  vec2 pos = project_to_pixel(windowPos);\n\n  vec2 pixelXY64[2];\n  pixelXY64[0] = vec2(pos.x, 0.);\n  pixelXY64[1] = vec2(pos.y, 0.);\n  vec2 gridXY64[2];\n  gridXY64[0] = div_fp64(pixelXY64[0], vec2(cellSize.x, 0));\n  gridXY64[1] = div_fp64(pixelXY64[1], vec2(cellSize.y, 0));\n  float x = floor(gridXY64[0].x);\n  float y = floor(gridXY64[1].x);\n  pos = vec2(x, y);\n  pos = (pos * (2., 2.) / (gridSize)) - (1., 1.);\n  vec2 offset = 1.0 / gridSize;\n  pos = pos + offset;\n\n  gl_Position = vec4(pos, 0.0, 1.0);\n  gl_PointSize = 1.0;\n}\n",fs:"#define SHADER_NAME gpu-aggregation-to-grid-fs\n\nprecision highp float;\n\nvarying vec3 vWeights;\n\nvoid main(void) {\n  gl_FragColor = vec4(vWeights, 1.0);\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[h.dI,f.A]},e);return new u.A(t,{id:"Gird-Aggregation-Model",vertexCount:1,drawMode:0,...n})}(r,i),!this.allAggregationModel){const n=t*e;this.allAggregationModel=function(t,e){return new u.A(t,{id:"All-Aggregation-Model",vs:"#version 300 es\n#define SHADER_NAME gpu-aggregation-all-vs-64\n\nin vec2 position;\nuniform ivec2 gridSize;\nout vec2 vTextureCoord;\n\nvoid main(void) {\n  vec2 pos = vec2(-1.0, -1.0);\n  vec2 offset = 1.0 / vec2(gridSize);\n  pos = pos + offset;\n\n  gl_Position = vec4(pos, 0.0, 1.0);\n\n  int yIndex = gl_InstanceID / gridSize[0];\n  int xIndex = gl_InstanceID - (yIndex * gridSize[0]);\n\n  vec2 yIndexFP64 = vec2(float(yIndex), 0.);\n  vec2 xIndexFP64 = vec2(float(xIndex), 0.);\n  vec2 gridSizeYFP64 = vec2(gridSize[1], 0.);\n  vec2 gridSizeXFP64 = vec2(gridSize[0], 0.);\n\n  vec2 texCoordXFP64 = div_fp64(yIndexFP64, gridSizeYFP64);\n  vec2 texCoordYFP64 = div_fp64(xIndexFP64, gridSizeXFP64);\n\n  vTextureCoord = vec2(texCoordYFP64.x, texCoordXFP64.x);\n  gl_PointSize = 1.0;\n}\n",fs:"#version 300 es\n#define SHADER_NAME gpu-aggregation-all-fs\n\nprecision highp float;\n\nin vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform bool combineMaxMin;\nout vec4 fragColor;\nvoid main(void) {\n  vec4 textureColor = texture(uSampler, vec2(vTextureCoord.s, vTextureCoord.t));\n  if (textureColor.a == 0.) {\n    discard;\n  }\n  fragColor.rgb = textureColor.rgb;\n  fragColor.a = combineMaxMin ? textureColor.r : textureColor.a;\n}\n",modules:[h.dI],vertexCount:1,drawMode:0,isInstanced:!0,instanceCount:e,attributes:{position:[0,0]}})}(r,n)}}_setupWeightAttributes(t){const{weightAttributes:e}=this.state,{weights:n}=t;for(const r in n)e[r]=t.attributes[r]}_trackGPUResultBuffers(t,e){const{resources:n}=this.state;for(const r in t)if(t[r])for(const i of R)if(t[r][i]&&e[r][i]!==t[r][i]){const e="gpu-result-".concat(r,"-").concat(i);n[e]&&n[e].delete(),n[e]=t[r][i]}}_updateModels(t){const{vertexCount:e,attributes:n,numCol:r,numRow:i}=t,{modelDirty:o}=this.state;o&&(this._setupModels(t),this.setState({modelDirty:!1})),this._setupWeightAttributes(t),this.gridAggregationModel.setVertexCount(e),this.gridAggregationModel.setAttributes(n),this.allAggregationModel.setInstanceCount(r*i)}}var D=n(82170),F=n(36179),N=n(70560);const j=[[255,255,178],[254,217,118],[254,178,76],[253,141,60],[240,59,32],[189,0,38]];function G(t,e=!1,n=Float32Array){let r;if(Number.isFinite(t[0]))r=new n(t);else{r=new n(4*t.length);let e=0;for(let n=0;n<t.length;n++){const i=t[n];r[e++]=i[0],r[e++]=i[1],r[e++]=i[2],r[e++]=Number.isFinite(i[3])?i[3]:255}}if(e)for(let t=0;t<r.length;t++)r[t]/=255;return r}const U=[0,0,0,0],z=[0,255,0,255],V=["minColor","maxColor","colorRange","colorDomain"],H={cellSizePixels:{value:100,min:1},cellMarginPixels:{value:2,min:0,max:5},colorDomain:null,colorRange:j};class q extends F.A{constructor(...t){super(...t),(0,r.A)(this,"state",void 0)}static isSupported(t){return(0,s.QN)(t,[o.G.TEXTURE_FLOAT])}getShaders(){return{vs:"#define SHADER_NAME screen-grid-layer-vertex-shader\n#define RANGE_COUNT 6\n\nattribute vec3 positions;\nattribute vec3 instancePositions;\nattribute vec4 instanceCounts;\nattribute vec3 instancePickingColors;\n\nuniform float opacity;\nuniform vec3 cellScale;\nuniform vec4 minColor;\nuniform vec4 maxColor;\nuniform vec4 colorRange[RANGE_COUNT];\nuniform vec2 colorDomain;\nuniform bool shouldUseMinMax;\nuniform sampler2D maxTexture;\n\nvarying vec4 vColor;\nvarying float vSampleCount;\n\nvec4 quantizeScale(vec2 domain, vec4 range[RANGE_COUNT], float value) {\n  vec4 outColor = vec4(0., 0., 0., 0.);\n  if (value >= domain.x && value <= domain.y) {\n    float domainRange = domain.y - domain.x;\n    if (domainRange <= 0.) {\n      outColor = colorRange[0];\n    } else {\n      float rangeCount = float(RANGE_COUNT);\n      float rangeStep = domainRange / rangeCount;\n      float idx = floor((value - domain.x) / rangeStep);\n      idx = clamp(idx, 0., rangeCount - 1.);\n      int intIdx = int(idx);\n      outColor = colorRange[intIdx];\n    }\n  }\n  outColor = outColor / 255.;\n  return outColor;\n}\n\nvoid main(void) {\n  vSampleCount = instanceCounts.a;\n\n  float weight = instanceCounts.r;\n  float maxWeight = texture2D(maxTexture, vec2(0.5)).r;\n\n  float step = weight / maxWeight;\n  vec4 minMaxColor = mix(minColor, maxColor, step) / 255.;\n\n  vec2 domain = colorDomain;\n  float domainMaxValid = float(colorDomain.y != 0.);\n  domain.y = mix(maxWeight, colorDomain.y, domainMaxValid);\n  vec4 rangeColor = quantizeScale(domain, colorRange, weight);\n\n  float rangeMinMax = float(shouldUseMinMax);\n  vec4 color = mix(rangeColor, minMaxColor, rangeMinMax);\n  vColor = vec4(color.rgb, color.a * opacity);\n  picking_setPickingColor(instancePickingColors);\n\n  gl_Position = vec4(instancePositions + positions * cellScale, 1.);\n}\n",fs:"#define SHADER_NAME screen-grid-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\nvarying float vSampleCount;\n\nvoid main(void) {\n  if (vSampleCount <= 0.0) {\n    discard;\n  }\n  gl_FragColor = vColor;\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[N.A]}}initializeState(){const{gl:t}=this.context;this.getAttributeManager().addInstanced({instancePositions:{size:3,update:this.calculateInstancePositions},instanceCounts:{size:4,noAlloc:!0}}),this.setState({model:this._getModel(t)})}shouldUpdateState({changeFlags:t}){return t.somethingChanged}updateState(t){super.updateState(t);const{oldProps:e,props:n,changeFlags:r}=t,i=this.getAttributeManager();n.numInstances!==e.numInstances?i.invalidateAll():e.cellSizePixels!==n.cellSizePixels&&i.invalidate("instancePositions"),this._updateUniforms(e,n,r)}draw({uniforms:t}){const{parameters:e,maxTexture:n}=this.props,r=this.props.minColor||U,i=this.props.maxColor||z,o=this.props.colorDomain||[1,0],{model:s}=this.state;s.setUniforms(t).setUniforms({minColor:r,maxColor:i,maxTexture:n,colorDomain:o}).draw({parameters:{depthTest:!1,depthMask:!1,...e}})}calculateInstancePositions(t,{numInstances:e}){const{width:n,height:r}=this.context.viewport,{cellSizePixels:i}=this.props,o=Math.ceil(n/i),{value:s,size:a}=t;for(let t=0;t<e;t++){const e=t%o,l=Math.floor(t/o);s[t*a+0]=e*i/n*2-1,s[t*a+1]=1-l*i/r*2,s[t*a+2]=0}}_getModel(t){return new u.A(t,{...this.getShaders(),id:this.props.id,geometry:new D.A({drawMode:6,attributes:{positions:new Float32Array([0,0,0,1,0,0,1,1,0,0,1,0])}}),isInstanced:!0})}_shouldUseMinMax(){const{minColor:t,maxColor:e,colorDomain:n,colorRange:r}=this.props;return t||e?(i.A.deprecated("ScreenGridLayer props: minColor and maxColor","colorRange, colorDomain")(),!0):!n&&!r}_updateUniforms(t,e,n){const{model:r}=this.state;if(V.some((n=>t[n]!==e[n]))&&r.setUniforms({shouldUseMinMax:this._shouldUseMinMax()}),t.colorRange!==e.colorRange&&r.setUniforms({colorRange:G(e.colorRange)}),t.cellMarginPixels!==e.cellMarginPixels||t.cellSizePixels!==e.cellSizePixels||n.viewportChanged){const{width:t,height:e}=this.context.viewport,{cellSizePixels:n,cellMarginPixels:i}=this.props,o=n>i?i:0,s=new Float32Array([(n-o)/t*2,-(n-o)/e*2,1]);r.setUniforms({cellScale:s})}}}(0,r.A)(q,"layerName","ScreenGridCellLayer"),(0,r.A)(q,"defaultProps",H);var W=n(68411),J=n(49949),Y=n(83726);function X(t,e){const n={};for(const r in t)e.includes(r)||(n[r]=t[r]);return n}class K extends W.A{constructor(...t){super(...t),(0,r.A)(this,"state",void 0)}initializeAggregationLayer(t){super.initializeState(this.context),this.setState({ignoreProps:X(this.constructor._propTypes,t.data.props),dimensions:t})}updateState(t){super.updateState(t);const{changeFlags:e}=t;if(e.extensionsChanged){const t=this.getShaders({});t&&t.defines&&(t.defines.NON_INSTANCED_MODEL=1),this.updateShaders(t)}this._updateAttributes()}updateAttributes(t){this.setState({changedAttributes:t})}getAttributes(){return this.getAttributeManager().getShaderAttributes()}getModuleSettings(){const{viewport:t,mousePosition:e,gl:n}=this.context;return Object.assign(Object.create(this.props),{viewport:t,mousePosition:e,pickingActive:0,devicePixelRatio:(0,a.o0)(n)})}updateShaders(t){}isAggregationDirty(t,e={}){const{props:n,oldProps:r,changeFlags:i}=t,{compareAll:o=!1,dimension:s}=e,{ignoreProps:a}=this.state,{props:l,accessors:u=[]}=s,{updateTriggersChanged:c}=i;if(i.dataChanged)return!0;if(c){if(c.all)return!0;for(const t of u)if(c[t])return!0}if(o)return!!i.extensionsChanged||(0,J.Me)({oldProps:r,newProps:n,ignoreProps:a,propTypes:this.constructor._propTypes});for(const t of l)if(n[t]!==r[t])return!0;return!1}isAttributeChanged(t){const{changedAttributes:e}=this.state;return t?e&&void 0!==e[t]:!function(t){let e=!0;for(const n in t){e=!1;break}return e}(e)}_getAttributeManager(){return new Y.A(this.context.gl,{id:this.props.id,stats:this.context.stats})}}(0,r.A)(K,"layerName","AggregationLayer");var Z=n(62671);function Q(t,e,n){const r=n;return r.domain=()=>t,r.range=()=>e,r}function $(t,e){return Q(t,e,(n=>function(t,e,n){const r=t[1]-t[0];if(r<=0)return i.A.warn("quantizeScale: invalid domain, returning range[0]")(),e[0];const o=r/e.length,s=Math.floor((n-t[0])/o);return e[Math.max(Math.min(s,e.length-1),0)]}(t,e,n)))}function tt(t,e){return Q(t,e,(n=>function(t,e,n){return(n-t[0])/(t[1]-t[0])*(e[1]-e[0])+e[0]}(t,e,n)))}function et(t,e){const n=t.sort(nt);let r=0;const i=Math.max(1,e.length),o=new Array(i-1);for(;++r<i;)o[r-1]=rt(n,r/i);const s=t=>function(t,e,n){return e[function(t,e){let n=0,r=t.length;for(;n<r;){const i=n+r>>>1;nt(t[i],e)>0?r=i:n=i+1}return n}(t,n)]}(o,e,t);return s.thresholds=()=>o,Q(t,e,s)}function nt(t,e){return t-e}function rt(t,e){const n=t.length;if(e<=0||n<2)return t[0];if(e>=1)return t[n-1];const r=(n-1)*e,i=Math.floor(r),o=t[i];return o+(t[i+1]-o)*(r-i)}function it(t,e){const n=new Map,r=[];for(const e of t){const t="".concat(e);n.has(t)||n.set(t,r.push(e))}return Q(t,e,(t=>function(t,e,n,r){const i="".concat(r);let o=e.get(i);return void 0===o&&(o=t.push(r),e.set(i,o)),n[(o-1)%n.length]}(r,n,e,t)))}function ot(t){return null!=t}function st(t,e){return("function"==typeof e?t.map(e):t).filter(ot)}const at=t=>t.length,lt=t=>t.points,ut=t=>t.index,ct=(t,e)=>t<e?-1:t>e?1:t>=e?0:NaN,ht={getValue:at,getPoints:lt,getIndex:ut,filterData:null};class dt{constructor(t=[],e=ht){(0,r.A)(this,"maxCount",void 0),(0,r.A)(this,"maxValue",void 0),(0,r.A)(this,"minValue",void 0),(0,r.A)(this,"totalCount",void 0),(0,r.A)(this,"aggregatedBins",void 0),(0,r.A)(this,"sortedBins",void 0),(0,r.A)(this,"binMap",void 0),this.aggregatedBins=this.getAggregatedBins(t,e),this._updateMinMaxValues(),this.binMap=this.getBinMap()}getAggregatedBins(t,e){const{getValue:n=at,getPoints:r=lt,getIndex:i=ut,filterData:o}=e,s="function"==typeof o,a=t.length,l=[];let u=0;for(let e=0;e<a;e++){const a=t[e],c=r(a),h=i(a),d=s?c.filter(o):c;a.filteredPoints=s?d:null;const f=d.length?n(d):null;null!=f&&(l[u]={i:Number.isFinite(h)?h:e,value:f,counts:d.length},u++)}return l}_percentileToIndex(t){const e=this.sortedBins.length;if(e<2)return[0,0];const[n,r]=t.map((t=>{return e=t,Math.max(0,Math.min(100,e));var e}));return[Math.ceil(n/100*(e-1)),Math.floor(r/100*(e-1))]}getBinMap(){const t={};for(const e of this.aggregatedBins)t[e.i]=e;return t}_updateMinMaxValues(){let t=0,e=0,n=3402823466e29,r=0;for(const i of this.aggregatedBins)t=t>i.counts?t:i.counts,e=e>i.value?e:i.value,n=n<i.value?n:i.value,r+=i.counts;this.maxCount=t,this.maxValue=e,this.minValue=n,this.totalCount=r}getValueRange(t){if(this.sortedBins||(this.sortedBins=this.aggregatedBins.sort(((t,e)=>ct(t.value,e.value)))),!this.sortedBins.length)return[];let e=0,n=this.sortedBins.length-1;if(Array.isArray(t)){const r=this._percentileToIndex(t);e=r[0],n=r[1]}return[this.sortedBins[e].value,this.sortedBins[n].value]}getValueDomainByScale(t,[e=0,n=100]=[]){if(this.sortedBins||(this.sortedBins=this.aggregatedBins.sort(((t,e)=>ct(t.value,e.value)))),!this.sortedBins.length)return[];const r=this._percentileToIndex([e,n]);return this._getScaleDomain(t,r)}_getScaleDomain(t,[e,n]){const r=this.sortedBins;switch(t){case"quantize":case"linear":default:return[r[e].value,r[n].value];case"quantile":return st(r.slice(e,n+1),(t=>t.value));case"ordinal":return function(t,e){return function(t){const e=[];return t.forEach((t=>{!e.includes(t)&&ot(t)&&e.push(t)})),e}(st(t,e))}(r,(t=>t.value))}}}var ft=n(97870),pt=n(1597);const gt=6378e3;function yt(t){return Number.isFinite(t)?t:0}function mt(t,e){const n=t.positions.value;let r,i,o=1/0,s=-1/0,a=1/0,l=-1/0;for(let t=0;t<e;t++)i=n[3*t],r=n[3*t+1],o=r<o?r:o,s=r>s?r:s,a=i<a?i:a,l=i>l?i:l;return{xMin:yt(a),xMax:yt(l),yMin:yt(o),yMax:yt(s)}}function vt(t,e){const n=t<0?-1:1;let r=n<0?Math.abs(t)+e:Math.abs(t);return r=Math.floor(r/e)*e,r*n}function bt(t,e,n=!0){if(!n)return{xOffset:e,yOffset:e};const{yMin:r,yMax:i}=t;return function(t,e){var n;return{yOffset:t/gt*(180/Math.PI),xOffset:(n=e,t/gt*(180/Math.PI)/Math.cos(n*Math.PI/180))}}(e,(r+i)/2)}function _t(t,e,n,r){const o=bt(t,e,r!==pt.rf.CARTESIAN),s=function(t,e,n,r){const{width:o,height:s}=r,a=n===pt.rf.CARTESIAN?[-o/2,-s/2]:[-180,-90];i.A.assert(n===pt.rf.CARTESIAN||n===pt.rf.LNGLAT||n===pt.rf.DEFAULT);const{xMin:l,yMin:u}=t;return[-1*(vt(l-a[0],e.xOffset)+a[0]),-1*(vt(u-a[1],e.yOffset)+a[1])]}(t,o,r,n),{xMin:a,yMin:l,xMax:u,yMax:c}=t,h=u-a+o.xOffset,d=c-l+o.yOffset;return{gridOffset:o,translation:s,width:h,height:d,numCol:Math.ceil(h/o.xOffset),numRow:Math.ceil(d/o.yOffset)}}function At(t,e){const n=function(t,e){const{data:n=[],cellSize:r}=t,{attributes:i,viewport:o,projectPoints:s,numInstances:a}=e,l=i.positions.value,{size:u}=i.positions.getAccessor(),c=e.boundingBox||function(t,e){const n=t.value,{size:r}=t.getAccessor();let i,o,s=1/0,a=-1/0,l=1/0,u=-1/0;for(let t=0;t<e;t++)o=n[t*r],i=n[t*r+1],Number.isFinite(o)&&Number.isFinite(i)&&(s=i<s?i:s,a=i>a?i:a,l=o<l?o:l,u=o>u?o:u);return{xMin:l,xMax:u,yMin:s,yMax:a}}(i.positions,a),h=e.posOffset||[180,90],d=e.gridOffset||bt(c,r);if(d.xOffset<=0||d.yOffset<=0)return{gridHash:{},gridOffset:d};const{width:f,height:p}=o,g=Math.ceil(f/d.xOffset),y=Math.ceil(p/d.yOffset),m={},{iterable:v,objectInfo:b}=(0,ft.X)(n),_=new Array(3);for(const t of v){b.index++,_[0]=l[b.index*u],_[1]=l[b.index*u+1],_[2]=u>=3?l[b.index*u+2]:0;const[e,n]=s?o.project(_):_;if(Number.isFinite(e)&&Number.isFinite(n)){const r=Math.floor((n+h[1])/d.yOffset),i=Math.floor((e+h[0])/d.xOffset);if(!s||i>=0&&i<g&&r>=0&&r<y){const e="".concat(r,"-").concat(i);m[e]=m[e]||{count:0,points:[],lonIdx:i,latIdx:r},m[e].count+=1,m[e].points.push({source:t,index:b.index})}}}return{gridHash:m,gridOffset:d,offsets:[-1*h[0],-1*h[1]]}}(t,e),r=function({gridHash:t,gridOffset:e,offsets:n}){const r=new Array(Object.keys(t).length);let i=0;for(const o in t){const s=o.split("-"),a=parseInt(s[0],10),l=parseInt(s[1],10),u=i++;r[u]={index:u,position:[n[0]+e.xOffset*l,n[1]+e.yOffset*a],...t[o]}}return r}(n);return{gridHash:n.gridHash,gridOffset:n.gridOffset,data:r}}class xt extends K{constructor(...t){super(...t),(0,r.A)(this,"state",void 0)}initializeAggregationLayer({dimensions:t}){const{gl:e}=this.context;super.initializeAggregationLayer(t),this.setState({layerData:{},gpuGridAggregator:new k(e,{id:"".concat(this.id,"-gpu-aggregator")}),cpuGridAggregator:At})}updateState(t){super.updateState(t),this.updateAggregationState(t);const{aggregationDataDirty:e,aggregationWeightsDirty:n,gpuAggregation:r}=this.state;if(this.getNumInstances()<=0)return;let i=!1;(e||r&&n)&&(this._updateAggregation(t),i=!0),r||!e&&!n||(this._updateWeightBins(),this._uploadAggregationResults(),i=!0),this.setState({aggregationDirty:i})}finalizeState(t){var e;const{count:n}=this.state.weights;n&&n.aggregationBuffer&&n.aggregationBuffer.delete(),null===(e=this.state.gpuGridAggregator)||void 0===e||e.delete(),super.finalizeState(t)}updateShaders(t){this.state.gpuAggregation&&this.state.gpuGridAggregator.updateShaders(t)}updateAggregationState(t){i.A.assert(!1)}allocateResources(t,e){if(this.state.numRow!==t||this.state.numCol!==e){const n=e*t*4*4,r=this.context.gl,{weights:i}=this.state;for(const t in i){const e=i[t];e.aggregationBuffer&&e.aggregationBuffer.delete(),e.aggregationBuffer=new Z.A(r,{byteLength:n,accessor:{size:4,type:5126,divisor:1}})}}}updateResults({aggregationData:t,maxMinData:e,maxData:n,minData:r}){const{count:i}=this.state.weights;i&&(i.aggregationData=t,i.maxMinData=e,i.maxData=n,i.minData=r)}_updateAggregation(t){const{cpuGridAggregator:e,gpuGridAggregator:n,gridOffset:r,posOffset:i,translation:o=[0,0],scaling:s=[0,0,0],boundingBox:a,projectPoints:l,gpuAggregation:u,numCol:c,numRow:h}=this.state,{props:d}=t,{viewport:f}=this.context,p=this.getAttributes(),g=this.getNumInstances();if(u){const{weights:t}=this.state;n.run({weights:t,cellSize:[r.xOffset,r.yOffset],numCol:c,numRow:h,translation:o,scaling:s,vertexCount:g,projectPoints:l,attributes:p,moduleSettings:this.getModuleSettings()})}else{const t=e(d,{gridOffset:r,projectPoints:l,attributes:p,viewport:f,posOffset:i,boundingBox:a});this.setState({layerData:t})}}_updateWeightBins(){const{getValue:t}=this.state,e=new dt(this.state.layerData.data||[],{getValue:t});this.setState({sortedBins:e})}_uploadAggregationResults(){const{numCol:t,numRow:e}=this.state,{data:n}=this.state.layerData,{aggregatedBins:r,minValue:i,maxValue:o,totalCount:s}=this.state.sortedBins,a=new Float32Array(t*e*4).fill(0);for(const e of r){const{lonIdx:r,latIdx:i}=n[e.i],{value:o,counts:s}=e,l=4*(r+i*t);a[l]=o,a[l+4-1]=s}const l=new Float32Array([o,0,0,i]),u=new Float32Array([o,0,0,s]),c=new Float32Array([i,0,0,s]);this.updateResults({aggregationData:a,maxMinData:l,maxData:u,minData:c})}}(0,r.A)(xt,"layerName","GridAggregationLayer");const wt={...q.defaultProps,getPosition:{type:"accessor",value:t=>t.position},getWeight:{type:"accessor",value:1},gpuAggregation:!0,aggregation:"SUM"},Ct="positions",St={data:{props:["cellSizePixels"]},weights:{props:["aggregation"],accessors:["getWeight"]}};class Et extends xt{constructor(...t){super(...t),(0,r.A)(this,"state",void 0)}initializeState(){const{gl:t}=this.context;if(!q.isSupported(t))return this.setState({supported:!1}),void i.A.error("ScreenGridLayer: ".concat(this.id," is not supported on this browser"))();super.initializeAggregationLayer({dimensions:St,getCellSize:t=>t.cellSizePixels});const e={count:{size:1,operation:p.SUM,needMax:!0,maxTexture:O(t,{id:"".concat(this.id,"-max-texture")})}};this.setState({supported:!0,projectPoints:!0,weights:e,subLayerData:{attributes:{}},maxTexture:e.count.maxTexture,positionAttributeName:"positions",posOffset:[0,0],translation:[1,-1]}),this.getAttributeManager().add({[Ct]:{size:3,accessor:"getPosition",type:5130,fp64:this.use64bitPositions()},count:{size:3,accessor:"getWeight"}})}shouldUpdateState({changeFlags:t}){return this.state.supported&&t.somethingChanged}updateState(t){super.updateState(t)}renderLayers(){if(!this.state.supported)return[];const{maxTexture:t,numRow:e,numCol:n,weights:r}=this.state,{updateTriggers:i}=this.props,{aggregationBuffer:o}=r.count;return new(this.getSubLayerClass("cells",q))(this.props,this.getSubLayerProps({id:"cell-layer",updateTriggers:i}),{data:{attributes:{instanceCounts:o}},maxTexture:t,numInstances:e*n})}finalizeState(t){super.finalizeState(t);const{aggregationBuffer:e,maxBuffer:n,maxTexture:r}=this.state;null==e||e.delete(),null==n||n.delete(),null==r||r.delete()}getPickingInfo({info:t}){const{index:e}=t;if(e>=0){const{gpuGridAggregator:n,gpuAggregation:r,weights:i}=this.state,o=r?n.getData("count"):i.count;t.object=k.getAggregationData({pixelIndex:e,...o})}return t}updateResults({aggregationData:t,maxData:e}){const{count:n}=this.state.weights;n.aggregationData=t,n.aggregationBuffer.setData({data:t}),n.maxData=e,n.maxTexture.setImageData({data:e})}updateAggregationState(t){const e=t.props.cellSizePixels,n=t.oldProps.cellSizePixels!==e,{viewportChanged:r}=t.changeFlags;let o=t.props.gpuAggregation;this.state.gpuAggregation!==t.props.gpuAggregation&&o&&!k.isSupported(this.context.gl)&&(i.A.warn("GPU Grid Aggregation not supported, falling back to CPU")(),o=!1);const s=o!==this.state.gpuAggregation;this.setState({gpuAggregation:o});const a=this.isAttributeChanged(Ct),{dimensions:l}=this.state,{data:u,weights:c}=l,h=a||s||r||this.isAggregationDirty(t,{compareAll:o,dimension:u}),d=this.isAggregationDirty(t,{dimension:c});this.setState({aggregationDataDirty:h,aggregationWeightsDirty:d});const{viewport:f}=this.context;if(r||n){const{width:t,height:n}=f,r=Math.ceil(t/e),i=Math.ceil(n/e);this.allocateResources(i,r),this.setState({scaling:[t/2,-n/2,1],gridOffset:{xOffset:e,yOffset:e},width:t,height:n,numCol:r,numRow:i})}d&&this._updateAccessors(t),(h||d)&&this._resetResults()}_updateAccessors(t){const{getWeight:e,aggregation:n,data:r}=t.props,{count:i}=this.state.weights;i&&(i.getWeight=e,i.operation=p[n]),this.setState({getValue:v(n,e,{data:r})})}_resetResults(){const{count:t}=this.state.weights;t&&(t.aggregationData=null)}}(0,r.A)(Et,"layerName","ScreenGridLayer"),(0,r.A)(Et,"defaultProps",wt);var Mt=n(53865);function Pt(){}const Tt=["getBins","getDomain","getScaleFunc"],Ot=[{key:"fillColor",accessor:"getFillColor",pickingInfo:"colorValue",getBins:{triggers:{value:{prop:"getColorValue",updateTrigger:"getColorValue"},weight:{prop:"getColorWeight",updateTrigger:"getColorWeight"},aggregation:{prop:"colorAggregation"},filterData:{prop:"_filterData",updateTrigger:"_filterData"}}},getDomain:{triggers:{lowerPercentile:{prop:"lowerPercentile"},upperPercentile:{prop:"upperPercentile"},scaleType:{prop:"colorScaleType"}}},getScaleFunc:{triggers:{domain:{prop:"colorDomain"},range:{prop:"colorRange"}},onSet:{props:"onSetColorDomain"}},nullValue:[0,0,0,0]},{key:"elevation",accessor:"getElevation",pickingInfo:"elevationValue",getBins:{triggers:{value:{prop:"getElevationValue",updateTrigger:"getElevationValue"},weight:{prop:"getElevationWeight",updateTrigger:"getElevationWeight"},aggregation:{prop:"elevationAggregation"},filterData:{prop:"_filterData",updateTrigger:"_filterData"}}},getDomain:{triggers:{lowerPercentile:{prop:"elevationLowerPercentile"},upperPercentile:{prop:"elevationUpperPercentile"},scaleType:{prop:"elevationScaleType"}}},getScaleFunc:{triggers:{domain:{prop:"elevationDomain"},range:{prop:"elevationRange"}},onSet:{props:"onSetElevationDomain"}},nullValue:-1}],It=t=>t.cellSize;class Rt{constructor(t){this.state={layerData:{},dimensions:{}},this.changeFlags={},this.dimensionUpdaters={},this._getCellSize=t.getCellSize||It,this._getAggregator=t.getAggregator,this._addDimension(t.dimensions||Ot)}static defaultDimensions(){return Ot}updateState(t,e){const{oldProps:n,props:r,changeFlags:i}=t;this.updateGetValueFuncs(n,r,i);const o=this.needsReProjectPoints(n,r,i);let s=!1;return i.dataChanged||o?(this.getAggregatedData(r,e),s=!0):((this.getDimensionChanges(n,r,i)||[]).forEach((t=>"function"==typeof t&&t())),s=!0),this.setState({aggregationDirty:s}),this.state}setState(t){this.state={...this.state,...t}}setDimensionState(t,e){this.setState({dimensions:{...this.state.dimensions,[t]:{...this.state.dimensions[t],...e}}})}normalizeResult(t={}){return t.hexagons?{data:t.hexagons,...t}:t.layerData?{data:t.layerData,...t}:t}getAggregatedData(t,e){const n=this._getAggregator(t)(t,e);this.setState({layerData:this.normalizeResult(n)}),this.changeFlags={layerData:!0},this.getSortedBins(t)}updateGetValueFuncs(t,e,n){for(const r in this.dimensionUpdaters){const{value:i,weight:o,aggregation:s}=this.dimensionUpdaters[r].getBins.triggers;let a=e[i.prop];this.needUpdateDimensionStep(this.dimensionUpdaters[r].getBins,t,e,n)&&(a=a?b(a,{data:e.data}):v(e[s.prop],e[o.prop],{data:e.data})),a&&this.setDimensionState(r,{getValue:a})}}needsReProjectPoints(t,e,n){return this._getCellSize(t)!==this._getCellSize(e)||this._getAggregator(t)!==this._getAggregator(e)||n.updateTriggersChanged&&(n.updateTriggersChanged.all||n.updateTriggersChanged.getPosition)}addDimension(t){this._addDimension(t)}_addDimension(t=[]){t.forEach((t=>{const{key:e}=t;this.dimensionUpdaters[e]=this.getDimensionUpdaters(t),this.state.dimensions[e]={getValue:null,domain:null,sortedBins:null,scaleFunc:Pt}}))}getDimensionUpdaters({key:t,accessor:e,pickingInfo:n,getBins:r,getDomain:i,getScaleFunc:o,nullValue:s}){return{key:t,accessor:e,pickingInfo:n,getBins:{updater:this.getDimensionSortedBins,...r},getDomain:{updater:this.getDimensionValueDomain,...i},getScaleFunc:{updater:this.getDimensionScale,...o},attributeAccessor:this.getSubLayerDimensionAttribute(t,s)}}needUpdateDimensionStep(t,e,n,r){return Object.values(t.triggers).some((t=>t.updateTrigger?r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged[t.updateTrigger]):e[t.prop]!==n[t.prop]))}getDimensionChanges(t,e,n){const r=[];for(const i in this.dimensionUpdaters){const o=Tt.find((r=>this.needUpdateDimensionStep(this.dimensionUpdaters[i][r],t,e,n)));o&&r.push(this.dimensionUpdaters[i][o].updater.bind(this,e,this.dimensionUpdaters[i]))}return r.length?r:null}getUpdateTriggers(t){const e=t.updateTriggers||{},n={};for(const r in this.dimensionUpdaters){const{accessor:i}=this.dimensionUpdaters[r];n[i]={},Tt.forEach((o=>{Object.values(this.dimensionUpdaters[r][o].triggers).forEach((({prop:r,updateTrigger:o})=>{if(o){const t=e[o];"object"!=typeof t||Array.isArray(t)?void 0!==t&&(n[i][r]=t):Object.assign(n[i],t)}else n[i][r]=t[r]}))}))}return n}getSortedBins(t){for(const e in this.dimensionUpdaters)this.getDimensionSortedBins(t,this.dimensionUpdaters[e])}getDimensionSortedBins(t,e){const{key:n}=e,{getValue:r}=this.state.dimensions[n],i=new dt(this.state.layerData.data||[],{getValue:r,filterData:t._filterData});this.setDimensionState(n,{sortedBins:i}),this.getDimensionValueDomain(t,e)}getDimensionValueDomain(t,e){const{getDomain:n,key:r}=e,{triggers:{lowerPercentile:i,upperPercentile:o,scaleType:s}}=n,a=this.state.dimensions[r].sortedBins.getValueDomainByScale(t[s.prop],[t[i.prop],t[o.prop]]);this.setDimensionState(r,{valueDomain:a}),this.getDimensionScale(t,e)}getDimensionScale(t,e){const{key:n,getScaleFunc:r,getDomain:i}=e,{domain:o,range:s}=r.triggers,{scaleType:a}=i.triggers,{onSet:l}=r,u=t[s.prop],c=t[o.prop]||this.state.dimensions[n].valueDomain,h=function(t){switch(t){case"quantize":default:return $;case"linear":return tt;case"quantile":return et;case"ordinal":return it}}(a&&t[a.prop]),d=h(c,u);"object"==typeof l&&"function"==typeof t[l.props]&&t[l.props](d.domain()),this.setDimensionState(n,{scaleFunc:d})}getSubLayerDimensionAttribute(t,e){return n=>{const{sortedBins:r,scaleFunc:i}=this.state.dimensions[t],o=r.binMap[n.index];if(o&&0===o.counts)return e;const s=o&&o.value,a=i.domain();return s>=a[0]&&s<=a[a.length-1]?i(s):e}}getSubLayerAccessors(t){const e={};for(const n in this.dimensionUpdaters){const{accessor:r}=this.dimensionUpdaters[n];e[r]=this.getSubLayerDimensionAttribute(t,n)}return e}getPickingInfo({info:t}){let e=null;if(t.picked&&t.index>-1){const n=this.state.layerData.data[t.index],r={};for(const t in this.dimensionUpdaters){const{pickingInfo:e}=this.dimensionUpdaters[t],{sortedBins:i}=this.state.dimensions[t],o=i.binMap[n.index]&&i.binMap[n.index].value;r[e]=o}e=Object.assign(r,n,{points:n.filteredPoints||n.points})}return t.picked=Boolean(e),t.object=e,t}getAccessor(t){return this.dimensionUpdaters.hasOwnProperty(t)?this.dimensionUpdaters[t].attributeAccessor:Pt}}function Bt(){}const Lt={colorDomain:null,colorRange:j,getColorValue:{type:"accessor",value:null},getColorWeight:{type:"accessor",value:1},colorAggregation:"SUM",lowerPercentile:{type:"number",min:0,max:100,value:0},upperPercentile:{type:"number",min:0,max:100,value:100},colorScaleType:"quantize",onSetColorDomain:Bt,elevationDomain:null,elevationRange:[0,1e3],getElevationValue:{type:"accessor",value:null},getElevationWeight:{type:"accessor",value:1},elevationAggregation:"SUM",elevationLowerPercentile:{type:"number",min:0,max:100,value:0},elevationUpperPercentile:{type:"number",min:0,max:100,value:100},elevationScale:{type:"number",min:0,value:1},elevationScaleType:"linear",onSetElevationDomain:Bt,gridAggregator:At,cellSize:{type:"number",min:0,max:1e3,value:1e3},coverage:{type:"number",min:0,max:1,value:1},getPosition:{type:"accessor",value:t=>t.position},extruded:!1,material:!0,_filterData:{type:"function",value:null,optional:!0}};class kt extends K{initializeState(){const t=new Rt({getAggregator:t=>t.gridAggregator,getCellSize:t=>t.cellSize});this.state={cpuAggregator:t,aggregatorState:t.state},this.getAttributeManager().add({positions:{size:3,type:5130,accessor:"getPosition"}})}updateState(t){super.updateState(t),this.setState({aggregatorState:this.state.cpuAggregator.updateState(t,{viewport:this.context.viewport,attributes:this.getAttributes(),numInstances:this.getNumInstances()})})}getPickingInfo({info:t}){return this.state.cpuAggregator.getPickingInfo({info:t})}_onGetSublayerColor(t){return this.state.cpuAggregator.getAccessor("fillColor")(t)}_onGetSublayerElevation(t){return this.state.cpuAggregator.getAccessor("elevation")(t)}_getSublayerUpdateTriggers(){return this.state.cpuAggregator.getUpdateTriggers(this.props)}renderLayers(){const{elevationScale:t,extruded:e,cellSize:n,coverage:r,material:i,transitions:o}=this.props,{cpuAggregator:s}=this.state,a=this.getSubLayerClass("grid-cell",Mt.A),l=this._getSublayerUpdateTriggers();return new a({cellSize:n,coverage:r,material:i,elevationScale:t,extruded:e,getFillColor:this._onGetSublayerColor.bind(this),getElevation:this._onGetSublayerElevation.bind(this),transitions:o&&{getFillColor:o.getColorValue||o.getColorWeight,getElevation:o.getElevationValue||o.getElevationWeight}},this.getSubLayerProps({id:"grid-cell",updateTriggers:l}),{data:s.state.layerData.data})}}(0,r.A)(kt,"layerName","CPUGridLayer"),(0,r.A)(kt,"defaultProps",Lt);var Dt=n(76483),Ft=n(46802);function Nt(){}const jt={colorDomain:null,colorRange:j,getColorValue:{type:"accessor",value:null},getColorWeight:{type:"accessor",value:1},colorAggregation:"SUM",lowerPercentile:{type:"number",value:0,min:0,max:100},upperPercentile:{type:"number",value:100,min:0,max:100},colorScaleType:"quantize",onSetColorDomain:Nt,elevationDomain:null,elevationRange:[0,1e3],getElevationValue:{type:"accessor",value:null},getElevationWeight:{type:"accessor",value:1},elevationAggregation:"SUM",elevationLowerPercentile:{type:"number",value:0,min:0,max:100},elevationUpperPercentile:{type:"number",value:100,min:0,max:100},elevationScale:{type:"number",min:0,value:1},elevationScaleType:"linear",onSetElevationDomain:Nt,radius:{type:"number",value:1e3,min:1},coverage:{type:"number",min:0,max:1,value:1},extruded:!1,hexagonAggregator:function(t,e){const{data:n,radius:r}=t,{viewport:o,attributes:s}=e,a=n.length?function(t,e){const{attributes:n}=e,r=n.positions.value,{size:i}=n.positions.getAccessor();let o,s=1/0,a=1/0,l=-1/0,u=-1/0;for(o=0;o<i*t.length;o+=i){const t=r[o],e=r[o+1];Number.isFinite(t)&&Number.isFinite(e)&&(s=Math.min(t,s),l=Math.max(t,l),a=Math.min(e,a),u=Math.max(e,u))}return[s,a,l,u].every(Number.isFinite)?[(s+l)/2,(a+u)/2]:null}(n,e):null,l=function(t,e,n){const{unitsPerMeter:r}=e.getDistanceScales(n);return t*r[0]}(r,o,a),u=[],{iterable:c,objectInfo:h}=(0,ft.X)(n),d=s.positions.value,{size:f}=s.positions.getAccessor();for(const t of c){h.index++;const e=h.index*f,n=[d[e],d[e+1]];Number.isFinite(n[0])&&Number.isFinite(n[1])?u.push({screenCoord:o.projectFlat(n),source:t,index:h.index}):i.A.warn("HexagonLayer: invalid position")()}return{hexagons:(0,Ft.n)().radius(l).x((t=>t.screenCoord[0])).y((t=>t.screenCoord[1]))(u).map(((t,e)=>({position:o.unprojectFlat([t.x,t.y]),points:t,index:e}))),radiusCommon:l}},getPosition:{type:"accessor",value:t=>t.position},material:!0,_filterData:{type:"function",value:null,optional:!0}};class Gt extends K{constructor(...t){super(...t),(0,r.A)(this,"state",void 0)}initializeState(){const t=new Rt({getAggregator:t=>t.hexagonAggregator,getCellSize:t=>t.radius});this.state={cpuAggregator:t,aggregatorState:t.state,vertices:null},this.getAttributeManager().add({positions:{size:3,type:5130,accessor:"getPosition"}})}updateState(t){if(super.updateState(t),t.changeFlags.propsOrDataChanged){const e=this.state.cpuAggregator.updateState(t,{viewport:this.context.viewport,attributes:this.getAttributes()});if(this.state.aggregatorState.layerData!==e.layerData){const{hexagonVertices:t}=e.layerData||{};this.setState({vertices:t&&this.convertLatLngToMeterOffset(t)})}this.setState({aggregatorState:e})}}convertLatLngToMeterOffset(t){const{viewport:e}=this.context;if(Array.isArray(t)&&6===t.length){const n=t[0],r=t[3],i=[(n[0]+r[0])/2,(n[1]+r[1])/2],o=e.projectFlat(i),{metersPerUnit:s}=e.getDistanceScales(i);return t.map((t=>{const n=e.projectFlat(t);return[(n[0]-o[0])*s[0],(n[1]-o[1])*s[1]]}))}return i.A.error("HexagonLayer: hexagonVertices needs to be an array of 6 points")(),null}getPickingInfo({info:t}){return this.state.cpuAggregator.getPickingInfo({info:t})}_onGetSublayerColor(t){return this.state.cpuAggregator.getAccessor("fillColor")(t)}_onGetSublayerElevation(t){return this.state.cpuAggregator.getAccessor("elevation")(t)}_getSublayerUpdateTriggers(){return this.state.cpuAggregator.getUpdateTriggers(this.props)}renderLayers(){const{elevationScale:t,extruded:e,coverage:n,material:r,transitions:i}=this.props,{aggregatorState:o,vertices:s}=this.state,a=this.getSubLayerClass("hexagon-cell",Dt.A),l=this._getSublayerUpdateTriggers();return new a({...s?{vertices:s,radius:1}:{radius:o.layerData.radiusCommon||1,radiusUnits:"common",angle:90},diskResolution:6,elevationScale:t,extruded:e,coverage:n,material:r,getFillColor:this._onGetSublayerColor.bind(this),getElevation:this._onGetSublayerElevation.bind(this),transitions:i&&{getFillColor:i.getColorValue||i.getColorWeight,getElevation:i.getElevationValue||i.getElevationWeight}},this.getSubLayerProps({id:"hexagon-cell",updateTriggers:l}),{data:o.layerData.data})}}(0,r.A)(Gt,"layerName","HexagonLayer"),(0,r.A)(Gt,"defaultProps",jt);var Ut=n(11805),zt=n(58534);const Vt=.5,Ht=1/6,qt={N:[0,Vt],E:[Vt,0],S:[0,-.5],W:[-.5,0],NE:[Vt,Vt],NW:[-.5,Vt],SE:[Vt,-.5],SW:[-.5,-.5]},Wt=[qt.W,qt.SW,qt.S],Jt=[qt.S,qt.SE,qt.E],Yt=[qt.E,qt.NE,qt.N],Xt=[qt.NW,qt.W,qt.N],Kt=[[-.5,Ht],[-.5,-Ht],[-Ht,-.5],[Ht,-.5]],Zt=[[-Ht,-.5],[Ht,-.5],[Vt,-Ht],[Vt,Ht]],Qt=[[Vt,-Ht],[Vt,Ht],[Ht,Vt],[-Ht,Vt]],$t=[[-.5,Ht],[-.5,-Ht],[Ht,Vt],[-Ht,Vt]],te=[qt.W,qt.SW,qt.SE,qt.E],ee=[qt.S,qt.SE,qt.NE,qt.N],ne=[qt.NW,qt.W,qt.E,qt.NE],re=[qt.NW,qt.SW,qt.S,qt.N],ie=[[-.5,Ht],[-.5,-Ht],[Vt,-Ht],[Vt,Ht]],oe=[[-Ht,-.5],[Ht,-.5],[Ht,Vt],[-Ht,Vt]],se=[qt.NW,qt.SW,qt.SE,qt.NE],ae=[qt.NW,qt.SW,qt.SE,qt.E,qt.N],le=[qt.W,qt.SW,qt.SE,qt.NE,qt.N],ue=[qt.NW,qt.W,qt.S,qt.SE,qt.NE],ce=[qt.NW,qt.SW,qt.S,qt.E,qt.NE],he=[qt.NW,qt.W,[Vt,-Ht],[Vt,Ht],qt.N],de=[[-Ht,-.5],[Ht,-.5],qt.E,qt.NE,qt.N],fe=[[-.5,Ht],[-.5,-Ht],qt.S,qt.SE,qt.E],pe=[qt.W,qt.SW,qt.S,[Ht,Vt],[-Ht,Vt]],ge=[qt.NW,qt.W,[-Ht,-.5],[Ht,-.5],qt.N],ye=[[-.5,Ht],[-.5,-Ht],qt.E,qt.NE,qt.N],me=[qt.S,qt.SE,qt.E,[Ht,Vt],[-Ht,Vt]],ve=[qt.W,qt.SW,qt.S,[Vt,-Ht],[Vt,Ht]],be=[qt.W,qt.SW,qt.SE,qt.E,[Ht,Vt],[-Ht,Vt]],_e=[[-.5,Ht],[-.5,-Ht],qt.S,qt.SE,qt.NE,qt.N],Ae=[qt.NW,qt.W,[-Ht,-.5],[Ht,-.5],qt.E,qt.NE],xe=[qt.NW,qt.SW,qt.S,[Vt,-Ht],[Vt,Ht],qt.N],we=[qt.W,qt.SW,qt.S,qt.E,qt.NE,qt.N],Ce=[qt.NW,qt.W,qt.S,qt.SE,qt.E,qt.N],Se=[[-.5,Ht],[-.5,-Ht],[-Ht,-.5],[Ht,-.5],qt.E,qt.NE,qt.N],Ee=[qt.W,qt.SW,qt.S,[Vt,-Ht],[Vt,Ht],[Ht,Vt],[-Ht,Vt]],Me=[qt.NW,qt.W,[-Ht,-.5],[Ht,-.5],[Vt,-Ht],[Vt,Ht],qt.N],Pe=[[-.5,Ht],[-.5,-Ht],qt.S,qt.SE,qt.E,[Ht,Vt],[-Ht,Vt]],Te=[[-.5,Ht],[-.5,-Ht],[-Ht,-.5],[Ht,-.5],[Vt,-Ht],[Vt,Ht],[Ht,Vt],[-Ht,Vt]],Oe={0:[],1:[[qt.W,qt.S]],2:[[qt.S,qt.E]],3:[[qt.W,qt.E]],4:[[qt.N,qt.E]],5:{0:[[qt.W,qt.S],[qt.N,qt.E]],1:[[qt.W,qt.N],[qt.S,qt.E]]},6:[[qt.N,qt.S]],7:[[qt.W,qt.N]],8:[[qt.W,qt.N]],9:[[qt.N,qt.S]],10:{0:[[qt.W,qt.N],[qt.S,qt.E]],1:[[qt.W,qt.S],[qt.N,qt.E]]},11:[[qt.N,qt.E]],12:[[qt.W,qt.E]],13:[[qt.S,qt.E]],14:[[qt.W,qt.S]],15:[]};function Ie(t){return parseInt(t,4)}const Re={[Ie("0000")]:[],[Ie("2222")]:[],[Ie("2221")]:[Wt],[Ie("2212")]:[Jt],[Ie("2122")]:[Yt],[Ie("1222")]:[Xt],[Ie("0001")]:[Wt],[Ie("0010")]:[Jt],[Ie("0100")]:[Yt],[Ie("1000")]:[Xt],[Ie("2220")]:[Kt],[Ie("2202")]:[Zt],[Ie("2022")]:[Qt],[Ie("0222")]:[$t],[Ie("0002")]:[Kt],[Ie("0020")]:[Zt],[Ie("0200")]:[Qt],[Ie("2000")]:[$t],[Ie("0011")]:[te],[Ie("0110")]:[ee],[Ie("1100")]:[ne],[Ie("1001")]:[re],[Ie("2211")]:[te],[Ie("2112")]:[ee],[Ie("1122")]:[ne],[Ie("1221")]:[re],[Ie("2200")]:[ie],[Ie("2002")]:[oe],[Ie("0022")]:[ie],[Ie("0220")]:[oe],[Ie("1111")]:[se],[Ie("1211")]:[ae],[Ie("2111")]:[le],[Ie("1112")]:[ue],[Ie("1121")]:[ce],[Ie("1011")]:[ae],[Ie("0111")]:[le],[Ie("1110")]:[ue],[Ie("1101")]:[ce],[Ie("1200")]:[he],[Ie("0120")]:[de],[Ie("0012")]:[fe],[Ie("2001")]:[pe],[Ie("1022")]:[he],[Ie("2102")]:[de],[Ie("2210")]:[fe],[Ie("0221")]:[pe],[Ie("1002")]:[ge],[Ie("2100")]:[ye],[Ie("0210")]:[me],[Ie("0021")]:[ve],[Ie("1220")]:[ge],[Ie("0122")]:[ye],[Ie("2012")]:[me],[Ie("2201")]:[ve],[Ie("0211")]:[be],[Ie("2110")]:[_e],[Ie("1102")]:[Ae],[Ie("1021")]:[xe],[Ie("2011")]:[be],[Ie("0112")]:[_e],[Ie("1120")]:[Ae],[Ie("1201")]:[xe],[Ie("2101")]:[we],[Ie("0121")]:[we],[Ie("1012")]:[Ce],[Ie("1210")]:[Ce],[Ie("0101")]:{0:[Wt,Yt],1:[we],2:[we]},[Ie("1010")]:{0:[Xt,Jt],1:[Ce],2:[Ce]},[Ie("2121")]:{0:[we],1:[we],2:[Wt,Yt]},[Ie("1212")]:{0:[Ce],1:[Ce],2:[Xt,Jt]},[Ie("2120")]:{0:[Se],1:[Se],2:[Kt,Yt]},[Ie("2021")]:{0:[Ee],1:[Ee],2:[Wt,Qt]},[Ie("1202")]:{0:[Me],1:[Me],2:[Xt,Zt]},[Ie("0212")]:{0:[Pe],1:[Pe],2:[Jt,$t]},[Ie("0102")]:{0:[Kt,Yt],1:[Se],2:[Se]},[Ie("0201")]:{0:[Wt,Qt],1:[Ee],2:[Ee]},[Ie("1020")]:{0:[Xt,Zt],1:[Me],2:[Me]},[Ie("2010")]:{0:[Jt,$t],1:[Pe],2:[Pe]},[Ie("2020")]:{0:[$t,Zt],1:[Te],2:[Kt,Qt]},[Ie("0202")]:{0:[Qt,Kt],1:[Te],2:[$t,Zt]}},Be={ISO_LINES:1,ISO_BANDS:2},Le={zIndex:0,zOffset:.005};function ke(t,e){return Array.isArray(e)?t<e[0]?0:t<e[1]?1:2:t>=e?1:0}function De(t){const{cellWeights:e,x:n,y:r,width:o,height:s}=t;let a=t.threshold;t.thresholdValue&&(i.A.deprecated("thresholdValue","threshold")(),a=t.thresholdValue);const l=n<0,u=n>=o-1,c=r<0,h=r>=s-1,d=l||u||c||h,f={},p={};l||h?p.top=0:(f.top=e[(r+1)*o+n],p.top=ke(f.top,a)),u||h?p.topRight=0:(f.topRight=e[(r+1)*o+n+1],p.topRight=ke(f.topRight,a)),u||c?p.right=0:(f.right=e[r*o+n+1],p.right=ke(f.right,a)),l||c?p.current=0:(f.current=e[r*o+n],p.current=ke(f.current,a));const{top:g,topRight:y,right:m,current:v}=p;let b=-1;Number.isFinite(a)&&(b=g<<3|y<<2|m<<1|v),Array.isArray(a)&&(b=g<<6|y<<4|m<<2|v);let _=0;return d||(_=ke((f.top+f.topRight+f.right+f.current)/4,a)),{code:b,meanCode:_}}function Fe(t){const{gridOrigin:e,cellSize:n,x:r,y:i,code:o,meanCode:s,type:a=Be.ISO_LINES}=t,l={...Le,...t.thresholdData};let u=a===Be.ISO_BANDS?Re[o]:Oe[o];Array.isArray(u)||(u=u[s]);const c=l.zIndex*l.zOffset,h=(r+1)*n[0],d=(i+1)*n[1],f=e[0]+h,p=e[1]+d;if(a===Be.ISO_BANDS){const t=[];return u.forEach((e=>{const r=[];e.forEach((t=>{const e=f+t[0]*n[0],i=p+t[1]*n[1];r.push([e,i,c])})),t.push(r)})),t}const g=[];return u.forEach((t=>{t.forEach((t=>{const e=f+t[0]*n[0],r=p+t[1]*n[1];g.push([e,r,c])}))})),g}const Ne=[255,255,255,255],je="positions",Ge={data:{props:["cellSize"]},weights:{props:["aggregation"],accessors:["getWeight"]}};class Ue extends xt{initializeState(){super.initializeAggregationLayer({dimensions:Ge}),this.setState({contourData:{},projectPoints:!1,weights:{count:{size:1,operation:p.SUM}}}),this.getAttributeManager().add({[je]:{size:3,accessor:"getPosition",type:5130,fp64:this.use64bitPositions()},count:{size:3,accessor:"getWeight"}})}updateState(t){super.updateState(t);let e=!1;const{oldProps:n,props:r}=t,{aggregationDirty:i}=this.state;n.contours===r.contours&&n.zOffset===r.zOffset||(e=!0,this._updateThresholdData(t.props)),this.getNumInstances()>0&&(i||e)&&this._generateContours()}renderLayers(){const{contourSegments:t,contourPolygons:e}=this.state.contourData,n=this.getSubLayerClass("lines",Ut.A),r=this.getSubLayerClass("bands",zt.A);return[t&&t.length>0&&new n(this.getSubLayerProps({id:"lines"}),{data:this.state.contourData.contourSegments,getSourcePosition:t=>t.start,getTargetPosition:t=>t.end,getColor:t=>t.contour.color||Ne,getWidth:t=>t.contour.strokeWidth||1}),e&&e.length>0&&new r(this.getSubLayerProps({id:"bands"}),{data:this.state.contourData.contourPolygons,getPolygon:t=>t.vertices,getFillColor:t=>t.contour.color||Ne})]}updateAggregationState(t){const{props:e,oldProps:n}=t,{cellSize:r,coordinateSystem:o}=e,{viewport:s}=this.context,a=n.cellSize!==r;let l=e.gpuAggregation;this.state.gpuAggregation!==e.gpuAggregation&&l&&!k.isSupported(this.context.gl)&&(i.A.warn("GPU Grid Aggregation not supported, falling back to CPU")(),l=!1);const u=l!==this.state.gpuAggregation;this.setState({gpuAggregation:l});const{dimensions:c}=this.state,h=this.isAttributeChanged(je),{data:d,weights:f}=c;let{boundingBox:p}=this.state;if(h&&(p=mt(this.getAttributes(),this.getNumInstances()),this.setState({boundingBox:p})),h||a){const{gridOffset:t,translation:e,width:n,height:i,numCol:a,numRow:l}=_t(p,r,s,o);this.allocateResources(l,a),this.setState({gridOffset:t,boundingBox:p,translation:e,posOffset:e.slice(),gridOrigin:[-1*e[0],-1*e[1]],width:n,height:i,numCol:a,numRow:l})}const g=h||u||this.isAggregationDirty(t,{dimension:d,compareAll:l}),y=this.isAggregationDirty(t,{dimension:f});y&&this._updateAccessors(t),(g||y)&&this._resetResults(),this.setState({aggregationDataDirty:g,aggregationWeightsDirty:y})}_updateAccessors(t){const{getWeight:e,aggregation:n,data:r}=t.props,{count:i}=this.state.weights;i&&(i.getWeight=e,i.operation=p[n]),this.setState({getValue:v(n,e,{data:r})})}_resetResults(){const{count:t}=this.state.weights;t&&(t.aggregationData=null)}_generateContours(){const{numCol:t,numRow:e,gridOrigin:n,gridOffset:r,thresholdData:i}=this.state,{count:o}=this.state.weights;let{aggregationData:s}=o;s||(s=o.aggregationBuffer.getData(),o.aggregationData=s);const{cellWeights:a}=k.getCellData({countsData:s}),l=function({thresholdData:t,cellWeights:e,gridSize:n,gridOrigin:r,cellSize:i}){const o=[],s=[],a=n[0],l=n[1];let u=0,c=0;for(const n of t){const{contour:t}=n,{threshold:h}=t;for(let d=-1;d<a;d++)for(let f=-1;f<l;f++){const{code:p,meanCode:g}=De({cellWeights:e,threshold:h,x:d,y:f,width:a,height:l}),y={type:Be.ISO_BANDS,gridOrigin:r,cellSize:i,x:d,y:f,width:a,height:l,code:p,meanCode:g,thresholdData:n};if(Array.isArray(h)){y.type=Be.ISO_BANDS;const e=Fe(y);for(const n of e)s[c++]={vertices:n,contour:t}}else{y.type=Be.ISO_LINES;const e=Fe(y);for(let n=0;n<e.length;n+=2)o[u++]={start:e[n],end:e[n+1],contour:t}}}}return{contourSegments:o,contourPolygons:s}}({thresholdData:i,cellWeights:a,gridSize:[t,e],gridOrigin:n,cellSize:[r.xOffset,r.yOffset]});this.setState({contourData:l})}_updateThresholdData(t){const{contours:e,zOffset:n}=t,r=e.length,i=new Array(r);for(let t=0;t<r;t++){const r=e[t];i[t]={contour:r,zIndex:r.zIndex||t,zOffset:n}}this.setState({thresholdData:i})}}(0,r.A)(Ue,"layerName","ContourLayer"),(0,r.A)(Ue,"defaultProps",{cellSize:{type:"number",min:1,max:1e3,value:1e3},getPosition:{type:"accessor",value:t=>t.position},getWeight:{type:"accessor",value:1},gpuAggregation:!0,aggregation:"SUM",contours:{type:"object",value:[{threshold:1}],optional:!0,compare:3},zOffset:.005});var ze=n(44123),Ve=n(51682),He=n(4992);const qe={colorDomain:null,colorRange:j,elevationDomain:null,elevationRange:[0,1e3],elevationScale:{type:"number",min:0,value:1},gridSize:{type:"array",value:[1,1]},gridOrigin:{type:"array",value:[0,0]},gridOffset:{type:"array",value:[0,0]},cellSize:{type:"number",min:0,max:1e3,value:1e3},offset:{type:"array",value:[1,1]},coverage:{type:"number",min:0,max:1,value:1},extruded:!0,material:!0};class We extends F.A{getShaders(){return super.getShaders({vs:"#version 300 es\n#define SHADER_NAME gpu-grid-cell-layer-vertex-shader\n#define RANGE_COUNT 6\n\nin vec3 positions;\nin vec3 normals;\n\nin vec4 colors;\nin vec4 elevations;\nin vec3 instancePickingColors;\nuniform vec2 offset;\nuniform bool extruded;\nuniform float cellSize;\nuniform float coverage;\nuniform float opacity;\nuniform float elevationScale;\n\nuniform ivec2 gridSize;\nuniform vec2 gridOrigin;\nuniform vec2 gridOriginLow;\nuniform vec2 gridOffset;\nuniform vec2 gridOffsetLow;\nuniform vec4 colorRange[RANGE_COUNT];\nuniform vec2 elevationRange;\nuniform vec2 colorDomain;\nuniform bool colorDomainValid;\nuniform vec2 elevationDomain;\nuniform bool elevationDomainValid;\n\nlayout(std140) uniform;\nuniform ColorData\n{\n  vec4 maxMinCount;\n} colorData;\nuniform ElevationData\n{\n  vec4 maxMinCount;\n} elevationData;\n\n#define EPSILON 0.00001\nout vec4 vColor;\n\nvec4 quantizeScale(vec2 domain, vec4 range[RANGE_COUNT], float value) {\n  vec4 outColor = vec4(0., 0., 0., 0.);\n  if (value >= (domain.x - EPSILON) && value <= (domain.y + EPSILON)) {\n    float domainRange = domain.y - domain.x;\n    if (domainRange <= 0.) {\n      outColor = colorRange[0];\n    } else {\n      float rangeCount = float(RANGE_COUNT);\n      float rangeStep = domainRange / rangeCount;\n      float idx = floor((value - domain.x) / rangeStep);\n      idx = clamp(idx, 0., rangeCount - 1.);\n      int intIdx = int(idx);\n      outColor = colorRange[intIdx];\n    }\n  }\n  return outColor;\n}\n\nfloat linearScale(vec2 domain, vec2 range, float value) {\n  if (value >= (domain.x - EPSILON) && value <= (domain.y + EPSILON)) {\n    return ((value - domain.x) / (domain.y - domain.x)) * (range.y - range.x) + range.x;\n  }\n  return -1.;\n}\n\nvoid main(void) {\n  vec2 clrDomain = colorDomainValid ? colorDomain : vec2(colorData.maxMinCount.a, colorData.maxMinCount.r);\n  vec4 color = quantizeScale(clrDomain, colorRange, colors.r);\n\n  float elevation = 0.0;\n\n  if (extruded) {\n    vec2 elvDomain = elevationDomainValid ? elevationDomain : vec2(elevationData.maxMinCount.a, elevationData.maxMinCount.r);\n    elevation = linearScale(elvDomain, elevationRange, elevations.r);\n    elevation = elevation  * (positions.z + 1.0) / 2.0 * elevationScale;\n  }\n  float shouldRender = float(color.r > 0.0 && elevations.r >= 0.0);\n  float dotRadius = cellSize / 2. * coverage * shouldRender;\n\n  int yIndex = (gl_InstanceID / gridSize[0]);\n  int xIndex = gl_InstanceID - (yIndex * gridSize[0]);\n\n  vec2 instancePositionXFP64 = mul_fp64(vec2(gridOffset[0], gridOffsetLow[0]), vec2(float(xIndex), 0.));\n  instancePositionXFP64 = sum_fp64(instancePositionXFP64, vec2(gridOrigin[0], gridOriginLow[0]));\n  vec2 instancePositionYFP64 = mul_fp64(vec2(gridOffset[1], gridOffsetLow[1]), vec2(float(yIndex), 0.));\n  instancePositionYFP64 = sum_fp64(instancePositionYFP64, vec2(gridOrigin[1], gridOriginLow[1]));\n\n  vec3 centroidPosition = vec3(instancePositionXFP64[0], instancePositionYFP64[0], elevation);\n  vec3 centroidPosition64Low = vec3(instancePositionXFP64[1], instancePositionYFP64[1], 0.0);\n  geometry.worldPosition = centroidPosition;\n  vec3 pos = vec3(project_size(positions.xy + offset) * dotRadius, 0.);\n  picking_setPickingColor(instancePickingColors);\n\n  gl_Position = project_position_to_clipspace(centroidPosition, centroidPosition64Low, pos, geometry.position);\n\n  vec3 normals_commonspace = project_normal(normals);\n\n   if (extruded) {\n    vec3 lightColor = lighting_getLightColor(color.rgb, project_uCameraPosition, geometry.position.xyz, normals_commonspace);\n    vColor = vec4(lightColor, color.a * opacity) / 255.;\n  } else {\n    vColor = vec4(color.rgb, color.a * opacity) / 255.;\n  }\n}\n",fs:"#version 300 es\n#define SHADER_NAME gpu-grid-cell-layer-fragment-shader\n\nprecision highp float;\n\nin vec4 vColor;\n\nout vec4 fragColor;\n\nvoid main(void) {\n  fragColor = vColor;\n  fragColor = picking_filterColor(fragColor);\n}\n",modules:[f.A,ze.K,N.A,h.dI]})}initializeState({gl:t}){this.getAttributeManager().addInstanced({colors:{size:4,noAlloc:!0},elevations:{size:4,noAlloc:!0}});const e=this._getModel(t);this._setupUniformBuffer(e),this.setState({model:e})}_getModel(t){return new u.A(t,{...this.getShaders(),id:this.props.id,geometry:new He.A,isInstanced:!0})}draw({uniforms:t}){const{cellSize:e,offset:n,extruded:r,elevationScale:i,coverage:o,gridSize:s,gridOrigin:a,gridOffset:l,elevationRange:u,colorMaxMinBuffer:c,elevationMaxMinBuffer:h}=this.props,d=[(0,Ve.qk)(a[0]),(0,Ve.qk)(a[1])],f=[(0,Ve.qk)(l[0]),(0,Ve.qk)(l[1])],p=this.getDomainUniforms(),g=G(this.props.colorRange);this.bindUniformBuffers(c,h),this.state.model.setUniforms(t).setUniforms(p).setUniforms({cellSize:e,offset:n,extruded:r,elevationScale:i,coverage:o,gridSize:s,gridOrigin:a,gridOriginLow:d,gridOffset:l,gridOffsetLow:f,colorRange:g,elevationRange:u}).draw(),this.unbindUniformBuffers(c,h)}bindUniformBuffers(t,e){t.bind({target:35345,index:0}),e.bind({target:35345,index:1})}unbindUniformBuffers(t,e){t.unbind({target:35345,index:0}),e.unbind({target:35345,index:1})}getDomainUniforms(){const{colorDomain:t,elevationDomain:e}=this.props,n={};return null!==t?(n.colorDomainValid=!0,n.colorDomain=t):n.colorDomainValid=!1,null!==e?(n.elevationDomainValid=!0,n.elevationDomain=e):n.elevationDomainValid=!1,n}_setupUniformBuffer(t){const e=this.context.gl,n=t.program.handle,r=e.getUniformBlockIndex(n,"ColorData"),i=e.getUniformBlockIndex(n,"ElevationData");e.uniformBlockBinding(n,r,0),e.uniformBlockBinding(n,i,1)}}(0,r.A)(We,"layerName","GPUGridCellLayer"),(0,r.A)(We,"defaultProps",qe);const Je={colorDomain:null,colorRange:j,getColorWeight:{type:"accessor",value:1},colorAggregation:"SUM",elevationDomain:null,elevationRange:[0,1e3],getElevationWeight:{type:"accessor",value:1},elevationAggregation:"SUM",elevationScale:{type:"number",min:0,value:1},cellSize:{type:"number",min:1,max:1e3,value:1e3},coverage:{type:"number",min:0,max:1,value:1},getPosition:{type:"accessor",value:t=>t.position},extruded:!1,material:!0},Ye={data:{props:["cellSize","colorAggregation","elevationAggregation"]}},Xe="positions";class Ke extends xt{initializeState({gl:t}){const e=k.isSupported(t);e||i.A.error("GPUGridLayer is not supported on this browser, use GridLayer instead")(),super.initializeAggregationLayer({dimensions:Ye}),this.setState({gpuAggregation:!0,projectPoints:!1,isSupported:e,weights:{color:{needMin:!0,needMax:!0,combineMaxMin:!0,maxMinBuffer:new Z.A(t,{byteLength:16,accessor:{size:4,type:5126,divisor:1}})},elevation:{needMin:!0,needMax:!0,combineMaxMin:!0,maxMinBuffer:new Z.A(t,{byteLength:16,accessor:{size:4,type:5126,divisor:1}})}},positionAttributeName:"positions"}),this.getAttributeManager().add({[Xe]:{size:3,accessor:"getPosition",type:5130,fp64:this.use64bitPositions()},color:{size:3,accessor:"getColorWeight"},elevation:{size:3,accessor:"getElevationWeight"}})}updateState(t){if(!1===this.state.isSupported)return;super.updateState(t);const{aggregationDirty:e}=this.state;e&&this.setState({gridHash:null})}getHashKeyForIndex(t){const{numRow:e,numCol:n,boundingBox:r,gridOffset:i}=this.state,o=[n,e],s=[r.xMin,r.yMin],a=[i.xOffset,i.yOffset],l=Math.floor(t/o[0]),u=t-l*o[0],c=Math.floor((l*a[1]+s[1]+90+a[1]/2)/a[1]),h=Math.floor((u*a[0]+s[0]+180+a[0]/2)/a[0]);return"".concat(c,"-").concat(h)}getPositionForIndex(t){const{numRow:e,numCol:n,boundingBox:r,gridOffset:i}=this.state,o=[n,e],s=[r.xMin,r.yMin],a=[i.xOffset,i.yOffset],l=Math.floor(t/o[0]);return[(t-l*o[0])*a[0]+s[0],l*a[1]+s[1]]}getPickingInfo({info:t,mode:e}){const{index:n}=t;let r=null;if(n>=0){const{gpuGridAggregator:t}=this.state,i=this.getPositionForIndex(n),o=k.getAggregationData({pixelIndex:n,...t.getData("color")}),s=k.getAggregationData({pixelIndex:n,...t.getData("elevation")});if(r={colorValue:o.cellWeight,elevationValue:s.cellWeight,count:o.cellCount||s.cellCount,position:i,totalCount:o.totalCount||s.totalCount},"hover"!==e){const{props:t}=this;let{gridHash:e}=this.state;if(!e){const{gridOffset:n,translation:r,boundingBox:i}=this.state,{viewport:o}=this.context;e=At(t,{gridOffset:n,attributes:this.getAttributes(),viewport:o,translation:r,boundingBox:i}).gridHash,this.setState({gridHash:e})}const i=e[this.getHashKeyForIndex(n)];Object.assign(r,i)}}return t.picked=Boolean(r),t.object=r,t}renderLayers(){if(!this.state.isSupported)return null;const{elevationScale:t,extruded:e,cellSize:n,coverage:r,material:i,elevationRange:o,colorDomain:s,elevationDomain:a}=this.props,{weights:l,numRow:u,numCol:c,gridOrigin:h,gridOffset:d}=this.state,{color:f,elevation:p}=l,g=G(this.props.colorRange);return new(this.getSubLayerClass("gpu-grid-cell",We))({gridSize:[c,u],gridOrigin:h,gridOffset:[d.xOffset,d.yOffset],colorRange:g,elevationRange:o,colorDomain:s,elevationDomain:a,cellSize:n,coverage:r,material:i,elevationScale:t,extruded:e},this.getSubLayerProps({id:"gpu-grid-cell"}),{data:{attributes:{colors:f.aggregationBuffer,elevations:p.aggregationBuffer}},colorMaxMinBuffer:f.maxMinBuffer,elevationMaxMinBuffer:p.maxMinBuffer,numInstances:c*u})}finalizeState(t){const{color:e,elevation:n}=this.state.weights;[e,n].forEach((t=>{const{aggregationBuffer:e,maxMinBuffer:n}=t;n.delete(),null==e||e.delete()})),super.finalizeState(t)}updateAggregationState(t){const{props:e,oldProps:n}=t,{cellSize:r,coordinateSystem:i}=e,{viewport:o}=this.context,s=n.cellSize!==r,{dimensions:a}=this.state,l=this.isAttributeChanged(Xe),u=l||this.isAttributeChanged();let{boundingBox:c}=this.state;if(l&&(c=mt(this.getAttributes(),this.getNumInstances()),this.setState({boundingBox:c})),l||s){const{gridOffset:t,translation:e,width:n,height:s,numCol:a,numRow:l}=_t(c,r,o,i);this.allocateResources(l,a),this.setState({gridOffset:t,translation:e,gridOrigin:[-1*e[0],-1*e[1]],width:n,height:s,numCol:a,numRow:l})}const h=u||this.isAggregationDirty(t,{dimension:a.data,compareAll:!0});h&&this._updateAccessors(t),this.setState({aggregationDataDirty:h})}_updateAccessors(t){const{colorAggregation:e,elevationAggregation:n}=t.props,{color:r,elevation:i}=this.state.weights;r.operation=p[e],i.operation=p[n]}}(0,r.A)(Ke,"layerName","GPUGridLayer"),(0,r.A)(Ke,"defaultProps",Je);const Ze={...Ke.defaultProps,...kt.defaultProps,gpuAggregation:!1};class Qe extends W.A{constructor(...t){super(...t),(0,r.A)(this,"state",void 0)}initializeState(){this.state={useGPUAggregation:!0}}updateState({props:t}){this.setState({useGPUAggregation:this.canUseGPUAggregation(t)})}renderLayers(){const{data:t,updateTriggers:e}=this.props,n=this.state.useGPUAggregation?"GPU":"CPU";return new(this.state.useGPUAggregation?this.getSubLayerClass("GPU",Ke):this.getSubLayerClass("CPU",kt))(this.props,this.getSubLayerProps({id:n,updateTriggers:e}),{data:t})}canUseGPUAggregation(t){const{gpuAggregation:e,lowerPercentile:n,upperPercentile:r,getColorValue:i,getElevationValue:o,colorScaleType:s}=t;return!!e&&!!k.isSupported(this.context.gl)&&0===n&&100===r&&null===i&&null===o&&"quantile"!==s&&"ordinal"!==s}}(0,r.A)(Qe,"layerName","GridLayer"),(0,r.A)(Qe,"defaultProps",Ze);const $e=new Float32Array(12);function tn(t,e=2){let n=0;for(const r of t)for(let t=0;t<e;t++)$e[n++]=r[t]||0;return $e}class en extends F.A{getShaders(){return{vs:"#define SHADER_NAME heatp-map-layer-vertex-shader\n\nuniform sampler2D maxTexture;\nuniform float intensity;\nuniform vec2 colorDomain;\nuniform float threshold;\nuniform float aggregationMode;\n\nattribute vec3 positions;\nattribute vec2 texCoords;\n\nvarying vec2 vTexCoords;\nvarying float vIntensityMin;\nvarying float vIntensityMax;\n\nvoid main(void) {\n  gl_Position = project_position_to_clipspace(positions, vec3(0.0), vec3(0.0));\n  vTexCoords = texCoords;\n  vec4 maxTexture = texture2D(maxTexture, vec2(0.5));\n  float maxValue = aggregationMode < 0.5 ? maxTexture.r : maxTexture.g;\n  float minValue = maxValue * threshold;\n  if (colorDomain[1] > 0.) {\n    maxValue = colorDomain[1];\n    minValue = colorDomain[0];\n  }\n  vIntensityMax = intensity / maxValue;\n  vIntensityMin = intensity / minValue;\n}\n",fs:"#define SHADER_NAME triangle-layer-fragment-shader\n\nprecision highp float;\n\nuniform float opacity;\nuniform sampler2D texture;\nuniform sampler2D colorTexture;\nuniform float aggregationMode;\n\nvarying vec2 vTexCoords;\nvarying float vIntensityMin;\nvarying float vIntensityMax;\n\nvec4 getLinearColor(float value) {\n  float factor = clamp(value * vIntensityMax, 0., 1.);\n  vec4 color = texture2D(colorTexture, vec2(factor, 0.5));\n  color.a *= min(value * vIntensityMin, 1.0);\n  return color;\n}\n\nvoid main(void) {\n  vec4 weights = texture2D(texture, vTexCoords);\n  float weight = weights.r;\n\n  if (aggregationMode > 0.5) {\n    weight /= max(1.0, weights.a);\n  }\n  if (weight <= 0.) {\n     discard;\n  }\n\n  vec4 linearColor = getLinearColor(weight);\n  linearColor.a *= opacity;\n  gl_FragColor =linearColor;\n}\n",modules:[f.A]}}initializeState({gl:t}){this.getAttributeManager().add({positions:{size:3,noAlloc:!0},texCoords:{size:2,noAlloc:!0}}),this.setState({model:this._getModel(t)})}_getModel(t){const{vertexCount:e}=this.props;return new u.A(t,{...this.getShaders(),id:this.props.id,geometry:new D.A({drawMode:6,vertexCount:e})})}draw({uniforms:t}){const{model:e}=this.state,{texture:n,maxTexture:r,colorTexture:i,intensity:o,threshold:s,aggregationMode:a,colorDomain:l}=this.props;e.setUniforms({...t,texture:n,maxTexture:r,colorTexture:i,intensity:o,threshold:s,aggregationMode:a,colorDomain:l}).draw()}}(0,r.A)(en,"layerName","TriangleLayer");const nn={mipmaps:!1,parameters:{10240:9729,10241:9729,10242:33071,10243:33071},dataFormat:6408},rn=[0,0],on={SUM:0,MEAN:1},sn={getPosition:{type:"accessor",value:t=>t.position},getWeight:{type:"accessor",value:1},intensity:{type:"number",min:0,value:1},radiusPixels:{type:"number",min:1,max:100,value:50},colorRange:j,threshold:{type:"number",min:0,max:1,value:.05},colorDomain:{type:"array",value:null,optional:!0},aggregation:"SUM",weightsTextureSize:{type:"number",min:128,max:2048,value:2048},debounceTimeout:{type:"number",min:0,max:1e3,value:500}},an=[o.G.BLEND_EQUATION_MINMAX,o.G.TEXTURE_FLOAT],ln=[o.G.COLOR_ATTACHMENT_RGBA32F,o.G.FLOAT_BLEND],un={data:{props:["radiusPixels"]}};class cn extends K{constructor(...t){super(...t),(0,r.A)(this,"state",void 0)}initializeState(){const{gl:t}=this.context;if(!(0,s.QN)(t,an))return this.setState({supported:!1}),void i.A.error("HeatmapLayer: ".concat(this.id," is not supported on this browser"))();super.initializeAggregationLayer(un),this.setState({supported:!0,colorDomain:rn}),this._setupTextureParams(),this._setupAttributes(),this._setupResources()}shouldUpdateState({changeFlags:t}){return t.somethingChanged}updateState(t){this.state.supported&&(super.updateState(t),this._updateHeatmapState(t))}_updateHeatmapState(t){const{props:e,oldProps:n}=t,r=this._getChangeFlags(t);(r.dataChanged||r.viewportChanged)&&(r.boundsChanged=this._updateBounds(r.dataChanged),this._updateTextureRenderingBounds()),r.dataChanged||r.boundsChanged?(clearTimeout(this.state.updateTimer),this.setState({isWeightMapDirty:!0})):r.viewportZoomChanged&&this._debouncedUpdateWeightmap(),e.colorRange!==n.colorRange&&this._updateColorTexture(t),this.state.isWeightMapDirty&&this._updateWeightmap(),this.setState({zoom:t.context.viewport.zoom})}renderLayers(){if(!this.state.supported)return[];const{weightsTexture:t,triPositionBuffer:e,triTexCoordBuffer:n,maxWeightsTexture:r,colorTexture:i,colorDomain:o}=this.state,{updateTriggers:s,intensity:a,threshold:l,aggregation:u}=this.props;return new(this.getSubLayerClass("triangle",en))(this.getSubLayerProps({id:"triangle-layer",updateTriggers:s}),{coordinateSystem:pt.rf.DEFAULT,data:{attributes:{positions:e,texCoords:n}},vertexCount:4,maxTexture:r,colorTexture:i,aggregationMode:on[u]||0,texture:t,intensity:a,threshold:l,colorDomain:o})}finalizeState(t){super.finalizeState(t);const{weightsTransform:e,weightsTexture:n,maxWeightTransform:r,maxWeightsTexture:i,triPositionBuffer:o,triTexCoordBuffer:s,colorTexture:a,updateTimer:l}=this.state;null==e||e.delete(),null==n||n.delete(),null==r||r.delete(),null==i||i.delete(),null==o||o.delete(),null==s||s.delete(),null==a||a.delete(),l&&clearTimeout(l)}_getAttributeManager(){return new Y.A(this.context.gl,{id:this.props.id,stats:this.context.stats})}_getChangeFlags(t){const e={},{dimensions:n}=this.state;e.dataChanged=this.isAttributeChanged()||this.isAggregationDirty(t,{compareAll:!0,dimension:n.data}),e.viewportChanged=t.changeFlags.viewportChanged;const{zoom:r}=this.state;return t.context.viewport&&t.context.viewport.zoom===r||(e.viewportZoomChanged=!0),e}_createTextures(){const{gl:t}=this.context,{textureSize:e,format:n,type:r}=this.state;this.setState({weightsTexture:new M.A(t,{width:e,height:e,format:n,type:r,...nn}),maxWeightsTexture:new M.A(t,{format:n,type:r,...nn})})}_setupAttributes(){this.getAttributeManager().add({positions:{size:3,type:5130,accessor:"getPosition"},weights:{size:1,accessor:"getWeight"}}),this.setState({positionAttributeName:"positions"})}_setupTextureParams(){const{gl:t}=this.context,{weightsTextureSize:e}=this.props,n=Math.min(e,(0,a.bQ)(t,3379)),r=(0,s.QN)(t,ln),{format:o,type:l}=function({gl:t,floatTargetSupport:e}){return e?{format:(0,a.C6)(t)?34836:6408,type:5126}:{format:6408,type:5121}}({gl:t,floatTargetSupport:r}),u=r?1:1/255;this.setState({textureSize:n,format:o,type:l,weightsScale:u}),r||i.A.warn("HeatmapLayer: ".concat(this.id," rendering to float texture not supported, fallingback to low precession format"))()}getShaders(t){return super.getShaders("max-weights-transform"===t?{vs:"attribute vec4 inTexture;\nvarying vec4 outTexture;\n\nvoid main()\n{\noutTexture = inTexture;\ngl_Position = vec4(0, 0, 0, 1.);\ngl_PointSize = 1.0;\n}\n",_fs:"varying vec4 outTexture;\nvoid main() {\n  gl_FragColor = outTexture;\n  gl_FragColor.g = outTexture.r / max(1.0, outTexture.a);\n}\n"}:{vs:"attribute vec3 positions;\nattribute vec3 positions64Low;\nattribute float weights;\nvarying vec4 weightsTexture;\nuniform float radiusPixels;\nuniform float textureWidth;\nuniform vec4 commonBounds;\nuniform float weightsScale;\nvoid main()\n{\n  weightsTexture = vec4(weights * weightsScale, 0., 0., 1.);\n\n  float radiusTexels  = project_pixel_size(radiusPixels) * textureWidth / (commonBounds.z - commonBounds.x);\n  gl_PointSize = radiusTexels * 2.;\n\n  vec3 commonPosition = project_position(positions, positions64Low);\n  gl_Position.xy = (commonPosition.xy - commonBounds.xy) / (commonBounds.zw - commonBounds.xy) ;\n  gl_Position.xy = (gl_Position.xy * 2.) - (1.);\n}\n",_fs:"varying vec4 weightsTexture;\nfloat gaussianKDE(float u){\n  return pow(2.71828, -u*u/0.05555)/(1.77245385*0.166666);\n}\nvoid main()\n{\n  float dist = length(gl_PointCoord - vec2(0.5, 0.5));\n  if (dist > 0.5) {\n    discard;\n  }\n  gl_FragColor = weightsTexture * gaussianKDE(2. * dist);\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n"})}_createWeightsTransform(t={}){var e;const{gl:n}=this.context;let{weightsTransform:r}=this.state;const{weightsTexture:i}=this.state;null===(e=r)||void 0===e||e.delete(),r=new c.A(n,{id:"".concat(this.id,"-weights-transform"),elementCount:1,_targetTexture:i,_targetTextureVarying:"weightsTexture",...t}),this.setState({weightsTransform:r})}_setupResources(){const{gl:t}=this.context;this._createTextures();const{textureSize:e,weightsTexture:n,maxWeightsTexture:r}=this.state,i=this.getShaders("weights-transform");this._createWeightsTransform(i);const o=this.getShaders("max-weights-transform"),s=new c.A(t,{id:"".concat(this.id,"-max-weights-transform"),_sourceTextures:{inTexture:n},_targetTexture:r,_targetTextureVarying:"outTexture",...o,elementCount:e*e});this.setState({weightsTexture:n,maxWeightsTexture:r,maxWeightTransform:s,zoom:null,triPositionBuffer:new Z.A(t,{byteLength:48,accessor:{size:3}}),triTexCoordBuffer:new Z.A(t,{byteLength:48,accessor:{size:2}})})}updateShaders(t){this._createWeightsTransform(t)}_updateMaxWeightValue(){const{maxWeightTransform:t}=this.state;t.run({parameters:{blend:!0,depthTest:!1,blendFunc:[1,1],blendEquation:32776}})}_updateBounds(t=!1){const{viewport:e}=this.context,n=[e.unproject([0,0]),e.unproject([e.width,0]),e.unproject([e.width,e.height]),e.unproject([0,e.height])].map((t=>t.map(Math.fround))),r=function(t){const e=t.map((t=>t[0])),n=t.map((t=>t[1])),r=Math.min.apply(null,e),i=Math.max.apply(null,e);return[r,Math.min.apply(null,n),i,Math.max.apply(null,n)]}(n),i={visibleWorldBounds:r,viewportCorners:n};let o=!1;if(t||!this.state.worldBounds||(s=this.state.worldBounds,!((a=r)[0]>=s[0]&&a[2]<=s[2]&&a[1]>=s[1]&&a[3]<=s[3]))){const t=this._worldToCommonBounds(r),e=this._commonToWorldBounds(t);this.props.coordinateSystem===pt.rf.LNGLAT&&(e[1]=Math.max(e[1],-85.051129),e[3]=Math.min(e[3],85.051129),e[0]=Math.max(e[0],-360),e[2]=Math.min(e[2],360));const n=this._worldToCommonBounds(e);i.worldBounds=e,i.normalizedCommonBounds=n,o=!0}var s,a;return this.setState(i),o}_updateTextureRenderingBounds(){const{triPositionBuffer:t,triTexCoordBuffer:e,normalizedCommonBounds:n,viewportCorners:r}=this.state,{viewport:i}=this.context;t.subData(tn(r,3));const o=r.map((t=>function(t,e){const[n,r,i,o]=e;return[(t[0]-n)/(i-n),(t[1]-r)/(o-r)]}(i.projectPosition(t),n)));e.subData(tn(o,2))}_updateColorTexture(t){const{colorRange:e}=t.props;let{colorTexture:n}=this.state;const r=G(e,!1,Uint8Array);n?n.setImageData({data:r,width:e.length}):n=new M.A(this.context.gl,{data:r,width:e.length,height:1,...nn}),this.setState({colorTexture:n})}_updateWeightmap(){const{radiusPixels:t,colorDomain:e,aggregation:n}=this.props,{weightsTransform:r,worldBounds:i,textureSize:o,weightsTexture:s,weightsScale:l}=this.state;this.state.isWeightMapDirty=!1;const u=this._worldToCommonBounds(i,{useLayerCoordinateSystem:!0});if(e&&"SUM"===n){const{viewport:t}=this.context,n=t.distanceScales.metersPerUnit[2]*(u[2]-u[0])/o;this.state.colorDomain=e.map((t=>t*n*l))}else this.state.colorDomain=e||rn;const c={radiusPixels:t,commonBounds:u,textureWidth:o,weightsScale:l};r.update({elementCount:this.getNumInstances()}),(0,a.zv)(this.context.gl,{clearColor:[0,0,0,0]},(()=>{r.run({uniforms:c,parameters:{blend:!0,depthTest:!1,blendFunc:[1,1],blendEquation:32774},clearRenderTarget:!0,attributes:this.getAttributes(),moduleSettings:this.getModuleSettings()})})),this._updateMaxWeightValue(),s.setParameters({10240:9729,10241:9729})}_debouncedUpdateWeightmap(t=!1){let{updateTimer:e}=this.state;const{debounceTimeout:n}=this.props;t?(e=null,this._updateBounds(!0),this._updateTextureRenderingBounds(),this.setState({isWeightMapDirty:!0})):(this.setState({isWeightMapDirty:!1}),clearTimeout(e),e=setTimeout(this._debouncedUpdateWeightmap.bind(this,!0),n)),this.setState({updateTimer:e})}_worldToCommonBounds(t,e={}){const{useLayerCoordinateSystem:n=!1}=e,[r,i,o,s]=t,{viewport:a}=this.context,{textureSize:l}=this.state,{coordinateSystem:u}=this.props,c=n&&(u===pt.rf.LNGLAT_OFFSETS||u===pt.rf.METER_OFFSETS),h=c?a.projectPosition(this.props.coordinateOrigin):[0,0],d=2*l/a.scale;let f,p;return n&&!c?(f=this.projectPosition([r,i,0]),p=this.projectPosition([o,s,0])):(f=a.projectPosition([r,i,0]),p=a.projectPosition([o,s,0])),function(t,e,n){const[r,i,o,s]=t,a=o-r,l=s-i;let u=a,c=l;a/l<e/n?u=e/n*l:c=n/e*a,u<e&&(u=e,c=n);const h=(o+r)/2,d=(s+i)/2;return[h-u/2,d-c/2,h+u/2,d+c/2]}([f[0]-h[0],f[1]-h[1],p[0]-h[0],p[1]-h[1]],d,d)}_commonToWorldBounds(t){const[e,n,r,i]=t,{viewport:o}=this.context,s=o.unprojectPosition([e,n]),a=o.unprojectPosition([r,i]);return s.slice(0,2).concat(a.slice(0,2))}}(0,r.A)(cn,"layerName","HeatmapLayer"),(0,r.A)(cn,"defaultProps",sn)},90544:(t,e,n)=>{"use strict";n.d(e,{A:()=>g});var r=n(67136),i=n(52473),o=n(71154);const s={transitionDuration:0},a=t=>1-(1-t)*(1-t),l=["wheel"],u=["panstart","panmove","panend"],c=["pinchstart","pinchmove","pinchend"],h=["tripanstart","tripanmove","tripanend"],d=["doubletap"],f=["keydown"],p={};class g{constructor(t){(0,r.A)(this,"props",void 0),(0,r.A)(this,"state",{}),(0,r.A)(this,"transitionManager",void 0),(0,r.A)(this,"eventManager",void 0),(0,r.A)(this,"onViewStateChange",void 0),(0,r.A)(this,"onStateChange",void 0),(0,r.A)(this,"makeViewport",void 0),(0,r.A)(this,"_controllerState",void 0),(0,r.A)(this,"_events",{}),(0,r.A)(this,"_interactionState",{isDragging:!1}),(0,r.A)(this,"_customEvents",[]),(0,r.A)(this,"_eventStartBlocked",null),(0,r.A)(this,"_panMove",!1),(0,r.A)(this,"invertPan",!1),(0,r.A)(this,"dragMode","rotate"),(0,r.A)(this,"inertia",0),(0,r.A)(this,"scrollZoom",!0),(0,r.A)(this,"dragPan",!0),(0,r.A)(this,"dragRotate",!0),(0,r.A)(this,"doubleClickZoom",!0),(0,r.A)(this,"touchZoom",!0),(0,r.A)(this,"touchRotate",!1),(0,r.A)(this,"keyboard",!0),this.transitionManager=new i.A({...t,getControllerState:t=>new this.ControllerState(t),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}),this.handleEvent=this.handleEvent.bind(this),this.eventManager=t.eventManager,this.onViewStateChange=t.onViewStateChange||(()=>{}),this.onStateChange=t.onStateChange||(()=>{}),this.makeViewport=t.makeViewport}set events(t){this.toggleEvents(this._customEvents,!1),this.toggleEvents(t,!0),this._customEvents=t,this.props&&this.setProps(this.props)}finalize(){for(const e in this._events){var t;this._events[e]&&(null===(t=this.eventManager)||void 0===t||t.off(e,this.handleEvent))}this.transitionManager.finalize()}handleEvent(t){this._controllerState=void 0;const e=this._eventStartBlocked;switch(t.type){case"panstart":return!e&&this._onPanStart(t);case"panmove":return this._onPan(t);case"panend":return this._onPanEnd(t);case"pinchstart":return!e&&this._onPinchStart(t);case"pinchmove":return this._onPinch(t);case"pinchend":return this._onPinchEnd(t);case"tripanstart":return!e&&this._onTriplePanStart(t);case"tripanmove":return this._onTriplePan(t);case"tripanend":return this._onTriplePanEnd(t);case"doubletap":return this._onDoubleTap(t);case"wheel":return this._onWheel(t);case"keydown":return this._onKeyDown(t);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState({makeViewport:this.makeViewport,...this.props,...this.state}),this._controllerState}getCenter(t){const{x:e,y:n}=this.props,{offsetCenter:r}=t;return[r.x-e,r.y-n]}isPointInBounds(t,e){const{width:n,height:r}=this.props;if(e&&e.handled)return!1;const i=t[0]>=0&&t[0]<=n&&t[1]>=0&&t[1]<=r;return i&&e&&e.stopPropagation(),i}isFunctionKeyPressed(t){const{srcEvent:e}=t;return Boolean(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(t){const e=setTimeout((()=>{this._eventStartBlocked===e&&(this._eventStartBlocked=null)}),t);this._eventStartBlocked=e}setProps(t){t.dragMode&&(this.dragMode=t.dragMode),this.props=t,"transitionInterpolator"in t||(t.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(t);const{inertia:e}=t;this.inertia=Number.isFinite(e)?e:!0===e?300:0;const{scrollZoom:n=!0,dragPan:r=!0,dragRotate:i=!0,doubleClickZoom:o=!0,touchZoom:s=!0,touchRotate:a=!1,keyboard:p=!0}=t,g=Boolean(this.onViewStateChange);this.toggleEvents(l,g&&n),this.toggleEvents(u,g),this.toggleEvents(c,g&&(s||a)),this.toggleEvents(h,g&&a),this.toggleEvents(d,g&&o),this.toggleEvents(f,g&&p),this.scrollZoom=n,this.dragPan=r,this.dragRotate=i,this.doubleClickZoom=o,this.touchZoom=s,this.touchRotate=a,this.keyboard=p}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(t,e){this.eventManager&&t.forEach((t=>{this._events[t]!==e&&(this._events[t]=e,e?this.eventManager.on(t,this.handleEvent):this.eventManager.off(t,this.handleEvent))}))}updateViewport(t,e=null,n={}){const r={...t.getViewportProps(),...e},i=this.controllerState!==t;if(this.state=t.getState(),this._setInteractionState(n),i){const t=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:r,interactionState:this._interactionState,oldViewState:t})}}_onTransition(t){this.onViewStateChange({...t,interactionState:this._interactionState})}_setInteractionState(t){Object.assign(this._interactionState,t),this.onStateChange(this._interactionState)}_onPanStart(t){const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;let n=this.isFunctionKeyPressed(t)||t.rightButton||!1;(this.invertPan||"pan"===this.dragMode)&&(n=!n);const r=this.controllerState[n?"panStart":"rotateStart"]({pos:e});return this._panMove=n,this.updateViewport(r,s,{isDragging:!0}),!0}_onPan(t){return!!this.isDragging()&&(this._panMove?this._onPanMove(t):this._onPanRotate(t))}_onPanEnd(t){return!!this.isDragging()&&(this._panMove?this._onPanMoveEnd(t):this._onPanRotateEnd(t))}_onPanMove(t){if(!this.dragPan)return!1;const e=this.getCenter(t),n=this.controllerState.pan({pos:e});return this.updateViewport(n,s,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(t){const{inertia:e}=this;if(this.dragPan&&e&&t.velocity){const n=this.getCenter(t),r=[n[0]+t.velocityX*e/2,n[1]+t.velocityY*e/2],i=this.controllerState.pan({pos:r}).panEnd();this.updateViewport(i,{...this._getTransitionProps(),transitionDuration:e,transitionEasing:a},{isDragging:!1,isPanning:!0})}else{const t=this.controllerState.panEnd();this.updateViewport(t,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(t){if(!this.dragRotate)return!1;const e=this.getCenter(t),n=this.controllerState.rotate({pos:e});return this.updateViewport(n,s,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(t){const{inertia:e}=this;if(this.dragRotate&&e&&t.velocity){const n=this.getCenter(t),r=[n[0]+t.velocityX*e/2,n[1]+t.velocityY*e/2],i=this.controllerState.rotate({pos:r}).rotateEnd();this.updateViewport(i,{...this._getTransitionProps(),transitionDuration:e,transitionEasing:a},{isDragging:!1,isRotating:!0})}else{const t=this.controllerState.rotateEnd();this.updateViewport(t,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(t){if(!this.scrollZoom)return!1;const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;t.srcEvent.preventDefault();const{speed:n=.01,smooth:r=!1}=!0===this.scrollZoom?{}:this.scrollZoom,{delta:i}=t;let o=2/(1+Math.exp(-Math.abs(i*n)));i<0&&0!==o&&(o=1/o);const s=this.controllerState.zoom({pos:e,scale:o});return this.updateViewport(s,{...this._getTransitionProps({around:e}),transitionDuration:r?250:1},{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(t){const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;const n=this.controllerState.rotateStart({pos:e});return this.updateViewport(n,s,{isDragging:!0}),!0}_onTriplePan(t){if(!this.touchRotate)return!1;if(!this.isDragging())return!1;const e=this.getCenter(t);e[0]-=t.deltaX;const n=this.controllerState.rotate({pos:e});return this.updateViewport(n,s,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(t){if(!this.isDragging())return!1;const{inertia:e}=this;if(this.touchRotate&&e&&t.velocityY){const n=this.getCenter(t),r=[n[0],n[1]+=t.velocityY*e/2],i=this.controllerState.rotate({pos:r});this.updateViewport(i,{...this._getTransitionProps(),transitionDuration:e,transitionEasing:a},{isDragging:!1,isRotating:!0}),this.blockEvents(e)}else{const t=this.controllerState.rotateEnd();this.updateViewport(t,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(t){const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;const n=this.controllerState.zoomStart({pos:e}).rotateStart({pos:e});return p._startPinchRotation=t.rotation,p._lastPinchEvent=t,this.updateViewport(n,s,{isDragging:!0}),!0}_onPinch(t){if(!this.touchZoom&&!this.touchRotate)return!1;if(!this.isDragging())return!1;let e=this.controllerState;if(this.touchZoom){const{scale:n}=t,r=this.getCenter(t);e=e.zoom({pos:r,scale:n})}if(this.touchRotate){const{rotation:n}=t;e=e.rotate({deltaAngleX:p._startPinchRotation-n})}return this.updateViewport(e,s,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),p._lastPinchEvent=t,!0}_onPinchEnd(t){if(!this.isDragging())return!1;const{inertia:e}=this,{_lastPinchEvent:n}=p;if(this.touchZoom&&e&&n&&t.scale!==n.scale){const r=this.getCenter(t);let i=this.controllerState.rotateEnd();const o=Math.log2(t.scale),s=(o-Math.log2(n.scale))/(t.deltaTime-n.deltaTime),l=Math.pow(2,o+s*e/2);i=i.zoom({pos:r,scale:l}).zoomEnd(),this.updateViewport(i,{...this._getTransitionProps({around:r}),transitionDuration:e,transitionEasing:a},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(e)}else{const t=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(t,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return p._startPinchRotation=null,p._lastPinchEvent=null,!0}_onDoubleTap(t){if(!this.doubleClickZoom)return!1;const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;const n=this.isFunctionKeyPressed(t),r=this.controllerState.zoom({pos:e,scale:n?.5:2});return this.updateViewport(r,this._getTransitionProps({around:e}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(t){if(!this.keyboard)return!1;const e=this.isFunctionKeyPressed(t),{zoomSpeed:n,moveSpeed:r,rotateSpeedX:i,rotateSpeedY:o}=!0===this.keyboard?{}:this.keyboard,{controllerState:s}=this;let a;const l={};switch(t.srcEvent.code){case"Minus":a=e?s.zoomOut(n).zoomOut(n):s.zoomOut(n),l.isZooming=!0;break;case"Equal":a=e?s.zoomIn(n).zoomIn(n):s.zoomIn(n),l.isZooming=!0;break;case"ArrowLeft":e?(a=s.rotateLeft(i),l.isRotating=!0):(a=s.moveLeft(r),l.isPanning=!0);break;case"ArrowRight":e?(a=s.rotateRight(i),l.isRotating=!0):(a=s.moveRight(r),l.isPanning=!0);break;case"ArrowUp":e?(a=s.rotateUp(o),l.isRotating=!0):(a=s.moveUp(r),l.isPanning=!0);break;case"ArrowDown":e?(a=s.rotateDown(o),l.isRotating=!0):(a=s.moveDown(r),l.isPanning=!0);break;default:return!1}return this.updateViewport(a,this._getTransitionProps(),l),!0}_getTransitionProps(t){const{transition:e}=this;return e&&e.transitionInterpolator?t?{...e,transitionInterpolator:new o.A({...t,...e.transitionInterpolator.opts,makeViewport:this.controllerState.makeViewport})}:e:s}}},2249:(t,e,n)=>{"use strict";n.d(e,{A:()=>h,y:()=>c});var r=n(67136),i=n(54692),o=n(90544),s=n(96825),a=n(649),l=n(40898),u=n(71154);class c extends s.A{constructor(t){const{width:e,height:n,latitude:i,longitude:o,zoom:s,bearing:a=0,pitch:u=0,altitude:c=1.5,position:h=[0,0,0],maxZoom:d=20,minZoom:f=0,maxPitch:p=60,minPitch:g=0,startPanLngLat:y,startZoomLngLat:m,startRotatePos:v,startBearing:b,startPitch:_,startZoom:A,normalize:x=!0}=t;(0,l.A)(Number.isFinite(o)),(0,l.A)(Number.isFinite(i)),(0,l.A)(Number.isFinite(s)),super({width:e,height:n,latitude:i,longitude:o,zoom:s,bearing:a,pitch:u,altitude:c,maxZoom:d,minZoom:f,maxPitch:p,minPitch:g,normalize:x,position:h},{startPanLngLat:y,startZoomLngLat:m,startRotatePos:v,startBearing:b,startPitch:_,startZoom:A}),(0,r.A)(this,"makeViewport",void 0),this.makeViewport=t.makeViewport}panStart({pos:t}){return this._getUpdatedState({startPanLngLat:this._unproject(t)})}pan({pos:t,startPos:e}){const n=this.getState().startPanLngLat||this._unproject(e);if(!n)return this;const r=this.makeViewport(this.getViewportProps()).panByPosition(n,t);return this._getUpdatedState(r)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:t}){return this._getUpdatedState({startRotatePos:t,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate({pos:t,deltaAngleX:e=0,deltaAngleY:n=0}){const{startRotatePos:r,startBearing:i,startPitch:o}=this.getState();if(!r||void 0===i||void 0===o)return this;let s;return s=t?this._getNewRotation(t,r,o,i):{bearing:i+e,pitch:o+n},this._getUpdatedState(s)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:t}){return this._getUpdatedState({startZoomLngLat:this._unproject(t),startZoom:this.getViewportProps().zoom})}zoom({pos:t,startPos:e,scale:n}){let{startZoom:r,startZoomLngLat:o}=this.getState();if(o||(r=this.getViewportProps().zoom,o=this._unproject(e)||this._unproject(t)),!o)return this;const{maxZoom:s,minZoom:a}=this.getViewportProps();let l=r+Math.log2(n);l=(0,i.qE)(l,a,s);const u=this.makeViewport({...this.getViewportProps(),zoom:l});return this._getUpdatedState({zoom:l,...u.panByPosition(o,t)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(t=2){return this._zoomFromCenter(t)}zoomOut(t=2){return this._zoomFromCenter(1/t)}moveLeft(t=100){return this._panFromCenter([t,0])}moveRight(t=100){return this._panFromCenter([-t,0])}moveUp(t=100){return this._panFromCenter([0,t])}moveDown(t=100){return this._panFromCenter([0,-t])}rotateLeft(t=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing-t})}rotateRight(t=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing+t})}rotateUp(t=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch+t})}rotateDown(t=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch-t})}shortestPathFrom(t){const e=t.getViewportProps(),n={...this.getViewportProps()},{bearing:r,longitude:i}=n;return Math.abs(r-e.bearing)>180&&(n.bearing=r<0?r+360:r-360),Math.abs(i-e.longitude)>180&&(n.longitude=i<0?i+360:i-360),n}applyConstraints(t){const{maxZoom:e,minZoom:n,zoom:r}=t;t.zoom=(0,i.qE)(r,n,e);const{maxPitch:o,minPitch:s,pitch:l}=t;t.pitch=(0,i.qE)(l,s,o);const{normalize:u=!0}=t;return u&&Object.assign(t,(0,a.normalizeViewportProps)(t)),t}_zoomFromCenter(t){const{width:e,height:n}=this.getViewportProps();return this.zoom({pos:[e/2,n/2],scale:t})}_panFromCenter(t){const{width:e,height:n}=this.getViewportProps();return this.pan({startPos:[e/2,n/2],pos:[e/2+t[0],n/2+t[1]]})}_getUpdatedState(t){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...t})}_unproject(t){const e=this.makeViewport(this.getViewportProps());return t&&e.unproject(t)}_getNewRotation(t,e,n,r){const o=t[0]-e[0],s=t[1]-e[1],a=t[1],l=e[1],{width:u,height:c}=this.getViewportProps(),h=o/u;let d=0;s>0?Math.abs(c-l)>5&&(d=s/(l-c)*1.2):s<0&&l>5&&(d=1-a/l),d=(0,i.qE)(d,-1,1);const{minPitch:f,maxPitch:p}=this.getViewportProps();let g=n;return d>0?g=n+d*(p-n):d<0&&(g=n-d*(f-n)),{pitch:g,bearing:r+180*h}}}class h extends o.A{constructor(...t){super(...t),(0,r.A)(this,"ControllerState",c),(0,r.A)(this,"transition",{transitionDuration:300,transitionInterpolator:new u.A({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})}),(0,r.A)(this,"dragMode","pan")}setProps(t){t.position=t.position||[0,0,0];const e=this.props;super.setProps(t),(!e||e.height!==t.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...t,...this.state}))}}},52473:(t,e,n)=>{"use strict";n.d(e,{A:()=>u,w:()=>s});var r=n(67136),i=n(82904);const o=()=>{},s={BREAK:1,SNAP_TO_END:2,IGNORE:3},a=t=>t,l=s.BREAK;class u{constructor(t){(0,r.A)(this,"getControllerState",void 0),(0,r.A)(this,"props",void 0),(0,r.A)(this,"propsInTransition",void 0),(0,r.A)(this,"transition",void 0),(0,r.A)(this,"onViewStateChange",void 0),(0,r.A)(this,"onStateChange",void 0),(0,r.A)(this,"_onTransitionUpdate",(t=>{const{time:e,settings:{interpolator:n,startProps:r,endProps:i,duration:o,easing:s}}=t,a=s(e/o),l=n.interpolateProps(r,i,a);this.propsInTransition=this.getControllerState({...this.props,...l}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})})),this.getControllerState=t.getControllerState,this.propsInTransition=null,this.transition=new i.A(t.timeline),this.onViewStateChange=t.onViewStateChange||o,this.onStateChange=t.onStateChange||o}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(t){let e=!1;const n=this.props;if(this.props=t,!n||this._shouldIgnoreViewportChange(n,t))return!1;if(this._isTransitionEnabled(t)){let r=n;if(this.transition.inProgress){const{interruption:t,endProps:e}=this.transition.settings;r={...n,...t===s.SNAP_TO_END?e:this.propsInTransition||n}}this._triggerTransition(r,t),e=!0}else this.transition.cancel();return e}updateTransition(){this.transition.update()}_isTransitionEnabled(t){const{transitionDuration:e,transitionInterpolator:n}=t;return(e>0||"auto"===e)&&Boolean(n)}_isUpdateDueToCurrentTransition(t){return!(!this.transition.inProgress||!this.propsInTransition)&&this.transition.settings.interpolator.arePropsEqual(t,this.propsInTransition)}_shouldIgnoreViewportChange(t,e){return this.transition.inProgress?this.transition.settings.interruption===s.IGNORE||this._isUpdateDueToCurrentTransition(e):!this._isTransitionEnabled(e)||e.transitionInterpolator.arePropsEqual(t,e)}_triggerTransition(t,e){const n=this.getControllerState(t),r=this.getControllerState(e).shortestPathFrom(n),i=e.transitionInterpolator,o=i.getDuration?i.getDuration(t,e):e.transitionDuration;if(0===o)return;const s=i.initializeProps(t,r);this.propsInTransition={};const u={duration:o,easing:e.transitionEasing||a,interpolator:i,interruption:e.transitionInterruption||l,startProps:s.start,endProps:s.end,onStart:e.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(e.onTransitionInterrupt),onEnd:this._onTransitionEnd(e.onTransitionEnd)};this.transition.start(u),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(t){return e=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),null==t||t(e)}}}},96825:(t,e,n)=>{"use strict";n.d(e,{A:()=>i});var r=n(67136);class i{constructor(t,e){(0,r.A)(this,"_viewportProps",void 0),(0,r.A)(this,"_state",void 0),this._viewportProps=this.applyConstraints(t),this._state=e}getViewportProps(){return this._viewportProps}getState(){return this._state}}},52908:(t,e,n)=>{"use strict";n.d(e,{A:()=>s,k:()=>o});var r=n(26820);let i={};function o(t){i=t}function s(t,e,n,o){r.A.level>0&&i[t]&&i[t].call(null,e,n,o)}},6111:(t,e,n)=>{"use strict";n.d(e,{$:()=>a});var r=n(67136);const i=[255,255,255],o=1;let s=0;class a{constructor(t={}){(0,r.A)(this,"id",void 0),(0,r.A)(this,"color",void 0),(0,r.A)(this,"intensity",void 0),(0,r.A)(this,"type","ambient");const{color:e=i}=t,{intensity:n=o}=t;this.id=t.id||"ambient-".concat(s++),this.color=e,this.intensity=n}}},12307:(t,e,n)=>{"use strict";n.d(e,{Z:()=>u});var r=n(67136),i=n(22466);const o=[255,255,255],s=1,a=[0,0,-1];let l=0;class u{constructor(t={}){(0,r.A)(this,"id",void 0),(0,r.A)(this,"color",void 0),(0,r.A)(this,"intensity",void 0),(0,r.A)(this,"type","directional"),(0,r.A)(this,"direction",void 0),(0,r.A)(this,"shadow",void 0);const{color:e=o}=t,{intensity:n=s}=t,{direction:u=a}=t,{_shadow:c=!1}=t;this.id=t.id||"directional-".concat(l++),this.color=e,this.intensity=n,this.type="directional",this.direction=new i.A(u).normalize().toArray(),this.shadow=c}getProjectedLight(t){return this}}},3599:(t,e,n)=>{"use strict";n.d(e,{A:()=>b});var r=n(67136),i=n(57877),o=n(26107),s=n(6111),a=n(12307),l=n(98569),u=n(22466),c=n(64156),h=n(50408),d=n(80606),f=n(8282);class p extends c.A{constructor(t,e){super(t,e),(0,r.A)(this,"shadowMap",void 0),(0,r.A)(this,"depthBuffer",void 0),(0,r.A)(this,"fbo",void 0),this.shadowMap=new o.A(t,{width:1,height:1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.depthBuffer=new h.A(t,{format:33189,width:1,height:1}),this.fbo=new d.A(t,{id:"shadowmap",width:1,height:1,attachments:{36064:this.shadowMap,36096:this.depthBuffer}})}render(t){const e=this.fbo;(0,f.zv)(this.gl,{depthRange:[0,1],depthTest:!0,blend:!1,clearColor:[1,1,1,1]},(()=>{const n=t.viewports[0],r=(0,f.o0)(this.gl),i=n.width*r,o=n.height*r;i===e.width&&o===e.height||e.resize({width:i,height:o}),super.render({...t,target:e,pass:"shadow"})}))}shouldDrawLayer(t){return!1!==t.props.shadowEnabled}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.delete(),this.fbo=null),this.shadowMap&&(this.shadowMap.delete(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.delete(),this.depthBuffer=null)}}var g=n(37450);const y={color:[255,255,255],intensity:1},m=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],v=[0,0,0,200/255];class b{constructor(t={}){(0,r.A)(this,"id","lighting-effect"),(0,r.A)(this,"props",void 0),(0,r.A)(this,"shadowColor",v),(0,r.A)(this,"shadow",void 0),(0,r.A)(this,"ambientLight",void 0),(0,r.A)(this,"directionalLights",void 0),(0,r.A)(this,"pointLights",void 0),(0,r.A)(this,"shadowPasses",[]),(0,r.A)(this,"shadowMaps",[]),(0,r.A)(this,"dummyShadowMap",null),(0,r.A)(this,"programManager",void 0),(0,r.A)(this,"shadowMatrices",void 0),this.setProps(t)}setProps(t){this.ambientLight=null,this.directionalLights=[],this.pointLights=[];for(const e in t){const n=t[e];switch(n.type){case"ambient":this.ambientLight=n;break;case"directional":this.directionalLights.push(n);break;case"point":this.pointLights.push(n)}}this._applyDefaultLights(),this.shadow=this.directionalLights.some((t=>t.shadow)),this.props=t}preRender(t,{layers:e,layerFilter:n,viewports:r,onViewportActive:s,views:a}){if(this.shadow){this.shadowMatrices=this._calculateMatrices(),0===this.shadowPasses.length&&this._createShadowPasses(t),this.programManager||(this.programManager=i.A.getDefaultProgramManager(t),g.A&&this.programManager.addDefaultModule(g.A)),this.dummyShadowMap||(this.dummyShadowMap=new o.A(t,{width:1,height:1}));for(let t=0;t<this.shadowPasses.length;t++)this.shadowPasses[t].render({layers:e,layerFilter:n,viewports:r,onViewportActive:s,views:a,moduleParameters:{shadowLightId:t,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}getModuleParameters(t){const e=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return e.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map((e=>e.getProjectedLight({layer:t}))),pointLights:this.pointLights.map((e=>e.getProjectedLight({layer:t})))},e}cleanup(){for(const t of this.shadowPasses)t.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.delete(),this.dummyShadowMap=null),this.shadow&&this.programManager&&(this.programManager.removeDefaultModule(g.A),this.programManager=null)}_calculateMatrices(){const t=[];for(const e of this.directionalLights){const n=(new l.A).lookAt({eye:new u.A(e.direction).negate()});t.push(n)}return t}_createShadowPasses(t){for(let e=0;e<this.directionalLights.length;e++){const n=new p(t);this.shadowPasses[e]=n,this.shadowMaps[e]=n.shadowMap}}_applyDefaultLights(){const{ambientLight:t,pointLights:e,directionalLights:n}=this;t||0!==e.length||0!==n.length||(this.ambientLight=new s.$(y),this.directionalLights.push(new a.Z(m[0]),new a.Z(m[1])))}}},98265:(t,e,n)=>{"use strict";n.r(e),n.d(e,{AmbientLight:()=>s.$,AttributeManager:()=>J.A,COORDINATE_SYSTEM:()=>i.rf,CompositeLayer:()=>X.A,Controller:()=>gt.A,Deck:()=>q.A,DeckRenderer:()=>K.A,DirectionalLight:()=>a.Z,FirstPersonController:()=>xt,FirstPersonView:()=>wt,FirstPersonViewport:()=>at,FlyToInterpolator:()=>jt,Layer:()=>Y.A,LayerExtension:()=>Lt.A,LayerManager:()=>W.A,LightingEffect:()=>o.A,LinearInterpolator:()=>vt.A,MapController:()=>Ot.A,MapView:()=>pt.A,OPERATION:()=>i.qR,OrbitController:()=>St,OrbitView:()=>Et,OrbitViewport:()=>it,OrthographicController:()=>Pt,OrthographicView:()=>Tt,OrthographicViewport:()=>ot.A,PointLight:()=>g,PostProcessEffect:()=>j,TRANSITION_EVENTS:()=>kt.w,Tesselator:()=>Vt.A,TransitionInterpolator:()=>Dt.A,UNIT:()=>i.p5,VERSION:()=>r.x,View:()=>ft.A,Viewport:()=>Z.A,WebMercatorViewport:()=>Q.A,_CameraLight:()=>m,_GlobeController:()=>Rt,_GlobeView:()=>Bt,_GlobeViewport:()=>$.A,_LayersPass:()=>V.A,_PickLayersPass:()=>H.A,_SunLight:()=>R,_compareProps:()=>Xt.Me,_count:()=>qt.U,_deepEqual:()=>Wt.b,_fillArray:()=>Ht.R,_flatten:()=>Ht.B,_memoize:()=>Jt.A,_mergeShaders:()=>Yt.n,assert:()=>Ut.A,createIterable:()=>zt.X,fp64LowPart:()=>mt.qk,gouraudLighting:()=>ht.K,log:()=>Gt.A,phongLighting:()=>ht.p,picking:()=>lt.A,project:()=>ut.A,project32:()=>ct.A,shadow:()=>dt.A});var r=n(7453),i=n(1597),o=n(3599),s=n(6111),a=n(12307),l=n(67136),u=n(63252);const c=[255,255,255],h=1,d=[0,0,1],f=[0,0,1];let p=0;class g{constructor(t={}){(0,l.A)(this,"id",void 0),(0,l.A)(this,"color",void 0),(0,l.A)(this,"intensity",void 0),(0,l.A)(this,"type","point"),(0,l.A)(this,"position",void 0),(0,l.A)(this,"attenuation",void 0),(0,l.A)(this,"projectedLight",void 0);const{color:e=c}=t,{intensity:n=h}=t,{position:r=f}=t;this.id=t.id||"point-".concat(p++),this.color=e,this.intensity=n,this.type="point",this.position=r,this.attenuation=function(t){return t.attenuation?t.attenuation:"intensity"in t?[0,0,t.intensity||0]:d}(t),this.projectedLight={...this}}getProjectedLight({layer:t}){const{projectedLight:e}=this,n=t.context.viewport,{coordinateSystem:r,coordinateOrigin:o}=t.props,s=(0,u.R)(this.position,{viewport:n,coordinateSystem:r,coordinateOrigin:o,fromCoordinateSystem:n.isGeospatial?i.rf.LNGLAT:i.rf.CARTESIAN,fromCoordinateOrigin:[0,0,0]});return e.color=this.color,e.intensity=this.intensity,e.position=s,e}}var y=n(42653);class m extends g{getProjectedLight({layer:t}){const{projectedLight:e}=this,n=t.context.viewport,{coordinateSystem:r,coordinateOrigin:i,modelMatrix:o}=t.props,{project_uCameraPosition:s}=(0,y.a)({viewport:n,modelMatrix:o,coordinateSystem:r,coordinateOrigin:i});return e.color=this.color,e.intensity=this.intensity,e.position=s,e}}const v=Math.PI/180,b=864e5,_=2440588,A=2451545,x=23.4397*v,w=357.5291,C=.98560028,S=280.147,E=360.9856235;function M(t,e,n){const{azimuth:r,altitude:i}=function(t,e,n){const r=v*-n,i=v*e,o=function(t){return function(t){return("number"==typeof t?t:t.getTime())/b-.5+_}(t)-A}(t),s=function(t){const e=function(t){const e=t;return e+v*(1.9148*Math.sin(e)+.02*Math.sin(2*e)+3e-4*Math.sin(3*e))+102.9372*v+Math.PI}(v*(w+C*t));return{declination:T(e,0),rightAscension:P(e,0)}}(o),a=function(t,e){return v*(S+E*t)-e}(o,r)-s.rightAscension;return{azimuth:O(a,i,s.declination),altitude:I(a,i,s.declination)}}(t,e,n);return[Math.sin(r)*Math.cos(i),Math.cos(r)*Math.cos(i),-Math.sin(i)]}function P(t,e){const n=t;return Math.atan2(Math.sin(n)*Math.cos(x)-Math.tan(e)*Math.sin(x),Math.cos(n))}function T(t,e){const n=t;return Math.asin(Math.sin(e)*Math.cos(x)+Math.cos(e)*Math.sin(x)*Math.sin(n))}function O(t,e,n){const r=t,i=e,o=n;return Math.atan2(Math.sin(r),Math.cos(r)*Math.sin(i)-Math.tan(o)*Math.cos(i))}function I(t,e,n){const r=t,i=e,o=n;return Math.asin(Math.sin(i)*Math.sin(o)+Math.cos(i)*Math.cos(o)*Math.cos(r))}class R extends a.Z{constructor(t){super(t),(0,l.A)(this,"timestamp",void 0),this.timestamp=t.timestamp}getProjectedLight({layer:t}){const{viewport:e}=t.context;if(e.resolution&&e.resolution>0){const[t,e,n]=M(this.timestamp,0,0);this.direction=[t,-n,e]}else{const{latitude:t,longitude:n}=e;this.direction=M(this.timestamp,t,n)}return this}}var B=n(73272),L=n(8282),k=n(22780),D=n(44991);class F extends D.A{constructor(t,e){super(t,e),(0,l.A)(this,"model",void 0);const{module:n,fs:r,id:i}=e;this.model=new B.A(t,{id:i,fs:r,modules:[n]})}render(t){const e=this.gl;(0,L.Rz)(e,{viewport:[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}),(0,L.zv)(e,{framebuffer:t.outputBuffer,clearColor:[0,0,0,0]},(()=>this._renderPass(e,t)))}delete(){this.model.delete(),this.model=null}_renderPass(t,e){const{inputBuffer:n}=e;(0,k.I)(t,{color:!0}),this.model.draw({moduleSettings:e.moduleSettings,uniforms:{texture:n,texSize:[n.width,n.height]},parameters:{depthWrite:!1,depthTest:!1}})}}var N=n(78141);class j{constructor(t,e={}){(0,l.A)(this,"id",void 0),(0,l.A)(this,"props",void 0),(0,l.A)(this,"module",void 0),(0,l.A)(this,"passes",void 0),this.id="".concat(t.name,"-pass"),this.props=e,(0,N.b)(t),this.module=t}setProps(t){this.props=t}preRender(){}postRender(t,e){const n=this.passes||function(t,e,n){if(!e.passes){const r=z(e);return[new F(t,{id:n,module:e,fs:r})]}return e.passes.map(((r,i)=>{const o=z(e,r),s="".concat(n,"-").concat(i);return new F(t,{id:s,module:e,fs:o})}))}(t,this.module,this.id);this.passes=n;const{target:r}=e;let i=e.inputBuffer,o=e.swapBuffer;for(let t=0;t<this.passes.length;t++){r&&t===this.passes.length-1&&(o=r),this.passes[t].render({inputBuffer:i,outputBuffer:o,moduleSettings:this.props});const e=o;o=i,i=e}return i}cleanup(){if(this.passes){for(const t of this.passes)t.delete();this.passes=void 0}}}const G=t=>"uniform sampler2D texture;\nuniform vec2 texSize;\n\nvarying vec2 position;\nvarying vec2 coordinate;\nvarying vec2 uv;\n\nvoid main() {\n  vec2 texCoord = coordinate;\n\n  gl_FragColor = texture2D(texture, texCoord);\n  gl_FragColor = ".concat(t,"(gl_FragColor, texSize, texCoord);\n}\n"),U=t=>"uniform sampler2D texture;\nuniform vec2 texSize;\n\nvarying vec2 position;\nvarying vec2 coordinate;\nvarying vec2 uv;\n\nvoid main() {\n  vec2 texCoord = coordinate;\n\n  gl_FragColor = ".concat(t,"(texture, texSize, texCoord);\n}\n");function z(t,e=t){if(e.filter){const n="string"==typeof e.filter?e.filter:"".concat(t.name,"_filterColor");return G(n)}if(e.sampler){const n="string"==typeof e.sampler?e.sampler:"".concat(t.name,"_sampleColor");return U(n)}return null}var V=n(64156),H=n(64766),q=n(88059),W=n(29344),J=n(83726),Y=n(36179),X=n(68411),K=n(345),Z=n(54684),Q=n(82125),$=n(33540),tt=n(98569),et=n(649);const nt=Math.PI/180;function rt({height:t,focalDistance:e,orbitAxis:n,rotationX:r,rotationOrbit:i,zoom:o}){const s="Z"===n?[0,0,1]:[0,1,0],a="Z"===n?[0,-e,0]:[0,0,e],l=(new tt.A).lookAt({eye:a,up:s});l.rotateX(r*nt),"Z"===n?l.rotateZ(i*nt):l.rotateY(i*nt);const u=Math.pow(2,o)/t;return l.scale(u),l}class it extends Z.A{constructor(t){const{height:e,projectionMatrix:n,fovy:r=50,orbitAxis:i="Z",target:o=[0,0,0],rotationX:s=0,rotationOrbit:a=0,zoom:u=0}=t,c=n?n[5]/2:(0,et.fovyToAltitude)(r);super({...t,longitude:void 0,viewMatrix:rt({height:e||1,focalDistance:c,orbitAxis:i,rotationX:s,rotationOrbit:a,zoom:u}),fovy:r,focalDistance:c,position:o,zoom:u}),(0,l.A)(this,"projectedCenter",void 0),this.projectedCenter=this.project(this.center)}unproject(t,{topLeft:e=!0}={}){const[n,r,i=this.projectedCenter[2]]=t,o=e?r:this.height-r,[s,a,l]=(0,et.pixelsToWorld)([n,o,i],this.pixelUnprojectionMatrix);return[s,a,l]}panByPosition(t,e){const n=this.project(t),r=[this.width/2+n[0]-e[0],this.height/2+n[1]-e[1],this.projectedCenter[2]];return{target:this.unproject(r)}}}var ot=n(1279),st=n(27539);class at extends Z.A{constructor(t){const{longitude:e,latitude:n,modelMatrix:r,bearing:i=0,pitch:o=0,up:s=[0,0,1]}=t,a=new st.A({bearing:i,pitch:-90===o?1e-4:90+o}).toVector3().normalize(),u=r?new tt.A(r).transformAsVector(a):a,c=Number.isFinite(n)?(0,et.getMeterZoom)({latitude:n}):0,h=Math.pow(2,c),d=(new tt.A).lookAt({eye:[0,0,0],center:u,up:s}).scale(h);super({...t,zoom:c,viewMatrix:d}),(0,l.A)(this,"longitude",void 0),(0,l.A)(this,"latitude",void 0),this.latitude=n,this.longitude=e}}var lt=n(70560),ut=n(19488),ct=n(79464),ht=n(44123),dt=n(37450),ft=n(43035),pt=n(45029),gt=n(90544),yt=n(96825),mt=n(51682),vt=n(71154),bt=n(22466),_t=n(54692);class At extends yt.A{constructor(t){const{width:e,height:n,position:r=[0,0,0],bearing:i=0,pitch:o=0,longitude:s=null,latitude:a=null,maxPitch:l=90,minPitch:u=-90,startRotatePos:c,startBearing:h,startPitch:d,startZoomPosition:f}=t;super({width:e,height:n,position:r,bearing:i,pitch:o,longitude:s,latitude:a,maxPitch:l,minPitch:u},{startRotatePos:c,startBearing:h,startPitch:d,startZoomPosition:f})}panStart(){return this}pan(){return this}panEnd(){return this}rotateStart({pos:t}){return this._getUpdatedState({startRotatePos:t,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate({pos:t,deltaAngleX:e=0,deltaAngleY:n=0}){const{startRotatePos:r,startBearing:i,startPitch:o}=this.getState(),{width:s,height:a}=this.getViewportProps();if(!r||void 0===i||void 0===o)return this;let l;return l=t?{bearing:i-(t[0]-r[0])/s*180,pitch:o-(t[1]-r[1])/a*90}:{bearing:i-e,pitch:o-n},this._getUpdatedState(l)}rotateEnd(){return this._getUpdatedState({startRotatePos:null,startBearing:null,startPitch:null})}zoomStart(){return this._getUpdatedState({startZoomPosition:this.getViewportProps().position})}zoom({scale:t}){let{startZoomPosition:e}=this.getState();e||(e=this.getViewportProps().position);const n=this.getDirection();return this._move(n,20*Math.log2(t),e)}zoomEnd(){return this._getUpdatedState({startZoomPosition:null})}moveLeft(t=20){const e=this.getDirection(!0);return this._move(e.rotateZ({radians:Math.PI/2}),t)}moveRight(t=20){const e=this.getDirection(!0);return this._move(e.rotateZ({radians:-Math.PI/2}),t)}moveUp(t=20){const e=this.getDirection(!0);return this._move(e,t)}moveDown(t=20){const e=this.getDirection(!0);return this._move(e.negate(),t)}rotateLeft(t=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing-t})}rotateRight(t=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing+t})}rotateUp(t=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch+t})}rotateDown(t=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch-t})}zoomIn(t=2){return this.zoom({scale:t})}zoomOut(t=2){return this.zoom({scale:1/t})}shortestPathFrom(t){const e=t.getViewportProps(),n={...this.getViewportProps()},{bearing:r,longitude:i}=n;return Math.abs(r-e.bearing)>180&&(n.bearing=r<0?r+360:r-360),null!==i&&null!==e.longitude&&Math.abs(i-e.longitude)>180&&(n.longitude=i<0?i+360:i-360),n}_move(t,e,n=this.getViewportProps().position){const r=t.scale(e);return this._getUpdatedState({position:new bt.A(n).add(r)})}getDirection(t=!1){return new st.A({bearing:this.getViewportProps().bearing,pitch:t?90:90+this.getViewportProps().pitch}).toVector3().normalize()}_getUpdatedState(t){return new At({...this.getViewportProps(),...this.getState(),...t})}applyConstraints(t){const{pitch:e,maxPitch:n,minPitch:r,longitude:i,bearing:o}=t;return t.pitch=(0,_t.qE)(e,r,n),null!==i&&(i<-180||i>180)&&(t.longitude=(0,mt.zi)(i+180,360)-180),(o<-180||o>180)&&(t.bearing=(0,mt.zi)(o+180,360)-180),t}}class xt extends gt.A{constructor(...t){super(...t),(0,l.A)(this,"ControllerState",At),(0,l.A)(this,"transition",{transitionDuration:300,transitionInterpolator:new vt.A(["position","pitch","bearing"])})}}class wt extends ft.A{get ViewportType(){return at}get ControllerType(){return xt}}(0,l.A)(wt,"displayName","FirstPersonView");class Ct extends yt.A{constructor(t){const{width:e,height:n,rotationX:r=0,rotationOrbit:i=0,target:o=[0,0,0],zoom:s=0,minRotationX:a=-90,maxRotationX:u=90,minZoom:c=-1/0,maxZoom:h=1/0,startPanPosition:d,startRotatePos:f,startRotationX:p,startRotationOrbit:g,startZoomPosition:y,startZoom:m}=t;super({width:e,height:n,rotationX:r,rotationOrbit:i,target:o,zoom:s,minRotationX:a,maxRotationX:u,minZoom:c,maxZoom:h},{startPanPosition:d,startRotatePos:f,startRotationX:p,startRotationOrbit:g,startZoomPosition:y,startZoom:m}),(0,l.A)(this,"makeViewport",void 0),this.makeViewport=t.makeViewport}panStart({pos:t}){return this._getUpdatedState({startPanPosition:this._unproject(t)})}pan({pos:t,startPosition:e}){const n=this.getState().startPanPosition||e;if(!n)return this;const r=this.makeViewport(this.getViewportProps()).panByPosition(n,t);return this._getUpdatedState(r)}panEnd(){return this._getUpdatedState({startPanPosition:null})}rotateStart({pos:t}){return this._getUpdatedState({startRotatePos:t,startRotationX:this.getViewportProps().rotationX,startRotationOrbit:this.getViewportProps().rotationOrbit})}rotate({pos:t,deltaAngleX:e=0,deltaAngleY:n=0}){const{startRotatePos:r,startRotationX:i,startRotationOrbit:o}=this.getState(),{width:s,height:a}=this.getViewportProps();if(!r||void 0===i||void 0===o)return this;let l;if(t){let e=(t[0]-r[0])/s;(i<-90||i>90)&&(e*=-1),l={rotationX:i+(t[1]-r[1])/a*180,rotationOrbit:o+180*e}}else l={rotationX:i+n,rotationOrbit:o+e};return this._getUpdatedState(l)}rotateEnd(){return this._getUpdatedState({startRotationX:null,startRotationOrbit:null})}shortestPathFrom(t){const e=t.getViewportProps(),n={...this.getViewportProps()},{rotationOrbit:r}=n;return Math.abs(r-e.rotationOrbit)>180&&(n.rotationOrbit=r<0?r+360:r-360),n}zoomStart({pos:t}){return this._getUpdatedState({startZoomPosition:this._unproject(t),startZoom:this.getViewportProps().zoom})}zoom({pos:t,startPos:e,scale:n}){let{startZoom:r,startZoomPosition:i}=this.getState();if(i||(r=this.getViewportProps().zoom,i=this._unproject(e)||this._unproject(t)),!i)return this;const o=this._calculateNewZoom({scale:n,startZoom:r}),s=this.makeViewport({...this.getViewportProps(),zoom:o});return this._getUpdatedState({zoom:o,...s.panByPosition(i,t)})}zoomEnd(){return this._getUpdatedState({startZoomPosition:null,startZoom:null})}zoomIn(t=2){return this._getUpdatedState({zoom:this._calculateNewZoom({scale:t})})}zoomOut(t=2){return this._getUpdatedState({zoom:this._calculateNewZoom({scale:1/t})})}moveLeft(t=50){return this._panFromCenter([-t,0])}moveRight(t=50){return this._panFromCenter([t,0])}moveUp(t=50){return this._panFromCenter([0,-t])}moveDown(t=50){return this._panFromCenter([0,t])}rotateLeft(t=15){return this._getUpdatedState({rotationOrbit:this.getViewportProps().rotationOrbit-t})}rotateRight(t=15){return this._getUpdatedState({rotationOrbit:this.getViewportProps().rotationOrbit+t})}rotateUp(t=10){return this._getUpdatedState({rotationX:this.getViewportProps().rotationX-t})}rotateDown(t=10){return this._getUpdatedState({rotationX:this.getViewportProps().rotationX+t})}_unproject(t){const e=this.makeViewport(this.getViewportProps());return t&&e.unproject(t)}_calculateNewZoom({scale:t,startZoom:e}){const{maxZoom:n,minZoom:r}=this.getViewportProps();void 0===e&&(e=this.getViewportProps().zoom);const i=e+Math.log2(t);return(0,_t.qE)(i,r,n)}_panFromCenter(t){const{width:e,height:n,target:r}=this.getViewportProps();return this.pan({startPosition:r,pos:[e/2+t[0],n/2+t[1]]})}_getUpdatedState(t){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...t})}applyConstraints(t){const{maxZoom:e,minZoom:n,zoom:r,maxRotationX:i,minRotationX:o,rotationOrbit:s}=t;return t.zoom=Array.isArray(r)?[(0,_t.qE)(r[0],n,e),(0,_t.qE)(r[1],n,e)]:(0,_t.qE)(r,n,e),t.rotationX=(0,_t.qE)(t.rotationX,o,i),(s<-180||s>180)&&(t.rotationOrbit=(0,mt.zi)(s+180,360)-180),t}}class St extends gt.A{constructor(...t){super(...t),(0,l.A)(this,"ControllerState",Ct),(0,l.A)(this,"transition",{transitionDuration:300,transitionInterpolator:new vt.A({transitionProps:{compare:["target","zoom","rotationX","rotationOrbit"],required:["target","zoom"]}})})}}class Et extends ft.A{constructor(t={}){super(t),this.props.orbitAxis=t.orbitAxis||"Z"}get ViewportType(){return it}get ControllerType(){return St}}(0,l.A)(Et,"displayName","OrbitView");class Mt extends Ct{constructor(t){super(t),(0,l.A)(this,"zoomAxis",void 0),this.zoomAxis=t.zoomAxis||"all"}_calculateNewZoom({scale:t,startZoom:e}){const{maxZoom:n,minZoom:r}=this.getViewportProps();void 0===e&&(e=this.getViewportProps().zoom);let i=Math.log2(t);if(Array.isArray(e)){let[t,o]=e;switch(this.zoomAxis){case"X":t=(0,_t.qE)(t+i,r,n);break;case"Y":o=(0,_t.qE)(o+i,r,n);break;default:let e=Math.min(t+i,o+i);e<r&&(i+=r-e),e=Math.max(t+i,o+i),e>n&&(i+=n-e),t+=i,o+=i}return[t,o]}return(0,_t.qE)(e+i,r,n)}}class Pt extends gt.A{constructor(...t){super(...t),(0,l.A)(this,"ControllerState",Mt),(0,l.A)(this,"transition",{transitionDuration:300,transitionInterpolator:new vt.A(["target","zoom"])}),(0,l.A)(this,"dragMode","pan")}_onPanRotate(){return!1}}class Tt extends ft.A{get ViewportType(){return ot.A}get ControllerType(){return Pt}}(0,l.A)(Tt,"displayName","OrthographicView");var Ot=n(2249);class It extends Ot.y{applyConstraints(t){const{maxZoom:e,minZoom:n,zoom:r}=t;t.zoom=(0,_t.qE)(r,n,e);const{longitude:i,latitude:o}=t;return(i<-180||i>180)&&(t.longitude=(0,mt.zi)(i+180,360)-180),t.latitude=(0,_t.qE)(o,-89,89),t}}class Rt extends gt.A{constructor(...t){super(...t),(0,l.A)(this,"ControllerState",It),(0,l.A)(this,"transition",{transitionDuration:300,transitionInterpolator:new vt.A(["longitude","latitude","zoom"])}),(0,l.A)(this,"dragMode","pan")}setProps(t){super.setProps(t),this.dragRotate=!1,this.touchRotate=!1}}class Bt extends ft.A{get ViewportType(){return $.A}get ControllerType(){return Rt}}(0,l.A)(Bt,"displayName","GlobeView");var Lt=n(5105),kt=n(52473),Dt=n(45272);const Ft={bearing:0,pitch:0,position:[0,0,0]},Nt={speed:1.2,curve:1.414};class jt extends Dt.A{constructor(t={}){super({compare:["longitude","latitude","zoom","bearing","pitch","position"],extract:["width","height","longitude","latitude","zoom","bearing","pitch","position"],required:["width","height","latitude","longitude","zoom"]}),(0,l.A)(this,"opts",void 0),this.opts={...Nt,...t}}interpolateProps(t,e,n){const r=(0,et.flyToViewport)(t,e,n,this.opts);for(const i in Ft)r[i]=(0,_t.Cc)(t[i]||Ft[i],e[i]||Ft[i],n);return r}getDuration(t,e){let{transitionDuration:n}=e;return"auto"===n&&(n=(0,et.getFlyToDuration)(t,e,this.opts)),n}}var Gt=n(26820),Ut=n(40898),zt=n(97870),Vt=n(57512),Ht=n(93716),qt=n(2353),Wt=n(75107),Jt=n(1490),Yt=n(49605),Xt=n(49949)},83726:(t,e,n)=>{"use strict";n.d(e,{A:()=>I});var r=n(67136),i=n(77325),o=n(38404),s=n(62671);class a{constructor(t,e){(0,r.A)(this,"opts",void 0),(0,r.A)(this,"source",void 0),this.opts=e,this.source=t}get value(){return this.source.value}getValue(){const t=this.source.getBuffer(),e=this.getAccessor();if(t)return[t,e];const{value:n}=this.source,{size:r}=e;let i=n;if(n&&n.length!==r){i=new Float32Array(r);const t=e.elementOffset||0;for(let e=0;e<r;++e)i[e]=n[t+e]}return i}getAccessor(){return{...this.source.getAccessor(),...this.opts}}}var l=n(65656),u=n(51682),c=n(26820);function h(t){return t.stride||t.size*t.bytesPerElement}function d(t,e){e.offset&&c.A.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const n=h(t),r=(void 0!==e.vertexOffset?e.vertexOffset:t.vertexOffset||0)*n+(e.elementOffset||0)*t.bytesPerElement+(t.offset||0);return{...e,offset:r,stride:n}}class f{constructor(t,e,n){(0,r.A)(this,"gl",void 0),(0,r.A)(this,"id",void 0),(0,r.A)(this,"size",void 0),(0,r.A)(this,"settings",void 0),(0,r.A)(this,"value",void 0),(0,r.A)(this,"doublePrecision",void 0),(0,r.A)(this,"_buffer",void 0),(0,r.A)(this,"state",void 0),this.gl=t,this.id=e.id||"",this.size=e.size||1;const s=e.logicalType||e.type,a=5130===s;let l,{defaultValue:u}=e;u=Number.isFinite(u)?[u]:u||new Array(this.size).fill(0),l=a?5126:!s&&e.isIndexed?t&&(0,i.jI)(t,o.G.ELEMENT_INDEX_UINT32)?5125:5123:s||5126;let c=function(t){switch(t){case 5126:return Float32Array;case 5130:return Float64Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return Uint8ClampedArray;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Unknown GL type")}}(s||l||5126);this.doublePrecision=a,a&&!1===e.fp64&&(c=Float32Array),this.value=null,this.settings={...e,defaultType:c,defaultValue:u,logicalType:s,type:l,size:this.size,bytesPerElement:c.BYTES_PER_ELEMENT},this.state={...n,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1},this._buffer=null}get isConstant(){return this.state.constant}get buffer(){if(!this._buffer){const{isIndexed:t,type:e}=this.settings;this._buffer=new s.A(this.gl,{id:this.id,target:t?34963:34962,accessor:{type:e}})}return this._buffer}get byteOffset(){const t=this.getAccessor();return t.vertexOffset?t.vertexOffset*h(t):0}get numInstances(){return this.state.numInstances}set numInstances(t){this.state.numInstances=t}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),l.A.release(this.state.allocatedValue)}getShaderAttributes(t,e){if(this.doublePrecision){const n={},r=this.value instanceof Float64Array,i=function(t,e){const n=d(t,e);return{high:n,low:{...n,offset:n.offset+4*t.size}}}(this.getAccessor(),e||{});return n[t]=new a(this,i.high),n["".concat(t,"64Low")]=r?new a(this,i.low):new Float32Array(this.size),n}if(e){const n=d(this.getAccessor(),e);return{[t]:new a(this,n)}}return{[t]:this}}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(){return this.state.constant?this.value:[this.getBuffer(),this.getAccessor()]}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let t=null;if(this.state.constant&&this.value){const e=Array.from(this.value);t=[e,e]}else{const{value:e,numInstances:n,size:r}=this,i=n*r;if(e&&i&&e.length>=i){const n=new Array(r).fill(1/0),o=new Array(r).fill(-1/0);for(let t=0;t<i;)for(let i=0;i<r;i++){const r=e[t++];r<n[i]&&(n[i]=r),r>o[i]&&(o[i]=r)}t=[n,o]}}return this.state.bounds=t,t}setData(t){const{state:e}=this;let n;n=ArrayBuffer.isView(t)?{value:t}:t instanceof s.A?{buffer:t}:t;const r={...this.settings,...n};if(e.bufferAccessor=r,e.bounds=null,n.constant){let t=n.value;if(t=this._normalizeValue(t,[],0),this.settings.normalized&&(t=this.normalizeConstant(t)),e.constant&&this._areValuesEqual(t,this.value))return!1;e.externalBuffer=null,e.constant=!0,this.value=t}else if(n.buffer){const t=n.buffer;e.externalBuffer=t,e.constant=!1,this.value=n.value||null;const i=n.value instanceof Float64Array;r.type=n.type||t.accessor.type,r.bytesPerElement=t.accessor.BYTES_PER_ELEMENT*(i?2:1),r.stride=h(r)}else if(n.value){this._checkExternalBuffer(n);let t=n.value;e.externalBuffer=null,e.constant=!1,this.value=t,r.bytesPerElement=t.BYTES_PER_ELEMENT,r.stride=h(r);const{buffer:i,byteOffset:o}=this;this.doublePrecision&&t instanceof Float64Array&&(t=(0,u.cT)(t,r));const s=t.byteLength+o+2*r.stride;i.byteLength<s&&i.reallocate(s),i.setAccessor(null),i.subData({data:t,offset:o}),r.type=n.type||i.accessor.type}return!0}updateSubBuffer(t={}){this.state.bounds=null;const e=this.value,{startOffset:n=0,endOffset:r}=t;this.buffer.subData({data:this.doublePrecision&&e instanceof Float64Array?(0,u.cT)(e,{size:this.size,startIndex:n,endIndex:r}):e.subarray(n,r),offset:n*e.BYTES_PER_ELEMENT+this.byteOffset})}allocate(t,e=!1){const{state:n}=this,r=n.allocatedValue,i=l.A.allocate(r,t+1,{size:this.size,type:this.settings.defaultType,copy:e});this.value=i;const{buffer:o,byteOffset:s}=this;return o.byteLength<i.byteLength+s&&(o.reallocate(i.byteLength+s),e&&r&&o.subData({data:r instanceof Float64Array?(0,u.cT)(r,this):r,offset:s})),n.allocatedValue=i,n.constant=!1,n.externalBuffer=null,n.bufferAccessor=this.settings,!0}_checkExternalBuffer(t){const{value:e}=t;if(!ArrayBuffer.isView(e))throw new Error("Attribute ".concat(this.id," value is not TypedArray"));const n=this.settings.defaultType;let r=!1;if(this.doublePrecision&&(r=e.BYTES_PER_ELEMENT<4),r)throw new Error("Attribute ".concat(this.id," does not support ").concat(e.constructor.name));e instanceof n||!this.settings.normalized||"normalized"in t||c.A.warn("Attribute ".concat(this.id," is normalized"))()}normalizeConstant(t){switch(this.settings.type){case 5120:return new Float32Array(t).map((t=>(t+128)/255*2-1));case 5122:return new Float32Array(t).map((t=>(t+32768)/65535*2-1));case 5121:return new Float32Array(t).map((t=>t/255));case 5123:return new Float32Array(t).map((t=>t/65535));default:return t}}_normalizeValue(t,e,n){const{defaultValue:r,size:i}=this.settings;if(Number.isFinite(t))return e[n]=t,e;if(!t){let t=i;for(;--t>=0;)e[n+t]=r[t];return e}switch(i){case 4:e[n+3]=Number.isFinite(t[3])?t[3]:r[3];case 3:e[n+2]=Number.isFinite(t[2])?t[2]:r[2];case 2:e[n+1]=Number.isFinite(t[1])?t[1]:r[1];case 1:e[n+0]=Number.isFinite(t[0])?t[0]:r[0];break;default:let o=i;for(;--o>=0;)e[n+o]=Number.isFinite(t[o])?t[o]:r[o]}return e}_areValuesEqual(t,e){if(!t||!e)return!1;const{size:n}=this;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}}var p=n(40898),g=n(97870),y=n(93716);const m=[],v=[[0,1/0]];var b=n(86992);class _ extends f{constructor(t,e){super(t,e,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,updateRanges:v}),(0,r.A)(this,"constant",!1),this.settings.update=e.update||(e.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(t){this.state.startIndices=t}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:t=!1}={}){const e=this.state.needsRedraw;return this.state.needsRedraw=e&&!t,e}getUpdateTriggers(){const{accessor:t}=this.settings;return[this.id].concat("function"!=typeof t&&t||[])}supportsTransition(){return Boolean(this.settings.transition)}getTransitionSetting(t){if(!t||!this.supportsTransition())return null;const{accessor:e}=this.settings,n=this.settings.transition,r=Array.isArray(e)?t[e.find((e=>t[e]))]:t[e];return(0,b.K$)(r,n)}setNeedsUpdate(t=this.id,e){if(this.state.needsUpdate=this.state.needsUpdate||t,this.setNeedsRedraw(t),e){const{startRow:t=0,endRow:n=1/0}=e;this.state.updateRanges=function(t,e){if(t===v)return t;if(e[0]<0&&(e[0]=0),e[0]>=e[1])return t;const n=[],r=t.length;let i=0;for(let o=0;o<r;o++){const r=t[o];r[1]<e[0]?(n.push(r),i=o+1):r[0]>e[1]?n.push(r):e=[Math.min(r[0],e[0]),Math.max(r[1],e[1])]}return n.splice(i,0,e),n}(this.state.updateRanges,[t,n])}else this.state.updateRanges=v}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=m}setNeedsRedraw(t=this.id){this.state.needsRedraw=this.state.needsRedraw||t}allocate(t){const{state:e,settings:n}=this;return!n.noAlloc&&!!n.update&&(super.allocate(t,e.updateRanges!==v),!0)}updateBuffer({numInstances:t,data:e,props:n,context:r}){if(!this.needsUpdate())return!1;const{state:{updateRanges:i},settings:{update:o,noAlloc:s}}=this;let a=!0;if(o){for(const[s,a]of i)o.call(r,this,{data:e,startRow:s,endRow:a,props:n,numInstances:t});if(this.value)if(this.constant||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[e,n]of i){const r=Number.isFinite(e)?this.getVertexOffset(e):0,i=Number.isFinite(n)?this.getVertexOffset(n):s||!Number.isFinite(t)?this.value.length:t*this.size;super.updateSubBuffer({startOffset:r,endOffset:i})}this._checkAttributeArray()}else a=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),a}setConstantValue(t){return void 0!==t&&"function"!=typeof t&&(this.setData({constant:!0,value:t})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0)}setExternalBuffer(t){const{state:e}=this;return t?(this.clearNeedsUpdate(),e.lastExternalBuffer===t||(e.lastExternalBuffer=t,this.setNeedsRedraw(),this.setData(t)),!0):(e.lastExternalBuffer=null,!1)}setBinaryValue(t,e=null){const{state:n,settings:r}=this;if(!t)return n.binaryValue=null,n.binaryAccessor=null,!1;if(r.noAlloc)return!1;if(n.binaryValue===t)return this.clearNeedsUpdate(),!0;if(n.binaryValue=t,this.setNeedsRedraw(),r.transform||e!==this.startIndices){ArrayBuffer.isView(t)&&(t={value:t});const i=t;(0,p.A)(ArrayBuffer.isView(i.value),"invalid ".concat(r.accessor));const o=Boolean(i.size)&&i.size!==this.size;return n.binaryAccessor=(0,g.I)(i.value,{size:i.size||this.size,stride:i.stride,offset:i.offset,startIndices:e,nested:o}),!1}return this.clearNeedsUpdate(),this.setData(t),!0}getVertexOffset(t){const{startIndices:e}=this;return(e?t<e.length?e[t]:this.numInstances:t)*this.size}getShaderAttributes(){const t=this.settings.shaderAttributes||{[this.id]:null},e={};for(const n in t)Object.assign(e,super.getShaderAttributes(n,t[n]));return e}_autoUpdater(t,{data:e,startRow:n,endRow:r,props:i,numInstances:o}){if(t.constant)return;const{settings:s,state:a,value:l,size:u,startIndices:c}=t,{accessor:h,transform:d}=s,f=a.binaryAccessor||("function"==typeof h?h:i[h]);(0,p.A)("function"==typeof f,'accessor "'.concat(h,'" is not a function'));let m=t.getVertexOffset(n);const{iterable:v,objectInfo:b}=(0,g.X)(e,n,r);for(const e of v){b.index++;let n=f(e,b);if(d&&(n=d.call(this,n)),c){const e=(b.index<c.length-1?c[b.index+1]:o)-c[b.index];if(n&&Array.isArray(n[0])){let e=m;for(const r of n)t._normalizeValue(r,l,e),e+=u}else n&&n.length>u?l.set(n,m):(t._normalizeValue(n,b.target,0),(0,y.R)({target:l,source:b.target,start:m,count:e}));m+=e*u}else t._normalizeValue(n,l,m),m+=u}}_validateAttributeUpdaters(){const{settings:t}=this;if(!t.noAlloc&&"function"!=typeof t.update)throw new Error("Attribute ".concat(this.id," missing update or accessor"))}_checkAttributeArray(){const{value:t}=this,e=Math.min(4,this.size);if(t&&t.length>=e){let n=!0;switch(e){case 4:n=n&&Number.isFinite(t[3]);case 3:n=n&&Number.isFinite(t[2]);case 2:n=n&&Number.isFinite(t[1]);case 1:n=n&&Number.isFinite(t[0]);break;default:n=!1}if(!n)throw new Error("Illegal attribute generated for ".concat(this.id))}}}var A=n(1490),x=n(52908),w=n(65079),C=n(82904);var S=n(27968),E=n(26107),M=n(80606);const P={interpolation:class{constructor({gl:t,attribute:e,timeline:n}){(0,r.A)(this,"gl",void 0),(0,r.A)(this,"type","interpolation"),(0,r.A)(this,"attributeInTransition",void 0),(0,r.A)(this,"settings",void 0),(0,r.A)(this,"attribute",void 0),(0,r.A)(this,"transition",void 0),(0,r.A)(this,"currentStartIndices",void 0),(0,r.A)(this,"currentLength",void 0),(0,r.A)(this,"transform",void 0),(0,r.A)(this,"buffers",void 0),this.gl=t,this.transition=new C.A(n),this.attribute=e,this.attributeInTransition=new _(t,e.settings),this.currentStartIndices=e.startIndices,this.currentLength=0,this.transform=function(t,e){const n=(0,b.A3)(e.size);return new w.A(t,{vs:"\n#define SHADER_NAME interpolation-transition-vertex-shader\n\nuniform float time;\nattribute ATTRIBUTE_TYPE aFrom;\nattribute ATTRIBUTE_TYPE aTo;\nvarying ATTRIBUTE_TYPE vCurrent;\n\nvoid main(void) {\n  vCurrent = mix(aFrom, aTo, time);\n  gl_Position = vec4(0.0);\n}\n",defines:{ATTRIBUTE_TYPE:n},varyings:["vCurrent"]})}(t,e);const i={byteLength:0,usage:35050};this.buffers=[new s.A(t,i),new s.A(t,i)]}get inProgress(){return this.transition.inProgress}start(t,e){if(t.duration<=0)return void this.transition.cancel();this.settings=t;const{gl:n,buffers:r,attribute:i}=this;(0,b.yY)(r);const o={numInstances:e,attribute:i,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:t.enter};for(const t of r)(0,b.aI)({buffer:t,...o});this.currentStartIndices=i.startIndices,this.currentLength=(0,b.Pu)(i,e),this.attributeInTransition.setData({buffer:r[1],value:i.value}),this.transition.start(t),this.transform.update({elementCount:Math.floor(this.currentLength/i.size),sourceBuffers:{aFrom:r[0],aTo:(0,b.EX)(n,i)},feedbackBuffers:{vCurrent:r[1]}})}update(){const t=this.transition.update();if(t){const{duration:t,easing:e}=this.settings,{time:n}=this.transition;let r=n/t;e&&(r=e(r)),this.transform.run({uniforms:{time:r}})}return t}cancel(){this.transition.cancel(),this.transform.delete();for(const t of this.buffers)t.delete();this.buffers.length=0}},spring:class{constructor({gl:t,attribute:e,timeline:n}){(0,r.A)(this,"gl",void 0),(0,r.A)(this,"type","spring"),(0,r.A)(this,"attributeInTransition",void 0),(0,r.A)(this,"settings",void 0),(0,r.A)(this,"attribute",void 0),(0,r.A)(this,"transition",void 0),(0,r.A)(this,"currentStartIndices",void 0),(0,r.A)(this,"currentLength",void 0),(0,r.A)(this,"texture",void 0),(0,r.A)(this,"framebuffer",void 0),(0,r.A)(this,"transform",void 0),(0,r.A)(this,"buffers",void 0),this.gl=t,this.type="spring",this.transition=new C.A(n),this.attribute=e,this.attributeInTransition=new _(t,{...e.settings,normalized:!1}),this.currentStartIndices=e.startIndices,this.currentLength=0,this.texture=function(t){return new E.A(t,{data:new Uint8Array(4),format:6408,type:5121,border:0,mipmaps:!1,dataFormat:6408,width:1,height:1})}(t),this.framebuffer=function(t,e){return new M.A(t,{id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,attachments:{36064:e}})}(t,this.texture),this.transform=function(t,e,n){const r=(0,b.A3)(e.size);return new w.A(t,{framebuffer:n,vs:"\n#define SHADER_NAME spring-transition-vertex-shader\n\n#define EPSILON 0.00001\n\nuniform float stiffness;\nuniform float damping;\nattribute ATTRIBUTE_TYPE aPrev;\nattribute ATTRIBUTE_TYPE aCur;\nattribute ATTRIBUTE_TYPE aTo;\nvarying ATTRIBUTE_TYPE vNext;\nvarying float vIsTransitioningFlag;\n\nATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {\n  ATTRIBUTE_TYPE velocity = cur - prev;\n  ATTRIBUTE_TYPE delta = dest - cur;\n  ATTRIBUTE_TYPE spring = delta * stiffness;\n  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;\n  return spring + damper + velocity + cur;\n}\n\nvoid main(void) {\n  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;\n  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;\n\n  vNext = getNextValue(aCur, aPrev, aTo);\n  gl_Position = vec4(0, 0, 0, 1);\n  gl_PointSize = 100.0;\n}\n",fs:"\n#define SHADER_NAME spring-transition-is-transitioning-fragment-shader\n\nvarying float vIsTransitioningFlag;\n\nvoid main(void) {\n  if (vIsTransitioningFlag == 0.0) {\n    discard;\n  }\n  gl_FragColor = vec4(1.0);\n}",defines:{ATTRIBUTE_TYPE:r},varyings:["vNext"]})}(t,e,this.framebuffer);const i={byteLength:0,usage:35050};this.buffers=[new s.A(t,i),new s.A(t,i),new s.A(t,i)]}get inProgress(){return this.transition.inProgress}start(t,e){const{gl:n,buffers:r,attribute:i}=this,o={numInstances:e,attribute:i,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:t.enter};for(const t of r)(0,b.aI)({buffer:t,...o});this.settings=t,this.currentStartIndices=i.startIndices,this.currentLength=(0,b.Pu)(i,e),this.attributeInTransition.setData({buffer:r[1],value:i.value}),this.transition.start({...t,duration:1/0}),this.transform.update({elementCount:Math.floor(this.currentLength/i.size),sourceBuffers:{aTo:(0,b.EX)(n,i)}})}update(){const{buffers:t,transform:e,framebuffer:n,transition:r}=this;if(!r.update())return!1;const i=this.settings;return e.update({sourceBuffers:{aPrev:t[0],aCur:t[1]},feedbackBuffers:{vNext:t[2]}}),e.run({framebuffer:n,discard:!1,clearRenderTarget:!0,uniforms:{stiffness:i.stiffness,damping:i.damping},parameters:{depthTest:!1,blend:!0,viewport:[0,0,1,1],blendFunc:[1,1],blendEquation:[32776,32776]}}),(0,b.yY)(t),this.attributeInTransition.setData({buffer:t[1],value:this.attribute.value}),(0,S.sy)(n)[0]>0||r.end(),!0}cancel(){this.transition.cancel(),this.transform.delete();for(const t of this.buffers)t.delete();this.buffers.length=0,this.texture.delete(),this.framebuffer.delete()}}};class T{constructor(t,{id:e,timeline:n}){(0,r.A)(this,"id",void 0),(0,r.A)(this,"isSupported",void 0),(0,r.A)(this,"gl",void 0),(0,r.A)(this,"timeline",void 0),(0,r.A)(this,"transitions",void 0),(0,r.A)(this,"needsRedraw",void 0),(0,r.A)(this,"numInstances",void 0),this.id=e,this.gl=t,this.timeline=n,this.transitions={},this.needsRedraw=!1,this.numInstances=1,this.isSupported=w.A.isSupported(t)}finalize(){for(const t in this.transitions)this._removeTransition(t)}update({attributes:t,transitions:e,numInstances:n}){this.numInstances=n||1;for(const n in t){const r=t[n],i=r.getTransitionSetting(e);i&&this._updateAttribute(n,r,i)}for(const n in this.transitions){const r=t[n];r&&r.getTransitionSetting(e)||this._removeTransition(n)}}hasAttribute(t){const e=this.transitions[t];return e&&e.inProgress}getAttributes(){const t={};for(const e in this.transitions){const n=this.transitions[e];n.inProgress&&(t[e]=n.attributeInTransition)}return t}run(){if(!this.isSupported||0===this.numInstances)return!1;for(const t in this.transitions)this.transitions[t].update()&&(this.needsRedraw=!0);const t=this.needsRedraw;return this.needsRedraw=!1,t}_removeTransition(t){this.transitions[t].cancel(),delete this.transitions[t]}_updateAttribute(t,e,n){const r=this.transitions[t];let i=!r||r.type!==n.type;if(i){if(!this.isSupported)return void c.A.warn("WebGL2 not supported by this browser. Transition for ".concat(t," is disabled."))();r&&this._removeTransition(t);const o=P[n.type];o?this.transitions[t]=new o({attribute:e,timeline:this.timeline,gl:this.gl}):(c.A.error("unsupported transition type '".concat(n.type,"'"))(),i=!1)}(i||e.needsRedraw())&&(this.needsRedraw=!0,this.transitions[t].start(n,this.numInstances))}}const O="attributeManager.invalidate";class I{constructor(t,{id:e="attribute-manager",stats:n,timeline:i}={}){(0,r.A)(this,"id",void 0),(0,r.A)(this,"gl",void 0),(0,r.A)(this,"attributes",void 0),(0,r.A)(this,"updateTriggers",void 0),(0,r.A)(this,"needsRedraw",void 0),(0,r.A)(this,"userData",void 0),(0,r.A)(this,"stats",void 0),(0,r.A)(this,"attributeTransitionManager",void 0),(0,r.A)(this,"mergeBoundsMemoized",(0,A.A)(u._Z)),this.id=e,this.gl=t,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=n,this.attributeTransitionManager=new T(t,{id:"".concat(e,"-transitions"),timeline:i}),Object.seal(this)}finalize(){for(const t in this.attributes)this.attributes[t].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(t={clearRedrawFlags:!1}){const e=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!t.clearRedrawFlags,e&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(t){this._add(t)}addInstanced(t){this._add(t,{instanced:1})}remove(t){for(const e of t)void 0!==this.attributes[e]&&(this.attributes[e].delete(),delete this.attributes[e])}invalidate(t,e){const n=this._invalidateTrigger(t,e);(0,x.A)(O,this,t,n)}invalidateAll(t){for(const e in this.attributes)this.attributes[e].setNeedsUpdate(e,t);(0,x.A)(O,this,"all")}update({data:t,numInstances:e,startIndices:n=null,transitions:r,props:i={},buffers:o={},context:s={}}){let a=!1;(0,x.A)("attributeManager.updateStart",this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const r in this.attributes){const l=this.attributes[r],u=l.settings.accessor;l.startIndices=n,l.numInstances=e,i[r]&&c.A.removed("props.".concat(r),"data.attributes.".concat(r))(),l.setExternalBuffer(o[r])||l.setBinaryValue("string"==typeof u?o[u]:void 0,t.startIndices)||"string"==typeof u&&!o[u]&&l.setConstantValue(i[u])||l.needsUpdate()&&(a=!0,this._updateAttribute({attribute:l,numInstances:e,data:t,props:i,context:s})),this.needsRedraw=this.needsRedraw||l.needsRedraw()}a&&(0,x.A)("attributeManager.updateEnd",this,e),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:e,transitions:r})}updateTransition(){const{attributeTransitionManager:t}=this,e=t.run();return this.needsRedraw=this.needsRedraw||e,e}getAttributes(){return this.attributes}getBounds(t){const e=t.map((t=>{var e;return null===(e=this.attributes[t])||void 0===e?void 0:e.getBounds()}));return this.mergeBoundsMemoized(e)}getChangedAttributes(t={clearChangedFlags:!1}){const{attributes:e,attributeTransitionManager:n}=this,r={...n.getAttributes()};for(const i in e){const o=e[i];o.needsRedraw(t)&&!n.hasAttribute(i)&&(r[i]=o)}return r}getShaderAttributes(t,e={}){t||(t=this.getAttributes());const n={};for(const r in t)e[r]||Object.assign(n,t[r].getShaderAttributes());return n}_add(t,e={}){for(const n in t){const r=t[n];this.attributes[n]=this._createAttribute(n,r,e)}this._mapUpdateTriggersToAttributes()}_createAttribute(t,e,n){const r={...e,id:t,size:(e.isIndexed?1:e.size)||1,divisor:n.instanced?1:e.divisor||0};return new _(this.gl,r)}_mapUpdateTriggersToAttributes(){const t={};for(const e in this.attributes)this.attributes[e].getUpdateTriggers().forEach((n=>{t[n]||(t[n]=[]),t[n].push(e)}));this.updateTriggers=t}_invalidateTrigger(t,e){const{attributes:n,updateTriggers:r}=this,i=r[t];return i&&i.forEach((t=>{const r=n[t];r&&r.setNeedsUpdate(r.id,e)})),i}_updateAttribute(t){const{attribute:e,numInstances:n}=t;(0,x.A)("attribute.updateStart",e),e.constant?e.setConstantValue(e.value):(e.allocate(n)&&(0,x.A)("attribute.allocate",e,n),e.updateBuffer(t)&&(this.needsRedraw=!0,(0,x.A)("attribute.updateEnd",e,n)))}}},86992:(t,e,n)=>{"use strict";function r(t){const{source:e,target:n,start:r=0,size:i,getData:o}=t,s=t.end||n.length,a=e.length,l=s-r;if(a>l)return void n.set(e.subarray(0,l),r);if(n.set(e,r),!o)return;let u=a;for(;u<l;){const t=o(u,e);for(let e=0;e<i;e++)n[r+u]=t[e]||0,u++}}n.d(e,{yY:()=>l,Pu:()=>u,A3:()=>a,EX:()=>s,K$:()=>o,aI:()=>c});const i={interpolation:{duration:0,easing:t=>t},spring:{stiffness:.05,damping:.5}};function o(t,e){if(!t)return null;Number.isFinite(t)&&(t={type:"interpolation",duration:t});const n=t.type||"interpolation";return{...i[n],...e,...t,type:n}}function s(t,e){const n=e.getBuffer();return n?[n,{divisor:0,size:e.size,normalized:e.settings.normalized}]:e.value}function a(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error('No defined attribute type for size "'.concat(t,'"'))}}function l(t){t.push(t.shift())}function u(t,e){const{doublePrecision:n,settings:r,value:i,size:o}=t,s=n&&i instanceof Float64Array?2:1;return(r.noAlloc?i.length:e*o)*s}function c({buffer:t,numInstances:e,attribute:n,fromLength:i,fromStartIndices:o,getData:s=t=>t}){const a=n.doublePrecision&&n.value instanceof Float64Array?2:1,l=n.size*a,c=n.byteOffset,h=n.startIndices,d=o&&h,f=u(n,e),p=n.isConstant;if(!d&&i>=f)return;const g=p?n.value:n.getBuffer().getData({srcByteOffset:c});if(n.settings.normalized&&!p){const t=s;s=(e,r)=>n.normalizeConstant(t(e,r))}const y=p?(t,e)=>s(g,e):(t,e)=>s(g.subarray(t,t+l),e),m=t.getData({length:i}),v=new Float32Array(f);!function({source:t,target:e,size:n,getData:i,sourceStartIndices:o,targetStartIndices:s}){if(!Array.isArray(s))return r({source:t,target:e,size:n,getData:i}),e;let a=0,l=0;const u=i&&((t,e)=>i(t+l,e)),c=Math.min(o.length,s.length);for(let i=1;i<c;i++){const c=o[i]*n,h=s[i]*n;r({source:t.subarray(a,c),target:e,start:l,end:h,size:n,getData:u}),a=c,l=h}l<e.length&&r({source:[],target:e,start:l,size:n,getData:u})}({source:m,target:v,sourceStartIndices:o,targetStartIndices:h,size:l,getData:y}),t.byteLength<v.byteLength+c&&t.reallocate(v.byteLength+c),t.subData({data:v,offset:c})}},68411:(t,e,n)=>{"use strict";n.d(e,{A:()=>l});var r=n(67136),i=n(36179),o=n(52908),s=n(93716),a=n(47810);class l extends i.A{get isComposite(){return!0}get isLoaded(){return super.isLoaded&&this.getSubLayers().every((t=>t.isLoaded))}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(t){}setState(t){super.setState(t),this.setNeedsUpdate()}getPickingInfo({info:t}){const{object:e}=t;return e&&e.__source&&e.__source.parent&&e.__source.parent.id===this.id?(t.object=e.__source.object,t.index=e.__source.index,t):t}filterSubLayer(t){return!0}shouldRenderSubLayer(t,e){return e&&e.length}getSubLayerClass(t,e){const{_subLayerProps:n}=this.props;return n&&n[t]&&n[t].type||e}getSubLayerRow(t,e,n){return t.__source={parent:this,object:e,index:n},t}getSubLayerAccessor(t){if("function"==typeof t){const e={index:-1,data:this.props.data,target:[]};return(n,r)=>n&&n.__source?(e.index=n.__source.index,t(n.__source.object,e)):t(n,r)}return t}getSubLayerProps(t={}){var e;const{opacity:n,pickable:r,visible:i,parameters:o,getPolygonOffset:s,highlightedObjectIndex:l,autoHighlight:u,highlightColor:c,coordinateSystem:h,coordinateOrigin:d,wrapLongitude:f,positionFormat:p,modelMatrix:g,extensions:y,fetch:m,operation:v,_subLayerProps:b}=this.props,_={id:"",updateTriggers:{},opacity:n,pickable:r,visible:i,parameters:o,getPolygonOffset:s,highlightedObjectIndex:l,autoHighlight:u,highlightColor:c,coordinateSystem:h,coordinateOrigin:d,wrapLongitude:f,positionFormat:p,modelMatrix:g,extensions:y,fetch:m,operation:v},A=b&&t.id&&b[t.id],x=A&&A.updateTriggers,w=t.id||"sublayer";if(A){const e=this.props[a.fW],n=t.type?t.type._propTypes:{};for(const t in A){const r=n[t]||e[t];r&&"accessor"===r.type&&(A[t]=this.getSubLayerAccessor(A[t]))}}Object.assign(_,t,A),_.id="".concat(this.props.id,"-").concat(w),_.updateTriggers={all:null===(e=this.props.updateTriggers)||void 0===e?void 0:e.all,...t.updateTriggers,...x};for(const t of y){const e=t.getSubLayerProps.call(this,t);e&&Object.assign(_,e,{updateTriggers:Object.assign(_.updateTriggers,e.updateTriggers)})}return _}_updateAutoHighlight(t){for(const e of this.getSubLayers())e.updateAutoHighlight(t)}_getAttributeManager(){return null}_postUpdate(t,e){let n=this.internalState.subLayers;const r=!n||this.needsUpdate();if(r){const t=this.renderLayers();n=(0,s.B)(t,Boolean),this.internalState.subLayers=n}(0,o.A)("compositeLayer.renderLayers",this,r,n);for(const t of n)t.parent=this}}(0,r.A)(l,"layerName","CompositeLayer")},1597:(t,e,n)=>{"use strict";n.d(e,{Kx:()=>o,p5:()=>s,qR:()=>l,qY:()=>a,rf:()=>i});var r=n(26820);const i={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(i,"IDENTITY",{get:()=>(r.A.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});const o={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},s={common:0,meters:1,pixels:2},a={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}},l={DRAW:"draw",MASK:"mask",TERRAIN:"terrain"}},345:(t,e,n)=>{"use strict";n.d(e,{A:()=>u});var r=n(67136),i=n(52908),o=n(64156);class s extends o.A{shouldDrawLayer(t){const{operation:e}=t.props;return e.includes("draw")||e.includes("terrain")}}var a=n(64766),l=n(80606);class u{constructor(t){(0,r.A)(this,"gl",void 0),(0,r.A)(this,"layerFilter",void 0),(0,r.A)(this,"drawPickingColors",void 0),(0,r.A)(this,"drawLayersPass",void 0),(0,r.A)(this,"pickLayersPass",void 0),(0,r.A)(this,"renderCount",void 0),(0,r.A)(this,"_needsRedraw",void 0),(0,r.A)(this,"renderBuffers",void 0),(0,r.A)(this,"lastPostProcessEffect",void 0),this.gl=t,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new s(t),this.pickLayersPass=new a.A(t),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(t){this.layerFilter!==t.layerFilter&&(this.layerFilter=t.layerFilter,this._needsRedraw="layerFilter changed"),this.drawPickingColors!==t.drawPickingColors&&(this.drawPickingColors=t.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(t){if(!t.viewports.length)return;const e=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass,n={layerFilter:this.layerFilter,isPicking:this.drawPickingColors,...t,target:t.target||l.A.getDefaultFramebuffer(this.gl)};n.effects&&this._preRender(n.effects,n);const r=this.lastPostProcessEffect?this.renderBuffers[0]:n.target,o=e.render({...n,target:r});n.effects&&this._postRender(n.effects,n),this.renderCount++,(0,i.A)("deckRenderer.renderLayers",this,o,t)}needsRedraw(t={clearRedrawFlags:!1}){const e=this._needsRedraw;return t.clearRedrawFlags&&(this._needsRedraw=!1),e}finalize(){const{renderBuffers:t}=this;for(const e of t)e.delete();t.length=0}_preRender(t,e){this.lastPostProcessEffect=null,e.preRenderStats=e.preRenderStats||{};for(const n of t)e.preRenderStats[n.id]=n.preRender(this.gl,e),n.postRender&&(this.lastPostProcessEffect=n.id);this.lastPostProcessEffect&&this._resizeRenderBuffers()}_resizeRenderBuffers(){const{renderBuffers:t}=this;0===t.length&&t.push(new l.A(this.gl),new l.A(this.gl));for(const e of t)e.resize()}_postRender(t,e){const{renderBuffers:n}=this,r={...e,inputBuffer:n[0],swapBuffer:n[1],target:null};for(const i of t)if(i.postRender){if(i.id===this.lastPostProcessEffect){r.target=e.target,i.postRender(this.gl,r);break}const t=i.postRender(this.gl,r);r.inputBuffer=t,r.swapBuffer=t===n[0]?n[1]:n[0]}}}},88059:(t,e,n)=>{"use strict";n.d(e,{A:()=>Ct});var r=n(67136),i=n(29344),o=n(75107),s=n(26820),a=n(93716);class l{constructor(t){(0,r.A)(this,"width",void 0),(0,r.A)(this,"height",void 0),(0,r.A)(this,"views",void 0),(0,r.A)(this,"viewState",void 0),(0,r.A)(this,"controllers",void 0),(0,r.A)(this,"timeline",void 0),(0,r.A)(this,"_viewports",void 0),(0,r.A)(this,"_viewportMap",void 0),(0,r.A)(this,"_isUpdating",void 0),(0,r.A)(this,"_needsRedraw",void 0),(0,r.A)(this,"_needsUpdate",void 0),(0,r.A)(this,"_eventManager",void 0),(0,r.A)(this,"_eventCallbacks",void 0),this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=t.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=t.eventManager,this._eventCallbacks={onViewStateChange:t.onViewStateChange,onInteractionStateChange:t.onInteractionStateChange},Object.seal(this),this.setProps(t)}finalize(){for(const t in this.controllers){const e=this.controllers[t];e&&e.finalize()}this.controllers={}}needsRedraw(t={clearRedrawFlags:!1}){const e=this._needsRedraw;return t.clearRedrawFlags&&(this._needsRedraw=!1),e}setNeedsUpdate(t){this._needsUpdate=this._needsUpdate||t,this._needsRedraw=this._needsRedraw||t}updateViewStates(){for(const t in this.controllers){const e=this.controllers[t];e&&e.updateTransition()}}getViewports(t){return t?this._viewports.filter((e=>e.containsPixel(t))):this._viewports}getViews(){const t={};return this.views.forEach((e=>{t[e.id]=e})),t}getView(t){return this.views.find((e=>e.id===t))}getViewState(t){const e="string"==typeof t?this.getView(t):t,n=e&&this.viewState[e.getViewStateId()]||this.viewState;return e?e.filterViewState(n):n}getViewport(t){return this._viewportMap[t]}unproject(t,e){const n=this.getViewports(),r={x:t[0],y:t[1]};for(let i=n.length-1;i>=0;--i){const o=n[i];if(o.containsPixel(r)){const n=t.slice();return n[0]-=o.x,n[1]-=o.y,o.unproject(n,e)}}return null}setProps(t){t.views&&this._setViews(t.views),t.viewState&&this._setViewState(t.viewState),("width"in t||"height"in t)&&this._setSize(t.width,t.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(t,e){t===this.width&&e===this.height||(this.width=t,this.height=e,this.setNeedsUpdate("Size changed"))}_setViews(t){t=(0,a.B)(t,Boolean),this._diffViews(t,this.views)&&this.setNeedsUpdate("views changed"),this.views=t}_setViewState(t){t?(!(0,o.b)(t,this.viewState,3)&&this.setNeedsUpdate("viewState changed"),this.viewState=t):s.A.warn("missing `viewState` or `initialViewState`")()}_onViewStateChange(t,e){this._eventCallbacks.onViewStateChange&&this._eventCallbacks.onViewStateChange({...e,viewId:t})}_createController(t,e){return new(0,e.type)({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._onViewStateChange.bind(this,e.id),onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:e=>{var n;return null===(n=this.getView(t.id))||void 0===n?void 0:n.makeViewport({viewState:e,width:this.width,height:this.height})}})}_updateController(t,e,n,r){const i=t.controller;if(i&&n){const o={...e,...i,id:t.id,x:n.x,y:n.y,width:n.width,height:n.height};return r&&r.constructor===i.type||(r=this._createController(t,o)),r&&r.setProps(o),r}return null}_rebuildViewports(){const{views:t}=this,e=this.controllers;this._viewports=[],this.controllers={};let n=!1;for(let r=t.length;r--;){const i=t[r],o=this.getViewState(i),s=i.makeViewport({viewState:o,width:this.width,height:this.height});let a=e[i.id];const l=Boolean(i.controller);l&&!a&&(n=!0),!n&&l||!a||(a.finalize(),a=null),this.controllers[i.id]=this._updateController(i,o,s,a),s&&this._viewports.unshift(s)}for(const t in e){const n=e[t];n&&!this.controllers[t]&&n.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach((t=>{t.id&&(this._viewportMap[t.id]=this._viewportMap[t.id]||t)}))}_diffViews(t,e){return t.length!==e.length||t.some(((n,r)=>!t[r].equals(e[r])))}}var u=n(45029),c=n(3599);const h=new c.A;class d{constructor(){(0,r.A)(this,"effects",void 0),(0,r.A)(this,"_resolvedEffects",[]),(0,r.A)(this,"_defaultEffects",[]),(0,r.A)(this,"_needsRedraw",void 0),this.effects=[],this._needsRedraw="Initial render",this._setEffects([])}addDefaultEffect(t){const e=this._defaultEffects;if(!e.find((e=>e.id===t.id))){const n=e.findIndex((e=>{return n=t,(null!==(r=e.order)&&void 0!==r?r:1/0)-(null!==(i=n.order)&&void 0!==i?i:1/0)>0;var n,r,i}));n<0?e.push(t):e.splice(n,0,t),this._setEffects(this.effects)}}setProps(t){"effects"in t&&((0,o.b)(t.effects,this.effects,1)||this._setEffects(t.effects))}needsRedraw(t={clearRedrawFlags:!1}){const e=this._needsRedraw;return t.clearRedrawFlags&&(this._needsRedraw=!1),e}getEffects(){return this._resolvedEffects}_setEffects(t){const e={};for(const t of this.effects)e[t.id]=t;const n=[];for(const r of t){const t=e[r.id];t&&t!==r?t.setProps?(t.setProps(r.props),n.push(t)):(t.cleanup(),n.push(r)):n.push(r),delete e[r.id]}for(const t in e)e[t].cleanup();this.effects=n,this._resolvedEffects=n.concat(this._defaultEffects),t.some((t=>t instanceof c.A))||this._resolvedEffects.push(h),this._needsRedraw="effects changed"}finalize(){for(const t of this._resolvedEffects)t.cleanup();this.effects.length=0,this._resolvedEffects.length=0,this._defaultEffects.length=0}}var f=n(345),p=n(80606),g=n(26107),y=n(8282),m=n(27968),v=n(64766);const b={pickedColor:null,pickedObjectIndex:-1};function _({pickedColors:t,decodePickingColor:e,deviceX:n,deviceY:r,deviceRadius:i,deviceRect:o}){const{x:a,y:l,width:u,height:c}=o;let h=i*i,d=-1,f=0;for(let e=0;e<c;e++){const i=e+l-r,o=i*i;if(o>h)f+=4*u;else for(let e=0;e<u;e++){if(t[f+3]-1>=0){const t=e+a-n,r=t*t+o;r<=h&&(h=r,d=f)}f+=4}}if(d>=0){const n=t.slice(d,d+4),r=e(n);if(r){const t=Math.floor(d/4/u),e=d/4-t*u;return{...r,pickedColor:n,pickedX:a+e,pickedY:l+t}}s.A.error("Picked non-existent layer. Is picking buffer corrupt?")()}return b}function A({pickInfo:t,viewports:e,pixelRatio:n,x:r,y:i,z:o}){let s,a=e[0];if(e.length>1&&(a=function(t,e){for(let n=t.length-1;n>=0;n--){const r=t[n];if(r.containsPixel(e))return r}return t[0]}((null==t?void 0:t.pickedViewports)||e,{x:r,y:i})),a){const t=[r-a.x,i-a.y];void 0!==o&&(t[2]=o),s=a.unproject(t)}return{color:null,layer:null,viewport:a,index:-1,picked:!1,x:r,y:i,pixel:[r,i],coordinate:s,devicePixel:t&&"pickedX"in t?[t.pickedX,t.pickedY]:void 0,pixelRatio:n}}function x(t){const{pickInfo:e,lastPickedInfo:n,mode:r,layers:i}=t,{pickedColor:o,pickedLayer:s,pickedObjectIndex:a}=e,l=s?[s]:[];if("hover"===r){const t=n.index,e=n.layerId,r=s?s.props.id:null;if(r!==e||a!==t){if(r!==e){const t=i.find((t=>t.props.id===e));t&&l.unshift(t)}n.layerId=r,n.index=a,n.info=null}}const u=A(t),c=new Map;return c.set(null,u),l.forEach((t=>{let e={...u};t===s&&(e.color=o,e.index=a,e.picked=!0),e=w({layer:t,info:e,mode:r});const i=e.layer;t===s&&"hover"===r&&(n.info=e),c.set(i.id,e),"hover"===r&&i.updateAutoHighlight(e)})),c}function w({layer:t,info:e,mode:n}){for(;t&&e;){const r=e.layer||null;e.sourceLayer=r,e.layer=t,e=t.getPickingInfo({info:e,mode:n,sourceLayer:r}),t=t.parent}return e}class C{constructor(t){(0,r.A)(this,"gl",void 0),(0,r.A)(this,"pickingFBO",void 0),(0,r.A)(this,"depthFBO",void 0),(0,r.A)(this,"pickLayersPass",void 0),(0,r.A)(this,"layerFilter",void 0),(0,r.A)(this,"lastPickedInfo",void 0),(0,r.A)(this,"_pickable",!0),this.gl=t,this.pickLayersPass=new v.A(t),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(t){"layerFilter"in t&&(this.layerFilter=t.layerFilter),"_pickable"in t&&(this._pickable=t._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.delete(),this.depthFBO&&(this.depthFBO.color.delete(),this.depthFBO.delete())}pickObject(t){return this._pickClosestObject(t)}pickObjects(t){return this._pickVisibleObjects(t)}getLastPickedObject({x:t,y:e,layers:n,viewports:r},i=this.lastPickedInfo.info){const o=i&&i.layer&&i.layer.id,s=i&&i.viewport&&i.viewport.id,a=o?n.find((t=>t.id===o)):null,l=s&&r.find((t=>t.id===s))||r[0],u=l&&l.unproject([t-l.x,e-l.y]),c={x:t,y:e,viewport:l,coordinate:u,layer:a};return{...i,...c}}_resizeBuffer(){var t,e;const{gl:n}=this;if(!this.pickingFBO&&(this.pickingFBO=new p.A(n),p.A.isSupported(n,{colorBufferFloat:!0}))){const t=new p.A(n);t.attach({36064:new g.A(n,{format:(0,y.C6)(n)?34836:6408,type:5126})}),this.depthFBO=t}null===(t=this.pickingFBO)||void 0===t||t.resize({width:n.canvas.width,height:n.canvas.height}),null===(e=this.depthFBO)||void 0===e||e.resize({width:n.canvas.width,height:n.canvas.height})}_getPickable(t){if(!1===this._pickable)return null;const e=t.filter((t=>this.pickLayersPass.shouldDrawLayer(t)&&!t.isComposite));return e.length?e:null}_pickClosestObject({layers:t,views:e,viewports:n,x:r,y:i,radius:o=0,depth:s=1,mode:a="query",unproject3D:l,onViewportActive:u,effects:c}){const h=this._getPickable(t),d=(0,y.o0)(this.gl);if(!h)return{result:[],emptyInfo:A({viewports:n,x:r,y:i,pixelRatio:d})};this._resizeBuffer();const f=(0,y.w8)(this.gl,[r,i],!0),p=[f.x+Math.floor(f.width/2),f.y+Math.floor(f.height/2)],g=Math.round(o*d),{width:m,height:v}=this.pickingFBO,b=this._getPickingRect({deviceX:p[0],deviceY:p[1],deviceRadius:g,deviceWidth:m,deviceHeight:v}),w={x:r-o,y:i-o,width:2*o+1,height:2*o+1};let C;const S=[],E=new Set;for(let t=0;t<s;t++){let o,f;if(o=b?_({...this._drawAndSample({layers:h,views:e,viewports:n,onViewportActive:u,deviceRect:b,cullRect:w,effects:c,pass:"picking:".concat(a)}),deviceX:p[0],deviceY:p[1],deviceRadius:g,deviceRect:b}):{pickedColor:null,pickedObjectIndex:-1},o.pickedLayer&&l&&this.depthFBO){const{pickedColors:t}=this._drawAndSample({layers:[o.pickedLayer],views:e,viewports:n,onViewportActive:u,deviceRect:{x:o.pickedX,y:o.pickedY,width:1,height:1},cullRect:w,effects:c,pass:"picking:".concat(a,":z")},!0);t[3]&&(f=t[0])}o.pickedLayer&&t+1<s&&(E.add(o.pickedLayer),o.pickedLayer.disablePickingIndex(o.pickedObjectIndex)),C=x({pickInfo:o,lastPickedInfo:this.lastPickedInfo,mode:a,layers:h,viewports:n,x:r,y:i,z:f,pixelRatio:d});for(const t of C.values())t.layer&&S.push(t);if(!o.pickedColor)break}for(const t of E)t.restorePickingColors();return{result:S,emptyInfo:C.get(null)}}_pickVisibleObjects({layers:t,views:e,viewports:n,x:r,y:i,width:o=1,height:a=1,mode:l="query",maxObjects:u=null,onViewportActive:c,effects:h}){const d=this._getPickable(t);if(!d)return[];this._resizeBuffer();const f=(0,y.o0)(this.gl),p=(0,y.w8)(this.gl,[r,i],!0),g=p.x,m=p.y+p.height,v=(0,y.w8)(this.gl,[r+o,i+a],!0),b=v.x+v.width,_=v.y,A={x:g,y:_,width:b-g,height:m-_},x=function({pickedColors:t,decodePickingColor:e}){const n=new Map;if(t)for(let r=0;r<t.length;r+=4)if(t[r+3]-1>=0){const i=t.slice(r,r+4),o=i.join(",");if(!n.has(o)){const t=e(i);t?n.set(o,{...t,color:i}):s.A.error("Picked non-existent layer. Is picking buffer corrupt?")()}}return Array.from(n.values())}(this._drawAndSample({layers:d,views:e,viewports:n,onViewportActive:c,deviceRect:A,cullRect:{x:r,y:i,width:o,height:a},effects:h,pass:"picking:".concat(l)})),C=new Map,S=Number.isFinite(u);for(let t=0;t<x.length;t++){var E;if(S&&u&&C.size>=u)break;const e=x[t];let n={color:e.pickedColor,layer:null,index:e.pickedObjectIndex,picked:!0,x:r,y:i,pixelRatio:f};n=w({layer:e.pickedLayer,info:n,mode:l});const o=null!==(E=n.object)&&void 0!==E?E:"".concat(n.layer.id,"[").concat(n.index,"]");C.has(o)||C.set(o,n)}return Array.from(C.values())}_drawAndSample({layers:t,views:e,viewports:n,onViewportActive:r,deviceRect:i,cullRect:o,effects:s,pass:a},l=!1){const u=l?this.depthFBO:this.pickingFBO,c={layers:t,layerFilter:this.layerFilter,views:e,viewports:n,onViewportActive:r,pickingFBO:u,deviceRect:i,cullRect:o,effects:s,pass:a,pickZ:l,preRenderStats:{}};for(const t of s)t.useInPicking&&(c.preRenderStats[t.id]=t.preRender(this.gl,c));const{decodePickingColor:h}=this.pickLayersPass.render(c),{x:d,y:f,width:p,height:g}=i,y=new(l?Float32Array:Uint8Array)(p*g*4);return(0,m.sy)(u,{sourceX:d,sourceY:f,sourceWidth:p,sourceHeight:g,target:y}),{pickedColors:y,decodePickingColor:h}}_getPickingRect({deviceX:t,deviceY:e,deviceRadius:n,deviceWidth:r,deviceHeight:i}){const o=Math.max(0,t-n),s=Math.max(0,e-n),a=Math.min(r,t+n+1)-o,l=Math.min(i,e+n+1)-s;return a<=0||l<=0?null:{x:o,y:s,width:a,height:l}}}const S={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"};class E{constructor(t){(0,r.A)(this,"el",null),(0,r.A)(this,"isVisible",!1);const e=t.parentElement;e&&(this.el=document.createElement("div"),this.el.className="deck-tooltip",Object.assign(this.el.style,S),e.appendChild(this.el))}setTooltip(t,e,n){const r=this.el;if(r){if("string"==typeof t)r.innerText=t;else{if(!t)return this.isVisible=!1,void(r.style.display="none");t.text&&(r.innerText=t.text),t.html&&(r.innerHTML=t.html),t.className&&(r.className=t.className)}this.isVisible=!0,r.style.display="block",r.style.transform="translate(".concat(e,"px, ").concat(n,"px)"),t&&"object"==typeof t&&"style"in t&&Object.assign(r.style,t.style)}}remove(){this.el&&(this.el.remove(),this.el=null)}}var M=n(65656),P=n(7453),T=n(82364),O=n(99910),I=n(96271),R=n(34394),B=n(35520),L=n(47168);const k={mousedown:1,mousemove:2,mouseup:4};!function(t){const e=t.prototype.handler;t.prototype.handler=function(t){const n=this.store;t.button>0&&"pointerdown"===t.type&&(function(e){for(let n=0;n<e.length;n++)if(e[n].pointerId===t.pointerId)return!0;return!1}(n)||n.push(t)),e.call(this,t)}}(L.PointerEventInput),L.MouseInput.prototype.handler=function(t){let e=k[t.type];1&e&&t.button>=0&&(this.pressed=!0),2&e&&0===t.buttons&&(e=4),this.pressed&&(4&e&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:"mouse",srcEvent:t}))};const D=L.Manager,F=L;class N{constructor(t,e,n){this.element=t,this.callback=e,this.options={enable:!0,...n}}}const j=F?[[F.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[F.Rotate,{enable:!1}],[F.Pinch,{enable:!1}],[F.Swipe,{enable:!1}],[F.Pan,{threshold:0,enable:!1}],[F.Press,{enable:!1}],[F.Tap,{event:"doubletap",taps:2,enable:!1}],[F.Tap,{event:"anytap",enable:!1}],[F.Tap,{enable:!1}]]:null,G={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},U={doubletap:["tap"]},z={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},V={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},H={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},q={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},W="undefined"!=typeof navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",J="undefined"!=typeof window?window:n.g;void 0!==n.g?n.g:window,"undefined"!=typeof document&&document;let Y=!1;try{const t={get passive(){return Y=!0,!0}};J.addEventListener("test",null,t),J.removeEventListener("test",null)}catch(t){Y=!1}const X=-1!==W.indexOf("firefox"),{WHEEL_EVENTS:K}=V,Z="wheel",Q=4.000244140625;class $ extends N{constructor(t,e,n){super(t,e,n),this.handleEvent=t=>{if(!this.options.enable)return;let e=t.deltaY;J.WheelEvent&&(X&&t.deltaMode===J.WheelEvent.DOM_DELTA_PIXEL&&(e/=J.devicePixelRatio),t.deltaMode===J.WheelEvent.DOM_DELTA_LINE&&(e*=40)),0!==e&&e%Q==0&&(e=Math.floor(e/Q)),t.shiftKey&&e&&(e*=.25),this.callback({type:Z,center:{x:t.clientX,y:t.clientY},delta:-e,srcEvent:t,pointerType:"mouse",target:t.target})},this.events=(this.options.events||[]).concat(K),this.events.forEach((e=>t.addEventListener(e,this.handleEvent,!!Y&&{passive:!1})))}destroy(){this.events.forEach((t=>this.element.removeEventListener(t,this.handleEvent)))}enableEventType(t,e){t===Z&&(this.options.enable=e)}}const{MOUSE_EVENTS:tt}=V,et="pointermove",nt="pointerover",rt="pointerout",it="pointerenter",ot="pointerleave";class st extends N{constructor(t,e,n){super(t,e,n),this.handleEvent=t=>{this.handleOverEvent(t),this.handleOutEvent(t),this.handleEnterEvent(t),this.handleLeaveEvent(t),this.handleMoveEvent(t)},this.pressed=!1;const{enable:r}=this.options;this.enableMoveEvent=r,this.enableLeaveEvent=r,this.enableEnterEvent=r,this.enableOutEvent=r,this.enableOverEvent=r,this.events=(this.options.events||[]).concat(tt),this.events.forEach((e=>t.addEventListener(e,this.handleEvent)))}destroy(){this.events.forEach((t=>this.element.removeEventListener(t,this.handleEvent)))}enableEventType(t,e){t===et&&(this.enableMoveEvent=e),t===nt&&(this.enableOverEvent=e),t===rt&&(this.enableOutEvent=e),t===it&&(this.enableEnterEvent=e),t===ot&&(this.enableLeaveEvent=e)}handleOverEvent(t){this.enableOverEvent&&"mouseover"===t.type&&this._emit(nt,t)}handleOutEvent(t){this.enableOutEvent&&"mouseout"===t.type&&this._emit(rt,t)}handleEnterEvent(t){this.enableEnterEvent&&"mouseenter"===t.type&&this._emit(it,t)}handleLeaveEvent(t){this.enableLeaveEvent&&"mouseleave"===t.type&&this._emit(ot,t)}handleMoveEvent(t){if(this.enableMoveEvent)switch(t.type){case"mousedown":t.button>=0&&(this.pressed=!0);break;case"mousemove":0===t.buttons&&(this.pressed=!1),this.pressed||this._emit(et,t);break;case"mouseup":this.pressed=!1}}_emit(t,e){this.callback({type:t,center:{x:e.clientX,y:e.clientY},srcEvent:e,pointerType:"mouse",target:e.target})}}const{KEY_EVENTS:at}=V,lt="keydown",ut="keyup";class ct extends N{constructor(t,e,n){super(t,e,n),this.handleEvent=t=>{const e=t.target||t.srcElement;"INPUT"===e.tagName&&"text"===e.type||"TEXTAREA"===e.tagName||(this.enableDownEvent&&"keydown"===t.type&&this.callback({type:lt,srcEvent:t,key:t.key,target:t.target}),this.enableUpEvent&&"keyup"===t.type&&this.callback({type:ut,srcEvent:t,key:t.key,target:t.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=(this.options.events||[]).concat(at),t.tabIndex=this.options.tabIndex||0,t.style.outline="none",this.events.forEach((e=>t.addEventListener(e,this.handleEvent)))}destroy(){this.events.forEach((t=>this.element.removeEventListener(t,this.handleEvent)))}enableEventType(t,e){t===lt&&(this.enableDownEvent=e),t===ut&&(this.enableUpEvent=e)}}const ht="contextmenu";class dt extends N{constructor(t,e,n){super(t,e,n),this.handleEvent=t=>{this.options.enable&&this.callback({type:ht,center:{x:t.clientX,y:t.clientY},srcEvent:t,pointerType:"mouse",target:t.target})},t.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(t,e){t===ht&&(this.options.enable=e)}}const ft={pointerdown:1,pointermove:2,pointerup:4,mousedown:1,mousemove:2,mouseup:4};function pt(t){const e=ft[t.srcEvent.type];if(!e)return null;const{buttons:n,button:r}=t.srcEvent;let i=!1,o=!1,s=!1;return 2===e?(i=Boolean(1&n),o=Boolean(4&n),s=Boolean(2&n)):(i=0===r,o=1===r,s=2===r),{leftButton:i,middleButton:o,rightButton:s}}function gt(t,e){const n=t.center;if(!n)return null;const r=e.getBoundingClientRect(),i=r.width/e.offsetWidth||1,o=r.height/e.offsetHeight||1;return{center:n,offsetCenter:{x:(n.x-r.left-e.clientLeft)/i,y:(n.y-r.top-e.clientTop)/o}}}const yt={srcElement:"root",priority:0};class mt{constructor(t){this.handleEvent=t=>{if(this.isEmpty())return;const e=this._normalizeEvent(t);let n=t.srcEvent.target;for(;n&&n!==e.rootElement;){if(this._emit(e,n),e.handled)return;n=n.parentNode}this._emit(e,"root")},this.eventManager=t,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(t,e,n,r=!1,i=!1){const{handlers:o,handlersByElement:s}=this;let a=yt;"string"==typeof n||n&&n.addEventListener?a={...yt,srcElement:n}:n&&(a={...yt,...n});let l=s.get(a.srcElement);l||(l=[],s.set(a.srcElement,l));const u={type:t,handler:e,srcElement:a.srcElement,priority:a.priority};r&&(u.once=!0),i&&(u.passive=!0),o.push(u),this._active=this._active||!u.passive;let c=l.length-1;for(;c>=0&&!(l[c].priority>=u.priority);)c--;l.splice(c+1,0,u)}remove(t,e){const{handlers:n,handlersByElement:r}=this;for(let i=n.length-1;i>=0;i--){const o=n[i];if(o.type===t&&o.handler===e){n.splice(i,1);const t=r.get(o.srcElement);t.splice(t.indexOf(o),1),0===t.length&&r.delete(o.srcElement)}}this._active=n.some((t=>!t.passive))}_emit(t,e){const n=this.handlersByElement.get(e);if(n){let e=!1;const r=()=>{t.handled=!0},i=()=>{t.handled=!0,e=!0},o=[];for(let s=0;s<n.length;s++){const{type:a,handler:l,once:u}=n[s];if(l({...t,type:a,stopPropagation:r,stopImmediatePropagation:i}),u&&o.push(n[s]),e)break}for(let t=0;t<o.length;t++){const{type:e,handler:n}=o[t];this.remove(e,n)}}}_normalizeEvent(t){const e=this.eventManager.getElement();return{...t,...pt(t),...gt(t,e),preventDefault:()=>{t.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:e}}}const vt={events:null,recognizers:null,recognizerOptions:{},Manager:D,touchAction:"none",tabIndex:0};class bt{constructor(t=null,e){this._onBasicInput=t=>{const{srcEvent:e}=t,n=z[e.type];n&&this.manager.emit(n,t)},this._onOtherEvent=t=>{this.manager.emit(t.type,t)},this.options={...vt,...e},this.events=new Map,this.setElement(t);const{events:n}=this.options;n&&this.on(n)}getElement(){return this.element}setElement(t){if(this.element&&this.destroy(),this.element=t,!t)return;const{options:e}=this,n=e.Manager;this.manager=new n(t,{touchAction:e.touchAction,recognizers:e.recognizers||j}).on("hammer.input",this._onBasicInput),e.recognizers||Object.keys(G).forEach((t=>{const e=this.manager.get(t);e&&G[t].forEach((t=>{e.recognizeWith(t)}))}));for(const t in e.recognizerOptions){const n=this.manager.get(t);if(n){const r=e.recognizerOptions[t];delete r.enable,n.set(r)}}this.wheelInput=new $(t,this._onOtherEvent,{enable:!1}),this.moveInput=new st(t,this._onOtherEvent,{enable:!1}),this.keyInput=new ct(t,this._onOtherEvent,{enable:!1,tabIndex:e.tabIndex}),this.contextmenuInput=new dt(t,this._onOtherEvent,{enable:!1});for(const[t,e]of this.events)e.isEmpty()||(this._toggleRecognizer(e.recognizerName,!0),this.manager.on(t,e.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(t,e,n){this._addEventHandler(t,e,n,!1)}once(t,e,n){this._addEventHandler(t,e,n,!0)}watch(t,e,n){this._addEventHandler(t,e,n,!1,!0)}off(t,e){this._removeEventHandler(t,e)}_toggleRecognizer(t,e){const{manager:n}=this;if(!n)return;const r=n.get(t);if(r&&r.options.enable!==e){r.set({enable:e});const i=U[t];i&&!this.options.recognizers&&i.forEach((i=>{const o=n.get(i);e?(o.requireFailure(t),r.dropRequireFailure(i)):o.dropRequireFailure(t)}))}this.wheelInput.enableEventType(t,e),this.moveInput.enableEventType(t,e),this.keyInput.enableEventType(t,e),this.contextmenuInput.enableEventType(t,e)}_addEventHandler(t,e,n,r,i){if("string"!=typeof t){n=e;for(const e in t)this._addEventHandler(e,t[e],n,r,i);return}const{manager:o,events:s}=this,a=q[t]||t;let l=s.get(a);l||(l=new mt(this),s.set(a,l),l.recognizerName=H[a]||a,o&&o.on(a,l.handleEvent)),l.add(t,e,n,r,i),l.isEmpty()||this._toggleRecognizer(l.recognizerName,!0)}_removeEventHandler(t,e){if("string"!=typeof t){for(const e in t)this._removeEventHandler(e,t[e]);return}const{events:n}=this,r=q[t]||t,i=n.get(r);if(i&&(i.remove(t,e),i.isEmpty())){const{recognizerName:t}=i;let e=!1;for(const r of n.values())if(r.recognizerName===t&&!r.isEmpty()){e=!0;break}e||this._toggleRecognizer(t,!1)}}}var _t=n(40898),At=n(1597);function xt(){}const wt={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,glOptions:{},parameters:{},parent:null,gl:null,canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,onWebGLInitialized:xt,onResize:xt,onViewStateChange:xt,onInteractionStateChange:xt,onBeforeRender:xt,onAfterRender:xt,onLoad:xt,onError:t=>s.A.error(t.message,t.cause)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:({isDragging:t})=>t?"grabbing":"grab",getTooltip:null,debug:!1,drawPickingColors:!1};class Ct{constructor(t){(0,r.A)(this,"props",void 0),(0,r.A)(this,"width",0),(0,r.A)(this,"height",0),(0,r.A)(this,"userData",{}),(0,r.A)(this,"canvas",null),(0,r.A)(this,"viewManager",null),(0,r.A)(this,"layerManager",null),(0,r.A)(this,"effectManager",null),(0,r.A)(this,"deckRenderer",null),(0,r.A)(this,"deckPicker",null),(0,r.A)(this,"eventManager",null),(0,r.A)(this,"tooltip",null),(0,r.A)(this,"metrics",void 0),(0,r.A)(this,"animationLoop",void 0),(0,r.A)(this,"stats",void 0),(0,r.A)(this,"viewState",void 0),(0,r.A)(this,"cursorState",void 0),(0,r.A)(this,"_needsRedraw",void 0),(0,r.A)(this,"_pickRequest",void 0),(0,r.A)(this,"_lastPointerDownInfo",null),(0,r.A)(this,"_metricsCounter",void 0),(0,r.A)(this,"_onPointerMove",(t=>{const{_pickRequest:e}=this;if("pointerleave"===t.type)e.x=-1,e.y=-1,e.radius=0;else{if(t.leftButton||t.rightButton)return;{const n=t.offsetCenter;if(!n)return;e.x=n.x,e.y=n.y,e.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:e.x,y:e.y}),e.event=t})),(0,r.A)(this,"_onEvent",(t=>{const e=At.qY[t.type],n=t.offsetCenter;if(!e||!n||!this.layerManager)return;const r=this.layerManager.getLayers(),i=this.deckPicker.getLastPickedObject({x:n.x,y:n.y,layers:r,viewports:this.getViewports(n)},this._lastPointerDownInfo),{layer:o}=i,s=o&&(o[e.handler]||o.props[e.handler]),a=this.props[e.handler];let l=!1;s&&(l=s.call(o,i,t)),!l&&a&&a(i,t)})),(0,r.A)(this,"_onPointerDown",(t=>{const e=t.offsetCenter,n=this._pick("pickObject","pickObject Time",{x:e.x,y:e.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=n.result[0]||n.emptyInfo})),this.props={...wt,...t},t=this.props,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this.cursorState={isHovering:!1,isDragging:!1},t.viewState&&t.initialViewState&&s.A.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),"IE"===(0,T.A)()&&s.A.warn("IE 11 is not supported")(),this.viewState=t.initialViewState,t.gl||"undefined"!=typeof document&&(this.canvas=this._createCanvas(t)),this.animationLoop=this._createAnimationLoop(t),this.stats=new B.Uz({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this.setProps(t),t._typedArrayManagerProps&&M.A.setOptions(t._typedArrayManagerProps),this.animationLoop.start()}finalize(){var t,e,n,r,i,o,s,a,l;null===(t=this.animationLoop)||void 0===t||t.stop(),this.animationLoop=null,this._lastPointerDownInfo=null,null===(e=this.layerManager)||void 0===e||e.finalize(),this.layerManager=null,null===(n=this.viewManager)||void 0===n||n.finalize(),this.viewManager=null,null===(r=this.effectManager)||void 0===r||r.finalize(),this.effectManager=null,null===(i=this.deckRenderer)||void 0===i||i.finalize(),this.deckRenderer=null,null===(o=this.deckPicker)||void 0===o||o.finalize(),this.deckPicker=null,null===(s=this.eventManager)||void 0===s||s.destroy(),this.eventManager=null,null===(a=this.tooltip)||void 0===a||a.remove(),this.tooltip=null,this.props.canvas||this.props.gl||!this.canvas||(null===(l=this.canvas.parentElement)||void 0===l||l.removeChild(this.canvas),this.canvas=null)}setProps(t){this.stats.get("setProps Time").timeStart(),"onLayerHover"in t&&s.A.removed("onLayerHover","onHover")(),"onLayerClick"in t&&s.A.removed("onLayerClick","onClick")(),t.initialViewState&&!(0,o.b)(this.props.initialViewState,t.initialViewState,3)&&(this.viewState=t.initialViewState),Object.assign(this.props,t),this._setCanvasSize(this.props);const e=Object.create(this.props);Object.assign(e,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop.setProps(e),this.layerManager&&(this.viewManager.setProps(e),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(e),this.effectManager.setProps(e),this.deckRenderer.setProps(e),this.deckPicker.setProps(e)),this.stats.get("setProps Time").timeEnd()}needsRedraw(t={clearRedrawFlags:!1}){if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let e=this._needsRedraw;t.clearRedrawFlags&&(this._needsRedraw=!1);const n=this.viewManager.needsRedraw(t),r=this.layerManager.needsRedraw(t),i=this.effectManager.needsRedraw(t),o=this.deckRenderer.needsRedraw(t);return e=e||n||r||i||o,e}redraw(t){if(!this.layerManager)return;let e=this.needsRedraw({clearRedrawFlags:!0});e=t||e,e&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(e):this._drawLayers(e))}get isInitialized(){return null!==this.viewManager}getViews(){return(0,_t.A)(this.viewManager),this.viewManager.views}getViewports(t){return(0,_t.A)(this.viewManager),this.viewManager.getViewports(t)}getCanvas(){return this.canvas}pickObject(t){const e=this._pick("pickObject","pickObject Time",t).result;return e.length?e[0]:null}pickMultipleObjects(t){return t.depth=t.depth||10,this._pick("pickObject","pickMultipleObjects Time",t).result}pickObjects(t){return this._pick("pickObjects","pickObjects Time",t)}_addResources(t,e=!1){for(const n in t)this.layerManager.resourceManager.add({resourceId:n,data:t[n],forceUpdate:e})}_removeResources(t){for(const e of t)this.layerManager.resourceManager.remove(e)}_addDefaultEffect(t){this.effectManager.addDefaultEffect(t)}_pick(t,e,n){(0,_t.A)(this.deckPicker);const{stats:r}=this;r.get("Pick Count").incrementCount(),r.get(e).timeStart();const i=this.deckPicker[t]({layers:this.layerManager.getLayers(n),views:this.viewManager.getViews(),viewports:this.getViewports(n),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...n});return r.get(e).timeEnd(),i}_createCanvas(t){let e=t.canvas;return"string"==typeof e&&(e=document.getElementById(e),(0,_t.A)(e)),e||(e=document.createElement("canvas"),e.id=t.id||"deckgl-overlay",(t.parent||document.body).appendChild(e)),Object.assign(e.style,t.style),e}_setCanvasSize(t){if(!this.canvas)return;const{width:e,height:n}=t;if(e||0===e){const t=Number.isFinite(e)?"".concat(e,"px"):e;this.canvas.style.width=t}if(n||0===n){var r;const e=Number.isFinite(n)?"".concat(n,"px"):n;this.canvas.style.position=(null===(r=t.style)||void 0===r?void 0:r.position)||"absolute",this.canvas.style.height=e}}_updateCanvasSize(){var t,e;const{canvas:n}=this;if(!n)return;const r=null!==(t=n.clientWidth)&&void 0!==t?t:n.width,i=null!==(e=n.clientHeight)&&void 0!==e?e:n.height;var o,s;r===this.width&&i===this.height||(this.width=r,this.height=i,null===(o=this.viewManager)||void 0===o||o.setProps({width:r,height:i}),null===(s=this.layerManager)||void 0===s||s.activateViewport(this.getViewports()[0]),this.props.onResize({width:r,height:i}))}_createAnimationLoop(t){const{width:e,height:n,gl:r,glOptions:i,debug:o,onError:s,onBeforeRender:a,onAfterRender:l,useDevicePixels:u}=t;return new O.A({width:e,height:n,useDevicePixels:u,autoResizeDrawingBuffer:!r,autoResizeViewport:!1,gl:r,onCreateContext:t=>(0,y.XZ)({...i,...t,canvas:this.canvas,debug:o,onContextLost:()=>this._onContextLost()}),onInitialize:t=>this._setGLContext(t.gl),onRender:this._onRenderFrame.bind(this),onBeforeRender:a,onAfterRender:l,onError:s})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){let t=this.props.views||[new u.A({id:"default-view"})];return t=Array.isArray(t)?t:[t],t.length&&this.props.controller&&(t[0].props.controller=this.props.controller),t}_onContextLost(){const{onError:t}=this.props;this.animationLoop&&t&&t(new Error("WebGL context is lost"))}_pickAndCallback(){const{_pickRequest:t}=this;if(t.event){const{result:n,emptyInfo:r}=this._pick("pickObject","pickObject Time",t);this.cursorState.isHovering=n.length>0;let i=r,o=!1;for(const r of n){var e;i=r,o=(null===(e=r.layer)||void 0===e?void 0:e.onHover(r,t.event))||o}if(!o&&this.props.onHover&&this.props.onHover(i,t.event),this.props.getTooltip&&this.tooltip){const t=this.props.getTooltip(i);this.tooltip.setTooltip(t,i.x,i.y)}t.event=null}}_updateCursor(){const t=this.props.parent||this.canvas;t&&(t.style.cursor=this.props.getCursor(this.cursorState))}_setGLContext(t){if(this.layerManager)return;this.canvas||(this.canvas=t.canvas,(0,y.uZ)(t,{enable:!0,copyState:!0})),this.tooltip=new E(this.canvas),(0,y.Rz)(t,{blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onWebGLInitialized(t);const e=new I.K;e.play(),this.animationLoop.attachTimeline(e),this.eventManager=new bt(this.props.parent||t.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const t in At.qY)this.eventManager.on(t,this._onEvent);this.viewManager=new l({timeline:e,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const n=this.viewManager.getViewports()[0];this.layerManager=new i.A(t,{deck:this,stats:this.stats,viewport:n,timeline:e}),this.effectManager=new d,this.deckRenderer=new f.A(t),this.deckPicker=new C(t),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(t,e){const{gl:n}=this.layerManager.context;(0,y.Rz)(n,this.props.parameters),this.props.onBeforeRender({gl:n}),this.deckRenderer.renderLayers({target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",effects:this.effectManager.getEffects(),...e}),this.props.onAfterRender({gl:n})}_onRenderFrame(t){this._getFrameStats(),this._metricsCounter++%60==0&&(this._getMetrics(),this.stats.reset(),s.A.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.tooltip.isVisible&&this.viewManager.needsRedraw()&&this.tooltip.setTooltip(null),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(t){const e=this.props.onViewStateChange(t)||t.viewState;this.viewState&&(this.viewState={...this.viewState,[t.viewId]:e},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(t){this.cursorState.isDragging=t.isDragging||!1,this.props.onInteractionStateChange(t)}_getFrameStats(){const{stats:t}=this;t.get("frameRate").timeEnd(),t.get("frameRate").timeStart();const e=this.animationLoop.stats;t.get("GPU Time").addTime(e.get("GPU Time").lastTiming),t.get("CPU Time").addTime(e.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:t,stats:e}=this;t.fps=e.get("frameRate").getHz(),t.setPropsTime=e.get("setProps Time").time,t.updateAttributesTime=e.get("Update Attributes").time,t.framesRedrawn=e.get("Redraw Count").count,t.pickTime=e.get("pickObject Time").time+e.get("pickMultipleObjects Time").time+e.get("pickObjects Time").time,t.pickCount=e.get("Pick Count").count,t.gpuTime=e.get("GPU Time").time,t.cpuTime=e.get("CPU Time").time,t.gpuTimePerFrame=e.get("GPU Time").getAverageTime(),t.cpuTimePerFrame=e.get("CPU Time").getAverageTime();const n=R.dJ.get("Memory Usage");t.bufferMemory=n.get("Buffer Memory").count,t.textureMemory=n.get("Texture Memory").count,t.renderbufferMemory=n.get("Renderbuffer Memory").count,t.gpuMemory=n.get("GPU Memory").count}}(0,r.A)(Ct,"defaultProps",wt),(0,r.A)(Ct,"VERSION",P.x)},7453:(t,e,n)=>{"use strict";n.d(e,{x:()=>l});var r=n(85749),i=n(94557),o=n(26820),s=n(52908);const a={id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:function(t){const e=t[0],n=t[t.length-1];return"{"===e&&"}"===n||"["===e&&"]"===n},parseTextSync:JSON.parse},l=function(){const t="8.9.36",e=globalThis.deck&&globalThis.deck.VERSION;if(e&&e!==t)throw new Error("deck.gl - multiple versions detected: ".concat(e," vs ").concat(t));return e||(o.A.log(1,"deck.gl ".concat(t))(),globalThis.deck={...globalThis.deck,VERSION:t,version:t,log:o.A,_registerLoggers:s.k},(0,r.registerLoaders)([a,[i.$,{imagebitmap:{premultiplyAlpha:"none"}}]])),t}()},5105:(t,e,n)=>{"use strict";n.d(e,{A:()=>o});var r=n(67136),i=n(75107);class o{static get componentName(){return Object.prototype.hasOwnProperty.call(this,"extensionName")?this.extensionName:""}constructor(t){(0,r.A)(this,"opts",void 0),t&&(this.opts=t)}equals(t){return this===t||this.constructor===t.constructor&&(0,i.b)(this.opts,t.opts,1)}getShaders(t){return null}getSubLayerProps(t){const{defaultProps:e}=t.constructor,n={updateTriggers:{}};for(const t in e)if(t in this.props){const r=e[t],i=this.props[t];n[t]=i,r&&"accessor"===r.type&&(n.updateTriggers[t]=this.props.updateTriggers[t],"function"==typeof i&&(n[t]=this.getSubLayerAccessor(i)))}return n}initializeState(t,e){}updateState(t,e){}onNeedsRedraw(t){}getNeedsPickingBuffer(t){return!1}draw(t,e){}finalizeState(t,e){}}(0,r.A)(o,"defaultProps",{}),(0,r.A)(o,"extensionName","LayerExtension")},29344:(t,e,n)=>{"use strict";n.d(e,{A:()=>v});var r=n(67136),i=n(96271),o=n(47810),s=n(26820),a=n(52908),l=n(93716),u=n(35520),c=n(85749);class h{constructor(t,e,n){(0,r.A)(this,"id",void 0),(0,r.A)(this,"context",void 0),(0,r.A)(this,"isLoaded",void 0),(0,r.A)(this,"persistent",void 0),(0,r.A)(this,"_loadCount",0),(0,r.A)(this,"_subscribers",new Set),(0,r.A)(this,"_data",void 0),(0,r.A)(this,"_loader",void 0),(0,r.A)(this,"_error",void 0),(0,r.A)(this,"_content",void 0),this.id=t,this.context=n,this.setData(e)}subscribe(t){this._subscribers.add(t)}unsubscribe(t){this._subscribers.delete(t)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then((()=>this.getData()))}setData(t,e){if(t===this._data&&!e)return;this._data=t;const n=++this._loadCount;let r=t;"string"==typeof t&&(r=(0,c.load)(t)),r instanceof Promise?(this.isLoaded=!1,this._loader=r.then((t=>{this._loadCount===n&&(this.isLoaded=!0,this._error=void 0,this._content=t)})).catch((t=>{this._loadCount===n&&(this.isLoaded=!0,this._error=t||!0)}))):(this.isLoaded=!0,this._error=void 0,this._content=t);for(const t of this._subscribers)t.onChange(this.getData())}}class d{constructor({gl:t,protocol:e}){(0,r.A)(this,"protocol",void 0),(0,r.A)(this,"_context",void 0),(0,r.A)(this,"_resources",void 0),(0,r.A)(this,"_consumers",void 0),(0,r.A)(this,"_pruneRequest",void 0),this.protocol=e||"resource://",this._context={gl:t,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(t){return!!t.startsWith(this.protocol)||t in this._resources}add({resourceId:t,data:e,forceUpdate:n=!1,persistent:r=!0}){let i=this._resources[t];i?i.setData(e,n):(i=new h(t,e,this._context),this._resources[t]=i),i.persistent=r}remove(t){const e=this._resources[t];e&&(e.delete(),delete this._resources[t])}unsubscribe({consumerId:t}){const e=this._consumers[t];if(e){for(const t in e){const n=e[t],r=this._resources[n.resourceId];r&&r.unsubscribe(n)}delete this._consumers[t],this.prune()}}subscribe({resourceId:t,onChange:e,consumerId:n,requestId:r="default"}){const{_resources:i,protocol:o}=this;t.startsWith(o)&&(i[t=t.replace(o,"")]||this.add({resourceId:t,data:null,persistent:!1}));const s=i[t];if(this._track(n,r,s,e),s)return s.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout((()=>this._prune()),0))}finalize(){for(const t in this._resources)this._resources[t].delete()}_track(t,e,n,r){const i=this._consumers,o=i[t]=i[t]||{},s=o[e]||{},a=s.resourceId&&this._resources[s.resourceId];a&&(a.unsubscribe(s),this.prune()),n&&(o[e]=s,s.onChange=r,s.resourceId=n.id,n.subscribe(s))}_prune(){this._pruneRequest=null;for(const t of Object.keys(this._resources)){const e=this._resources[t];e.persistent||e.inUse()||(e.delete(),delete this._resources[t])}}}var f=n(54684),p=n(57877);const g=[n(19488).A],y=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function m(t){const e=p.A.getDefaultProgramManager(t);for(const t of g)e.addDefaultModule(t);for(const t of y)e.addShaderHook(t);return e}class v{constructor(t,{deck:e,stats:n,viewport:o,timeline:s}={}){(0,r.A)(this,"layers",void 0),(0,r.A)(this,"context",void 0),(0,r.A)(this,"resourceManager",void 0),(0,r.A)(this,"_lastRenderedLayers",[]),(0,r.A)(this,"_needsRedraw",!1),(0,r.A)(this,"_needsUpdate",!1),(0,r.A)(this,"_nextLayers",null),(0,r.A)(this,"_debug",!1),(0,r.A)(this,"activateViewport",(t=>{(0,a.A)("layerManager.activateViewport",this,t),t&&(this.context.viewport=t)})),this.layers=[],this.resourceManager=new d({gl:t,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,gl:t,deck:e,programManager:t&&m(t),stats:n||new u.Uz({id:"deck.gl"}),viewport:o||new f.A({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:s||new i.K,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(const t of this.layers)this._finalizeLayer(t)}needsRedraw(t={clearRedrawFlags:!1}){let e=this._needsRedraw;t.clearRedrawFlags&&(this._needsRedraw=!1);for(const n of this.layers){const r=n.getNeedsRedraw(t);e=e||r}return e}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._needsUpdate}setNeedsRedraw(t){this._needsRedraw=this._needsRedraw||t}setNeedsUpdate(t){this._needsUpdate=this._needsUpdate||t}getLayers({layerIds:t}={}){return t?this.layers.filter((e=>t.find((t=>0===e.id.indexOf(t))))):this.layers}setProps(t){"debug"in t&&(this._debug=t.debug),"userData"in t&&(this.context.userData=t.userData),"layers"in t&&(this._nextLayers=t.layers),"onError"in t&&(this.context.onError=t.onError)}setLayers(t,e){(0,a.A)("layerManager.setLayers",this,e,t),this._lastRenderedLayers=t;const n=(0,l.B)(t,Boolean);for(const t of n)t.context=this.context;this._updateLayers(this.layers,n)}updateLayers(){const t=this.needsUpdate();t&&(this.setNeedsRedraw("updating layers: ".concat(t)),this.setLayers(this._nextLayers||this._lastRenderedLayers,t)),this._nextLayers=null}_handleError(t,e,n){n.raiseError(e,"".concat(t," of ").concat(n))}_updateLayers(t,e){const n={};for(const e of t)n[e.id]?s.A.warn("Multiple old layers with same id ".concat(e.id))():n[e.id]=e;const r=[];this._updateSublayersRecursively(e,n,r),this._finalizeOldLayers(n);let i=!1;for(const t of r)if(t.hasUniformTransition()){i="Uniform transition in ".concat(t);break}this._needsUpdate=i,this.layers=r}_updateSublayersRecursively(t,e,n){for(const r of t){r.context=this.context;const t=e[r.id];null===t&&s.A.warn("Multiple new layers with same id ".concat(r.id))(),e[r.id]=null;let i=null;try{this._debug&&t!==r&&r.validateProps(),t?(this._transferLayerState(t,r),this._updateLayer(r)):this._initializeLayer(r),n.push(r),i=r.isComposite?r.getSubLayers():null}catch(t){this._handleError("matching",t,r)}i&&this._updateSublayersRecursively(i,e,n)}}_finalizeOldLayers(t){for(const e in t){const n=t[e];n&&this._finalizeLayer(n)}}_initializeLayer(t){try{t._initialize(),t.lifecycle=o.VD.INITIALIZED}catch(e){this._handleError("initialization",e,t)}}_transferLayerState(t,e){e._transferState(t),e.lifecycle=o.VD.MATCHED,e!==t&&(t.lifecycle=o.VD.AWAITING_GC)}_updateLayer(t){try{t._update()}catch(e){this._handleError("update",e,t)}}_finalizeLayer(t){this._needsRedraw=this._needsRedraw||"finalized ".concat(t),t.lifecycle=o.VD.AWAITING_FINALIZATION;try{t._finalize(),t.lifecycle=o.VD.FINALIZED}catch(e){this._handleError("finalization",e,t)}}}},36179:(t,e,n)=>{"use strict";n.d(e,{A:()=>$});var r=n(67136),i=n(1597),o=n(83726),s=n(86992),a=n(54692),l=n(82904);class u extends l.A{get value(){return this._value}_onUpdate(){const{time:t,settings:{fromValue:e,toValue:n,duration:r,easing:i}}=this,o=i(t/r);this._value=(0,a.Cc)(e,n,o)}}const c=1e-5;function h(t,e,n,r,i){const o=e-t;return(n-e)*i+-o*r+o+e}function d(t,e){if(Array.isArray(t)){let n=0;for(let r=0;r<t.length;r++){const i=t[r]-e[r];n+=i*i}return Math.sqrt(n)}return Math.abs(t-e)}class f extends l.A{get value(){return this._currValue}_onUpdate(){const{fromValue:t,toValue:e,damping:n,stiffness:r}=this.settings,{_prevValue:i=t,_currValue:o=t}=this;let s=function(t,e,n,r,i){if(Array.isArray(n)){const o=[];for(let s=0;s<n.length;s++)o[s]=h(t[s],e[s],n[s],r,i);return o}return h(t,e,n,r,i)}(i,o,e,n,r);const a=d(s,e),l=d(s,o);a<c&&l<c&&(s=e,this.end()),this._prevValue=o,this._currValue=s}}var p=n(26820);const g={interpolation:u,spring:f};class y{constructor(t){this.transitions=new Map,this.timeline=t}get active(){return this.transitions.size>0}add(t,e,n,r){const{transitions:i}=this;if(i.has(t)){const n=i.get(t),{value:r=n.settings.fromValue}=n;e=r,this.remove(t)}if(!(r=(0,s.K$)(r)))return;const o=g[r.type];if(!o)return void p.A.error("unsupported transition type '".concat(r.type,"'"))();const a=new o(this.timeline);a.start({...r,fromValue:e,toValue:n}),i.set(t,a)}remove(t){const{transitions:e}=this;e.has(t)&&(e.get(t).cancel(),e.delete(t))}update(){const t={};for(const[e,n]of this.transitions)n.update(),t[e]=n.value,n.inProgress||this.remove(e);return t}clear(){for(const t of this.transitions.keys())this.remove(t)}}var m=n(49949),v=n(47810),b=n(2353),_=n(52908),A=n(8282),x=n(40898),w=n(1490),C=n(49605),S=n(63252),E=n(65656),M=n(97870),P=n(26107);const T={10241:9987,10240:9729,10242:33071,10243:33071},O={};var I=n(75107);const R={boolean:{validate:(t,e)=>!0,equal:(t,e,n)=>Boolean(t)===Boolean(e)},number:{validate:(t,e)=>Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)},color:{validate:(t,e)=>e.optional&&!t||k(t)&&(3===t.length||4===t.length),equal:(t,e,n)=>(0,I.b)(t,e,1)},accessor:{validate(t,e){const n=D(t);return"function"===n||n===D(e.value)},equal:(t,e,n)=>"function"==typeof e||(0,I.b)(t,e,1)},array:{validate:(t,e)=>e.optional&&!t||k(t),equal(t,e,n){const{compare:r}=n,i=Number.isInteger(r)?r:r?1:0;return r?(0,I.b)(t,e,i):t===e}},object:{equal(t,e,n){if(n.ignore)return!0;const{compare:r}=n,i=Number.isInteger(r)?r:r?1:0;return r?(0,I.b)(t,e,i):t===e}},function:{validate:(t,e)=>e.optional&&!t||"function"==typeof t,equal:(t,e,n)=>!n.compare&&!1!==n.ignore||t===e},data:{transform:(t,e,n)=>{const{dataTransform:r}=n.props;return r&&t?r(t):t}},image:{transform:(t,e,n)=>{const r=n.context;return r&&r.gl?function(t,e,n,r){if(n instanceof P.A)return n;n.constructor&&"Object"!==n.constructor.name&&(n={data:n});let i=null;n.compressed&&(i={10241:n.data.length>1?9985:9729});const o=new P.A(e,{...n,parameters:{...T,...i,...r}});return O[o.id]=t,o}(n.id,r.gl,t,{...e.parameters,...n.props.textureParameters}):null},release:(t,e,n)=>{var r,i;r=n.id,(i=t)&&i instanceof P.A&&O[i.id]===r&&(i.delete(),delete O[i.id])}}};function B(t,e){switch(D(e)){case"object":return L(t,e);case"array":return L(t,{type:"array",value:e,compare:!1});case"boolean":return L(t,{type:"boolean",value:e});case"number":return L(t,{type:"number",value:e});case"function":return L(t,{type:"function",value:e,compare:!0});default:return{name:t,type:"unknown",value:e}}}function L(t,e){return"type"in e?{name:t,...R[e.type],...e}:"value"in e?{name:t,type:D(e.value),...e}:{name:t,type:"object",value:e}}function k(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function D(t){return k(t)?"array":null===t?"null":typeof t}function F(t,e){let n="_mergedDefaultProps";if(e)for(const t of e){const e=t.constructor;e&&(n+=":".concat(e.extensionName||e.name))}return G(t,n)||(t[n]=function(t,e){if(!t.prototype)return null;const n=F(Object.getPrototypeOf(t)),r=function(t){const e={},n={},r={};for(const[i,o]of Object.entries(t)){const t=null==o?void 0:o.deprecatedFor;if(t)r[i]=Array.isArray(t)?t:[t];else{const t=B(i,o);e[i]=t,n[i]=t.value}}return{propTypes:e,defaultProps:n,deprecatedProps:r}}(G(t,"defaultProps")||{}),i=Object.assign(Object.create(null),n,r.defaultProps),o=Object.assign(Object.create(null),null==n?void 0:n[v.fW],r.propTypes),s=Object.assign(Object.create(null),null==n?void 0:n[v.uH],r.deprecatedProps);for(const t of e){const e=F(t.constructor);e&&(Object.assign(i,e),Object.assign(o,e[v.fW]),Object.assign(s,e[v.uH]))}return function(t,e){const n=function(t){const e=t.componentName;return e||p.A.warn("".concat(t.name,".componentName not specified"))(),e||t.name}(e);Object.defineProperties(t,{id:{writable:!0,value:n}})}(i,t),function(t,e){const n={},r={};for(const t in e){const i=e[t],{name:o,value:s}=i;i.async&&(n[o]=s,r[o]=N(o))}t[v.jA]=n,t[v.YN]={},Object.defineProperties(t,r)}(i,o),function(t,e){for(const n in e)Object.defineProperty(t,n,{enumerable:!1,set(t){const r="".concat(this.id,": ").concat(n);for(const r of e[n])j(this,r)||(this[r]=t);p.A.deprecated(r,e[n].join("/"))()}})}(i,s),i[v.fW]=o,i[v.uH]=s,0!==e.length||j(t,"_propTypes")||(t._propTypes=o),i}(t,e||[]))}function N(t){return{enumerable:!0,set(e){"string"==typeof e||e instanceof Promise||(0,M.Td)(e)?this[v.YN][t]=e:this[v.vf][t]=e},get(){if(this[v.vf]){if(t in this[v.vf])return this[v.vf][t]||this[v.jA][t];if(t in this[v.YN]){const e=this[v.r3]&&this[v.r3].internalState;if(e&&e.hasAsyncProp(t))return e.getAsyncProp(t)||this[v.jA][t]}}return this[v.jA][t]}}}function j(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function G(t,e){return j(t,e)&&t[e]}let U=0;class z{constructor(...t){(0,r.A)(this,"id",void 0),(0,r.A)(this,"props",void 0),(0,r.A)(this,"count",void 0),this.props=function(t,e){let n;for(let t=e.length-1;t>=0;t--){const r=e[t];"extensions"in r&&(n=r.extensions)}const r=F(t.constructor,n),i=Object.create(r);i[v.r3]=t,i[v.YN]={},i[v.vf]={};for(let t=0;t<e.length;++t){const n=e[t];for(const t in n)i[t]=n[t]}return Object.freeze(i),i}(this,t),this.id=this.props.id,this.count=U++}clone(t){const{props:e}=this,n={};for(const t in e[v.jA])t in e[v.vf]?n[t]=e[v.vf][t]:t in e[v.YN]&&(n[t]=e[v.YN][t]);return new this.constructor({...e,...n,...t})}}(0,r.A)(z,"componentName","Component"),(0,r.A)(z,"defaultProps",{});const V=Object.freeze({});class H{constructor(t){(0,r.A)(this,"component",void 0),(0,r.A)(this,"onAsyncPropUpdated",void 0),(0,r.A)(this,"asyncProps",void 0),(0,r.A)(this,"oldProps",void 0),(0,r.A)(this,"oldAsyncProps",void 0),this.component=t,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(const t in this.asyncProps){const e=this.asyncProps[t];e&&e.type&&e.type.release&&e.type.release(e.resolvedValue,e.type,this.component)}this.asyncProps={},this.component=null,this.resetOldProps()}getOldProps(){return this.oldAsyncProps||this.oldProps||V}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component?this.component.props:null}hasAsyncProp(t){return t in this.asyncProps}getAsyncProp(t){const e=this.asyncProps[t];return e&&e.resolvedValue}isAsyncPropLoading(t){if(t){const e=this.asyncProps[t];return Boolean(e&&e.pendingLoadCount>0&&e.pendingLoadCount!==e.resolvedLoadCount)}for(const t in this.asyncProps)if(this.isAsyncPropLoading(t))return!0;return!1}reloadAsyncProp(t,e){this._watchPromise(t,Promise.resolve(e))}setAsyncProps(t){this.component=t[v.r3]||this.component;const e=t[v.vf]||{},n=t[v.YN]||t,r=t[v.jA]||{};for(const t in e){const n=e[t];this._createAsyncPropData(t,r[t]),this._updateAsyncProp(t,n),e[t]=this.getAsyncProp(t)}for(const t in n){const e=n[t];this._createAsyncPropData(t,r[t]),this._updateAsyncProp(t,e)}}_fetch(t,e){return null}_onResolve(t,e){}_onError(t,e){}_updateAsyncProp(t,e){this._didAsyncInputValueChange(t,e)&&("string"==typeof e&&(e=this._fetch(t,e)),e instanceof Promise?this._watchPromise(t,e):(0,M.Td)(e)?this._resolveAsyncIterable(t,e):this._setPropValue(t,e))}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(const t in this.asyncProps)Object.defineProperty(this.oldAsyncProps,t,{enumerable:!0,value:this.oldProps[t]})}}_didAsyncInputValueChange(t,e){const n=this.asyncProps[t];return e!==n.resolvedValue&&e!==n.lastValue&&(n.lastValue=e,!0)}_setPropValue(t,e){this._freezeAsyncOldProps();const n=this.asyncProps[t];n&&(e=this._postProcessValue(n,e),n.resolvedValue=e,n.pendingLoadCount++,n.resolvedLoadCount=n.pendingLoadCount)}_setAsyncPropValue(t,e,n){const r=this.asyncProps[t];r&&n>=r.resolvedLoadCount&&void 0!==e&&(this._freezeAsyncOldProps(),r.resolvedValue=e,r.resolvedLoadCount=n,this.onAsyncPropUpdated(t,e))}_watchPromise(t,e){const n=this.asyncProps[t];if(n){n.pendingLoadCount++;const r=n.pendingLoadCount;e.then((e=>{this.component&&(e=this._postProcessValue(n,e),this._setAsyncPropValue(t,e,r),this._onResolve(t,e))})).catch((e=>{this._onError(t,e)}))}}async _resolveAsyncIterable(t,e){if("data"!==t)return void this._setPropValue(t,e);const n=this.asyncProps[t];if(!n)return;n.pendingLoadCount++;const r=n.pendingLoadCount;let i=[],o=0;for await(const n of e){if(!this.component)return;const{dataTransform:e}=this.component.props;i=e?e(n,i):i.concat(n),Object.defineProperty(i,"__diff",{enumerable:!1,value:[{startRow:o,endRow:i.length}]}),o=i.length,this._setAsyncPropValue(t,i,r)}this._onResolve(t,i)}_postProcessValue(t,e){const n=t.type;return n&&this.component&&(n.release&&n.release(t.resolvedValue,n,this.component),n.transform)?n.transform(e,n,this.component):e}_createAsyncPropData(t,e){if(!this.asyncProps[t]){const n=this.component&&this.component.props[v.fW];this.asyncProps[t]={type:n&&n[t],lastValue:null,resolvedValue:e,pendingLoadCount:0,resolvedLoadCount:0}}}}class q extends H{constructor({attributeManager:t,layer:e}){super(e),(0,r.A)(this,"attributeManager",void 0),(0,r.A)(this,"needsRedraw",void 0),(0,r.A)(this,"needsUpdate",void 0),(0,r.A)(this,"subLayers",void 0),(0,r.A)(this,"usesPickingColorCache",void 0),(0,r.A)(this,"hasPickingBuffer",void 0),(0,r.A)(this,"changeFlags",void 0),(0,r.A)(this,"viewport",void 0),(0,r.A)(this,"uniformTransitions",void 0),(0,r.A)(this,"propsInTransition",void 0),this.attributeManager=t,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}_fetch(t,e){const n=this.layer,r=null==n?void 0:n.props.fetch;return r?r(e,{propName:t,layer:n}):super._fetch(t,e)}_onResolve(t,e){const n=this.layer;if(n){const r=n.props.onDataLoad;"data"===t&&r&&r(e,{propName:t,layer:n})}}_onError(t,e){const n=this.layer;n&&n.raiseError(e,"loading ".concat(t," of ").concat(this.layer))}}var W=n(649),J=n(85749);const Y=2**24-1,X=Object.freeze([]),K=(0,w.A)((({oldViewport:t,viewport:e})=>t.equals(e)));let Z=new Uint8ClampedArray(0);const Q={data:{type:"data",value:X,async:!0},dataComparator:{type:"function",value:null,optional:!0},_dataDiff:{type:"function",value:t=>t&&t.__diff,optional:!0},dataTransform:{type:"function",value:null,optional:!0},onDataLoad:{type:"function",value:null,optional:!0},onError:{type:"function",value:null,optional:!0},fetch:{type:"function",value:(t,{propName:e,layer:n,loaders:r,loadOptions:i,signal:o})=>{const{resourceManager:s}=n.context;var a;i=i||n.getLoadOptions(),r=r||n.props.loaders,o&&(i={...i,fetch:{...null===(a=i)||void 0===a?void 0:a.fetch,signal:o}});let l=s.contains(t);return l||i||(s.add({resourceId:t,data:(0,J.load)(t,r),persistent:!1}),l=!0),l?s.subscribe({resourceId:t,onChange:t=>{var r;return null===(r=n.internalState)||void 0===r?void 0:r.reloadAsyncProp(e,t)},consumerId:n.id,requestId:e}):(0,J.load)(t,r,i)}},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:"draw",onHover:{type:"function",value:null,optional:!0},onClick:{type:"function",value:null,optional:!0},onDragStart:{type:"function",value:null,optional:!0},onDrag:{type:"function",value:null,optional:!0},onDragEnd:{type:"function",value:null,optional:!0},coordinateSystem:i.rf.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:2},loadOptions:{type:"object",value:null,optional:!0,ignore:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,ignore:!0},getPolygonOffset:{type:"function",value:({layerIndex:t})=>[0,100*-t]},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class $ extends z{constructor(...t){super(...t),(0,r.A)(this,"internalState",null),(0,r.A)(this,"lifecycle",v.VD.NO_STATE),(0,r.A)(this,"context",void 0),(0,r.A)(this,"state",void 0),(0,r.A)(this,"parent",null)}static get componentName(){return Object.prototype.hasOwnProperty.call(this,"layerName")?this.layerName:""}get root(){let t=this;for(;t.parent;)t=t.parent;return t}toString(){const t=this.constructor.layerName||this.constructor.name;return"".concat(t,"({id: '").concat(this.props.id,"'})")}project(t){(0,x.A)(this.internalState);const e=this.internalState.viewport||this.context.viewport,n=(0,S.w)(t,{viewport:e,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[r,i,o]=(0,W.worldToPixels)(n,e.pixelProjectionMatrix);return 2===t.length?[r,i]:[r,i,o]}unproject(t){return(0,x.A)(this.internalState),(this.internalState.viewport||this.context.viewport).unproject(t)}projectPosition(t,e){(0,x.A)(this.internalState);const n=this.internalState.viewport||this.context.viewport;return(0,S.R)(t,{viewport:n,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...e})}get isComposite(){return!1}setState(t){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,t),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return!!this.internalState&&!this.internalState.isAsyncPropLoading()}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){return this.state&&(this.state.models||this.state.model&&[this.state.model])||[]}setModuleParameters(t){for(const e of this.getModels())e.updateModuleSettings(t)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){const{coordinateSystem:t}=this.props;return t===i.rf.DEFAULT||t===i.rf.LNGLAT||t===i.rf.CARTESIAN}onHover(t,e){return this.props.onHover&&this.props.onHover(t,e)||!1}onClick(t,e){return this.props.onClick&&this.props.onClick(t,e)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(t,e=[]){return e[0]=t+1&255,e[1]=t+1>>8&255,e[2]=t+1>>8>>8&255,e}decodePickingColor(t){(0,x.A)(t instanceof Uint8Array);const[e,n,r]=t;return e+256*n+65536*r-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&void 0!==this.state.numInstances?this.state.numInstances:(0,b.U)(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){var t;return null===(t=this.getAttributeManager())||void 0===t?void 0:t.getBounds(["positions","instancePositions"])}getShaders(t){for(const e of this.props.extensions)t=(0,C.n)(t,e.getShaders.call(this,e));return t}shouldUpdateState(t){return t.changeFlags.propsOrDataChanged}updateState(t){const e=this.getAttributeManager(),{dataChanged:n}=t.changeFlags;if(n&&e)if(Array.isArray(n))for(const t of n)e.invalidateAll(t);else e.invalidateAll();if(e){const{props:n}=t,r=this.internalState.hasPickingBuffer,i=Number.isInteger(n.highlightedObjectIndex)||n.pickable||n.extensions.some((t=>t.getNeedsPickingBuffer.call(this,t)));if(r!==i){this.internalState.hasPickingBuffer=i;const{pickingColors:t,instancePickingColors:n}=e.attributes,r=t||n;r&&(i&&r.constant&&(r.constant=!1,e.invalidate(r.id)),r.value||i||(r.constant=!0,r.value=[0,0,0]))}}}finalizeState(t){for(const t of this.getModels())t.delete();const e=this.getAttributeManager();e&&e.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(t){for(const e of this.getModels())e.draw(t)}getPickingInfo({info:t,mode:e,sourceLayer:n}){const{index:r}=t;return r>=0&&Array.isArray(this.props.data)&&(t.object=this.props.data[r]),t}raiseError(t,e){var n,r,i,o;e&&(t=new Error("".concat(e,": ").concat(t.message),{cause:t})),null!==(n=(r=this.props).onError)&&void 0!==n&&n.call(r,t)||null===(i=this.context)||void 0===i||null===(o=i.onError)||void 0===o||o.call(i,t,this)}getNeedsRedraw(t={clearRedrawFlags:!1}){return this._getNeedsRedraw(t)}needsUpdate(){return!!this.internalState&&(this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()))}hasUniformTransition(){var t;return(null===(t=this.internalState)||void 0===t?void 0:t.uniformTransitions.active)||!1}activateViewport(t){if(!this.internalState)return;const e=this.internalState.viewport;this.internalState.viewport=t,e&&K({oldViewport:e,viewport:t})||(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(t="all"){const e=this.getAttributeManager();e&&("all"===t?e.invalidateAll():e.invalidate(t))}updateAttributes(t){for(const e of this.getModels())this._setModelAttributes(e,t)}_updateAttributes(){const t=this.getAttributeManager();if(!t)return;const e=this.props,n=this.getNumInstances(),r=this.getStartIndices();t.update({data:e.data,numInstances:n,startIndices:r,props:e,transitions:e.transitions,buffers:e.data.attributes,context:this});const i=t.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(i)}_updateAttributeTransition(){const t=this.getAttributeManager();t&&t.updateTransition()}_updateUniformTransition(){const{uniformTransitions:t}=this.internalState;if(t.active){const e=t.update(),n=Object.create(this.props);for(const t in e)Object.defineProperty(n,t,{value:e[t]});return n}return this.props}calculateInstancePickingColors(t,{numInstances:e}){if(t.constant)return;const n=Math.floor(Z.length/3);if(this.internalState.usesPickingColorCache=!0,n<e){e>Y&&p.A.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),Z=E.A.allocate(Z,e,{size:3,copy:!0,maxCount:Math.max(e,Y)});const t=Math.floor(Z.length/3),r=[];for(let e=n;e<t;e++)this.encodePickingColor(e,r),Z[3*e+0]=r[0],Z[3*e+1]=r[1],Z[3*e+2]=r[2]}t.value=Z.subarray(0,3*e)}_setModelAttributes(t,e){const n=this.getAttributeManager(),r=t.userData.excludeAttributes||{},i=n.getShaderAttributes(e,r);t.setAttributes(i)}disablePickingIndex(t){const e=this.props.data;if(!("attributes"in e))return void this._disablePickingIndex(t);const{pickingColors:n,instancePickingColors:r}=this.getAttributeManager().attributes,i=n||r,o=i&&e.attributes&&e.attributes[i.id];if(o&&o.value){const n=o.value,r=this.encodePickingColor(t);for(let t=0;t<e.length;t++){const e=i.getVertexOffset(t);n[e]===r[0]&&n[e+1]===r[1]&&n[e+2]===r[2]&&this._disablePickingIndex(t)}}else this._disablePickingIndex(t)}_disablePickingIndex(t){const{pickingColors:e,instancePickingColors:n}=this.getAttributeManager().attributes,r=e||n;if(!r)return;const i=r.getVertexOffset(t),o=r.getVertexOffset(t+1);r.buffer.subData({data:new Uint8Array(o-i),offset:i})}restorePickingColors(){const{pickingColors:t,instancePickingColors:e}=this.getAttributeManager().attributes,n=t||e;n&&(this.internalState.usesPickingColorCache&&n.value.buffer!==Z.buffer&&(n.value=Z.subarray(0,n.value.length)),n.updateSubBuffer({startOffset:0}))}_initialize(){(0,x.A)(!this.internalState),(0,x.A)(Number.isFinite(this.props.coordinateSystem)),(0,_.A)("layer.initialize",this);const t=this._getAttributeManager();t&&t.addInstanced({instancePickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new q({attributeManager:t,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(p.A.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),t)}),this.internalState.uniformTransitions=new y(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(const t of this.props.extensions)t.initializeState.call(this,this.context,t);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(t){(0,_.A)("layer.matched",this,this===t);const{state:e,internalState:n}=t;this!==t&&(this.internalState=n,this.state=e,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){const t=this.needsUpdate();if((0,_.A)("layer.update",this,t),!t)return;const e=this.props,n=this.context,r=this.internalState,i=n.viewport,o=this._updateUniformTransition();r.propsInTransition=o,n.viewport=r.viewport||i,this.props=o;try{const t=this._getUpdateParams(),e=this.getModels();if(n.gl)this.updateState(t);else try{this.updateState(t)}catch(t){}for(const e of this.props.extensions)e.updateState.call(this,t,e);const r=this.getModels()[0]!==e[0];this._postUpdate(t,r)}finally{n.viewport=i,this.props=e,this._clearChangeFlags(),r.needsUpdate=!1,r.resetOldProps()}}_finalize(){(0,_.A)("layer.finalize",this),this.finalizeState(this.context);for(const t of this.props.extensions)t.finalizeState.call(this,this.context,t)}_drawLayer({moduleParameters:t=null,uniforms:e={},parameters:n={}}){this._updateAttributeTransition();const r=this.props,i=this.context;this.props=this.internalState.propsInTransition||r;const o=this.props.opacity;e.opacity=Math.pow(o,1/2.2);try{t&&this.setModuleParameters(t);const{getPolygonOffset:r}=this.props,o=r&&r(e)||[0,0];(0,A.Rz)(i.gl,{polygonOffset:o}),(0,A.zv)(i.gl,n,(()=>{const r={moduleParameters:t,uniforms:e,parameters:n,context:i};for(const t of this.props.extensions)t.draw.call(this,r,t);this.draw(r)}))}finally{this.props=r}}getChangeFlags(){var t;return null===(t=this.internalState)||void 0===t?void 0:t.changeFlags}setChangeFlags(t){if(!this.internalState)return;const{changeFlags:e}=this.internalState;for(const n in t)if(t[n]){let r=!1;if("dataChanged"===n){const i=t[n],o=e[n];i&&Array.isArray(o)&&(e.dataChanged=Array.isArray(i)?o.concat(i):i,r=!0)}e[n]||(e[n]=t[n],r=!0),r&&(0,_.A)("layer.changeFlag",this,n,t)}const n=Boolean(e.dataChanged||e.updateTriggersChanged||e.propsChanged||e.extensionsChanged);e.propsOrDataChanged=n,e.somethingChanged=n||e.viewportChanged||e.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(t,e){const n=(0,m.mg)(t,e);if(n.updateTriggersChanged)for(const t in n.updateTriggersChanged)n.updateTriggersChanged[t]&&this.invalidateAttribute(t);if(n.transitionsChanged)for(const i in n.transitionsChanged){var r;this.internalState.uniformTransitions.add(i,e[i],t[i],null===(r=t.transitions)||void 0===r?void 0:r[i])}return this.setChangeFlags(n)}validateProps(){(0,m.zo)(this.props)}updateAutoHighlight(t){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(t)}_updateAutoHighlight(t){const e={pickingSelectedColor:t.picked?t.color:null},{highlightColor:n}=this.props;t.picked&&"function"==typeof n&&(e.pickingHighlightColor=n(t)),this.setModuleParameters(e),this.setNeedsRedraw()}_getAttributeManager(){const t=this.context;return new o.A(t.gl,{id:this.props.id,stats:t.stats,timeline:t.timeline})}_postUpdate(t,e){const{props:n,oldProps:r}=t;this.setNeedsRedraw(),this._updateAttributes();const{model:i}=this.state;null==i||i.setInstanceCount(this.getNumInstances());const{autoHighlight:o,highlightedObjectIndex:s,highlightColor:a}=n;if(e||r.autoHighlight!==o||r.highlightedObjectIndex!==s||r.highlightColor!==a){const t={};o||(t.pickingSelectedColor=null),Array.isArray(a)&&(t.pickingHighlightColor=a),(e||s!==r.highlightedObjectIndex)&&(t.pickingSelectedColor=Number.isFinite(s)&&s>=0?this.encodePickingColor(s):null),this.setModuleParameters(t)}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(t){if(!this.internalState)return!1;let e=!1;e=e||this.internalState.needsRedraw&&this.id;const n=this.getAttributeManager(),r=!!n&&n.getNeedsRedraw(t);if(e=e||r,e)for(const t of this.props.extensions)t.onNeedsRedraw.call(this,t);return this.internalState.needsRedraw=this.internalState.needsRedraw&&!t.clearRedrawFlags,e}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}(0,r.A)($,"defaultProps",Q),(0,r.A)($,"layerName","Layer")},47810:(t,e,n)=>{"use strict";n.d(e,{VD:()=>r,YN:()=>l,fW:()=>o,jA:()=>a,r3:()=>i,uH:()=>s,vf:()=>u});const r={NO_STATE:"Awaiting state",MATCHED:"Matched. State transferred from previous layer",INITIALIZED:"Initialized",AWAITING_GC:"Discarded. Awaiting garbage collection",AWAITING_FINALIZATION:"No longer matched. Awaiting garbage collection",FINALIZED:"Finalized! Awaiting garbage collection"},i=Symbol.for("component"),o=Symbol.for("propTypes"),s=Symbol.for("deprecatedProps"),a=Symbol.for("asyncPropDefaults"),l=Symbol.for("asyncPropOriginal"),u=Symbol.for("asyncPropResolved")},49949:(t,e,n)=>{"use strict";n.d(e,{Me:()=>a,mg:()=>o,zo:()=>i});var r=n(47810);function i(t){const e=t[r.fW];for(const n in e){const r=e[n],{validate:i}=r;if(i&&!i(t[n],r))throw new Error("Invalid prop ".concat(n,": ").concat(t[n]))}}function o(t,e){const n=a({newProps:t,oldProps:e,propTypes:t[r.fW],ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),i=function(t,e){if(null===e)return"oldProps is null, initial diff";let n=!1;const{dataComparator:r,_dataDiff:i}=t;return r?r(t.data,e.data)||(n="Data comparator detected a change"):t.data!==e.data&&(n="A new data container was supplied"),n&&i&&(n=i(t.data,e.data)||n),n}(t,e);let o=!1;return i||(o=function(t,e){if(null===e)return{all:!0};if("all"in t.updateTriggers&&c(t,e,"all"))return{all:!0};const n={};let r=!1;for(const i in t.updateTriggers)"all"!==i&&c(t,e,i)&&(n[i]=!0,r=!0);return!!r&&n}(t,e)),{dataChanged:i,propsChanged:n,updateTriggersChanged:o,extensionsChanged:u(t,e),transitionsChanged:s(t,e)}}function s(t,e){if(!t.transitions)return!1;const n={},i=t[r.fW];let o=!1;for(const r in t.transitions){const s=i[r],a=s&&s.type;("number"===a||"color"===a||"array"===a)&&l(t[r],e[r],s)&&(n[r]=!0,o=!0)}return!!o&&n}function a({newProps:t,oldProps:e,ignoreProps:n={},propTypes:r={},triggerName:i="props"}){if(e===t)return!1;if("object"!=typeof t||null===t)return"".concat(i," changed shallowly");if("object"!=typeof e||null===e)return"".concat(i," changed shallowly");for(const o of Object.keys(t))if(!(o in n)){if(!(o in e))return"".concat(i,".").concat(o," added");const n=l(t[o],e[o],r[o]);if(n)return"".concat(i,".").concat(o," ").concat(n)}for(const o of Object.keys(e))if(!(o in n)){if(!(o in t))return"".concat(i,".").concat(o," dropped");if(!Object.hasOwnProperty.call(t,o)){const n=l(t[o],e[o],r[o]);if(n)return"".concat(i,".").concat(o," ").concat(n)}}return!1}function l(t,e,n){let r=n&&n.equal;return r&&!r(t,e,n)?"changed deeply":r||(r=t&&e&&t.equals,!r||r.call(t,e))?r||e===t?null:"changed shallowly":"changed deeply"}function u(t,e){if(null===e)return!0;const n=e.extensions,{extensions:r}=t;if(r===n)return!1;if(!n||!r)return!0;if(r.length!==n.length)return!0;for(let t=0;t<r.length;t++)if(!r[t].equals(n[t]))return!0;return!1}function c(t,e,n){let r=t.updateTriggers[n];r=null==r?{}:r;let i=e.updateTriggers[n];return i=null==i?{}:i,a({oldProps:i,newProps:r,triggerName:n})}},64156:(t,e,n)=>{"use strict";n.d(e,{A:()=>a});var r=n(67136),i=n(44991),o=n(8282),s=n(22780);class a extends i.A{constructor(...t){super(...t),(0,r.A)(this,"_lastRenderIndex",-1)}render(t){const e=this.gl;return(0,o.Rz)(e,{framebuffer:t.target}),this._drawLayers(t)}_drawLayers(t){const{target:e,moduleParameters:n,viewports:r,views:i,onViewportActive:s,clearStack:a=!0,clearCanvas:l=!0}=t;t.pass=t.pass||"unknown";const u=this.gl;l&&function(t,e){const n=e?e.width:t.drawingBufferWidth,r=e?e.height:t.drawingBufferHeight;(0,o.Rz)(t,{viewport:[0,0,n,r]}),t.clear(16640)}(u,e),a&&(this._lastRenderIndex=-1);const c=[];for(const o of r){const r=i&&i[o.id];null==s||s(o);const a=this._getDrawLayerParams(o,t),l=o.subViewports||[o];for(const i of l){const o=this._drawLayersInViewport(u,{target:e,moduleParameters:n,viewport:i,view:r,pass:t.pass,layers:t.layers},a);c.push(o)}}return c}_getDrawLayerParams(t,{layers:e,pass:n,isPicking:r=!1,layerFilter:i,cullRect:o,effects:s,moduleParameters:a},u=!1){const c=[],h=l(this._lastRenderIndex+1),d={layer:e[0],viewport:t,isPicking:r,renderPass:n,cullRect:o},f={};for(let r=0;r<e.length;r++){const o=e[r],l=this._shouldDrawLayer(o,d,i,f),p={shouldDrawLayer:l};l&&!u&&(p.layerRenderIndex=h(o,l),p.moduleParameters=this._getModuleParameters(o,s,n,a),p.layerParameters=this.getLayerParameters(o,r,t)),c[r]=p}return c}_drawLayersInViewport(t,{layers:e,moduleParameters:n,pass:r,target:i,viewport:a,view:l},u){const c=function(t,{moduleParameters:e,target:n,viewport:r}){const i=n&&"default-framebuffer"!==n.id,s=e&&e.devicePixelRatio||(0,o.o0)(t),a=i?n.height:t.drawingBufferHeight,l=r;return[l.x*s,a-(l.y+l.height)*s,l.width*s,l.height*s]}(t,{moduleParameters:n,target:i,viewport:a});if(l&&l.props.clear){const e=!0===l.props.clear?{color:!0,depth:!0}:l.props.clear;(0,o.zv)(t,{scissorTest:!0,scissor:c},(()=>(0,s.I)(t,e)))}const h={totalCount:e.length,visibleCount:0,compositeCount:0,pickableCount:0};(0,o.Rz)(t,{viewport:c});for(let t=0;t<e.length;t++){const n=e[t],{shouldDrawLayer:i,layerRenderIndex:o,moduleParameters:s,layerParameters:l}=u[t];if(i&&n.props.pickable&&h.pickableCount++,n.isComposite)h.compositeCount++;else if(i){h.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,o),s.viewport=a;try{n._drawLayer({moduleParameters:s,uniforms:{layerIndex:o},parameters:l})}catch(t){n.raiseError(t,"drawing ".concat(n," to ").concat(r))}}}return h}shouldDrawLayer(t){return!0}getModuleParameters(t,e){return null}getLayerParameters(t,e,n){return t.props.parameters}_shouldDrawLayer(t,e,n,r){if(!t.props.visible||!this.shouldDrawLayer(t))return!1;e.layer=t;let i=t.parent;for(;i;){if(!i.props.visible||!i.filterSubLayer(e))return!1;e.layer=i,i=i.parent}if(n){const t=e.layer.id;if(t in r||(r[t]=n(e)),!r[t])return!1}return t.activateViewport(e.viewport),!0}_getModuleParameters(t,e,n,r){var i;const s=Object.assign(Object.create((null===(i=t.internalState)||void 0===i?void 0:i.propsInTransition)||t.props),{autoWrapLongitude:t.wrapLongitude,viewport:t.context.viewport,mousePosition:t.context.mousePosition,pickingActive:0,devicePixelRatio:(0,o.o0)(this.gl)});if(e)for(const n of e){var a;Object.assign(s,null===(a=n.getModuleParameters)||void 0===a?void 0:a.call(n,t))}return Object.assign(s,this.getModuleParameters(t,e),r)}}function l(t=0,e={}){const n={},r=(i,o)=>{const s=i.props._offset,a=i.id,u=i.parent&&i.parent.id;let c;if(u&&!(u in e)&&r(i.parent,!1),u in n){const t=n[u]=n[u]||l(e[u],e);c=t(i,o),n[a]=t}else Number.isFinite(s)?(c=s+(e[u]||0),n[a]=null):c=t;return o&&c>=t&&(t=c+1),e[a]=c,c};return r}},44991:(t,e,n)=>{"use strict";n.d(e,{A:()=>i});var r=n(67136);class i{constructor(t,e={id:"pass"}){(0,r.A)(this,"id",void 0),(0,r.A)(this,"gl",void 0),(0,r.A)(this,"props",void 0);const{id:n}=e;this.id=n,this.gl=t,this.props={...e}}setProps(t){Object.assign(this.props,t)}render(t){}cleanup(){}}},64766:(t,e,n)=>{"use strict";n.d(e,{A:()=>l});var r=n(67136),i=n(64156),o=n(8282),s=n(26820);const a={blendFunc:[1,0,32771,0],blendEquation:32774};class l extends i.A{constructor(...t){super(...t),(0,r.A)(this,"pickZ",void 0),(0,r.A)(this,"_colorEncoderState",null)}render(t){return"pickingFBO"in t?this._drawPickingBuffer(t):super.render(t)}_drawPickingBuffer({layers:t,layerFilter:e,views:n,viewports:r,onViewportActive:i,pickingFBO:s,deviceRect:{x:l,y:c,width:h,height:d},cullRect:f,effects:p,pass:g="picking",pickZ:y,moduleParameters:m}){const v=this.gl;this.pickZ=y;const b=this._resetColorEncoder(y),_=(0,o.zv)(v,{scissorTest:!0,scissor:[l,c,h,d],clearColor:[0,0,0,0],depthMask:!0,depthTest:!0,depthRange:[0,1],colorMask:[!0,!0,!0,!0],...a,blend:!y},(()=>super.render({target:s,layers:t,layerFilter:e,views:n,viewports:r,onViewportActive:i,cullRect:f,effects:null==p?void 0:p.filter((t=>t.useInPicking)),pass:g,isPicking:!0,moduleParameters:m})));return this._colorEncoderState=null,{decodePickingColor:b&&u.bind(null,b),stats:_}}shouldDrawLayer(t){const{pickable:e,operation:n}=t.props;return e&&n.includes("draw")||n.includes("terrain")||n.includes("mask")}getModuleParameters(){return{pickingActive:1,pickingAttribute:this.pickZ,lightSources:{}}}getLayerParameters(t,e,n){const r={...t.props.parameters},{pickable:i,operation:o}=t.props;return this._colorEncoderState?i&&o.includes("draw")&&(Object.assign(r,a),r.blend=!0,r.blendColor=function(t,e,n){const{byLayer:r,byAlpha:i}=t;let o,a=r.get(e);return a?(a.viewports.push(n),o=a.a):(o=r.size+1,o<=255?(a={a:o,layer:e,viewports:[n]},r.set(e,a),i[o]=a):(s.A.warn("Too many pickable layers, only picking the first 255")(),o=0)),[0,0,0,o/255]}(this._colorEncoderState,t,n)):r.blend=!1,o.includes("terrain")&&(r.blend=!1),r}_resetColorEncoder(t){return this._colorEncoderState=t?null:{byLayer:new Map,byAlpha:[]},this._colorEncoderState}}function u(t,e){const n=t.byAlpha[e[3]];return n&&{pickedLayer:n.layer,pickedViewports:n.viewports,pickedObjectIndex:n.layer.decodePickingColor(e)}}},70560:(t,e,n)=>{"use strict";n.d(e,{A:()=>r});const r={inject:{"vs:DECKGL_FILTER_GL_POSITION":"\n    // for picking depth values\n    picking_setPickingAttribute(position.z / position.w);\n  ","vs:DECKGL_FILTER_COLOR":"\n  picking_setPickingColor(geometry.pickingColor);\n  ","fs:#decl":"\nuniform bool picking_uAttribute;\n  ","fs:DECKGL_FILTER_COLOR":{order:99,injection:"\n  // use highlight color if this fragment belongs to the selected object.\n  color = picking_filterHighlightColor(color);\n\n  // use picking color if rendering to picking FBO.\n  color = picking_filterPickingColor(color);\n    "}},...n(37276).q}},63252:(t,e,n)=>{"use strict";n.d(e,{R:()=>d,w:()=>h});var r=n(1597),i=n(42653),o=n(82125),s=n(94796),a=n(30329),l=n(649);const u=[0,0,0];function c(t,e,n=!1){const r=e.projectPosition(t);if(n&&e instanceof o.A){const[n,i,o=0]=t,s=e.getDistanceScales([n,i]);r[2]=o*s.unitsPerMeter[2]}return r}function h(t,{viewport:e,modelMatrix:n,coordinateSystem:i,coordinateOrigin:o,offsetMode:a}){let[u,h,d=0]=t;switch(n&&([u,h,d]=s.Z0([],[u,h,d,1],n)),i){case r.rf.LNGLAT:return c([u,h,d],e,a);case r.rf.LNGLAT_OFFSETS:return c([u+o[0],h+o[1],d+(o[2]||0)],e,a);case r.rf.METER_OFFSETS:return c((0,l.addMetersToLngLat)(o,[u,h,d]),e,a);case r.rf.CARTESIAN:default:return e.isGeospatial?[u+o[0],h+o[1],d+o[2]]:e.projectPosition([u,h,d])}}function d(t,e){const{viewport:n,coordinateSystem:o,coordinateOrigin:s,modelMatrix:l,fromCoordinateSystem:c,fromCoordinateOrigin:d}=function(t){const{viewport:e,modelMatrix:n,coordinateOrigin:i}=t;let{coordinateSystem:o,fromCoordinateSystem:s,fromCoordinateOrigin:a}=t;return o===r.rf.DEFAULT&&(o=e.isGeospatial?r.rf.LNGLAT:r.rf.CARTESIAN),void 0===s&&(s=o),void 0===a&&(a=i),{viewport:e,coordinateSystem:o,coordinateOrigin:i,modelMatrix:n,fromCoordinateSystem:s,fromCoordinateOrigin:a}}(e),{autoOffset:f=!0}=e,{geospatialOrigin:p=u,shaderCoordinateOrigin:g=u,offsetMode:y=!1}=f?(0,i.o)(n,o,s):{},m=h(t,{viewport:n,modelMatrix:l,coordinateSystem:c,coordinateOrigin:d,offsetMode:y});if(y){const t=n.projectPosition(p||g);a.jb(m,m,t)}return m}},19488:(t,e,n)=>{"use strict";n.d(e,{A:()=>f});var r=n(3612);const i="#define SMOOTH_EDGE_RADIUS 0.5",o={name:"geometry",vs:"\n".concat(i,"\n\nstruct VertexGeometry {\n  vec4 position;\n  vec3 worldPosition;\n  vec3 worldPositionAlt;\n  vec3 normal;\n  vec2 uv;\n  vec3 pickingColor;\n} geometry = VertexGeometry(\n  vec4(0.0, 0.0, 1.0, 0.0),\n  vec3(0.0),\n  vec3(0.0),\n  vec3(0.0),\n  vec2(0.0),\n  vec3(0.0)\n);\n"),fs:"\n".concat(i,"\n\nstruct FragmentGeometry {\n  vec2 uv;\n} geometry;\n\nfloat smoothedge(float edge, float x) {\n  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);\n}\n")};var s=n(1597);const a=Object.keys(s.rf).map((t=>"const int COORDINATE_SYSTEM_".concat(t," = ").concat(s.rf[t],";"))).join(""),l=Object.keys(s.Kx).map((t=>"const int PROJECTION_MODE_".concat(t," = ").concat(s.Kx[t],";"))).join(""),u=Object.keys(s.p5).map((t=>"const int UNIT_".concat(t.toUpperCase()," = ").concat(s.p5[t],";"))).join(""),c="".concat(a,"\n").concat(l,"\n").concat(u,"\n\nuniform int project_uCoordinateSystem;\nuniform int project_uProjectionMode;\nuniform float project_uScale;\nuniform bool project_uWrapLongitude;\nuniform vec3 project_uCommonUnitsPerMeter;\nuniform vec3 project_uCommonUnitsPerWorldUnit;\nuniform vec3 project_uCommonUnitsPerWorldUnit2;\nuniform vec4 project_uCenter;\nuniform mat4 project_uModelMatrix;\nuniform mat4 project_uViewProjectionMatrix;\nuniform vec2 project_uViewportSize;\nuniform float project_uDevicePixelRatio;\nuniform float project_uFocalDistance;\nuniform vec3 project_uCameraPosition;\nuniform vec3 project_uCoordinateOrigin;\nuniform vec3 project_uCommonOrigin;\nuniform bool project_uPseudoMeters;\n\nconst float TILE_SIZE = 512.0;\nconst float PI = 3.1415926536;\nconst float WORLD_SCALE = TILE_SIZE / (PI * 2.0);\nconst vec3 ZERO_64_LOW = vec3(0.0);\nconst float EARTH_RADIUS = 6370972.0;\nconst float GLOBE_RADIUS = 256.0;\nfloat project_size_at_latitude(float lat) {\n  float y = clamp(lat, -89.9, 89.9);\n  return 1.0 / cos(radians(y));\n}\n\nfloat project_size() {\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR &&\n    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT &&\n    project_uPseudoMeters == false) {\n    \n    if (geometry.position.w == 0.0) {\n      return project_size_at_latitude(geometry.worldPosition.y);\n    }\n  \n    float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;\n    float y2 = y * y;\n    float y4 = y2 * y2;\n    float y6 = y4 * y2;\n    return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;\n  }\n  return 1.0;\n}\n\nfloat project_size_at_latitude(float meters, float lat) {\n  return meters * project_uCommonUnitsPerMeter.z * project_size_at_latitude(lat);\n}\nfloat project_size(float meters) {\n  return meters * project_uCommonUnitsPerMeter.z * project_size();\n}\n\nvec2 project_size(vec2 meters) {\n  return meters * project_uCommonUnitsPerMeter.xy * project_size();\n}\n\nvec3 project_size(vec3 meters) {\n  return meters * project_uCommonUnitsPerMeter * project_size();\n}\n\nvec4 project_size(vec4 meters) {\n  return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);\n}\nmat3 project_get_orientation_matrix(vec3 up) {\n  vec3 uz = normalize(up);\n  vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));\n  vec3 uy = cross(uz, ux);\n  return mat3(ux, uy, uz);\n}\n\nbool project_needs_rotation(vec3 commonPosition, out mat3 transform) {\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    transform = project_get_orientation_matrix(commonPosition);\n    return true;\n  }\n  return false;\n}\nvec3 project_normal(vec3 vector) {\n  vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);\n  vec3 n = normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);\n  mat3 rotation;\n  if (project_needs_rotation(geometry.position.xyz, rotation)) {\n    n = rotation * n;\n  }\n  return n;\n}\n\nvec4 project_offset_(vec4 offset) {\n  float dy = offset.y;\n  vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;\n  return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);\n}\nvec2 project_mercator_(vec2 lnglat) {\n  float x = lnglat.x;\n  if (project_uWrapLongitude) {\n    x = mod(x + 180., 360.0) - 180.;\n  }\n  float y = clamp(lnglat.y, -89.9, 89.9);\n  return vec2(\n    radians(x) + PI,\n    PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))\n  ) * WORLD_SCALE;\n}\n\nvec3 project_globe_(vec3 lnglatz) {\n  float lambda = radians(lnglatz.x);\n  float phi = radians(lnglatz.y);\n  float cosPhi = cos(phi);\n  float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;\n\n  return vec3(\n    sin(lambda) * cosPhi,\n    -cos(lambda) * cosPhi,\n    sin(phi)\n  ) * D;\n}\nvec4 project_position(vec4 position, vec3 position64Low) {\n  vec4 position_world = project_uModelMatrix * position;\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4(\n        project_mercator_(position_world.xy),\n        project_size_at_latitude(position_world.z, position_world.y),\n        position_world.w\n      );\n    }\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {\n      position_world.xyz += project_uCoordinateOrigin;\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4(\n        project_globe_(position_world.xyz),\n        position_world.w\n      );\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      if (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {\n        return vec4(\n          project_mercator_(position_world.xy) - project_uCommonOrigin.xy,\n          project_size(position_world.z),\n          position_world.w\n        );\n      }\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||\n    (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&\n    (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n     project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {\n    position_world.xyz -= project_uCoordinateOrigin;\n  }\n  return project_offset_(position_world) + project_offset_(project_uModelMatrix * vec4(position64Low, 0.0));\n}\n\nvec4 project_position(vec4 position) {\n  return project_position(position, ZERO_64_LOW);\n}\n\nvec3 project_position(vec3 position, vec3 position64Low) {\n  vec4 projected_position = project_position(vec4(position, 1.0), position64Low);\n  return projected_position.xyz;\n}\n\nvec3 project_position(vec3 position) {\n  vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);\n  return projected_position.xyz;\n}\n\nvec2 project_position(vec2 position) {\n  vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);\n  return projected_position.xy;\n}\n\nvec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {\n  return viewProjectionMatrix * position + center;\n}\nvec4 project_common_position_to_clipspace(vec4 position) {\n  return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);\n}\nvec2 project_pixel_size_to_clipspace(vec2 pixels) {\n  vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;\n  return offset * project_uFocalDistance;\n}\n\nfloat project_size_to_pixel(float meters) {\n  return project_size(meters) * project_uScale;\n}\nfloat project_size_to_pixel(float size, int unit) {\n  if (unit == UNIT_METERS) return project_size_to_pixel(size);\n  if (unit == UNIT_COMMON) return size * project_uScale;\n  return size;\n}\nfloat project_pixel_size(float pixels) {\n  return pixels / project_uScale;\n}\nvec2 project_pixel_size(vec2 pixels) {\n  return pixels / project_uScale;\n}\n");var h=n(42653);const d={},f={name:"project",dependencies:[r.i,o],vs:c,getUniforms:function(t=d){return"viewport"in t?(0,h.a)(t):{}}}},42653:(t,e,n)=>{"use strict";n.d(e,{a:()=>p,o:()=>f});var r=n(67684),i=n(94796),o=n(1597),s=n(1490);const a=[0,0,0,0],l=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],u=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],c=[0,0,0],h=[0,0,0],d=(0,s.A)((function({viewport:t,devicePixelRatio:e,coordinateSystem:n,coordinateOrigin:s}){const{projectionCenter:h,viewProjectionMatrix:d,originCommon:p,cameraPosCommon:g,shaderCoordinateOrigin:y,geospatialOrigin:m}=function(t,e,n){const{viewMatrixUncentered:o,projectionMatrix:s}=t;let{viewMatrix:u,viewProjectionMatrix:c}=t,h=a,d=a,p=t.cameraPosition;const{geospatialOrigin:g,shaderCoordinateOrigin:y,offsetMode:m}=f(t,e,n);return m&&(d=t.projectPosition(g||y),p=[p[0]-d[0],p[1]-d[1],p[2]-d[2]],d[3]=1,h=i.Z0([],d,c),u=o||u,c=r.lw([],s,u),c=r.lw([],c,l)),{viewMatrix:u,viewProjectionMatrix:c,projectionCenter:h,originCommon:d,cameraPosCommon:p,shaderCoordinateOrigin:y,geospatialOrigin:g}}(t,n,s),v=t.getDistanceScales(),b=[t.width*e,t.height*e],_=i.Z0([],[0,0,-t.focalDistance,1],t.projectionMatrix)[3]||1,A={project_uCoordinateSystem:n,project_uProjectionMode:t.projectionMode,project_uCoordinateOrigin:y,project_uCommonOrigin:p.slice(0,3),project_uCenter:h,project_uPseudoMeters:Boolean(t._pseudoMeters),project_uViewportSize:b,project_uDevicePixelRatio:e,project_uFocalDistance:_,project_uCommonUnitsPerMeter:v.unitsPerMeter,project_uCommonUnitsPerWorldUnit:v.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:c,project_uScale:t.scale,project_uWrapLongitude:!1,project_uViewProjectionMatrix:d,project_uModelMatrix:u,project_uCameraPosition:g};if(m){const e=t.getDistanceScales(m);switch(n){case o.rf.METER_OFFSETS:A.project_uCommonUnitsPerWorldUnit=e.unitsPerMeter,A.project_uCommonUnitsPerWorldUnit2=e.unitsPerMeter2;break;case o.rf.LNGLAT:case o.rf.LNGLAT_OFFSETS:t._pseudoMeters||(A.project_uCommonUnitsPerMeter=e.unitsPerMeter),A.project_uCommonUnitsPerWorldUnit=e.unitsPerDegree,A.project_uCommonUnitsPerWorldUnit2=e.unitsPerDegree2;break;case o.rf.CARTESIAN:A.project_uCommonUnitsPerWorldUnit=[1,1,e.unitsPerMeter[2]],A.project_uCommonUnitsPerWorldUnit2=[0,0,e.unitsPerMeter2[2]]}}return A}));function f(t,e,n=h){n.length<3&&(n=[n[0],n[1],0]);let r,i=n,s=!0;switch(r=e===o.rf.LNGLAT_OFFSETS||e===o.rf.METER_OFFSETS?n:t.isGeospatial?[Math.fround(t.longitude),Math.fround(t.latitude),0]:null,t.projectionMode){case o.Kx.WEB_MERCATOR:e!==o.rf.LNGLAT&&e!==o.rf.CARTESIAN||(r=[0,0,0],s=!1);break;case o.Kx.WEB_MERCATOR_AUTO_OFFSET:e===o.rf.LNGLAT?i=r:e===o.rf.CARTESIAN&&(i=[Math.fround(t.center[0]),Math.fround(t.center[1]),0],r=t.unprojectPosition(i),i[0]-=n[0],i[1]-=n[1],i[2]-=n[2]);break;case o.Kx.IDENTITY:i=t.position.map(Math.fround),i[2]=i[2]||0;break;case o.Kx.GLOBE:s=!1,r=null;break;default:s=!1}return{geospatialOrigin:r,shaderCoordinateOrigin:i,offsetMode:s}}function p({viewport:t,devicePixelRatio:e=1,modelMatrix:n=null,coordinateSystem:r=o.rf.DEFAULT,coordinateOrigin:i=h,autoWrapLongitude:s=!1}){r===o.rf.DEFAULT&&(r=t.isGeospatial?o.rf.LNGLAT:o.rf.CARTESIAN);const a=d({viewport:t,devicePixelRatio:e,coordinateSystem:r,coordinateOrigin:i});return a.project_uWrapLongitude=s,a.project_uModelMatrix=n||u,a}},79464:(t,e,n)=>{"use strict";n.d(e,{A:()=>r});const r={name:"project32",dependencies:[n(19488).A],vs:"\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition\n) {\n  vec3 projectedPosition = project_position(position, position64Low);\n  mat3 rotation;\n  if (project_needs_rotation(projectedPosition, rotation)) {\n    // offset is specified as ENU\n    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe\n    offset = rotation * offset;\n  }\n  commonPosition = vec4(projectedPosition + offset, 1.0);\n  return project_common_position_to_clipspace(commonPosition);\n}\n\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset\n) {\n  vec4 commonPosition;\n  return project_position_to_clipspace(position, position64Low, offset, commonPosition);\n}\n"}},37450:(t,e,n)=>{"use strict";n.d(e,{A:()=>f});var r=n(1597),i=n(19488),o=n(98569),s=n(22466),a=n(1490),l=n(649);const u=(0,a.A)((function({viewport:t,center:e}){return new o.A(t.viewProjectionMatrix).invert().transform(e)})),c=(0,a.A)((function({viewport:t,shadowMatrices:e}){const n=[],r=t.pixelUnprojectionMatrix,i=t.isGeospatial?void 0:1,a=[[0,0,i],[t.width,0,i],[0,t.height,i],[t.width,t.height,i],[0,0,-1],[t.width,0,-1],[0,t.height,-1],[t.width,t.height,-1]].map((t=>function(t,e){const[n,r,i]=t,o=(0,l.pixelsToWorld)([n,r,i],e);return Number.isFinite(i)?o:[o[0],o[1],0]}(t,r)));for(const r of e){const e=r.clone().translate(new s.A(t.center).negate()),i=a.map((t=>e.transform(t))),l=(new o.A).ortho({left:Math.min(...i.map((t=>t[0]))),right:Math.max(...i.map((t=>t[0]))),bottom:Math.min(...i.map((t=>t[1]))),top:Math.max(...i.map((t=>t[1]))),near:Math.min(...i.map((t=>-t[2]))),far:Math.max(...i.map((t=>-t[2])))});n.push(l.multiplyRight(r))}return n})),h=[0,0,0,1],d=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],f={name:"shadow",dependencies:[i.A],vs:"\nconst int max_lights = 2;\nuniform mat4 shadow_uViewProjectionMatrices[max_lights];\nuniform vec4 shadow_uProjectCenters[max_lights];\nuniform bool shadow_uDrawShadowMap;\nuniform bool shadow_uUseShadowMap;\nuniform int shadow_uLightId;\nuniform float shadow_uLightCount;\n\nvarying vec3 shadow_vPosition[max_lights];\n\nvec4 shadow_setVertexPosition(vec4 position_commonspace) {\n  if (shadow_uDrawShadowMap) {\n    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);\n  }\n  if (shadow_uUseShadowMap) {\n    for (int i = 0; i < max_lights; i++) {\n      if(i < int(shadow_uLightCount)) {\n        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);\n        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;\n      }\n    }\n  }\n  return gl_Position;\n}\n",fs:"\nconst int max_lights = 2;\nuniform bool shadow_uDrawShadowMap;\nuniform bool shadow_uUseShadowMap;\nuniform sampler2D shadow_uShadowMap0;\nuniform sampler2D shadow_uShadowMap1;\nuniform vec4 shadow_uColor;\nuniform float shadow_uLightCount;\n\nvarying vec3 shadow_vPosition[max_lights];\n\nconst vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);\nconst vec4 bitUnpackShift = 1.0 / bitPackShift;\nconst vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);\n\nfloat shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {\n  vec4 rgbaDepth = texture2D(shadowMap, position.xy);\n\n  float z = dot(rgbaDepth, bitUnpackShift);\n  return smoothstep(0.001, 0.01, position.z - z);\n}\n\nvec4 shadow_filterShadowColor(vec4 color) {\n  if (shadow_uDrawShadowMap) {\n    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);\n    rgbaDepth -= rgbaDepth.gbaa * bitMask;\n    return rgbaDepth;\n  }\n  if (shadow_uUseShadowMap) {\n    float shadowAlpha = 0.0;\n    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);\n    if(shadow_uLightCount > 1.0) {\n      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);\n    }\n    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;\n    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);\n\n    return vec4(\n      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),\n      blendedAlpha\n    );\n  }\n  return color;\n}\n",inject:{"vs:DECKGL_FILTER_GL_POSITION":"\n    position = shadow_setVertexPosition(geometry.position);\n    ","fs:DECKGL_FILTER_COLOR":"\n    color = shadow_filterShadowColor(color);\n    "},getUniforms:(t={},e={})=>"viewport"in t&&(t.drawToShadowMap||t.shadowMaps&&t.shadowMaps.length>0)?function(t,e){const{shadowEnabled:n=!0}=t;if(!n||!t.shadowMatrices||!t.shadowMatrices.length)return{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1};const i={shadow_uDrawShadowMap:Boolean(t.drawToShadowMap),shadow_uUseShadowMap:!!t.shadowMaps&&t.shadowMaps.length>0,shadow_uColor:t.shadowColor||h,shadow_uLightId:t.shadowLightId||0,shadow_uLightCount:t.shadowMatrices.length},o=u({viewport:t.viewport,center:e.project_uCenter}),a=[],l=c({shadowMatrices:t.shadowMatrices,viewport:t.viewport}).slice();for(let n=0;n<t.shadowMatrices.length;n++){const i=l[n],u=i.clone().translate(new s.A(t.viewport.center).negate());e.project_uCoordinateSystem===r.rf.LNGLAT&&e.project_uProjectionMode===r.Kx.WEB_MERCATOR?(l[n]=u,a[n]=o):(l[n]=i.clone().multiplyRight(d),a[n]=u.transform(o))}for(let e=0;e<l.length;e++)i["shadow_uViewProjectionMatrices[".concat(e,"]")]=l[e],i["shadow_uProjectCenters[".concat(e,"]")]=a[e],t.shadowMaps&&t.shadowMaps.length>0?i["shadow_uShadowMap".concat(e)]=t.shadowMaps[e]:i["shadow_uShadowMap".concat(e)]=t.dummyShadowMap;return i}(t,e):{}}},71154:(t,e,n)=>{"use strict";n.d(e,{A:()=>l});var r=n(67136),i=n(45272),o=n(54692);const s=["longitude","latitude","zoom","bearing","pitch"],a=["longitude","latitude","zoom"];class l extends i.A{constructor(t={}){const e=Array.isArray(t)?t:t.transitionProps,n=Array.isArray(t)?{}:t;n.transitionProps=Array.isArray(e)?{compare:e,required:e}:e||{compare:s,required:a},super(n.transitionProps),(0,r.A)(this,"opts",void 0),this.opts=n}initializeProps(t,e){const n=super.initializeProps(t,e),{makeViewport:r,around:i}=this.opts;if(r&&i){const o=r(t),s=r(e),a=o.unproject(i);n.start.around=i,Object.assign(n.end,{around:s.project(a),aroundPosition:a,width:e.width,height:e.height})}return n}interpolateProps(t,e,n){const r={};for(const i of this._propsToExtract)r[i]=(0,o.Cc)(t[i]||0,e[i]||0,n);if(e.aroundPosition&&this.opts.makeViewport){const i=this.opts.makeViewport({...e,...r});Object.assign(r,i.panByPosition(e.aroundPosition,(0,o.Cc)(t.around,e.around,n)))}return r}}},45272:(t,e,n)=>{"use strict";n.d(e,{A:()=>s});var r=n(67136),i=n(54692),o=n(40898);class s{constructor(t){(0,r.A)(this,"_propsToCompare",void 0),(0,r.A)(this,"_propsToExtract",void 0),(0,r.A)(this,"_requiredProps",void 0);const{compare:e,extract:n,required:i}=t;this._propsToCompare=e,this._propsToExtract=n||e,this._requiredProps=i}arePropsEqual(t,e){for(const n of this._propsToCompare)if(!(n in t)||!(n in e)||!(0,i.aI)(t[n],e[n]))return!1;return!0}initializeProps(t,e){const n={},r={};for(const i of this._propsToExtract)(i in t||i in e)&&(n[i]=t[i],r[i]=e[i]);return this._checkRequiredProps(n),this._checkRequiredProps(r),{start:n,end:r}}getDuration(t,e){return e.transitionDuration}_checkRequiredProps(t){this._requiredProps&&this._requiredProps.forEach((e=>{const n=t[e];(0,o.A)(Number.isFinite(n)||Array.isArray(n),"".concat(e," is required for transition"))}))}}},82904:(t,e,n)=>{"use strict";n.d(e,{A:()=>i});var r=n(67136);class i{constructor(t){(0,r.A)(this,"_inProgress",void 0),(0,r.A)(this,"_handle",void 0),(0,r.A)(this,"_timeline",void 0),(0,r.A)(this,"time",void 0),(0,r.A)(this,"settings",void 0),this._inProgress=!1,this._handle=null,this._timeline=t,this.time=0,this.settings={duration:0}}get inProgress(){return this._inProgress}start(t){var e,n;this.cancel(),this.settings=t,this._inProgress=!0,null===(e=(n=this.settings).onStart)||void 0===e||e.call(n,this)}end(){var t,e;this._inProgress&&(this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,null===(t=(e=this.settings).onEnd)||void 0===t||t.call(e,this))}cancel(){var t,e;this._inProgress&&(null===(t=(e=this.settings).onInterrupt)||void 0===t||t.call(e,this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1)}update(){var t,e;if(!this._inProgress)return!1;if(null===this._handle){const{_timeline:t,settings:e}=this;this._handle=t.addChannel({delay:t.getTime(),duration:e.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),null===(t=(e=this.settings).onUpdate)||void 0===t||t.call(e,this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}},40898:(t,e,n)=>{"use strict";function r(t,e){if(!t)throw new Error(e||"deck.gl: assertion failed.")}n.d(e,{A:()=>r})},2353:(t,e,n)=>{"use strict";n.d(e,{U:()=>o});const r="count(): argument not an object",i="count(): argument not a container";function o(t){if(null===(e=t)||"object"!=typeof e)throw new Error(r);var e;if("function"==typeof t.count)return t.count();if(Number.isFinite(t.size))return t.size;if(Number.isFinite(t.length))return t.length;if(function(t){return null!==t&&"object"==typeof t&&t.constructor===Object}(t))return Object.keys(t).length;throw new Error(i)}},75107:(t,e,n)=>{"use strict";function r(t,e,n){if(t===e)return!0;if(!n||!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let i=0;i<t.length;i++)if(!r(t[i],e[i],n-1))return!1;return!0}if(Array.isArray(e))return!1;if("object"==typeof t&&"object"==typeof e){const i=Object.keys(t),o=Object.keys(e);if(i.length!==o.length)return!1;for(const o of i){if(!e.hasOwnProperty(o))return!1;if(!r(t[o],e[o],n-1))return!1}return!0}return!1}n.d(e,{b:()=>r})},93716:(t,e,n)=>{"use strict";function r(t,e=()=>!0){return Array.isArray(t)?i(t,e,[]):e(t)?[t]:[]}function i(t,e,n){let r=-1;for(;++r<t.length;){const o=t[r];Array.isArray(o)?i(o,e,n):e(o)&&n.push(o)}return n}function o({target:t,source:e,start:n=0,count:r=1}){const i=e.length,o=r*i;let s=0;for(let r=n;s<i;s++)t[r++]=e[s];for(;s<o;)s<o-s?(t.copyWithin(n+s,n,n+s),s*=2):(t.copyWithin(n+s,n,n+o-s),s=o);return t}n.d(e,{B:()=>r,R:()=>o})},97870:(t,e,n)=>{"use strict";n.d(e,{I:()=>a,Td:()=>s,X:()=>o});const r=[],i=[];function o(t,e=0,n=1/0){let o=r;const s={index:-1,data:t,target:[]};return t?"function"==typeof t[Symbol.iterator]?o=t:t.length>0&&(i.length=t.length,o=i):o=r,(e>0||Number.isFinite(n))&&(o=(Array.isArray(o)?o:Array.from(o)).slice(e,n),s.index=e-1),{iterable:o,objectInfo:s}}function s(t){return t&&t[Symbol.asyncIterator]}function a(t,e){const{size:n,stride:r,offset:i,startIndices:o,nested:s}=e,a=t.BYTES_PER_ELEMENT,l=r?r/a:n,u=i?i/a:0,c=Math.floor((t.length-u)/l);return(e,{index:r,target:i})=>{if(!o){const e=r*l+u;for(let r=0;r<n;r++)i[r]=t[e+r];return i}const a=o[r],h=o[r+1]||c;let d;if(s){d=new Array(h-a);for(let e=a;e<h;e++){const r=e*l+u;i=new Array(n);for(let e=0;e<n;e++)i[e]=t[r+e];d[e-a]=i}}else if(l===n)d=t.subarray(a*n+u,h*n+u);else{d=new t.constructor((h-a)*n);let e=0;for(let r=a;r<h;r++){const i=r*l+u;for(let r=0;r<n;r++)d[e++]=t[i+r]}}return d}}},26820:(t,e,n)=>{"use strict";n.d(e,{A:()=>r});const r=new(n(91317).t)({id:"deck"})},51682:(t,e,n)=>{"use strict";n.d(e,{$M:()=>o,Vl:()=>a,_Z:()=>p,cT:()=>f,on:()=>l,qk:()=>h,zi:()=>s});var r=n(65656),i=n(22466);function o(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function s(t,e){const n=t%e;return n<0?e+n:n}function a(t){return[t[12],t[13],t[14]]}function l(t){return{left:c(t[3]+t[0],t[7]+t[4],t[11]+t[8],t[15]+t[12]),right:c(t[3]-t[0],t[7]-t[4],t[11]-t[8],t[15]-t[12]),bottom:c(t[3]+t[1],t[7]+t[5],t[11]+t[9],t[15]+t[13]),top:c(t[3]-t[1],t[7]-t[5],t[11]-t[9],t[15]-t[13]),near:c(t[3]+t[2],t[7]+t[6],t[11]+t[10],t[15]+t[14]),far:c(t[3]-t[2],t[7]-t[6],t[11]-t[10],t[15]-t[14])}}const u=new i.A;function c(t,e,n,r){u.set(t,e,n);const o=u.len();return{distance:r/o,normal:new i.A(-t/o,-e/o,-n/o)}}function h(t){return t-Math.fround(t)}let d;function f(t,e){const{size:n=1,startIndex:i=0}=e,o=void 0!==e.endIndex?e.endIndex:t.length,s=(o-i)/n;d=r.A.allocate(d,s,{type:Float32Array,size:2*n});let a=i,l=0;for(;a<o;){for(let e=0;e<n;e++){const r=t[a++];d[l+e]=r,d[l+e+n]=h(r)}l+=2*n}return d.subarray(0,s*n*2)}function p(t){let e=null,n=!1;for(const r of t)r&&(e?(n||(e=[[e[0][0],e[0][1]],[e[1][0],e[1][1]]],n=!0),e[0][0]=Math.min(e[0][0],r[0][0]),e[0][1]=Math.min(e[0][1],r[0][1]),e[1][0]=Math.max(e[1][0],r[1][0]),e[1][1]=Math.max(e[1][1],r[1][1])):e=r);return e}},1490:(t,e,n)=>{"use strict";function r(t,e){if(t===e)return!0;if(Array.isArray(t)){const n=t.length;if(!e||e.length!==n)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}return!1}function i(t){let e,n={};return i=>{for(const o in i)if(!r(i[o],n[o])){e=t(i),n=i;break}return e}}n.d(e,{A:()=>i})},49605:(t,e,n)=>{"use strict";function r(t,e){if(!e)return t;const n={...t,...e};if("defines"in e&&(n.defines={...t.defines,...e.defines}),"modules"in e&&(n.modules=(t.modules||[]).concat(e.modules),e.modules.some((t=>"project64"===t.name)))){const t=n.modules.findIndex((t=>"project32"===t.name));t>=0&&n.modules.splice(t,1)}if("inject"in e)if(t.inject){const r={...t.inject};for(const t in e.inject)r[t]=(r[t]||"")+e.inject[t];n.inject=r}else n.inject=e.inject;return n}n.d(e,{n:()=>r})},57512:(t,e,n)=>{"use strict";n.d(e,{A:()=>l});var r=n(67136),i=n(97870),o=n(65656),s=n(40898),a=n(62671);class l{constructor(t){(0,r.A)(this,"opts",void 0),(0,r.A)(this,"typedArrayManager",void 0),(0,r.A)(this,"indexStarts",[0]),(0,r.A)(this,"vertexStarts",[0]),(0,r.A)(this,"vertexCount",0),(0,r.A)(this,"instanceCount",0),(0,r.A)(this,"attributes",void 0),(0,r.A)(this,"_attributeDefs",void 0),(0,r.A)(this,"data",void 0),(0,r.A)(this,"getGeometry",void 0),(0,r.A)(this,"geometryBuffer",void 0),(0,r.A)(this,"buffers",void 0),(0,r.A)(this,"positionSize",void 0),(0,r.A)(this,"normalize",void 0);const{attributes:e={}}=t;this.typedArrayManager=o.A,this.attributes={},this._attributeDefs=e,this.opts=t,this.updateGeometry(t)}updateGeometry(t){Object.assign(this.opts,t);const{data:e,buffers:n={},getGeometry:r,geometryBuffer:i,positionFormat:o,dataChanged:a,normalize:l=!0}=this.opts;if(this.data=e,this.getGeometry=r,this.positionSize=i&&i.size||("XY"===o?2:3),this.buffers=n,this.normalize=l,i&&((0,s.A)(e.startIndices),this.getGeometry=this.getGeometryFromBuffer(i),l||(n.positions=i)),this.geometryBuffer=n.positions,Array.isArray(a))for(const t of a)this._rebuildGeometry(t);else this._rebuildGeometry()}updatePartialGeometry({startRow:t,endRow:e}){this._rebuildGeometry({startRow:t,endRow:e})}getGeometryFromBuffer(t){const e=t.value||t;return ArrayBuffer.isView(e)?(0,i.I)(e,{size:this.positionSize,offset:t.offset,stride:t.stride,startIndices:this.data.startIndices}):null}_allocate(t,e){const{attributes:n,buffers:r,_attributeDefs:i,typedArrayManager:o}=this;for(const s in i)if(s in r)o.release(n[s]),n[s]=null;else{const r=i[s];r.copy=e,n[s]=o.allocate(n[s],t,r)}}_forEachGeometry(t,e,n){const{data:r,getGeometry:o}=this,{iterable:s,objectInfo:a}=(0,i.X)(r,e,n);for(const e of s)a.index++,t(o?o(e,a):null,a.index)}_rebuildGeometry(t){if(!this.data)return;let{indexStarts:e,vertexStarts:n,instanceCount:r}=this;const{data:i,geometryBuffer:o}=this,{startRow:s=0,endRow:l=1/0}=t||{},u={};if(t||(e=[0],n=[0]),this.normalize||!o)this._forEachGeometry(((t,e)=>{const r=t&&this.normalizeGeometry(t);u[e]=r,n[e+1]=n[e]+(r?this.getGeometrySize(r):0)}),s,l),r=n[n.length-1];else if(n=i.startIndices,r=n[i.length]||0,ArrayBuffer.isView(o))r=r||o.length/this.positionSize;else if(o instanceof a.A){const t=o.accessor.stride||4*this.positionSize;r=r||o.byteLength/t}else if(o.buffer){const t=o.stride||4*this.positionSize;r=r||o.buffer.byteLength/t}else if(o.value){const t=o.value,e=o.stride/t.BYTES_PER_ELEMENT||this.positionSize;r=r||t.length/e}this._allocate(r,Boolean(t)),this.indexStarts=e,this.vertexStarts=n,this.instanceCount=r;const c={};this._forEachGeometry(((t,i)=>{const o=u[i]||t;c.vertexStart=n[i],c.indexStart=e[i];const s=i<n.length-1?n[i+1]:r;c.geometrySize=s-n[i],c.geometryIndex=i,this.updateGeometryAttributes(o,c)}),s,l),this.vertexCount=e[e.length-1]}}},65656:(t,e,n)=>{"use strict";n.d(e,{A:()=>i});var r=n(67136);const i=new class{constructor(t={}){(0,r.A)(this,"_pool",[]),(0,r.A)(this,"opts",{overAlloc:2,poolSize:100}),this.setOptions(t)}setOptions(t){Object.assign(this.opts,t)}allocate(t,e,{size:n=1,type:r,padding:i=0,copy:o=!1,initialize:s=!1,maxCount:a}){const l=r||t&&t.constructor||Float32Array,u=e*n+i;if(ArrayBuffer.isView(t)){if(u<=t.length)return t;if(u*t.BYTES_PER_ELEMENT<=t.buffer.byteLength)return new l(t.buffer,0,u)}let c=1/0;a&&(c=a*n+i);const h=this._allocate(l,u,s,c);return t&&o?h.set(t):s||h.fill(0,0,4),this._release(t),h}release(t){this._release(t)}_allocate(t,e,n,r){let i=Math.max(Math.ceil(e*this.opts.overAlloc),1);i>r&&(i=r);const o=this._pool,s=t.BYTES_PER_ELEMENT*i,a=o.findIndex((t=>t.byteLength>=s));if(a>=0){const e=new t(o.splice(a,1)[0],0,i);return n&&e.fill(0),e}return new t(i)}_release(t){if(!ArrayBuffer.isView(t))return;const e=this._pool,{buffer:n}=t,{byteLength:r}=n,i=e.findIndex((t=>t.byteLength>=r));i<0?e.push(n):(i>0||e.length<this.opts.poolSize)&&e.splice(i,0,n),e.length>this.opts.poolSize&&e.shift()}}},33540:(t,e,n)=>{"use strict";n.d(e,{A:()=>p});var r=n(67136),i=n(98569),o=n(54684),s=n(1597),a=n(30329),l=n(94796);const u=Math.PI/180,c=180/Math.PI,h=6370972,d=256;function f(){const t=4018225162502676e-20,e=Math.PI/180*d;return{unitsPerMeter:[t,t,t],unitsPerMeter2:[0,0,0],metersPerUnit:[24886.609375,24886.609375,24886.609375],unitsPerDegree:[e,e,t],unitsPerDegree2:[0,0,0],degreesPerUnit:[1/e,1/e,24886.609375]}}class p extends o.A{constructor(t={}){const{latitude:e=0,longitude:n=0,zoom:o=0,nearZMultiplier:s=.1,farZMultiplier:a=2,resolution:l=10}=t;let{height:c,altitude:h=1.5}=t;c=c||1,h=Math.max(.75,h);const d=(new i.A).lookAt({eye:[0,-h,0],up:[0,0,1]}),p=Math.pow(2,o);d.rotateX(e*u),d.rotateZ(-n*u),d.scale(p/c);const g=Math.atan(.5/h),y=512*p/c;super({...t,height:c,viewMatrix:d,longitude:n,latitude:e,zoom:o,distanceScales:f(),fovyRadians:2*g,focalDistance:h,near:s,far:Math.min(2,1/y+1)*h*a}),(0,r.A)(this,"longitude",void 0),(0,r.A)(this,"latitude",void 0),(0,r.A)(this,"resolution",void 0),this.latitude=e,this.longitude=n,this.resolution=l}get projectionMode(){return s.Kx.GLOBE}getDistanceScales(){return this.distanceScales}getBounds(t={}){const e={targetZ:t.z||0},n=this.unproject([0,this.height/2],e),r=this.unproject([this.width/2,0],e),i=this.unproject([this.width,this.height/2],e),o=this.unproject([this.width/2,this.height],e);return i[0]<this.longitude&&(i[0]+=360),n[0]>this.longitude&&(n[0]-=360),[Math.min(n[0],i[0],r[0],o[0]),Math.min(n[1],i[1],r[1],o[1]),Math.max(n[0],i[0],r[0],o[0]),Math.max(n[1],i[1],r[1],o[1])]}unproject(t,{topLeft:e=!0,targetZ:n}={}){const[r,i,o]=t,s=e?i:this.height-i,{pixelUnprojectionMatrix:l}=this;let u;if(Number.isFinite(o))u=g(l,[r,s,o,1]);else{const t=g(l,[r,s,-1,1]),e=g(l,[r,s,1,1]),i=((n||0)/h+1)*d,o=a.uE(a.jb([],t,e)),c=a.uE(t),f=a.uE(e),p=(4*c*f-(o-c-f)**2)/16*4/o,y=(Math.sqrt(c-p)-Math.sqrt(Math.max(0,i*i-p)))/Math.sqrt(o);u=a.Cc([],t,e,y)}const[c,f,p]=this.unprojectPosition(u);return Number.isFinite(o)?[c,f,p]:Number.isFinite(n)?[c,f,n]:[c,f]}projectPosition(t){const[e,n,r=0]=t,i=e*u,o=n*u,s=Math.cos(o),a=(r/h+1)*d;return[Math.sin(i)*s*a,-Math.cos(i)*s*a,Math.sin(o)*a]}unprojectPosition(t){const[e,n,r]=t,i=a.Il(t),o=Math.asin(r/i);return[Math.atan2(e,-n)*c,o*c,(i/d-1)*h]}projectFlat(t){return t}unprojectFlat(t){return t}panByPosition(t,e){const n=this.unproject(e);return{longitude:t[0]-n[0]+this.longitude,latitude:t[1]-n[1]+this.latitude}}}function g(t,e){const n=l.Z0([],e,t);return l.hs(n,n,1/n[3]),n}},1279:(t,e,n)=>{"use strict";n.d(e,{A:()=>c});var r=n(54684),i=n(98569),o=n(54692),s=n(649),a=n(40842);const l=(new i.A).lookAt({eye:[0,0,1]});function u({width:t,height:e,near:n,far:r,padding:s}){let a=-t/2,l=t/2,u=-e/2,c=e/2;if(s){const{left:n=0,right:r=0,top:i=0,bottom:h=0}=s,d=(0,o.qE)((n+t-r)/2,0,t)-t/2,f=(0,o.qE)((i+e-h)/2,0,e)-e/2;a-=d,l-=d,u+=f,c+=f}return(new i.A).ortho({left:a,right:l,bottom:u,top:c,near:n,far:r})}class c extends r.A{constructor(t){const{width:e,height:n,near:r=.1,far:i=1e3,zoom:o=0,target:s=[0,0,0],padding:a=null,flipY:c=!0}=t,h=Array.isArray(o)?o[0]:o,d=Array.isArray(o)?o[1]:o,f=Math.min(h,d),p=Math.pow(2,f);let g;if(h!==d){const t=Math.pow(2,h),e=Math.pow(2,d);g={unitsPerMeter:[t/p,e/p,1],metersPerUnit:[p/t,p/e,1]}}super({...t,longitude:void 0,position:s,viewMatrix:l.clone().scale([p,p*(c?-1:1),p]),projectionMatrix:u({width:e||1,height:n||1,padding:a,near:r,far:i}),zoom:f,distanceScales:g})}projectFlat([t,e]){const{unitsPerMeter:n}=this.distanceScales;return[t*n[0],e*n[1]]}unprojectFlat([t,e]){const{metersPerUnit:n}=this.distanceScales;return[t*n[0],e*n[1]]}panByPosition(t,e){const n=(0,s.pixelsToWorld)(e,this.pixelUnprojectionMatrix),r=this.projectFlat(t),i=a.WQ([],r,a.ze([],n)),o=a.WQ([],this.center,i);return{target:this.unprojectFlat(o)}}}},54684:(t,e,n)=>{"use strict";n.d(e,{A:()=>y});var r=n(67136),i=n(26820),o=n(51682),s=n(98569),a=n(54692),l=n(22466),u=n(67684),c=n(649),h=n(1597);const d=Math.PI/180,f=(0,o.$M)(),p=[0,0,0],g={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};class y{constructor(t={}){(0,r.A)(this,"id",void 0),(0,r.A)(this,"x",void 0),(0,r.A)(this,"y",void 0),(0,r.A)(this,"width",void 0),(0,r.A)(this,"height",void 0),(0,r.A)(this,"padding",void 0),(0,r.A)(this,"isGeospatial",void 0),(0,r.A)(this,"zoom",void 0),(0,r.A)(this,"focalDistance",void 0),(0,r.A)(this,"position",void 0),(0,r.A)(this,"modelMatrix",void 0),(0,r.A)(this,"distanceScales",void 0),(0,r.A)(this,"scale",void 0),(0,r.A)(this,"center",void 0),(0,r.A)(this,"cameraPosition",void 0),(0,r.A)(this,"projectionMatrix",void 0),(0,r.A)(this,"viewMatrix",void 0),(0,r.A)(this,"viewMatrixUncentered",void 0),(0,r.A)(this,"viewMatrixInverse",void 0),(0,r.A)(this,"viewProjectionMatrix",void 0),(0,r.A)(this,"pixelProjectionMatrix",void 0),(0,r.A)(this,"pixelUnprojectionMatrix",void 0),(0,r.A)(this,"resolution",void 0),(0,r.A)(this,"_frustumPlanes",{}),this.id=t.id||this.constructor.displayName||"viewport",this.x=t.x||0,this.y=t.y||0,this.width=t.width||1,this.height=t.height||1,this.zoom=t.zoom||0,this.padding=t.padding,this.distanceScales=t.distanceScales||g,this.focalDistance=t.focalDistance||1,this.position=t.position||p,this.modelMatrix=t.modelMatrix||null;const{longitude:e,latitude:n}=t;this.isGeospatial=Number.isFinite(n)&&Number.isFinite(e),this._initProps(t),this._initMatrices(t),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get subViewports(){return null}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?h.Kx.WEB_MERCATOR:h.Kx.WEB_MERCATOR_AUTO_OFFSET:h.Kx.IDENTITY}equals(t){return t instanceof y&&(this===t||t.width===this.width&&t.height===this.height&&t.scale===this.scale&&(0,a.aI)(t.projectionMatrix,this.projectionMatrix)&&(0,a.aI)(t.viewMatrix,this.viewMatrix))}project(t,{topLeft:e=!0}={}){const n=this.projectPosition(t),r=(0,c.worldToPixels)(n,this.pixelProjectionMatrix),[i,o]=r,s=e?o:this.height-o;return 2===t.length?[i,s]:[i,s,r[2]]}unproject(t,{topLeft:e=!0,targetZ:n}={}){const[r,i,o]=t,s=e?i:this.height-i,a=n&&n*this.distanceScales.unitsPerMeter[2],l=(0,c.pixelsToWorld)([r,s,o],this.pixelUnprojectionMatrix,a),[u,h,d]=this.unprojectPosition(l);return Number.isFinite(o)?[u,h,d]:Number.isFinite(n)?[u,h,n]:[u,h]}projectPosition(t){const[e,n]=this.projectFlat(t);return[e,n,(t[2]||0)*this.distanceScales.unitsPerMeter[2]]}unprojectPosition(t){const[e,n]=this.unprojectFlat(t);return[e,n,(t[2]||0)*this.distanceScales.metersPerUnit[2]]}projectFlat(t){if(this.isGeospatial){const e=(0,c.lngLatToWorld)(t);return e[1]=(0,a.qE)(e[1],-318,830),e}return t}unprojectFlat(t){return this.isGeospatial?(0,c.worldToLngLat)(t):t}getBounds(t={}){const e={targetZ:t.z||0},n=this.unproject([0,0],e),r=this.unproject([this.width,0],e),i=this.unproject([0,this.height],e),o=this.unproject([this.width,this.height],e);return[Math.min(n[0],r[0],i[0],o[0]),Math.min(n[1],r[1],i[1],o[1]),Math.max(n[0],r[0],i[0],o[0]),Math.max(n[1],r[1],i[1],o[1])]}getDistanceScales(t){return t?(0,c.getDistanceScales)({longitude:t[0],latitude:t[1],highPrecision:!0}):this.distanceScales}containsPixel({x:t,y:e,width:n=1,height:r=1}){return t<this.x+this.width&&this.x<t+n&&e<this.y+this.height&&this.y<e+r}getFrustumPlanes(){return this._frustumPlanes.near||Object.assign(this._frustumPlanes,(0,o.on)(this.viewProjectionMatrix)),this._frustumPlanes}panByPosition(t,e){return null}_initProps(t){const e=t.longitude,n=t.latitude;this.isGeospatial&&(Number.isFinite(t.zoom)||(this.zoom=(0,c.getMeterZoom)({latitude:n})+Math.log2(this.focalDistance)),this.distanceScales=t.distanceScales||(0,c.getDistanceScales)({latitude:n,longitude:e}));const r=Math.pow(2,this.zoom);this.scale=r;const{position:i,modelMatrix:o}=t;let a=p;if(i&&(a=o?new s.A(o).transformAsVector(i,[]):i),this.isGeospatial){const t=this.projectPosition([e,n,0]);this.center=new l.A(a).scale(this.distanceScales.unitsPerMeter).add(t)}else this.center=this.projectPosition(a)}_initMatrices(t){const{viewMatrix:e=f,projectionMatrix:n=null,orthographic:r=!1,fovyRadians:c,fovy:h=75,near:p=.1,far:g=1e3,padding:y=null,focalDistance:m=1}=t;this.viewMatrixUncentered=e,this.viewMatrix=(new s.A).multiplyRight(e).translate(new l.A(this.center).negate()),this.projectionMatrix=n||function({width:t,height:e,orthographic:n,fovyRadians:r,focalDistance:i,padding:o,near:l,far:u}){const c=t/e,h=n?(new s.A).orthographic({fovy:r,aspect:c,focalDistance:i,near:l,far:u}):(new s.A).perspective({fovy:r,aspect:c,near:l,far:u});if(o){const{left:n=0,right:r=0,top:i=0,bottom:s=0}=o,l=(0,a.qE)((n+t-r)/2,0,t)-t/2,u=(0,a.qE)((i+e-s)/2,0,e)-e/2;h[8]-=2*l/t,h[9]+=2*u/e}return h}({width:this.width,height:this.height,orthographic:r,fovyRadians:c||h*d,focalDistance:m,padding:y,near:p,far:g});const v=(0,o.$M)();u.lw(v,v,this.projectionMatrix),u.lw(v,v,this.viewMatrix),this.viewProjectionMatrix=v,this.viewMatrixInverse=u.B8([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=(0,o.Vl)(this.viewMatrixInverse);const b=(0,o.$M)(),_=(0,o.$M)();u.hs(b,b,[this.width/2,-this.height/2,1]),u.Tl(b,b,[1,-1,0]),u.lw(_,b,this.viewProjectionMatrix),this.pixelProjectionMatrix=_,this.pixelUnprojectionMatrix=u.B8((0,o.$M)(),this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||i.A.warn("Pixel project matrix not invertible")()}}(0,r.A)(y,"displayName","Viewport")},82125:(t,e,n)=>{"use strict";n.d(e,{A:()=>u});var r=n(67136),i=n(54684),o=n(649),s=n(40842),a=n(54692),l=n(98569);class u extends i.A{constructor(t={}){const{latitude:e=0,longitude:n=0,zoom:i=0,pitch:s=0,bearing:u=0,nearZMultiplier:c=.1,farZMultiplier:h=1.01,nearZ:d,farZ:f,orthographic:p=!1,projectionMatrix:g,repeat:y=!1,worldOffset:m=0,position:v,padding:b,legacyMeterSizes:_=!1}=t;let{width:A,height:x,altitude:w=1.5}=t;const C=Math.pow(2,i);let S;A=A||1,x=x||1;let E=null;if(g)w=g[5]/2,S=(0,o.altitudeToFovy)(w);else{let n;if(t.fovy?(S=t.fovy,w=(0,o.fovyToAltitude)(S)):S=(0,o.altitudeToFovy)(w),b){const{top:t=0,bottom:e=0}=b;n=[0,(0,a.qE)((t+x-e)/2,0,x)-x/2]}E=(0,o.getProjectionParameters)({width:A,height:x,scale:C,center:v&&[0,0,v[2]*(0,o.unitsPerMeter)(e)],offset:n,pitch:s,fovy:S,nearZMultiplier:c,farZMultiplier:h}),Number.isFinite(d)&&(E.near=d),Number.isFinite(f)&&(E.far=f)}let M=(0,o.getViewMatrix)({height:x,pitch:s,bearing:u,scale:C,altitude:w});m&&(M=(new l.A).translate([512*m,0,0]).multiplyLeft(M)),super({...t,width:A,height:x,viewMatrix:M,longitude:n,latitude:e,zoom:i,...E,fovy:S,focalDistance:w}),(0,r.A)(this,"longitude",void 0),(0,r.A)(this,"latitude",void 0),(0,r.A)(this,"pitch",void 0),(0,r.A)(this,"bearing",void 0),(0,r.A)(this,"altitude",void 0),(0,r.A)(this,"fovy",void 0),(0,r.A)(this,"orthographic",void 0),(0,r.A)(this,"_subViewports",void 0),(0,r.A)(this,"_pseudoMeters",void 0),this.latitude=e,this.longitude=n,this.zoom=i,this.pitch=s,this.bearing=u,this.altitude=w,this.fovy=S,this.orthographic=p,this._subViewports=y?[]:null,this._pseudoMeters=_,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const t=this.getBounds(),e=Math.floor((t[0]+180)/360),n=Math.ceil((t[2]-180)/360);for(let t=e;t<=n;t++){const e=t?new u({...this,worldOffset:t}):this;this._subViewports.push(e)}}return this._subViewports}projectPosition(t){if(this._pseudoMeters)return super.projectPosition(t);const[e,n]=this.projectFlat(t);return[e,n,(t[2]||0)*(0,o.unitsPerMeter)(t[1])]}unprojectPosition(t){if(this._pseudoMeters)return super.unprojectPosition(t);const[e,n]=this.unprojectFlat(t);return[e,n,(t[2]||0)/(0,o.unitsPerMeter)(n)]}addMetersToLngLat(t,e){return(0,o.addMetersToLngLat)(t,e)}panByPosition(t,e){const n=(0,o.pixelsToWorld)(e,this.pixelUnprojectionMatrix),r=this.projectFlat(t),i=s.WQ([],r,s.ze([],n)),a=s.WQ([],this.center,i),[l,u]=this.unprojectFlat(a);return{longitude:l,latitude:u}}getBounds(t={}){const e=(0,o.getBounds)(this,t.z||0);return[Math.min(e[0][0],e[1][0],e[2][0],e[3][0]),Math.min(e[0][1],e[1][1],e[2][1],e[3][1]),Math.max(e[0][0],e[1][0],e[2][0],e[3][0]),Math.max(e[0][1],e[1][1],e[2][1],e[3][1])]}fitBounds(t,e={}){const{width:n,height:r}=this,{longitude:i,latitude:s,zoom:a}=(0,o.fitBounds)({width:n,height:r,bounds:t,...e});return new u({width:n,height:r,longitude:i,latitude:s,zoom:a})}}(0,r.A)(u,"displayName","WebMercatorViewport")},45029:(t,e,n)=>{"use strict";n.d(e,{A:()=>a});var r=n(67136),i=n(43035),o=n(82125),s=n(2249);class a extends i.A{get ViewportType(){return o.A}get ControllerType(){return s.A}}(0,r.A)(a,"displayName","MapView")},43035:(t,e,n)=>{"use strict";n.d(e,{A:()=>c});var r=n(67136),i=n(54684);const o=/([0-9]+\.?[0-9]*)(%|px)/;function s(t){switch(typeof t){case"number":return{position:t,relative:!1};case"string":const e=o.exec(t);if(e&&e.length>=3){const t="%"===e[2],n=parseFloat(e[1]);return{position:t?n/100:n,relative:t}}default:throw new Error("Could not parse position string ".concat(t))}}function a(t,e){return t.relative?Math.round(t.position*e):t.position}var l=n(75107),u=n(40898);class c{constructor(t){(0,r.A)(this,"id",void 0),(0,r.A)(this,"viewportInstance",void 0),(0,r.A)(this,"_x",void 0),(0,r.A)(this,"_y",void 0),(0,r.A)(this,"_width",void 0),(0,r.A)(this,"_height",void 0),(0,r.A)(this,"_padding",void 0),(0,r.A)(this,"props",void 0);const{id:e,x:n=0,y:o=0,width:a="100%",height:l="100%",padding:c=null,viewportInstance:h}=t||{};(0,u.A)(!h||h instanceof i.A),this.viewportInstance=h,this.id=e||this.constructor.displayName||"view",this.props={...t,id:this.id},this._x=s(n),this._y=s(o),this._width=s(a),this._height=s(l),this._padding=c&&{left:s(c.left||0),right:s(c.right||0),top:s(c.top||0),bottom:s(c.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(t){return this===t||(this.viewportInstance?!!t.viewportInstance&&this.viewportInstance.equals(t.viewportInstance):this.ViewportType===t.ViewportType&&(0,l.b)(this.props,t.props,2))}makeViewport({width:t,height:e,viewState:n}){if(this.viewportInstance)return this.viewportInstance;n=this.filterViewState(n);const r=this.getDimensions({width:t,height:e});return r.height&&r.width?new this.ViewportType({...n,...this.props,...r}):null}getViewStateId(){const{viewState:t}=this.props;return"string"==typeof t?t:(null==t?void 0:t.id)||this.id}filterViewState(t){if(this.props.viewState&&"object"==typeof this.props.viewState){if(!this.props.viewState.id)return this.props.viewState;const e={...t};for(const t in this.props.viewState)"id"!==t&&(e[t]=this.props.viewState[t]);return e}return t}getDimensions({width:t,height:e}){const n={x:a(this._x,t),y:a(this._y,e),width:a(this._width,t),height:a(this._height,e)};return this._padding&&(n.padding={left:a(this._padding.left,t),top:a(this._padding.top,e),right:a(this._padding.right,t),bottom:a(this._padding.bottom,e)}),n}get controller(){const t=this.props.controller;return t?!0===t?{type:this.ControllerType}:"function"==typeof t?{type:t}:{type:this.ControllerType,...t}:null}}},96042:(t,e,n)=>{"use strict";n.d(e,{A:()=>c});var r=n(67136),i=n(5105);const o="\nuniform vec4 clip_bounds;\n\nbool clip_isInBounds(vec2 position) {\n  return position.x >= clip_bounds[0] && position.y >= clip_bounds[1] && position.x < clip_bounds[2] && position.y < clip_bounds[3];\n}\n",s={name:"clip-vs",vs:o},a={"vs:#decl":"\nvarying float clip_isVisible;\n","vs:DECKGL_FILTER_GL_POSITION":"\n  clip_isVisible = float(clip_isInBounds(geometry.worldPosition.xy));\n","fs:#decl":"\nvarying float clip_isVisible;\n","fs:DECKGL_FILTER_COLOR":"\n  if (clip_isVisible < 0.5) discard;\n"},l={name:"clip-fs",fs:o},u={"vs:#decl":"\nvarying vec2 clip_commonPosition;\n","vs:DECKGL_FILTER_GL_POSITION":"\n  clip_commonPosition = geometry.position.xy;\n","fs:#decl":"\nvarying vec2 clip_commonPosition;\n","fs:DECKGL_FILTER_COLOR":"\n  if (!clip_isInBounds(clip_commonPosition)) discard;\n"};class c extends i.A{getShaders(){let t="instancePositions"in this.getAttributeManager().attributes;return void 0!==this.props.clipByInstance&&(t=Boolean(this.props.clipByInstance)),this.state.clipByInstance=t,t?{modules:[s],inject:a}:{modules:[l],inject:u}}draw({uniforms:t}){const{clipBounds:e}=this.props;if(this.state.clipByInstance)t.clip_bounds=e;else{const n=this.projectPosition([e[0],e[1],0]),r=this.projectPosition([e[2],e[3],0]);t.clip_bounds=[Math.min(n[0],r[0]),Math.min(n[1],r[1]),Math.max(n[0],r[0]),Math.max(n[1],r[1])]}}}(0,r.A)(c,"defaultProps",{clipBounds:[0,0,1,1],clipByInstance:void 0}),(0,r.A)(c,"extensionName","ClipExtension")},74704:(t,e,n)=>{"use strict";n.r(e),n.d(e,{BrushingExtension:()=>l,ClipExtension:()=>G.A,CollisionFilterExtension:()=>nt,DataFilterExtension:()=>w,FillStyleExtension:()=>j,Fp64Extension:()=>I,MaskExtension:()=>it,PathStyleExtension:()=>D,_TerrainExtension:()=>mt,project64:()=>T});var r=n(67136),i=n(5105),o=n(19488);const s={source:0,target:1,custom:2,source_target:3},a={name:"brushing",dependencies:[o.A],vs:"\n  uniform bool brushing_enabled;\n  uniform int brushing_target;\n  uniform vec2 brushing_mousePos;\n  uniform float brushing_radius;\n\n  #ifdef NON_INSTANCED_MODEL\n  attribute vec2 brushingTargets;\n  #else\n  attribute vec2 instanceBrushingTargets;\n  #endif\n\n  varying float brushing_isVisible;\n\n  bool brushing_isPointInRange(vec2 position) {\n    if (!brushing_enabled) {\n      return true;\n    }\n    vec2 source_commonspace = project_position(position);\n    vec2 target_commonspace = project_position(brushing_mousePos);\n    float distance = length((target_commonspace - source_commonspace) / project_uCommonUnitsPerMeter.xy);\n\n    return distance <= brushing_radius;\n  }\n\n  bool brushing_arePointsInRange(vec2 sourcePos, vec2 targetPos) {\n    return brushing_isPointInRange(sourcePos) || brushing_isPointInRange(targetPos);\n  }\n\n  void brushing_setVisible(bool visible) {\n    brushing_isVisible = float(visible);\n  }\n",fs:"\n  uniform bool brushing_enabled;\n  varying float brushing_isVisible;\n",inject:{"vs:DECKGL_FILTER_GL_POSITION":"\n    vec2 brushingTarget;\n    vec2 brushingSource;\n    if (brushing_target == 3) {\n      brushingTarget = geometry.worldPositionAlt.xy;\n      brushingSource = geometry.worldPosition.xy;\n    } else if (brushing_target == 0) {\n      brushingTarget = geometry.worldPosition.xy;\n    } else if (brushing_target == 1) {\n      brushingTarget = geometry.worldPositionAlt.xy;\n    } else {\n      #ifdef NON_INSTANCED_MODEL\n      brushingTarget = brushingTargets;\n      #else\n      brushingTarget = instanceBrushingTargets;\n      #endif\n    }\n    bool visible;\n    if (brushing_target == 3) {\n      visible = brushing_arePointsInRange(brushingSource, brushingTarget);\n    } else {\n      visible = brushing_isPointInRange(brushingTarget);\n    }\n    brushing_setVisible(visible);\n  ","fs:DECKGL_FILTER_COLOR":"\n    if (brushing_enabled && brushing_isVisible < 0.5) {\n      discard;\n    }\n  "},getUniforms:t=>{if(!t||!("viewport"in t))return{};const{brushingEnabled:e=!0,brushingRadius:n=1e4,brushingTarget:r="source",mousePosition:i,viewport:o}=t;return{brushing_enabled:Boolean(e&&i&&o.containsPixel(i)),brushing_radius:n,brushing_target:s[r]||0,brushing_mousePos:i?o.unproject([i.x-o.x,i.y-o.y]):[0,0]}}};class l extends i.A{getShaders(){return{modules:[a]}}initializeState(t,e){const n=this.getAttributeManager();n&&n.add({brushingTargets:{size:2,accessor:"getBrushingTarget",shaderAttributes:{brushingTargets:{divisor:0},instanceBrushingTargets:{divisor:1}}}}),this.state.onMouseMove=()=>{var t;null===(t=this.getCurrentLayer())||void 0===t||t.setNeedsRedraw()},t.deck&&t.deck.eventManager.on({pointermove:this.state.onMouseMove,pointerleave:this.state.onMouseMove})}finalizeState(t,e){t.deck&&t.deck.eventManager.off({pointermove:this.state.onMouseMove,pointerleave:this.state.onMouseMove})}}(0,r.A)(l,"defaultProps",{getBrushingTarget:{type:"accessor",value:[0,0]},brushingTarget:"source",brushingEnabled:!0,brushingRadius:1e4}),(0,r.A)(l,"extensionName","BrushingExtension");const u="\nuniform DATAFILTER_TYPE filter_min;\nuniform DATAFILTER_TYPE filter_softMin;\nuniform DATAFILTER_TYPE filter_softMax;\nuniform DATAFILTER_TYPE filter_max;\nuniform bool filter_useSoftMargin;\nuniform bool filter_enabled;\nuniform bool filter_transformSize;\n\n#ifdef NON_INSTANCED_MODEL\n  #define DATAFILTER_ATTRIB filterValues\n  #define DATAFILTER_ATTRIB_64LOW filterValues64Low\n#else\n  #define DATAFILTER_ATTRIB instanceFilterValues\n  #define DATAFILTER_ATTRIB_64LOW instanceFilterValues64Low\n#endif\n\nattribute DATAFILTER_TYPE DATAFILTER_ATTRIB;\n#ifdef DATAFILTER_DOUBLE\n  attribute DATAFILTER_TYPE DATAFILTER_ATTRIB_64LOW;\n\n  uniform DATAFILTER_TYPE filter_min64High;\n  uniform DATAFILTER_TYPE filter_max64High;\n#endif\n\nvarying float dataFilter_value;\n\nfloat dataFilter_reduceValue(float value) {\n  return value;\n}\nfloat dataFilter_reduceValue(vec2 value) {\n  return min(value.x, value.y);\n}\nfloat dataFilter_reduceValue(vec3 value) {\n  return min(min(value.x, value.y), value.z);\n}\nfloat dataFilter_reduceValue(vec4 value) {\n  return min(min(value.x, value.y), min(value.z, value.w));\n}\nvoid dataFilter_setValue(DATAFILTER_TYPE valueFromMin, DATAFILTER_TYPE valueFromMax) {\n  if (filter_enabled) {\n    if (filter_useSoftMargin) {\n      dataFilter_value = dataFilter_reduceValue(\n        smoothstep(filter_min, filter_softMin, valueFromMin) *\n        (1.0 - smoothstep(filter_softMax, filter_max, valueFromMax))\n      );\n    } else {\n      dataFilter_value = dataFilter_reduceValue(\n        step(filter_min, valueFromMin) * step(valueFromMax, filter_max)\n      );\n    }\n  } else {\n    dataFilter_value = 1.0;\n  }\n}\n",c="\nuniform bool filter_transformColor;\nvarying float dataFilter_value;\n";function h(t){if(!t||!("extensions"in t))return{};const{filterRange:e=[-1,1],filterEnabled:n=!0,filterTransformSize:r=!0,filterTransformColor:i=!0}=t,o=t.filterSoftRange||e;return{...Number.isFinite(e[0])?{filter_min:e[0],filter_softMin:o[0],filter_softMax:o[1],filter_max:e[1]}:{filter_min:e.map((t=>t[0])),filter_softMin:o.map((t=>t[0])),filter_softMax:o.map((t=>t[1])),filter_max:e.map((t=>t[1]))},filter_enabled:n,filter_useSoftMargin:Boolean(t.filterSoftRange),filter_transformSize:n&&r,filter_transformColor:n&&i}}const d={"vs:#main-start":"\n    #ifdef DATAFILTER_DOUBLE\n      dataFilter_setValue(\n        DATAFILTER_ATTRIB - filter_min64High + DATAFILTER_ATTRIB_64LOW,\n        DATAFILTER_ATTRIB - filter_max64High + DATAFILTER_ATTRIB_64LOW\n      );\n    #else\n      dataFilter_setValue(DATAFILTER_ATTRIB, DATAFILTER_ATTRIB);\n    #endif\n  ","vs:#main-end":"\n    if (dataFilter_value == 0.0) {\n      gl_Position = vec4(0.);\n    }\n  ","vs:DECKGL_FILTER_SIZE":"\n    if (filter_transformSize) {\n      size = size * dataFilter_value;\n    }\n  ","fs:DECKGL_FILTER_COLOR":"\n    if (dataFilter_value == 0.0) discard;\n    if (filter_transformColor) {\n      color.a *= dataFilter_value;\n    }\n  "},f={name:"data-filter",vs:u,fs:c,inject:d,getUniforms:h},p={name:"data-filter-fp64",vs:u,fs:c,inject:d,getUniforms:function(t){if(!t||!("extensions"in t))return{};const e=h(t);if(Number.isFinite(e.filter_min)){const t=Math.fround(e.filter_min);e.filter_min-=t,e.filter_softMin-=t,e.filter_min64High=t;const n=Math.fround(e.filter_max);e.filter_max-=n,e.filter_softMax-=n,e.filter_max64High=n}else{const t=e.filter_min.map(Math.fround);e.filter_min=e.filter_min.map(((e,n)=>e-t[n])),e.filter_softMin=e.filter_softMin.map(((e,n)=>e-t[n])),e.filter_min64High=t;const n=e.filter_max.map(Math.fround);e.filter_max=e.filter_max.map(((t,e)=>t-n[e])),e.filter_softMax=e.filter_softMax.map(((t,e)=>t-n[e])),e.filter_max64High=n}return e}};var g=n(80606),y=n(26107),m=n(8282),v=n(76694);const b={blend:!0,blendFunc:[1,1,1,1],blendEquation:[32774,32774],depthTest:!1};var _=n(22780),A=n(27968);const x={1:"float",2:"vec2",3:"vec3",4:"vec4"};class w extends i.A{constructor({filterSize:t=1,fp64:e=!1,countItems:n=!1}={}){if(!x[t])throw new Error("filterSize out of range");super({filterSize:t,fp64:e,countItems:n})}getShaders(t){const{filterSize:e,fp64:n}=t.opts;return{modules:[n?p:f],defines:{DATAFILTER_TYPE:x[e],DATAFILTER_DOUBLE:Boolean(n)}}}initializeState(t,e){const n=this.getAttributeManager();n&&n.add({filterValues:{size:e.opts.filterSize,type:e.opts.fp64?5130:5126,accessor:"getFilterValue",shaderAttributes:{filterValues:{divisor:0},instanceFilterValues:{divisor:1}}}});const{gl:r}=this.context;if(n&&e.opts.countItems){const t=function(t){return Boolean(t.getExtension("EXT_float_blend")&&(t.getExtension("EXT_color_buffer_float")||t.getExtension("WEBGL_color_buffer_float")))}(r);n.add({filterIndices:{size:t?1:2,vertexOffset:1,type:5121,normalized:!0,accessor:(e,{index:n})=>{const r=e&&e.__source?e.__source.index:n;return t?(r+1)%255:[(r+1)%255,Math.floor(r/255)%255]},shaderAttributes:{filterPrevIndices:{vertexOffset:0},filterIndices:{vertexOffset:1}}}});const i=function(t,e){return e?new g.A(t,{width:1,height:1,attachments:{36064:new y.A(t,{format:(0,m.C6)(t)?34836:6408,type:5126,mipmaps:!1})}}):new g.A(t,{width:256,height:64,depth:!1})}(r,t),o=function(t,e,n){return e.defines.NON_INSTANCED_MODEL=1,n&&(e.defines.FLOAT_TARGET=1),new v.A(t,{id:"data-filter-aggregation-model",vertexCount:1,isInstanced:!1,drawMode:0,vs:"#define SHADER_NAME data-filter-vertex-shader\n\n#ifdef FLOAT_TARGET\n  attribute float filterIndices;\n  attribute float filterPrevIndices;\n#else\n  attribute vec2 filterIndices;\n  attribute vec2 filterPrevIndices;\n#endif\n\nvarying vec4 vColor;\nconst float component = 1.0 / 255.0;\n\nvoid main() {\n  #ifdef FLOAT_TARGET\n    dataFilter_value *= float(filterIndices != filterPrevIndices);\n    gl_Position = vec4(0.0, 0.0, 0.0, 1.0);\n    vColor = vec4(0.0, 0.0, 0.0, 1.0);\n  #else\n    // Float texture is not supported: pack result into 4 channels x 256 px x 64px\n    dataFilter_value *= float(filterIndices.x != filterPrevIndices.x);\n    float col = filterIndices.x;\n    float row = filterIndices.y * 4.0;\n    float channel = floor(row);\n    row = fract(row);\n    vColor = component * vec4(bvec4(channel == 0.0, channel == 1.0, channel == 2.0, channel == 3.0));\n    gl_Position = vec4(col * 2.0 - 1.0, row * 2.0 - 1.0, 0.0, 1.0);\n  #endif\n  gl_PointSize = 1.0;\n}\n",fs:"#define SHADER_NAME data-filter-fragment-shader\nprecision highp float;\n\nvarying vec4 vColor;\n\nvoid main() {\n  if (dataFilter_value < 0.5) {\n    discard;\n  }\n  gl_FragColor = vColor;\n}\n",...e})}(r,e.getShaders.call(this,e),t);this.setState({filterFBO:i,filterModel:o})}}updateState({props:t,oldProps:e}){if(this.state.filterModel){const n=this.getAttributeManager().attributes.filterValues.needsUpdate()||t.filterEnabled!==e.filterEnabled||t.filterRange!==e.filterRange||t.filterSoftRange!==e.filterSoftRange;n&&this.setState({filterNeedsUpdate:n})}}draw(t,e){const{filterFBO:n,filterModel:r,filterNeedsUpdate:i}=this.state,{onFilteredItemsChange:o}=this.props;if(i&&o&&r){const{attributes:{filterValues:e,filterIndices:i}}=this.getAttributeManager();r.setVertexCount(this.getNumInstances());const{gl:s}=this.context;(0,_.I)(s,{framebuffer:n,color:[0,0,0,0]}),r.updateModuleSettings(t.moduleParameters).setAttributes({...e.getShaderAttributes(),...i&&i.getShaderAttributes()}).draw({framebuffer:n,parameters:{...b,viewport:[0,0,n.width,n.height]}});const a=(0,A.sy)(n);let l=0;for(let t=0;t<a.length;t++)l+=a[t];o({id:this.id,count:l}),this.state.filterNeedsUpdate=!1}}finalizeState(){const{filterFBO:t,filterModel:e}=this.state;t&&(t.color.delete(),t.delete(),e.delete())}}(0,r.A)(w,"defaultProps",{getFilterValue:{type:"accessor",value:0},onFilteredItemsChange:{type:"function",value:null,optional:!0},filterEnabled:!0,filterRange:[-1,1],filterSoftRange:null,filterTransformSize:!0,filterTransformColor:!0}),(0,r.A)(w,"extensionName","DataFilterExtension");var C=n(1597),S=n(98589),E=n(1490);const{fp64ify:M,fp64ifyMatrix4:P}=S.vP,T={name:"project64",dependencies:[o.A,S.vP],vs:"\nconst vec2 WORLD_SCALE_FP64 = vec2(81.4873275756836, 0.0000032873668232014097);\n\nuniform vec2 project_uViewProjectionMatrixFP64[16];\nvoid mercatorProject_fp64(vec4 lnglat_fp64, out vec2 out_val[2]) {\n\n#if defined(NVIDIA_FP64_WORKAROUND)\n  out_val[0] = sum_fp64(radians_fp64(lnglat_fp64.xy), PI_FP64 * ONE);\n#else\n  out_val[0] = sum_fp64(radians_fp64(lnglat_fp64.xy), PI_FP64);\n#endif\n  out_val[1] = sum_fp64(PI_FP64,\n    log_fp64(tan_fp64(sum_fp64(PI_4_FP64, radians_fp64(lnglat_fp64.zw) / 2.0))));\n  return;\n}\n\nvoid project_position_fp64(vec4 position_fp64, out vec2 out_val[2]) {\n  vec2 pos_fp64[2];\n  mercatorProject_fp64(position_fp64, pos_fp64);\n  out_val[0] = mul_fp64(pos_fp64[0], WORLD_SCALE_FP64);\n  out_val[1] = mul_fp64(pos_fp64[1], WORLD_SCALE_FP64);\n\n  return;\n}\n\nvoid project_position_fp64(vec2 position, vec2 position64xyLow, out vec2 out_val[2]) {\n  vec4 position64xy = vec4(\n    position.x, position64xyLow.x,\n    position.y, position64xyLow.y);\n\n  project_position_fp64(position64xy, out_val);\n}\n\nvec4 project_common_position_to_clipspace_fp64(vec2 vertex_pos_modelspace[4]) {\n  vec2 vertex_pos_clipspace[4];\n  mat4_vec4_mul_fp64(project_uViewProjectionMatrixFP64, vertex_pos_modelspace,\n    vertex_pos_clipspace);\n  return vec4(\n    vertex_pos_clipspace[0].x,\n    vertex_pos_clipspace[1].x,\n    vertex_pos_clipspace[2].x,\n    vertex_pos_clipspace[3].x\n    );\n}\n\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64xyLow, vec3 offset, out vec4 commonPosition\n) {\n  vec2 offset64[4];\n  vec4_fp64(vec4(offset, 0.0), offset64);\n\n  float z = project_size(position.z);\n  vec2 projectedPosition64xy[2];\n  project_position_fp64(position.xy, position64xyLow.xy, projectedPosition64xy);\n\n  vec2 commonPosition64[4];\n  commonPosition64[0] = sum_fp64(offset64[0], projectedPosition64xy[0]);\n  commonPosition64[1] = sum_fp64(offset64[1], projectedPosition64xy[1]);\n  commonPosition64[2] = sum_fp64(offset64[2], vec2(z, 0.0));\n  commonPosition64[3] = vec2(1.0, 0.0);\n\n  commonPosition = vec4(projectedPosition64xy[0].x, projectedPosition64xy[1].x, z, 1.0);\n\n  return project_common_position_to_clipspace_fp64(commonPosition64);\n}\n\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64xyLow, vec3 offset\n) {\n  vec4 commonPosition;\n  return project_position_to_clipspace(\n    position, position64xyLow, offset, commonPosition\n  );\n}\n",getUniforms:function(t){if(t&&"viewport"in t){const{viewProjectionMatrix:e,scale:n}=t.viewport;return O({viewProjectionMatrix:e,scale:n})}return{}}},O=(0,E.A)((function({viewProjectionMatrix:t,scale:e}){const n=P(t);return{project_uViewProjectionMatrixFP64:n,project64_uViewProjectionMatrix:n,project64_uScale:M(e)}}));class I extends i.A{getShaders(){const{coordinateSystem:t}=this.props;if(t!==C.rf.LNGLAT&&t!==C.rf.DEFAULT)throw new Error("fp64: coordinateSystem must be LNGLAT");return{modules:[T]}}}(0,r.A)(I,"extensionName","Fp64Extension");var R=n(49605);const B={inject:{"vs:#decl":"\nattribute vec2 instanceDashArrays;\nattribute float instanceDashOffsets;\nvarying vec2 vDashArray;\nvarying float vDashOffset;\n","vs:#main-end":"\nvDashArray = instanceDashArrays;\nvDashOffset = instanceDashOffsets / width.x;\n","fs:#decl":"\nuniform float dashAlignMode;\nuniform float capType;\nuniform bool dashGapPickable;\nvarying vec2 vDashArray;\nvarying float vDashOffset;\n\nfloat round(float x) {\n  return floor(x + 0.5);\n}\n","fs:#main-start":"\n  float solidLength = vDashArray.x;\n  float gapLength = vDashArray.y;\n  float unitLength = solidLength + gapLength;\n\n  float offset;\n\n  if (unitLength > 0.0) {\n    if (dashAlignMode == 0.0) {\n      offset = vDashOffset;\n    } else {\n      unitLength = vPathLength / round(vPathLength / unitLength);\n      offset = solidLength / 2.0;\n    }\n\n    float unitOffset = mod(vPathPosition.y + offset, unitLength);\n\n    if (gapLength > 0.0 && unitOffset > solidLength) {\n      if (capType <= 0.5) {\n        if (!(dashGapPickable && picking_uActive)) {\n          discard;\n        }\n      } else {\n        float distToEnd = length(vec2(\n          min(unitOffset - solidLength, unitLength - unitOffset),\n          vPathPosition.x\n        ));\n        if (distToEnd > 1.0) {\n          if (!(dashGapPickable && picking_uActive)) {\n            discard;\n          }\n        }\n      }\n    }\n  }\n"}},L={inject:{"vs:#decl":"\nattribute float instanceOffsets;\n","vs:DECKGL_FILTER_SIZE":"\n  float offsetWidth = abs(instanceOffsets * 2.0) + 1.0;\n  size *= offsetWidth;\n","vs:#main-end":"\n  float offsetWidth = abs(instanceOffsets * 2.0) + 1.0;\n  float offsetDir = sign(instanceOffsets);\n  vPathPosition.x = (vPathPosition.x + offsetDir) * offsetWidth - offsetDir;\n  vPathPosition.y *= offsetWidth;\n  vPathLength *= offsetWidth;\n","fs:#main-start":"\n  float isInside;\n  isInside = step(-1.0, vPathPosition.x) * step(vPathPosition.x, 1.0);\n  if (isInside == 0.0) {\n    discard;\n  }\n"}};var k=n(30329);class D extends i.A{constructor({dash:t=!1,offset:e=!1,highPrecisionDash:n=!1}={}){super({dash:t||n,offset:e,highPrecisionDash:n})}isEnabled(t){return"pathTesselator"in t.state}getShaders(t){if(!t.isEnabled(this))return null;let e={};return t.opts.dash&&(e=(0,R.n)(e,B)),t.opts.offset&&(e=(0,R.n)(e,L)),e}initializeState(t,e){const n=this.getAttributeManager();n&&e.isEnabled(this)&&(e.opts.dash&&n.addInstanced({instanceDashArrays:{size:2,accessor:"getDashArray"}}),e.opts.highPrecisionDash&&n.addInstanced({instanceDashOffsets:{size:1,accessor:"getPath",transform:e.getDashOffsets.bind(this)}}),e.opts.offset&&n.addInstanced({instanceOffsets:{size:1,accessor:"getOffset"}}))}updateState(t,e){if(!e.isEnabled(this))return;const n={};e.opts.dash&&(n.dashAlignMode=this.props.dashJustified?1:0,n.dashGapPickable=Boolean(this.props.dashGapPickable)),this.state.model.setUniforms(n)}getDashOffsets(t){const e=[0],n="XY"===this.props.positionFormat?2:3,r=Array.isArray(t[0]),i=r?t.length:t.length/n;let o,s;for(let a=0;a<i-1;a++)o=r?t[a]:t.slice(a*n,a*n+n),o=this.projectPosition(o),a>0&&(e[a]=e[a-1]+(0,k.xg)(s,o)),s=o;return e}}(0,r.A)(D,"defaultProps",{getDashArray:{type:"accessor",value:[0,0]},getOffset:{type:"accessor",value:0},dashJustified:!1,dashGapPickable:!1}),(0,r.A)(D,"extensionName","PathStyleExtension");var F=n(51682);const N={name:"fill-pattern",vs:"\n#ifdef NON_INSTANCED_MODEL\n  #define FILL_PATTERN_FRAME_ATTRIB fillPatternFrames\n  #define FILL_PATTERN_SCALE_ATTRIB fillPatternScales\n  #define FILL_PATTERN_OFFSET_ATTRIB fillPatternOffsets\n#else\n  #define FILL_PATTERN_FRAME_ATTRIB instanceFillPatternFrames\n  #define FILL_PATTERN_SCALE_ATTRIB instanceFillPatternScales\n  #define FILL_PATTERN_OFFSET_ATTRIB instanceFillPatternOffsets\n#endif\n\nattribute vec4 FILL_PATTERN_FRAME_ATTRIB;\nattribute float FILL_PATTERN_SCALE_ATTRIB;\nattribute vec2 FILL_PATTERN_OFFSET_ATTRIB;\n\nuniform bool fill_patternEnabled;\nuniform vec2 fill_patternTextureSize;\n\nvarying vec2 fill_uv;\nvarying vec4 fill_patternBounds;\nvarying vec4 fill_patternPlacement;\n",fs:"\nuniform bool fill_patternEnabled;\nuniform bool fill_patternMask;\nuniform sampler2D fill_patternTexture;\nuniform vec2 fill_uvCoordinateOrigin;\nuniform vec2 fill_uvCoordinateOrigin64Low;\n\nvarying vec4 fill_patternBounds;\nvarying vec4 fill_patternPlacement;\nvarying vec2 fill_uv;\n\nconst float FILL_UV_SCALE = 512.0 / 40000000.0;\n",inject:{"vs:DECKGL_FILTER_GL_POSITION":"\n    fill_uv = geometry.position.xy;\n  ","vs:DECKGL_FILTER_COLOR":"\n    if (fill_patternEnabled) {\n      fill_patternBounds = FILL_PATTERN_FRAME_ATTRIB / vec4(fill_patternTextureSize, fill_patternTextureSize);\n      fill_patternPlacement.xy = FILL_PATTERN_OFFSET_ATTRIB;\n      fill_patternPlacement.zw = FILL_PATTERN_SCALE_ATTRIB * FILL_PATTERN_FRAME_ATTRIB.zw;\n    }\n  ","fs:DECKGL_FILTER_COLOR":"\n    if (fill_patternEnabled) {\n      vec2 scale = FILL_UV_SCALE * fill_patternPlacement.zw;\n      vec2 patternUV = mod(mod(fill_uvCoordinateOrigin, scale) + fill_uvCoordinateOrigin64Low + fill_uv, scale) / scale;\n      patternUV = mod(fill_patternPlacement.xy + patternUV, 1.0);\n\n      vec2 texCoords = fill_patternBounds.xy + fill_patternBounds.zw * patternUV;\n\n      vec4 patternColor = texture2D(fill_patternTexture, texCoords);\n      color.a *= patternColor.a;\n      if (!fill_patternMask) {\n        color.rgb = patternColor.rgb;\n      }\n    }\n  "},dependencies:[o.A],getUniforms:function(t,e){if(!t)return{};if("fillPatternTexture"in t){const{fillPatternTexture:e}=t;return{fill_patternTexture:e,fill_patternTextureSize:[e.width,e.height]}}if("viewport"in t){const{fillPatternMask:n=!0,fillPatternEnabled:r=!0}=t,{project_uCommonOrigin:i}=e,o=[(0,F.qk)(i[0]),(0,F.qk)(i[1])];return{fill_uvCoordinateOrigin:i.slice(0,2),fill_uvCoordinateOrigin64Low:o,fill_patternMask:n,fill_patternEnabled:r}}return{}}};class j extends i.A{constructor({pattern:t=!1}={}){super({pattern:t})}isEnabled(t){return null!==t.getAttributeManager()&&!("pathTesselator"in t.state)}getShaders(t){return t.isEnabled(this)?{modules:[t.opts.pattern&&N].filter(Boolean)}:null}initializeState(t,e){if(!e.isEnabled(this))return;const n=this.getAttributeManager();e.opts.pattern&&n.add({fillPatternFrames:{size:4,accessor:"getFillPattern",transform:e.getPatternFrame.bind(this),shaderAttributes:{fillPatternFrames:{divisor:0},instanceFillPatternFrames:{divisor:1}}},fillPatternScales:{size:1,accessor:"getFillPatternScale",defaultValue:1,shaderAttributes:{fillPatternScales:{divisor:0},instanceFillPatternScales:{divisor:1}}},fillPatternOffsets:{size:2,accessor:"getFillPatternOffset",shaderAttributes:{fillPatternOffsets:{divisor:0},instanceFillPatternOffsets:{divisor:1}}}}),this.setState({emptyTexture:new y.A(this.context.gl,{data:new Uint8Array(4),width:1,height:1})})}updateState({props:t,oldProps:e},n){n.isEnabled(this)&&t.fillPatternMapping&&t.fillPatternMapping!==e.fillPatternMapping&&this.getAttributeManager().invalidate("getFillPattern")}draw(t,e){if(!e.isEnabled(this))return;const{fillPatternAtlas:n}=this.props;this.setModuleParameters({fillPatternTexture:n||this.state.emptyTexture})}finalizeState(){const{emptyTexture:t}=this.state;null==t||t.delete()}getPatternFrame(t){const{fillPatternMapping:e}=this.getCurrentLayer().props,n=e&&e[t];return n?[n.x,n.y,n.width,n.height]:[0,0,0,0]}}(0,r.A)(j,"defaultProps",{fillPatternEnabled:!0,fillPatternAtlas:{type:"image",value:null,async:!0,parameters:{10241:9729}},fillPatternMapping:{type:"object",value:{},async:!0},fillPatternMask:!0,getFillPattern:{type:"accessor",value:t=>t.pattern},getFillPatternScale:{type:"accessor",value:1},getFillPatternOffset:{type:"accessor",value:[0,0]}}),(0,r.A)(j,"extensionName","FillStyleExtension");var G=n(96042);const U={name:"collision",dependencies:[o.A],vs:"\n#ifdef NON_INSTANCED_MODEL\nattribute float collisionPriorities;\n#else\nattribute float instanceCollisionPriorities;\n#endif\n\nuniform sampler2D collision_texture;\nuniform bool collision_sort;\nuniform bool collision_enabled;\n\nvec2 collision_getCoords(vec4 position) {\n  vec4 collision_clipspace = project_common_position_to_clipspace(position);\n  return (1.0 + collision_clipspace.xy / collision_clipspace.w) / 2.0;\n}\n\nfloat collision_match(vec2 tex, vec3 pickingColor) {\n  vec4 collision_pickingColor = texture2D(collision_texture, tex);\n  float delta = dot(abs(collision_pickingColor.rgb - pickingColor), vec3(1.0));\n  float e = 0.001;\n  return step(delta, e);\n}\n\nfloat collision_isVisible(vec2 texCoords, vec3 pickingColor) {\n  if (!collision_enabled) {\n    return 1.0;\n  }\n\n  // Visibility test, sample area of 5x5 pixels in order to fade in/out.\n  // Due to the locality, the lookups will be cached\n  // This reduces the flicker present when objects are shown/hidden\n  const int N = 2;\n  float accumulator = 0.0;\n  vec2 step = vec2(1.0 / project_uViewportSize);\n\n  const float floatN = float(N);\n  vec2 delta = -floatN * step;\n  for(int i = -N; i <= N; i++) {\n    delta.x = -step.x * floatN;\n    for(int j = -N; j <= N; j++) {\n      accumulator += collision_match(texCoords + delta, pickingColor);\n      delta.x += step.x;\n    }\n    delta.y += step.y;\n  }\n\n  float W = 2.0 * floatN + 1.0;\n  return pow(accumulator / (W * W), 2.2);\n}\n",inject:{"vs:#decl":"\n  float collision_fade = 1.0;\n","vs:DECKGL_FILTER_GL_POSITION":"\n  if (collision_sort) {\n    #ifdef NON_INSTANCED_MODEL\n    float collisionPriority = collisionPriorities;\n    #else\n    float collisionPriority = instanceCollisionPriorities;\n    #endif\n    position.z = -0.001 * collisionPriority * position.w; // Support range -1000 -> 1000\n  }\n\n  if (collision_enabled) {\n    vec4 collision_common_position = project_position(vec4(geometry.worldPosition, 1.0));\n    vec2 collision_texCoords = collision_getCoords(collision_common_position);\n    collision_fade = collision_isVisible(collision_texCoords, geometry.pickingColor / 255.0);\n    if (collision_fade < 0.0001) {\n      // Position outside clip space bounds to discard\n      position = vec4(0.0, 0.0, 2.0, 1.0);\n    }\n  }\n  ","vs:DECKGL_FILTER_COLOR":"\n  color.a *= collision_fade;\n  "},getUniforms:(t,e)=>{if(!t||!("dummyCollisionMap"in t))return{};const{collisionFBO:n,drawToCollisionMap:r,dummyCollisionMap:i}=t;return{collision_sort:Boolean(r),collision_texture:!r&&n?n:i}}};var z=n(50408),V=n(54692),H=n(75107),q=n(64156);class W extends q.A{renderCollisionMap(t,e){const n=this.gl;return(0,m.zv)(n,{scissorTest:!0,scissor:[1,1,t.width-2,t.height-2],clearColor:[0,0,0,0],blend:!1,depthTest:!0,depthRange:[0,1]},(()=>this.render({...e,target:t,pass:"collision"})))}getModuleParameters(){return{drawToCollisionMap:!0,pickingActive:1,pickingAttribute:!1,lightSources:{}}}}var J=n(26820);class Y extends q.A{constructor(t,e){super(t,e),(0,r.A)(this,"maskMap",void 0),(0,r.A)(this,"fbo",void 0);const{mapSize:n=2048}=e;this.maskMap=new y.A(t,{width:n,height:n,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.fbo=new g.A(t,{id:"maskmap",width:n,height:n,attachments:{36064:this.maskMap}})}render(t){const e=this.gl,n=[!1,!1,!1,!1];return n[t.channel]=!0,(0,m.zv)(e,{clearColor:[255,255,255,255],blend:!0,blendFunc:[0,1],blendEquation:32778,colorMask:n,depthTest:!1},(()=>super.render({...t,target:this.fbo,pass:"mask"})))}shouldDrawLayer(t){return t.props.operation.includes("mask")}delete(){this.fbo.delete(),this.maskMap.delete()}}var X=n(82125),K=n(1279);function Z(t,e){const n=[1/0,1/0,-1/0,-1/0];for(const r of t){const t=r.getBounds();if(t){const i=r.projectPosition(t[0],{viewport:e,autoOffset:!1}),o=r.projectPosition(t[1],{viewport:e,autoOffset:!1});n[0]=Math.min(n[0],i[0]),n[1]=Math.min(n[1],i[1]),n[2]=Math.max(n[2],o[0]),n[3]=Math.max(n[3],o[1])}}return Number.isFinite(n[0])?n:null}function Q(t){const{bounds:e,viewport:n,border:r=0}=t,{isGeospatial:i}=n;if(e[2]<=e[0]||e[3]<=e[1])return null;const o=n.unprojectPosition([(e[0]+e[2])/2,(e[1]+e[3])/2,0]);let{width:s,height:a,zoom:l}=t;if(void 0===l){s-=2*r,a-=2*r;const t=Math.min(s/(e[2]-e[0]),a/(e[3]-e[1]));l=Math.min(Math.log2(t),20)}else if(!s||!a){const t=2**l;s=Math.round(Math.abs(e[2]-e[0])*t),a=Math.round(Math.abs(e[3]-e[1])*t);const n=2048-2*r;if(s>n||a>n){const t=n/Math.max(s,a);s=Math.round(s*t),a=Math.round(a*t),l+=Math.log2(t)}}return i?new X.A({id:n.id,x:r,y:r,width:s,height:a,longitude:o[0],latitude:o[1],zoom:l,orthographic:!0}):new K.A({id:n.id,x:r,y:r,width:s,height:a,target:o,zoom:l,flipY:!1})}function $(t,e,n){if(!t)return[0,0,1,1];const r=function(t,e){let n;if(e&&2===e.length){const[r,i]=e,o=t.getBounds({z:r}),s=t.getBounds({z:i});n=[Math.min(o[0],s[0]),Math.min(o[1],s[1]),Math.max(o[2],s[2]),Math.max(o[3],s[3])]}else n=t.getBounds();const r=t.projectPosition(n.slice(0,2)),i=t.projectPosition(n.slice(2,4));return[r[0],r[1],i[0],i[1]]}(e,n),i=function(t){const e=t[2]-t[0],n=t[3]-t[1],r=(t[0]+t[2])/2,i=(t[1]+t[3])/2;return[r-e,i-n,r+e,i+n]}(r);return t[2]-t[0]<=i[2]-i[0]&&t[3]-t[1]<=i[3]-i[1]?t:[Math.max(t[0],i[0]),Math.max(t[1],i[1]),Math.min(t[2],i[2]),Math.min(t[3],i[3])]}class tt{constructor(){(0,r.A)(this,"id","mask-effect"),(0,r.A)(this,"props",null),(0,r.A)(this,"useInPicking",!0),(0,r.A)(this,"order",0),(0,r.A)(this,"dummyMaskMap",void 0),(0,r.A)(this,"channels",[]),(0,r.A)(this,"masks",null),(0,r.A)(this,"maskPass",void 0),(0,r.A)(this,"maskMap",void 0),(0,r.A)(this,"lastViewport",void 0)}preRender(t,{layers:e,layerFilter:n,viewports:r,onViewportActive:i,views:o,isPicking:s}){let a=!1;if(this.dummyMaskMap||(this.dummyMaskMap=new y.A(t,{width:1,height:1})),s)return{didRender:a};const l=e.filter((t=>t.props.visible&&t.props.operation.includes("mask")));if(0===l.length)return this.masks=null,this.channels.length=0,{didRender:a};this.masks={},this.maskPass||(this.maskPass=new Y(t,{id:"default-mask"}),this.maskMap=this.maskPass.maskMap);const u=this._sortMaskChannels(l),c=r[0],h=!this.lastViewport||!this.lastViewport.equals(c);if(void 0!==c.resolution)return J.A.warn("MaskExtension is not supported in GlobeView")(),{didRender:a};for(const t in u){const e=this._renderChannel(u[t],{layerFilter:n,onViewportActive:i,views:o,viewport:c,viewportChanged:h});a||(a=e)}return{didRender:a}}_renderChannel(t,{layerFilter:e,onViewportActive:n,views:r,viewport:i,viewportChanged:o}){let s=!1;const a=this.channels[t.index];if(!a)return s;const l=t===a||t.layers.length!==a.layers.length||t.layers.some(((t,e)=>t!==a.layers[e]||t.props.transitions))||t.layerBounds.some(((t,e)=>t!==a.layerBounds[e]));if(t.bounds=a.bounds,t.maskBounds=a.maskBounds,this.channels[t.index]=t,l||o){this.lastViewport=i;const o=Z(t.layers,i);if(t.bounds=o&&$(o,i),l||!(0,V.aI)(t.bounds,a.bounds)){const{maskPass:a,maskMap:l}=this,u=o&&Q({bounds:t.bounds,viewport:i,width:l.width,height:l.height,border:1});t.maskBounds=u?u.getBounds():[0,0,1,1],a.render({pass:"mask",channel:t.index,layers:t.layers,layerFilter:e,viewports:u?[u]:[],onViewportActive:n,views:r,moduleParameters:{devicePixelRatio:1}}),s=!0}}return this.masks[t.id]={index:t.index,bounds:t.maskBounds,coordinateOrigin:t.coordinateOrigin,coordinateSystem:t.coordinateSystem},s}_sortMaskChannels(t){const e={};let n=0;for(const r of t){const{id:t}=r.root;let i=e[t];if(!i){if(++n>4){J.A.warn("Too many mask layers. The max supported is 4")();continue}i={id:t,index:this.channels.findIndex((e=>(null==e?void 0:e.id)===t)),layers:[],layerBounds:[],coordinateOrigin:r.root.props.coordinateOrigin,coordinateSystem:r.root.props.coordinateSystem},e[t]=i}i.layers.push(r),i.layerBounds.push(r.getBounds())}for(let t=0;t<4;t++){const n=this.channels[t];n&&n.id in e||(this.channels[t]=null)}for(const t in e){const n=e[t];n.index<0&&(n.index=this.channels.findIndex((t=>!t)),this.channels[n.index]=n)}return e}getModuleParameters(){return{maskMap:this.masks?this.maskMap:this.dummyMaskMap,maskChannels:this.masks}}cleanup(){this.dummyMaskMap&&(this.dummyMaskMap.delete(),this.dummyMaskMap=void 0),this.maskPass&&(this.maskPass.delete(),this.maskPass=void 0,this.maskMap=void 0),this.lastViewport=void 0,this.masks=null,this.channels.length=0}}class et{constructor(){(0,r.A)(this,"id","collision-filter-effect"),(0,r.A)(this,"props",null),(0,r.A)(this,"useInPicking",!0),(0,r.A)(this,"order",1),(0,r.A)(this,"channels",{}),(0,r.A)(this,"collisionFilterPass",void 0),(0,r.A)(this,"collisionFBOs",{}),(0,r.A)(this,"dummyCollisionMap",void 0),(0,r.A)(this,"lastViewport",void 0)}preRender(t,{effects:e,layers:n,layerFilter:r,viewports:i,onViewportActive:o,views:s,isPicking:a,preRenderStats:l={}}){var u;if(this.dummyCollisionMap||(this.dummyCollisionMap=new y.A(t,{width:1,height:1})),a)return;const c=n.filter((({props:{visible:t,collisionEnabled:e}})=>t&&e));if(0===c.length)return void(this.channels={});this.collisionFilterPass||(this.collisionFilterPass=new W(t,{id:"default-collision-filter"}));const h=null==e?void 0:e.filter((t=>t.constructor===tt)),d=null===(u=l["mask-effect"])||void 0===u?void 0:u.didRender,f=this._groupByCollisionGroup(t,c),p=i[0],g=!this.lastViewport||!this.lastViewport.equals(p)||d;for(const e in f){const n=this.collisionFBOs[e],i=f[e];n.resize({width:t.canvas.width/2,height:t.canvas.height/2}),this._render(i,{effects:h,layerFilter:r,onViewportActive:o,views:s,viewport:p,viewportChanged:g})}}_render(t,{effects:e,layerFilter:n,onViewportActive:r,views:i,viewport:o,viewportChanged:s}){const{collisionGroup:a}=t,l=this.channels[a];if(!l)return;const u=s||t===l||!(0,H.b)(l.layers,t.layers,1)||t.layerBounds.some(((t,e)=>!(0,V.aI)(t,l.layerBounds[e])))||t.allLayersLoaded!==l.allLayersLoaded||t.layers.some((t=>t.props.transitions));if(this.channels[a]=t,u){this.lastViewport=o;const s=this.collisionFBOs[a];this.collisionFilterPass.renderCollisionMap(s,{pass:"collision-filter",isPicking:!0,layers:t.layers,effects:e,layerFilter:n,viewports:o?[o]:[],onViewportActive:r,views:i,moduleParameters:{dummyCollisionMap:this.dummyCollisionMap,devicePixelRatio:(0,m.o0)(s.gl)/2}})}}_groupByCollisionGroup(t,e){const n={};for(const t of e){const{collisionGroup:e}=t.props;let r=n[e];r||(r={collisionGroup:e,layers:[],layerBounds:[],allLayersLoaded:!0},n[e]=r),r.layers.push(t),r.layerBounds.push(t.getBounds()),t.isLoaded||(r.allLayersLoaded=!1)}for(const e of Object.keys(n))this.collisionFBOs[e]||this.createFBO(t,e),this.channels[e]||(this.channels[e]=n[e]);for(const t of Object.keys(this.collisionFBOs))n[t]||this.destroyFBO(t);return n}getModuleParameters(t){const{collisionGroup:e}=t.props,{collisionFBOs:n,dummyCollisionMap:r}=this;return{collisionFBO:n[e],dummyCollisionMap:r}}cleanup(){this.dummyCollisionMap&&(this.dummyCollisionMap.delete(),this.dummyCollisionMap=void 0),this.channels={};for(const t of Object.keys(this.collisionFBOs))this.destroyFBO(t);this.collisionFBOs={},this.lastViewport=void 0}createFBO(t,e){const{width:n,height:r}=t.canvas,i=new y.A(t,{width:n,height:r,parameters:{10241:9728,10240:9728,10242:33071,10243:33071}}),o=new z.A(t,{format:33189,width:n,height:r});this.collisionFBOs[e]=new g.A(t,{id:"Collision-".concat(e),width:n,height:r,attachments:{36064:i,36096:o}})}destroyFBO(t){const e=this.collisionFBOs[t];for(const t of Object.values(e.attachments))t.delete();e.delete(),delete this.collisionFBOs[t]}}class nt extends i.A{getShaders(){return{modules:[U]}}draw({uniforms:t,context:e,moduleParameters:n}){const{collisionEnabled:r}=this.props,{collisionFBO:i,drawToCollisionMap:o}=n,s=r&&Boolean(i);t.collision_enabled=s,o&&(this.props=this.clone(this.props.collisionTestProps).props)}initializeState(t,e){var n;null!==this.getAttributeManager()&&(null===(n=this.context.deck)||void 0===n||n._addDefaultEffect(new et),this.getAttributeManager().add({collisionPriorities:{size:1,accessor:"getCollisionPriority",shaderAttributes:{collisionPriorities:{divisor:0},instanceCollisionPriorities:{divisor:1}}}}))}getNeedsPickingBuffer(){return this.props.collisionEnabled}}(0,r.A)(nt,"defaultProps",{getCollisionPriority:{type:"accessor",value:0},collisionEnabled:!0,collisionGroup:{type:"string",value:"default"},collisionTestProps:{}}),(0,r.A)(nt,"extensionName","CollisionFilterExtension");const rt={name:"mask",dependencies:[o.A],vs:"\nuniform vec4 mask_bounds;\nuniform bool mask_maskByInstance;\nvec2 mask_getCoords(vec4 position) {\n  return (position.xy - mask_bounds.xy) / (mask_bounds.zw - mask_bounds.xy);\n}\n",fs:"\nuniform sampler2D mask_texture;\nuniform int mask_channel;\nuniform bool mask_enabled;\nuniform bool mask_inverted;\nbool mask_isInBounds(vec2 texCoords) {\n  if (!mask_enabled) {\n    return true;\n  }\n  vec4 maskColor = texture2D(mask_texture, texCoords);\n  float maskValue = 1.0;\n  if (mask_channel == 0) {\n    maskValue = maskColor.r;\n  } else if (mask_channel == 1) {\n    maskValue = maskColor.g;\n  } else if (mask_channel == 2) {\n    maskValue = maskColor.b;\n  } else if (mask_channel == 3) {\n    maskValue = maskColor.a;\n  }\n\n  if (mask_inverted) {\n    return maskValue >= 0.5;\n  } else {\n    return maskValue < 0.5;\n  }\n}\n",inject:{"vs:#decl":"\nvarying vec2 mask_texCoords;\n","vs:#main-end":"\n   vec4 mask_common_position;\n   if (mask_maskByInstance) {\n     mask_common_position = project_position(vec4(geometry.worldPosition, 1.0));\n   } else {\n     mask_common_position = geometry.position;\n   }\n   mask_texCoords = mask_getCoords(mask_common_position);\n","fs:#decl":"\nvarying vec2 mask_texCoords;\n","fs:#main-start":"\n  if (mask_enabled) {\n    bool mask = mask_isInBounds(mask_texCoords);\n\n    // Debug: show extent of render target\n    // gl_FragColor = vec4(mask_texCoords, 0.0, 1.0);\n    gl_FragColor = texture2D(mask_texture, mask_texCoords);\n\n    if (!mask) discard;\n  }\n"},getUniforms:t=>t&&"maskMap"in t?{mask_texture:t.maskMap}:{}};class it extends i.A{initializeState(){var t;null===(t=this.context.deck)||void 0===t||t._addDefaultEffect(new tt)}getShaders(){let t="instancePositions"in this.getAttributeManager().attributes;return void 0!==this.props.maskByInstance&&(t=Boolean(this.props.maskByInstance)),this.state.maskByInstance=t,{modules:[rt]}}draw({uniforms:t,context:e,moduleParameters:n}){t.mask_maskByInstance=this.state.maskByInstance;const{maskId:r,maskInverted:i}=this.props,{maskChannels:o}=n,{viewport:s}=e;if(o&&o[r]){const{index:e,bounds:n,coordinateOrigin:a}=o[r];let{coordinateSystem:l}=o[r];t.mask_enabled=!0,t.mask_channel=e,t.mask_inverted=i,l===C.rf.DEFAULT&&(l=s.isGeospatial?C.rf.LNGLAT:C.rf.CARTESIAN);const u={modelMatrix:null,fromCoordinateOrigin:a,fromCoordinateSystem:l},c=this.projectPosition([n[0],n[1],0],u),h=this.projectPosition([n[2],n[3],0],u);t.mask_bounds=[c[0],c[1],h[0],h[1]]}else r&&J.A.warn("Could not find a mask layer with id: ".concat(r))(),t.mask_enabled=!1}}(0,r.A)(it,"defaultProps",{maskId:"",maskByInstance:void 0,maskInverted:!1}),(0,r.A)(it,"extensionName","MaskExtension");var ot=n(57877);const st={NONE:0,WRITE_HEIGHT_MAP:1,USE_HEIGHT_MAP:2,USE_COVER:3,USE_COVER_ONLY:4,SKIP:5},at=Object.keys(st).map((t=>"const float TERRAIN_MODE_".concat(t," = ").concat(st[t],".0;"))).join("\n"),lt={name:"terrain",dependencies:[o.A],inject:{"vs:#decl":"\nuniform float terrain_mode;\nuniform sampler2D terrain_map;\nuniform vec4 terrain_bounds;\nvarying vec3 commonPos;\n".concat(at,"\n    "),"vs:#main-start":"\nif (terrain_mode == TERRAIN_MODE_SKIP) {\n  gl_Position = vec4(0.0);\n  return;\n}\n","vs:DECKGL_FILTER_GL_POSITION":"\ncommonPos = geometry.position.xyz;\nif (terrain_mode == TERRAIN_MODE_WRITE_HEIGHT_MAP) {\n  vec2 texCoords = (commonPos.xy - terrain_bounds.xy) / terrain_bounds.zw;\n  position = vec4(texCoords * 2.0 - 1.0, 0.0, 1.0);\n  commonPos.z += project_uCommonOrigin.z;\n}\nif (terrain_mode == TERRAIN_MODE_USE_HEIGHT_MAP) {\n  vec3 anchor = geometry.worldPosition;\n  anchor.z = 0.0;\n  vec3 anchorCommon = project_position(anchor);\n  vec2 texCoords = (anchorCommon.xy - terrain_bounds.xy) / terrain_bounds.zw;\n  if (texCoords.x >= 0.0 && texCoords.y >= 0.0 && texCoords.x <= 1.0 && texCoords.y <= 1.0) {\n    float terrainZ = texture2D(terrain_map, texCoords).r;\n    geometry.position.z += terrainZ;\n    position = project_common_position_to_clipspace(geometry.position);\n  }\n}\n    ","fs:#decl":"\nuniform float terrain_mode;\nuniform sampler2D terrain_map;\nuniform vec4 terrain_bounds;\nvarying vec3 commonPos;\n".concat(at,"\n    "),"fs:#main-start":"\nif (terrain_mode == TERRAIN_MODE_WRITE_HEIGHT_MAP) {\n  gl_FragColor = vec4(commonPos.z, 0.0, 0.0, 1.0);\n  return;\n}\n    ","fs:DECKGL_FILTER_COLOR":"\nif ((terrain_mode == TERRAIN_MODE_USE_COVER) || (terrain_mode == TERRAIN_MODE_USE_COVER_ONLY)) {\n  vec2 texCoords = (commonPos.xy - terrain_bounds.xy) / terrain_bounds.zw;\n  vec4 pixel = texture2D(terrain_map, texCoords);\n  if (terrain_mode == TERRAIN_MODE_USE_COVER_ONLY) {\n    color = pixel;\n  } else {\n    // pixel is premultiplied\n    color = pixel + color * (1.0 - pixel.a);\n  }\n  return;\n}\n    "},getUniforms:(t={},e)=>{if("dummyHeightMap"in t){const{drawToTerrainHeightMap:n,heightMap:r,heightMapBounds:i,dummyHeightMap:o,terrainCover:s,useTerrainHeightMap:a,terrainSkipRender:l}=t,{project_uCommonOrigin:u}=e;let c=l?st.SKIP:st.NONE,h=o,d=null;if(n)c=st.WRITE_HEIGHT_MAP,d=i;else if(a&&r)c=st.USE_HEIGHT_MAP,h=r,d=i;else if(s){const e=t.pickingActive;h=e?s.getPickingFramebuffer():s.getRenderFramebuffer(),e&&(c=st.SKIP),h?(c=c===st.SKIP?st.USE_COVER_ONLY:st.USE_COVER,d=s.bounds):h=o}return{terrain_mode:c,terrain_map:h,terrain_bounds:d?[d[0]-u[0],d[1]-u[1],d[2]-d[0],d[3]-d[1]]:[0,0,0,0]}}return null}};function ut(t,e){return new g.A(t,{id:e.id,attachments:{36064:new y.A(t,{...e.float&&{format:(0,m.C6)(t)?34836:6408,type:5126},mipmaps:!1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}})}})}class ct{constructor(t){(0,r.A)(this,"isDirty",!0),(0,r.A)(this,"targetLayer",void 0),(0,r.A)(this,"renderViewport",null),(0,r.A)(this,"bounds",null),(0,r.A)(this,"fbo",void 0),(0,r.A)(this,"pickingFbo",void 0),(0,r.A)(this,"layers",[]),(0,r.A)(this,"tile",void 0),(0,r.A)(this,"targetBounds",null),(0,r.A)(this,"targetBoundsCommon",null),this.targetLayer=t,this.tile=ht(t)}get id(){return this.targetLayer.id}get isActive(){return Boolean(this.targetLayer.getCurrentLayer())}shouldUpdate({targetLayer:t,viewport:e,layers:n,layerNeedsRedraw:r}){t&&(this.targetLayer=t);const i=!!e&&this._updateViewport(e);let o=!!n&&this._updateLayers(n);if(r)for(const t of this.layers)if(r[t]){o=!0;break}return o||i}_updateLayers(t){let e=!1;if((t=this.tile?function(t,e){return e.filter((e=>{const n=ht(e);return!n||(r=t.boundingBox,i=n.boundingBox,!(!r||!i)&&r[0][0]<i[1][0]&&i[0][0]<r[1][0]&&r[0][1]<i[1][1]&&i[0][1]<r[1][1]);var r,i}))}(this.tile,t):t).length!==this.layers.length)e=!0;else for(let n=0;n<t.length;n++)if(t[n].id!==this.layers[n]){e=!0;break}return e&&(this.layers=t.map((t=>t.id))),e}_updateViewport(t){const e=this.targetLayer;let n=!1;if(this.tile&&"boundingBox"in this.tile){if(!this.targetBounds){n=!0,this.targetBounds=this.tile.boundingBox;const e=t.projectPosition(this.targetBounds[0]),r=t.projectPosition(this.targetBounds[1]);this.targetBoundsCommon=[e[0],e[1],r[0],r[1]]}}else this.targetBounds!==e.getBounds()&&(n=!0,this.targetBounds=e.getBounds(),this.targetBoundsCommon=Z([e],t));if(!this.targetBoundsCommon)return!1;const r=Math.ceil(t.zoom+.5);if(this.tile)this.bounds=this.targetBoundsCommon;else{var i;const e=null===(i=this.renderViewport)||void 0===i?void 0:i.zoom;n=n||r!==e;const o=$(this.targetBoundsCommon,t),s=this.bounds;n=n||!s||o.some(((t,e)=>t!==s[e])),this.bounds=o}return n&&(this.renderViewport=Q({bounds:this.bounds,zoom:r,viewport:t})),n}getRenderFramebuffer(){return this.renderViewport&&0!==this.layers.length?(this.fbo||(this.fbo=ut(this.targetLayer.context.gl,{id:this.id})),this.fbo):null}getPickingFramebuffer(){return!this.renderViewport||0===this.layers.length&&!this.targetLayer.props.pickable?null:(this.pickingFbo||(this.pickingFbo=ut(this.targetLayer.context.gl,{id:"".concat(this.id,"-picking")})),this.pickingFbo)}filterLayers(t){return t.filter((({id:t})=>this.layers.includes(t)))}delete(){const{fbo:t,pickingFbo:e}=this;t&&(t.texture.delete(),t.delete()),e&&(e.texture.delete(),e.delete())}}function ht(t){for(;t;){const{tile:e}=t.props;if(e)return e;t=t.parent}return null}class dt extends q.A{getRenderableLayers(t,e){const{layers:n}=e,r=[],i=this._getDrawLayerParams(t,e,!0);for(let t=0;t<n.length;t++){const e=n[t];!e.isComposite&&i[t].shouldDrawLayer&&r.push(e)}return r}renderHeightMap(t,e){const n=t.getRenderFramebuffer(),r=t.renderViewport;n&&r&&(n.resize(r),(0,m.zv)(this.gl,{clearColor:[0,0,0,0],blend:!0,blendFunc:[1,1],blendEquation:32776,depthTest:!1},(()=>this.render({...e,target:n,pass:"terrain-height-map",layers:e.layers,viewports:[r],effects:[]}))))}renderTerrainCover(t,e){const n=t.getRenderFramebuffer(),r=t.renderViewport;if(!n||!r)return;const i=t.filterLayers(e.layers);n.resize(r),(0,m.zv)(this.gl,{clearColor:[0,0,0,0],depthTest:!1},(()=>this.render({...e,target:n,pass:"terrain-cover-".concat(t.id),layers:i,effects:[],viewports:[r]})))}}var ft=n(64766);class pt extends ft.A{constructor(...t){super(...t),(0,r.A)(this,"drawParameters",{})}getRenderableLayers(t,e){const{layers:n}=e,r=[];this.drawParameters={},this._resetColorEncoder(e.pickZ);const i=this._getDrawLayerParams(t,e);for(let t=0;t<n.length;t++){const e=n[t];!e.isComposite&&i[t].shouldDrawLayer&&(r.push(e),this.drawParameters[e.id]=i[t].layerParameters)}return r}renderTerrainCover(t,e){const n=t.getPickingFramebuffer(),r=t.renderViewport;if(!n||!r)return;const i=t.filterLayers(e.layers),o=t.targetLayer;o.props.pickable&&i.unshift(o),n.resize(r),(0,m.zv)(this.gl,{depthTest:!1},(()=>this.render({...e,pickingFBO:n,pass:"terrain-cover-picking-".concat(t.id),layers:i,effects:[],viewports:[r],cullRect:void 0,deviceRect:r,pickZ:!1})))}getLayerParameters(t,e,n){if(this.drawParameters[t.id])return this.drawParameters[t.id];const r=super.getLayerParameters(t,e,n);return r.blend=!0,r}}class gt{static isSupported(t){return g.A.isSupported(t,{colorBufferFloat:!0})}constructor(t){(0,r.A)(this,"renderViewport",null),(0,r.A)(this,"bounds",null),(0,r.A)(this,"fbo",void 0),(0,r.A)(this,"gl",void 0),(0,r.A)(this,"layers",[]),(0,r.A)(this,"layersBounds",[]),(0,r.A)(this,"layersBoundsCommon",null),(0,r.A)(this,"lastViewport",null),this.gl=t}getRenderFramebuffer(){return this.renderViewport?(this.fbo||(this.fbo=ut(this.gl,{id:"height-map",float:!0})),this.fbo):null}shouldUpdate({layers:t,viewport:e}){const n=t.length!==this.layers.length||t.some(((t,e)=>t!==this.layers[e]||t.props.transitions||t.getBounds()!==this.layersBounds[e]));n&&(this.layers=t,this.layersBounds=t.map((t=>t.getBounds())),this.layersBoundsCommon=Z(t,e));const r=!this.lastViewport||!e.equals(this.lastViewport);if(this.layersBoundsCommon){if(n||r){const t=$(this.layersBoundsCommon,e);if(t[2]<=t[0]||t[3]<=t[1])return this.renderViewport=null,!1;this.bounds=t,this.lastViewport=e;const n=e.scale,r=(t[2]-t[0])*n,i=(t[3]-t[1])*n;return this.renderViewport=r>0||i>0?Q({bounds:[e.center[0]-1,e.center[1]-1,e.center[0]+1,e.center[1]+1],zoom:e.zoom,width:Math.min(r,2048),height:Math.min(i,2048),viewport:e}):null,!0}}else this.renderViewport=null;return!1}delete(){this.fbo&&(this.fbo.color.delete(),this.fbo.delete())}}class yt{constructor(){(0,r.A)(this,"id","terrain-effect"),(0,r.A)(this,"props",null),(0,r.A)(this,"useInPicking",!0),(0,r.A)(this,"isPicking",!1),(0,r.A)(this,"isDrapingEnabled",!1),(0,r.A)(this,"dummyHeightMap",void 0),(0,r.A)(this,"heightMap",void 0),(0,r.A)(this,"terrainPass",void 0),(0,r.A)(this,"terrainPickingPass",void 0),(0,r.A)(this,"terrainCovers",new Map)}initialize(t){this.dummyHeightMap=new y.A(t,{width:1,height:1,data:new Uint8Array([0,0,0,0])}),this.terrainPass=new dt(t,{id:"terrain"}),this.terrainPickingPass=new pt(t,{id:"terrain-picking"}),gt.isSupported(t)?this.heightMap=new gt(t):J.A.warn("Terrain offset mode is not supported by this browser")(),ot.A.getDefaultProgramManager(t).addDefaultModule(lt)}preRender(t,e){if(!this.dummyHeightMap){this.initialize(t);for(const t of e.layers)t.props.operation.includes("terrain")&&t.setChangeFlags({extensionsChanged:!0})}if(e.pickZ)return void(this.isDrapingEnabled=!1);const{viewports:n}=e,r=e.pass.startsWith("picking");this.isPicking=r,this.isDrapingEnabled=!0;const i=n[0],o=(r?this.terrainPickingPass:this.terrainPass).getRenderableLayers(i,e),s=o.filter((t=>t.props.operation.includes("terrain")));if(0===s.length)return;r||o.filter((t=>"offset"===t.state.terrainDrawMode)).length>0&&this._updateHeightMap(s,i,e);const a=o.filter((t=>"drape"===t.state.terrainDrawMode));this._updateTerrainCovers(s,a,i,e)}getModuleParameters(t){var e,n;const{terrainDrawMode:r}=t.state;return{heightMap:null===(e=this.heightMap)||void 0===e?void 0:e.getRenderFramebuffer(),heightMapBounds:null===(n=this.heightMap)||void 0===n?void 0:n.bounds,dummyHeightMap:this.dummyHeightMap,terrainCover:this.isDrapingEnabled?this.terrainCovers.get(t.id):null,useTerrainHeightMap:"offset"===r,terrainSkipRender:"drape"===r||!t.props.operation.includes("draw")}}cleanup(){this.dummyHeightMap&&(this.dummyHeightMap.delete(),this.dummyHeightMap=void 0),this.heightMap&&(this.heightMap.delete(),this.heightMap=void 0);for(const t of this.terrainCovers.values())t.delete();this.terrainCovers.clear()}_updateHeightMap(t,e,n){this.heightMap&&this.heightMap.shouldUpdate({layers:t,viewport:e})&&this.terrainPass.renderHeightMap(this.heightMap,{...n,layers:t,moduleParameters:{heightMapBounds:this.heightMap.bounds,dummyHeightMap:this.dummyHeightMap,devicePixelRatio:1,drawToTerrainHeightMap:!0}})}_updateTerrainCovers(t,e,n,r){const i={};for(const t of e)t.state.terrainCoverNeedsRedraw&&(i[t.id]=!0,t.state.terrainCoverNeedsRedraw=!1);for(const t of this.terrainCovers.values())t.isDirty=t.isDirty||t.shouldUpdate({layerNeedsRedraw:i});for(const i of t)this._updateTerrainCover(i,e,n,r);this.isPicking||this._pruneTerrainCovers()}_updateTerrainCover(t,e,n,r){const i=this.isPicking?this.terrainPickingPass:this.terrainPass;let o=this.terrainCovers.get(t.id);o||(o=new ct(t),this.terrainCovers.set(t.id,o));try{const s=o.shouldUpdate({targetLayer:t,viewport:n,layers:e});(this.isPicking||o.isDirty||s)&&(i.renderTerrainCover(o,{...r,layers:e,moduleParameters:{dummyHeightMap:this.dummyHeightMap,terrainSkipRender:!1,devicePixelRatio:1}}),this.isPicking||(o.isDirty=!1))}catch(e){t.raiseError(e,"Error rendering terrain cover ".concat(o.id))}}_pruneTerrainCovers(){const t=[];for(const[e,n]of this.terrainCovers)n.isActive||t.push(e);for(const e of t)this.terrainCovers.delete(e)}}class mt extends i.A{getShaders(){return{modules:[lt]}}initializeState(){var t;null===(t=this.context.deck)||void 0===t||t._addDefaultEffect(new yt)}updateState(t){const{props:e,oldProps:n}=t;if(this.state.terrainDrawMode&&e.terrainDrawMode===n.terrainDrawMode&&e.extruded===n.extruded)return;let{terrainDrawMode:r}=e;if(!r){var i;const t=this.props.extruded,e=null===(i=this.getAttributeManager())||void 0===i?void 0:i.attributes;r=t||e&&"instancePositions"in e?"offset":"drape"}this.setState({terrainDrawMode:r})}onNeedsRedraw(){const t=this.state;"drape"===t.terrainDrawMode&&(t.terrainCoverNeedsRedraw=!0)}}(0,r.A)(mt,"defaultProps",{terrainDrawMode:void 0}),(0,r.A)(mt,"extensionName","TerrainExtension")},64949:(t,e,n)=>{"use strict";n.r(e),n.d(e,{GeohashLayer:()=>Zo,GreatCircleLayer:()=>z,H3ClusterLayer:()=>ze,H3HexagonLayer:()=>Ue,MVTLayer:()=>qo,QuadkeyLayer:()=>it,S2Layer:()=>rt,TerrainLayer:()=>Po,Tile3DLayer:()=>wo,TileLayer:()=>Ie,TripsLayer:()=>Be,_GeoCellLayer:()=>q,_Tile2DHeader:()=>ct,_Tileset2D:()=>Me,_WMSLayer:()=>G,_getURLFromTemplate:()=>fe});var r=n(67136),i=n(68411),o=n(75107),s=n(1597),a=n(53313);class l{constructor(t){(0,r.A)(this,"fetch",void 0),(0,r.A)(this,"loadOptions",void 0),(0,r.A)(this,"_needsRefresh",!0),(0,r.A)(this,"props",void 0),this.props={...t},this.loadOptions={...t.loadOptions},this.fetch=function(t){const e=null==t?void 0:t.fetch;if(e&&"function"==typeof e)return(t,n)=>e(t,n);const n=null==t?void 0:t.fetch;return n&&"function"!=typeof n?t=>fetch(t,n):t=>fetch(t)}(this.loadOptions)}setProps(t){this.props=Object.assign(this.props,t),this.setNeedsRefresh()}setNeedsRefresh(){this._needsRefresh=!0}getNeedsRefresh(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const e=this._needsRefresh;return t&&(this._needsRefresh=!1),e}}class u extends l{}var c=n(94557);class h extends u{constructor(t){super(t)}async getMetadata(){throw new Error("ImageSource.getMetadata not implemented")}async getImage(t){const e=this.getGranularParameters(t),n=this.getURLFromTemplate(e),r=await this.fetch(n),i=await r.arrayBuffer();return await c.$.parse(i)}getGranularParameters(t){const[e,n,r,i]=t.bbox;return{...t,east:e,north:n,south:i,west:r}}getURLFromTemplate(t){let e=this.props.url;for(const[n,r]of Object.entries(t))e=e.replace("${".concat(n,"}"),String(r)),e=e.replace("{".concat(n,"}"),String(r));return e}}(0,r.A)(h,"type","template"),(0,r.A)(h,"testURL",(t=>t.toLowerCase().includes("{")));var d=n(86454);function f(t){if(Array.isArray(t))return t.map((t=>f(t)));if(t&&"object"==typeof t){const n={};for(const[r,i]of Object.entries(t))n[(e=r,"string"==typeof e?e.charAt(0).toLowerCase()+e.slice(1):e)]=f(i);return n}var e;return t}const p={name:"XML",id:"xml",module:"xml",version:"3.4.15",worker:!1,extensions:["xml"],mimeTypes:["application/xml","text/xml"],testText:function(t){return t.startsWith("<?xml")},options:{xml:{parser:"fast-xml-parser",uncapitalizeKeys:!1,removeNSPrefix:!1,textNodeName:"value",arrayPaths:[]}},parse:async(t,e)=>g((new TextDecoder).decode(t),e),parseTextSync:(t,e)=>g(t,e)};function g(t,e){var n;const r={...p.options.xml,...null==e?void 0:e.xml};if("fast-xml-parser"===r.parser){const n={allowBooleanAttributes:!0,ignoreDeclaration:!0,removeNSPrefix:r.removeNSPrefix,textNodeName:r.textNodeName,isArray:(t,e,n,i)=>{var o;const s=Boolean(null==r||null===(o=r.arrayPaths)||void 0===o?void 0:o.some((t=>e===t)));return s},...null==e?void 0:e._fastXML},i=function(t,e){return new d.XMLParser({ignoreAttributes:!1,attributeNamePrefix:"",...e}).parse(t)}(t,n);return r.uncapitalizeKeys?f(i):i}throw new Error(null==e||null===(n=e.xml)||void 0===n?void 0:n.parser)}function y(t){return Array.isArray(t)?t:t?[t]:[]}function m(t){const e=y(t);return e.length>0&&e.every((t=>"string"==typeof t))?e:[]}function v(t){switch(typeof t){case"number":return t;case"string":return parseFloat(t);default:return}}function b(t){switch(typeof t){case"number":return t;case"string":return parseInt(t,10);default:return}}function _(t){switch(t){case"true":case"1":return!0;default:return!1}}function A(t,e){const n=p.parseTextSync(t,e),r=n.WMT_MS_Capabilities||n.WMS_Capabilities||n,i=function(t){var e,n,r,i,o,s,a,l,u,c,h,d,f,p,g,v;const _={version:String(t.version||""),name:String((null===(e=t.Service)||void 0===e?void 0:e.Name)||"unnamed"),title:null!==(n=t.Service)&&void 0!==n&&n.Title?String(null===(r=t.Service)||void 0===r?void 0:r.Title):void 0,abstract:null!==(i=t.Service)&&void 0!==i&&i.Abstract?String(null===(o=t.Service)||void 0===o?void 0:o.Abstract):void 0,keywords:m(null===(s=t.Service)||void 0===s||null===(a=s.KeywordList)||void 0===a?void 0:a.Keyword),fees:null!==(l=t.Service)&&void 0!==l&&l.Fees?JSON.stringify(null===(u=t.Service)||void 0===u?void 0:u.Fees):void 0,accessConstraints:null!==(c=t.Service)&&void 0!==c&&c.AccessConstraints?JSON.stringify(null===(h=t.Service)||void 0===h?void 0:h.AccessConstraints):void 0,layerLimit:b(null===(d=t.Service)||void 0===d?void 0:d.LayerLimit),maxWidth:b(null===(f=t.Service)||void 0===f?void 0:f.maxWidth),maxHeight:b(null===(p=t.Service)||void 0===p?void 0:p.maxHeight),layers:[],requests:x(null===(g=t.Capability)||void 0===g?void 0:g.Request),exceptions:w(t.Exception)},A=y(null===(v=t.Capability)||void 0===v?void 0:v.Layer);for(const t of A)_.layers.push(C(t));for(const[t,e]of Object.entries(_))void 0===e&&delete _[t];return _}(r);if(null!=e&&e.inheritedLayerProps)for(const t of i.layers)S(t,null);return(null!=e&&e.includeRawData||null!=e&&e.raw)&&(i.raw=r),null!=e&&e.includeXMLText&&(i.xml=t),i}function x(t){const e={};for(const[n,r]of Object.entries(t||{})){const t=m(null==r?void 0:r.Format);e[n]={mimeTypes:t}}return e}function w(t){if(y(null==t?void 0:t.Format).length>0)return{mimeTypes:m(t)}}function C(t){var e;const n={title:String((null==t?void 0:t.Title)||""),name:(null==t?void 0:t.Name)&&String(null==t?void 0:t.Name),abstract:(null==t?void 0:t.Name)&&String(null==t?void 0:t.Abstract),keywords:m(null===(e=t.KeywordList)||void 0===e?void 0:e.Keyword)},r=(null==t?void 0:t.CRS)||(null==t?void 0:t.SRS);r&&Array.isArray(r)&&r.every((t=>"string"==typeof t))&&(n.crs=r);let i=(null==t?void 0:t.EX_GeographicBoundingBox)&&function(t){const{westBoundLongitude:e,northBoundLatitude:n,eastBoundLongitude:r,southBoundLatitude:i}=t;return[[e,i],[r,n]]}(null==t?void 0:t.EX_GeographicBoundingBox);i&&(n.geographicBoundingBox=i),i=(null==t?void 0:t.LatLonBoundingBox)&&function(t){const{minx:e,miny:n,maxx:r,maxy:i}=t;return[[e,n],[r,i]]}(null==t?void 0:t.LatLonBoundingBox),i&&(n.geographicBoundingBox=i);const o=(null==t?void 0:t.BoundingBox)&&y(null==t?void 0:t.BoundingBox).map((t=>function(t){const{CRS:e,SRS:n,minx:r,miny:i,maxx:o,maxy:s,resx:a,resy:l}=t,u={crs:e||n,boundingBox:[[v(r),v(i)],[v(o),v(s)]]};return a&&(u.xResolution=a),l&&(u.yResolution=l),u}(t)));o&&o.length>0&&(n.boundingBoxes=o);const s=y(null==t?void 0:t.Dimension).map((t=>function(t){const{name:e,units:n,value:r}=t,i={name:e,units:n,extent:r};return t.unitSymbol&&(i.unitSymbol=t.unitSymbol),t.default&&(i.defaultValue=t.default),t.multipleValues&&(i.multipleValues=_(t.multipleValues)),t.nearestValue&&(i.nearestValue=_(t.nearestValue)),t.current&&(i.current=_(t.current)),i}(t)));s.length&&(n.dimensions=s),null!=t&&t.opaque&&(n.opaque=_(null==t?void 0:t.opaque)),null!=t&&t.cascaded&&(n.cascaded=_(null==t?void 0:t.cascaded)),null!=t&&t.queryable&&(n.queryable=_(null==t?void 0:t.queryable));const a=y(null==t?void 0:t.Layer),l=[];for(const t of a)l.push(C(t));l.length>0&&(n.layers=l);for(const[t,e]of Object.entries(n))void 0===e&&delete n[t];return n}function S(t,e){null!=e&&e.geographicBoundingBox&&!t.geographicBoundingBox&&(t.geographicBoundingBox=[...e.geographicBoundingBox]),null!=e&&e.crs&&!t.crs&&(t.crs=[...e.crs]),null!=e&&e.boundingBoxes&&!t.boundingBoxes&&(t.boundingBoxes=[...e.boundingBoxes]),null!=e&&e.dimensions&&!t.dimensions&&(t.dimensions=[...e.dimensions]);for(const e of t.layers||[])S(e,t)}const E={id:"wms-capabilities",name:"WMS Capabilities",module:"wms",version:"3.4.15",worker:!1,extensions:["xml"],mimeTypes:["application/vnd.ogc.wms_xml","application/xml","text/xml"],testText:function(t){return t.startsWith("<?xml")},options:{wms:{}},parse:async(t,e)=>A((new TextDecoder).decode(t),null==e?void 0:e.wms),parseTextSync:(t,e)=>A(t,null==e?void 0:e.wms)};function M(t,e){var n;const r=(null===(n=p.parseTextSync(t,e).FeatureInfoResponse)||void 0===n?void 0:n.FIELDS)||[];return{features:(Array.isArray(r)?r:[r]).map((t=>function(t){return{attributes:t||{},type:"",bounds:{bottom:0,top:0,left:0,right:0}}}(t)))}}const P={...E,id:"wms-feature-info",name:"WMS FeatureInfo",parse:async(t,e)=>M((new TextDecoder).decode(t),e),parseTextSync:(t,e)=>M(t,e)};function T(t,e){var n;return null===(n=p.parseTextSync)||void 0===n?void 0:n.call(p,t,e)}const O={...E,id:"wms-layer-description",name:"WMS DescribeLayer",parse:async(t,e)=>T((new TextDecoder).decode(t),e),parseTextSync:(t,e)=>T(t,e)},I={id:"wms-error",name:"WMS Error",module:"wms",version:"3.4.15",worker:!1,extensions:["xml"],mimeTypes:["application/vnd.ogc.se_xml","application/xml","text/xml"],testText:function(t){return t.startsWith("<?xml")},options:{wms:{throwOnError:!1}},parse:async(t,e)=>R((new TextDecoder).decode(t),e),parseSync:(t,e)=>R((new TextDecoder).decode(t),e),parseTextSync:(t,e)=>R(t,e)};function R(t,e){const n={...I.options.wms,...null==e?void 0:e.wms},r=function(t,e){var n,r,i;const o=null===(n=p.parseTextSync)||void 0===n?void 0:n.call(p,t,e),s=(null==o||null===(r=o.ServiceExceptionReport)||void 0===r?void 0:r.ServiceException)||(null==o||null===(i=o["ogc:ServiceExceptionReport"])||void 0===i?void 0:i["ogc:ServiceException"]);return"string"==typeof s?s:s.value||s.code||"Unknown error"}(t,n),i=n.minimalErrors?r:"WMS Service error: ".concat(r);if(n.throwOnError)throw new Error(i);return i}class B extends u{constructor(t){var e;super(t),(0,r.A)(this,"url",void 0),(0,r.A)(this,"substituteCRS84",void 0),(0,r.A)(this,"flipCRS",void 0),(0,r.A)(this,"wmsParameters",void 0),(0,r.A)(this,"vendorParameters",void 0),(0,r.A)(this,"capabilities",null),this.url=t.url,this.substituteCRS84=null!==(e=t.substituteCRS84)&&void 0!==e&&e,this.flipCRS=["EPSG:4326"],this.wmsParameters={layers:void 0,query_layers:void 0,styles:void 0,version:"1.3.0",crs:"EPSG:4326",format:"image/png",info_format:"text/plain",transparent:void 0,time:void 0,elevation:void 0,...t.wmsParameters},this.vendorParameters=t.vendorParameters||{}}async getMetadata(){const t=await this.getCapabilities();return this.normalizeMetadata(t)}async getImage(t){return await this.getMap(t)}normalizeMetadata(t){return t}async getCapabilities(t,e){const n=this.getCapabilitiesURL(t,e),r=await this.fetch(n),i=await r.arrayBuffer();this._checkResponse(r,i);const o=await E.parse(i,this.loadOptions);return this.capabilities=o,o}async getMap(t,e){const n=this.getMapURL(t,e),r=await this.fetch(n),i=await r.arrayBuffer();this._checkResponse(r,i);try{return await c.$.parse(i,this.loadOptions)}catch{throw this._parseError(i)}}async getFeatureInfo(t,e){const n=this.getFeatureInfoURL(t,e),r=await this.fetch(n),i=await r.arrayBuffer();return this._checkResponse(r,i),await P.parse(i,this.loadOptions)}async getFeatureInfoText(t,e){const n=this.getFeatureInfoURL(t,e),r=await this.fetch(n),i=await r.arrayBuffer();return this._checkResponse(r,i),(new TextDecoder).decode(i)}async describeLayer(t,e){const n=this.describeLayerURL(t,e),r=await this.fetch(n),i=await r.arrayBuffer();return this._checkResponse(r,i),await O.parse(i,this.loadOptions)}async getLegendGraphic(t,e){const n=this.getLegendGraphicURL(t,e),r=await this.fetch(n),i=await r.arrayBuffer();this._checkResponse(r,i);try{return await c.$.parse(i,this.loadOptions)}catch{throw this._parseError(i)}}getCapabilitiesURL(t,e){const n={version:this.wmsParameters.version,...t};return this._getWMSUrl("GetCapabilities",n,e)}getMapURL(t,e){t=this._getWMS130Parameters(t);const n={version:this.wmsParameters.version,format:this.wmsParameters.format,transparent:this.wmsParameters.transparent,time:this.wmsParameters.time,elevation:this.wmsParameters.elevation,layers:this.wmsParameters.layers,styles:this.wmsParameters.styles,crs:this.wmsParameters.crs,...t};return this._getWMSUrl("GetMap",n,e)}getFeatureInfoURL(t,e){const n={version:this.wmsParameters.version,info_format:this.wmsParameters.info_format,layers:this.wmsParameters.layers,query_layers:this.wmsParameters.query_layers,styles:this.wmsParameters.styles,crs:this.wmsParameters.crs,...t};return this._getWMSUrl("GetFeatureInfo",n,e)}describeLayerURL(t,e){const n={version:this.wmsParameters.version,...t};return this._getWMSUrl("DescribeLayer",n,e)}getLegendGraphicURL(t,e){const n={version:this.wmsParameters.version,...t};return this._getWMSUrl("GetLegendGraphic",n,e)}_parseWMSUrl(t){const[e,n]=t.split("?"),r=n.split("&"),i={};for(const t of r){const[e,n]=t.split("=");i[e]=n}return{url:e,parameters:i}}_getWMSUrl(t,e,n){let r=this.url,i=!0;const o={service:"WMS",version:e.version,request:t,...e,...this.vendorParameters,...n},s=["transparent","time","elevation"];for(const[t,n]of Object.entries(o))s.includes(t)&&!n||(r+=i?"?":"&",i=!1,r+=this._getURLParameter(t,n,e));return encodeURI(r)}_getWMS130Parameters(t){const e={...t};return e.srs&&(e.crs=e.crs||e.srs,delete e.srs),e}_getURLParameter(t,e,n){switch(t){case"crs":"1.3.0"!==n.version?t="srs":this.substituteCRS84&&"EPSG:4326"===e&&(e="CRS:84");break;case"srs":"1.3.0"===n.version&&(t="crs");break;case"bbox":const r=this._flipBoundingBox(e,n);r&&(e=r)}return t=t.toUpperCase(),Array.isArray(e)?"".concat(t,"=").concat(e.join(",")):"".concat(t,"=").concat(e?String(e):"")}_flipBoundingBox(t,e){if(!Array.isArray(t)||4!==t.length)return null;const n=t;return"1.3.0"!==e.version||!this.flipCRS.includes(e.crs||"")||this.substituteCRS84&&"EPSG:4326"===e.crs?n:[n[1],n[0],n[3],n[2]]}async _fetchArrayBuffer(t){const e=await this.fetch(t),n=await e.arrayBuffer();return this._checkResponse(e,n),n}_checkResponse(t,e){const n=t.headers["content-type"];if(!t.ok||I.mimeTypes.includes(n)){const t=function(t,e){const n={...t};for(const[t,r]of Object.entries(e))r&&"object"==typeof r?(n[t]=n[t]||{},Object.assign(n[t],e[t])):n[t]=e[t];return n}(this.loadOptions,{wms:{throwOnError:!0}}),n=I.parseSync(e,t);throw new Error(n)}}_parseError(t){const e=I.parseSync(t,this.loadOptions);return new Error(e)}}(0,r.A)(B,"type","wms"),(0,r.A)(B,"testURL",(t=>t.toLowerCase().includes("wms")));class L extends u{constructor(t){super(t)}async getMetadata(){return await this.metadata()}async getImage(t){throw new Error("not implemented")}async metadata(){throw new Error("not implemented")}exportImage(t){throw new Error("not implemented")}metadataURL(t){return"".concat(this.props.url,"?f=pjson")}exportImageURL(t){const e="bbox=".concat(t.bbox[0],",").concat(t.bbox[1],",").concat(t.bbox[2],",").concat(t.bbox[3]),n="size=".concat(t.width,",").concat(t.height),r={...t,bbox:e,size:n};return delete r.width,delete r.height,this.getUrl("exportImage",r)}getUrl(t,e,n){let r="".concat(this.props.url,"/").concat(t),i=!0;for(const[t,n]of Object.entries(e))r+=i?"?":"&",i=!1,Array.isArray(n)?r+="".concat(t.toUpperCase(),"=").concat(n.join(",")):r+="".concat(t.toUpperCase(),"=").concat(n?String(n):"");return r}async checkResponse(t){if(!t.ok)throw new Error("error")}}(0,r.A)(L,"type","arcgis-image-server"),(0,r.A)(L,"testURL",(t=>t.toLowerCase().includes("ImageServer")));const k=[B,L,h];var D=n(649);const F=6378137*Math.PI;function N(t){const e=(0,D.lngLatToWorld)(t);return e[0]=(e[0]/256-1)*F,e[1]=(e[1]/256-1)*F,e}const j={id:"imagery-layer",data:"",serviceType:"auto",srs:"auto",layers:{type:"array",compare:!0,value:[]},onMetadataLoad:{type:"function",value:()=>{}},onMetadataLoadError:{type:"function",value:console.error},onImageLoadStart:{type:"function",value:()=>{}},onImageLoad:{type:"function",value:()=>{}},onImageLoadError:{type:"function",compare:!1,value:(t,e)=>console.error(e,t)}};class G extends i.A{constructor(...t){super(...t),(0,r.A)(this,"state",void 0)}get isLoaded(){var t;return 0===(null===(t=this.state)||void 0===t?void 0:t.loadCounter)&&super.isLoaded}shouldUpdateState(){return!0}initializeState(){this.state._nextRequestId=0,this.state.lastRequestId=-1,this.state.loadCounter=0}updateState({changeFlags:t,props:e,oldProps:n}){const{viewport:r}=this.context;t.dataChanged||e.serviceType!==n.serviceType?(this.state.imageSource=this._createImageSource(e),this._loadMetadata(),this.debounce((()=>this.loadImage(r,"image source changed")),0)):(0,o.b)(e.layers,n.layers,1)?t.viewportChanged&&this.debounce((()=>this.loadImage(r,"viewport changed"))):this.debounce((()=>this.loadImage(r,"layers changed")),0)}finalizeState(){}renderLayers(){const{bounds:t,image:e,lastRequestParameters:n}=this.state;return e&&new a.A({...this.getSubLayerProps({id:"bitmap"}),_imageCoordinateSystem:"EPSG:4326"===n.srs?s.rf.LNGLAT:s.rf.CARTESIAN,bounds:t,image:e})}async getFeatureInfoText(t,e){const{lastRequestParameters:n}=this.state;var r,i;return n?await(null===(r=(i=this.state.imageSource).getFeatureInfoText)||void 0===r?void 0:r.call(i,{...n,query_layers:n.layers,x:t,y:e,info_format:"application/vnd.ogc.gml"})):""}_createImageSource(t){if(t.data instanceof u)return t.data;if("string"==typeof t.data)return function(t){const{type:e="auto"}=t;switch("auto"===e?function(t){for(const e of k)if(e.testURL&&e.testURL(t))return e.type;return"wms"}(t.url):e){case"template":return new h(t);case"wms":return new B(t);default:throw new Error("Not a valid image source type")}}({url:t.data,loadOptions:t.loadOptions,type:t.serviceType});throw new Error("invalid image source in props.data")}async _loadMetadata(){const{imageSource:t}=this.state;try{this.state.loadCounter++;const n=await t.getMetadata();var e;this.state.imageSource===t&&(null===(e=this.getCurrentLayer())||void 0===e||e.props.onMetadataLoad(n))}catch(t){var n;null===(n=this.getCurrentLayer())||void 0===n||n.props.onMetadataLoadError(t)}finally{this.state.loadCounter--}}async loadImage(t,e){const{layers:n,serviceType:r}=this.props;if("wms"===r&&0===n.length)return;const i=t.getBounds(),{width:o,height:s}=t,a=this.getRequestId();let{srs:l}=this.props;"auto"===l&&(l=t.resolution?"EPSG:4326":"EPSG:3857");const u={width:o,height:s,bbox:i,layers:n,srs:l};if("EPSG:3857"===l){const[t,e]=N([i[0],i[1]]),[n,r]=N([i[2],i[3]]);u.bbox=[t,e,n,r]}try{this.state.loadCounter++,this.props.onImageLoadStart(a);const t=await this.state.imageSource.getImage(u);var c;this.state.lastRequestId<a&&(null===(c=this.getCurrentLayer())||void 0===c||c.props.onImageLoad(a),this.setState({image:t,bounds:i,lastRequestParameters:u,lastRequestId:a}))}catch(t){var h;this.raiseError(t,"Load image"),null===(h=this.getCurrentLayer())||void 0===h||h.props.onImageLoadError(a,t)}finally{this.state.loadCounter--}}getRequestId(){return this.state._nextRequestId++}debounce(t,e=500){clearTimeout(this.state._timeoutId),this.state._timeoutId=setTimeout((()=>t()),e)}}(0,r.A)(G,"layerName","WMSLayer"),(0,r.A)(G,"defaultProps",j);var U=n(69002);class z extends U.A{}(0,r.A)(z,"layerName","GreatCircleLayer"),(0,r.A)(z,"defaultProps",{getHeight:{type:"accessor",value:0},greatCircle:!0});var V=n(19460);const H={...V.A.defaultProps};class q extends i.A{indexToBounds(){return null}renderLayers(){const{elevationScale:t,extruded:e,wireframe:n,filled:r,stroked:i,lineWidthUnits:o,lineWidthScale:s,lineWidthMinPixels:a,lineWidthMaxPixels:l,lineJointRounded:u,lineMiterLimit:c,lineDashJustified:h,getElevation:d,getFillColor:f,getLineColor:p,getLineWidth:g}=this.props,{updateTriggers:y,material:m,transitions:v}=this.props,b=this.getSubLayerClass("cell",V.A),{updateTriggers:_,...A}=this.indexToBounds()||{};return new b({filled:r,wireframe:n,extruded:e,elevationScale:t,stroked:i,lineWidthUnits:o,lineWidthScale:s,lineWidthMinPixels:a,lineWidthMaxPixels:l,lineJointRounded:u,lineMiterLimit:c,lineDashJustified:h,material:m,transitions:v,getElevation:d,getFillColor:f,getLineColor:p,getLineWidth:g},this.getSubLayerProps({id:"cell",updateTriggers:y&&{..._,getElevation:y.getElevation,getFillColor:y.getFillColor,getLineColor:y.getLineColor,getLineWidth:y.getLineWidth}}),A)}}(0,r.A)(q,"layerName","GeoCellLayer"),(0,r.A)(q,"defaultProps",H);var W=n(60004),J=n.n(W);const Y=3,X=61,K=180/Math.PI;function Z(t,e,n){const r=1<<e;return[(t[0]+n[0])/r,(t[1]+n[1])/r]}function Q(t){return t>=.5?1/3*(4*t*t-1):1/3*(1-4*(1-t)*(1-t))}function $(t,[e,n]){switch(t){case 0:return[1,e,n];case 1:return[-e,1,n];case 2:return[-e,-n,1];case 3:return[-1,-n,-e];case 4:return[n,-1,-e];case 5:return[n,e,-1];default:throw new Error("Invalid face")}}function tt([t,e,n]){const r=Math.atan2(n,Math.sqrt(t*t+e*e));return[Math.atan2(e,t)*K,r*K]}function et(t,e,n,r){if(0===r){1===n&&(e[0]=t-1-e[0],e[1]=t-1-e[1]);const r=e[0];e[0]=e[1],e[1]=r}}function nt(t){const e=function(t){const e=t.split("/"),n=parseInt(e[0],10),r=e[1],i=r.length,o=[0,0];let s;for(let t=i-1;t>=0;t--){s=i-t;const e=r[t];let n=0,a=0;"1"===e?a=1:"2"===e?(n=1,a=1):"3"===e&&(n=1);const l=Math.pow(2,s-1);et(l,o,n,a),o[0]+=l*n,o[1]+=l*a}if(n%2==1){const t=o[0];o[0]=o[1],o[1]=t}return{face:n,ij:o,level:s}}(function(t){if("string"==typeof t){if(t.indexOf("/")>0)return t;t=function(t){const e=t.padEnd(16,"0");return J().fromString(e,16)}(t)}return function(t){let e=J().fromString(t,!0,10).toString(2);for(;e.length<Y+X;)e="0"+e;const n=e.lastIndexOf("1"),r=e.substring(0,3),i=e.substring(3,n),o=i.length/2,s=J().fromString(r,!0,2).toString(10);let a=J().fromString(i,!0,2).toString(4);for(;a.length<o;)a="0"+a;return"".concat(s,"/").concat(a)}(t.toString())}(t));return function({face:t,ij:e,level:n}){const r=[[0,0],[0,1],[1,1],[1,0],[0,0]],i=Math.max(1,Math.ceil(100*Math.pow(2,-n))),o=new Float64Array(4*i*2+2);let s=0,a=0;for(let u=0;u<4;u++){const c=r[u].slice(0),h=r[u+1],d=(h[0]-c[0])/i,f=(h[1]-c[1])/i;for(let r=0;r<i;r++){c[0]+=d,c[1]+=f;const r=tt($(t,[Q((l=Z(e,n,c))[0]),Q(l[1])]));Math.abs(r[1])>89.999&&(r[0]=a);const i=r[0]-a;r[0]+=i>180?-360:i<-180?360:0,o[s++]=r[0],o[s++]=r[1],a=r[0]}}var l;return o[s++]=o[0],o[s++]=o[1],o}(e)}class rt extends q{indexToBounds(){const{data:t,getS2Token:e}=this.props;return{data:t,_normalize:!1,positionFormat:"XY",getPolygon:(t,n)=>nt(e(t,n))}}}(0,r.A)(rt,"layerName","S2Layer"),(0,r.A)(rt,"defaultProps",{getS2Token:{type:"accessor",value:t=>t.token}});class it extends q{indexToBounds(){const{data:t,extruded:e,getQuadkey:n}=this.props,r=e?.99:1;return{data:t,_normalize:!1,positionFormat:"XY",getPolygon:(t,e)=>function(t,e=1){const[n,r]=function(t,e){let n=0,r=0,i=1<<t.length;const o=i/512;for(let e=0;e<t.length;e++){i>>=1;const o=parseInt(t[e]);o%2&&(n|=i),o>1&&(r|=i)}return[[n/o,512-r/o],[(n+e)/o,512-(r+e)/o]]}(t,e),[i,o]=(0,D.worldToLngLat)(n),[s,a]=(0,D.worldToLngLat)(r);return[s,o,s,a,i,a,i,o,s,o]}(n(t,e),r),updateTriggers:{getPolygon:r}}}}(0,r.A)(it,"layerName","QuadkeyLayer"),(0,r.A)(it,"defaultProps",{getQuadkey:{type:"accessor",value:t=>t.quadkey}});var ot=n(93716),st=n(31152),at=n(31726),lt=n(98569),ut=n(54692);class ct{constructor(t){(0,r.A)(this,"index",void 0),(0,r.A)(this,"isVisible",void 0),(0,r.A)(this,"isSelected",void 0),(0,r.A)(this,"parent",void 0),(0,r.A)(this,"children",void 0),(0,r.A)(this,"content",void 0),(0,r.A)(this,"state",void 0),(0,r.A)(this,"layers",void 0),(0,r.A)(this,"id",void 0),(0,r.A)(this,"zoom",void 0),(0,r.A)(this,"userData",void 0),(0,r.A)(this,"boundingBox",void 0),(0,r.A)(this,"_abortController",void 0),(0,r.A)(this,"_loader",void 0),(0,r.A)(this,"_loaderId",void 0),(0,r.A)(this,"_isLoaded",void 0),(0,r.A)(this,"_isCancelled",void 0),(0,r.A)(this,"_needsReload",void 0),(0,r.A)(this,"_bbox",void 0),this.index=t,this.isVisible=!1,this.isSelected=!1,this.parent=null,this.children=[],this.content=null,this._loader=void 0,this._abortController=null,this._loaderId=0,this._isLoaded=!1,this._isCancelled=!1,this._needsReload=!1}get bbox(){return this._bbox}set bbox(t){this._bbox||(this._bbox=t,this.boundingBox="west"in t?[[t.west,t.south],[t.east,t.north]]:[[t.left,t.top],[t.right,t.bottom]])}get data(){return this.isLoading&&this._loader?this._loader.then((()=>this.data)):this.content}get isLoaded(){return this._isLoaded&&!this._needsReload}get isLoading(){return Boolean(this._loader)&&!this._isCancelled}get needsReload(){return this._needsReload||this._isCancelled}get byteLength(){const t=this.content?this.content.byteLength:0;return Number.isFinite(t)||console.error("byteLength not defined in tile data"),t}async _loadData({getData:t,requestScheduler:e,onLoad:n,onError:r}){const{index:i,id:o,bbox:s,userData:a,zoom:l}=this,u=this._loaderId;this._abortController=new AbortController;const{signal:c}=this._abortController,h=await e.scheduleRequest(this,(t=>t.isSelected?1:-1));if(!h)return void(this._isCancelled=!0);if(this._isCancelled)return void h.done();let d,f=null;try{f=await t({index:i,id:o,bbox:s,userData:a,zoom:l,signal:c})}catch(t){d=t||!0}finally{h.done()}u===this._loaderId&&(this._loader=void 0,this.content=f,!this._isCancelled||f?(this._isLoaded=!0,this._isCancelled=!1,d?r(d,this):n(this)):this._isLoaded=!1)}loadData(t){return this._isLoaded=!1,this._isCancelled=!1,this._needsReload=!1,this._loaderId++,this._loader=this._loadData(t),this._loader}setNeedsReload(){this.isLoading&&(this.abort(),this._loader=void 0),this._needsReload=!0}abort(){var t;this.isLoaded||(this._isCancelled=!0,null===(t=this._abortController)||void 0===t||t.abort())}}var ht=n(33540),dt=n(82125);const ft=-1;var pt=n(22466);const gt=new pt.A,yt=new pt.A;class mt{constructor(t=[0,0,0],e=[0,0,0],n){(0,r.A)(this,"center",void 0),(0,r.A)(this,"halfDiagonal",void 0),(0,r.A)(this,"minimum",void 0),(0,r.A)(this,"maximum",void 0),n=n||gt.copy(t).add(e).scale(.5),this.center=new pt.A(n),this.halfDiagonal=new pt.A(e).subtract(this.center),this.minimum=new pt.A(t),this.maximum=new pt.A(e)}clone(){return new mt(this.minimum,this.maximum,this.center)}equals(t){return this===t||Boolean(t)&&this.minimum.equals(t.minimum)&&this.maximum.equals(t.maximum)}transform(t){return this.center.transformAsPoint(t),this.halfDiagonal.transform(t),this.minimum.transform(t),this.maximum.transform(t),this}intersectPlane(t){const{halfDiagonal:e}=this,n=yt.from(t.normal),r=e.x*Math.abs(n.x)+e.y*Math.abs(n.y)+e.z*Math.abs(n.z),i=this.center.dot(n)+t.distance;return i-r>0?1:i+r<0?ft:0}distanceTo(t){return Math.sqrt(this.distanceSquaredTo(t))}distanceSquaredTo(t){const e=gt.from(t).subtract(this.center),{halfDiagonal:n}=this;let r,i=0;return r=Math.abs(e.x)-n.x,r>0&&(i+=r*r),r=Math.abs(e.y)-n.y,r>0&&(i+=r*r),r=Math.abs(e.z)-n.z,r>0&&(i+=r*r),i}}var vt=n(67684);const bt=new pt.A,_t=new pt.A;class At{constructor(t=[0,0,0],e=0){(0,r.A)(this,"center",void 0),(0,r.A)(this,"radius",void 0),this.radius=-0,this.center=new pt.A,this.fromCenterRadius(t,e)}fromCenterRadius(t,e){return this.center.from(t),this.radius=e,this}fromCornerPoints(t,e){return e=bt.from(e),this.center=(new pt.A).from(t).add(e).scale(.5),this.radius=this.center.distance(e),this}equals(t){return this===t||Boolean(t)&&this.center.equals(t.center)&&this.radius===t.radius}clone(){return new At(this.center,this.radius)}union(t){const e=this.center,n=this.radius,r=t.center,i=t.radius,o=bt.copy(r).subtract(e),s=o.magnitude();if(n>=s+i)return this.clone();if(i>=s+n)return t.clone();const a=.5*(n+s+i);return _t.copy(o).scale((-n+a)/s).add(e),this.center.copy(_t),this.radius=a,this}expand(t){const e=bt.from(t).subtract(this.center).magnitude();return e>this.radius&&(this.radius=e),this}transform(t){this.center.transform(t);const e=vt.IL(bt,t);return this.radius=Math.max(e[0],Math.max(e[1],e[2]))*this.radius,this}distanceSquaredTo(t){const e=this.distanceTo(t);return e*e}distanceTo(t){const e=bt.from(t).subtract(this.center);return Math.max(0,e.len()-this.radius)}intersectPlane(t){const e=this.center,n=this.radius,r=t.normal.dot(e)+t.distance;return r<-n?ft:r<n?0:1}}var xt=n(50108),wt=n(5521);const Ct=new pt.A,St=new pt.A,Et=new pt.A,Mt=new pt.A,Pt=new pt.A,Tt=new pt.A,Ot=new pt.A;class It{constructor(t=[0,0,0],e=[0,0,0,0,0,0,0,0,0]){(0,r.A)(this,"center",void 0),(0,r.A)(this,"halfAxes",void 0),this.center=(new pt.A).from(t),this.halfAxes=new xt.A(e)}get halfSize(){const t=this.halfAxes.getColumn(0),e=this.halfAxes.getColumn(1),n=this.halfAxes.getColumn(2);return[new pt.A(t).len(),new pt.A(e).len(),new pt.A(n).len()]}get quaternion(){const t=this.halfAxes.getColumn(0),e=this.halfAxes.getColumn(1),n=this.halfAxes.getColumn(2),r=new pt.A(t).normalize(),i=new pt.A(e).normalize(),o=new pt.A(n).normalize();return(new wt.A).fromMatrix3(new xt.A([...r,...i,...o]))}fromCenterHalfSizeQuaternion(t,e,n){const r=new wt.A(n),i=(new xt.A).fromQuaternion(r);return i[0]=i[0]*e[0],i[1]=i[1]*e[0],i[2]=i[2]*e[0],i[3]=i[3]*e[1],i[4]=i[4]*e[1],i[5]=i[5]*e[1],i[6]=i[6]*e[2],i[7]=i[7]*e[2],i[8]=i[8]*e[2],this.center=(new pt.A).from(t),this.halfAxes=i,this}clone(){return new It(this.center,this.halfAxes)}equals(t){return this===t||Boolean(t)&&this.center.equals(t.center)&&this.halfAxes.equals(t.halfAxes)}getBoundingSphere(t=new At){const e=this.halfAxes,n=e.getColumn(0,Et),r=e.getColumn(1,Mt),i=e.getColumn(2,Pt),o=Ct.copy(n).add(r).add(i);return t.center.copy(this.center),t.radius=o.magnitude(),t}intersectPlane(t){const e=this.center,n=t.normal,r=this.halfAxes,i=n.x,o=n.y,s=n.z,a=Math.abs(i*r[0]+o*r[1]+s*r[2])+Math.abs(i*r[3]+o*r[4]+s*r[5])+Math.abs(i*r[6]+o*r[7]+s*r[8]),l=n.dot(e)+t.distance;return l<=-a?ft:l>=a?1:0}distanceTo(t){return Math.sqrt(this.distanceSquaredTo(t))}distanceSquaredTo(t){const e=St.from(t).subtract(this.center),n=this.halfAxes,r=n.getColumn(0,Et),i=n.getColumn(1,Mt),o=n.getColumn(2,Pt),s=r.magnitude(),a=i.magnitude(),l=o.magnitude();r.normalize(),i.normalize(),o.normalize();let u,c=0;return u=Math.abs(e.dot(r))-s,u>0&&(c+=u*u),u=Math.abs(e.dot(i))-a,u>0&&(c+=u*u),u=Math.abs(e.dot(o))-l,u>0&&(c+=u*u),c}computePlaneDistances(t,e,n=[-0,-0]){let r=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY;const o=this.center,s=this.halfAxes,a=s.getColumn(0,Et),l=s.getColumn(1,Mt),u=s.getColumn(2,Pt),c=Tt.copy(a).add(l).add(u).add(o),h=Ot.copy(c).subtract(t);let d=e.dot(h);return r=Math.min(d,r),i=Math.max(d,i),c.copy(o).add(a).add(l).subtract(u),h.copy(c).subtract(t),d=e.dot(h),r=Math.min(d,r),i=Math.max(d,i),c.copy(o).add(a).subtract(l).add(u),h.copy(c).subtract(t),d=e.dot(h),r=Math.min(d,r),i=Math.max(d,i),c.copy(o).add(a).subtract(l).subtract(u),h.copy(c).subtract(t),d=e.dot(h),r=Math.min(d,r),i=Math.max(d,i),o.copy(c).subtract(a).add(l).add(u),h.copy(c).subtract(t),d=e.dot(h),r=Math.min(d,r),i=Math.max(d,i),o.copy(c).subtract(a).add(l).subtract(u),h.copy(c).subtract(t),d=e.dot(h),r=Math.min(d,r),i=Math.max(d,i),o.copy(c).subtract(a).subtract(l).add(u),h.copy(c).subtract(t),d=e.dot(h),r=Math.min(d,r),i=Math.max(d,i),o.copy(c).subtract(a).subtract(l).subtract(u),h.copy(c).subtract(t),d=e.dot(h),r=Math.min(d,r),i=Math.max(d,i),n[0]=r,n[1]=i,n}transform(t){this.center.transformAsPoint(t);const e=this.halfAxes.getColumn(0,Et);e.transformAsPoint(t);const n=this.halfAxes.getColumn(1,Mt);n.transformAsPoint(t);const r=this.halfAxes.getColumn(2,Pt);return r.transformAsPoint(t),this.halfAxes=new xt.A([...e,...n,...r]),this}getTransform(){throw new Error("not implemented")}}var Rt=n(58523);const Bt=new pt.A,Lt=new pt.A;class kt{constructor(t=[0,0,1],e=0){(0,r.A)(this,"normal",void 0),(0,r.A)(this,"distance",void 0),this.normal=new pt.A,this.distance=-0,this.fromNormalDistance(t,e)}fromNormalDistance(t,e){return(0,Rt.A)(Number.isFinite(e)),this.normal.from(t).normalize(),this.distance=e,this}fromPointNormal(t,e){t=Bt.from(t),this.normal.from(e).normalize();const n=-this.normal.dot(t);return this.distance=n,this}fromCoefficients(t,e,n,r){return this.normal.set(t,e,n),(0,Rt.A)((0,ut.aI)(this.normal.len(),1)),this.distance=r,this}clone(){return new kt(this.normal,this.distance)}equals(t){return(0,ut.aI)(this.distance,t.distance)&&(0,ut.aI)(this.normal,t.normal)}getPointDistance(t){return this.normal.dot(t)+this.distance}transform(t){const e=Lt.copy(this.normal).transformAsVector(t).normalize(),n=this.normal.scale(-this.distance).transform(t);return this.fromPointNormal(n,e)}projectPointOntoPlane(t,e=[0,0,0]){t=Bt.from(t);const n=this.getPointDistance(t),r=Lt.copy(this.normal).scale(n);return t.subtract(r).to(e)}}const Dt=[new pt.A([1,0,0]),new pt.A([0,1,0]),new pt.A([0,0,1])],Ft=new pt.A,Nt=new pt.A;new kt(new pt.A(1,0,0),0);class jt{constructor(t=[]){(0,r.A)(this,"planes",void 0),this.planes=t}fromBoundingSphere(t){this.planes.length=2*Dt.length;const e=t.center,n=t.radius;let r=0;for(const t of Dt){let i=this.planes[r],o=this.planes[r+1];i||(i=this.planes[r]=new kt),o||(o=this.planes[r+1]=new kt);const s=Ft.copy(t).scale(-n).add(e);t.dot(s),i.fromPointNormal(s,t);const a=Ft.copy(t).scale(n).add(e),l=Nt.copy(t).negate();l.dot(a),o.fromPointNormal(a,l),r+=2}return this}computeVisibility(t){let e=1;for(const n of this.planes)switch(t.intersectPlane(n)){case ft:return ft;case 0:e=0}return e}computeVisibilityWithPlaneMask(t,e){if((0,Rt.A)(Number.isFinite(e),"parentPlaneMask is required."),e===jt.MASK_OUTSIDE||e===jt.MASK_INSIDE)return e;let n=jt.MASK_INSIDE;const r=this.planes;for(let i=0;i<this.planes.length;++i){const o=i<31?1<<i:0;if(i<31&&!(e&o))continue;const s=r[i],a=t.intersectPlane(s);if(a===ft)return jt.MASK_OUTSIDE;0===a&&(n|=o)}return n}}(0,r.A)(jt,"MASK_OUTSIDE",4294967295),(0,r.A)(jt,"MASK_INSIDE",0),(0,r.A)(jt,"MASK_INDETERMINATE",2147483647),new pt.A,new pt.A,new pt.A,new pt.A,new pt.A,new pt.A,new pt.A,new pt.A,new pt.A,new pt.A,new pt.A,new pt.A,new pt.A,new pt.A,new pt.A,new pt.A,new pt.A,Math.PI;var Gt=n(33067);const Ut=new xt.A,zt=new xt.A,Vt=new xt.A,Ht=new xt.A,qt=new xt.A;const Wt=[1,0,0],Jt=[2,2,1];function Yt(t){let e=0;for(let n=0;n<3;++n){const r=t[Ut.getElementIndex(Jt[n],Wt[n])];e+=2*r*r}return Math.sqrt(e)}function Xt(t,e){const n=Gt.A.EPSILON15;let r=0,i=1;for(let e=0;e<3;++e){const n=Math.abs(t[Ut.getElementIndex(Jt[e],Wt[e])]);n>r&&(i=e,r=n)}const o=Wt[i],s=Jt[i];let a=1,l=0;if(Math.abs(t[Ut.getElementIndex(s,o)])>n){const e=(t[Ut.getElementIndex(s,s)]-t[Ut.getElementIndex(o,o)])/2/t[Ut.getElementIndex(s,o)];let n;n=e<0?-1/(-e+Math.sqrt(1+e*e)):1/(e+Math.sqrt(1+e*e)),a=1/Math.sqrt(1+n*n),l=n*a}return xt.A.IDENTITY.to(e),e[Ut.getElementIndex(o,o)]=e[Ut.getElementIndex(s,s)]=a,e[Ut.getElementIndex(s,o)]=l,e[Ut.getElementIndex(o,s)]=-l,e}const Kt=new pt.A,Zt=new pt.A,Qt=new pt.A,$t=new pt.A,te=new pt.A,ee=new xt.A,ne={diagonal:new xt.A,unitary:new xt.A};function re(t,e=new It){if(!t||0===t.length)return e.halfAxes=new xt.A([0,0,0,0,0,0,0,0,0]),e.center=new pt.A,e;const n=t.length,r=new pt.A(0,0,0);for(const e of t)r.add(e);const i=1/n;r.multiplyByScalar(i);let o=0,s=0,a=0,l=0,u=0,c=0;for(const e of t){const t=Kt.copy(e).subtract(r);o+=t.x*t.x,s+=t.x*t.y,a+=t.x*t.z,l+=t.y*t.y,u+=t.y*t.z,c+=t.z*t.z}o*=i,s*=i,a*=i,l*=i,u*=i,c*=i;const h=ee;h[0]=o,h[1]=s,h[2]=a,h[3]=s,h[4]=l,h[5]=u,h[6]=a,h[7]=u,h[8]=c;const{unitary:d}=function(t,e={}){const n=Gt.A.EPSILON20;let r=0,i=0;const o=zt,s=Vt;o.identity(),s.copy(t);const a=n*function(t){let e=0;for(let n=0;n<9;++n){const r=t[n];e+=r*r}return Math.sqrt(e)}(s);for(;i<10&&Yt(s)>a;)Xt(s,Ht),qt.copy(Ht).transpose(),s.multiplyRight(Ht),s.multiplyLeft(qt),o.multiplyRight(Ht),++r>2&&(++i,r=0);return e.unitary=o.toTarget(e.unitary),e.diagonal=s.toTarget(e.diagonal),e}(h,ne),f=e.halfAxes.copy(d);let p=f.getColumn(0,Qt),g=f.getColumn(1,$t),y=f.getColumn(2,te),m=-Number.MAX_VALUE,v=-Number.MAX_VALUE,b=-Number.MAX_VALUE,_=Number.MAX_VALUE,A=Number.MAX_VALUE,x=Number.MAX_VALUE;for(const e of t)Kt.copy(e),m=Math.max(Kt.dot(p),m),v=Math.max(Kt.dot(g),v),b=Math.max(Kt.dot(y),b),_=Math.min(Kt.dot(p),_),A=Math.min(Kt.dot(g),A),x=Math.min(Kt.dot(y),x);p=p.multiplyByScalar(.5*(_+m)),g=g.multiplyByScalar(.5*(A+v)),y=y.multiplyByScalar(.5*(x+b)),e.center.copy(p).add(g).add(y);const w=Zt.set(m-_,v-A,b-x).multiplyByScalar(.5),C=new xt.A([w[0],0,0,0,w[1],0,0,0,w[2]]);return e.halfAxes.multiplyRight(C),e}const ie=512,oe=[[.5,.5],[0,0],[0,1],[1,0],[1,1]],se=oe.concat([[0,.5],[.5,0],[1,.5],[.5,1]]),ae=se.concat([[.25,.5],[.75,.5]]);class le{constructor(t,e,n){(0,r.A)(this,"x",void 0),(0,r.A)(this,"y",void 0),(0,r.A)(this,"z",void 0),(0,r.A)(this,"childVisible",void 0),(0,r.A)(this,"selected",void 0),(0,r.A)(this,"_children",void 0),this.x=t,this.y=e,this.z=n}get children(){if(!this._children){const t=2*this.x,e=2*this.y,n=this.z+1;this._children=[new le(t,e,n),new le(t,e+1,n),new le(t+1,e,n),new le(t+1,e+1,n)]}return this._children}update(t){const{viewport:e,cullingVolume:n,elevationBounds:r,minZ:i,maxZ:o,bounds:s,offset:a,project:l}=t,u=this.getBoundingVolume(r,a,l);if(s&&!this.insideBounds(s))return!1;if(n.computeVisibility(u)<0)return!1;if(!this.childVisible){let{z:t}=this;if(t<o&&t>=i){const n=u.distanceTo(e.cameraPosition)*e.scale/e.height;t+=Math.floor(Math.log2(n))}if(t>=o)return this.selected=!0,!0}this.selected=!1,this.childVisible=!0;for(const e of this.children)e.update(t);return!0}getSelected(t=[]){if(this.selected&&t.push(this),this._children)for(const e of this._children)e.getSelected(t);return t}insideBounds([t,e,n,r]){const i=Math.pow(2,this.z),o=ie/i;return this.x*o<n&&this.y*o<r&&(this.x+1)*o>t&&(this.y+1)*o>e}getBoundingVolume(t,e,n){if(n){const e=this.z<1?ae:this.z<2?se:oe,r=[];for(const i of e){const e=me(this.x+i[0],this.y+i[1],this.z);e[2]=t[0],r.push(n(e)),t[0]!==t[1]&&(e[2]=t[1],r.push(n(e)))}return re(r)}const r=Math.pow(2,this.z),i=ie/r,o=this.x*i+e*ie,s=ie-(this.y+1)*i;return new mt([o,s,t[0]],[o+i,s+i,t[1]])}}const ue=512,ce=[-1/0,-1/0,1/0,1/0],he={type:"object",value:null,validate:(t,e)=>e.optional&&null===t||"string"==typeof t||Array.isArray(t)&&t.every((t=>"string"==typeof t)),equal:(t,e)=>{if(t===e)return!0;if(!Array.isArray(t)||!Array.isArray(e))return!1;const n=t.length;if(n!==e.length)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}};function de(t,e){const n=[e.transformAsPoint([t[0],t[1]]),e.transformAsPoint([t[2],t[1]]),e.transformAsPoint([t[0],t[3]]),e.transformAsPoint([t[2],t[3]])],r=[Math.min(...n.map((t=>t[0]))),Math.min(...n.map((t=>t[1]))),Math.max(...n.map((t=>t[0]))),Math.max(...n.map((t=>t[1])))];return r}function fe(t,e){if(!t||!t.length)return null;const{index:n,id:r}=e;var i;Array.isArray(t)&&(t=t[(i=r,Math.abs(i.split("").reduce(((t,e)=>(t<<5)-t+e.charCodeAt(0)|0),0))%t.length)]);let o=t;for(const t of Object.keys(n)){const e=new RegExp("{".concat(t,"}"),"g");o=o.replace(e,String(n[t]))}return Number.isInteger(n.y)&&Number.isInteger(n.z)&&(o=o.replace(/\{-y\}/g,String(Math.pow(2,n.z)-n.y-1))),o}function pe({viewport:t,z:e=0,cullRect:n}){return(t.subViewports||[t]).map((t=>ge(t,e||0,n)))}function ge(t,e,n){if(!Array.isArray(e)){const r=n.x-t.x,i=n.y-t.y,{width:o,height:s}=n,a={targetZ:e},l=t.unproject([r,i],a),u=t.unproject([r+o,i],a),c=t.unproject([r,i+s],a),h=t.unproject([r+o,i+s],a);return[Math.min(l[0],u[0],c[0],h[0]),Math.min(l[1],u[1],c[1],h[1]),Math.max(l[0],u[0],c[0],h[0]),Math.max(l[1],u[1],c[1],h[1])]}const r=ge(t,e[0],n),i=ge(t,e[1],n);return[Math.min(r[0],i[0]),Math.min(r[1],i[1]),Math.max(r[2],i[2]),Math.max(r[3],i[3])]}function ye(t,e){return Math.pow(2,t)*ue/e}function me(t,e,n){const r=ye(n,ue),i=t/r*360-180,o=Math.PI-2*Math.PI*e/r;return[i,180/Math.PI*Math.atan(.5*(Math.exp(o)-Math.exp(-o)))]}function ve(t,e,n,r){const i=ye(n,r);return[t/i*ue,e/i*ue]}function be(t,e,n,r,i=ue){if(t.isGeospatial){const[t,i]=me(e,n,r),[o,s]=me(e+1,n+1,r);return{west:t,north:i,east:o,south:s}}const[o,s]=ve(e,n,r,i),[a,l]=ve(e+1,n+1,r,i);return{left:o,top:s,right:a,bottom:l}}function _e({viewport:t,maxZoom:e,minZoom:n,zRange:r,extent:i,tileSize:o=ue,modelMatrix:s,modelMatrixInverse:a,zoomOffset:l=0}){let u=t.isGeospatial?Math.round(t.zoom+Math.log2(ue/o))+l:Math.ceil(t.zoom)+l;if("number"==typeof n&&Number.isFinite(n)&&u<n){if(!i)return[];u=n}"number"==typeof e&&Number.isFinite(e)&&u>e&&(u=e);let c=i;return s&&a&&i&&!t.isGeospatial&&(c=de(i,s)),t.isGeospatial?function(t,e,n,r){const i=t instanceof ht.A&&t.resolution?t.projectPosition:null,o=Object.values(t.getFrustumPlanes()).map((({normal:t,distance:e})=>new kt(t.clone().negate(),e))),s=new jt(o),a=t.distanceScales.unitsPerMeter[2],l=n&&n[0]*a||0,u=n&&n[1]*a||0,c=t instanceof dt.A&&t.pitch<=60?e:0;if(r){const[t,e,n,i]=r,o=(0,D.lngLatToWorld)([t,i]),s=(0,D.lngLatToWorld)([n,e]);r=[o[0],ie-o[1],s[0],ie-s[1]]}const h=new le(0,0,0),d={viewport:t,project:i,cullingVolume:s,elevationBounds:[l,u],minZ:c,maxZ:e,bounds:r,offset:0};if(h.update(d),t instanceof dt.A&&t.subViewports&&t.subViewports.length>1){for(d.offset=-1;h.update(d)&&!(--d.offset<-3););for(d.offset=1;h.update(d)&&!(++d.offset>3););}return h.getSelected()}(t,u,r,i):function(t,e,n,r,i){const o=function(t,e,n){let r;return r=t.getBounds(),t.isGeospatial?[Math.max(r[0],n[0]),Math.max(r[1],n[1]),Math.min(r[2],n[2]),Math.min(r[3],n[3])]:[Math.max(Math.min(r[0],n[2]),n[0]),Math.max(Math.min(r[1],n[3]),n[1]),Math.min(Math.max(r[2],n[0]),n[2]),Math.min(Math.max(r[3],n[1]),n[3])]}(t,0,r),s=ye(e,n),[a,l,u,c]=function(t,e,n){if(n){const r=de(t,n).map((t=>t*e/ue));return r}return t.map((t=>t*e/ue))}(o,s,i),h=[];for(let t=Math.floor(a);t<u;t++)for(let n=Math.floor(l);n<c;n++)h.push({x:t,y:n,z:e});return h}(t,u,o,c||ce,a)}function Ae(t,e){if(t===e)return!0;if(Array.isArray(t)){const n=t.length;if(!e||e.length!==n)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}return!1}const xe="never",we="no-overlap",Ce="best-available",Se={[Ce]:function(t){for(const e of t)e.state=0;for(const e of t)e.isSelected&&!Pe(e)&&Te(e);for(const e of t)e.isVisible=Boolean(2&e.state)},[we]:function(t){for(const e of t)e.state=0;for(const e of t)e.isSelected&&Pe(e);const e=Array.from(t).sort(((t,e)=>t.zoom-e.zoom));for(const t of e)if(t.isVisible=Boolean(2&t.state),t.children&&(t.isVisible||1&t.state))for(const e of t.children)e.state=1;else t.isSelected&&Te(t)},[xe]:()=>{}},Ee={extent:null,tileSize:512,maxZoom:null,minZoom:null,maxCacheSize:null,maxCacheByteSize:null,refinementStrategy:"best-available",zRange:null,maxRequests:6,zoomOffset:0,onTileLoad:()=>{},onTileUnload:()=>{},onTileError:()=>{}};class Me{constructor(t){(0,r.A)(this,"opts",void 0),(0,r.A)(this,"_requestScheduler",void 0),(0,r.A)(this,"_cache",void 0),(0,r.A)(this,"_dirty",void 0),(0,r.A)(this,"_tiles",void 0),(0,r.A)(this,"_cacheByteSize",void 0),(0,r.A)(this,"_viewport",void 0),(0,r.A)(this,"_zRange",void 0),(0,r.A)(this,"_selectedTiles",void 0),(0,r.A)(this,"_frameNumber",void 0),(0,r.A)(this,"_modelMatrix",void 0),(0,r.A)(this,"_modelMatrixInverse",void 0),(0,r.A)(this,"_maxZoom",void 0),(0,r.A)(this,"_minZoom",void 0),(0,r.A)(this,"onTileLoad",void 0),(0,r.A)(this,"_getCullBounds",function(t){let e,n={};return r=>{for(const i in r)if(!Ae(r[i],n[i])){e=t(r),n=r;break}return e}}(pe)),this.opts={...Ee,...t},this.onTileLoad=t=>{var e,n;null===(e=(n=this.opts).onTileLoad)||void 0===e||e.call(n,t),this.opts.maxCacheByteSize&&(this._cacheByteSize+=t.byteLength,this._resizeCache())},this._requestScheduler=new at.A({maxRequests:t.maxRequests,throttleRequests:Boolean(t.maxRequests&&t.maxRequests>0)}),this._cache=new Map,this._tiles=[],this._dirty=!1,this._cacheByteSize=0,this._viewport=null,this._zRange=null,this._selectedTiles=null,this._frameNumber=0,this._modelMatrix=new lt.A,this._modelMatrixInverse=new lt.A,this.setOptions(t)}get tiles(){return this._tiles}get selectedTiles(){return this._selectedTiles}get isLoaded(){return null!==this._selectedTiles&&this._selectedTiles.every((t=>t.isLoaded))}get needsReload(){return null!==this._selectedTiles&&this._selectedTiles.some((t=>t.needsReload))}setOptions(t){Object.assign(this.opts,t),Number.isFinite(t.maxZoom)&&(this._maxZoom=Math.floor(t.maxZoom)),Number.isFinite(t.minZoom)&&(this._minZoom=Math.ceil(t.minZoom))}finalize(){for(const t of this._cache.values())t.isLoading&&t.abort();this._cache.clear(),this._tiles=[],this._selectedTiles=null}reloadAll(){for(const t of this._cache.keys()){const e=this._cache.get(t);this._selectedTiles&&this._selectedTiles.includes(e)?e.setNeedsReload():this._cache.delete(t)}}update(t,{zRange:e,modelMatrix:n}={zRange:null,modelMatrix:null}){const r=n?new lt.A(n):new lt.A,i=!r.equals(this._modelMatrix);if(this._viewport&&t.equals(this._viewport)&&(0,ut.aI)(this._zRange,e)&&!i)this.needsReload&&(this._selectedTiles=this._selectedTiles.map((t=>this._getTile(t.index,!0))));else{i&&(this._modelMatrixInverse=r.clone().invert(),this._modelMatrix=r),this._viewport=t,this._zRange=e;const n=this.getTileIndices({viewport:t,maxZoom:this._maxZoom,minZoom:this._minZoom,zRange:e,modelMatrix:this._modelMatrix,modelMatrixInverse:this._modelMatrixInverse});this._selectedTiles=n.map((t=>this._getTile(t,!0))),this._dirty&&this._rebuildTree()}const o=this.updateTileStates();return this._pruneRequests(),this._dirty&&this._resizeCache(),o&&this._frameNumber++,this._frameNumber}isTileVisible(t,e){if(!t.isVisible)return!1;if(e&&this._viewport){const n=this._getCullBounds({viewport:this._viewport,z:this._zRange,cullRect:e}),{bbox:r}=t;for(const[t,e,i,o]of n){let n;if("west"in r)n=r.west<i&&r.east>t&&r.south<o&&r.north>e;else{const s=Math.min(r.top,r.bottom),a=Math.max(r.top,r.bottom);n=r.left<i&&r.right>t&&s<o&&a>e}if(n)return!0}return!1}return!0}getTileIndices({viewport:t,maxZoom:e,minZoom:n,zRange:r,modelMatrix:i,modelMatrixInverse:o}){const{tileSize:s,extent:a,zoomOffset:l}=this.opts;return _e({viewport:t,maxZoom:e,minZoom:n,zRange:r,tileSize:s,extent:a,modelMatrix:i,modelMatrixInverse:o,zoomOffset:l})}getTileId(t){return"".concat(t.x,"-").concat(t.y,"-").concat(t.z)}getTileZoom(t){return t.z}getTileMetadata(t){const{tileSize:e}=this.opts;return{bbox:be(this._viewport,t.x,t.y,t.z,e)}}getParentIndex(t){return{x:Math.floor(t.x/2),y:Math.floor(t.y/2),z:t.z-1}}updateTileStates(){const t=this.opts.refinementStrategy||Ce,e=new Array(this._cache.size);let n=0;for(const t of this._cache.values())e[n++]=t.isVisible,t.isSelected=!1,t.isVisible=!1;for(const t of this._selectedTiles)t.isSelected=!0,t.isVisible=!0;("function"==typeof t?t:Se[t])(Array.from(this._cache.values())),n=0;for(const t of this._cache.values())if(e[n++]!==t.isVisible)return!0;return!1}_pruneRequests(){const{maxRequests:t=0}=this.opts,e=[];let n=0;for(const t of this._cache.values())t.isLoading&&(n++,t.isSelected||t.isVisible||e.push(t));for(;t>0&&n>t&&e.length>0;)e.shift().abort(),n--}_rebuildTree(){const{_cache:t}=this;for(const e of t.values())e.parent=null,e.children&&(e.children.length=0);for(const e of t.values()){const t=this._getNearestAncestor(e);e.parent=t,null!=t&&t.children&&t.children.push(e)}}_resizeCache(){const{_cache:t,opts:e}=this,n=e.maxCacheSize||(e.maxCacheByteSize?1/0:5*this.selectedTiles.length),r=e.maxCacheByteSize||1/0;if(t.size>n||this._cacheByteSize>r){for(const[s,a]of t){var i,o;if(a.isVisible||a.isSelected||(this._cacheByteSize-=e.maxCacheByteSize?a.byteLength:0,t.delete(s),null===(i=(o=this.opts).onTileUnload)||void 0===i||i.call(o,a)),t.size<=n&&this._cacheByteSize<=r)break}this._rebuildTree(),this._dirty=!0}this._dirty&&(this._tiles=Array.from(this._cache.values()).sort(((t,e)=>t.zoom-e.zoom)),this._dirty=!1)}_getTile(t,e){const n=this.getTileId(t);let r=this._cache.get(n),i=!1;return!r&&e?(r=new ct(t),Object.assign(r,this.getTileMetadata(r.index)),Object.assign(r,{id:n,zoom:this.getTileZoom(r.index)}),i=!0,this._cache.set(n,r),this._dirty=!0):r&&r.needsReload&&(i=!0),r&&i&&r.loadData({getData:this.opts.getTileData,requestScheduler:this._requestScheduler,onLoad:this.onTileLoad,onError:this.opts.onTileError}),r}_getNearestAncestor(t){const{_minZoom:e=0}=this;let n=t.index;for(;this.getTileZoom(n)>e;){n=this.getParentIndex(n);const t=this._getTile(n);if(t)return t}return null}}function Pe(t){let e=t;for(;e;){if(e.isLoaded||e.content)return e.state|=2,!0;e=e.parent}return!1}function Te(t){for(const e of t.children)e.isLoaded||e.content?e.state|=2:Te(e)}const Oe={TilesetClass:Me,data:{type:"data",value:[]},dataComparator:he.equal,renderSubLayers:{type:"function",value:t=>new st.A(t)},getTileData:{type:"function",optional:!0,value:null},onViewportLoad:{type:"function",optional:!0,value:null},onTileLoad:{type:"function",value:t=>{}},onTileUnload:{type:"function",value:t=>{}},onTileError:{type:"function",value:t=>console.error(t)},extent:{type:"array",optional:!0,value:null,compare:!0},tileSize:512,maxZoom:null,minZoom:0,maxCacheSize:null,maxCacheByteSize:null,refinementStrategy:Ce,zRange:null,maxRequests:6,zoomOffset:0};class Ie extends i.A{constructor(...t){super(...t),(0,r.A)(this,"state",void 0)}initializeState(){this.state={tileset:null,isLoaded:!1}}finalizeState(){var t,e;null===(t=this.state)||void 0===t||null===(e=t.tileset)||void 0===e||e.finalize()}get isLoaded(){var t,e,n;return Boolean(null===(t=this.state)||void 0===t||null===(e=t.tileset)||void 0===e||null===(n=e.selectedTiles)||void 0===n?void 0:n.every((t=>t.isLoaded&&t.layers&&t.layers.every((t=>t.isLoaded)))))}shouldUpdateState({changeFlags:t}){return t.somethingChanged}updateState({changeFlags:t}){let{tileset:e}=this.state;const n=t.propsOrDataChanged||t.updateTriggersChanged,r=t.dataChanged||t.updateTriggersChanged&&(t.updateTriggersChanged.all||t.updateTriggersChanged.getTileData);e?n&&(e.setOptions(this._getTilesetOptions()),r?e.reloadAll():e.tiles.forEach((t=>{t.layers=null}))):(e=new this.props.TilesetClass(this._getTilesetOptions()),this.setState({tileset:e})),this._updateTileset()}_getTilesetOptions(){const{tileSize:t,maxCacheSize:e,maxCacheByteSize:n,refinementStrategy:r,extent:i,maxZoom:o,minZoom:s,maxRequests:a,zoomOffset:l}=this.props;return{maxCacheSize:e,maxCacheByteSize:n,maxZoom:o,minZoom:s,tileSize:t,refinementStrategy:r,extent:i,maxRequests:a,zoomOffset:l,getTileData:this.getTileData.bind(this),onTileLoad:this._onTileLoad.bind(this),onTileError:this._onTileError.bind(this),onTileUnload:this._onTileUnload.bind(this)}}_updateTileset(){const t=this.state.tileset,{zRange:e,modelMatrix:n}=this.props,r=t.update(this.context.viewport,{zRange:e,modelMatrix:n}),{isLoaded:i}=t,o=this.state.isLoaded!==i,s=this.state.frameNumber!==r;i&&(o||s)&&this._onViewportLoad(),s&&this.setState({frameNumber:r}),this.state.isLoaded=i}_onViewportLoad(){const{tileset:t}=this.state,{onViewportLoad:e}=this.props;e&&e(t.selectedTiles)}_onTileLoad(t){this.props.onTileLoad(t),t.layers=null,this.setNeedsUpdate()}_onTileError(t,e){this.props.onTileError(t),e.layers=null,this.setNeedsUpdate()}_onTileUnload(t){this.props.onTileUnload(t)}getTileData(t){const{data:e,getTileData:n,fetch:r}=this.props,{signal:i}=t;return t.url="string"==typeof e||Array.isArray(e)?fe(e,t):null,n?n(t):r&&t.url?r(t.url,{propName:"data",layer:this,signal:i}):null}renderSubLayers(t){return this.props.renderSubLayers(t)}getSubLayerPropsByTile(t){return null}getPickingInfo({info:t,sourceLayer:e}){const n=e.props.tile;return t.picked&&(t.tile=n),t.sourceTile=n,t}_updateAutoHighlight(t){const e=t.sourceTile;if(e&&e.layers)for(const n of e.layers)n.updateAutoHighlight(t)}renderLayers(){return this.state.tileset.tiles.map((t=>{const e=this.getSubLayerPropsByTile(t);if(t.isLoaded||t.content)if(t.layers)e&&t.layers[0]&&Object.keys(e).some((n=>t.layers[0].props[n]!==e[n]))&&(t.layers=t.layers.map((t=>t.clone(e))));else{const n=this.renderSubLayers({...this.props,...this.getSubLayerProps({id:t.id,updateTriggers:this.props.updateTriggers}),data:t.content,_offset:0,tile:t});t.layers=(0,ot.B)(n,Boolean).map((n=>n.clone({tile:t,...e})))}return t.layers}))}filterSubLayer({layer:t,cullRect:e}){const{tile:n}=t.props;return this.state.tileset.isTileVisible(n,e)}}(0,r.A)(Ie,"defaultProps",Oe),(0,r.A)(Ie,"layerName","TileLayer");var Re=n(33885);class Be extends Re.A{getShaders(){const t=super.getShaders();return t.inject={"vs:#decl":"uniform float trailLength;\nattribute float instanceTimestamps;\nattribute float instanceNextTimestamps;\nvarying float vTime;\n","vs:#main-end":"vTime = instanceTimestamps + (instanceNextTimestamps - instanceTimestamps) * vPathPosition.y / vPathLength;\n","fs:#decl":"uniform bool fadeTrail;\nuniform float trailLength;\nuniform float currentTime;\nvarying float vTime;\n","fs:#main-start":"if(vTime > currentTime || (fadeTrail && (vTime < currentTime - trailLength))) {\n  discard;\n}\n","fs:DECKGL_FILTER_COLOR":"if(fadeTrail) {\n  color.a *= 1.0 - (currentTime - vTime) / trailLength;\n}\n"},t}initializeState(){super.initializeState(),this.getAttributeManager().addInstanced({timestamps:{size:1,accessor:"getTimestamps",shaderAttributes:{instanceTimestamps:{vertexOffset:0},instanceNextTimestamps:{vertexOffset:1}}}})}draw(t){const{fadeTrail:e,trailLength:n,currentTime:r}=this.props;t.uniforms={...t.uniforms,fadeTrail:e,trailLength:n,currentTime:r},super.draw(t)}}(0,r.A)(Be,"layerName","TripsLayer"),(0,r.A)(Be,"defaultProps",{fadeTrail:!0,trailLength:{type:"number",value:120,min:0},currentTime:{type:"number",value:0,min:0},getTimestamps:{type:"accessor",value:t=>t.timestamps}});var Le=n(54923),ke=n(97870),De=n(76483);function Fe(t,e){e=void 0===e?t[0][0]:e;for(const n of t){const t=n[0]-e;t>180?n[0]-=360:t<-180&&(n[0]+=360)}}function Ne(t,e,n){const r=t(e,n),[i,o]=(0,Le.h3ToGeo)(r);return[o,i]}function je(t,e=1){const n=(0,Le.h3ToGeoBoundary)(t,!0);return 1!==e?function(t,e,n){const[r,i]=(0,Le.h3ToGeo)(t),o=e.length;Fe(e,i);const s=e[0]===e[o-1]?o-1:o;for(let t=0;t<s;t++)e[t][0]=(0,ut.Cc)(i,e[t][0],n),e[t][1]=(0,ut.Cc)(r,e[t][1],n)}(t,n,e):Fe(n),n}const Ge={...V.A.defaultProps,highPrecision:"auto",coverage:{type:"number",min:0,max:1,value:1},centerHexagon:null,getHexagon:{type:"accessor",value:t=>t.hexagon},extruded:!0};class Ue extends i.A{constructor(...t){super(...t),(0,r.A)(this,"state",void 0)}initializeState(){Ue._checkH3Lib(),this.state={edgeLengthKM:0,resolution:-1}}shouldUpdateState({changeFlags:t}){return this._shouldUseHighPrecision()?t.propsOrDataChanged:t.somethingChanged}updateState({props:t,changeFlags:e}){if(!0!==t.highPrecision&&(e.dataChanged||e.updateTriggersChanged&&e.updateTriggersChanged.getHexagon)){const t=this._calculateH3DataProps();this.setState(t)}this._updateVertices(this.context.viewport)}_calculateH3DataProps(){let t=-1,e=!1,n=!1;const{iterable:r,objectInfo:i}=(0,ke.X)(this.props.data);for(const o of r){i.index++;const r=this.props.getHexagon(o,i),s=(0,Le.h3GetResolution)(r);if(t<0){if(t=s,!this.props.highPrecision)break}else if(t!==s){n=!0;break}if((0,Le.h3IsPentagon)(r)){e=!0;break}}return{resolution:t,edgeLengthKM:t>=0?(0,Le.edgeLength)(t,"km"):0,hasMultipleRes:n,hasPentagon:e}}_shouldUseHighPrecision(){if("auto"===this.props.highPrecision){const{resolution:t,hasPentagon:e,hasMultipleRes:n}=this.state,{viewport:r}=this.context;return Boolean(null==r?void 0:r.resolution)||n||e||t>=0&&t<=5}return this.props.highPrecision}_updateVertices(t){if(this._shouldUseHighPrecision())return;const{resolution:e,edgeLengthKM:n,centerHex:r}=this.state;if(e<0)return;const i=this.props.centerHexagon||(0,Le.geoToH3)(t.latitude,t.longitude,e);if(r===i)return;if(r){const t=(0,Le.h3Distance)(r,i);if(t>=0&&t*n<10)return}const{unitsPerMeter:o}=t.distanceScales;let s=je(i);const[a,l]=(0,Le.h3ToGeo)(i),[u,c]=t.projectFlat([l,a]);s=s.map((e=>{const n=t.projectFlat(e);return[(n[0]-u)/o[0],(n[1]-c)/o[1]]})),this.setState({centerHex:i,vertices:s})}renderLayers(){return this._shouldUseHighPrecision()?this._renderPolygonLayer():this._renderColumnLayer()}_getForwardProps(){const{elevationScale:t,material:e,coverage:n,extruded:r,wireframe:i,stroked:o,filled:s,lineWidthUnits:a,lineWidthScale:l,lineWidthMinPixels:u,lineWidthMaxPixels:c,getFillColor:h,getElevation:d,getLineColor:f,getLineWidth:p,transitions:g,updateTriggers:y}=this.props;return{elevationScale:t,extruded:r,coverage:n,wireframe:i,stroked:o,filled:s,lineWidthUnits:a,lineWidthScale:l,lineWidthMinPixels:u,lineWidthMaxPixels:c,material:e,getElevation:d,getFillColor:h,getLineColor:f,getLineWidth:p,transitions:g,updateTriggers:{getFillColor:y.getFillColor,getElevation:y.getElevation,getLineColor:y.getLineColor,getLineWidth:y.getLineWidth}}}_renderPolygonLayer(){const{data:t,getHexagon:e,updateTriggers:n,coverage:r}=this.props,i=this.getSubLayerClass("hexagon-cell-hifi",V.A),o=this._getForwardProps();return o.updateTriggers.getPolygon=function(t,e){let n;return n=null==t?e:"object"==typeof t?{...t,coverage:e}:{getHexagon:t,coverage:e},n}(n.getHexagon,r),new i(o,this.getSubLayerProps({id:"hexagon-cell-hifi",updateTriggers:o.updateTriggers}),{data:t,_normalize:!1,_windingOrder:"CCW",positionFormat:"XY",getPolygon:(t,n)=>function(t){const e=new Float64Array(2*t.length);let n=0;for(const r of t)e[n++]=r[0],e[n++]=r[1];return e}(je(e(t,n),r))})}_renderColumnLayer(){const{data:t,getHexagon:e,updateTriggers:n}=this.props,r=this.getSubLayerClass("hexagon-cell",De.A),i=this._getForwardProps();return i.updateTriggers.getPosition=n.getHexagon,new r(i,this.getSubLayerProps({id:"hexagon-cell",flatShading:!0,updateTriggers:i.updateTriggers}),{data:t,diskResolution:6,radius:1,vertices:this.state.vertices,getPosition:Ne.bind(null,e)})}}(0,r.A)(Ue,"defaultProps",Ge),(0,r.A)(Ue,"layerName","H3HexagonLayer"),(0,r.A)(Ue,"_checkH3Lib",(()=>{}));class ze extends q{initializeState(){Ue._checkH3Lib()}updateState({props:t,changeFlags:e}){if(e.dataChanged||e.updateTriggersChanged&&e.updateTriggersChanged.getHexagons){const{data:e,getHexagons:n}=t,r=[],{iterable:i,objectInfo:o}=(0,ke.X)(e);for(const t of i){o.index++;const e=n(t,o),i=(0,Le.h3SetToMultiPolygon)(e,!0);for(const e of i)r.push(this.getSubLayerRow({polygon:e},t,o.index))}this.setState({polygons:r})}}indexToBounds(){const{getElevation:t,getFillColor:e,getLineColor:n,getLineWidth:r}=this.props;return{data:this.state.polygons,getPolygon:t=>t.polygon,getElevation:this.getSubLayerAccessor(t),getFillColor:this.getSubLayerAccessor(e),getLineColor:this.getSubLayerAccessor(n),getLineWidth:this.getSubLayerAccessor(r)}}}(0,r.A)(ze,"layerName","H3ClusterLayer"),(0,r.A)(ze,"defaultProps",{getHexagons:{type:"accessor",value:t=>t.hexagons}});var Ve=n(82170),He=n(26820),qe=n(81537),We=n(26578),Je=n(36830),Ye=n(64506),Xe=n(76694),Ke=n(4437);class Ze extends Ke.A{getShaders(){const t=super.getShaders();return t.modules.push(Ye.R),{...t,vs:"#version 300 es\n#define SHADER_NAME simple-mesh-layer-vs\nuniform float sizeScale;\nuniform bool composeModelMatrix;\nuniform bool pickFeatureIds;\nin vec3 positions;\nin vec3 normals;\nin vec3 colors;\nin vec2 texCoords;\nin vec4 uvRegions;\nin vec3 featureIdsPickingColors;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nin mat3 instanceModelMatrix;\nout vec2 vTexCoord;\nout vec3 cameraPosition;\nout vec3 normals_commonspace;\nout vec4 position_commonspace;\nout vec4 vColor;\n\nvec2 applyUVRegion(vec2 uv) {\n  #ifdef HAS_UV_REGIONS\n    return fract(uv) * (uvRegions.zw - uvRegions.xy) + uvRegions.xy;\n  #else\n    return uv;\n  #endif\n}\n\nvoid main(void) {\n  vec2 uv = applyUVRegion(texCoords);\n  geometry.uv = uv;\n\n  if (pickFeatureIds) {\n    geometry.pickingColor = featureIdsPickingColors;\n  } else {\n    geometry.pickingColor = instancePickingColors;\n  }\n\n  vTexCoord = uv;\n  cameraPosition = project_uCameraPosition;\n  vColor = vec4(colors * instanceColors.rgb, instanceColors.a);\n\n  vec3 pos = (instanceModelMatrix * positions) * sizeScale;\n  vec3 projectedPosition = project_position(positions);\n  position_commonspace = vec4(projectedPosition, 1.0);\n  gl_Position = project_common_position_to_clipspace(position_commonspace);\n\n  geometry.position = position_commonspace;\n  normals_commonspace = project_normal(instanceModelMatrix * normals);\n  geometry.normal = normals_commonspace;\n\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  #ifdef MODULE_PBR\n    pbr_vPosition = geometry.position.xyz;\n    #ifdef HAS_NORMALS\n      pbr_vNormal = geometry.normal;\n    #endif\n\n    #ifdef HAS_UV\n      pbr_vUV = uv;\n    #else\n      pbr_vUV = vec2(0., 0.);\n    #endif\n    geometry.uv = pbr_vUV;\n  #endif\n\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#version 300 es\n#define SHADER_NAME simple-mesh-layer-fs\n\nprecision highp float;\n\nuniform bool hasTexture;\nuniform sampler2D sampler;\nuniform bool flatShading;\nuniform float opacity;\n\nin vec2 vTexCoord;\nin vec3 cameraPosition;\nin vec3 normals_commonspace;\nin vec4 position_commonspace;\nin vec4 vColor;\n\nout vec4 fragColor;\n\nvoid main(void) {\n  \n#ifdef MODULE_PBR\n\n  fragColor = vColor * pbr_filterColor(vec4(0));\n  geometry.uv = pbr_vUV;\n  fragColor.a *= opacity;\n\n#else\n\n  geometry.uv = vTexCoord;\n\n  vec3 normal;\n  if (flatShading) {\n#ifdef DERIVATIVES_AVAILABLE\n    normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));\n#else\n    normal = vec3(0.0, 0.0, 1.0);\n#endif\n  } else {\n    normal = normals_commonspace;\n  }\n\n  vec4 color = hasTexture ? texture(sampler, vTexCoord) : vColor;\n  vec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);\n  fragColor = vec4(lightColor, color.a * opacity);\n\n#endif\n\n  DECKGL_FILTER_COLOR(fragColor, geometry);\n}\n"}}initializeState(){const{featureIds:t}=this.props;super.initializeState();const e=this.getAttributeManager();t&&e.add({featureIdsPickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateFeatureIdsPickingColors}})}updateState(t){super.updateState(t);const{props:e,oldProps:n}=t;e.pbrMaterial!==n.pbrMaterial&&this.updatePbrMaterialUniforms(e.pbrMaterial)}draw(t){const{featureIds:e}=this.props;this.state.model&&(this.state.model.setUniforms({u_Camera:this.state.model.getUniforms().project_uCameraPosition,pickFeatureIds:Boolean(e)}),super.draw(t))}getModel(t){const{id:e,pbrMaterial:n}=this.props,r=this.parseMaterial(n,t);this.setState({materialParser:r});const i=this.getShaders();var o;return(o=t.attributes).COLOR_0||o.colors||(o.colors={constant:!0,value:new Float32Array([1,1,1])}),new Xe.A(this.context.gl,{...this.getShaders(),id:e,geometry:t,defines:{...i.defines,...null==r?void 0:r.defines,HAS_UV_REGIONS:t.attributes.uvRegions},parameters:null==r?void 0:r.parameters,isInstanced:!0})}updatePbrMaterialUniforms(t){const{model:e}=this.state;if(e){const{mesh:n}=this.props,r=this.parseMaterial(t,n);this.setState({materialParser:r}),e.setUniforms(r.uniforms)}}parseMaterial(t,e){var n;const r=Boolean(t.pbrMetallicRoughness&&t.pbrMetallicRoughness.baseColorTexture);return null===(n=this.state.materialParser)||void 0===n||n.delete(),new Je.A(this.context.gl,{attributes:{NORMAL:e.attributes.normals,TEXCOORD_0:e.attributes.texCoords},material:{unlit:r,...t},pbrDebug:!1,imageBasedLightingEnvironment:null,lights:!0,useTangents:!1})}calculateFeatureIdsPickingColors(t){const e=this.props.featureIds,n=new Uint8ClampedArray(e.length*t.size),r=[];for(let t=0;t<e.length;t++)this.encodePickingColor(e[t],r),n[3*t]=r[0],n[3*t+1]=r[1],n[3*t+2]=r[2];t.value=n}finalizeState(t){var e;super.finalizeState(t),null===(e=this.state.materialParser)||void 0===e||e.delete(),this.setState({materialParser:null})}}(0,r.A)(Ze,"layerName","MeshLayer"),(0,r.A)(Ze,"defaultProps",{pbrMaterial:{type:"object",value:null},featureIds:{type:"array",value:null,optional:!0}});var Qe=n(86735),$e=n(30329);const tn=6378137,en=6378137,nn=6356752.314245179;function rn(t){return t}Math.max(tn,en,nn),new pt.A;const on=new pt.A,sn=new pt.A,an=new pt.A,ln=new pt.A,un={up:{south:"east",north:"west",west:"south",east:"north"},down:{south:"west",north:"east",west:"north",east:"south"},south:{up:"west",down:"east",west:"down",east:"up"},north:{up:"east",down:"west",west:"up",east:"down"},west:{up:"north",down:"south",north:"down",south:"up"},east:{up:"south",down:"north",north:"up",south:"down"}},cn={north:[-1,0,0],east:[0,1,0],up:[0,0,1],south:[1,0,0],west:[0,-1,0],down:[0,0,-1]},hn={east:new pt.A,north:new pt.A,up:new pt.A,west:new pt.A,south:new pt.A,down:new pt.A},dn=new pt.A,fn=new pt.A,pn=new pt.A;function gn(t,e,n,r,i,o){const s=un[e]&&un[e][n];let a,l,u;(0,Rt.A)(s&&(!r||r===s));const c=ln.copy(i);if((0,ut.aI)(c.x,0,1e-14)&&(0,ut.aI)(c.y,0,1e-14)){const t=Math.sign(c.z);a=dn.fromArray(cn[e]),"east"!==e&&"west"!==e&&a.scale(t),l=fn.fromArray(cn[n]),"east"!==n&&"west"!==n&&l.scale(t),u=pn.fromArray(cn[r]),"east"!==r&&"west"!==r&&u.scale(t)}else{const{up:i,east:o,north:s}=hn;o.set(-c.y,c.x,0).normalize(),t.geodeticSurfaceNormal(c,i),s.copy(i).cross(o);const{down:h,west:d,south:f}=hn;h.copy(i).scale(-1),d.copy(o).scale(-1),f.copy(s).scale(-1),a=hn[e],l=hn[n],u=hn[r]}return o[0]=a.x,o[1]=a.y,o[2]=a.z,o[3]=0,o[4]=l.x,o[5]=l.y,o[6]=l.z,o[7]=0,o[8]=u.x,o[9]=u.y,o[10]=u.z,o[11]=0,o[12]=c.x,o[13]=c.y,o[14]=c.z,o[15]=1,o}const yn=new pt.A,mn=new pt.A,vn=new pt.A,bn=new pt.A,_n=new pt.A,An=new pt.A;class xn{constructor(t=0,e=0,n=0){(0,r.A)(this,"radii",void 0),(0,r.A)(this,"radiiSquared",void 0),(0,r.A)(this,"radiiToTheFourth",void 0),(0,r.A)(this,"oneOverRadii",void 0),(0,r.A)(this,"oneOverRadiiSquared",void 0),(0,r.A)(this,"minimumRadius",void 0),(0,r.A)(this,"maximumRadius",void 0),(0,r.A)(this,"centerToleranceSquared",Gt.A.EPSILON1),(0,r.A)(this,"squaredXOverSquaredZ",void 0),(0,Rt.A)(t>=0),(0,Rt.A)(e>=0),(0,Rt.A)(n>=0),this.radii=new pt.A(t,e,n),this.radiiSquared=new pt.A(t*t,e*e,n*n),this.radiiToTheFourth=new pt.A(t*t*t*t,e*e*e*e,n*n*n*n),this.oneOverRadii=new pt.A(0===t?0:1/t,0===e?0:1/e,0===n?0:1/n),this.oneOverRadiiSquared=new pt.A(0===t?0:1/(t*t),0===e?0:1/(e*e),0===n?0:1/(n*n)),this.minimumRadius=Math.min(t,e,n),this.maximumRadius=Math.max(t,e,n),0!==this.radiiSquared.z&&(this.squaredXOverSquaredZ=this.radiiSquared.x/this.radiiSquared.z),Object.freeze(this)}equals(t){return this===t||Boolean(t&&this.radii.equals(t.radii))}toString(){return this.radii.toString()}cartographicToCartesian(t,e=[0,0,0]){const n=mn,r=vn,[,,i]=t;this.geodeticSurfaceNormalCartographic(t,n),r.copy(this.radiiSquared).scale(n);const o=Math.sqrt(n.dot(r));return r.scale(1/o),n.scale(i),r.add(n),r.to(e)}cartesianToCartographic(t,e=[0,0,0]){An.from(t);const n=this.scaleToGeodeticSurface(An,bn);if(!n)return;const r=this.geodeticSurfaceNormal(n,mn),i=_n;i.copy(An).subtract(n);return function(t,e,n=rn){return"longitude"in e?(e.longitude=n(t[0]),e.latitude=n(t[1]),e.height=t[2]):"x"in e?(e.x=n(t[0]),e.y=n(t[1]),e.z=t[2]):(e[0]=n(t[0]),e[1]=n(t[1]),e[2]=t[2]),e}([Math.atan2(r.y,r.x),Math.asin(r.z),Math.sign($e.Om(i,An))*$e.Bw(i)],e,ut.$W._cartographicRadians?rn:ut.xW)}eastNorthUpToFixedFrame(t,e=new lt.A){return gn(this,"east","north","up",t,e)}localFrameToFixedFrame(t,e,n,r,i=new lt.A){return gn(this,t,e,n,r,i)}geocentricSurfaceNormal(t,e=[0,0,0]){return yn.from(t).normalize().to(e)}geodeticSurfaceNormalCartographic(t,e=[0,0,0]){const n=function(t,e=[]){return function(t,e=[],n=rn){return"longitude"in t?(e[0]=n(t.longitude),e[1]=n(t.latitude),e[2]=t.height):"x"in t?(e[0]=n(t.x),e[1]=n(t.y),e[2]=t.z):(e[0]=n(t[0]),e[1]=n(t[1]),e[2]=t[2]),e}(t,e,ut.$W._cartographicRadians?rn:ut.eh)}(t),r=n[0],i=n[1],o=Math.cos(i);return yn.set(o*Math.cos(r),o*Math.sin(r),Math.sin(i)).normalize(),yn.to(e)}geodeticSurfaceNormal(t,e=[0,0,0]){return yn.from(t).scale(this.oneOverRadiiSquared).normalize().to(e)}scaleToGeodeticSurface(t,e){return function(t,e,n=[]){const{oneOverRadii:r,oneOverRadiiSquared:i,centerToleranceSquared:o}=e;on.from(t);const s=on.x,a=on.y,l=on.z,u=r.x,c=r.y,h=r.z,d=s*s*u*u,f=a*a*c*c,p=l*l*h*h,g=d+f+p,y=Math.sqrt(1/g);if(!Number.isFinite(y))return;const m=sn;if(m.copy(t).scale(y),g<o)return m.to(n);const v=i.x,b=i.y,_=i.z,A=an;A.set(m.x*v*2,m.y*b*2,m.z*_*2);let x,w,C,S,E=(1-y)*on.len()/(.5*A.len()),M=0;do{E-=M,x=1/(1+E*v),w=1/(1+E*b),C=1/(1+E*_);const t=x*x,e=w*w,n=C*C;S=d*t+f*e+p*n-1,M=S/(-2*(d*(t*x)*v+f*(e*w)*b+p*(n*C)*_))}while(Math.abs(S)>Gt.A.EPSILON12);return on.scale([x,w,C]).to(n)}(t,this,e)}scaleToGeocentricSurface(t,e=[0,0,0]){bn.from(t);const n=bn.x,r=bn.y,i=bn.z,o=this.oneOverRadiiSquared,s=1/Math.sqrt(n*n*o.x+r*r*o.y+i*i*o.z);return bn.multiplyScalar(s).to(e)}transformPositionToScaledSpace(t,e=[0,0,0]){return bn.from(t).scale(this.oneOverRadii).to(e)}transformPositionFromScaledSpace(t,e=[0,0,0]){return bn.from(t).scale(this.radii).to(e)}getSurfaceNormalIntersectionWithZAxis(t,e=0,n=[0,0,0]){(0,Rt.A)((0,ut.aI)(this.radii.x,this.radii.y,Gt.A.EPSILON15)),(0,Rt.A)(this.radii.z>0),bn.from(t);const r=bn.z*(1-this.squaredXOverSquaredZ);if(!(Math.abs(r)>=this.radii.z-e))return bn.set(0,0,r).to(n)}}(0,r.A)(xn,"WGS84",new xn(tn,en,nn));var wn=n(35520),Cn=n(16562);class Sn{constructor(t,e,n){(0,r.A)(this,"item",void 0),(0,r.A)(this,"previous",void 0),(0,r.A)(this,"next",void 0),this.item=t,this.previous=e,this.next=n}}class En{constructor(){(0,r.A)(this,"head",null),(0,r.A)(this,"tail",null),(0,r.A)(this,"_length",0)}get length(){return this._length}add(t){const e=new Sn(t,this.tail,null);return this.tail?(this.tail.next=e,this.tail=e):(this.head=e,this.tail=e),++this._length,e}remove(t){t&&(t.previous&&t.next?(t.previous.next=t.next,t.next.previous=t.previous):t.previous?(t.previous.next=null,this.tail=t.previous):t.next?(t.next.previous=null,this.head=t.next):(this.head=null,this.tail=null),t.next=null,t.previous=null,--this._length)}splice(t,e){t!==e&&(this.remove(e),this._insert(t,e))}_insert(t,e){const n=t.next;t.next=e,this.tail===t?this.tail=e:n.previous=e,e.next=n,e.previous=t,++this._length}}class Mn{constructor(){(0,r.A)(this,"_list",void 0),(0,r.A)(this,"_sentinel",void 0),(0,r.A)(this,"_trimTiles",void 0),this._list=new En,this._sentinel=this._list.add("sentinel"),this._trimTiles=!1}reset(){this._list.splice(this._list.tail,this._sentinel)}touch(t){const e=t._cacheNode;e&&this._list.splice(this._sentinel,e)}add(t,e,n){e._cacheNode||(e._cacheNode=this._list.add(e),n&&n(t,e))}unloadTile(t,e,n){const r=e._cacheNode;r&&(this._list.remove(r),e._cacheNode=null,n&&n(t,e))}unloadTiles(t,e){const n=this._trimTiles;this._trimTiles=!1;const r=this._list,i=1024*t.maximumMemoryUsage*1024,o=this._sentinel;let s=r.head;for(;s!==o&&(t.gpuMemoryUsageInBytes>i||n);){const n=s.item;s=s.next,this.unloadTile(t,n,e)}}trim(){this._trimTiles=!0}}var Pn=n(17243);const Tn=new pt.A,On=new pt.A,In=new jt([new kt,new kt,new kt,new kt,new kt,new kt]);function Rn(t,e){const{cameraDirection:n,cameraUp:r,height:i}=t,{metersPerUnit:o}=t.distanceScales,s=Ln(t,t.center),a=xn.WGS84.eastNorthUpToFixedFrame(s),l=t.unprojectPosition(t.cameraPosition),u=xn.WGS84.cartographicToCartesian(l,new pt.A),c=new pt.A(a.transformAsVector(new pt.A(n).scale(o))).normalize(),h=new pt.A(a.transformAsVector(new pt.A(r).scale(o))).normalize();!function(t){const e=t.getFrustumPlanes(),n=Bn(e.near,t.cameraPosition),r=Ln(t,n),i=Ln(t,t.cameraPosition,On);let o=0;In.planes[o++].fromPointNormal(r,Tn.copy(r).subtract(i));for(const i in e){if("near"===i)continue;const s=Ln(t,Bn(e[i],n,On),On);In.planes[o++].fromPointNormal(s,Tn.copy(r).subtract(s))}}(t);const d=t.constructor,{longitude:f,latitude:p,width:g,bearing:y,zoom:m}=t;return{camera:{position:u,direction:c,up:h},viewport:t,topDownViewport:new d({longitude:f,latitude:p,height:i,width:g,bearing:y,zoom:m,pitch:0}),height:i,cullingVolume:In,frameNumber:e,sseDenominator:1.15}}function Bn(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new pt.A;const r=t.normal.dot(e);return n.copy(t.normal).scale(t.distance-r).add(e),n}function Ln(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new pt.A;const r=t.unprojectPosition(e);return xn.WGS84.cartographicToCartesian(r,n)}const kn=6356752.314245179,Dn=new pt.A;function Fn(t,e,n){const r=xn.WGS84.cartographicToCartesian([t.xmax,t.ymax,t.zmax],new pt.A),i=Math.sqrt(Math.pow(r[0]-n[0],2)+Math.pow(r[1]-n[1],2)+Math.pow(r[2]-n[2],2));return Math.log2(kn/(i+e[2]))}var Nn=n(29645);const jn={ADD:1,REPLACE:2},Gn={EMPTY:"empty",SCENEGRAPH:"scenegraph",POINTCLOUD:"pointcloud",MESH:"mesh"},Un="I3S",zn="TILES3D",Vn="geometricError";function Hn(t){return null!=t}const qn=new pt.A,Wn=new pt.A,Jn=new pt.A,Yn=new pt.A;function Xn(t,e,n){if((0,Pn.v)(t,"3D Tile: boundingVolume must be defined"),t.box)return function(t,e,n){const r=new pt.A(t[0],t[1],t[2]);e.transform(r,r);let i=[];if(10===t.length){const e=t.slice(3,6),n=new wt.A;n.fromArray(t,6);const r=new pt.A([1,0,0]),o=new pt.A([0,1,0]),s=new pt.A([0,0,1]);r.transformByQuaternion(n),r.scale(e[0]),o.transformByQuaternion(n),o.scale(e[1]),s.transformByQuaternion(n),s.scale(e[2]),i=[...r.toArray(),...o.toArray(),...s.toArray()]}else i=[...t.slice(3,6),...t.slice(6,9),...t.slice(9,12)];const o=e.transformAsVector(i.slice(0,3)),s=e.transformAsVector(i.slice(3,6)),a=e.transformAsVector(i.slice(6,9)),l=new xt.A([o[0],o[1],o[2],s[0],s[1],s[2],a[0],a[1],a[2]]);return Hn(n)?(n.center=r,n.halfAxes=l,n):new It(r,l)}(t.box,e,n);if(t.region){const[e,n,r,i,o,s]=t.region,a=xn.WGS84.cartographicToCartesian([(0,ut.uj)(e),(0,ut.uj)(i),o],Jn),l=xn.WGS84.cartographicToCartesian([(0,ut.uj)(r),(0,ut.uj)(n),s],Yn),u=(new pt.A).addVectors(a,l).multiplyScalar(.5),c=(new pt.A).subVectors(a,l).len()/2;return Kn([u[0],u[1],u[2],c],new lt.A)}if(t.sphere)return Kn(t.sphere,e,n);throw new Error("3D Tile: boundingVolume must contain a sphere, region, or box")}function Kn(t,e,n){const r=new pt.A(t[0],t[1],t[2]);e.transform(r,r);const i=e.getScale(Wn),o=Math.max(Math.max(i[0],i[1]),i[2]),s=t[3]*o;return Hn(n)?(n.center=r,n.radius=s,n):new At(r,s)}function Zn(t,e){xn.WGS84.cartesianToCartographic(e,qn),t[0][0]=Math.min(t[0][0],qn[0]),t[0][1]=Math.min(t[0][1],qn[1]),t[0][2]=Math.min(t[0][2],qn[2]),t[1][0]=Math.max(t[1][0],qn[0]),t[1][1]=Math.max(t[1][1],qn[1]),t[1][2]=Math.max(t[1][2],qn[2])}new pt.A,new pt.A,new lt.A,new pt.A,new pt.A,new pt.A;const Qn=new pt.A,$n=new pt.A,tr=new pt.A,er=new pt.A,nr=new pt.A,rr=new lt.A,ir=new lt.A;function or(t,e){const{topDownViewport:n}=e,r=t.header.mbs[1],i=t.header.mbs[0],o=t.header.mbs[2],s=t.header.mbs[3],a=[...t.boundingVolume.center],l=n.unprojectPosition(n.cameraPosition);xn.WGS84.cartographicToCartesian(l,Qn),$n.copy(Qn).subtract(a).normalize(),xn.WGS84.eastNorthUpToFixedFrame(a,rr),ir.copy(rr).invert(),tr.copy(Qn).transform(ir);const u=Math.sqrt(tr[0]*tr[0]+tr[1]*tr[1]),c=u*u/tr[2];er.copy([tr[0],tr[1],c]);const h=er.transform(rr).subtract(a).normalize(),d=$n.cross(h).normalize().scale(s).add(a),f=xn.WGS84.cartesianToCartographic(d),p=n.project([i,r,o]),g=n.project(f);return nr.copy(p).subtract(g).magnitude()}class sr{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;(0,r.A)(this,"_map",new Map),(0,r.A)(this,"_array",void 0),(0,r.A)(this,"_length",void 0),this._array=new Array(t),this._length=t}get length(){return this._length}set length(t){this._length=t,t>this._array.length&&(this._array.length=t)}get values(){return this._array}get(t){return(0,Pn.v)(t<this._array.length),this._array[t]}set(t,e){(0,Pn.v)(t>=0),t>=this.length&&(this.length=t+1),this._map.has(this._array[t])&&this._map.delete(this._array[t]),this._array[t]=e,this._map.set(e,t)}delete(t){const e=this._map.get(t);e>=0&&(this._array.splice(e,1),this._map.delete(t),this.length--)}peek(){return this._array[this._length-1]}push(t){if(!this._map.has(t)){const e=this.length++;this._array[e]=t,this._map.set(t,e)}}pop(){const t=this._array[--this.length];return this._map.delete(t),t}reserve(t){(0,Pn.v)(t>=0),t>this._array.length&&(this._array.length=t)}resize(t){(0,Pn.v)(t>=0),this.length=t}trim(t){null==t&&(t=this.length),this._array.length=t}reset(){this._array=[],this._map=new Map,this._length=0}find(t){return this._map.has(t)}}const ar={loadSiblings:!1,skipLevelOfDetail:!1,maximumScreenSpaceError:2,updateTransforms:!0,onTraversalEnd:()=>{},viewportTraversersMap:{},basePath:""};class lr{traversalFinished(t){return!0}constructor(t){(0,r.A)(this,"options",void 0),(0,r.A)(this,"root",null),(0,r.A)(this,"selectedTiles",{}),(0,r.A)(this,"requestedTiles",{}),(0,r.A)(this,"emptyTiles",{}),(0,r.A)(this,"lastUpdate",(new Date).getTime()),(0,r.A)(this,"updateDebounceTime",1e3),(0,r.A)(this,"_traversalStack",new sr),(0,r.A)(this,"_emptyTraversalStack",new sr),(0,r.A)(this,"_frameNumber",null),this.options={...ar,...t}}traverse(t,e,n){this.root=t,this.options={...this.options,...n},this.reset(),this.updateTile(t,e),this._frameNumber=e.frameNumber,this.executeTraversal(t,e)}reset(){this.requestedTiles={},this.selectedTiles={},this.emptyTiles={},this._traversalStack.reset(),this._emptyTraversalStack.reset()}executeTraversal(t,e){const n=this._traversalStack;for(t._selectionDepth=1,n.push(t);n.length>0;){const t=n.pop();let r=!1;this.canTraverse(t,e)&&(this.updateChildTiles(t,e),r=this.updateAndPushChildren(t,e,n,t.hasRenderContent?t._selectionDepth+1:t._selectionDepth));const i=t.parent,o=Boolean(!i||i._shouldRefine),s=!r;t.hasRenderContent?t.refine===jn.ADD?(this.loadTile(t,e),this.selectTile(t,e)):t.refine===jn.REPLACE&&(this.loadTile(t,e),s&&this.selectTile(t,e)):(this.emptyTiles[t.id]=t,this.loadTile(t,e),s&&this.selectTile(t,e)),this.touchTile(t,e),t._shouldRefine=r&&o}const r=(new Date).getTime();(this.traversalFinished(e)||r-this.lastUpdate>this.updateDebounceTime)&&(this.lastUpdate=r,this.options.onTraversalEnd(e))}updateChildTiles(t,e){const n=t.children;for(const t of n)this.updateTile(t,e)}updateAndPushChildren(t,e,n,r){const{loadSiblings:i,skipLevelOfDetail:o}=this.options,s=t.children;s.sort(this.compareDistanceToCamera.bind(this));const a=t.refine===jn.REPLACE&&t.hasRenderContent&&!o;let l=!1,u=!0;for(const t of s)if(t._selectionDepth=r,t.isVisibleAndInRequestVolume?(n.find(t)&&n.delete(t),n.push(t),l=!0):(a||i)&&(this.loadTile(t,e),this.touchTile(t,e)),a){let n;if(n=!!t._inRequestVolume&&(t.hasRenderContent?t.contentAvailable:this.executeEmptyTraversal(t,e)),u=u&&n,!u)return!1}return l||(u=!1),u}updateTile(t,e){this.updateTileVisibility(t,e)}selectTile(t,e){this.shouldSelectTile(t)&&(t._selectedFrame=e.frameNumber,this.selectedTiles[t.id]=t)}loadTile(t,e){this.shouldLoadTile(t)&&(t._requestedFrame=e.frameNumber,t._priority=t._getPriority(),this.requestedTiles[t.id]=t)}touchTile(t,e){t.tileset._cache.touch(t),t._touchedFrame=e.frameNumber}canTraverse(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return!!t.hasChildren&&(t.hasTilesetContent?!t.contentExpired:!(!r&&!t.isVisibleAndInRequestVolume)&&this.shouldRefine(t,e,n))}shouldLoadTile(t){return t.hasUnloadedContent||t.contentExpired}shouldSelectTile(t){return t.contentAvailable&&!this.options.skipLevelOfDetail}shouldRefine(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=t._screenSpaceError;return n&&(r=t.getScreenSpaceError(e,!0)),r>this.options.maximumScreenSpaceError}updateTileVisibility(t,e){const n=[];if(this.options.viewportTraversersMap)for(const t in this.options.viewportTraversersMap)this.options.viewportTraversersMap[t]===e.viewport.id&&n.push(t);else n.push(e.viewport.id);t.updateVisibility(e,n)}compareDistanceToCamera(t,e){return t._distanceToCamera-e._distanceToCamera}anyChildrenVisible(t,e){let n=!1;for(const r of t.children)r.updateVisibility(e),n=n||r.isVisibleAndInRequestVolume;return n}executeEmptyTraversal(t,e){let n=!0;const r=this._emptyTraversalStack;for(r.push(t);r.length>0&&n;){const t=r.pop();if(this.updateTile(t,e),t.isVisibleAndInRequestVolume||this.loadTile(t,e),this.touchTile(t,e),!t.hasRenderContent&&this.canTraverse(t,e,!1,!0)){const e=t.children;for(const t of e)r.find(t)&&r.delete(t),r.push(t)}else t.contentAvailable||t.hasEmptyContent||(n=!1)}return n}}const ur=new pt.A;class cr{constructor(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";(0,r.A)(this,"tileset",void 0),(0,r.A)(this,"header",void 0),(0,r.A)(this,"id",void 0),(0,r.A)(this,"url",void 0),(0,r.A)(this,"parent",void 0),(0,r.A)(this,"refine",void 0),(0,r.A)(this,"type",void 0),(0,r.A)(this,"contentUrl",void 0),(0,r.A)(this,"lodMetricType","geometricError"),(0,r.A)(this,"lodMetricValue",0),(0,r.A)(this,"boundingVolume",null),(0,r.A)(this,"content",null),(0,r.A)(this,"contentState",0),(0,r.A)(this,"gpuMemoryUsageInBytes",0),(0,r.A)(this,"children",[]),(0,r.A)(this,"depth",0),(0,r.A)(this,"viewportIds",[]),(0,r.A)(this,"transform",new lt.A),(0,r.A)(this,"extensions",null),(0,r.A)(this,"implicitTiling",null),(0,r.A)(this,"userData",{}),(0,r.A)(this,"computedTransform",void 0),(0,r.A)(this,"hasEmptyContent",!1),(0,r.A)(this,"hasTilesetContent",!1),(0,r.A)(this,"traverser",new lr({})),(0,r.A)(this,"_cacheNode",null),(0,r.A)(this,"_frameNumber",null),(0,r.A)(this,"_expireDate",null),(0,r.A)(this,"_expiredContent",null),(0,r.A)(this,"_boundingBox",void 0),(0,r.A)(this,"_distanceToCamera",0),(0,r.A)(this,"_screenSpaceError",0),(0,r.A)(this,"_visibilityPlaneMask",void 0),(0,r.A)(this,"_visible",void 0),(0,r.A)(this,"_contentBoundingVolume",void 0),(0,r.A)(this,"_viewerRequestVolume",void 0),(0,r.A)(this,"_initialTransform",new lt.A),(0,r.A)(this,"_priority",0),(0,r.A)(this,"_selectedFrame",0),(0,r.A)(this,"_requestedFrame",0),(0,r.A)(this,"_selectionDepth",0),(0,r.A)(this,"_touchedFrame",0),(0,r.A)(this,"_centerZDepth",0),(0,r.A)(this,"_shouldRefine",!1),(0,r.A)(this,"_stackLength",0),(0,r.A)(this,"_visitedFrame",0),(0,r.A)(this,"_inRequestVolume",!1),(0,r.A)(this,"_lodJudge",null),this.header=e,this.tileset=t,this.id=i||e.id,this.url=e.url,this.parent=n,this.refine=this._getRefine(e.refine),this.type=e.type,this.contentUrl=e.contentUrl,this._initializeLodMetric(e),this._initializeTransforms(e),this._initializeBoundingVolumes(e),this._initializeContent(e),this._initializeRenderingState(e),Object.seal(this)}destroy(){this.header=null}isDestroyed(){return null===this.header}get selected(){return this._selectedFrame===this.tileset._frameNumber}get isVisible(){return this._visible}get isVisibleAndInRequestVolume(){return this._visible&&this._inRequestVolume}get hasRenderContent(){return!this.hasEmptyContent&&!this.hasTilesetContent}get hasChildren(){return this.children.length>0||this.header.children&&this.header.children.length>0}get contentReady(){return 3===this.contentState||this.hasEmptyContent}get contentAvailable(){return Boolean(this.contentReady&&this.hasRenderContent||this._expiredContent&&!this.contentFailed)}get hasUnloadedContent(){return this.hasRenderContent&&this.contentUnloaded}get contentUnloaded(){return 0===this.contentState}get contentExpired(){return 4===this.contentState}get contentFailed(){return 5===this.contentState}get distanceToCamera(){return this._distanceToCamera}get screenSpaceError(){return this._screenSpaceError}get boundingBox(){return this._boundingBox||(this._boundingBox=function(t,e){if(t.box)return function(t){const e=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],{halfAxes:n}=t,r=new pt.A(n.getColumn(0)),i=new pt.A(n.getColumn(1)),o=new pt.A(n.getColumn(2));for(let n=0;n<2;n++){for(let n=0;n<2;n++){for(let n=0;n<2;n++)qn.copy(t.center),qn.add(r),qn.add(i),qn.add(o),Zn(e,qn),o.negate();i.negate()}r.negate()}return e}(e);if(t.region){const[e,n,r,i,o,s]=t.region;return[[(0,ut.uj)(e),(0,ut.uj)(n),o],[(0,ut.uj)(r),(0,ut.uj)(i),s]]}if(t.sphere)return function(t){const e=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],{center:n,radius:r}=t,i=xn.WGS84.scaleToGeodeticSurface(n,qn);let o;o=i?xn.WGS84.geodeticSurfaceNormal(i):new pt.A(0,0,1);let s=new pt.A(o[2],-o[1],0);s.len()>0?s.normalize():s=new pt.A(0,1,0);const a=s.clone().cross(o);for(const t of[s,a,o]){Wn.copy(t).scale(r);for(let t=0;t<2;t++)qn.copy(n),qn.add(Wn),Zn(e,qn),Wn.negate()}return e}(e);throw new Error("Unkown boundingVolume type")}(this.header.boundingVolume,this.boundingVolume)),this._boundingBox}getScreenSpaceError(t,e){switch(this.tileset.type){case Un:return or(this,t);case zn:return function(t,e,n){const r=t.tileset,i=t.parent&&t.parent.lodMetricValue||t.lodMetricValue,o=n?i:t.lodMetricValue;if(0===o)return 0;const s=Math.max(t._distanceToCamera,1e-7),{height:a,sseDenominator:l}=e,{viewDistanceScale:u}=r.options;let c=o*a*(u||1)/(s*l);return c-=function(t,e){if(t.dynamicScreenSpaceError&&t.dynamicScreenSpaceErrorComputedDensity){const n=t.dynamicScreenSpaceErrorComputedDensity,r=t.dynamicScreenSpaceErrorFactor,i=function(t,e){const n=t*e;return 1-Math.exp(-n*n)}(e,n)*r;return i}return 0}(r,s),c}(this,t,e);default:throw new Error("Unsupported tileset type")}}unselect(){this._selectedFrame=0}_getGpuMemoryUsageInBytes(){return this.content.gpuMemoryUsageInBytes||this.content.byteLength||0}_getPriority(){const t=this.tileset._traverser,{skipLevelOfDetail:e}=t.options,n=this.refine===jn.ADD||e;if(n&&!this.isVisible&&void 0!==this._visible)return-1;if(this.tileset._frameNumber-this._touchedFrame>=1)return-1;if(0===this.contentState)return-1;const r=this.parent,i=!r||n&&0!==this._screenSpaceError&&!r.hasTilesetContent?this._screenSpaceError:r._screenSpaceError,o=t.root?t.root._screenSpaceError:0;return Math.max(o-i,0)}async loadContent(){if(this.hasEmptyContent)return!1;if(this.content)return!0;this.contentExpired&&(this._expireDate=null),this.contentState=1;const t=await this.tileset._requestScheduler.scheduleRequest(this.id,this._getPriority.bind(this));if(!t)return this.contentState=0,!1;try{const t=this.tileset.getTileUrl(this.contentUrl),e=this.tileset.loader,n={...this.tileset.loadOptions,[e.id]:{...this.tileset.loadOptions[e.id],isTileset:"json"===this.type,...this._getLoaderSpecificOptions(e.id)}};return this.content=await(0,Nn.load)(t,e,n),this.tileset.options.contentLoader&&await this.tileset.options.contentLoader(this),this._isTileset()&&this.tileset._initializeTileHeaders(this.content,this),this.contentState=3,this._onContentLoaded(),!0}catch(t){throw this.contentState=5,t}finally{t.done()}}unloadContent(){return this.content&&this.content.destroy&&this.content.destroy(),this.content=null,this.header.content&&this.header.content.destroy&&this.header.content.destroy(),this.header.content=null,this.contentState=0,!0}updateVisibility(t,e){if(this._frameNumber===t.frameNumber)return;const n=this.parent,r=n?n._visibilityPlaneMask:jt.MASK_INDETERMINATE;if(this.tileset._traverser.options.updateTransforms){const t=n?n.computedTransform:this.tileset.modelMatrix;this._updateTransform(t)}this._distanceToCamera=this.distanceToTile(t),this._screenSpaceError=this.getScreenSpaceError(t,!1),this._visibilityPlaneMask=this.visibility(t,r),this._visible=this._visibilityPlaneMask!==jt.MASK_OUTSIDE,this._inRequestVolume=this.insideViewerRequestVolume(t),this._frameNumber=t.frameNumber,this.viewportIds=e}visibility(t,e){const{cullingVolume:n}=t,{boundingVolume:r}=this;return n.computeVisibilityWithPlaneMask(r,e)}contentVisibility(){return!0}distanceToTile(t){const e=this.boundingVolume;return Math.sqrt(Math.max(e.distanceSquaredTo(t.camera.position),0))}cameraSpaceZDepth(t){let{camera:e}=t;const n=this.boundingVolume;return ur.subVectors(n.center,e.position),e.direction.dot(ur)}insideViewerRequestVolume(t){const e=this._viewerRequestVolume;return!e||e.distanceSquaredTo(t.camera.position)<=0}updateExpiration(){if(function(t){return null!=t}(this._expireDate)&&this.contentReady&&!this.hasEmptyContent){const t=Date.now();Date.lessThan(this._expireDate,t)&&(this.contentState=4,this._expiredContent=this.content)}}get extras(){return this.header.extras}_initializeLodMetric(t){"lodMetricType"in t?this.lodMetricType=t.lodMetricType:(this.lodMetricType=this.parent&&this.parent.lodMetricType||this.tileset.lodMetricType,console.warn("3D Tile: Required prop lodMetricType is undefined. Using parent lodMetricType")),"lodMetricValue"in t?this.lodMetricValue=t.lodMetricValue:(this.lodMetricValue=this.parent&&this.parent.lodMetricValue||this.tileset.lodMetricValue,console.warn("3D Tile: Required prop lodMetricValue is undefined. Using parent lodMetricValue"))}_initializeTransforms(t){this.transform=t.transform?new lt.A(t.transform):new lt.A;const e=this.parent,n=this.tileset,r=e&&e.computedTransform?e.computedTransform.clone():n.modelMatrix.clone();this.computedTransform=new lt.A(r).multiplyRight(this.transform);const i=e&&e._initialTransform?e._initialTransform.clone():new lt.A;this._initialTransform=new lt.A(i).multiplyRight(this.transform)}_initializeBoundingVolumes(t){this._contentBoundingVolume=null,this._viewerRequestVolume=null,this._updateBoundingVolume(t)}_initializeContent(t){this.content={_tileset:this.tileset,_tile:this},this.hasEmptyContent=!0,this.contentState=0,this.hasTilesetContent=!1,t.contentUrl&&(this.content=null,this.hasEmptyContent=!1)}_initializeRenderingState(t){this.depth=t.level||(this.parent?this.parent.depth+1:0),this._shouldRefine=!1,this._distanceToCamera=0,this._centerZDepth=0,this._screenSpaceError=0,this._visibilityPlaneMask=jt.MASK_INDETERMINATE,this._visible=void 0,this._inRequestVolume=!1,this._stackLength=0,this._selectionDepth=0,this._frameNumber=0,this._touchedFrame=0,this._visitedFrame=0,this._selectedFrame=0,this._requestedFrame=0,this._priority=0}_getRefine(t){return t||this.parent&&this.parent.refine||jn.REPLACE}_isTileset(){return-1!==this.contentUrl.indexOf(".json")}_onContentLoaded(){switch(this.content&&this.content.type){case"vctr":case"geom":this.tileset._traverser.disableSkipLevelOfDetail=!0}this._isTileset()?this.hasTilesetContent=!0:this.gpuMemoryUsageInBytes=this._getGpuMemoryUsageInBytes()}_updateBoundingVolume(t){this.boundingVolume=Xn(t.boundingVolume,this.computedTransform,this.boundingVolume);const e=t.content;e&&(e.boundingVolume&&(this._contentBoundingVolume=Xn(e.boundingVolume,this.computedTransform,this._contentBoundingVolume)),t.viewerRequestVolume&&(this._viewerRequestVolume=Xn(t.viewerRequestVolume,this.computedTransform,this._viewerRequestVolume)))}_updateTransform(){const t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:new lt.A).clone().multiplyRight(this.transform);!t.equals(this.computedTransform)&&(this.computedTransform=t,this._updateBoundingVolume(this.header))}_getLoaderSpecificOptions(t){return"i3s"===t?{...this.tileset.options.i3s,_tileOptions:{attributeUrls:this.header.attributeUrls,textureUrl:this.header.textureUrl,textureFormat:this.header.textureFormat,textureLoaderOptions:this.header.textureLoaderOptions,materialDefinition:this.header.materialDefinition,isDracoGeometry:this.header.isDracoGeometry,mbs:this.header.mbs},_tilesetOptions:{store:this.tileset.tileset.store,attributeStorageInfo:this.tileset.tileset.attributeStorageInfo,fields:this.tileset.tileset.fields},isTileHeader:!1}:{assetGltfUpAxis:(e=this.tileset.tileset).asset&&e.asset.gltfUpAxis||"Y"};var e}}class hr extends lr{compareDistanceToCamera(t,e){return 0===e._distanceToCamera&&0===t._distanceToCamera?e._centerZDepth-t._centerZDepth:e._distanceToCamera-t._distanceToCamera}updateTileVisibility(t,e){if(super.updateTileVisibility(t,e),!t.isVisibleAndInRequestVolume)return;const n=t.children.length>0;if(t.hasTilesetContent&&n){const n=t.children[0];return this.updateTileVisibility(n,e),void(t._visible=n._visible)}if(this.meetsScreenSpaceErrorEarly(t,e))return void(t._visible=!1);const r=t.refine===jn.REPLACE,i=1===t._optimChildrenWithinParent;r&&i&&n&&!this.anyChildrenVisible(t,e)&&(t._visible=!1)}meetsScreenSpaceErrorEarly(t,e){const{parent:n}=t;return!(!n||n.hasTilesetContent||n.refine!==jn.ADD||this.shouldRefine(t,e,!0))}}class dr{constructor(){(0,r.A)(this,"frameNumberMap",new Map)}register(t,e){const n=this.frameNumberMap.get(t)||new Map,r=n.get(e)||0;n.set(e,r+1),this.frameNumberMap.set(t,n)}deregister(t,e){const n=this.frameNumberMap.get(t);if(!n)return;const r=n.get(e)||1;n.set(e,r-1)}isZero(t,e){var n;return 0===((null===(n=this.frameNumberMap.get(t))||void 0===n?void 0:n.get(e))||0)}}class fr{constructor(){(0,r.A)(this,"_statusMap",void 0),(0,r.A)(this,"pendingTilesRegister",new dr),this._statusMap={}}add(t,e,n,r){if(!this._statusMap[e]){const{frameNumber:i,viewport:{id:o}}=r;this._statusMap[e]={request:t,callback:n,key:e,frameState:r,status:"REQUESTED"},this.pendingTilesRegister.register(o,i),t().then((t=>{this._statusMap[e].status="COMPLETED";const{frameNumber:n,viewport:{id:i}}=this._statusMap[e].frameState;this.pendingTilesRegister.deregister(i,n),this._statusMap[e].callback(t,r)})).catch((t=>{this._statusMap[e].status="ERROR";const{frameNumber:r,viewport:{id:i}}=this._statusMap[e].frameState;this.pendingTilesRegister.deregister(i,r),n(t)}))}}update(t,e){if(this._statusMap[t]){const{frameNumber:n,viewport:{id:r}}=this._statusMap[t].frameState;this.pendingTilesRegister.deregister(r,n);const{frameNumber:i,viewport:{id:o}}=e;this.pendingTilesRegister.register(o,i),this._statusMap[t].frameState=e}}find(t){return this._statusMap[t]}hasPendingTiles(t,e){return!this.pendingTilesRegister.isZero(t,e)}}class pr extends lr{constructor(t){super(t),(0,r.A)(this,"_tileManager",void 0),this._tileManager=new fr}traversalFinished(t){return!this._tileManager.hasPendingTiles(t.viewport.id,this._frameNumber||0)}shouldRefine(t,e){return t._lodJudge=function(t,e){if(0===t.lodMetricValue||isNaN(t.lodMetricValue))return"DIG";const n=2*or(t,e);return n<2?"OUT":!t.header.children||n<=t.lodMetricValue?"DRAW":t.header.children?"DIG":"OUT"}(t,e),"DIG"===t._lodJudge}updateChildTiles(t,e){const n=t.header.children||[],r=t.children,i=t.tileset;for(const o of n){const n="".concat(o.id,"-").concat(e.viewport.id),s=r&&r.find((t=>t.id===n));if(s)s&&this.updateTile(s,e);else{let r=()=>this._loadTile(o.id,i);this._tileManager.find(n)?this._tileManager.update(n,e):(i.tileset.nodePages&&(r=()=>i.tileset.nodePagesTile.formTileFromNodePages(o.id)),this._tileManager.add(r,n,(e=>this._onTileLoad(e,t,n)),e))}}return!1}async _loadTile(t,e){const{loader:n}=e,r=e.getTileUrl("".concat(e.url,"/nodes/").concat(t)),i={...e.loadOptions,i3s:{...e.loadOptions.i3s,isTileHeader:!0}};return await(0,Nn.load)(r,n,i)}_onTileLoad(t,e,n){const r=new cr(e.tileset,t,e,n);e.children.push(r);const i=this._tileManager.find(r.id).frameState;this.updateTile(r,i),this._frameNumber===i.frameNumber&&(this.traversalFinished(i)||(new Date).getTime()-this.lastUpdate>this.updateDebounceTime)&&this.executeTraversal(r,i)}}const gr={description:"",ellipsoid:xn.WGS84,modelMatrix:new lt.A,throttleRequests:!0,maxRequests:64,maximumMemoryUsage:32,maximumTilesSelected:0,debounceTime:0,onTileLoad:()=>{},onTileUnload:()=>{},onTileError:()=>{},onTraversalComplete:t=>t,contentLoader:void 0,viewDistanceScale:1,maximumScreenSpaceError:8,loadTiles:!0,updateTransforms:!0,viewportTraversersMap:null,loadOptions:{fetch:{}},attributions:[],basePath:"",i3s:{}},yr="Tiles In Tileset(s)",mr="Tiles In Memory",vr="Tiles In View",br="Tiles To Render",_r="Tiles Loaded",Ar="Tiles Loading",xr="Tiles Unloaded",wr="Failed Tile Loads",Cr="Points/Vertices",Sr="Tile Memory Use";class Er{constructor(t,e){(0,r.A)(this,"options",void 0),(0,r.A)(this,"loadOptions",void 0),(0,r.A)(this,"type",void 0),(0,r.A)(this,"tileset",void 0),(0,r.A)(this,"loader",void 0),(0,r.A)(this,"url",void 0),(0,r.A)(this,"basePath",void 0),(0,r.A)(this,"modelMatrix",void 0),(0,r.A)(this,"ellipsoid",void 0),(0,r.A)(this,"lodMetricType",void 0),(0,r.A)(this,"lodMetricValue",void 0),(0,r.A)(this,"refine",void 0),(0,r.A)(this,"root",null),(0,r.A)(this,"roots",{}),(0,r.A)(this,"asset",{}),(0,r.A)(this,"description",""),(0,r.A)(this,"properties",void 0),(0,r.A)(this,"extras",null),(0,r.A)(this,"attributions",{}),(0,r.A)(this,"credits",{}),(0,r.A)(this,"stats",void 0),(0,r.A)(this,"contentFormats",{draco:!1,meshopt:!1,dds:!1,ktx2:!1}),(0,r.A)(this,"cartographicCenter",null),(0,r.A)(this,"cartesianCenter",null),(0,r.A)(this,"zoom",1),(0,r.A)(this,"boundingVolume",null),(0,r.A)(this,"dynamicScreenSpaceErrorComputedDensity",0),(0,r.A)(this,"maximumMemoryUsage",32),(0,r.A)(this,"gpuMemoryUsageInBytes",0),(0,r.A)(this,"_frameNumber",0),(0,r.A)(this,"_queryParams",{}),(0,r.A)(this,"_extensionsUsed",[]),(0,r.A)(this,"_tiles",{}),(0,r.A)(this,"_pendingCount",0),(0,r.A)(this,"selectedTiles",[]),(0,r.A)(this,"traverseCounter",0),(0,r.A)(this,"geometricError",0),(0,r.A)(this,"lastUpdatedVieports",null),(0,r.A)(this,"_requestedTiles",[]),(0,r.A)(this,"_emptyTiles",[]),(0,r.A)(this,"frameStateData",{}),(0,r.A)(this,"_traverser",void 0),(0,r.A)(this,"_cache",new Mn),(0,r.A)(this,"_requestScheduler",void 0),(0,r.A)(this,"updatePromise",null),(0,r.A)(this,"tilesetInitializationPromise",void 0),this.options={...gr,...e},this.tileset=t,this.loader=t.loader,this.type=t.type,this.url=t.url,this.basePath=t.basePath||Cn.pD(this.url),this.modelMatrix=this.options.modelMatrix,this.ellipsoid=this.options.ellipsoid,this.lodMetricType=t.lodMetricType,this.lodMetricValue=t.lodMetricValue,this.refine=t.root.refine,this.loadOptions=this.options.loadOptions||{},this._traverser=this._initializeTraverser(),this._requestScheduler=new at.A({throttleRequests:this.options.throttleRequests,maxRequests:this.options.maxRequests}),this.stats=new wn.Uz({id:this.url}),this._initializeStats(),this.tilesetInitializationPromise=this._initializeTileSet(t)}destroy(){this._destroy()}isLoaded(){return 0===this._pendingCount&&0!==this._frameNumber&&0===this._requestedTiles.length}get tiles(){return Object.values(this._tiles)}get frameNumber(){return this._frameNumber}get queryParams(){return new URLSearchParams(this._queryParams).toString()}setProps(t){this.options={...this.options,...t}}setOptions(t){this.options={...this.options,...t}}getTileUrl(t){return t.startsWith("data:")?t:"".concat(t).concat(t.includes("?")?"&":"?").concat(this.queryParams)}hasExtension(t){return Boolean(this._extensionsUsed.indexOf(t)>-1)}update(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.tilesetInitializationPromise.then((()=>{!t&&this.lastUpdatedVieports?t=this.lastUpdatedVieports:this.lastUpdatedVieports=t,t&&this.doUpdate(t)}))}async selectTiles(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return await this.tilesetInitializationPromise,t&&(this.lastUpdatedVieports=t),this.updatePromise||(this.updatePromise=new Promise((t=>{setTimeout((()=>{this.lastUpdatedVieports&&this.doUpdate(this.lastUpdatedVieports),t(this._frameNumber),this.updatePromise=null}),this.options.debounceTime)}))),this.updatePromise}doUpdate(t){if("loadTiles"in this.options&&!this.options.loadTiles)return;if(this.traverseCounter>0)return;const e=t instanceof Array?t:[t];this._cache.reset(),this._frameNumber++,this.traverseCounter=e.length;const n=[];for(const t of e){const e=t.id;this._needTraverse(e)?n.push(e):this.traverseCounter--}for(const t of e){const e=t.id;if(this.roots[e]||(this.roots[e]=this._initializeTileHeaders(this.tileset,null)),!n.includes(e))continue;const r=Rn(t,this._frameNumber);this._traverser.traverse(this.roots[e],r,this.options)}}_needTraverse(t){let e=t;return this.options.viewportTraversersMap&&(e=this.options.viewportTraversersMap[t]),e===t}_onTraversalEnd(t){const e=t.viewport.id;this.frameStateData[e]||(this.frameStateData[e]={selectedTiles:[],_requestedTiles:[],_emptyTiles:[]});const n=this.frameStateData[e],r=Object.values(this._traverser.selectedTiles),[i,o]=function(t,e,n){if(0===n||t.length<=n)return[t,[]];const r=[],{longitude:i,latitude:o}=e.viewport;for(const[e,n]of t.entries()){const[t,s]=n.header.mbs,a=Math.abs(i-t),l=Math.abs(o-s),u=Math.sqrt(l*l+a*a);r.push([e,u])}const s=r.sort(((t,e)=>t[1]-e[1])),a=[];for(let e=0;e<n;e++)a.push(t[s[e][0]]);const l=[];for(let e=n;e<s.length;e++)l.push(t[s[e][0]]);return[a,l]}(r,t,this.options.maximumTilesSelected);n.selectedTiles=i;for(const t of o)t.unselect();n._requestedTiles=Object.values(this._traverser.requestedTiles),n._emptyTiles=Object.values(this._traverser.emptyTiles),this.traverseCounter--,this.traverseCounter>0||this._updateTiles()}_updateTiles(){this.selectedTiles=[],this._requestedTiles=[],this._emptyTiles=[];for(const t in this.frameStateData){const e=this.frameStateData[t];this.selectedTiles=this.selectedTiles.concat(e.selectedTiles),this._requestedTiles=this._requestedTiles.concat(e._requestedTiles),this._emptyTiles=this._emptyTiles.concat(e._emptyTiles)}this.selectedTiles=this.options.onTraversalComplete(this.selectedTiles);for(const t of this.selectedTiles)this._tiles[t.id]=t;this._loadTiles(),this._unloadTiles(),this._updateStats()}_tilesChanged(t,e){if(t.length!==e.length)return!0;const n=new Set(t.map((t=>t.id))),r=new Set(e.map((t=>t.id)));let i=t.filter((t=>!r.has(t.id))).length>0;return i=i||e.filter((t=>!n.has(t.id))).length>0,i}_loadTiles(){for(const t of this._requestedTiles)t.contentUnloaded&&this._loadTile(t)}_unloadTiles(){this._cache.unloadTiles(this,((t,e)=>t._unloadTile(e)))}_updateStats(){let t=0,e=0;for(const n of this.selectedTiles)n.contentAvailable&&n.content&&(t++,n.content.pointCount?e+=n.content.pointCount:e+=n.content.vertexCount);this.stats.get(vr).count=this.selectedTiles.length,this.stats.get(br).count=t,this.stats.get(Cr).count=e}async _initializeTileSet(t){this.type===Un&&(this.calculateViewPropsI3S(),t.root=await t.root),this.root=this._initializeTileHeaders(t,null),this.type===zn&&(this._initializeTiles3DTileset(t),this.calculateViewPropsTiles3D()),this.type===Un&&this._initializeI3STileset()}calculateViewPropsI3S(){var t;const e=this.tileset.fullExtent;if(e){const{xmin:t,xmax:n,ymin:r,ymax:i,zmin:o,zmax:s}=e;return this.cartographicCenter=new pt.A(t+(n-t)/2,r+(i-r)/2,o+(s-o)/2),this.cartesianCenter=xn.WGS84.cartographicToCartesian(this.cartographicCenter,new pt.A),void(this.zoom=Fn(e,this.cartographicCenter,this.cartesianCenter))}const n=null===(t=this.tileset.store)||void 0===t?void 0:t.extent;if(n){const[t,e,r,i]=n;return this.cartographicCenter=new pt.A(t+(r-t)/2,e+(i-e)/2,0),this.cartesianCenter=xn.WGS84.cartographicToCartesian(this.cartographicCenter,new pt.A),void(this.zoom=function(t,e,n){const[r,i,o,s]=t;return Fn({xmin:r,xmax:o,ymin:i,ymax:s,zmin:0,zmax:0},e,n)}(n,this.cartographicCenter,this.cartesianCenter))}console.warn("Extent is not defined in the tileset header"),this.cartographicCenter=new pt.A,this.zoom=1}calculateViewPropsTiles3D(){const t=this.root,{center:e}=t.boundingVolume;if(!e)return console.warn("center was not pre-calculated for the root tile"),this.cartographicCenter=new pt.A,void(this.zoom=1);0!==e[0]||0!==e[1]||0!==e[2]?this.cartographicCenter=xn.WGS84.cartesianToCartographic(e,new pt.A):this.cartographicCenter=new pt.A(0,0,-xn.WGS84.radii[0]),this.cartesianCenter=e,this.zoom=function(t,e){if(t instanceof It){const{halfAxes:n}=t,r=function(t){t.getColumn(0,Dn);const e=t.getColumn(1),n=t.getColumn(2);return Dn.add(e).add(n).len()}(n);return Math.log2(kn/(r+e[2]))}if(t instanceof At){const{radius:n}=t;return Math.log2(kn/(n+e[2]))}if(t.width&&t.height){const{width:e,height:n}=t;return(Math.log2(6378137/e)+Math.log2(6378137/n))/2}return 1}(t.boundingVolume,this.cartographicCenter)}_initializeStats(){this.stats.get(yr),this.stats.get(Ar),this.stats.get(mr),this.stats.get(vr),this.stats.get(br),this.stats.get(_r),this.stats.get(xr),this.stats.get(wr),this.stats.get(Cr),this.stats.get(Sr,"memory")}_initializeTileHeaders(t,e){const n=new cr(this,t.root,e);if(e&&(e.children.push(n),n.depth=e.depth+1),this.type===zn){const t=[];for(t.push(n);t.length>0;){const e=t.pop();this.stats.get(yr).incrementCount();const n=e.header.children||[];for(const i of n){var r;const n=new cr(this,i,e);if(null!==(r=n.contentUrl)&&void 0!==r&&r.includes("?session=")){const t=new URL(n.contentUrl).searchParams.get("session");t&&(this._queryParams.session=t)}e.children.push(n),n.depth=e.depth+1,t.push(n)}}}return n}_initializeTraverser(){let t;switch(this.type){case zn:t=hr;break;case Un:t=pr;break;default:t=lr}return new t({basePath:this.basePath,onTraversalEnd:this._onTraversalEnd.bind(this)})}_destroyTileHeaders(t){this._destroySubtree(t)}async _loadTile(t){let e;try{this._onStartTileLoading(),e=await t.loadContent()}catch(e){this._onTileLoadError(t,e instanceof Error?e:new Error("load failed"))}finally{this._onEndTileLoading(),this._onTileLoad(t,e)}}_onTileLoadError(t,e){this.stats.get(wr).incrementCount();const n=e.message||e.toString(),r=t.url;console.error("A 3D tile failed to load: ".concat(t.url," ").concat(n)),this.options.onTileError(t,n,r)}_onTileLoad(t,e){if(e){if(this.type===Un){var n,r;const t=(null===(n=this.tileset)||void 0===n||null===(r=n.nodePagesTile)||void 0===r?void 0:r.nodesInNodePages)||0;this.stats.get(yr).reset(),this.stats.get(yr).addCount(t)}t&&t.content&&function(t,e){(0,Pn.v)(t),(0,Pn.v)(e);const{rtcCenter:n,gltfUpAxis:r}=e,{computedTransform:i,boundingVolume:{center:o}}=t;let s=new lt.A(i);switch(n&&s.translate(n),r){case"Z":default:break;case"Y":const t=(new lt.A).rotateX(Math.PI/2);s=s.multiplyRight(t);break;case"X":const e=(new lt.A).rotateY(-Math.PI/2);s=s.multiplyRight(e)}e.isQuantized&&s.translate(e.quantizedVolumeOffset).scale(e.quantizedVolumeScale);const a=new pt.A(o);e.cartesianModelMatrix=s,e.cartesianOrigin=a;const l=xn.WGS84.cartesianToCartographic(a,new pt.A),u=xn.WGS84.eastNorthUpToFixedFrame(a).invert();e.cartographicModelMatrix=u.multiplyRight(s),e.cartographicOrigin=l,e.coordinateSystem||(e.modelMatrix=e.cartographicModelMatrix)}(t,t.content),this.updateContentTypes(t),this._addTileToCache(t),this.options.onTileLoad(t)}}updateContentTypes(t){if(this.type===Un)switch(t.header.isDracoGeometry&&(this.contentFormats.draco=!0),t.header.textureFormat){case"dds":this.contentFormats.dds=!0;break;case"ktx2":this.contentFormats.ktx2=!0}else if(this.type===zn){var e;const{extensionsRemoved:n=[]}=(null===(e=t.content)||void 0===e?void 0:e.gltf)||{};n.includes("KHR_draco_mesh_compression")&&(this.contentFormats.draco=!0),n.includes("EXT_meshopt_compression")&&(this.contentFormats.meshopt=!0),n.includes("KHR_texture_basisu")&&(this.contentFormats.ktx2=!0)}}_onStartTileLoading(){this._pendingCount++,this.stats.get(Ar).incrementCount()}_onEndTileLoading(){this._pendingCount--,this.stats.get(Ar).decrementCount()}_addTileToCache(t){this._cache.add(this,t,(e=>e._updateCacheStats(t)))}_updateCacheStats(t){this.stats.get(_r).incrementCount(),this.stats.get(mr).incrementCount(),this.gpuMemoryUsageInBytes+=t.gpuMemoryUsageInBytes||0,this.stats.get(Sr).count=this.gpuMemoryUsageInBytes}_unloadTile(t){this.gpuMemoryUsageInBytes-=t.gpuMemoryUsageInBytes||0,this.stats.get(mr).decrementCount(),this.stats.get(xr).incrementCount(),this.stats.get(Sr).count=this.gpuMemoryUsageInBytes,this.options.onTileUnload(t),t.unloadContent()}_destroy(){const t=[];for(this.root&&t.push(this.root);t.length>0;){const e=t.pop();for(const n of e.children)t.push(n);this._destroyTile(e)}this.root=null}_destroySubtree(t){const e=t,n=[];for(n.push(e);n.length>0;){t=n.pop();for(const e of t.children)n.push(e);t!==e&&this._destroyTile(t)}e.children=[]}_destroyTile(t){this._cache.unloadTile(this,t),this._unloadTile(t),t.destroy()}_initializeTiles3DTileset(t){if(t.queryString){const e=new URLSearchParams(t.queryString),n=Object.fromEntries(e.entries());this._queryParams={...this._queryParams,...n}}if(this.asset=t.asset,!this.asset)throw new Error("Tileset must have an asset property.");if("0.0"!==this.asset.version&&"1.0"!==this.asset.version)throw new Error("The tileset must be 3D Tiles version 0.0 or 1.0.");"tilesetVersion"in this.asset&&(this._queryParams.v=this.asset.tilesetVersion),this.credits={attributions:this.options.attributions||[]},this.description=this.options.description||"",this.properties=t.properties,this.geometricError=t.geometricError,this._extensionsUsed=t.extensionsUsed||[],this.extras=t.extras}_initializeI3STileset(){this.loadOptions.i3s&&"token"in this.loadOptions.i3s&&(this._queryParams.token=this.loadOptions.i3s.token)}}const Mr="3.4.15",Pr={COMPOSITE:"cmpt",POINT_CLOUD:"pnts",BATCHED_3D_MODEL:"b3dm",INSTANCED_3D_MODEL:"i3dm",GEOMETRY:"geom",VECTOR:"vect",GLTF:"glTF"};function Tr(t,e,n){(0,Pn.v)(t instanceof ArrayBuffer);const r=new TextDecoder("utf8"),i=new Uint8Array(t,e,n);return r.decode(i)}Object.keys(Pr);var Or=n(22308);const Ir={BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DOUBLE:5130},Rr={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,...Ir},Br={[Ir.DOUBLE]:Float64Array,[Ir.FLOAT]:Float32Array,[Ir.UNSIGNED_SHORT]:Uint16Array,[Ir.UNSIGNED_INT]:Uint32Array,[Ir.UNSIGNED_BYTE]:Uint8Array,[Ir.BYTE]:Int8Array,[Ir.SHORT]:Int16Array,[Ir.INT]:Int32Array},Lr={DOUBLE:Ir.DOUBLE,FLOAT:Ir.FLOAT,UNSIGNED_SHORT:Ir.UNSIGNED_SHORT,UNSIGNED_INT:Ir.UNSIGNED_INT,UNSIGNED_BYTE:Ir.UNSIGNED_BYTE,BYTE:Ir.BYTE,SHORT:Ir.SHORT,INT:Ir.INT},kr="Failed to convert GL type";class Dr{static fromTypedArray(t){t=ArrayBuffer.isView(t)?t.constructor:t;for(const e in Br)if(Br[e]===t)return e;throw new Error(kr)}static fromName(t){const e=Lr[t];if(!e)throw new Error(kr);return e}static getArrayType(t){switch(t){case Ir.UNSIGNED_SHORT_5_6_5:case Ir.UNSIGNED_SHORT_4_4_4_4:case Ir.UNSIGNED_SHORT_5_5_5_1:return Uint16Array;default:const e=Br[t];if(!e)throw new Error(kr);return e}}static getByteSize(t){return Dr.getArrayType(t).BYTES_PER_ELEMENT}static validate(t){return Boolean(Dr.getArrayType(t))}static createTypedArray(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3?arguments[3]:void 0;return void 0===r&&(r=(e.byteLength-n)/Dr.getByteSize(t)),new(Dr.getArrayType(t))(e,n,r)}}class Fr{constructor(t,e){(0,r.A)(this,"json",void 0),(0,r.A)(this,"buffer",void 0),(0,r.A)(this,"featuresLength",0),(0,r.A)(this,"_cachedTypedArrays",{}),this.json=t,this.buffer=e}getExtension(t){return this.json.extensions&&this.json.extensions[t]}hasProperty(t){return Boolean(this.json[t])}getGlobalProperty(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Rr.UNSIGNED_INT,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;const r=this.json[t];return r&&Number.isFinite(r.byteOffset)?this._getTypedArrayFromBinary(t,e,n,1,r.byteOffset):r}getPropertyArray(t,e,n){const r=this.json[t];return r&&Number.isFinite(r.byteOffset)?("componentType"in r&&(e=Dr.fromName(r.componentType)),this._getTypedArrayFromBinary(t,e,n,this.featuresLength,r.byteOffset)):this._getTypedArrayFromArray(t,e,r)}getProperty(t,e,n,r,i){const o=this.json[t];if(!o)return o;const s=this.getPropertyArray(t,e,n);if(1===n)return s[r];for(let t=0;t<n;++t)i[t]=s[n*r+t];return i}_getTypedArrayFromBinary(t,e,n,r,i){const o=this._cachedTypedArrays;let s=o[t];return s||(s=Dr.createTypedArray(e,this.buffer.buffer,this.buffer.byteOffset+i,r*n),o[t]=s),s}_getTypedArrayFromArray(t,e,n){const r=this._cachedTypedArrays;let i=r[t];return i||(i=Dr.createTypedArray(e,n),r[t]=i),i}}const Nr={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},jr={SCALAR:(t,e)=>t[e],VEC2:(t,e)=>[t[2*e+0],t[2*e+1]],VEC3:(t,e)=>[t[3*e+0],t[3*e+1],t[3*e+2]],VEC4:(t,e)=>[t[4*e+0],t[4*e+1],t[4*e+2],t[4*e+3]],MAT2:(t,e)=>[t[4*e+0],t[4*e+1],t[4*e+2],t[4*e+3]],MAT3:(t,e)=>[t[9*e+0],t[9*e+1],t[9*e+2],t[9*e+3],t[9*e+4],t[9*e+5],t[9*e+6],t[9*e+7],t[9*e+8]],MAT4:(t,e)=>[t[16*e+0],t[16*e+1],t[16*e+2],t[16*e+3],t[16*e+4],t[16*e+5],t[16*e+6],t[16*e+7],t[16*e+8],t[16*e+9],t[16*e+10],t[16*e+11],t[16*e+12],t[16*e+13],t[16*e+14],t[16*e+15]]},Gr={SCALAR:(t,e,n)=>{e[n]=t},VEC2:(t,e,n)=>{e[2*n+0]=t[0],e[2*n+1]=t[1]},VEC3:(t,e,n)=>{e[3*n+0]=t[0],e[3*n+1]=t[1],e[3*n+2]=t[2]},VEC4:(t,e,n)=>{e[4*n+0]=t[0],e[4*n+1]=t[1],e[4*n+2]=t[2],e[4*n+3]=t[3]},MAT2:(t,e,n)=>{e[4*n+0]=t[0],e[4*n+1]=t[1],e[4*n+2]=t[2],e[4*n+3]=t[3]},MAT3:(t,e,n)=>{e[9*n+0]=t[0],e[9*n+1]=t[1],e[9*n+2]=t[2],e[9*n+3]=t[3],e[9*n+4]=t[4],e[9*n+5]=t[5],e[9*n+6]=t[6],e[9*n+7]=t[7],e[9*n+8]=t[8],e[9*n+9]=t[9]},MAT4:(t,e,n)=>{e[16*n+0]=t[0],e[16*n+1]=t[1],e[16*n+2]=t[2],e[16*n+3]=t[3],e[16*n+4]=t[4],e[16*n+5]=t[5],e[16*n+6]=t[6],e[16*n+7]=t[7],e[16*n+8]=t[8],e[16*n+9]=t[9],e[16*n+10]=t[10],e[16*n+11]=t[11],e[16*n+12]=t[12],e[16*n+13]=t[13],e[16*n+14]=t[14],e[16*n+15]=t[15]}},Ur=t=>void 0!==t;function zr(t,e,n){if(!t)return;const r=t.parentCounts;return t.parentIds?n(t,e):r>0?function(t,e,n){const r=t.classIds,i=t.parentCounts,o=t.parentIds,s=t.parentIndexes,a=r.length,l=scratchVisited;l.length=Math.max(l.length,a);const u=++marker,c=scratchStack;for(c.length=0,c.push(e);c.length>0;){if(l[e=c.pop()]===u)continue;l[e]=u;const r=n(t,e);if(Ur(r))return r;const a=i[e],h=s[e];for(let t=0;t<a;++t){const n=o[h+t];n!==e&&c.push(n)}}return null}(t,e,n):function(t,e,n){let r=!0;for(;r;){const i=n(t,e);if(Ur(i))return i;const o=t.parentIds[e];r=o!==e,e=o}throw new Error("traverseHierarchySingleParent")}(t,e,n)}function Vr(t,e,n){const r=t.parentCounts,i=t.parentIds,o=t.parentIndexes,s=t.classIds.length;if(!Ur(i))return;assert(e<s,"Parent index ".concat(e," exceeds the total number of instances: ").concat(s)),assert(-1===n.indexOf(e),"Circular dependency detected in the batch table hierarchy."),n.push(e);const a=Ur(r)?r[e]:1,l=Ur(r)?o[e]:e;for(let r=0;r<a;++r){const o=i[l+r];o!==e&&Vr(t,o,n)}n.pop(e)}function Hr(t){return null!=t}const qr=(t,e)=>t,Wr={HIERARCHY:!0,extensions:!0,extras:!0};class Jr{constructor(t,e,n){var i;let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};(0,r.A)(this,"json",void 0),(0,r.A)(this,"binary",void 0),(0,r.A)(this,"featureCount",void 0),(0,r.A)(this,"_extensions",void 0),(0,r.A)(this,"_properties",void 0),(0,r.A)(this,"_binaryProperties",void 0),(0,r.A)(this,"_hierarchy",void 0),(0,Pn.v)(n>=0),this.json=t||{},this.binary=e,this.featureCount=n,this._extensions=(null===(i=this.json)||void 0===i?void 0:i.extensions)||{},this._properties={};for(const t in this.json)Wr[t]||(this._properties[t]=this.json[t]);this._binaryProperties=this._initializeBinaryProperties(),o["3DTILES_batch_table_hierarchy"]&&(this._hierarchy=function(t,e,n){if(!e)return null;let r=t.getExtension("3DTILES_batch_table_hierarchy");const i=e.HIERARCHY;return i&&(console.warn("3D Tile Parser: HIERARCHY is deprecated. Use 3DTILES_batch_table_hierarchy."),e.extensions=e.extensions||{},e.extensions["3DTILES_batch_table_hierarchy"]=i,r=i),r?function(t,e){let n,r,i;const o=t.instancesLength,s=t.classes;let a,l=t.classIds,u=t.parentCounts,c=t.parentIds,h=o;if(Ur(l.byteOffset)&&(l.componentType=defaultValue(l.componentType,GL.UNSIGNED_SHORT),l.type=AttributeType.SCALAR,i=getBinaryAccessor(l),l=i.createArrayBufferView(e.buffer,e.byteOffset+l.byteOffset,o)),Ur(u))for(Ur(u.byteOffset)&&(u.componentType=defaultValue(u.componentType,GL.UNSIGNED_SHORT),u.type=AttributeType.SCALAR,i=getBinaryAccessor(u),u=i.createArrayBufferView(e.buffer,e.byteOffset+u.byteOffset,o)),a=new Uint16Array(o),h=0,n=0;n<o;++n)a[n]=h,h+=u[n];Ur(c)&&Ur(c.byteOffset)&&(c.componentType=defaultValue(c.componentType,GL.UNSIGNED_SHORT),c.type=AttributeType.SCALAR,i=getBinaryAccessor(c),c=i.createArrayBufferView(e.buffer,e.byteOffset+c.byteOffset,h));const d=s.length;for(n=0;n<d;++n){const t=s[n].length,r=s[n].instances,i=getBinaryProperties(t,r,e);s[n].instances=combine(i,r)}const f=new Array(d).fill(0),p=new Uint16Array(o);for(n=0;n<o;++n)r=l[n],p[n]=f[r],++f[r];const g={classes:s,classIds:l,classIndexes:p,parentCounts:u,parentIndexes:a,parentIds:c};return function(t){const e=t.classIds.length;for(let n=0;n<e;++n)Vr(t,n,stack)}(g),g}(r,n):null}(this,this.json,this.binary))}getExtension(t){return this.json&&this.json.extensions&&this.json.extensions[t]}memorySizeInBytes(){return 0}isClass(t,e){return this._checkBatchId(t),(0,Pn.v)("string"==typeof e,e),!!this._hierarchy&&Hr(zr(this._hierarchy,t,((t,n)=>{const r=t.classIds[n];return t.classes[r].name===e})))}isExactClass(t,e){return(0,Pn.v)("string"==typeof e,e),this.getExactClassName(t)===e}getExactClassName(t){if(this._checkBatchId(t),this._hierarchy){const e=this._hierarchy.classIds[t];return this._hierarchy.classes[e].name}}hasProperty(t,e){return this._checkBatchId(t),(0,Pn.v)("string"==typeof e,e),Hr(this._properties[e])||this._hasPropertyInHierarchy(t,e)}getPropertyNames(t,e){this._checkBatchId(t),(e=Hr(e)?e:[]).length=0;const n=Object.keys(this._properties);return e.push(...n),this._hierarchy&&this._getPropertyNamesInHierarchy(t,e),e}getProperty(t,e){if(this._checkBatchId(t),(0,Pn.v)("string"==typeof e,e),this._binaryProperties){const n=this._binaryProperties[e];if(Hr(n))return this._getBinaryProperty(n,t)}const n=this._properties[e];if(Hr(n))return qr(n[t]);if(this._hierarchy){const n=this._getHierarchyProperty(t,e);if(Hr(n))return n}}setProperty(t,e,n){const r=this.featureCount;if(this._checkBatchId(t),(0,Pn.v)("string"==typeof e,e),this._binaryProperties){const r=this._binaryProperties[e];if(r)return void this._setBinaryProperty(r,t,n)}if(this._hierarchy&&this._setHierarchyProperty(this,t,e,n))return;let i=this._properties[e];Hr(i)||(this._properties[e]=new Array(r),i=this._properties[e]),i[t]=qr(n)}_checkBatchId(t){if(!(t>=0&&t<this.featureCount))throw new Error("batchId not in range [0, featureCount - 1].")}_getBinaryProperty(t,e){return t.unpack(t.typedArray,e)}_setBinaryProperty(t,e,n){t.pack(n,t.typedArray,e)}_initializeBinaryProperties(){let t=null;for(const e in this._properties){const n=this._properties[e],r=this._initializeBinaryProperty(e,n);r&&(t=t||{},t[e]=r)}return t}_initializeBinaryProperty(t,e){if("byteOffset"in e){const n=e;(0,Pn.v)(this.binary,"Property ".concat(t," requires a batch table binary.")),(0,Pn.v)(n.type,"Property ".concat(t," requires a type."));const r=function(t,e,n,r){const{componentType:i}=t;(0,Pn.v)(t.componentType);const o="string"==typeof i?Dr.fromName(i):i,s=Nr[t.type],a=jr[t.type],l=Gr[t.type];return n+=t.byteOffset,{values:Dr.createTypedArray(o,e,n,s*r),type:o,size:s,unpacker:a,packer:l}}(n,this.binary.buffer,0|this.binary.byteOffset,this.featureCount);return{typedArray:r.values,componentCount:r.size,unpack:r.unpacker,pack:r.packer}}return null}_hasPropertyInHierarchy(t,e){if(!this._hierarchy)return!1;const n=zr(this._hierarchy,t,((t,n)=>{const r=t.classIds[n];return Hr(t.classes[r].instances[e])}));return Hr(n)}_getPropertyNamesInHierarchy(t,e){zr(this._hierarchy,t,((t,n)=>{const r=t.classIds[n],i=t.classes[r].instances;for(const t in i)i.hasOwnProperty(t)&&-1===e.indexOf(t)&&e.push(t)}))}_getHierarchyProperty(t,e){return zr(this._hierarchy,t,((t,n)=>{const r=t.classIds[n],i=t.classes[r],o=t.classIndexes[n],s=i.instances[e];return Hr(s)?Hr(s.typedArray)?this._getBinaryProperty(s,o):qr(s[o]):null}))}_setHierarchyProperty(t,e,n,r){const i=zr(this._hierarchy,e,((t,i)=>{const o=t.classIds[i],s=t.classes[o],a=t.classIndexes[i],l=s.instances[n];return!!Hr(l)&&((0,Pn.v)(i===e,'Inherited property "'.concat(n,'" is read-only.')),Hr(l.typedArray)?this._setBinaryProperty(l,a,r):l[a]=qr(r),!0)}));return Hr(i)}}const Yr=4;function Xr(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const r=new DataView(e);if(t.magic=r.getUint32(n,!0),n+=Yr,t.version=r.getUint32(n,!0),n+=Yr,t.byteLength=r.getUint32(n,!0),n+=Yr,1!==t.version)throw new Error("3D Tile Version ".concat(t.version," not supported"));return n}const Kr=4,Zr="b3dm tile in legacy format.";function Qr(t,e,n){const r=new DataView(e);let i;t.header=t.header||{};let o=r.getUint32(n,!0);n+=Kr;let s=r.getUint32(n,!0);n+=Kr;let a=r.getUint32(n,!0);n+=Kr;let l=r.getUint32(n,!0);return n+=Kr,a>=570425344?(n-=2*Kr,i=o,a=s,l=0,o=0,s=0,console.warn(Zr)):l>=570425344&&(n-=Kr,i=a,a=o,l=s,o=0,s=0,console.warn(Zr)),t.header.featureTableJsonByteLength=o,t.header.featureTableBinaryByteLength=s,t.header.batchTableJsonByteLength=a,t.header.batchTableBinaryByteLength=l,t.header.batchLength=i,n}function $r(t,e,n,r){return n=function(t,e,n){const{featureTableJsonByteLength:r,featureTableBinaryByteLength:i,batchLength:o}=t.header;if(t.featureTableJson={BATCH_LENGTH:o||0},r>0){const i=Tr(e,n,r);t.featureTableJson=JSON.parse(i)}return n+=r,t.featureTableBinary=new Uint8Array(e,n,i),n+=i}(t,e,n),n=function(t,e,n){const{batchTableJsonByteLength:r,batchTableBinaryByteLength:i}=t.header;if(r>0){const o=Tr(e,n,r);t.batchTableJson=JSON.parse(o),n+=r,i>0&&(t.batchTableBinary=new Uint8Array(e,n,i),t.batchTableBinary=new Uint8Array(t.batchTableBinary),n+=i)}return n}(t,e,n),n}function ti(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];const n=t>>11&31,r=t>>5&63,i=31&t;return e[0]=n<<3,e[1]=r<<2,e[2]=i<<3,e}function ei(t,e,n){if(!(e||t&&t.batchIds&&n))return null;const{batchIds:r,isRGB565:i,pointCount:o}=t;if(r&&n){const t=new Uint8ClampedArray(3*o);for(let e=0;e<o;e++){const i=r[e],o=n.getProperty(i,"dimensions").map((t=>255*t));t[3*e]=o[0],t[3*e+1]=o[1],t[3*e+2]=o[2]}return{type:Rr.UNSIGNED_BYTE,value:t,size:3,normalized:!0}}if(i){const t=new Uint8ClampedArray(3*o);for(let n=0;n<o;n++){const r=ti(e[n]);t[3*n]=r[0],t[3*n+1]=r[1],t[3*n+2]=r[2]}return{type:Rr.UNSIGNED_BYTE,value:t,size:3,normalized:!0}}return e&&e.length===3*o?{type:Rr.UNSIGNED_BYTE,value:e,size:3,normalized:!0}:{type:Rr.UNSIGNED_BYTE,value:e,size:4,normalized:!0}}var ni=n(90353);function ri(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:255;return(0,ut.qE)(t,0,e)/e*2-1}function ii(t){return t<0?-1:1}function oi(t,e,n){return function(t,e,n,r){if(function(t){if(!t)throw new Error("math.gl assertion failed. ".concat(void 0))}(r),t<0||t>n||e<0||e>n)throw new Error("x and y must be unsigned normalized integers between 0 and ".concat(n));if(r.x=ri(t,n),r.y=ri(e,n),r.z=1-(Math.abs(r.x)+Math.abs(r.y)),r.z<0){const t=r.x;r.x=(1-Math.abs(r.y))*ii(t),r.y=(1-Math.abs(t))*ii(r.y)}return r.normalize()}(t,e,255,n)}new ni.A,new pt.A,new ni.A,new ni.A,new Uint8Array(1);const si=new pt.A;async function ai(t,e,n,r,i){n=$r(t,e,n=Qr(t,e,n=Xr(t,e,n))),function(t){t.attributes={positions:null,colors:null,normals:null,batchIds:null},t.isQuantized=!1,t.isTranslucent=!1,t.isRGB565=!1,t.isOctEncoded16P=!1}(t);const{featureTable:o,batchTable:s}=function(t){const e=new Fr(t.featureTableJson,t.featureTableBinary),n=e.getGlobalProperty("POINTS_LENGTH");if(!Number.isFinite(n))throw new Error("POINTS_LENGTH must be defined");e.featuresLength=n,t.featuresLength=n,t.pointsLength=n,t.pointCount=n,t.rtcCenter=e.getGlobalProperty("RTC_CENTER",Rr.FLOAT,3);const r=function(t,e){let n=null;if(!t.batchIds&&e.hasProperty("BATCH_ID")&&(t.batchIds=e.getPropertyArray("BATCH_ID",Rr.UNSIGNED_SHORT,1),t.batchIds)){const r=e.getGlobalProperty("BATCH_LENGTH");if(!r)throw new Error("Global property: BATCH_LENGTH must be defined when BATCH_ID is defined.");const{batchTableJson:i,batchTableBinary:o}=t;n=new Jr(i,o,r)}return n}(t,e);return{featureTable:e,batchTable:r}}(t);return await async function(t,e,n,r,i){let o,s,a;const l=t.batchTableJson&&t.batchTableJson.extensions&&t.batchTableJson.extensions["3DTILES_draco_point_compression"];l&&(a=l.properties);const u=e.getExtension("3DTILES_draco_point_compression");if(u){s=u.properties;const e=u.byteOffset,n=u.byteLength;if(!s||!Number.isFinite(e)||!n)throw new Error("Draco properties, byteOffset, and byteLength must be defined");o=t.featureTableBinary.slice(e,e+n),t.hasPositions=Number.isFinite(s.POSITION),t.hasColors=Number.isFinite(s.RGB)||Number.isFinite(s.RGBA),t.hasNormals=Number.isFinite(s.NORMAL),t.hasBatchIds=Number.isFinite(s.BATCH_ID),t.isTranslucent=Number.isFinite(s.RGBA)}if(!o)return!0;const c={buffer:o,properties:{...s,...a},featureTableProperties:s,batchTableProperties:a,dequantizeInShader:!1};return await async function(t,e,n,r){const{parse:i}=r,o={...n,draco:{...n.draco,extraAttributes:e.batchTableProperties||{}}};delete o["3d-tiles"];const s=await i(e.buffer,Or.Vl,o),a=s.attributes.POSITION&&s.attributes.POSITION.value,l=s.attributes.COLOR_0&&s.attributes.COLOR_0.value,u=s.attributes.NORMAL&&s.attributes.NORMAL.value,c=s.attributes.BATCH_ID&&s.attributes.BATCH_ID.value,h=a&&s.attributes.POSITION.value.quantization,d=u&&s.attributes.NORMAL.value.quantization;if(h){const e=s.POSITION.data.quantization,n=e.range;t.quantizedVolumeScale=new pt.A(n,n,n),t.quantizedVolumeOffset=new pt.A(e.minValues),t.quantizedRange=(1<<e.quantizationBits)-1,t.isQuantizedDraco=!0}d&&(t.octEncodedRange=(1<<s.NORMAL.data.quantization.quantizationBits)-1,t.isOctEncodedDraco=!0);const f={};if(e.batchTableProperties)for(const t of Object.keys(e.batchTableProperties))s.attributes[t]&&s.attributes[t].value&&(f[t.toLowerCase()]=s.attributes[t].value);t.attributes={positions:a,colors:ei(t,l,void 0),normals:u,batchIds:c,...f}}(t,c,r,i)}(t,o,0,r,i),function(t,e,n){if(!t.attributes.positions)if(e.hasProperty("POSITION"))t.attributes.positions=e.getPropertyArray("POSITION",Rr.FLOAT,3);else if(e.hasProperty("POSITION_QUANTIZED")){const r=e.getPropertyArray("POSITION_QUANTIZED",Rr.UNSIGNED_SHORT,3);if(t.isQuantized=!0,t.quantizedRange=65535,t.quantizedVolumeScale=e.getGlobalProperty("QUANTIZED_VOLUME_SCALE",Rr.FLOAT,3),!t.quantizedVolumeScale)throw new Error("QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");if(t.quantizedVolumeOffset=e.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",Rr.FLOAT,3),!t.quantizedVolumeOffset)throw new Error("QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");t.attributes.positions=function(t,e,n){return t.isQuantized?n["3d-tiles"]&&n["3d-tiles"].decodeQuantizedPositions?(t.isQuantized=!1,function(t,e){const n=new pt.A,r=new Float32Array(3*t.pointCount);for(let i=0;i<t.pointCount;i++)n.set(e[3*i],e[3*i+1],e[3*i+2]).scale(1/t.quantizedRange).multiply(t.quantizedVolumeScale).add(t.quantizedVolumeOffset).toArray(r,3*i);return r}(t,e)):{type:Rr.UNSIGNED_SHORT,value:e,size:3,normalized:!0}:e}(t,r,n)}if(!t.attributes.positions)throw new Error("Either POSITION or POSITION_QUANTIZED must be defined.")}(t,o,r),function(t,e,n){if(!t.attributes.colors){let r=null;e.hasProperty("RGBA")?(r=e.getPropertyArray("RGBA",Rr.UNSIGNED_BYTE,4),t.isTranslucent=!0):e.hasProperty("RGB")?r=e.getPropertyArray("RGB",Rr.UNSIGNED_BYTE,3):e.hasProperty("RGB565")&&(r=e.getPropertyArray("RGB565",Rr.UNSIGNED_SHORT,1),t.isRGB565=!0),t.attributes.colors=ei(t,r,n)}e.hasProperty("CONSTANT_RGBA")&&(t.constantRGBA=e.getGlobalProperty("CONSTANT_RGBA",Rr.UNSIGNED_BYTE,4))}(t,o,s),function(t,e){if(!t.attributes.normals){let n=null;e.hasProperty("NORMAL")?n=e.getPropertyArray("NORMAL",Rr.FLOAT,3):e.hasProperty("NORMAL_OCT16P")&&(n=e.getPropertyArray("NORMAL_OCT16P",Rr.UNSIGNED_BYTE,2),t.isOctEncoded16P=!0),t.attributes.normals=function(t,e){if(!e)return null;if(t.isOctEncoded16P){const n=new Float32Array(3*t.pointsLength);for(let r=0;r<t.pointsLength;r++)oi(e[2*r],e[2*r+1],si),si.toArray(n,3*r);return{type:Rr.FLOAT,size:2,value:n}}return{type:Rr.FLOAT,size:2,value:e}}(t,n)}}(t,o),n}var li=n(65771),ui=n(6440),ci=n(57345);const hi={URI:0,EMBEDDED:1};function di(t,e,n,r){t.rotateYtoZ=!0;const i=t.byteOffset+t.byteLength-n;if(0===i)throw new Error("glTF byte length must be greater than 0.");return t.gltfUpAxis=r["3d-tiles"]&&r["3d-tiles"].assetGltfUpAxis?r["3d-tiles"].assetGltfUpAxis:"Y",t.gltfArrayBuffer=(0,ci._m)(e,n,i),t.gltfByteOffset=0,t.gltfByteLength=i,n%4==0||console.warn("".concat(t.type,": embedded glb is not aligned to a 4-byte boundary.")),t.byteOffset+t.byteLength}async function fi(t,e,n,r){const i=n["3d-tiles"]||{};if(function(t,e){switch(e){case hi.URI:const e=new Uint8Array(t.gltfArrayBuffer,t.gltfByteOffset),n=(new TextDecoder).decode(e);t.gltfUrl=n.replace(/[\s\0]+$/,""),delete t.gltfArrayBuffer,delete t.gltfByteOffset,delete t.gltfByteLength;break;case hi.EMBEDDED:break;default:throw new Error("b3dm: Illegal glTF format field")}}(t,e),i.loadGLTF){const{parse:e,fetch:i}=r;t.gltfUrl&&(t.gltfArrayBuffer=await i(t.gltfUrl,n),t.gltfByteOffset=0),t.gltfArrayBuffer&&(t.gltf=await e(t.gltfArrayBuffer,li.B,n,r),t.gpuMemoryUsageInBytes=(0,ui.S3)(t.gltf),delete t.gltfArrayBuffer,delete t.gltfByteOffset,delete t.gltfByteLength)}}async function pi(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};switch(i.byteOffset=e,i.type=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=new DataView(t);return"".concat(String.fromCharCode(n.getUint8(e+0))).concat(String.fromCharCode(n.getUint8(e+1))).concat(String.fromCharCode(n.getUint8(e+2))).concat(String.fromCharCode(n.getUint8(e+3)))}(t,e),i.type){case Pr.COMPOSITE:return await async function(t,e,n,r,i,o){n=Xr(t,e,n);const s=new DataView(e);for(t.tilesLength=s.getUint32(n,!0),n+=4,t.tiles=[];t.tiles.length<t.tilesLength&&t.byteLength-n>12;){const s={};t.tiles.push(s),n=await o(e,n,r,i,s)}return n}(i,t,e,n,r,pi);case Pr.BATCHED_3D_MODEL:return await async function(t,e,n,r,i){var o;n=function(t,e,n,r){n=di(t,e,n=$r(t,e,n=Qr(t,e,n=Xr(t,e,n))),r);const i=new Fr(t.featureTableJson,t.featureTableBinary);return t.rtcCenter=i.getGlobalProperty("RTC_CENTER",Rr.FLOAT,3),n}(t,e,n,r),await fi(t,hi.EMBEDDED,r,i);const s=null==t||null===(o=t.gltf)||void 0===o?void 0:o.extensions;return s&&s.CESIUM_RTC&&(t.rtcCenter=s.CESIUM_RTC.center),n}(i,t,e,n,r);case Pr.GLTF:return await async function(t,e,n,r){t.rotateYtoZ=!0,t.gltfUpAxis=n["3d-tiles"]&&n["3d-tiles"].assetGltfUpAxis?n["3d-tiles"].assetGltfUpAxis:"Y";const{parse:i}=r;t.gltf=await i(e,li.B,n,r),t.gpuMemoryUsageInBytes=(0,ui.S3)(t.gltf)}(i,t,n,r);case Pr.INSTANCED_3D_MODEL:return await async function(t,e,n,r,i){return n=function(t,e,n,r){if(n=Xr(t,e,n),1!==t.version)throw new Error("Instanced 3D Model version ".concat(t.version," is not supported"));n=Qr(t,e,n);const i=new DataView(e);if(t.gltfFormat=i.getUint32(n,!0),n=di(t,e,n=$r(t,e,n+=4),r),0===t.featureTableJsonByteLength)throw new Error("i3dm parser: featureTableJsonByteLength is zero.");const o=new Fr(t.featureTableJson,t.featureTableBinary),s=o.getGlobalProperty("INSTANCES_LENGTH");if(o.featuresLength=s,!Number.isFinite(s))throw new Error("i3dm parser: INSTANCES_LENGTH must be defined");return t.eastNorthUp=o.getGlobalProperty("EAST_NORTH_UP"),t.rtcCenter=o.getGlobalProperty("RTC_CENTER",Rr.FLOAT,3),new Jr(t.batchTableJson,t.batchTableBinary,s),function(t,e,n,r){const i=[new Array(r),t._batchTable][0],o=new pt.A,s=new pt.A,a=new pt.A,l=new pt.A,u=new xt.A,c=new wt.A,h=new pt.A,d={},f=new lt.A,p=[],g=[],y=new pt.A,m=new pt.A;for(let n=0;n<r;n++){let r;if(e.hasProperty("POSITION"))r=e.getProperty("POSITION",Rr.FLOAT,3,n,o);else if(e.hasProperty("POSITION_QUANTIZED")){r=e.getProperty("POSITION_QUANTIZED",Rr.UNSIGNED_SHORT,3,n,o);const t=e.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",Rr.FLOAT,3,y);if(!t)throw new Error("i3dm parser: QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");const i=e.getGlobalProperty("QUANTIZED_VOLUME_SCALE",Rr.FLOAT,3,m);if(!i)throw new Error("i3dm parser: QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");const s=65535;for(let e=0;e<3;e++)r[e]=r[e]/s*i[e]+t[e]}if(!r)throw new Error("i3dm: POSITION or POSITION_QUANTIZED must be defined for each instance.");o.copy(r),d.translation=o,t.normalUp=e.getProperty("NORMAL_UP",Rr.FLOAT,3,n,p),t.normalRight=e.getProperty("NORMAL_RIGHT",Rr.FLOAT,3,n,g);const v=!1;if(t.normalUp){if(!t.normalRight)throw new Error("i3dm: Custom orientation requires both NORMAL_UP and NORMAL_RIGHT.");t.hasCustomOrientation=!0}else{if(t.octNormalUp=e.getProperty("NORMAL_UP_OCT32P",Rr.UNSIGNED_SHORT,2,p),t.octNormalRight=e.getProperty("NORMAL_RIGHT_OCT32P",Rr.UNSIGNED_SHORT,2,g),t.octNormalUp){if(!t.octNormalRight)throw new Error("i3dm: oct-encoded orientation requires NORMAL_UP_OCT32P and NORMAL_RIGHT_OCT32P");throw new Error("i3dm: oct-encoded orientation not implemented")}t.eastNorthUp?(xn.WGS84.eastNorthUpToFixedFrame(o,f),f.getRotationMatrix3(u)):u.identity()}v&&(l.copy(s).cross(a).normalize(),u.setColumn(0,s),u.setColumn(1,a),u.setColumn(2,l)),c.fromMatrix3(u),d.rotation=c,h.set(1,1,1);const b=e.getProperty("SCALE",Rr.FLOAT,1,n);Number.isFinite(b)&&h.multiplyByScalar(b);const _=e.getProperty("SCALE_NON_UNIFORM",Rr.FLOAT,3,n,p);_&&h.scale(_),d.scale=h;let A=e.getProperty("BATCH_ID",Rr.UNSIGNED_SHORT,1,n);void 0===A&&(A=n);const x=(new lt.A).fromQuaternion(d.rotation);f.identity(),f.translate(d.translation),f.multiplyRight(x),f.scale(d.scale);const w=f.clone();i[n]={modelMatrix:w,batchId:A}}t.instances=i}(t,o,0,s),n}(t,e,n,r),await fi(t,t.gltfFormat,r,i),n}(i,t,e,n,r);case Pr.POINT_CLOUD:return await ai(i,t,e,n,r);default:throw new Error("3DTileLoader: unknown type ".concat(i.type))}}async function gi(t,e,n,r){const i=t[e].bufferView,o=t.bufferViews[i],s=t.buffers[o.buffer];if(null==r||!r.url||!r.fetch)throw new Error("Url is not provided");if(!r.fetch)throw new Error("fetch is not provided");if(s.uri){const t=function(t,e){if(e.startsWith("http")){const n=new URL(t,e);return decodeURI(n.toString())}const n="http://".concat(e),r=new URL(t,n);return"/".concat(r.host).concat(r.pathname)}(s.uri,null==r?void 0:r.url),e=await r.fetch(t),n=await e.arrayBuffer();return new Uint8Array(n,o.byteOffset,o.byteLength)}return new Uint8Array(n,o.byteOffset,o.byteLength)}function yi(t){const e=new DataView(t);return e.getUint32(0,!0)+2**32*e.getUint32(4,!0)}const mi={id:"3d-tiles-subtree",name:"3D Tiles Subtree",module:"3d-tiles",version:Mr,extensions:["subtree"],mimeTypes:["application/octet-stream"],tests:["subtree"],parse:async function(t,e,n){if(1952609651!==new Uint32Array(t.slice(0,4))[0])throw new Error("Wrong subtree file magic number");if(1!==new Uint32Array(t.slice(4,8))[0])throw new Error("Wrong subtree file verson, must be 1");const r=yi(t.slice(8,16)),i=new Uint8Array(t,24,r),o=new TextDecoder("utf8").decode(i),s=JSON.parse(o),a=yi(t.slice(16,24));let l=new ArrayBuffer(0);return a&&(l=t.slice(24+r)),"bufferView"in s.tileAvailability&&(s.tileAvailability.explicitBitstream=await gi(s,"tileAvailability",l,n)),"bufferView"in s.contentAvailability&&(s.contentAvailability.explicitBitstream=await gi(s,"contentAvailability",l,n)),"bufferView"in s.childSubtreeAvailability&&(s.childSubtreeAvailability.explicitBitstream=await gi(s,"childSubtreeAvailability",l,n)),s},options:{}};var vi=null;try{vi=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(t){}function bi(t,e,n){this.low=0|t,this.high=0|e,this.unsigned=!!n}function _i(t){return!0===(t&&t.__isLong__)}function Ai(t){var e=Math.clz32(t&-t);return t?31-e:e}bi.prototype.__isLong__,Object.defineProperty(bi.prototype,"__isLong__",{value:!0}),bi.isLong=_i;var xi={},wi={};function Ci(t,e){var n,r,i;return e?(i=0<=(t>>>=0)&&t<256)&&(r=wi[t])?r:(n=Ei(t,0,!0),i&&(wi[t]=n),n):(i=-128<=(t|=0)&&t<128)&&(r=xi[t])?r:(n=Ei(t,t<0?-1:0,!1),i&&(xi[t]=n),n)}function Si(t,e){if(isNaN(t))return e?ki:Li;if(e){if(t<0)return ki;if(t>=Ii)return Gi}else{if(t<=-Ri)return Ui;if(t+1>=Ri)return ji}return t<0?Si(-t,e).neg():Ei(t%Oi|0,t/Oi|0,e)}function Ei(t,e,n){return new bi(t,e,n)}bi.fromInt=Ci,bi.fromNumber=Si,bi.fromBits=Ei;var Mi=Math.pow;function Pi(t,e,n){if(0===t.length)throw Error("empty string");if("number"==typeof e?(n=e,e=!1):e=!!e,"NaN"===t||"Infinity"===t||"+Infinity"===t||"-Infinity"===t)return e?ki:Li;if((n=n||10)<2||36<n)throw RangeError("radix");var r;if((r=t.indexOf("-"))>0)throw Error("interior hyphen");if(0===r)return Pi(t.substring(1),e,n).neg();for(var i=Si(Mi(n,8)),o=Li,s=0;s<t.length;s+=8){var a=Math.min(8,t.length-s),l=parseInt(t.substring(s,s+a),n);if(a<8){var u=Si(Mi(n,a));o=o.mul(u).add(Si(l))}else o=(o=o.mul(i)).add(Si(l))}return o.unsigned=e,o}function Ti(t,e){return"number"==typeof t?Si(t,e):"string"==typeof t?Pi(t,e):Ei(t.low,t.high,"boolean"==typeof e?e:t.unsigned)}bi.fromString=Pi,bi.fromValue=Ti;var Oi=4294967296,Ii=Oi*Oi,Ri=Ii/2,Bi=Ci(1<<24),Li=Ci(0);bi.ZERO=Li;var ki=Ci(0,!0);bi.UZERO=ki;var Di=Ci(1);bi.ONE=Di;var Fi=Ci(1,!0);bi.UONE=Fi;var Ni=Ci(-1);bi.NEG_ONE=Ni;var ji=Ei(-1,2147483647,!1);bi.MAX_VALUE=ji;var Gi=Ei(-1,-1,!0);bi.MAX_UNSIGNED_VALUE=Gi;var Ui=Ei(0,-2147483648,!1);bi.MIN_VALUE=Ui;var zi=bi.prototype;zi.toInt=function(){return this.unsigned?this.low>>>0:this.low},zi.toNumber=function(){return this.unsigned?(this.high>>>0)*Oi+(this.low>>>0):this.high*Oi+(this.low>>>0)},zi.toString=function(t){if((t=t||10)<2||36<t)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(Ui)){var e=Si(t),n=this.div(e),r=n.mul(e).sub(this);return n.toString(t)+r.toInt().toString(t)}return"-"+this.neg().toString(t)}for(var i=Si(Mi(t,6),this.unsigned),o=this,s="";;){var a=o.div(i),l=(o.sub(a.mul(i)).toInt()>>>0).toString(t);if((o=a).isZero())return l+s;for(;l.length<6;)l="0"+l;s=""+l+s}},zi.getHighBits=function(){return this.high},zi.getHighBitsUnsigned=function(){return this.high>>>0},zi.getLowBits=function(){return this.low},zi.getLowBitsUnsigned=function(){return this.low>>>0},zi.getNumBitsAbs=function(){if(this.isNegative())return this.eq(Ui)?64:this.neg().getNumBitsAbs();for(var t=0!=this.high?this.high:this.low,e=31;e>0&&!(t&1<<e);e--);return 0!=this.high?e+33:e+1},zi.isZero=function(){return 0===this.high&&0===this.low},zi.eqz=zi.isZero,zi.isNegative=function(){return!this.unsigned&&this.high<0},zi.isPositive=function(){return this.unsigned||this.high>=0},zi.isOdd=function(){return!(1&~this.low)},zi.isEven=function(){return!(1&this.low)},zi.equals=function(t){return _i(t)||(t=Ti(t)),(this.unsigned===t.unsigned||this.high>>>31!=1||t.high>>>31!=1)&&this.high===t.high&&this.low===t.low},zi.eq=zi.equals,zi.notEquals=function(t){return!this.eq(t)},zi.neq=zi.notEquals,zi.ne=zi.notEquals,zi.lessThan=function(t){return this.comp(t)<0},zi.lt=zi.lessThan,zi.lessThanOrEqual=function(t){return this.comp(t)<=0},zi.lte=zi.lessThanOrEqual,zi.le=zi.lessThanOrEqual,zi.greaterThan=function(t){return this.comp(t)>0},zi.gt=zi.greaterThan,zi.greaterThanOrEqual=function(t){return this.comp(t)>=0},zi.gte=zi.greaterThanOrEqual,zi.ge=zi.greaterThanOrEqual,zi.compare=function(t){if(_i(t)||(t=Ti(t)),this.eq(t))return 0;var e=this.isNegative(),n=t.isNegative();return e&&!n?-1:!e&&n?1:this.unsigned?t.high>>>0>this.high>>>0||t.high===this.high&&t.low>>>0>this.low>>>0?-1:1:this.sub(t).isNegative()?-1:1},zi.comp=zi.compare,zi.negate=function(){return!this.unsigned&&this.eq(Ui)?Ui:this.not().add(Di)},zi.neg=zi.negate,zi.add=function(t){_i(t)||(t=Ti(t));var e=this.high>>>16,n=65535&this.high,r=this.low>>>16,i=65535&this.low,o=t.high>>>16,s=65535&t.high,a=t.low>>>16,l=0,u=0,c=0,h=0;return c+=(h+=i+(65535&t.low))>>>16,u+=(c+=r+a)>>>16,l+=(u+=n+s)>>>16,l+=e+o,Ei((c&=65535)<<16|(h&=65535),(l&=65535)<<16|(u&=65535),this.unsigned)},zi.subtract=function(t){return _i(t)||(t=Ti(t)),this.add(t.neg())},zi.sub=zi.subtract,zi.multiply=function(t){if(this.isZero())return this;if(_i(t)||(t=Ti(t)),vi)return Ei(vi.mul(this.low,this.high,t.low,t.high),vi.get_high(),this.unsigned);if(t.isZero())return this.unsigned?ki:Li;if(this.eq(Ui))return t.isOdd()?Ui:Li;if(t.eq(Ui))return this.isOdd()?Ui:Li;if(this.isNegative())return t.isNegative()?this.neg().mul(t.neg()):this.neg().mul(t).neg();if(t.isNegative())return this.mul(t.neg()).neg();if(this.lt(Bi)&&t.lt(Bi))return Si(this.toNumber()*t.toNumber(),this.unsigned);var e=this.high>>>16,n=65535&this.high,r=this.low>>>16,i=65535&this.low,o=t.high>>>16,s=65535&t.high,a=t.low>>>16,l=65535&t.low,u=0,c=0,h=0,d=0;return h+=(d+=i*l)>>>16,c+=(h+=r*l)>>>16,h&=65535,c+=(h+=i*a)>>>16,u+=(c+=n*l)>>>16,c&=65535,u+=(c+=r*a)>>>16,c&=65535,u+=(c+=i*s)>>>16,u+=e*l+n*a+r*s+i*o,Ei((h&=65535)<<16|(d&=65535),(u&=65535)<<16|(c&=65535),this.unsigned)},zi.mul=zi.multiply,zi.divide=function(t){if(_i(t)||(t=Ti(t)),t.isZero())throw Error("division by zero");var e,n,r;if(vi)return this.unsigned||-2147483648!==this.high||-1!==t.low||-1!==t.high?Ei((this.unsigned?vi.div_u:vi.div_s)(this.low,this.high,t.low,t.high),vi.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?ki:Li;if(this.unsigned){if(t.unsigned||(t=t.toUnsigned()),t.gt(this))return ki;if(t.gt(this.shru(1)))return Fi;r=ki}else{if(this.eq(Ui))return t.eq(Di)||t.eq(Ni)?Ui:t.eq(Ui)?Di:(e=this.shr(1).div(t).shl(1)).eq(Li)?t.isNegative()?Di:Ni:(n=this.sub(t.mul(e)),r=e.add(n.div(t)));if(t.eq(Ui))return this.unsigned?ki:Li;if(this.isNegative())return t.isNegative()?this.neg().div(t.neg()):this.neg().div(t).neg();if(t.isNegative())return this.div(t.neg()).neg();r=Li}for(n=this;n.gte(t);){e=Math.max(1,Math.floor(n.toNumber()/t.toNumber()));for(var i=Math.ceil(Math.log(e)/Math.LN2),o=i<=48?1:Mi(2,i-48),s=Si(e),a=s.mul(t);a.isNegative()||a.gt(n);)a=(s=Si(e-=o,this.unsigned)).mul(t);s.isZero()&&(s=Di),r=r.add(s),n=n.sub(a)}return r},zi.div=zi.divide,zi.modulo=function(t){return _i(t)||(t=Ti(t)),vi?Ei((this.unsigned?vi.rem_u:vi.rem_s)(this.low,this.high,t.low,t.high),vi.get_high(),this.unsigned):this.sub(this.div(t).mul(t))},zi.mod=zi.modulo,zi.rem=zi.modulo,zi.not=function(){return Ei(~this.low,~this.high,this.unsigned)},zi.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32},zi.clz=zi.countLeadingZeros,zi.countTrailingZeros=function(){return this.low?Ai(this.low):Ai(this.high)+32},zi.ctz=zi.countTrailingZeros,zi.and=function(t){return _i(t)||(t=Ti(t)),Ei(this.low&t.low,this.high&t.high,this.unsigned)},zi.or=function(t){return _i(t)||(t=Ti(t)),Ei(this.low|t.low,this.high|t.high,this.unsigned)},zi.xor=function(t){return _i(t)||(t=Ti(t)),Ei(this.low^t.low,this.high^t.high,this.unsigned)},zi.shiftLeft=function(t){return _i(t)&&(t=t.toInt()),0==(t&=63)?this:t<32?Ei(this.low<<t,this.high<<t|this.low>>>32-t,this.unsigned):Ei(0,this.low<<t-32,this.unsigned)},zi.shl=zi.shiftLeft,zi.shiftRight=function(t){return _i(t)&&(t=t.toInt()),0==(t&=63)?this:t<32?Ei(this.low>>>t|this.high<<32-t,this.high>>t,this.unsigned):Ei(this.high>>t-32,this.high>=0?0:-1,this.unsigned)},zi.shr=zi.shiftRight,zi.shiftRightUnsigned=function(t){return _i(t)&&(t=t.toInt()),0==(t&=63)?this:t<32?Ei(this.low>>>t|this.high<<32-t,this.high>>>t,this.unsigned):Ei(32===t?this.high:this.high>>>t-32,0,this.unsigned)},zi.shru=zi.shiftRightUnsigned,zi.shr_u=zi.shiftRightUnsigned,zi.rotateLeft=function(t){var e;return _i(t)&&(t=t.toInt()),0==(t&=63)?this:32===t?Ei(this.high,this.low,this.unsigned):t<32?(e=32-t,Ei(this.low<<t|this.high>>>e,this.high<<t|this.low>>>e,this.unsigned)):(e=32-(t-=32),Ei(this.high<<t|this.low>>>e,this.low<<t|this.high>>>e,this.unsigned))},zi.rotl=zi.rotateLeft,zi.rotateRight=function(t){var e;return _i(t)&&(t=t.toInt()),0==(t&=63)?this:32===t?Ei(this.high,this.low,this.unsigned):t<32?(e=32-t,Ei(this.high<<e|this.low>>>t,this.low<<e|this.high>>>t,this.unsigned)):(e=32-(t-=32),Ei(this.low<<e|this.high>>>t,this.high<<e|this.low>>>t,this.unsigned))},zi.rotr=zi.rotateRight,zi.toSigned=function(){return this.unsigned?Ei(this.low,this.high,!1):this},zi.toUnsigned=function(){return this.unsigned?this:Ei(this.low,this.high,!0)},zi.toBytes=function(t){return t?this.toBytesLE():this.toBytesBE()},zi.toBytesLE=function(){var t=this.high,e=this.low;return[255&e,e>>>8&255,e>>>16&255,e>>>24,255&t,t>>>8&255,t>>>16&255,t>>>24]},zi.toBytesBE=function(){var t=this.high,e=this.low;return[t>>>24,t>>>16&255,t>>>8&255,255&t,e>>>24,e>>>16&255,e>>>8&255,255&e]},bi.fromBytes=function(t,e,n){return n?bi.fromBytesLE(t,e):bi.fromBytesBE(t,e)},bi.fromBytesLE=function(t,e){return new bi(t[0]|t[1]<<8|t[2]<<16|t[3]<<24,t[4]|t[5]<<8|t[6]<<16|t[7]<<24,e)},bi.fromBytesBE=function(t,e){return new bi(t[4]<<24|t[5]<<16|t[6]<<8|t[7],t[0]<<24|t[1]<<16|t[2]<<8|t[3],e)};const Vi=bi,Hi=16;function qi(t){"X"===t&&(t="");const e=t.padEnd(Hi,"0");return Vi.fromString(e,!0,16)}const Wi=3,Ji=61,Yi=180/Math.PI;function Xi(t,e,n){const r=1<<e;return[(t[0]+n[0])/r,(t[1]+n[1])/r]}function Ki(t){return t>=.5?1/3*(4*t*t-1):1/3*(1-4*(1-t)*(1-t))}function Zi(t){return[Ki(t[0]),Ki(t[1])]}function Qi(t,e){let[n,r]=e;switch(t){case 0:return[1,n,r];case 1:return[-n,1,r];case 2:return[-n,-r,1];case 3:return[-1,-r,-n];case 4:return[r,-1,-n];case 5:return[r,n,-1];default:throw new Error("Invalid face")}}function $i(t){let[e,n,r]=t;const i=Math.atan2(r,Math.sqrt(e*e+n*n));return[Math.atan2(n,e)*Yi,i*Yi]}function to(t,e,n,r){if(0===r){1===n&&(e[0]=t-1-e[0],e[1]=t-1-e[1]);const r=e[0];e[0]=e[1],e[1]=r}}function eo(t){const e=function(t){if(t.indexOf("/")>0)return t;return function(t){if(t.isZero())return"";let e=t.toString(2);for(;e.length<Wi+Ji;)e="0"+e;const n=e.lastIndexOf("1"),r=e.substring(0,3),i=e.substring(3,n),o=i.length/2,s=Vi.fromString(r,!0,2).toString(10);let a="";if(0!==o)for(a=Vi.fromString(i,!0,2).toString(4);a.length<o;)a="0"+a;return"".concat(s,"/").concat(a)}(qi(t))}(t),n=function(t){if(0===t.length)throw new Error("Invalid Hilbert quad key ".concat(t));const e=t.split("/"),n=parseInt(e[0],10),r=e[1],i=r.length;let o=0;const s=[0,0];for(let t=i-1;t>=0;t--){o=i-t;const e=r[t];let n=0,a=0;"1"===e?a=1:"2"===e?(n=1,a=1):"3"===e&&(n=1);const l=Math.pow(2,o-1);to(l,s,n,a),s[0]+=l*n,s[1]+=l*a}if(n%2==1){const t=s[0];s[0]=s[1],s[1]=t}return{face:n,ij:s,level:o}}(e);return n}const no=100;function ro(t){const{face:e,ij:n,level:r}=t,i=[[0,0],[0,1],[1,1],[1,0],[0,0]],o=Math.max(1,Math.ceil(no*Math.pow(2,-r))),s=new Float64Array(4*o*2+2);let a=0,l=0;for(let t=0;t<4;t++){const u=i[t].slice(0),c=i[t+1],h=(c[0]-u[0])/o,d=(c[1]-u[1])/o;for(let t=0;t<o;t++){u[0]+=h,u[1]+=d;const t=$i(Qi(e,Zi(Xi(n,r,u))));Math.abs(t[1])>89.999&&(t[0]=l);const i=t[0]-l;t[0]+=i>180?-360:i<-180?360:0,s[a++]=t[0],s[a++]=t[1],l=t[0]}}return s[a++]=s[0],s[a++]=s[1],s}function io(t){if(t.length%2!=0)throw new Error("Invalid corners");const e=[],n=[];for(let r=0;r<t.length;r+=2)e.push(t[r]),n.push(t[r+1]);return e.sort(((t,e)=>t-e)),n.sort(((t,e)=>t-e)),{west:e[0],east:e[e.length-1],north:n[n.length-1],south:n[0]}}function oo(t){const e=t.token,n={minimumHeight:t.minimumHeight,maximumHeight:t.maximumHeight},r=function(t,e){const n=(null==e?void 0:e.minimumHeight)||0,r=(null==e?void 0:e.maximumHeight)||0,i=function(t){let e;if(2===t.face||5===t.face){let n=null,r=0;for(let e=0;e<4;e++){const i=ro(eo("".concat(t.face,"/").concat(e)));null==n&&(n=new Float64Array(4*i.length)),n.set(i,r),r+=i.length}e=io(n)}else e=io(ro(t));return e}(eo(t)),o=i.west,s=i.south,a=i.east,l=i.north,u=[];return u.push(new pt.A(o,l,n)),u.push(new pt.A(a,l,n)),u.push(new pt.A(a,s,n)),u.push(new pt.A(o,s,n)),u.push(new pt.A(o,l,r)),u.push(new pt.A(a,l,r)),u.push(new pt.A(a,s,r)),u.push(new pt.A(o,s,r)),u}(e,n),i=function(t){const e=Zi(Xi(t.ij,t.level,[.5,.5]));return $i(Qi(t.face,e))}(eo(e)),o=i[0],s=i[1],a=xn.WGS84.cartographicToCartesian([o,s,n.maximumHeight]),l=new pt.A(a[0],a[1],a[2]);r.push(l);const u=re(r);return[...u.center,...u.halfAxes]}const so={QUADTREE:4,OCTREE:8};function ao(t,e,n){if(null!=t&&t.box){const r=function(t,e){const n=function(t){return t.and(t.not().add(1))}(t).shiftRightUnsigned(2);return t.add(Vi.fromNumber(2*e+1-4).multiply(n))}(qi(t.s2VolumeInfo.token),e),i=function(t){if(t.isZero())return"X";let e=t.countTrailingZeros();e=(e-e%4)/4;const n=e;e*=4;const r=t.shiftRightUnsigned(e).toString(16).replace(/0+$/,"");return Array(17-n-r.length).join("0")+r}(r),o={...t.s2VolumeInfo};if(o.token=i,"OCTREE"===n){const e=t.s2VolumeInfo,n=e.maximumHeight-e.minimumHeight,r=n/2,i=e.minimumHeight+n/2;e.minimumHeight=i-r,e.maximumHeight=i+r}return{box:oo(o),s2VolumeInfo:o}}}async function lo(t){const{options:e,parentData:n={mortonIndex:0,x:0,y:0,z:0},childIndex:r=0,globalData:i={level:0,mortonIndex:0,x:0,y:0,z:0},s2VolumeBox:o}=t;let{subtree:s,level:a=0}=t;const{subdivisionScheme:l,subtreeLevels:u,maximumLevel:c,contentUrlTemplate:h,subtreesUriTemplate:d,basePath:f}=e,p={children:[],lodMetricValue:0,contentUrl:""},g=so[l],y=1&r,m=r>>1&1,v=r>>2&1,b=(g**a-1)/(g-1);let _=ho(n.mortonIndex,r),A=b+_,x=ho(n.x,y),w=ho(n.y,m),C=ho(n.z,v),S=!1;a+1>u&&(S=uo(s.childSubtreeAvailability,_));const E=ho(i.x,x),M=ho(i.y,w),P=ho(i.z,C),T=a+i.level;if(S){const t=fo("".concat(f,"/").concat(d),T,E,M,P);s=await(0,Nn.load)(t,mi),i.mortonIndex=_,i.x=x,i.y=w,i.z=C,i.level=a,_=0,A=0,x=0,w=0,C=0,a=0}if(!uo(s.tileAvailability,A)||a>c)return p;uo(s.contentAvailability,A)&&(p.contentUrl=fo(h,T,E,M,P));const O=a+1,I={mortonIndex:_,x,y:w,z:C};for(let t=0;t<g;t++){const n=ao(o,t,l),r=await lo({subtree:s,options:e,parentData:I,childIndex:t,level:O,globalData:i,s2VolumeBox:n});if(r.contentUrl||r.children.length){const t=co(r,T+1,{childTileX:x,childTileY:w,childTileZ:C},e,o);p.children.push(t)}}return p}function uo(t,e){return"constant"in t?Boolean(t.constant):!!t.explicitBitstream&&function(t,e){const n=t%8;return 1==(e[Math.floor(t/8)]>>n&1)}(e,t.explicitBitstream)}function co(t,e,n,r,i){const{basePath:o,refine:s,getRefine:a,lodMetricType:l,getTileType:u,rootLodMetricValue:c,rootBoundingVolume:h}=r,d=t.contentUrl&&t.contentUrl.replace("".concat(o,"/"),""),f=c/2**e,p=function(t,e,n){if(e.region){const{childTileX:r,childTileY:i,childTileZ:o}=n,[s,a,l,u,c,h]=e.region,d=2**t,f=(l-s)/d,p=(u-a)/d,g=(h-c)/d,[y,m]=[s+f*r,s+f*(r+1)],[v,b]=[a+p*i,a+p*(i+1)],[_,A]=[c+g*o,c+g*(o+1)];return{region:[y,v,m,b,_,A]}}if(e.box)return e;throw new Error("Unsupported bounding volume type ".concat(e))}(e,null!=i&&i.box?{box:i.box}:h,n);return{children:t.children,contentUrl:t.contentUrl,content:{uri:d},id:t.contentUrl,refine:a(s),type:u(t),lodMetricType:l,lodMetricValue:f,geometricError:f,transform:t.transform,boundingVolume:p}}function ho(t,e){return parseInt(t.toString(2)+e.toString(2),2)}function fo(t,e,n,r,i){const o=function(t){const e={};for(const n in t)e["{".concat(n,"}")]=t[n];return e}({level:e,x:n,y:r,z:i});return t.replace(/{level}|{x}|{y}|{z}/gi,(t=>o[t]))}function po(t){if(!t.contentUrl)return Gn.EMPTY;const e=t.contentUrl.split("?")[0].split(".").pop();switch(e){case"pnts":return Gn.POINTCLOUD;case"i3dm":case"b3dm":case"glb":case"gltf":return Gn.SCENEGRAPH;default:return e}}function go(t){switch(t){case"REPLACE":case"replace":return jn.REPLACE;case"ADD":case"add":return jn.ADD;default:return t}}function yo(t,e){if(/^[a-z][0-9a-z+.-]*:/i.test(e)){const n=new URL(t,"".concat(e,"/"));return decodeURI(n.toString())}return t.startsWith("/")?t:"".concat(e,"/").concat(t)}function mo(t,e){if(!t)return null;if(t.content){const n=t.content.uri||t.content.url;t.contentUrl=yo(n,e.basePath)}return t.id=t.contentUrl,t.lodMetricType=Vn,t.lodMetricValue=t.geometricError,t.transformMatrix=t.transform,t.type=po(t),t.refine=go(t.refine),t}async function vo(t,e,n,r){var i,o;const s=e.basePath,{subdivisionScheme:a,maximumLevel:l,subtreeLevels:u,subtrees:{uri:c}}=n,h=yo(fo(c,0,0,0,0),s),d=await(0,Nn.load)(h,mi,r),f=yo(t.content.uri,s),p=null==e||null===(i=e.root)||void 0===i?void 0:i.refine,g=t.geometricError,y=null===(o=t.boundingVolume.extensions)||void 0===o?void 0:o["3DTILES_bounding_volume_S2"];if(y){const e={box:oo(y),s2VolumeInfo:y};t.boundingVolume=e}const m=t.boundingVolume,v={contentUrlTemplate:f,subtreesUriTemplate:c,subdivisionScheme:a,subtreeLevels:u,maximumLevel:l,refine:p,basePath:s,lodMetricType:Vn,rootLodMetricValue:g,rootBoundingVolume:m,getTileType:po,getRefine:go};return await async function(t,e,n){if(!t)return null;t.lodMetricType=Vn,t.lodMetricValue=t.geometricError,t.transformMatrix=t.transform;const{children:r,contentUrl:i}=await lo({subtree:e,options:n,s2VolumeBox:t});return i&&(t.contentUrl=i,t.content={uri:i.replace("".concat(n.basePath,"/"),"")}),t.refine=go(t.refine),t.type=po(t),t.children=r,t.id=t.contentUrl,t}(t,d,v)}function bo(t){var e;return(null==t||null===(e=t.extensions)||void 0===e?void 0:e["3DTILES_implicit_tiling"])||(null==t?void 0:t.implicitTiling)}const _o={id:"3d-tiles",name:"3D Tiles",module:"3d-tiles",version:Mr,extensions:["cmpt","pnts","b3dm","i3dm"],mimeTypes:["application/octet-stream"],tests:["cmpt","pnts","b3dm","i3dm"],parse:async function(t,e,n){const r=e["3d-tiles"]||{};let i;return i="auto"===r.isTileset?n.url&&-1!==n.url.indexOf(".json"):r.isTileset,t=i?await async function(t,e,n){var r;const i=JSON.parse((new TextDecoder).decode(t));return i.loader=e.loader||_o,i.url=n.url,i.queryString=n.queryString,i.basePath=(o=i,Cn.pD(o.url)),i.root=await async function(t,e){const n=t.basePath;let r;const i=bo(null==t?void 0:t.root);r=i&&t.root?await vo(t.root,t,i,e):mo(t.root,t);const o=[];for(o.push(r);o.length>0;){const r=(o.pop()||{}).children||[];for(let i of r){const r=bo(i);r?i=await vo(i,t,r,e):mo(i,{basePath:n}),o.push(i)}}return r}(i,e),i.type=zn,i.lodMetricType=Vn,i.lodMetricValue=(null===(r=i.root)||void 0===r?void 0:r.lodMetricValue)||0,i;var o}(t,e,n):await async function(t,e,n){const r={content:{featureIds:null}};return await pi(t,0,e,n,r.content),r.content}(t,e,n),t},options:{"3d-tiles":{loadGLTF:!0,decodeQuantizedPositions:!1,isTileset:"auto",assetGltfUpAxis:null}}},Ao=[0],xo={getPointColor:{type:"accessor",value:[0,0,0,255]},pointSize:1,data:"",loader:_o,onTilesetLoad:{type:"function",value:t=>{}},onTileLoad:{type:"function",value:t=>{}},onTileUnload:{type:"function",value:t=>{}},onTileError:{type:"function",value:(t,e,n)=>{}},_getMeshColor:{type:"function",value:t=>[255,255,255]}};class wo extends i.A{constructor(...t){super(...t),(0,r.A)(this,"state",void 0)}initializeState(){"onTileLoadFail"in this.props&&He.A.removed("onTileLoadFail","onTileError")(),this.state={layerMap:{},tileset3d:null,activeViewports:{},lastUpdatedViewports:null}}get isLoaded(){var t,e;return Boolean((null===(t=this.state)||void 0===t||null===(e=t.tileset3d)||void 0===e?void 0:e.isLoaded())&&super.isLoaded)}shouldUpdateState({changeFlags:t}){return t.somethingChanged}updateState({props:t,oldProps:e,changeFlags:n}){if(t.data&&t.data!==e.data&&this._loadTileset(t.data),n.viewportChanged){const{activeViewports:t}=this.state;Object.keys(t).length&&(this._updateTileset(t),this.state.lastUpdatedViewports=t,this.state.activeViewports={})}if(n.propsChanged){const{layerMap:t}=this.state;for(const e in t)t[e].needsUpdate=!0}}activateViewport(t){const{activeViewports:e,lastUpdatedViewports:n}=this.state;this.internalState.viewport=t,e[t.id]=t;const r=null==n?void 0:n[t.id];r&&t.equals(r)||(this.setChangeFlags({viewportChanged:!0}),this.setNeedsUpdate())}getPickingInfo({info:t,sourceLayer:e}){const n=e&&e.props.tile;return t.picked&&(t.object=n),t.sourceTile=n,t}filterSubLayer({layer:t,viewport:e}){const{tile:n}=t.props,{id:r}=e;return n.selected&&n.viewportIds.includes(r)}_updateAutoHighlight(t){const e=t.sourceTile,n=this.state.layerMap[null==e?void 0:e.id];n&&n.layer&&n.layer.updateAutoHighlight(t)}async _loadTileset(t){const{loadOptions:e={}}=this.props;let n=this.props.loader||this.props.loaders;Array.isArray(n)&&(n=n[0]);const r={loadOptions:{...e}};let i=t;if(n.preload){const o=await n.preload(t,e);o.url&&(i=o.url),o.headers&&(r.loadOptions.fetch={...r.loadOptions.fetch,headers:o.headers}),Object.assign(r,o)}const o=await(0,Qe.load)(i,n,r.loadOptions),s=new Er(o,{onTileLoad:this._onTileLoad.bind(this),onTileUnload:this._onTileUnload.bind(this),onTileError:this.props.onTileError,...r});this.setState({tileset3d:s,layerMap:{}}),this._updateTileset(this.state.activeViewports),this.props.onTilesetLoad(s)}_onTileLoad(t){const{lastUpdatedViewports:e}=this.state;this.props.onTileLoad(t),this._updateTileset(e),this.setNeedsUpdate()}_onTileUnload(t){delete this.state.layerMap[t.id],this.props.onTileUnload(t)}_updateTileset(t){if(!t)return;const{tileset3d:e}=this.state,{timeline:n}=this.context,r=Object.keys(t).length;n&&r&&e&&e.selectTiles(Object.values(t)).then((t=>{this.state.frameNumber!==t&&this.setState({frameNumber:t})}))}_getSubLayer(t,e){if(!t.content)return null;switch(t.type){case Gn.POINTCLOUD:return this._makePointCloudLayer(t,e);case Gn.SCENEGRAPH:return this._make3DModelLayer(t);case Gn.MESH:return this._makeSimpleMeshLayer(t,e);default:throw new Error("Tile3DLayer: Failed to render layer of type ".concat(t.content.type))}}_makePointCloudLayer(t,e){const{attributes:n,pointCount:r,constantRGBA:i,cartographicOrigin:o,modelMatrix:a}=t.content,{positions:l,normals:u,colors:c}=n;if(!l)return null;const h=e&&e.props.data||{header:{vertexCount:r},attributes:{POSITION:l,NORMAL:u,COLOR_0:c}},{pointSize:d,getPointColor:f}=this.props;return new(this.getSubLayerClass("pointcloud",qe.A))({pointSize:d},this.getSubLayerProps({id:"pointcloud"}),{id:"".concat(this.id,"-pointcloud-").concat(t.id),tile:t,data:h,coordinateSystem:s.rf.METER_OFFSETS,coordinateOrigin:o,modelMatrix:a,getColor:i||f,_offset:0})}_make3DModelLayer(t){const{gltf:e,instances:n,cartographicOrigin:r,modelMatrix:i}=t.content;return new(this.getSubLayerClass("scenegraph",We.A))({_lighting:"pbr"},this.getSubLayerProps({id:"scenegraph"}),{id:"".concat(this.id,"-scenegraph-").concat(t.id),tile:t,data:n||Ao,scenegraph:e,coordinateSystem:s.rf.METER_OFFSETS,coordinateOrigin:r,modelMatrix:i,getTransformMatrix:t=>t.modelMatrix,getPosition:[0,0,0],_offset:0})}_makeSimpleMeshLayer(t,e){const n=t.content,{attributes:r,indices:i,modelMatrix:o,cartographicOrigin:a,coordinateSystem:l=s.rf.METER_OFFSETS,material:u,featureIds:c}=n,{_getMeshColor:h}=this.props,d=e&&e.props.mesh||new Ve.A({drawMode:4,attributes:Co(r),indices:i});return new(this.getSubLayerClass("mesh",Ze))(this.getSubLayerProps({id:"mesh"}),{id:"".concat(this.id,"-mesh-").concat(t.id),tile:t,mesh:d,data:Ao,getColor:h(t),pbrMaterial:u,modelMatrix:o,coordinateOrigin:a,coordinateSystem:l,featureIds:c,_offset:0})}renderLayers(){const{tileset3d:t,layerMap:e}=this.state;return t?t.tiles.map((t=>{const n=e[t.id]=e[t.id]||{tile:t};let{layer:r}=n;return t.selected&&(r?n.needsUpdate&&(r=this._getSubLayer(t,r),n.needsUpdate=!1):r=this._getSubLayer(t)),n.layer=r,r})).filter(Boolean):null}}function Co(t){const e={};return e.positions={...t.positions,value:new Float32Array(t.positions.value)},t.normals&&(e.normals=t.normals),t.texCoords&&(e.texCoords=t.texCoords),t.colors&&(e.colors=t.colors),t.uvRegions&&(e.uvRegions=t.uvRegions),e}(0,r.A)(wo,"defaultProps",xo),(0,r.A)(wo,"layerName","Tile3DLayer");const So=[1],Eo={...Ie.defaultProps,elevationData:he,texture:{...he,optional:!0},meshMaxError:{type:"number",value:4},bounds:{type:"array",value:null,optional:!0,compare:!0},color:{type:"color",value:[255,255,255]},elevationDecoder:{type:"object",value:{rScaler:1,gScaler:0,bScaler:0,offset:0}},workerUrl:"",wireframe:!1,material:!0,loaders:[{name:"Terrain",id:"terrain",module:"terrain",version:"3.4.15",worker:!0,extensions:["png","pngraw","jpg","jpeg","gif","webp","bmp"],mimeTypes:["image/png","image/jpeg","image/gif","image/webp","image/bmp"],options:{terrain:{tesselator:"auto",bounds:null,meshMaxError:10,elevationDecoder:{rScaler:1,gScaler:0,bScaler:0,offset:0},skirtHeight:null}}}]};function Mo(t){return Array.isArray(t)?t.join(";"):t||""}class Po extends i.A{constructor(...t){super(...t),(0,r.A)(this,"state",void 0)}updateState({props:t,oldProps:e}){const n=t.elevationData!==e.elevationData;if(n){const{elevationData:e}=t,n=e&&(Array.isArray(e)||e.includes("{x}")&&e.includes("{y}"));this.setState({isTiled:n})}const r=n||t.meshMaxError!==e.meshMaxError||t.elevationDecoder!==e.elevationDecoder||t.bounds!==e.bounds;if(!this.state.isTiled&&r){const e=this.loadTerrain(t);this.setState({terrain:e})}t.workerUrl&&He.A.removed("workerUrl","loadOptions.terrain.workerUrl")()}loadTerrain({elevationData:t,bounds:e,elevationDecoder:n,meshMaxError:r,signal:i}){var o;if(!t)return null;let s=this.getLoadOptions();s={...s,terrain:{skirtHeight:this.state.isTiled?2*r:0,...null===(o=s)||void 0===o?void 0:o.terrain,bounds:e,meshMaxError:r,elevationDecoder:n}};const{fetch:a}=this.props;return a(t,{propName:"elevationData",layer:this,loadOptions:s,signal:i})}getTiledTerrainData(t){const{elevationData:e,fetch:n,texture:r,elevationDecoder:i,meshMaxError:o}=this.props,{viewport:s}=this.context,a=fe(e,t),l=r&&fe(r,t),{signal:u}=t;let c=[0,0],h=[0,0];if(s.isGeospatial){const e=t.bbox;c=s.projectFlat([e.west,e.south]),h=s.projectFlat([e.east,e.north])}else{const e=t.bbox;c=[e.left,e.bottom],h=[e.right,e.top]}const d=[c[0],c[1],h[0],h[1]],f=this.loadTerrain({elevationData:a,bounds:d,elevationDecoder:i,meshMaxError:o,signal:u}),p=l?n(l,{propName:"texture",layer:this,loaders:[],signal:u}).catch((t=>null)):Promise.resolve(null);return Promise.all([f,p])}renderSubLayers(t){const e=this.getSubLayerClass("mesh",Ke.A),{color:n,wireframe:r,material:i}=this.props,{data:o}=t;if(!o)return null;const[a,l]=o;return new e(t,{data:So,mesh:a,texture:l,_instanced:!1,coordinateSystem:s.rf.CARTESIAN,getPosition:t=>[0,0,0],getColor:n,wireframe:r,material:i})}onViewportLoad(t){if(!t)return;const{zRange:e}=this.state,n=t.map((t=>t.content)).filter(Boolean).map((t=>t[0].header.boundingBox.map((t=>t[2]))));if(0===n.length)return;const r=Math.min(...n.map((t=>t[0]))),i=Math.max(...n.map((t=>t[1])));(!e||r<e[0]||i>e[1])&&this.setState({zRange:[r,i]})}renderLayers(){const{color:t,material:e,elevationData:n,texture:r,wireframe:i,meshMaxError:o,elevationDecoder:s,tileSize:a,maxZoom:l,minZoom:u,extent:c,maxRequests:h,onTileLoad:d,onTileUnload:f,onTileError:p,maxCacheSize:g,maxCacheByteSize:y,refinementStrategy:m}=this.props;return this.state.isTiled?new Ie(this.getSubLayerProps({id:"tiles"}),{getTileData:this.getTiledTerrainData.bind(this),renderSubLayers:this.renderSubLayers.bind(this),updateTriggers:{getTileData:{elevationData:Mo(n),texture:Mo(r),meshMaxError:o,elevationDecoder:s}},onViewportLoad:this.onViewportLoad.bind(this),zRange:this.state.zRange||null,tileSize:a,maxZoom:l,minZoom:u,extent:c,maxRequests:h,onTileLoad:d,onTileUnload:f,onTileError:p,maxCacheSize:g,maxCacheByteSize:y,refinementStrategy:m}):n?new(this.getSubLayerClass("mesh",Ke.A))(this.getSubLayerProps({id:"mesh"}),{data:So,mesh:this.state.terrain,texture:r,_instanced:!1,getPosition:t=>[0,0,0],getColor:t,material:e,wireframe:i}):null}}(0,r.A)(Po,"defaultProps",Eo),(0,r.A)(Po,"layerName","TerrainLayer");var To=n(96042);n(34439);n(15335);function Oo(t,e){const n=null==e?void 0:e.globalFeatureId;return void 0!==n?function(t,e){const n=Ro(t);for(const t of n){let n=0,r=t.featureIds.value[0];for(let i=0;i<t.featureIds.value.length;i++){const o=t.featureIds.value[i];if(o!==r){if(e===t.globalFeatureIds.value[n])return Bo(t,n,i);n=i,r=o}}if(e===t.globalFeatureIds.value[n])return Bo(t,n,t.featureIds.value.length)}throw new Error("featureId:".concat(e," not found"))}(t,n):function(t,e){return function(t){const e=[];for(const n of t){if(0===n.featureIds.value.length)continue;let t=0,r=n.featureIds.value[0];for(let i=0;i<n.featureIds.value.length;i++){const o=n.featureIds.value[i];o!==r&&(e.push(Bo(n,t,i)),t=i,r=o)}e.push(Bo(n,t,n.featureIds.value.length))}return e}(Ro(t,e))}(t,null==e?void 0:e.type)}function Io(t,e,n){switch(t.type){case"Point":return function(t,e,n){const{positions:r}=t,i=ko(r,e,n);return i.length>1?{type:"MultiPoint",coordinates:i}:{type:"Point",coordinates:i[0]}}(t,e,n);case"LineString":return function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1/0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0;const{positions:r}=t,i=t.pathIndices.value.filter((t=>t>=e&&t<=n));if(!(i.length>2))return{type:"LineString",coordinates:ko(r,i[0],i[1])};const o=[];for(let t=0;t<i.length-1;t++){const e=ko(r,i[t],i[t+1]);o.push(e)}return{type:"MultiLineString",coordinates:o}}(t,e,n);case"Polygon":return Lo(t,e,n);default:throw new Error("Unsupported geometry type: ".concat(null==t?void 0:t.type))}}function Ro(t,e){if(!Boolean(t.points||t.lines||t.polygons))return t.type=e||function(t){return t.pathIndices?"LineString":t.polygonIndices?"Polygon":"Point"}(t),[t];const n=[];return t.points&&(t.points.type="Point",n.push(t.points)),t.lines&&(t.lines.type="LineString",n.push(t.lines)),t.polygons&&(t.polygons.type="Polygon",n.push(t.polygons)),n}function Bo(t,e,n){const r=Io(t,e,n),i=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=Object.assign({},t.properties[t.featureIds.value[e]]);for(const r in t.numericProps)n[r]=t.numericProps[r].value[e];return n}(t,e,n),o=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t.fields&&t.fields[t.featureIds.value[e]]}(t,e,n);return{type:"Feature",geometry:r,properties:i,...o}}function Lo(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1/0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0;const{positions:r}=t,i=t.polygonIndices.value.filter((t=>t>=e&&t<=n)),o=t.primitivePolygonIndices.value.filter((t=>t>=e&&t<=n));if(!(i.length>2)){const t=[];for(let e=0;e<o.length-1;e++){const n=ko(r,o[e],o[e+1]);t.push(n)}return{type:"Polygon",coordinates:t}}const s=[];for(let e=0;e<i.length-1;e++){const n=Lo(t,i[e],i[e+1]).coordinates;s.push(n)}return{type:"MultiPolygon",coordinates:s}}function ko(t,e,n){e=e||0,n=n||t.value.length/t.size;const r=[];for(let i=e;i<n;i++){const e=Array();for(let n=i*t.size;n<(i+1)*t.size;n++)e.push(Number(t.value[n]));r.push(e)}return r}const Do={Point:Fo,MultiPoint:function(t,e,n){return No(t,e,n)},LineString:jo,MultiLineString:function(t,e,n){return t.map((t=>jo(t,e,n)))},Polygon:Go,MultiPolygon:function(t,e,n){return t.map((t=>Go(t,e,n)))}};function Fo([t,e],[n,r],i){const o=(0,ut.Cc)(n[0],r[0],t),s=(0,ut.Cc)(n[1],r[1],e);return i.unprojectFlat([o,s])}function No(t,e,n){return t.map((t=>Fo(t,e,n)))}function jo(t,e,n){return No(t,e,n)}function Go(t,e,n){return t.map((t=>No(t,e,n)))}const Uo=["points","lines","polygons"];function zo(t,e,n,r){const i=t.featureIds.value;if(!i.length)return-1;let o=0,s=i[i.length-1]+1;if(r){const e=function(t,e){if(!t.__layers){const e={},{properties:n}=t;for(let t=0;t<n.length;t++){const{layerName:r}=n[t];r&&(e[r]?e[r][1]=t:e[r]=[t,t])}t.__layers=e}return t.__layers[e]}(t,r);if(!e)return-1;o=e[0],s=e[1]+1}let a=-1;if(e in t.numericProps){const r=t.numericProps[e].value.findIndex(((t,e)=>t===n&&i[e]>=o&&i[e]<s));return r>=0?t.globalFeatureIds.value[r]:-1}return e?a=Vo(t.properties,(t=>t[e]===n),o,s):t.fields&&(a=Vo(t.fields,(t=>t.id===n),o,s)),a>=0?function(t,e){if(!t.__ids){const e=[],n=t.featureIds.value,r=t.globalFeatureIds.value;for(let t=0;t<n.length;t++)e[n[t]]=r[t];t.__ids=e}return t.__ids[e]}(t,a):-1}function Vo(t,e,n,r){for(let i=n;i<r;i++)if(e(t[i],i))return i;return-1}const Ho={...st.A.defaultProps,data:he,onDataLoad:{type:"function",value:null,optional:!0,compare:!1},uniqueIdProperty:"",highlightedFeatureId:null,loaders:[{name:"Mapbox Vector Tile",id:"mvt",module:"mvt",version:"3.4.15",extensions:["mvt","pbf"],mimeTypes:["application/vnd.mapbox-vector-tile","application/x-protobuf"],worker:!0,category:"geometry",options:{mvt:{shape:"geojson",coordinates:"local",layerProperty:"layerName",layers:void 0,tileIndex:null}}}],binary:!0};class qo extends Ie{constructor(...t){super(...t),(0,r.A)(this,"state",void 0)}initializeState(){super.initializeState();const t=void 0===this.context.viewport.resolution&&this.props.binary;this.setState({binary:t,data:null,tileJSON:null,hoveredFeatureId:null,hoveredFeatureLayerName:null})}get isLoaded(){var t;return Boolean((null===(t=this.state)||void 0===t?void 0:t.data)&&super.isLoaded)}updateState({props:t,oldProps:e,context:n,changeFlags:r}){var i;r.dataChanged&&this._updateTileData(),null!==(i=this.state)&&void 0!==i&&i.data&&(super.updateState({props:t,oldProps:e,context:n,changeFlags:r}),this._setWGS84PropertyForTiles());const{highlightColor:o}=t;o!==e.highlightColor&&Array.isArray(o)&&this.setState({highlightColor:o})}async _updateTileData(){let t=this.props.data,e=null;if("string"!=typeof t||/(?=.*{z})(?=.*{x})(?=.*({y}|{-y}))/.test(t))t&&"object"==typeof t&&"tilejson"in t&&(e=t);else{const{onDataLoad:n,fetch:r}=this.props;this.setState({data:null,tileJSON:null});try{e=await r(t,{propName:"data",layer:this,loaders:[]})}catch(e){this.raiseError(e,"loading TileJSON"),t=null}n&&n(e,{propName:"data",layer:this})}e&&(t=e.tiles),this.setState({data:t,tileJSON:e})}_getTilesetOptions(){const t=super._getTilesetOptions(),e=this.state.tileJSON,{minZoom:n,maxZoom:r}=this.props;return e&&(Number.isFinite(e.minzoom)&&e.minzoom>n&&(t.minZoom=e.minzoom),Number.isFinite(e.maxzoom)&&(!Number.isFinite(r)||e.maxzoom<r)&&(t.maxZoom=e.maxzoom)),t}renderLayers(){var t;return null!==(t=this.state)&&void 0!==t&&t.data?super.renderLayers():null}getTileData(t){var e;const{data:n,binary:r}=this.state,{index:i,signal:o}=t,s=fe(n,t);if(!s)return Promise.reject("Invalid URL");let a=this.getLoadOptions();const{fetch:l}=this.props;return a={...a,mimeType:"application/x-protobuf",mvt:{...null===(e=a)||void 0===e?void 0:e.mvt,coordinates:this.context.viewport.resolution?"wgs84":"local",tileIndex:i},gis:r?{format:"binary"}:{}},l(s,{propName:"data",layer:this,loadOptions:a,signal:o})}renderSubLayers(t){const{x:e,y:n,z:r}=t.tile.index,i=Math.pow(2,r),o=512/i,a=-o,l=512*e/i,u=512*(1-n/i),c=(new lt.A).scale([o,a,1]);t.autoHighlight=!1,this.context.viewport.resolution||(t.modelMatrix=c,t.coordinateOrigin=[l,u,0],t.coordinateSystem=s.rf.CARTESIAN,t.extensions=[...t.extensions||[],new To.A]);const h=super.renderSubLayers(t);return!this.state.binary||h instanceof st.A||He.A.warn("renderSubLayers() must return GeoJsonLayer when using binary:true")(),h}_updateAutoHighlight(t){const{uniqueIdProperty:e}=this.props,{hoveredFeatureId:n,hoveredFeatureLayerName:r}=this.state,i=t.object;let o=null,s=null;i&&(o=Wo(i,e),s=Jo(i));let{highlightColor:a}=this.props;"function"==typeof a&&(a=a(t)),n===o&&r===s||this.setState({highlightColor:a,hoveredFeatureId:o,hoveredFeatureLayerName:s})}getPickingInfo(t){const e=super.getPickingInfo(t),n=Boolean(this.context.viewport.resolution);if(this.state.binary&&-1!==e.index){const{data:n}=t.sourceLayer.props;e.object=Oo(n,{globalFeatureId:e.index})}return e.object&&!n&&(e.object=Xo(e.object,e.tile.bbox,this.context.viewport)),e}getSubLayerPropsByTile(t){return{highlightedObjectIndex:this.getHighlightedObjectIndex(t),highlightColor:this.state.highlightColor}}getHighlightedObjectIndex(t){const{hoveredFeatureId:e,hoveredFeatureLayerName:n,binary:r}=this.state,{uniqueIdProperty:i,highlightedFeatureId:o}=this.props,s=t.content,a=Yo(o);if(!Yo(e)&&!a)return-1;const l=a?o:e;return Array.isArray(s)?s.findIndex((t=>{const e=Wo(t,i)===l,r=a||Jo(t)===n;return e&&r})):s&&r?function(t,e,n,r){for(const i of Uo){const o=t[i]&&zo(t[i],e,n,r);if(o>=0)return o}return-1}(s,i,l,a?"":n):-1}_pickObjects(t){const{deck:e,viewport:n}=this.context,r=n.width,i=n.height,o=n.x,s=n.y,a=[this.id];return e.pickObjects({x:o,y:s,width:r,height:i,layerIds:a,maxObjects:t})}getRenderedFeatures(t=null){const e=this._pickObjects(t),n=new Set,r=[];for(const t of e){const e=Wo(t.object,this.props.uniqueIdProperty);void 0===e?r.push(t.object):n.has(e)||(n.add(e),r.push(t.object))}return r}_setWGS84PropertyForTiles(){const t="dataInWGS84";this.state.tileset.selectedTiles.forEach((e=>{e.hasOwnProperty(t)||Object.defineProperty(e,t,{get:()=>{if(!e.content)return null;if(this.state.binary&&Array.isArray(e.content)&&!e.content.length)return[];const{bbox:t}=e;if(void 0===e._contentWGS84&&(n=t,Number.isFinite(n.west)&&Number.isFinite(n.north)&&Number.isFinite(n.east)&&Number.isFinite(n.south))){const n=this.state.binary?Oo(e.content):e.content;e._contentWGS84=n.map((e=>Xo(e,t,this.context.viewport)))}var n;return e._contentWGS84}})}))}}function Wo(t,e){return t.properties&&e?t.properties[e]:"id"in t?t.id:void 0}function Jo(t){var e;return(null===(e=t.properties)||void 0===e?void 0:e.layerName)||null}function Yo(t){return null!=t&&""!==t}function Xo(t,e,n){const r={...t,geometry:{type:t.geometry.type}};return Object.defineProperty(r.geometry,"coordinates",{get:()=>{const r=function(t,e,n){const r=[n.projectFlat([e.west,e.north]),n.projectFlat([e.east,e.south])];return{...t,coordinates:Do[t.type](t.coordinates,r,n)}}(t.geometry,e,n);return r.coordinates}}),r}(0,r.A)(qo,"layerName","MVTLayer"),(0,r.A)(qo,"defaultProps",Ho);const Ko={};for(let t=0;t<32;t++)Ko["0123456789bcdefghjkmnpqrstuvwxyz".charAt(t)]=t;class Zo extends q{indexToBounds(){const{data:t,getGeohash:e}=this.props;return{data:t,_normalize:!1,positionFormat:"XY",getPolygon:(t,n)=>function(t){const[e,n,r,i]=function(t){let e,n=!0,r=90,i=-90,o=180,s=-180,a=0;for(let l=0,u=t.length;l<u;l++){const u=t[l].toLowerCase();a=Ko[u];for(let t=4;t>=0;t--){const l=a>>t&1;n?(e=(o+s)/2,1===l?s=e:o=e):(e=(r+i)/2,1===l?i=e:r=e),n=!n}}return[i,s,r,o]}(t);return[i,r,i,e,n,e,n,r,i,r]}(e(t,n))}}}(0,r.A)(Zo,"layerName","GeohashLayer"),(0,r.A)(Zo,"defaultProps",{getGeohash:{type:"accessor",value:t=>t.geohash}})},69002:(t,e,n)=>{"use strict";n.d(e,{A:()=>d});var r=n(67136),i=n(36179),o=n(79464),s=n(70560),a=n(1597),l=n(76694),u=n(82170);const c=[0,0,0,255],h={getSourcePosition:{type:"accessor",value:t=>t.sourcePosition},getTargetPosition:{type:"accessor",value:t=>t.targetPosition},getSourceColor:{type:"accessor",value:c},getTargetColor:{type:"accessor",value:c},getWidth:{type:"accessor",value:1},getHeight:{type:"accessor",value:1},getTilt:{type:"accessor",value:0},greatCircle:!1,numSegments:{type:"number",value:50,min:1},widthUnits:"pixels",widthScale:{type:"number",value:1,min:0},widthMinPixels:{type:"number",value:0,min:0},widthMaxPixels:{type:"number",value:Number.MAX_SAFE_INTEGER,min:0}};class d extends i.A{constructor(...t){super(...t),(0,r.A)(this,"state",void 0)}getBounds(){var t;return null===(t=this.getAttributeManager())||void 0===t?void 0:t.getBounds(["instanceSourcePositions","instanceTargetPositions"])}getShaders(){return super.getShaders({vs:"#define SHADER_NAME arc-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec4 instanceSourceColors;\nattribute vec4 instanceTargetColors;\nattribute vec3 instanceSourcePositions;\nattribute vec3 instanceSourcePositions64Low;\nattribute vec3 instanceTargetPositions;\nattribute vec3 instanceTargetPositions64Low;\nattribute vec3 instancePickingColors;\nattribute float instanceWidths;\nattribute float instanceHeights;\nattribute float instanceTilts;\n\nuniform bool greatCircle;\nuniform bool useShortestPath;\nuniform float numSegments;\nuniform float opacity;\nuniform float widthScale;\nuniform float widthMinPixels;\nuniform float widthMaxPixels;\nuniform int widthUnits;\n\nvarying vec4 vColor;\nvarying vec2 uv;\nvarying float isValid;\n\nfloat paraboloid(float distance, float sourceZ, float targetZ, float ratio) {\n\n  float deltaZ = targetZ - sourceZ;\n  float dh = distance * instanceHeights;\n  if (dh == 0.0) {\n    return sourceZ + deltaZ * ratio;\n  }\n  float unitZ = deltaZ / dh;\n  float p2 = unitZ * unitZ + 1.0;\n  float dir = step(deltaZ, 0.0);\n  float z0 = mix(sourceZ, targetZ, dir);\n  float r = mix(ratio, 1.0 - ratio, dir);\n  return sqrt(r * (p2 - r)) * dh + z0;\n}\nvec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction, float width) {\n  vec2 dir_screenspace = normalize(line_clipspace * project_uViewportSize);\n  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n\n  return dir_screenspace * offset_direction * width / 2.0;\n}\n\nfloat getSegmentRatio(float index) {\n  return smoothstep(0.0, 1.0, index / (numSegments - 1.0));\n}\n\nvec3 interpolateFlat(vec3 source, vec3 target, float segmentRatio) {\n  float distance = length(source.xy - target.xy);\n  float z = paraboloid(distance, source.z, target.z, segmentRatio);\n\n  float tiltAngle = radians(instanceTilts);\n  vec2 tiltDirection = normalize(target.xy - source.xy);\n  vec2 tilt = vec2(-tiltDirection.y, tiltDirection.x) * z * sin(tiltAngle);\n\n  return vec3(\n    mix(source.xy, target.xy, segmentRatio) + tilt,\n    z * cos(tiltAngle)\n  );\n}\nfloat getAngularDist (vec2 source, vec2 target) {\n  vec2 sourceRadians = radians(source);\n  vec2 targetRadians = radians(target);\n  vec2 sin_half_delta = sin((sourceRadians - targetRadians) / 2.0);\n  vec2 shd_sq = sin_half_delta * sin_half_delta;\n\n  float a = shd_sq.y + cos(sourceRadians.y) * cos(targetRadians.y) * shd_sq.x;\n  return 2.0 * asin(sqrt(a));\n}\n\nvec3 interpolateGreatCircle(vec3 source, vec3 target, vec3 source3D, vec3 target3D, float angularDist, float t) {\n  vec2 lngLat;\n  if(abs(angularDist - PI) < 0.001) {\n    lngLat = (1.0 - t) * source.xy + t * target.xy;\n  } else {\n    float a = sin((1.0 - t) * angularDist);\n    float b = sin(t * angularDist);\n    vec3 p = source3D.yxz * a + target3D.yxz * b;\n    lngLat = degrees(vec2(atan(p.y, -p.x), atan(p.z, length(p.xy))));\n  }\n\n  float z = paraboloid(angularDist * EARTH_RADIUS, source.z, target.z, t);\n\n  return vec3(lngLat, z);\n}\n\nvoid main(void) {\n  geometry.worldPosition = instanceSourcePositions;\n  geometry.worldPositionAlt = instanceTargetPositions;\n\n  float segmentIndex = positions.x;\n  float segmentRatio = getSegmentRatio(segmentIndex);\n  float prevSegmentRatio = getSegmentRatio(max(0.0, segmentIndex - 1.0));\n  float nextSegmentRatio = getSegmentRatio(min(numSegments - 1.0, segmentIndex + 1.0));\n  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));\n  isValid = 1.0;\n\n  uv = vec2(segmentRatio, positions.y);\n  geometry.uv = uv;\n  geometry.pickingColor = instancePickingColors;\n\n  vec4 curr;\n  vec4 next;\n  vec3 source;\n  vec3 target;\n\n  if ((greatCircle || project_uProjectionMode == PROJECTION_MODE_GLOBE) && project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n    source = project_globe_(vec3(instanceSourcePositions.xy, 0.0));\n    target = project_globe_(vec3(instanceTargetPositions.xy, 0.0));\n    float angularDist = getAngularDist(instanceSourcePositions.xy, instanceTargetPositions.xy);\n\n    vec3 prevPos = interpolateGreatCircle(instanceSourcePositions, instanceTargetPositions, source, target, angularDist, prevSegmentRatio);\n    vec3 currPos = interpolateGreatCircle(instanceSourcePositions, instanceTargetPositions, source, target, angularDist, segmentRatio);\n    vec3 nextPos = interpolateGreatCircle(instanceSourcePositions, instanceTargetPositions, source, target, angularDist, nextSegmentRatio);\n\n    if (abs(currPos.x - prevPos.x) > 180.0) {\n      indexDir = -1.0;\n      isValid = 0.0;\n    } else if (abs(currPos.x - nextPos.x) > 180.0) {\n      indexDir = 1.0;\n      isValid = 0.0;\n    }\n    nextPos = indexDir < 0.0 ? prevPos : nextPos;\n    nextSegmentRatio = indexDir < 0.0 ? prevSegmentRatio : nextSegmentRatio;\n\n    if (isValid == 0.0) {\n      nextPos.x += nextPos.x > 0.0 ? -360.0 : 360.0;\n      float t = ((currPos.x > 0.0 ? 180.0 : -180.0) - currPos.x) / (nextPos.x - currPos.x);\n      currPos = mix(currPos, nextPos, t);\n      segmentRatio = mix(segmentRatio, nextSegmentRatio, t);\n    }\n\n    vec3 currPos64Low = mix(instanceSourcePositions64Low, instanceTargetPositions64Low, segmentRatio);\n    vec3 nextPos64Low = mix(instanceSourcePositions64Low, instanceTargetPositions64Low, nextSegmentRatio);\n  \n    curr = project_position_to_clipspace(currPos, currPos64Low, vec3(0.0), geometry.position);\n    next = project_position_to_clipspace(nextPos, nextPos64Low, vec3(0.0));\n  \n  } else {\n    vec3 source_world = instanceSourcePositions;\n    vec3 target_world = instanceTargetPositions;\n    if (useShortestPath) {\n      source_world.x = mod(source_world.x + 180., 360.0) - 180.;\n      target_world.x = mod(target_world.x + 180., 360.0) - 180.;\n\n      float deltaLng = target_world.x - source_world.x;\n      if (deltaLng > 180.) target_world.x -= 360.;\n      if (deltaLng < -180.) source_world.x -= 360.;\n    }\n    source = project_position(source_world, instanceSourcePositions64Low);\n    target = project_position(target_world, instanceTargetPositions64Low);\n    float antiMeridianX = 0.0;\n\n    if (useShortestPath) {\n      if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {\n        antiMeridianX = -(project_uCoordinateOrigin.x + 180.) / 360. * TILE_SIZE;\n      }\n      float thresholdRatio = (antiMeridianX - source.x) / (target.x - source.x);\n\n      if (prevSegmentRatio <= thresholdRatio && nextSegmentRatio > thresholdRatio) {\n        isValid = 0.0;\n        indexDir = sign(segmentRatio - thresholdRatio);\n        segmentRatio = thresholdRatio;\n      }\n    }\n\n    nextSegmentRatio = indexDir < 0.0 ? prevSegmentRatio : nextSegmentRatio;\n    vec3 currPos = interpolateFlat(source, target, segmentRatio);\n    vec3 nextPos = interpolateFlat(source, target, nextSegmentRatio);\n\n    if (useShortestPath) {\n      if (nextPos.x < antiMeridianX) {\n        currPos.x += TILE_SIZE;\n        nextPos.x += TILE_SIZE;\n      }\n    }\n\n    curr = project_common_position_to_clipspace(vec4(currPos, 1.0));\n    next = project_common_position_to_clipspace(vec4(nextPos, 1.0));\n    geometry.position = vec4(currPos, 1.0);\n  }\n  float widthPixels = clamp(\n    project_size_to_pixel(instanceWidths * widthScale, widthUnits),\n    widthMinPixels, widthMaxPixels\n  );\n  vec3 offset = vec3(\n    getExtrusionOffset((next.xy - curr.xy) * indexDir, positions.y, widthPixels),\n    0.0);\n  DECKGL_FILTER_SIZE(offset, geometry);\n  DECKGL_FILTER_GL_POSITION(curr, geometry);\n  gl_Position = curr + vec4(project_pixel_size_to_clipspace(offset.xy), 0.0, 0.0);\n\n  vec4 color = mix(instanceSourceColors, instanceTargetColors, segmentRatio);\n  vColor = vec4(color.rgb, color.a * opacity);\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#define SHADER_NAME arc-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\nvarying vec2 uv;\nvarying float isValid;\n\nvoid main(void) {\n  if (isValid == 0.0) {\n    discard;\n  }\n\n  gl_FragColor = vColor;\n  geometry.uv = uv;\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[o.A,s.A]})}get wrapLongitude(){return!1}initializeState(){this.getAttributeManager().addInstanced({instanceSourcePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getSourcePosition"},instanceTargetPositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getTargetPosition"},instanceSourceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getSourceColor",defaultValue:c},instanceTargetColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getTargetColor",defaultValue:c},instanceWidths:{size:1,transition:!0,accessor:"getWidth",defaultValue:1},instanceHeights:{size:1,transition:!0,accessor:"getHeight",defaultValue:1},instanceTilts:{size:1,transition:!0,accessor:"getTilt",defaultValue:0}})}updateState(t){super.updateState(t);const{props:e,oldProps:n,changeFlags:r}=t;if(r.extensionsChanged||r.propsChanged&&e.numSegments!==n.numSegments){var i;const{gl:t}=this.context;null===(i=this.state.model)||void 0===i||i.delete(),this.state.model=this._getModel(t),this.getAttributeManager().invalidateAll()}}draw({uniforms:t}){const{widthUnits:e,widthScale:n,widthMinPixels:r,widthMaxPixels:i,greatCircle:o,wrapLongitude:s}=this.props;this.state.model.setUniforms(t).setUniforms({greatCircle:o,widthUnits:a.p5[e],widthScale:n,widthMinPixels:r,widthMaxPixels:i,useShortestPath:s}).draw()}_getModel(t){const{id:e,numSegments:n}=this.props;let r=[];for(let t=0;t<n;t++)r=r.concat([t,1,0,t,-1,0]);const i=new l.A(t,{...this.getShaders(),id:e,geometry:new u.A({drawMode:5,attributes:{positions:new Float32Array(r)}}),isInstanced:!0});return i.setUniforms({numSegments:n}),i}}(0,r.A)(d,"layerName","ArcLayer"),(0,r.A)(d,"defaultProps",h)},53313:(t,e,n)=>{"use strict";n.d(e,{A:()=>m});var r=n(67136),i=n(1597),o=n(36179),s=n(79464),a=n(70560),l=n(76694),u=n(82170),c=n(649),h=n(54692);const d=new Uint16Array([0,2,1,0,3,2]),f=new Float32Array([0,1,0,0,1,0,1,1]);function p(t,e,n){return(0,h.Cc)((0,h.Cc)(t[0],t[1],n),(0,h.Cc)(t[3],t[2],n),e)}const g="\n#define SHADER_NAME bitmap-layer-fragment-shader\n\n#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform sampler2D bitmapTexture;\n\nvarying vec2 vTexCoord;\nvarying vec2 vTexPos;\n\nuniform float desaturate;\nuniform vec4 transparentColor;\nuniform vec3 tintColor;\nuniform float opacity;\n\nuniform float coordinateConversion;\nuniform vec4 bounds;\n\n/* projection utils */\nconst float TILE_SIZE = 512.0;\nconst float PI = 3.1415926536;\nconst float WORLD_SCALE = TILE_SIZE / PI / 2.0;\n\n// from degrees to Web Mercator\nvec2 lnglat_to_mercator(vec2 lnglat) {\n  float x = lnglat.x;\n  float y = clamp(lnglat.y, -89.9, 89.9);\n  return vec2(\n    radians(x) + PI,\n    PI + log(tan(PI * 0.25 + radians(y) * 0.5))\n  ) * WORLD_SCALE;\n}\n\n// from Web Mercator to degrees\nvec2 mercator_to_lnglat(vec2 xy) {\n  xy /= WORLD_SCALE;\n  return degrees(vec2(\n    xy.x - PI,\n    atan(exp(xy.y - PI)) * 2.0 - PI * 0.5\n  ));\n}\n/* End projection utils */\n\n// apply desaturation\nvec3 color_desaturate(vec3 color) {\n  float luminance = (color.r + color.g + color.b) * 0.333333333;\n  return mix(color, vec3(luminance), desaturate);\n}\n\n// apply tint\nvec3 color_tint(vec3 color) {\n  return color * tintColor;\n}\n\n// blend with background color\nvec4 apply_opacity(vec3 color, float alpha) {\n  if (transparentColor.a == 0.0) {\n    return vec4(color, alpha);\n  }\n  float blendedAlpha = alpha + transparentColor.a * (1.0 - alpha);\n  float highLightRatio = alpha / blendedAlpha;\n  vec3 blendedRGB = mix(transparentColor.rgb, color, highLightRatio);\n  return vec4(blendedRGB, blendedAlpha);\n}\n\nvec2 getUV(vec2 pos) {\n  return vec2(\n    (pos.x - bounds[0]) / (bounds[2] - bounds[0]),\n    (pos.y - bounds[3]) / (bounds[1] - bounds[3])\n  );\n}\n\n".concat("\nvec3 packUVsIntoRGB(vec2 uv) {\n  // Extract the top 8 bits. We want values to be truncated down so we can add a fraction\n  vec2 uv8bit = floor(uv * 256.);\n\n  // Calculate the normalized remainders of u and v parts that do not fit into 8 bits\n  // Scale and clamp to 0-1 range\n  vec2 uvFraction = fract(uv * 256.);\n  vec2 uvFraction4bit = floor(uvFraction * 16.);\n\n  // Remainder can be encoded in blue channel, encode as 4 bits for pixel coordinates\n  float fractions = uvFraction4bit.x + uvFraction4bit.y * 16.;\n\n  return vec3(uv8bit, fractions) / 255.;\n}\n","\n\nvoid main(void) {\n  vec2 uv = vTexCoord;\n  if (coordinateConversion < -0.5) {\n    vec2 lnglat = mercator_to_lnglat(vTexPos);\n    uv = getUV(lnglat);\n  } else if (coordinateConversion > 0.5) {\n    vec2 commonPos = lnglat_to_mercator(vTexPos);\n    uv = getUV(commonPos);\n  }\n  vec4 bitmapColor = texture2D(bitmapTexture, uv);\n\n  gl_FragColor = apply_opacity(color_tint(color_desaturate(bitmapColor.rgb)), bitmapColor.a * opacity);\n\n  geometry.uv = uv;\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n\n  if (picking_uActive && !picking_uAttribute) {\n    // Since instance information is not used, we can use picking color for pixel index\n    gl_FragColor.rgb = packUVsIntoRGB(uv);\n  }\n}\n"),y={image:{type:"image",value:null,async:!0},bounds:{type:"array",value:[1,0,0,1],compare:!0},_imageCoordinateSystem:i.rf.DEFAULT,desaturate:{type:"number",min:0,max:1,value:0},transparentColor:{type:"color",value:[0,0,0,0]},tintColor:{type:"color",value:[255,255,255]},textureParameters:{type:"object",ignore:!0}};class m extends o.A{constructor(...t){super(...t),(0,r.A)(this,"state",void 0)}getShaders(){return super.getShaders({vs:"\n#define SHADER_NAME bitmap-layer-vertex-shader\n\nattribute vec2 texCoords;\nattribute vec3 positions;\nattribute vec3 positions64Low;\n\nvarying vec2 vTexCoord;\nvarying vec2 vTexPos;\n\nuniform float coordinateConversion;\n\nconst vec3 pickingColor = vec3(1.0, 0.0, 0.0);\n\nvoid main(void) {\n  geometry.worldPosition = positions;\n  geometry.uv = texCoords;\n  geometry.pickingColor = pickingColor;\n\n  gl_Position = project_position_to_clipspace(positions, positions64Low, vec3(0.0), geometry.position);\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  vTexCoord = texCoords;\n\n  if (coordinateConversion < -0.5) {\n    vTexPos = geometry.position.xy + project_uCommonOrigin.xy;\n  } else if (coordinateConversion > 0.5) {\n    vTexPos = geometry.worldPosition.xy;\n  }\n\n  vec4 color = vec4(0.0);\n  DECKGL_FILTER_COLOR(color, geometry);\n}\n",fs:g,modules:[s.A,a.A]})}initializeState(){const t=this.getAttributeManager();t.remove(["instancePickingColors"]);const e=!0;t.add({indices:{size:1,isIndexed:!0,update:t=>t.value=this.state.mesh.indices,noAlloc:e},positions:{size:3,type:5130,fp64:this.use64bitPositions(),update:t=>t.value=this.state.mesh.positions,noAlloc:e},texCoords:{size:2,update:t=>t.value=this.state.mesh.texCoords,noAlloc:e}})}updateState({props:t,oldProps:e,changeFlags:n}){const r=this.getAttributeManager();if(n.extensionsChanged){var i;const{gl:t}=this.context;null===(i=this.state.model)||void 0===i||i.delete(),this.state.model=this._getModel(t),r.invalidateAll()}if(t.bounds!==e.bounds){const t=this.state.mesh,e=this._createMesh();this.state.model.setVertexCount(e.vertexCount);for(const n in e)t&&t[n]!==e[n]&&r.invalidate(n);this.setState({mesh:e,...this._getCoordinateUniforms()})}else t._imageCoordinateSystem!==e._imageCoordinateSystem&&this.setState(this._getCoordinateUniforms())}getPickingInfo(t){const{image:e}=this.props,n=t.info;if(!n.color||!e)return n.bitmap=null,n;const{width:r,height:i}=e;n.index=0;const o=function(t){const[e,n,r]=t;return[(e+(15&r)/16)/256,(n+(240&r)/256)/256]}(n.color),s=[Math.floor(o[0]*r),Math.floor(o[1]*i)];return n.bitmap={size:{width:r,height:i},uv:o,pixel:s},n}disablePickingIndex(){this.setState({disablePicking:!0})}restorePickingColors(){this.setState({disablePicking:!1})}_updateAutoHighlight(t){super._updateAutoHighlight({...t,color:this.encodePickingColor(0)})}_createMesh(){const{bounds:t}=this.props;let e=t;return v(t)&&(e=[[t[0],t[1]],[t[0],t[3]],[t[2],t[3]],[t[2],t[1]]]),function(t,e){if(!e)return function(t){const e=new Float64Array(12);for(let n=0;n<t.length;n++)e[3*n+0]=t[n][0],e[3*n+1]=t[n][1],e[3*n+2]=t[n][2]||0;return{vertexCount:6,positions:e,indices:d,texCoords:f}}(t);const n=Math.max(Math.abs(t[0][0]-t[3][0]),Math.abs(t[1][0]-t[2][0])),r=Math.max(Math.abs(t[1][1]-t[0][1]),Math.abs(t[2][1]-t[3][1])),i=Math.ceil(n/e)+1,o=Math.ceil(r/e)+1,s=(i-1)*(o-1)*6,a=new Uint32Array(s),l=new Float32Array(i*o*2),u=new Float64Array(i*o*3);let c=0,h=0;for(let e=0;e<i;e++){const n=e/(i-1);for(let r=0;r<o;r++){const i=r/(o-1),s=p(t,n,i);u[3*c+0]=s[0],u[3*c+1]=s[1],u[3*c+2]=s[2]||0,l[2*c+0]=n,l[2*c+1]=1-i,e>0&&r>0&&(a[h++]=c-o,a[h++]=c-o-1,a[h++]=c-1,a[h++]=c-o,a[h++]=c-1,a[h++]=c),c++}}return{vertexCount:s,positions:u,indices:a,texCoords:l}}(e,this.context.viewport.resolution)}_getModel(t){return t?new l.A(t,{...this.getShaders(),id:this.props.id,geometry:new u.A({drawMode:4,vertexCount:6}),isInstanced:!1}):null}draw(t){const{uniforms:e,moduleParameters:n}=t,{model:r,coordinateConversion:i,bounds:o,disablePicking:s}=this.state,{image:a,desaturate:l,transparentColor:u,tintColor:c}=this.props;n.pickingActive&&s||a&&r&&r.setUniforms(e).setUniforms({bitmapTexture:a,desaturate:l,transparentColor:u.map((t=>t/255)),tintColor:c.slice(0,3).map((t=>t/255)),coordinateConversion:i,bounds:o}).draw()}_getCoordinateUniforms(){const{LNGLAT:t,CARTESIAN:e,DEFAULT:n}=i.rf;let{_imageCoordinateSystem:r}=this.props;if(r!==n){const{bounds:n}=this.props;if(!v(n))throw new Error("_imageCoordinateSystem only supports rectangular bounds");const i=this.context.viewport.resolution?t:e;if(r=r===t?t:e,r===t&&i===e)return{coordinateConversion:-1,bounds:n};if(r===e&&i===t){const t=(0,c.lngLatToWorld)([n[0],n[1]]),e=(0,c.lngLatToWorld)([n[2],n[3]]);return{coordinateConversion:1,bounds:[t[0],t[1],e[0],e[1]]}}}return{coordinateConversion:0,bounds:[0,0,0,0]}}}function v(t){return Number.isFinite(t[0])}(0,r.A)(m,"layerName","BitmapLayer"),(0,r.A)(m,"defaultProps",y)},76483:(t,e,n)=>{"use strict";n.d(e,{A:()=>_});var r=n(67136),i=n(36179),o=n(79464),s=n(44123),a=n(70560),l=n(1597),u=n(8282),c=n(77325),h=n(38404),d=n(76694),f=n(26820),p=n(82170),g=n(33185),y=n(34439);class m extends p.A{constructor(t){const{id:e=(0,g.Ld)("column-geometry")}=t,{indices:n,attributes:r}=function(t){const{radius:e,height:n=1,nradial:r=10}=t;let{vertices:i}=t;i&&(f.A.assert(i.length>=r),i=i.flatMap((t=>[t[0],t[1]])),(0,y.UD)(i,y.rJ.COUNTER_CLOCKWISE));const o=n>0,s=r+1,a=o?3*s+1:r,l=2*Math.PI/r,u=new Uint16Array(o?3*r*2:0),c=new Float32Array(3*a),h=new Float32Array(3*a);let d=0;if(o){for(let t=0;t<s;t++){const o=t*l,s=t%r,a=Math.sin(o),u=Math.cos(o);for(let t=0;t<2;t++)c[d+0]=i?i[2*s]:u*e,c[d+1]=i?i[2*s+1]:a*e,c[d+2]=(.5-t)*n,h[d+0]=i?i[2*s]:u,h[d+1]=i?i[2*s+1]:a,d+=3}c[d+0]=c[d-3],c[d+1]=c[d-2],c[d+2]=c[d-1],d+=3}for(let t=o?0:1;t<s;t++){const o=Math.floor(t/2)*Math.sign(.5-t%2),s=o*l,a=(o+r)%r,u=Math.sin(s),f=Math.cos(s);c[d+0]=i?i[2*a]:f*e,c[d+1]=i?i[2*a+1]:u*e,c[d+2]=n/2,h[d+2]=1,d+=3}if(o){let t=0;for(let e=0;e<r;e++)u[t++]=2*e+0,u[t++]=2*e+2,u[t++]=2*e+0,u[t++]=2*e+1,u[t++]=2*e+1,u[t++]=2*e+3}return{indices:u,attributes:{POSITION:{size:3,value:c},NORMAL:{size:3,value:h}}}}(t);super({...t,id:e,indices:n,attributes:r})}}const v=[0,0,0,255],b={diskResolution:{type:"number",min:4,value:20},vertices:null,radius:{type:"number",min:0,value:1e3},angle:{type:"number",value:0},offset:{type:"array",value:[0,0]},coverage:{type:"number",min:0,max:1,value:1},elevationScale:{type:"number",min:0,value:1},radiusUnits:"meters",lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,extruded:!0,wireframe:!1,filled:!0,stroked:!1,getPosition:{type:"accessor",value:t=>t.position},getFillColor:{type:"accessor",value:v},getLineColor:{type:"accessor",value:v},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0,getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class _ extends i.A{getShaders(){const{gl:t}=this.context,e=!(0,u.C6)(t),n={},r=this.props.flatShading&&(0,c.jI)(t,h.G.GLSL_DERIVATIVES);return r&&(n.FLAT_SHADING=1),super.getShaders({vs:"#version 300 es\n\n#define SHADER_NAME column-layer-vertex-shader\n\nin vec3 positions;\nin vec3 normals;\n\nin vec3 instancePositions;\nin float instanceElevations;\nin vec3 instancePositions64Low;\nin vec4 instanceFillColors;\nin vec4 instanceLineColors;\nin float instanceStrokeWidths;\n\nin vec3 instancePickingColors;\nuniform float opacity;\nuniform float radius;\nuniform float angle;\nuniform vec2 offset;\nuniform bool extruded;\nuniform bool stroked;\nuniform bool isStroke;\nuniform float coverage;\nuniform float elevationScale;\nuniform float edgeDistance;\nuniform float widthScale;\nuniform float widthMinPixels;\nuniform float widthMaxPixels;\nuniform int radiusUnits;\nuniform int widthUnits;\nout vec4 vColor;\n#ifdef FLAT_SHADING\nout vec4 position_commonspace;\n#endif\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n\n  vec4 color = isStroke ? instanceLineColors : instanceFillColors;\n  mat2 rotationMatrix = mat2(cos(angle), sin(angle), -sin(angle), cos(angle));\n  float elevation = 0.0;\n  float strokeOffsetRatio = 1.0;\n\n  if (extruded) {\n    elevation = instanceElevations * (positions.z + 1.0) / 2.0 * elevationScale;\n  } else if (stroked) {\n    float widthPixels = clamp(\n      project_size_to_pixel(instanceStrokeWidths * widthScale, widthUnits),\n      widthMinPixels, widthMaxPixels) / 2.0;\n    float halfOffset = project_pixel_size(widthPixels) / project_size(edgeDistance * coverage * radius);\n    if (isStroke) {\n      strokeOffsetRatio -= sign(positions.z) * halfOffset;\n    } else {\n      strokeOffsetRatio -= halfOffset;\n    }\n  }\n  float shouldRender = float(color.a > 0.0 && instanceElevations >= 0.0);\n  float dotRadius = radius * coverage * shouldRender;\n\n  geometry.pickingColor = instancePickingColors;\n  vec3 centroidPosition = vec3(instancePositions.xy, instancePositions.z + elevation);\n  vec3 centroidPosition64Low = instancePositions64Low;\n  vec2 offset = (rotationMatrix * positions.xy * strokeOffsetRatio + offset) * dotRadius;\n  if (radiusUnits == UNIT_METERS) {\n    offset = project_size(offset);\n  }\n  vec3 pos = vec3(offset, 0.);\n  DECKGL_FILTER_SIZE(pos, geometry);\n\n  gl_Position = project_position_to_clipspace(centroidPosition, centroidPosition64Low, pos, geometry.position);\n  geometry.normal = project_normal(vec3(rotationMatrix * normals.xy, normals.z));\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  if (extruded && !isStroke) {\n#ifdef FLAT_SHADING\n    position_commonspace = geometry.position;\n    vColor = vec4(color.rgb, color.a * opacity);\n#else\n    vec3 lightColor = lighting_getLightColor(color.rgb, project_uCameraPosition, geometry.position.xyz, geometry.normal);\n    vColor = vec4(lightColor, color.a * opacity);\n#endif\n  } else {\n    vColor = vec4(color.rgb, color.a * opacity);\n  }\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#version 300 es\n#define SHADER_NAME column-layer-fragment-shader\n\nprecision highp float;\n\nuniform vec3 project_uCameraPosition;\nuniform bool extruded;\nuniform bool isStroke;\n\nout vec4 fragColor;\n\nin vec4 vColor;\n#ifdef FLAT_SHADING\nin vec4 position_commonspace;\n#endif\n\nvoid main(void) {\n  fragColor = vColor;\n#ifdef FLAT_SHADING\n  if (extruded && !isStroke && !picking_uActive) {\n    vec3 normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));\n    fragColor.rgb = lighting_getLightColor(vColor.rgb, project_uCameraPosition, position_commonspace.xyz, normal);\n  }\n#endif\n  DECKGL_FILTER_COLOR(fragColor, geometry);\n}\n",defines:n,transpileToGLSL100:e,modules:[o.A,r?s.p:s.K,a.A]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceElevations:{size:1,transition:!0,accessor:"getElevation"},instanceFillColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getFillColor",defaultValue:v},instanceLineColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getLineColor",defaultValue:v},instanceStrokeWidths:{size:1,accessor:"getLineWidth",transition:!0}})}updateState(t){super.updateState(t);const{props:e,oldProps:n,changeFlags:r}=t,i=r.extensionsChanged||e.flatShading!==n.flatShading;if(i){var o;const{gl:t}=this.context;null===(o=this.state.model)||void 0===o||o.delete(),this.state.model=this._getModel(t),this.getAttributeManager().invalidateAll()}(i||e.diskResolution!==n.diskResolution||e.vertices!==n.vertices||(e.extruded||e.stroked)!==(n.extruded||n.stroked))&&this._updateGeometry(e)}getGeometry(t,e,n){const r=new m({radius:1,height:n?2:0,vertices:e,nradial:t});let i=0;if(e)for(let n=0;n<t;n++){const r=e[n];i+=Math.sqrt(r[0]*r[0]+r[1]*r[1])/t}else i=1;return this.setState({edgeDistance:Math.cos(Math.PI/t)*i}),r}_getModel(t){return new d.A(t,{...this.getShaders(),id:this.props.id,isInstanced:!0})}_updateGeometry({diskResolution:t,vertices:e,extruded:n,stroked:r}){const i=this.getGeometry(t,e,n||r);this.setState({fillVertexCount:i.attributes.POSITION.value.length/3,wireframeVertexCount:i.indices.value.length}),this.state.model.setProps({geometry:i})}draw({uniforms:t}){const{lineWidthUnits:e,lineWidthScale:n,lineWidthMinPixels:r,lineWidthMaxPixels:i,radiusUnits:o,elevationScale:s,extruded:a,filled:u,stroked:c,wireframe:h,offset:d,coverage:f,radius:p,angle:g}=this.props,{model:y,fillVertexCount:m,wireframeVertexCount:v,edgeDistance:b}=this.state;y.setUniforms(t).setUniforms({radius:p,angle:g/180*Math.PI,offset:d,extruded:a,stroked:c,coverage:f,elevationScale:s,edgeDistance:b,radiusUnits:l.p5[o],widthUnits:l.p5[e],widthScale:n,widthMinPixels:r,widthMaxPixels:i}),a&&h&&(y.setProps({isIndexed:!0}),y.setVertexCount(v).setDrawMode(1).setUniforms({isStroke:!0}).draw()),u&&(y.setProps({isIndexed:!1}),y.setVertexCount(m).setDrawMode(5).setUniforms({isStroke:!1}).draw()),!a&&c&&(y.setProps({isIndexed:!1}),y.setVertexCount(2*m/3).setDrawMode(5).setUniforms({isStroke:!0}).draw())}}(0,r.A)(_,"layerName","ColumnLayer"),(0,r.A)(_,"defaultProps",b)},53865:(t,e,n)=>{"use strict";n.d(e,{A:()=>a});var r=n(67136),i=n(4992),o=n(1597),s=n(76483);class a extends s.A{getGeometry(t){return new i.A}draw({uniforms:t}){const{elevationScale:e,extruded:n,offset:r,coverage:i,cellSize:s,angle:a,radiusUnits:l}=this.props;this.state.model.setUniforms(t).setUniforms({radius:s/2,radiusUnits:o.p5[l],angle:a,offset:r,extruded:n,coverage:i,elevationScale:e,edgeDistance:1,isWireframe:!1}).draw()}}(0,r.A)(a,"layerName","GridCellLayer"),(0,r.A)(a,"defaultProps",{cellSize:{type:"number",min:0,value:1e3},offset:{type:"array",value:[1,1]}})},31152:(t,e,n)=>{"use strict";n.d(e,{A:()=>w});var r=n(67136),i=n(68411),o=n(53986),s=n(58830),a=n(54127),l=n(10064),u=n(33885),c=n(58534);const h={circle:{type:a.A,props:{filled:"filled",stroked:"stroked",lineWidthMaxPixels:"lineWidthMaxPixels",lineWidthMinPixels:"lineWidthMinPixels",lineWidthScale:"lineWidthScale",lineWidthUnits:"lineWidthUnits",pointRadiusMaxPixels:"radiusMaxPixels",pointRadiusMinPixels:"radiusMinPixels",pointRadiusScale:"radiusScale",pointRadiusUnits:"radiusUnits",pointAntialiasing:"antialiasing",pointBillboard:"billboard",getFillColor:"getFillColor",getLineColor:"getLineColor",getLineWidth:"getLineWidth",getPointRadius:"getRadius"}},icon:{type:s.A,props:{iconAtlas:"iconAtlas",iconMapping:"iconMapping",iconSizeMaxPixels:"sizeMaxPixels",iconSizeMinPixels:"sizeMinPixels",iconSizeScale:"sizeScale",iconSizeUnits:"sizeUnits",iconAlphaCutoff:"alphaCutoff",iconBillboard:"billboard",getIcon:"getIcon",getIconAngle:"getAngle",getIconColor:"getColor",getIconPixelOffset:"getPixelOffset",getIconSize:"getSize"}},text:{type:l.A,props:{textSizeMaxPixels:"sizeMaxPixels",textSizeMinPixels:"sizeMinPixels",textSizeScale:"sizeScale",textSizeUnits:"sizeUnits",textBackground:"background",textBackgroundPadding:"backgroundPadding",textFontFamily:"fontFamily",textFontWeight:"fontWeight",textLineHeight:"lineHeight",textMaxWidth:"maxWidth",textOutlineColor:"outlineColor",textOutlineWidth:"outlineWidth",textWordBreak:"wordBreak",textCharacterSet:"characterSet",textBillboard:"billboard",textFontSettings:"fontSettings",getText:"getText",getTextAngle:"getAngle",getTextColor:"getColor",getTextPixelOffset:"getPixelOffset",getTextSize:"getSize",getTextAnchor:"getTextAnchor",getTextAlignmentBaseline:"getAlignmentBaseline",getTextBackgroundColor:"getBackgroundColor",getTextBorderColor:"getBorderColor",getTextBorderWidth:"getBorderWidth"}}},d={type:u.A,props:{lineWidthUnits:"widthUnits",lineWidthScale:"widthScale",lineWidthMinPixels:"widthMinPixels",lineWidthMaxPixels:"widthMaxPixels",lineJointRounded:"jointRounded",lineCapRounded:"capRounded",lineMiterLimit:"miterLimit",lineBillboard:"billboard",getLineColor:"getColor",getLineWidth:"getWidth"}},f={type:c.A,props:{extruded:"extruded",filled:"filled",wireframe:"wireframe",elevationScale:"elevationScale",material:"material",_full3d:"_full3d",getElevation:"getElevation",getFillColor:"getFillColor",getLineColor:"getLineColor"}};function p({type:t,props:e}){const n={};for(const r in e)n[r]=t.defaultProps[e[r]];return n}function g(t,e){const{transitions:n,updateTriggers:r}=t.props,i={updateTriggers:{},transitions:n&&{getPosition:n.geometry}};for(const o in e){const s=e[o];let a=t.props[o];o.startsWith("get")&&(a=t.getSubLayerAccessor(a),i.updateTriggers[s]=r[o],n&&(i.transitions[s]=n[o])),i[s]=a}return i}var y=n(26820);function m(t,e,n={}){const r={pointFeatures:[],lineFeatures:[],polygonFeatures:[],polygonOutlineFeatures:[]},{startRow:i=0,endRow:o=t.length}=n;for(let n=i;n<o;n++){const i=t[n],{geometry:o}=i;if(o)if("GeometryCollection"===o.type){y.A.assert(Array.isArray(o.geometries),"GeoJSON does not have geometries array");const{geometries:t}=o;for(let o=0;o<t.length;o++)v(t[o],r,e,i,n)}else v(o,r,e,i,n)}return r}function v(t,e,n,r,i){const{type:o,coordinates:s}=t,{pointFeatures:a,lineFeatures:l,polygonFeatures:u,polygonOutlineFeatures:c}=e;if(function(t,e){let n=b[t];for(y.A.assert(n,"Unknown GeoJSON type ".concat(t));e&&--n>0;)e=e[0];return e&&Number.isFinite(e[0])}(o,s))switch(o){case"Point":a.push(n({geometry:t},r,i));break;case"MultiPoint":s.forEach((t=>{a.push(n({geometry:{type:"Point",coordinates:t}},r,i))}));break;case"LineString":l.push(n({geometry:t},r,i));break;case"MultiLineString":s.forEach((t=>{l.push(n({geometry:{type:"LineString",coordinates:t}},r,i))}));break;case"Polygon":u.push(n({geometry:t},r,i)),s.forEach((t=>{c.push(n({geometry:{type:"LineString",coordinates:t}},r,i))}));break;case"MultiPolygon":s.forEach((t=>{u.push(n({geometry:{type:"Polygon",coordinates:t}},r,i)),t.forEach((t=>{c.push(n({geometry:{type:"LineString",coordinates:t}},r,i))}))}))}else y.A.warn("".concat(o," coordinates are malformed"))()}const b={Point:1,MultiPoint:2,LineString:2,MultiLineString:3,Polygon:3,MultiPolygon:4};function _(t){return t.geometry.coordinates}const A=["points","linestrings","polygons"],x={...p(h.circle),...p(h.icon),...p(h.text),...p(d),...p(f),stroked:!0,filled:!0,extruded:!1,wireframe:!1,_full3d:!1,iconAtlas:{type:"object",value:null},iconMapping:{type:"object",value:{}},getIcon:{type:"accessor",value:t=>t.properties.icon},getText:{type:"accessor",value:t=>t.properties.text},pointType:"circle",getRadius:{deprecatedFor:"getPointRadius"}};class w extends i.A{initializeState(){this.state={layerProps:{},features:{}}}updateState({props:t,changeFlags:e}){if(!e.dataChanged)return;const{data:n}=this.props,r=n&&"points"in n&&"polygons"in n&&"lines"in n;this.setState({binary:r}),r?this._updateStateBinary({props:t,changeFlags:e}):this._updateStateJSON({props:t,changeFlags:e})}_updateStateBinary({props:t,changeFlags:e}){const n=function(t,e){const n={points:{},lines:{},polygons:{},polygonsOutline:{}},{points:r,lines:i,polygons:o}=t,s=function(t,e){const n={points:null,lines:null,polygons:null};for(const r in n){const i=t[r].globalFeatureIds.value;n[r]=new Uint8ClampedArray(3*i.length);const o=[];for(let t=0;t<i.length;t++)e(i[t],o),n[r][3*t+0]=o[0],n[r][3*t+1]=o[1],n[r][3*t+2]=o[2]}return n}(t,e);return n.points.data={length:r.positions.value.length/r.positions.size,attributes:{...r.attributes,getPosition:r.positions,instancePickingColors:{size:3,value:s.points}},properties:r.properties,numericProps:r.numericProps,featureIds:r.featureIds},n.lines.data={length:i.pathIndices.value.length-1,startIndices:i.pathIndices.value,attributes:{...i.attributes,getPath:i.positions,instancePickingColors:{size:3,value:s.lines}},properties:i.properties,numericProps:i.numericProps,featureIds:i.featureIds},n.lines._pathType="open",n.polygons.data={length:o.polygonIndices.value.length-1,startIndices:o.polygonIndices.value,attributes:{...o.attributes,getPolygon:o.positions,pickingColors:{size:3,value:s.polygons}},properties:o.properties,numericProps:o.numericProps,featureIds:o.featureIds},n.polygons._normalize=!1,o.triangles&&(n.polygons.data.attributes.indices=o.triangles.value),n.polygonsOutline.data={length:o.primitivePolygonIndices.value.length-1,startIndices:o.primitivePolygonIndices.value,attributes:{...o.attributes,getPath:o.positions,instancePickingColors:{size:3,value:s.polygons}},properties:o.properties,numericProps:o.numericProps,featureIds:o.featureIds},n.polygonsOutline._pathType="open",n}(t.data,this.encodePickingColor);this.setState({layerProps:n})}_updateStateJSON({props:t,changeFlags:e}){const n=function(t){if(Array.isArray(t))return t;switch(y.A.assert(t.type,"GeoJSON does not have type"),t.type){case"Feature":return[t];case"FeatureCollection":return y.A.assert(Array.isArray(t.features),"GeoJSON does not have features array"),t.features;default:return[{geometry:t}]}}(t.data),r=this.getSubLayerRow.bind(this);let i={};const s={};if(Array.isArray(e.dataChanged)){const t=this.state.features;for(const e in t)i[e]=t[e].slice(),s[e]=[];for(const a of e.dataChanged){const e=m(n,r,a);for(const n in t)s[n].push((0,o.J)({data:i[n],getIndex:t=>t.__source.index,dataRange:a,replace:e[n]}))}}else i=m(n,r);const a=function(t,e){const n={points:{},lines:{},polygons:{},polygonsOutline:{}},{pointFeatures:r,lineFeatures:i,polygonFeatures:o,polygonOutlineFeatures:s}=t;return n.points.data=r,n.points._dataDiff=e.pointFeatures&&(()=>e.pointFeatures),n.points.getPosition=_,n.lines.data=i,n.lines._dataDiff=e.lineFeatures&&(()=>e.lineFeatures),n.lines.getPath=_,n.polygons.data=o,n.polygons._dataDiff=e.polygonFeatures&&(()=>e.polygonFeatures),n.polygons.getPolygon=_,n.polygonsOutline.data=s,n.polygonsOutline._dataDiff=e.polygonOutlineFeatures&&(()=>e.polygonOutlineFeatures),n.polygonsOutline.getPath=_,n}(i,s);this.setState({features:i,featuresDiff:s,layerProps:a})}getPickingInfo(t){const e=super.getPickingInfo(t),{index:n,sourceLayer:r}=e;return e.featureType=A.find((t=>r.id.startsWith("".concat(this.id,"-").concat(t,"-")))),n>=0&&r.id.startsWith("".concat(this.id,"-points-text"))&&this.state.binary&&(e.index=this.props.data.points.globalFeatureIds.value[n]),e}_updateAutoHighlight(t){const e="".concat(this.id,"-points-"),n="points"===t.featureType;for(const r of this.getSubLayers())r.id.startsWith(e)===n&&r.updateAutoHighlight(t)}_renderPolygonLayer(){const{extruded:t,wireframe:e}=this.props,{layerProps:n}=this.state,r="polygons-fill",i=this.shouldRenderSubLayer(r,n.polygons.data)&&this.getSubLayerClass(r,f.type);if(i){const o=g(this,f.props),s=t&&e;return s||delete o.getLineColor,o.updateTriggers.lineColors=s,new i(o,this.getSubLayerProps({id:r,updateTriggers:o.updateTriggers}),n.polygons)}return null}_renderLineLayers(){const{extruded:t,stroked:e}=this.props,{layerProps:n}=this.state,r="polygons-stroke",i="linestrings",o=!t&&e&&this.shouldRenderSubLayer(r,n.polygonsOutline.data)&&this.getSubLayerClass(r,d.type),s=this.shouldRenderSubLayer(i,n.lines.data)&&this.getSubLayerClass(i,d.type);if(o||s){const t=g(this,d.props);return[o&&new o(t,this.getSubLayerProps({id:r,updateTriggers:t.updateTriggers}),n.polygonsOutline),s&&new s(t,this.getSubLayerProps({id:i,updateTriggers:t.updateTriggers}),n.lines)]}return null}_renderPointLayers(){const{pointType:t}=this.props,{layerProps:e,binary:n}=this.state;let{highlightedObjectIndex:r}=this.props;!n&&Number.isFinite(r)&&(r=e.points.data.findIndex((t=>t.__source.index===r)));const i=new Set(t.split("+")),o=[];for(const t of i){const i="points-".concat(t),s=h[t],a=s&&this.shouldRenderSubLayer(i,e.points.data)&&this.getSubLayerClass(i,s.type);if(a){const l=g(this,s.props);let u=e.points;if("text"===t&&n){const{instancePickingColors:t,...e}=u.data.attributes;u={...u,data:{...u.data,attributes:e}}}o.push(new a(l,this.getSubLayerProps({id:i,updateTriggers:l.updateTriggers,highlightedObjectIndex:r}),u))}}return o}renderLayers(){const{extruded:t}=this.props,e=this._renderPolygonLayer();return[!t&&e,this._renderLineLayers(),this._renderPointLayers(),t&&e]}getSubLayerAccessor(t){const{binary:e}=this.state;return e&&"function"==typeof t?(e,n)=>{const{data:r,index:i}=n,o=function(t,e){if(!t)return null;const n="startIndices"in t?t.startIndices[e]:e,r=t.featureIds.value[n];return-1!==n?function(t,e,n){const r={properties:{...t.properties[e]}};for(const e in t.numericProps)r.properties[e]=t.numericProps[e].value[n];return r}(t,r,n):null}(r,i);return t(o,n)}:super.getSubLayerAccessor(t)}}(0,r.A)(w,"layerName","GeoJsonLayer"),(0,r.A)(w,"defaultProps",x)},58830:(t,e,n)=>{"use strict";n.d(e,{A:()=>w});var r=n(67136),i=n(36179),o=n(79464),s=n(70560),a=n(1597),l=n(26820),u=n(76694),c=n(82170),h=n(26107),d=n(27968),f=n(86735),p=n(97870);const g=()=>{},y={10241:9987,10240:9729,10242:33071,10243:33071};function m(t,e,n,r){const i=Math.min(n/e.width,r/e.height),o=Math.floor(e.width*i),s=Math.floor(e.height*i);return 1===i?{data:e,width:o,height:s}:(t.canvas.height=s,t.canvas.width=o,t.clearRect(0,0,o,s),t.drawImage(e,0,0,e.width,e.height,0,0,o,s),{data:t.canvas,width:o,height:s})}function v(t){return t&&(t.id||t.url)}function b(t,e,n){for(let r=0;r<e.length;r++){const{icon:i,xOffset:o}=e[r];t[v(i)]={...i,x:o,y:n}}}class _{constructor(t,{onUpdate:e=g,onError:n=g}){(0,r.A)(this,"gl",void 0),(0,r.A)(this,"onUpdate",void 0),(0,r.A)(this,"onError",void 0),(0,r.A)(this,"_loadOptions",null),(0,r.A)(this,"_texture",null),(0,r.A)(this,"_externalTexture",null),(0,r.A)(this,"_mapping",{}),(0,r.A)(this,"_textureParameters",null),(0,r.A)(this,"_pendingCount",0),(0,r.A)(this,"_autoPacking",!1),(0,r.A)(this,"_xOffset",0),(0,r.A)(this,"_yOffset",0),(0,r.A)(this,"_rowHeight",0),(0,r.A)(this,"_buffer",4),(0,r.A)(this,"_canvasWidth",1024),(0,r.A)(this,"_canvasHeight",0),(0,r.A)(this,"_canvas",null),this.gl=t,this.onUpdate=e,this.onError=n}finalize(){var t;null===(t=this._texture)||void 0===t||t.delete()}getTexture(){return this._texture||this._externalTexture}getIconMapping(t){const e=this._autoPacking?v(t):t;return this._mapping[e]||{}}setProps({loadOptions:t,autoPacking:e,iconAtlas:n,iconMapping:r,textureParameters:i}){var o;t&&(this._loadOptions=t),void 0!==e&&(this._autoPacking=e),r&&(this._mapping=r),n&&(null===(o=this._texture)||void 0===o||o.delete(),this._texture=null,this._externalTexture=n),i&&(this._textureParameters=i)}get isLoaded(){return 0===this._pendingCount}packIcons(t,e){if(!this._autoPacking||"undefined"==typeof document)return;const n=Object.values(function(t,e,n){if(!t||!e)return null;n=n||{};const r={},{iterable:i,objectInfo:o}=(0,p.X)(t);for(const t of i){o.index++;const i=e(t,o),s=v(i);if(!i)throw new Error("Icon is missing.");if(!i.url)throw new Error("Icon url is missing.");r[s]||n[s]&&i.url===n[s].url||(r[s]={...i,source:t,sourceIndex:o.index})}return r}(t,e,this._mapping)||{});if(n.length>0){const{mapping:t,xOffset:e,yOffset:r,rowHeight:i,canvasHeight:o}=function({icons:t,buffer:e,mapping:n={},xOffset:r=0,yOffset:i=0,rowHeight:o=0,canvasWidth:s}){let a=[];for(let l=0;l<t.length;l++){const u=t[l];if(!n[v(u)]){const{height:t,width:l}=u;r+l+e>s&&(b(n,a,i),r=0,i=o+i+e,o=0,a=[]),a.push({icon:u,xOffset:r}),r=r+l+e,o=Math.max(o,t)}}return a.length>0&&b(n,a,i),{mapping:n,rowHeight:o,xOffset:r,yOffset:i,canvasWidth:s,canvasHeight:(l=o+i+e,Math.pow(2,Math.ceil(Math.log2(l))))};var l}({icons:n,buffer:this._buffer,canvasWidth:this._canvasWidth,mapping:this._mapping,rowHeight:this._rowHeight,xOffset:this._xOffset,yOffset:this._yOffset});this._rowHeight=i,this._mapping=t,this._xOffset=e,this._yOffset=r,this._canvasHeight=o,this._texture||(this._texture=new h.A(this.gl,{width:this._canvasWidth,height:this._canvasHeight,parameters:this._textureParameters||y})),this._texture.height!==this._canvasHeight&&(this._texture=function(t,e,n,r){const i=t.width,o=t.height,s=new h.A(t.gl,{width:e,height:n,parameters:r});return(0,d.ob)(t,s,{targetY:0,width:i,height:o}),t.delete(),s}(this._texture,this._canvasWidth,this._canvasHeight,this._textureParameters||y)),this.onUpdate(),this._canvas=this._canvas||document.createElement("canvas"),this._loadIcons(n)}}_loadIcons(t){const e=this._canvas.getContext("2d",{willReadFrequently:!0});for(const n of t)this._pendingCount++,(0,f.load)(n.url,this._loadOptions).then((t=>{const r=v(n),i=this._mapping[r],{x:o,y:s,width:a,height:l}=i,{data:u,width:c,height:h}=m(e,t,a,l);this._texture.setSubImageData({data:u,x:o+(a-c)/2,y:s+(l-h)/2,width:c,height:h}),i.width=c,i.height=h,this._texture.generateMipmap(),this.onUpdate()})).catch((t=>{this.onError({url:n.url,source:n.source,sourceIndex:n.sourceIndex,loadOptions:this._loadOptions,error:t})})).finally((()=>{this._pendingCount--}))}}const A=[0,0,0,255],x={iconAtlas:{type:"image",value:null,async:!0},iconMapping:{type:"object",value:{},async:!0},sizeScale:{type:"number",value:1,min:0},billboard:!0,sizeUnits:"pixels",sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},alphaCutoff:{type:"number",value:.05,min:0,max:1},getPosition:{type:"accessor",value:t=>t.position},getIcon:{type:"accessor",value:t=>t.icon},getColor:{type:"accessor",value:A},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},onIconError:{type:"function",value:null,optional:!0},textureParameters:{type:"object",ignore:!0}};class w extends i.A{constructor(...t){super(...t),(0,r.A)(this,"state",void 0)}getShaders(){return super.getShaders({vs:"#define SHADER_NAME icon-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute float instanceSizes;\nattribute float instanceAngles;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\nattribute vec4 instanceIconFrames;\nattribute float instanceColorModes;\nattribute vec2 instanceOffsets;\nattribute vec2 instancePixelOffset;\n\nuniform float sizeScale;\nuniform vec2 iconsTextureDim;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform bool billboard;\nuniform int sizeUnits;\n\nvarying float vColorMode;\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvec2 rotate_by_angle(vec2 vertex, float angle) {\n  float angle_radian = angle * PI / 180.0;\n  float cos_angle = cos(angle_radian);\n  float sin_angle = sin(angle_radian);\n  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);\n  return rotationMatrix * vertex;\n}\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = positions;\n  geometry.pickingColor = instancePickingColors;\n  uv = positions;\n\n  vec2 iconSize = instanceIconFrames.zw;\n  float sizePixels = clamp(\n    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits), \n    sizeMinPixels, sizeMaxPixels\n  );\n  float instanceScale = iconSize.y == 0.0 ? 0.0 : sizePixels / iconSize.y;\n  vec2 pixelOffset = positions / 2.0 * iconSize + instanceOffsets;\n  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles) * instanceScale;\n  pixelOffset += instancePixelOffset;\n  pixelOffset.y *= -1.0;\n\n  if (billboard)  {\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n    vec3 offset = vec3(pixelOffset, 0.0);\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n\n  } else {\n    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);\n    DECKGL_FILTER_SIZE(offset_common, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position); \n    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  }\n\n  vTextureCoords = mix(\n    instanceIconFrames.xy,\n    instanceIconFrames.xy + iconSize,\n    (positions.xy + 1.0) / 2.0\n  ) / iconsTextureDim;\n\n  vColor = instanceColors;\n  DECKGL_FILTER_COLOR(vColor, geometry);\n\n  vColorMode = instanceColorModes;\n}\n",fs:"#define SHADER_NAME icon-layer-fragment-shader\n\nprecision highp float;\n\nuniform float opacity;\nuniform sampler2D iconsTexture;\nuniform float alphaCutoff;\n\nvarying float vColorMode;\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  vec4 texColor = texture2D(iconsTexture, vTextureCoords);\n  vec3 color = mix(texColor.rgb, vColor.rgb, vColorMode);\n  float a = texColor.a * opacity * vColor.a;\n\n  if (a < alphaCutoff) {\n    discard;\n  }\n\n  gl_FragColor = vec4(color, a);\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[o.A,s.A]})}initializeState(){this.state={iconManager:new _(this.context.gl,{onUpdate:this._onUpdate.bind(this),onError:this._onError.bind(this)})},this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceOffsets:{size:2,accessor:"getIcon",transform:this.getInstanceOffset},instanceIconFrames:{size:4,accessor:"getIcon",transform:this.getInstanceIconFrame},instanceColorModes:{size:1,type:5121,accessor:"getIcon",transform:this.getInstanceColorMode},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:A},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instancePixelOffset:{size:2,transition:!0,accessor:"getPixelOffset"}})}updateState(t){super.updateState(t);const{props:e,oldProps:n,changeFlags:r}=t,i=this.getAttributeManager(),{iconAtlas:o,iconMapping:s,data:a,getIcon:l,textureParameters:u}=e,{iconManager:c}=this.state,h=o||this.internalState.isAsyncPropLoading("iconAtlas");if(c.setProps({loadOptions:e.loadOptions,autoPacking:!h,iconAtlas:o,iconMapping:h?s:null,textureParameters:u}),h?n.iconMapping!==e.iconMapping&&i.invalidate("getIcon"):(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getIcon))&&c.packIcons(a,l),r.extensionsChanged){var d;const{gl:t}=this.context;null===(d=this.state.model)||void 0===d||d.delete(),this.state.model=this._getModel(t),i.invalidateAll()}}get isLoaded(){return super.isLoaded&&this.state.iconManager.isLoaded}finalizeState(t){super.finalizeState(t),this.state.iconManager.finalize()}draw({uniforms:t}){const{sizeScale:e,sizeMinPixels:n,sizeMaxPixels:r,sizeUnits:i,billboard:o,alphaCutoff:s}=this.props,{iconManager:l}=this.state,u=l.getTexture();u&&this.state.model.setUniforms(t).setUniforms({iconsTexture:u,iconsTextureDim:[u.width,u.height],sizeUnits:a.p5[i],sizeScale:e,sizeMinPixels:n,sizeMaxPixels:r,billboard:o,alphaCutoff:s}).draw()}_getModel(t){return new u.A(t,{...this.getShaders(),id:this.props.id,geometry:new c.A({drawMode:6,attributes:{positions:{size:2,value:new Float32Array([-1,-1,-1,1,1,1,1,-1])}}}),isInstanced:!0})}_onUpdate(){this.setNeedsRedraw()}_onError(t){var e;const n=null===(e=this.getCurrentLayer())||void 0===e?void 0:e.props.onIconError;n?n(t):l.A.error(t.error.message)()}getInstanceOffset(t){const{width:e,height:n,anchorX:r=e/2,anchorY:i=n/2}=this.state.iconManager.getIconMapping(t);return[e/2-r,n/2-i]}getInstanceColorMode(t){return this.state.iconManager.getIconMapping(t).mask?1:0}getInstanceIconFrame(t){const{x:e,y:n,width:r,height:i}=this.state.iconManager.getIconMapping(t);return[e,n,r,i]}}(0,r.A)(w,"defaultProps",x),(0,r.A)(w,"layerName","IconLayer")},23863:(t,e,n)=>{"use strict";n.r(e),n.d(e,{ArcLayer:()=>r.A,BitmapLayer:()=>i.A,ColumnLayer:()=>u.A,GeoJsonLayer:()=>f.A,GridCellLayer:()=>c.A,IconLayer:()=>o.A,LineLayer:()=>s.A,PathLayer:()=>h.A,PointCloudLayer:()=>a.A,PolygonLayer:()=>d.A,ScatterplotLayer:()=>l.A,SolidPolygonLayer:()=>g.A,TextLayer:()=>p.A,_MultiIconLayer:()=>y.A,_TextBackgroundLayer:()=>m.A});var r=n(69002),i=n(53313),o=n(58830),s=n(11805),a=n(81537),l=n(54127),u=n(76483),c=n(53865),h=n(33885),d=n(19460),f=n(31152),p=n(10064),g=n(58534),y=n(93677),m=n(18948)},11805:(t,e,n)=>{"use strict";n.d(e,{A:()=>h});var r=n(67136),i=n(36179),o=n(79464),s=n(70560),a=n(1597),l=n(76694),u=n(82170);const c={getSourcePosition:{type:"accessor",value:t=>t.sourcePosition},getTargetPosition:{type:"accessor",value:t=>t.targetPosition},getColor:{type:"accessor",value:[0,0,0,255]},getWidth:{type:"accessor",value:1},widthUnits:"pixels",widthScale:{type:"number",value:1,min:0},widthMinPixels:{type:"number",value:0,min:0},widthMaxPixels:{type:"number",value:Number.MAX_SAFE_INTEGER,min:0}};class h extends i.A{getBounds(){var t;return null===(t=this.getAttributeManager())||void 0===t?void 0:t.getBounds(["instanceSourcePositions","instanceTargetPositions"])}getShaders(){return super.getShaders({vs:"#define SHADER_NAME line-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec3 instanceSourcePositions;\nattribute vec3 instanceTargetPositions;\nattribute vec3 instanceSourcePositions64Low;\nattribute vec3 instanceTargetPositions64Low;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\nattribute float instanceWidths;\n\nuniform float opacity;\nuniform float widthScale;\nuniform float widthMinPixels;\nuniform float widthMaxPixels;\nuniform float useShortestPath;\nuniform int widthUnits;\n\nvarying vec4 vColor;\nvarying vec2 uv;\nvec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction, float width) {\n  vec2 dir_screenspace = normalize(line_clipspace * project_uViewportSize);\n  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n\n  return dir_screenspace * offset_direction * width / 2.0;\n}\n\nvec3 splitLine(vec3 a, vec3 b, float x) {\n  float t = (x - a.x) / (b.x - a.x);\n  return vec3(x, mix(a.yz, b.yz, t));\n}\n\nvoid main(void) {\n  geometry.worldPosition = instanceSourcePositions;\n  geometry.worldPositionAlt = instanceTargetPositions;\n\n  vec3 source_world = instanceSourcePositions;\n  vec3 target_world = instanceTargetPositions;\n  vec3 source_world_64low = instanceSourcePositions64Low;\n  vec3 target_world_64low = instanceTargetPositions64Low;\n\n  if (useShortestPath > 0.5 || useShortestPath < -0.5) {\n    source_world.x = mod(source_world.x + 180., 360.0) - 180.;\n    target_world.x = mod(target_world.x + 180., 360.0) - 180.;\n    float deltaLng = target_world.x - source_world.x;\n\n    if (deltaLng * useShortestPath > 180.) {\n      source_world.x += 360. * useShortestPath;\n      source_world = splitLine(source_world, target_world, 180. * useShortestPath);\n      source_world_64low = vec3(0.0);\n    } else if (deltaLng * useShortestPath < -180.) {\n      target_world.x += 360. * useShortestPath;\n      target_world = splitLine(source_world, target_world, 180. * useShortestPath);\n      target_world_64low = vec3(0.0);\n    } else if (useShortestPath < 0.) {\n      gl_Position = vec4(0.);\n      return;\n    }\n  }\n  vec4 source_commonspace;\n  vec4 target_commonspace;\n  vec4 source = project_position_to_clipspace(source_world, source_world_64low, vec3(0.), source_commonspace);\n  vec4 target = project_position_to_clipspace(target_world, target_world_64low, vec3(0.), target_commonspace);\n  float segmentIndex = positions.x;\n  vec4 p = mix(source, target, segmentIndex);\n  geometry.position = mix(source_commonspace, target_commonspace, segmentIndex);\n  uv = positions.xy;\n  geometry.uv = uv;\n  geometry.pickingColor = instancePickingColors;\n  float widthPixels = clamp(\n    project_size_to_pixel(instanceWidths * widthScale, widthUnits),\n    widthMinPixels, widthMaxPixels\n  );\n  vec3 offset = vec3(\n    getExtrusionOffset(target.xy - source.xy, positions.y, widthPixels),\n    0.0);\n  DECKGL_FILTER_SIZE(offset, geometry);\n  DECKGL_FILTER_GL_POSITION(p, geometry);\n  gl_Position = p + vec4(project_pixel_size_to_clipspace(offset.xy), 0.0, 0.0);\n  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity);\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#define SHADER_NAME line-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\nvarying vec2 uv;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  gl_FragColor = vColor;\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[o.A,s.A]})}get wrapLongitude(){return!1}initializeState(){this.getAttributeManager().addInstanced({instanceSourcePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getSourcePosition"},instanceTargetPositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getTargetPosition"},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:[0,0,0,255]},instanceWidths:{size:1,transition:!0,accessor:"getWidth",defaultValue:1}})}updateState(t){if(super.updateState(t),t.changeFlags.extensionsChanged){var e;const{gl:t}=this.context;null===(e=this.state.model)||void 0===e||e.delete(),this.state.model=this._getModel(t),this.getAttributeManager().invalidateAll()}}draw({uniforms:t}){const{widthUnits:e,widthScale:n,widthMinPixels:r,widthMaxPixels:i,wrapLongitude:o}=this.props;this.state.model.setUniforms(t).setUniforms({widthUnits:a.p5[e],widthScale:n,widthMinPixels:r,widthMaxPixels:i,useShortestPath:o?1:0}).draw(),o&&this.state.model.setUniforms({useShortestPath:-1}).draw()}_getModel(t){return new l.A(t,{...this.getShaders(),id:this.props.id,geometry:new u.A({drawMode:5,attributes:{positions:new Float32Array([0,-1,0,0,1,0,1,-1,0,1,1,0])}}),isInstanced:!0})}}(0,r.A)(h,"layerName","LineLayer"),(0,r.A)(h,"defaultProps",c)},33885:(t,e,n)=>{"use strict";n.d(e,{A:()=>m});var r=n(67136),i=n(36179),o=n(79464),s=n(70560),a=n(1597),l=n(76694),u=n(82170),c=n(57512),h=n(34439);class d extends c.A{constructor(t){super({...t,attributes:{positions:{size:3,padding:18,initialize:!0,type:t.fp64?Float64Array:Float32Array},segmentTypes:{size:1,type:Uint8ClampedArray}}})}get(t){return this.attributes[t]}getGeometryFromBuffer(t){return this.normalize?super.getGeometryFromBuffer(t):null}normalizeGeometry(t){return this.normalize?function(t,e,n,r){let i;if(Array.isArray(t[0])){const n=t.length*e;i=new Array(n);for(let n=0;n<t.length;n++)for(let r=0;r<e;r++)i[n*e+r]=t[n][r]||0}else i=t;return n?(0,h.Mk)(i,{size:e,gridResolution:n}):r?(0,h.Iy)(i,{size:e}):i}(t,this.positionSize,this.opts.resolution,this.opts.wrapLongitude):t}getGeometrySize(t){if(f(t)){let e=0;for(const n of t)e+=this.getGeometrySize(n);return e}const e=this.getPathLength(t);return e<2?0:this.isClosed(t)?e<3?0:e+2:e}updateGeometryAttributes(t,e){if(0!==e.geometrySize)if(t&&f(t))for(const n of t){const t=this.getGeometrySize(n);e.geometrySize=t,this.updateGeometryAttributes(n,e),e.vertexStart+=t}else this._updateSegmentTypes(t,e),this._updatePositions(t,e)}_updateSegmentTypes(t,e){const n=this.attributes.segmentTypes,r=!!t&&this.isClosed(t),{vertexStart:i,geometrySize:o}=e;n.fill(0,i,i+o),r?(n[i]=4,n[i+o-2]=4):(n[i]+=1,n[i+o-2]+=2),n[i+o-1]=4}_updatePositions(t,e){const{positions:n}=this.attributes;if(!n||!t)return;const{vertexStart:r,geometrySize:i}=e,o=new Array(3);for(let e=r,s=0;s<i;e++,s++)this.getPointOnPath(t,s,o),n[3*e]=o[0],n[3*e+1]=o[1],n[3*e+2]=o[2]}getPathLength(t){return t.length/this.positionSize}getPointOnPath(t,e,n=[]){const{positionSize:r}=this;e*r>=t.length&&(e+=1-t.length/r);const i=e*r;return n[0]=t[i],n[1]=t[i+1],n[2]=3===r&&t[i+2]||0,n}isClosed(t){if(!this.normalize)return Boolean(this.opts.loop);const{positionSize:e}=this,n=t.length-e;return t[0]===t[n]&&t[1]===t[n+1]&&(2===e||t[2]===t[n+2])}}function f(t){return Array.isArray(t[0])}const p=[0,0,0,255],g={widthUnits:"meters",widthScale:{type:"number",min:0,value:1},widthMinPixels:{type:"number",min:0,value:0},widthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},jointRounded:!1,capRounded:!1,miterLimit:{type:"number",min:0,value:4},billboard:!1,_pathType:null,getPath:{type:"accessor",value:t=>t.path},getColor:{type:"accessor",value:p},getWidth:{type:"accessor",value:1},rounded:{deprecatedFor:["jointRounded","capRounded"]}},y={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t};class m extends i.A{constructor(...t){super(...t),(0,r.A)(this,"state",void 0)}getShaders(){return super.getShaders({vs:"#define SHADER_NAME path-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute float instanceTypes;\nattribute vec3 instanceStartPositions;\nattribute vec3 instanceEndPositions;\nattribute vec3 instanceLeftPositions;\nattribute vec3 instanceRightPositions;\nattribute vec3 instanceLeftPositions64Low;\nattribute vec3 instanceStartPositions64Low;\nattribute vec3 instanceEndPositions64Low;\nattribute vec3 instanceRightPositions64Low;\nattribute float instanceStrokeWidths;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\n\nuniform float widthScale;\nuniform float widthMinPixels;\nuniform float widthMaxPixels;\nuniform float jointType;\nuniform float capType;\nuniform float miterLimit;\nuniform bool billboard;\nuniform int widthUnits;\n\nuniform float opacity;\n\nvarying vec4 vColor;\nvarying vec2 vCornerOffset;\nvarying float vMiterLength;\nvarying vec2 vPathPosition;\nvarying float vPathLength;\nvarying float vJointType;\n\nconst float EPSILON = 0.001;\nconst vec3 ZERO_OFFSET = vec3(0.0);\n\nfloat flipIfTrue(bool flag) {\n  return -(float(flag) * 2. - 1.);\n}\nvec3 getLineJoinOffset(\n  vec3 prevPoint, vec3 currPoint, vec3 nextPoint,\n  vec2 width\n) {\n  bool isEnd = positions.x > 0.0;\n  float sideOfPath = positions.y;\n  float isJoint = float(sideOfPath == 0.0);\n\n  vec3 deltaA3 = (currPoint - prevPoint);\n  vec3 deltaB3 = (nextPoint - currPoint);\n\n  mat3 rotationMatrix;\n  bool needsRotation = !billboard && project_needs_rotation(currPoint, rotationMatrix);\n  if (needsRotation) {\n    deltaA3 = deltaA3 * rotationMatrix;\n    deltaB3 = deltaB3 * rotationMatrix;\n  }\n  vec2 deltaA = deltaA3.xy / width;\n  vec2 deltaB = deltaB3.xy / width;\n\n  float lenA = length(deltaA);\n  float lenB = length(deltaB);\n\n  vec2 dirA = lenA > 0. ? normalize(deltaA) : vec2(0.0, 0.0);\n  vec2 dirB = lenB > 0. ? normalize(deltaB) : vec2(0.0, 0.0);\n\n  vec2 perpA = vec2(-dirA.y, dirA.x);\n  vec2 perpB = vec2(-dirB.y, dirB.x);\n  vec2 tangent = dirA + dirB;\n  tangent = length(tangent) > 0. ? normalize(tangent) : perpA;\n  vec2 miterVec = vec2(-tangent.y, tangent.x);\n  vec2 dir = isEnd ? dirA : dirB;\n  vec2 perp = isEnd ? perpA : perpB;\n  float L = isEnd ? lenA : lenB;\n  float sinHalfA = abs(dot(miterVec, perp));\n  float cosHalfA = abs(dot(dirA, miterVec));\n  float turnDirection = flipIfTrue(dirA.x * dirB.y >= dirA.y * dirB.x);\n  float cornerPosition = sideOfPath * turnDirection;\n\n  float miterSize = 1.0 / max(sinHalfA, EPSILON);\n  miterSize = mix(\n    min(miterSize, max(lenA, lenB) / max(cosHalfA, EPSILON)),\n    miterSize,\n    step(0.0, cornerPosition)\n  );\n\n  vec2 offsetVec = mix(miterVec * miterSize, perp, step(0.5, cornerPosition))\n    * (sideOfPath + isJoint * turnDirection);\n  bool isStartCap = lenA == 0.0 || (!isEnd && (instanceTypes == 1.0 || instanceTypes == 3.0));\n  bool isEndCap = lenB == 0.0 || (isEnd && (instanceTypes == 2.0 || instanceTypes == 3.0));\n  bool isCap = isStartCap || isEndCap;\n  if (isCap) {\n    offsetVec = mix(perp * sideOfPath, dir * capType * 4.0 * flipIfTrue(isStartCap), isJoint);\n    vJointType = capType;\n  } else {\n    vJointType = jointType;\n  }\n  vPathLength = L;\n  vCornerOffset = offsetVec;\n  vMiterLength = dot(vCornerOffset, miterVec * turnDirection);\n  vMiterLength = isCap ? isJoint : vMiterLength;\n\n  vec2 offsetFromStartOfPath = vCornerOffset + deltaA * float(isEnd);\n  vPathPosition = vec2(\n    dot(offsetFromStartOfPath, perp),\n    dot(offsetFromStartOfPath, dir)\n  );\n  geometry.uv = vPathPosition;\n\n  float isValid = step(instanceTypes, 3.5);\n  vec3 offset = vec3(offsetVec * width * isValid, 0.0);\n\n  if (needsRotation) {\n    offset = rotationMatrix * offset;\n  }\n  return offset;\n}\nvoid clipLine(inout vec4 position, vec4 refPosition) {\n  if (position.w < EPSILON) {\n    float r = (EPSILON - refPosition.w) / (position.w - refPosition.w);\n    position = refPosition + (position - refPosition) * r;\n  }\n}\n\nvoid main() {\n  geometry.pickingColor = instancePickingColors;\n\n  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity);\n\n  float isEnd = positions.x;\n\n  vec3 prevPosition = mix(instanceLeftPositions, instanceStartPositions, isEnd);\n  vec3 prevPosition64Low = mix(instanceLeftPositions64Low, instanceStartPositions64Low, isEnd);\n\n  vec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);\n  vec3 currPosition64Low = mix(instanceStartPositions64Low, instanceEndPositions64Low, isEnd);\n\n  vec3 nextPosition = mix(instanceEndPositions, instanceRightPositions, isEnd);\n  vec3 nextPosition64Low = mix(instanceEndPositions64Low, instanceRightPositions64Low, isEnd);\n\n  geometry.worldPosition = currPosition;\n  vec2 widthPixels = vec2(clamp(\n    project_size_to_pixel(instanceStrokeWidths * widthScale, widthUnits),\n    widthMinPixels, widthMaxPixels) / 2.0);\n  vec3 width;\n\n  if (billboard) {\n    vec4 prevPositionScreen = project_position_to_clipspace(prevPosition, prevPosition64Low, ZERO_OFFSET);\n    vec4 currPositionScreen = project_position_to_clipspace(currPosition, currPosition64Low, ZERO_OFFSET, geometry.position);\n    vec4 nextPositionScreen = project_position_to_clipspace(nextPosition, nextPosition64Low, ZERO_OFFSET);\n\n    clipLine(prevPositionScreen, currPositionScreen);\n    clipLine(nextPositionScreen, currPositionScreen);\n    clipLine(currPositionScreen, mix(nextPositionScreen, prevPositionScreen, isEnd));\n\n    width = vec3(widthPixels, 0.0);\n    DECKGL_FILTER_SIZE(width, geometry);\n\n    vec3 offset = getLineJoinOffset(\n      prevPositionScreen.xyz / prevPositionScreen.w,\n      currPositionScreen.xyz / currPositionScreen.w,\n      nextPositionScreen.xyz / nextPositionScreen.w,\n      project_pixel_size_to_clipspace(width.xy)\n    );\n\n    DECKGL_FILTER_GL_POSITION(currPositionScreen, geometry);\n    gl_Position = vec4(currPositionScreen.xyz + offset * currPositionScreen.w, currPositionScreen.w);\n  } else {\n    prevPosition = project_position(prevPosition, prevPosition64Low);\n    currPosition = project_position(currPosition, currPosition64Low);\n    nextPosition = project_position(nextPosition, nextPosition64Low);\n\n    width = vec3(project_pixel_size(widthPixels), 0.0);\n    DECKGL_FILTER_SIZE(width, geometry);\n\n    vec3 offset = getLineJoinOffset(prevPosition, currPosition, nextPosition, width.xy);\n    geometry.position = vec4(currPosition + offset, 1.0);\n    gl_Position = project_common_position_to_clipspace(geometry.position);\n    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  }\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#define SHADER_NAME path-layer-fragment-shader\n\nprecision highp float;\n\nuniform float miterLimit;\n\nvarying vec4 vColor;\nvarying vec2 vCornerOffset;\nvarying float vMiterLength;\nvarying vec2 vPathPosition;\nvarying float vPathLength;\nvarying float vJointType;\n\nvoid main(void) {\n  geometry.uv = vPathPosition;\n\n  if (vPathPosition.y < 0.0 || vPathPosition.y > vPathLength) {\n    if (vJointType > 0.5 && length(vCornerOffset) > 1.0) {\n      discard;\n    }\n    if (vJointType < 0.5 && vMiterLength > miterLimit + 1.0) {\n      discard;\n    }\n  }\n  gl_FragColor = vColor;\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[o.A,s.A]})}get wrapLongitude(){return!1}initializeState(){const t=!0;this.getAttributeManager().addInstanced({positions:{size:3,vertexOffset:1,type:5130,fp64:this.use64bitPositions(),transition:y,accessor:"getPath",update:this.calculatePositions,noAlloc:t,shaderAttributes:{instanceLeftPositions:{vertexOffset:0},instanceStartPositions:{vertexOffset:1},instanceEndPositions:{vertexOffset:2},instanceRightPositions:{vertexOffset:3}}},instanceTypes:{size:1,type:5121,update:this.calculateSegmentTypes,noAlloc:t},instanceStrokeWidths:{size:1,accessor:"getWidth",transition:y,defaultValue:1},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,accessor:"getColor",transition:y,defaultValue:p},instancePickingColors:{size:3,type:5121,accessor:(t,{index:e,target:n})=>this.encodePickingColor(t&&t.__source?t.__source.index:e,n)}}),this.setState({pathTesselator:new d({fp64:this.use64bitPositions()})})}updateState(t){super.updateState(t);const{props:e,changeFlags:n}=t,r=this.getAttributeManager();if(n.dataChanged||n.updateTriggersChanged&&(n.updateTriggersChanged.all||n.updateTriggersChanged.getPath)){const{pathTesselator:t}=this.state,i=e.data.attributes||{};t.updateGeometry({data:e.data,geometryBuffer:i.getPath,buffers:i,normalize:!e._pathType,loop:"loop"===e._pathType,getGeometry:e.getPath,positionFormat:e.positionFormat,wrapLongitude:e.wrapLongitude,resolution:this.context.viewport.resolution,dataChanged:n.dataChanged}),this.setState({numInstances:t.instanceCount,startIndices:t.vertexStarts}),n.dataChanged||r.invalidateAll()}if(n.extensionsChanged){var i;const{gl:t}=this.context;null===(i=this.state.model)||void 0===i||i.delete(),this.state.model=this._getModel(t),r.invalidateAll()}}getPickingInfo(t){const e=super.getPickingInfo(t),{index:n}=e,{data:r}=this.props;return r[0]&&r[0].__source&&(e.object=r.find((t=>t.__source.index===n))),e}disablePickingIndex(t){const{data:e}=this.props;if(e[0]&&e[0].__source)for(let n=0;n<e.length;n++)e[n].__source.index===t&&this._disablePickingIndex(n);else super.disablePickingIndex(t)}draw({uniforms:t}){const{jointRounded:e,capRounded:n,billboard:r,miterLimit:i,widthUnits:o,widthScale:s,widthMinPixels:l,widthMaxPixels:u}=this.props;this.state.model.setUniforms(t).setUniforms({jointType:Number(e),capType:Number(n),billboard:r,widthUnits:a.p5[o],widthScale:s,miterLimit:i,widthMinPixels:l,widthMaxPixels:u}).draw()}_getModel(t){return new l.A(t,{...this.getShaders(),id:this.props.id,geometry:new u.A({drawMode:4,attributes:{indices:new Uint16Array([0,1,2,1,4,2,1,3,4,3,5,4]),positions:{value:new Float32Array([0,0,0,-1,0,1,1,-1,1,1,1,0]),size:2}}}),isInstanced:!0})}calculatePositions(t){const{pathTesselator:e}=this.state;t.startIndices=e.vertexStarts,t.value=e.get("positions")}calculateSegmentTypes(t){const{pathTesselator:e}=this.state;t.startIndices=e.vertexStarts,t.value=e.get("segmentTypes")}}(0,r.A)(m,"defaultProps",g),(0,r.A)(m,"layerName","PathLayer")},81537:(t,e,n)=>{"use strict";n.d(e,{A:()=>p});var r=n(67136),i=n(36179),o=n(79464),s=n(44123),a=n(70560),l=n(1597),u=n(76694),c=n(82170);const h=[0,0,0,255],d=[0,0,1],f={sizeUnits:"pixels",pointSize:{type:"number",min:0,value:10},getPosition:{type:"accessor",value:t=>t.position},getNormal:{type:"accessor",value:d},getColor:{type:"accessor",value:h},material:!0,radiusPixels:{deprecatedFor:"pointSize"}};class p extends i.A{getShaders(){return super.getShaders({vs:"#define SHADER_NAME point-cloud-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec3 instanceNormals;\nattribute vec4 instanceColors;\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute vec3 instancePickingColors;\n\nuniform float opacity;\nuniform float radiusPixels;\nuniform int sizeUnits;\n\nvarying vec4 vColor;\nvarying vec2 unitPosition;\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.normal = project_normal(instanceNormals);\n  unitPosition = positions.xy;\n  geometry.uv = unitPosition;\n  geometry.pickingColor = instancePickingColors;\n  vec3 offset = vec3(positions.xy * project_size_to_pixel(radiusPixels, sizeUnits), 0.0);\n  DECKGL_FILTER_SIZE(offset, geometry);\n\n  gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.), geometry.position);\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n  vec3 lightColor = lighting_getLightColor(instanceColors.rgb, project_uCameraPosition, geometry.position.xyz, geometry.normal);\n  vColor = vec4(lightColor, instanceColors.a * opacity);\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#define SHADER_NAME point-cloud-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\nvarying vec2 unitPosition;\n\nvoid main(void) {\n  geometry.uv = unitPosition;\n\n  float distToCenter = length(unitPosition);\n\n  if (distToCenter > 1.0) {\n    discard;\n  }\n\n  gl_FragColor = vColor;\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[o.A,s.K,a.A]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceNormals:{size:3,transition:!0,accessor:"getNormal",defaultValue:d},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:h}})}updateState(t){const{changeFlags:e,props:n}=t;if(super.updateState(t),e.extensionsChanged){var r;const{gl:t}=this.context;null===(r=this.state.model)||void 0===r||r.delete(),this.state.model=this._getModel(t),this.getAttributeManager().invalidateAll()}e.dataChanged&&function(t){const{header:e,attributes:n}=t;e&&n&&(t.length=e.vertexCount,n.POSITION&&(n.instancePositions=n.POSITION),n.NORMAL&&(n.instanceNormals=n.NORMAL),n.COLOR_0&&(n.instanceColors=n.COLOR_0))}(n.data)}draw({uniforms:t}){const{pointSize:e,sizeUnits:n}=this.props;this.state.model.setUniforms(t).setUniforms({sizeUnits:l.p5[n],radiusPixels:e}).draw()}_getModel(t){const e=[];for(let t=0;t<3;t++){const n=t/3*Math.PI*2;e.push(2*Math.cos(n),2*Math.sin(n),0)}return new u.A(t,{...this.getShaders(),id:this.props.id,geometry:new c.A({drawMode:4,attributes:{positions:new Float32Array(e)}}),isInstanced:!0})}}(0,r.A)(p,"layerName","PointCloudLayer"),(0,r.A)(p,"defaultProps",f)},19460:(t,e,n)=>{"use strict";n.d(e,{A:()=>f});var r=n(67136),i=n(68411),o=n(26820),s=n(97870),a=n(58534),l=n(33885),u=n(35110),c=n(53986);const h=[0,0,0,255],d={stroked:!0,filled:!0,extruded:!1,elevationScale:1,wireframe:!1,_normalize:!0,_windingOrder:"CW",lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,lineJointRounded:!1,lineMiterLimit:4,getPolygon:{type:"accessor",value:t=>t.polygon},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:h},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0};class f extends i.A{initializeState(){this.state={paths:[]},this.props.getLineDashArray&&o.A.removed("getLineDashArray","PathStyleExtension")()}updateState({changeFlags:t}){const e=t.dataChanged||t.updateTriggersChanged&&(t.updateTriggersChanged.all||t.updateTriggersChanged.getPolygon);if(e&&Array.isArray(t.dataChanged)){const e=this.state.paths.slice(),n=t.dataChanged.map((t=>(0,c.J)({data:e,getIndex:t=>t.__source.index,dataRange:t,replace:this._getPaths(t)})));this.setState({paths:e,pathsDiff:n})}else e&&this.setState({paths:this._getPaths(),pathsDiff:null})}_getPaths(t={}){const{data:e,getPolygon:n,positionFormat:r,_normalize:i}=this.props,o=[],a="XY"===r?2:3,{startRow:l,endRow:c}=t,{iterable:h,objectInfo:d}=(0,s.X)(e,l,c);for(const t of h){d.index++;let e=n(t,d);i&&(e=u.S8(e,a));const{holeIndices:r}=e,s=e.positions||e;if(r)for(let e=0;e<=r.length;e++){const n=s.slice(r[e-1]||0,r[e]||s.length);o.push(this.getSubLayerRow({path:n},t,d.index))}else o.push(this.getSubLayerRow({path:s},t,d.index))}return o}renderLayers(){const{data:t,_dataDiff:e,stroked:n,filled:r,extruded:i,wireframe:o,_normalize:s,_windingOrder:u,elevationScale:c,transitions:d,positionFormat:f}=this.props,{lineWidthUnits:p,lineWidthScale:g,lineWidthMinPixels:y,lineWidthMaxPixels:m,lineJointRounded:v,lineMiterLimit:b,lineDashJustified:_}=this.props,{getFillColor:A,getLineColor:x,getLineWidth:w,getLineDashArray:C,getElevation:S,getPolygon:E,updateTriggers:M,material:P}=this.props,{paths:T,pathsDiff:O}=this.state,I=this.getSubLayerClass("fill",a.A),R=this.getSubLayerClass("stroke",l.A),B=this.shouldRenderSubLayer("fill",T)&&new I({_dataDiff:e,extruded:i,elevationScale:c,filled:r,wireframe:o,_normalize:s,_windingOrder:u,getElevation:S,getFillColor:A,getLineColor:i&&o?x:h,material:P,transitions:d},this.getSubLayerProps({id:"fill",updateTriggers:M&&{getPolygon:M.getPolygon,getElevation:M.getElevation,getFillColor:M.getFillColor,lineColors:i&&o,getLineColor:M.getLineColor}}),{data:t,positionFormat:f,getPolygon:E});return[!i&&B,!i&&n&&this.shouldRenderSubLayer("stroke",T)&&new R({_dataDiff:O&&(()=>O),widthUnits:p,widthScale:g,widthMinPixels:y,widthMaxPixels:m,jointRounded:v,miterLimit:b,dashJustified:_,_pathType:"loop",transitions:d&&{getWidth:d.getLineWidth,getColor:d.getLineColor,getPath:d.getPolygon},getColor:this.getSubLayerAccessor(x),getWidth:this.getSubLayerAccessor(w),getDashArray:this.getSubLayerAccessor(C)},this.getSubLayerProps({id:"stroke",updateTriggers:M&&{getWidth:M.getLineWidth,getColor:M.getLineColor,getDashArray:M.getLineDashArray}}),{data:T,positionFormat:f,getPath:t=>t.path}),i&&B]}}(0,r.A)(f,"layerName","PolygonLayer"),(0,r.A)(f,"defaultProps",d)},54127:(t,e,n)=>{"use strict";n.d(e,{A:()=>d});var r=n(67136),i=n(36179),o=n(79464),s=n(70560),a=n(1597),l=n(76694),u=n(82170);const c=[0,0,0,255],h={radiusUnits:"meters",radiusScale:{type:"number",min:0,value:1},radiusMinPixels:{type:"number",min:0,value:0},radiusMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},lineWidthUnits:"meters",lineWidthScale:{type:"number",min:0,value:1},lineWidthMinPixels:{type:"number",min:0,value:0},lineWidthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},stroked:!1,filled:!0,billboard:!1,antialiasing:!0,getPosition:{type:"accessor",value:t=>t.position},getRadius:{type:"accessor",value:1},getFillColor:{type:"accessor",value:c},getLineColor:{type:"accessor",value:c},getLineWidth:{type:"accessor",value:1},strokeWidth:{deprecatedFor:"getLineWidth"},outline:{deprecatedFor:"stroked"},getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class d extends i.A{getShaders(){return super.getShaders({vs:"#define SHADER_NAME scatterplot-layer-vertex-shader\n\nattribute vec3 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute float instanceRadius;\nattribute float instanceLineWidths;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute vec3 instancePickingColors;\n\nuniform float opacity;\nuniform float radiusScale;\nuniform float radiusMinPixels;\nuniform float radiusMaxPixels;\nuniform float lineWidthScale;\nuniform float lineWidthMinPixels;\nuniform float lineWidthMaxPixels;\nuniform float stroked;\nuniform bool filled;\nuniform bool antialiasing;\nuniform bool billboard;\nuniform int radiusUnits;\nuniform int lineWidthUnits;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying vec2 unitPosition;\nvarying float innerUnitRadius;\nvarying float outerRadiusPixels;\n\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  outerRadiusPixels = clamp(\n    project_size_to_pixel(radiusScale * instanceRadius, radiusUnits),\n    radiusMinPixels, radiusMaxPixels\n  );\n  float lineWidthPixels = clamp(\n    project_size_to_pixel(lineWidthScale * instanceLineWidths, lineWidthUnits),\n    lineWidthMinPixels, lineWidthMaxPixels\n  );\n  outerRadiusPixels += stroked * lineWidthPixels / 2.0;\n  float edgePadding = antialiasing ? (outerRadiusPixels + SMOOTH_EDGE_RADIUS) / outerRadiusPixels : 1.0;\n  unitPosition = edgePadding * positions.xy;\n  geometry.uv = unitPosition;\n  geometry.pickingColor = instancePickingColors;\n\n  innerUnitRadius = 1.0 - stroked * lineWidthPixels / outerRadiusPixels;\n  \n  if (billboard) {\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n    vec3 offset = edgePadding * positions * outerRadiusPixels;\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n  } else {\n    vec3 offset = edgePadding * positions * project_pixel_size(outerRadiusPixels);\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset, geometry.position);\n    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  }\n  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);\n  DECKGL_FILTER_COLOR(vFillColor, geometry);\n  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);\n  DECKGL_FILTER_COLOR(vLineColor, geometry);\n}\n",fs:"#define SHADER_NAME scatterplot-layer-fragment-shader\n\nprecision highp float;\n\nuniform bool filled;\nuniform float stroked;\nuniform bool antialiasing;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying vec2 unitPosition;\nvarying float innerUnitRadius;\nvarying float outerRadiusPixels;\n\nvoid main(void) {\n  geometry.uv = unitPosition;\n\n  float distToCenter = length(unitPosition) * outerRadiusPixels;\n  float inCircle = antialiasing ? \n    smoothedge(distToCenter, outerRadiusPixels) : \n    step(distToCenter, outerRadiusPixels);\n\n  if (inCircle == 0.0) {\n    discard;\n  }\n\n  if (stroked > 0.5) {\n    float isLine = antialiasing ? \n      smoothedge(innerUnitRadius * outerRadiusPixels, distToCenter) :\n      step(innerUnitRadius * outerRadiusPixels, distToCenter);\n\n    if (filled) {\n      gl_FragColor = mix(vFillColor, vLineColor, isLine);\n    } else {\n      if (isLine == 0.0) {\n        discard;\n      }\n      gl_FragColor = vec4(vLineColor.rgb, vLineColor.a * isLine);\n    }\n  } else if (!filled) {\n    discard;\n  } else {\n    gl_FragColor = vFillColor;\n  }\n\n  gl_FragColor.a *= inCircle;\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[o.A,s.A]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceRadius:{size:1,transition:!0,accessor:"getRadius",defaultValue:1},instanceFillColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(t){if(super.updateState(t),t.changeFlags.extensionsChanged){var e;const{gl:t}=this.context;null===(e=this.state.model)||void 0===e||e.delete(),this.state.model=this._getModel(t),this.getAttributeManager().invalidateAll()}}draw({uniforms:t}){const{radiusUnits:e,radiusScale:n,radiusMinPixels:r,radiusMaxPixels:i,stroked:o,filled:s,billboard:l,antialiasing:u,lineWidthUnits:c,lineWidthScale:h,lineWidthMinPixels:d,lineWidthMaxPixels:f}=this.props;this.state.model.setUniforms(t).setUniforms({stroked:o?1:0,filled:s,billboard:l,antialiasing:u,radiusUnits:a.p5[e],radiusScale:n,radiusMinPixels:r,radiusMaxPixels:i,lineWidthUnits:a.p5[c],lineWidthScale:h,lineWidthMinPixels:d,lineWidthMaxPixels:f}).draw()}_getModel(t){return new l.A(t,{...this.getShaders(),id:this.props.id,geometry:new u.A({drawMode:6,vertexCount:4,attributes:{positions:{size:3,value:new Float32Array([-1,-1,0,1,-1,0,1,1,0,-1,1,0])}}}),isInstanced:!0})}}(0,r.A)(d,"defaultProps",h),(0,r.A)(d,"layerName","ScatterplotLayer")},35110:(t,e,n)=>{"use strict";n.d(e,{$q:()=>y,A4:()=>c,Dt:()=>u,S8:()=>f});var r=n(66570),i=n.n(r),o=n(34439);const s=o.rJ.CLOCKWISE,a=o.rJ.COUNTER_CLOCKWISE,l={isClosed:!0};function u(t){return"positions"in t?t.positions:t}function c(t){return"holeIndices"in t?t.holeIndices:null}function h(t,e,n,r,i){let s=e;const a=n.length;for(let e=0;e<a;e++)for(let i=0;i<r;i++)t[s++]=n[e][i]||0;if(!function(t){const e=t[0],n=t[t.length-1];return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]}(n))for(let e=0;e<r;e++)t[s++]=n[0][e]||0;return l.start=e,l.end=s,l.size=r,(0,o.UD)(t,i,l),s}function d(t,e,n,r,i=0,s,a){const u=(s=s||n.length)-i;if(u<=0)return e;let c=e;for(let e=0;e<u;e++)t[c++]=n[i+e];if(!function(t,e,n,r){for(let i=0;i<e;i++)if(t[n+i]!==t[r-e+i])return!1;return!0}(n,r,i,s))for(let e=0;e<r;e++)t[c++]=n[i+e];return l.start=e,l.end=c,l.size=r,(0,o.UD)(t,a,l),c}function f(t,e){!function(t){if(t=t&&t.positions||t,!Array.isArray(t)&&!ArrayBuffer.isView(t))throw new Error("invalid polygon")}(t);const n=[],r=[];if("positions"in t){const{positions:i,holeIndices:o}=t;if(o){let t=0;for(let l=0;l<=o.length;l++)t=d(n,t,i,e,o[l-1],o[l],0===l?s:a),r.push(t);return r.pop(),{positions:n,holeIndices:r}}t=i}if(!function(t){return Array.isArray(t[0])}(t))return d(n,0,t,e,0,n.length,s),n;if(!function(t){return t.length>=1&&t[0].length>=2&&Number.isFinite(t[0][0])}(t)){let i=0;for(const[o,l]of t.entries())i=h(n,i,l,e,0===o?s:a),r.push(i);return r.pop(),{positions:n,holeIndices:r}}return h(n,0,t,e,s),n}function p(t,e,n){const r=t.length/3;let i=0;for(let o=0;o<r;o++){const s=(o+1)%r;i+=t[3*o+e]*t[3*s+n],i-=t[3*s+e]*t[3*o+n]}return Math.abs(i/2)}function g(t,e,n,r){const i=t.length/3;for(let o=0;o<i;o++){const i=3*o,s=t[i+0],a=t[i+1],l=t[i+2];t[i+e]=s,t[i+n]=a,t[i+r]=l}}function y(t,e,n,r){let o=c(t);o&&(o=o.map((t=>t/e)));let s=u(t);const a=r&&3===e;if(n){const t=s.length;s=s.slice();const r=[];for(let i=0;i<t;i+=e){r[0]=s[i],r[1]=s[i+1],a&&(r[2]=s[i+2]);const t=n(r);s[i]=t[0],s[i+1]=t[1],a&&(s[i+2]=t[2])}}if(a){const t=p(s,0,1),e=p(s,0,2),r=p(s,1,2);if(!t&&!e&&!r)return[];t>e&&t>r||(e>r?(n||(s=s.slice()),g(s,0,2,1)):(n||(s=s.slice()),g(s,2,0,1)))}return i()(s,o,e)}},58534:(t,e,n)=>{"use strict";n.d(e,{A:()=>C});var r=n(67136),i=n(36179),o=n(79464),s=n(44123),a=n(70560),l=n(1597),u=n(77325),c=n(38404),h=n(76694),d=n(82170),f=n(35110),p=n(57512),g=n(34439);class y extends p.A{constructor(t){const{fp64:e,IndexType:n=Uint32Array}=t;super({...t,attributes:{positions:{size:3,type:e?Float64Array:Float32Array},vertexValid:{type:Uint8ClampedArray,size:1},indices:{type:n,size:1}}})}get(t){const{attributes:e}=this;return"indices"===t?e.indices&&e.indices.subarray(0,this.vertexCount):e[t]}updateGeometry(t){super.updateGeometry(t);const e=this.buffers.indices;if(e)this.vertexCount=(e.value||e).length;else if(this.data&&!this.getGeometry)throw new Error("missing indices buffer")}normalizeGeometry(t){if(this.normalize){const e=f.S8(t,this.positionSize);return this.opts.resolution?(0,g.wk)(f.Dt(e),f.A4(e),{size:this.positionSize,gridResolution:this.opts.resolution,edgeTypes:!0}):this.opts.wrapLongitude?(0,g.Eg)(f.Dt(e),f.A4(e),{size:this.positionSize,maxLatitude:86,edgeTypes:!0}):e}return t}getGeometrySize(t){if(m(t)){let e=0;for(const n of t)e+=this.getGeometrySize(n);return e}return f.Dt(t).length/this.positionSize}getGeometryFromBuffer(t){return this.normalize||!this.buffers.indices?super.getGeometryFromBuffer(t):null}updateGeometryAttributes(t,e){if(t&&m(t))for(const n of t){const t=this.getGeometrySize(n);e.geometrySize=t,this.updateGeometryAttributes(n,e),e.vertexStart+=t,e.indexStart=this.indexStarts[e.geometryIndex+1]}else this._updateIndices(t,e),this._updatePositions(t,e),this._updateVertexValid(t,e)}_updateIndices(t,{geometryIndex:e,vertexStart:n,indexStart:r}){const{attributes:i,indexStarts:o,typedArrayManager:s}=this;let a=i.indices;if(!a||!t)return;let l=r;const u=f.$q(t,this.positionSize,this.opts.preproject,this.opts.full3d);a=s.allocate(a,r+u.length,{copy:!0});for(let t=0;t<u.length;t++)a[l++]=u[t]+n;o[e+1]=r+u.length,i.indices=a}_updatePositions(t,{vertexStart:e,geometrySize:n}){const{attributes:{positions:r},positionSize:i}=this;if(!r||!t)return;const o=f.Dt(t);for(let t=e,s=0;s<n;t++,s++){const e=o[s*i],n=o[s*i+1],a=i>2?o[s*i+2]:0;r[3*t]=e,r[3*t+1]=n,r[3*t+2]=a}}_updateVertexValid(t,{vertexStart:e,geometrySize:n}){const{positionSize:r}=this,i=this.attributes.vertexValid,o=t&&f.A4(t);if(t&&t.edgeTypes?i.set(t.edgeTypes,e):i.fill(1,e,e+n),o)for(let t=0;t<o.length;t++)i[e+o[t]/r-1]=0;i[e+n-1]=0}}function m(t){return Array.isArray(t)&&t.length>0&&!Number.isFinite(t[0])}const v="\nattribute vec2 vertexPositions;\nattribute float vertexValid;\n\nuniform bool extruded;\nuniform bool isWireframe;\nuniform float elevationScale;\nuniform float opacity;\n\nvarying vec4 vColor;\n\nstruct PolygonProps {\n  vec4 fillColors;\n  vec4 lineColors;\n  vec3 positions;\n  vec3 nextPositions;\n  vec3 pickingColors;\n  vec3 positions64Low;\n  vec3 nextPositions64Low;\n  float elevations;\n};\n\nvec3 project_offset_normal(vec3 vector) {\n  if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS) {\n    return normalize(vector * project_uCommonUnitsPerWorldUnit);\n  }\n  return project_normal(vector);\n}\n\nvoid calculatePosition(PolygonProps props) {\n#ifdef IS_SIDE_VERTEX\n  if(vertexValid < 0.5){\n    gl_Position = vec4(0.);\n    return;\n  }\n#endif\n\n  vec3 pos;\n  vec3 pos64Low;\n  vec3 normal;\n  vec4 colors = isWireframe ? props.lineColors : props.fillColors;\n\n  geometry.worldPosition = props.positions;\n  geometry.worldPositionAlt = props.nextPositions;\n  geometry.pickingColor = props.pickingColors;\n\n#ifdef IS_SIDE_VERTEX\n  pos = mix(props.positions, props.nextPositions, vertexPositions.x);\n  pos64Low = mix(props.positions64Low, props.nextPositions64Low, vertexPositions.x);\n#else\n  pos = props.positions;\n  pos64Low = props.positions64Low;\n#endif\n\n  if (extruded) {\n    pos.z += props.elevations * vertexPositions.y * elevationScale;\n  }\n  gl_Position = project_position_to_clipspace(pos, pos64Low, vec3(0.), geometry.position);\n\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  if (extruded) {\n  #ifdef IS_SIDE_VERTEX\n    normal = vec3(\n      props.positions.y - props.nextPositions.y + (props.positions64Low.y - props.nextPositions64Low.y),\n      props.nextPositions.x - props.positions.x + (props.nextPositions64Low.x - props.positions64Low.x),\n      0.0);\n    normal = project_offset_normal(normal);\n  #else\n    normal = project_normal(vec3(0.0, 0.0, 1.0));\n  #endif\n    geometry.normal = normal;\n    vec3 lightColor = lighting_getLightColor(colors.rgb, project_uCameraPosition, geometry.position.xyz, normal);\n    vColor = vec4(lightColor, colors.a * opacity);\n  } else {\n    vColor = vec4(colors.rgb, colors.a * opacity);\n  }\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",b="#define SHADER_NAME solid-polygon-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec3 positions64Low;\nattribute float elevations;\nattribute vec4 fillColors;\nattribute vec4 lineColors;\nattribute vec3 pickingColors;\n\n".concat(v,"\n\nvoid main(void) {\n  PolygonProps props;\n\n  props.positions = positions;\n  props.positions64Low = positions64Low;\n  props.elevations = elevations;\n  props.fillColors = fillColors;\n  props.lineColors = lineColors;\n  props.pickingColors = pickingColors;\n\n  calculatePosition(props);\n}\n"),_="#define SHADER_NAME solid-polygon-layer-vertex-shader-side\n#define IS_SIDE_VERTEX\n\n\nattribute vec3 instancePositions;\nattribute vec3 nextPositions;\nattribute vec3 instancePositions64Low;\nattribute vec3 nextPositions64Low;\nattribute float instanceElevations;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute vec3 instancePickingColors;\n\n".concat(v,"\n\nvoid main(void) {\n  PolygonProps props;\n\n  #if RING_WINDING_ORDER_CW == 1\n    props.positions = instancePositions;\n    props.positions64Low = instancePositions64Low;\n    props.nextPositions = nextPositions;\n    props.nextPositions64Low = nextPositions64Low;\n  #else\n    props.positions = nextPositions;\n    props.positions64Low = nextPositions64Low;\n    props.nextPositions = instancePositions;\n    props.nextPositions64Low = instancePositions64Low;\n  #endif\n  props.elevations = instanceElevations;\n  props.fillColors = instanceFillColors;\n  props.lineColors = instanceLineColors;\n  props.pickingColors = instancePickingColors;\n\n  calculatePosition(props);\n}\n"),A=[0,0,0,255],x={filled:!0,extruded:!1,wireframe:!1,_normalize:!0,_windingOrder:"CW",_full3d:!1,elevationScale:{type:"number",min:0,value:1},getPolygon:{type:"accessor",value:t=>t.polygon},getElevation:{type:"accessor",value:1e3},getFillColor:{type:"accessor",value:A},getLineColor:{type:"accessor",value:A},material:!0},w={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t};class C extends i.A{constructor(...t){super(...t),(0,r.A)(this,"state",void 0)}getShaders(t){return super.getShaders({vs:"top"===t?b:_,fs:"#define SHADER_NAME solid-polygon-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\n\nvoid main(void) {\n  gl_FragColor = vColor;\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",defines:{RING_WINDING_ORDER_CW:this.props._normalize||"CCW"!==this.props._windingOrder?1:0},modules:[o.A,s.K,a.A]})}get wrapLongitude(){return!1}initializeState(){const{gl:t,viewport:e}=this.context;let{coordinateSystem:n}=this.props;const{_full3d:r}=this.props;let i;e.isGeospatial&&n===l.rf.DEFAULT&&(n=l.rf.LNGLAT),n===l.rf.LNGLAT&&(i=r?e.projectPosition.bind(e):e.projectFlat.bind(e)),this.setState({numInstances:0,polygonTesselator:new y({preproject:i,fp64:this.use64bitPositions(),IndexType:!t||(0,u.QN)(t,c.G.ELEMENT_INDEX_UINT32)?Uint32Array:Uint16Array})});const o=this.getAttributeManager(),s=!0;o.remove(["instancePickingColors"]),o.add({indices:{size:1,isIndexed:!0,update:this.calculateIndices,noAlloc:s},positions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:w,accessor:"getPolygon",update:this.calculatePositions,noAlloc:s,shaderAttributes:{positions:{vertexOffset:0,divisor:0},instancePositions:{vertexOffset:0,divisor:1},nextPositions:{vertexOffset:1,divisor:1}}},vertexValid:{size:1,divisor:1,type:5121,update:this.calculateVertexValid,noAlloc:s},elevations:{size:1,transition:w,accessor:"getElevation",shaderAttributes:{elevations:{divisor:0},instanceElevations:{divisor:1}}},fillColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:w,accessor:"getFillColor",defaultValue:A,shaderAttributes:{fillColors:{divisor:0},instanceFillColors:{divisor:1}}},lineColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:w,accessor:"getLineColor",defaultValue:A,shaderAttributes:{lineColors:{divisor:0},instanceLineColors:{divisor:1}}},pickingColors:{size:3,type:5121,accessor:(t,{index:e,target:n})=>this.encodePickingColor(t&&t.__source?t.__source.index:e,n),shaderAttributes:{pickingColors:{divisor:0},instancePickingColors:{divisor:1}}}})}getPickingInfo(t){const e=super.getPickingInfo(t),{index:n}=e,{data:r}=this.props;return r[0]&&r[0].__source&&(e.object=r.find((t=>t.__source.index===n))),e}disablePickingIndex(t){const{data:e}=this.props;if(e[0]&&e[0].__source)for(let n=0;n<e.length;n++)e[n].__source.index===t&&this._disablePickingIndex(n);else super.disablePickingIndex(t)}draw({uniforms:t}){const{extruded:e,filled:n,wireframe:r,elevationScale:i}=this.props,{topModel:o,sideModel:s,polygonTesselator:a}=this.state,l={...t,extruded:Boolean(e),elevationScale:i};s&&(s.setInstanceCount(a.instanceCount-1),s.setUniforms(l),r&&(s.setDrawMode(3),s.setUniforms({isWireframe:!0}).draw()),n&&(s.setDrawMode(6),s.setUniforms({isWireframe:!1}).draw())),o&&(o.setVertexCount(a.vertexCount),o.setUniforms(l).draw())}updateState(t){super.updateState(t),this.updateGeometry(t);const{props:e,oldProps:n,changeFlags:r}=t,i=this.getAttributeManager();var o;(r.extensionsChanged||e.filled!==n.filled||e.extruded!==n.extruded)&&(null===(o=this.state.models)||void 0===o||o.forEach((t=>t.delete())),this.setState(this._getModels(this.context.gl)),i.invalidateAll())}updateGeometry({props:t,oldProps:e,changeFlags:n}){if(n.dataChanged||n.updateTriggersChanged&&(n.updateTriggersChanged.all||n.updateTriggersChanged.getPolygon)){const{polygonTesselator:e}=this.state,r=t.data.attributes||{};e.updateGeometry({data:t.data,normalize:t._normalize,geometryBuffer:r.getPolygon,buffers:r,getGeometry:t.getPolygon,positionFormat:t.positionFormat,wrapLongitude:t.wrapLongitude,resolution:this.context.viewport.resolution,fp64:this.use64bitPositions(),dataChanged:n.dataChanged,full3d:t._full3d}),this.setState({numInstances:e.instanceCount,startIndices:e.vertexStarts}),n.dataChanged||this.getAttributeManager().invalidateAll()}}_getModels(t){const{id:e,filled:n,extruded:r}=this.props;let i,o;if(n){const n=this.getShaders("top");n.defines.NON_INSTANCED_MODEL=1,i=new h.A(t,{...n,id:"".concat(e,"-top"),drawMode:4,attributes:{vertexPositions:new Float32Array([0,1])},uniforms:{isWireframe:!1,isSideVertex:!1},vertexCount:0,isIndexed:!0})}return r&&(o=new h.A(t,{...this.getShaders("side"),id:"".concat(e,"-side"),geometry:new d.A({drawMode:1,vertexCount:4,attributes:{vertexPositions:{size:2,value:new Float32Array([1,0,0,0,0,1,1,1])}}}),instanceCount:0,isInstanced:1}),o.userData.excludeAttributes={indices:!0}),{models:[o,i].filter(Boolean),topModel:i,sideModel:o}}calculateIndices(t){const{polygonTesselator:e}=this.state;t.startIndices=e.indexStarts,t.value=e.get("indices")}calculatePositions(t){const{polygonTesselator:e}=this.state;t.startIndices=e.vertexStarts,t.value=e.get("positions")}calculateVertexValid(t){t.value=this.state.polygonTesselator.get("vertexValid")}}(0,r.A)(C,"defaultProps",x),(0,r.A)(C,"layerName","SolidPolygonLayer")},93677:(t,e,n)=>{"use strict";n.d(e,{A:()=>l});var r=n(67136),i=n(26820),o=n(58830);const s=.75,a=[];class l extends o.A{constructor(...t){super(...t),(0,r.A)(this,"state",void 0)}getShaders(){return{...super.getShaders(),fs:"#define SHADER_NAME multi-icon-layer-fragment-shader\n\nprecision highp float;\n\nuniform float opacity;\nuniform sampler2D iconsTexture;\nuniform float gamma;\nuniform bool sdf;\nuniform float alphaCutoff;\nuniform float sdfBuffer;\nuniform float outlineBuffer;\nuniform vec4 outlineColor;\n\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  if (!picking_uActive) {\n    float alpha = texture2D(iconsTexture, vTextureCoords).a;\n    vec4 color = vColor;\n    if (sdf) {\n      float distance = alpha;\n      alpha = smoothstep(sdfBuffer - gamma, sdfBuffer + gamma, distance);\n\n      if (outlineBuffer > 0.0) {\n        float inFill = alpha;\n        float inBorder = smoothstep(outlineBuffer - gamma, outlineBuffer + gamma, distance);\n        color = mix(outlineColor, vColor, inFill);\n        alpha = inBorder;\n      }\n    }\n    float a = alpha * color.a;\n    \n    if (a < alphaCutoff) {\n      discard;\n    }\n\n    gl_FragColor = vec4(color.rgb, a * opacity);\n  }\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n"}}initializeState(){super.initializeState(),this.getAttributeManager().addInstanced({instanceOffsets:{size:2,accessor:"getIconOffsets"},instancePickingColors:{type:5121,size:3,accessor:(t,{index:e,target:n})=>this.encodePickingColor(e,n)}})}updateState(t){super.updateState(t);const{props:e,oldProps:n}=t;let{outlineColor:r}=e;r!==n.outlineColor&&(r=r.map((t=>t/255)),r[3]=Number.isFinite(r[3])?r[3]:1,this.setState({outlineColor:r})),!e.sdf&&e.outlineWidth&&i.A.warn("".concat(this.id,": fontSettings.sdf is required to render outline"))()}draw(t){const{sdf:e,smoothing:n,outlineWidth:r}=this.props,{outlineColor:i}=this.state,o=r?Math.max(n,s*(1-r)):-1;if(t.uniforms={...t.uniforms,sdfBuffer:s,outlineBuffer:o,gamma:n,sdf:Boolean(e),outlineColor:i},super.draw(t),e&&r){const{iconManager:t}=this.state;t.getTexture()&&this.state.model.draw({uniforms:{outlineBuffer:s}})}}getInstanceOffset(t){return t?Array.from(t).flatMap((t=>super.getInstanceOffset(t))):a}getInstanceColorMode(t){return 1}getInstanceIconFrame(t){return t?Array.from(t).flatMap((t=>super.getInstanceIconFrame(t))):a}}(0,r.A)(l,"defaultProps",{getIconOffsets:{type:"accessor",value:t=>t.offsets},alphaCutoff:.001,smoothing:.1,outlineWidth:0,outlineColor:{type:"color",value:[0,0,0,255]}}),(0,r.A)(l,"layerName","MultiIconLayer")},18948:(t,e,n)=>{"use strict";n.d(e,{A:()=>h});var r=n(67136),i=n(36179),o=n(79464),s=n(70560),a=n(1597),l=n(76694),u=n(82170);const c={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,padding:{type:"array",value:[0,0,0,0]},getPosition:{type:"accessor",value:t=>t.position},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},getBoundingRect:{type:"accessor",value:[0,0,0,0]},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:[0,0,0,255]},getLineWidth:{type:"accessor",value:1}};class h extends i.A{constructor(...t){super(...t),(0,r.A)(this,"state",void 0)}getShaders(){return super.getShaders({vs:"#define SHADER_NAME text-background-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute vec4 instanceRects;\nattribute float instanceSizes;\nattribute float instanceAngles;\nattribute vec2 instancePixelOffsets;\nattribute float instanceLineWidths;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute vec3 instancePickingColors;\n\nuniform bool billboard;\nuniform float opacity;\nuniform float sizeScale;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform vec4 padding;\nuniform int sizeUnits;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying float vLineWidth;\nvarying vec2 uv;\nvarying vec2 dimensions;\n\nvec2 rotate_by_angle(vec2 vertex, float angle) {\n  float angle_radian = radians(angle);\n  float cos_angle = cos(angle_radian);\n  float sin_angle = sin(angle_radian);\n  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);\n  return rotationMatrix * vertex;\n}\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = positions;\n  geometry.pickingColor = instancePickingColors;\n  uv = positions;\n  vLineWidth = instanceLineWidths;\n  float sizePixels = clamp(\n    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits),\n    sizeMinPixels, sizeMaxPixels\n  );\n\n  dimensions = instanceRects.zw * sizePixels + padding.xy + padding.zw;\n\n  vec2 pixelOffset = (positions * instanceRects.zw + instanceRects.xy) * sizePixels + mix(-padding.xy, padding.zw, positions);\n  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles);\n  pixelOffset += instancePixelOffsets;\n  pixelOffset.y *= -1.0;\n\n  if (billboard)  {\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n    vec3 offset = vec3(pixelOffset, 0.0);\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n  } else {\n    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);\n    DECKGL_FILTER_SIZE(offset_common, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);\n    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  }\n  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);\n  DECKGL_FILTER_COLOR(vFillColor, geometry);\n  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);\n  DECKGL_FILTER_COLOR(vLineColor, geometry);\n}\n",fs:"#define SHADER_NAME text-background-layer-fragment-shader\n\nprecision highp float;\n\nuniform bool stroked;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying float vLineWidth;\nvarying vec2 uv;\nvarying vec2 dimensions;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  vec2 pixelPosition = uv * dimensions;\n  if (stroked) {\n    float distToEdge = min(\n      min(pixelPosition.x, dimensions.x - pixelPosition.x),\n      min(pixelPosition.y, dimensions.y - pixelPosition.y)\n    );\n    float isBorder = smoothedge(distToEdge, vLineWidth);\n    gl_FragColor = mix(vFillColor, vLineColor, isBorder);\n  } else {\n    gl_FragColor = vFillColor;\n  }\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[o.A,s.A]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instanceRects:{size:4,accessor:"getBoundingRect"},instancePixelOffsets:{size:2,transition:!0,accessor:"getPixelOffset"},instanceFillColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(t){super.updateState(t);const{changeFlags:e}=t;if(e.extensionsChanged){var n;const{gl:t}=this.context;null===(n=this.state.model)||void 0===n||n.delete(),this.state.model=this._getModel(t),this.getAttributeManager().invalidateAll()}}draw({uniforms:t}){const{billboard:e,sizeScale:n,sizeUnits:r,sizeMinPixels:i,sizeMaxPixels:o,getLineWidth:s}=this.props;let{padding:l}=this.props;l.length<4&&(l=[l[0],l[1],l[0],l[1]]),this.state.model.setUniforms(t).setUniforms({billboard:e,stroked:Boolean(s),padding:l,sizeUnits:a.p5[r],sizeScale:n,sizeMinPixels:i,sizeMaxPixels:o}).draw()}_getModel(t){return new l.A(t,{...this.getShaders(),id:this.props.id,geometry:new u.A({drawMode:6,vertexCount:4,attributes:{positions:{size:2,value:new Float32Array([0,0,1,0,1,1,0,1])}}}),isInstanced:!0})}}(0,r.A)(h,"defaultProps",c),(0,r.A)(h,"layerName","TextBackgroundLayer")},10064:(t,e,n)=>{"use strict";n.d(e,{A:()=>P});var r=n(67136),i=n(68411),o=n(26820),s=n(97870),a=n(93677);const l=1e20;class u{constructor({fontSize:t=24,buffer:e=3,radius:n=8,cutoff:r=.25,fontFamily:i="sans-serif",fontWeight:o="normal",fontStyle:s="normal"}={}){this.buffer=e,this.cutoff=r,this.radius=n;const a=this.size=t+4*e,l=this._createCanvas(a),u=this.ctx=l.getContext("2d",{willReadFrequently:!0});u.font=`${s} ${o} ${t}px ${i}`,u.textBaseline="alphabetic",u.textAlign="left",u.fillStyle="black",this.gridOuter=new Float64Array(a*a),this.gridInner=new Float64Array(a*a),this.f=new Float64Array(a),this.z=new Float64Array(a+1),this.v=new Uint16Array(a)}_createCanvas(t){const e=document.createElement("canvas");return e.width=e.height=t,e}draw(t){const{width:e,actualBoundingBoxAscent:n,actualBoundingBoxDescent:r,actualBoundingBoxLeft:i,actualBoundingBoxRight:o}=this.ctx.measureText(t),s=Math.ceil(n),a=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(o-i))),u=Math.min(this.size-this.buffer,s+Math.ceil(r)),h=a+2*this.buffer,d=u+2*this.buffer,f=Math.max(h*d,0),p=new Uint8ClampedArray(f),g={data:p,width:h,height:d,glyphWidth:a,glyphHeight:u,glyphTop:s,glyphLeft:0,glyphAdvance:e};if(0===a||0===u)return g;const{ctx:y,buffer:m,gridInner:v,gridOuter:b}=this;y.clearRect(m,m,a,u),y.fillText(t,m,m+s);const _=y.getImageData(m,m,a,u);b.fill(l,0,f),v.fill(0,0,f);for(let t=0;t<u;t++)for(let e=0;e<a;e++){const n=_.data[4*(t*a+e)+3]/255;if(0===n)continue;const r=(t+m)*h+e+m;if(1===n)b[r]=0,v[r]=l;else{const t=.5-n;b[r]=t>0?t*t:0,v[r]=t<0?t*t:0}}c(b,0,0,h,d,h,this.f,this.v,this.z),c(v,m,m,a,u,h,this.f,this.v,this.z);for(let t=0;t<f;t++){const e=Math.sqrt(b[t])-Math.sqrt(v[t]);p[t]=Math.round(255-255*(e/this.radius+this.cutoff))}return g}}function c(t,e,n,r,i,o,s,a,l){for(let u=e;u<e+r;u++)h(t,n*o+u,o,i,s,a,l);for(let u=n;u<n+i;u++)h(t,u*o+e,1,r,s,a,l)}function h(t,e,n,r,i,o,s){o[0]=0,s[0]=-l,s[1]=l,i[0]=t[e];for(let a=1,u=0,c=0;a<r;a++){i[a]=t[e+a*n];const r=a*a;do{const t=o[u];c=(i[a]-i[t]+r-t*t)/(a-t)/2}while(c<=s[u]&&--u>-1);u++,o[u]=a,s[u]=c,s[u+1]=l}for(let a=0,l=0;a<r;a++){for(;s[l+1]<a;)l++;const r=o[l],u=a-r;t[e+a*n]=i[r]+u*u}}const d=[];function f(t,e,n,r){let i=0;for(let s=e;s<n;s++){var o;i+=(null===(o=r[t[s]])||void 0===o?void 0:o.layoutWidth)||0}return i}function p(t,e,n,r,i,o){let s=e,a=0;for(let l=e;l<n;l++){const e=f(t,l,l+1,i);a+e>r&&(s<l&&o.push(l),s=l,a=0),a+=e}return a}function g(t,e,n,r,i=0,o){void 0===o&&(o=t.length);const s=[];return"break-all"===e?p(t,i,o,n,r,s):function(t,e,n,r,i,o){let s=e,a=e,l=e,u=0;for(let c=e;c<n;c++)if(" "===t[c]?l=c+1:" "!==t[c+1]&&c+1!==n||(l=c+1),l>a){let e=f(t,a,l,i);u+e>r&&(s<a&&(o.push(a),s=a,u=0),e>r&&(e=p(t,a,l,r,i,o),s=o[o.length-1])),a=l,u+=e}}(t,i,o,n,r,s),s}function y(t,e,n,r,i,s){let a=0,l=0;for(let s=e;s<n;s++){const e=t[s],n=r[e];n?(l||(l=n.layoutHeight),i[s]=a+n.layoutWidth/2,a+=n.layoutWidth):(o.A.warn("Missing character: ".concat(e," (").concat(e.codePointAt(0),")"))(),i[s]=a,a+=32)}s[0]=a,s[1]=l}class m{constructor(t=5){(0,r.A)(this,"limit",void 0),(0,r.A)(this,"_cache",{}),(0,r.A)(this,"_order",[]),this.limit=t}get(t){const e=this._cache[t];return e&&(this._deleteOrder(t),this._appendOrder(t)),e}set(t,e){this._cache[t]?(this.delete(t),this._cache[t]=e,this._appendOrder(t)):(Object.keys(this._cache).length===this.limit&&this.delete(this._order[0]),this._cache[t]=e,this._appendOrder(t))}delete(t){this._cache[t]&&(delete this._cache[t],this._deleteOrder(t))}_deleteOrder(t){const e=this._order.indexOf(t);e>=0&&this._order.splice(e,1)}_appendOrder(t){this._order.push(t)}}const v={fontFamily:"Monaco, monospace",fontWeight:"normal",characterSet:function(){const t=[];for(let e=32;e<128;e++)t.push(String.fromCharCode(e));return t}(),fontSize:64,buffer:4,sdf:!1,cutoff:.25,radius:12,smoothing:.1};let b=new m(3);function _(t,e){for(let n=0;n<t.length;n++)e.data[4*n+3]=t[n]}function A(t,e,n,r){t.font="".concat(r," ").concat(n,"px ").concat(e),t.fillStyle="#000",t.textBaseline="alphabetic",t.textAlign="left"}class x{constructor(){(0,r.A)(this,"props",{...v}),(0,r.A)(this,"_key",void 0),(0,r.A)(this,"_atlas",void 0)}get texture(){return this._atlas}get mapping(){return this._atlas&&this._atlas.mapping}get scale(){const{fontSize:t,buffer:e}=this.props;return(1.2*t+2*e)/t}setProps(t={}){Object.assign(this.props,t),this._key=this._getKey();const e=function(t,e){let n;n="string"==typeof e?new Set(Array.from(e)):new Set(e);const r=b.get(t);if(!r)return n;for(const t in r.mapping)n.has(t)&&n.delete(t);return n}(this._key,this.props.characterSet),n=b.get(this._key);if(n&&0===e.size)return void(this._atlas!==n&&(this._atlas=n));const r=this._generateFontAtlas(e,n);this._atlas=r,b.set(this._key,r)}_generateFontAtlas(t,e){const{fontFamily:n,fontWeight:r,fontSize:i,buffer:o,sdf:s,radius:a,cutoff:l}=this.props;let c=e&&e.data;c||(c=document.createElement("canvas"),c.width=1024);const h=c.getContext("2d",{willReadFrequently:!0});A(h,n,i,r);const{mapping:d,canvasHeight:f,xOffset:p,yOffset:g}=function({characterSet:t,getFontWidth:e,fontHeight:n,buffer:r,maxCanvasWidth:i,mapping:o={},xOffset:s=0,yOffset:a=0}){let l=0,u=s;const c=n+2*r;for(const s of t)if(!o[s]){const t=e(s);u+t+2*r>i&&(u=0,l++),o[s]={x:u+r,y:a+l*c+r,width:t,height:c,layoutWidth:t,layoutHeight:n},u+=t+2*r}return{mapping:o,xOffset:u,yOffset:a+l*c,canvasHeight:(h=a+(l+1)*c,Math.pow(2,Math.ceil(Math.log2(h))))};var h}({getFontWidth:t=>h.measureText(t).width,fontHeight:1.2*i,buffer:o,characterSet:t,maxCanvasWidth:1024,...e&&{mapping:e.mapping,xOffset:e.xOffset,yOffset:e.yOffset}});if(c.height!==f){const t=h.getImageData(0,0,c.width,c.height);c.height=f,h.putImageData(t,0,0)}if(A(h,n,i,r),s){const e=new u({fontSize:i,buffer:o,radius:a,cutoff:l,fontFamily:n,fontWeight:"".concat(r)});for(const n of t){const{data:t,width:r,height:o,glyphTop:s}=e.draw(n);d[n].width=r,d[n].layoutOffsetY=.9*i-s;const a=h.createImageData(r,o);_(t,a),h.putImageData(a,d[n].x,d[n].y)}}else for(const e of t)h.fillText(e,d[e].x,d[e].y+o+.9*i);return{xOffset:p,yOffset:g,mapping:d,data:c,width:c.width,height:c.height}}_getKey(){const{fontFamily:t,fontWeight:e,fontSize:n,buffer:r,sdf:i,radius:o,cutoff:s}=this.props;return i?"".concat(t," ").concat(e," ").concat(n," ").concat(r," ").concat(o," ").concat(s):"".concat(t," ").concat(e," ").concat(n," ").concat(r)}}var w=n(18948);const C={start:1,middle:0,end:-1},S={top:1,center:0,bottom:-1},E=[0,0,0,255],M={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,background:!1,getBackgroundColor:{type:"accessor",value:[255,255,255,255]},getBorderColor:{type:"accessor",value:E},getBorderWidth:{type:"accessor",value:0},backgroundPadding:{type:"array",value:[0,0,0,0]},characterSet:{type:"object",value:v.characterSet},fontFamily:v.fontFamily,fontWeight:v.fontWeight,lineHeight:1,outlineWidth:{type:"number",value:0,min:0},outlineColor:{type:"color",value:E},fontSettings:{type:"object",value:{},compare:1},wordBreak:"break-word",maxWidth:{type:"number",value:-1},getText:{type:"accessor",value:t=>t.text},getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:E},getSize:{type:"accessor",value:32},getAngle:{type:"accessor",value:0},getTextAnchor:{type:"accessor",value:"middle"},getAlignmentBaseline:{type:"accessor",value:"center"},getPixelOffset:{type:"accessor",value:[0,0]},backgroundColor:{deprecatedFor:["background","getBackgroundColor"]}};class P extends i.A{constructor(...t){super(...t),(0,r.A)(this,"state",void 0),(0,r.A)(this,"getBoundingRect",((t,e)=>{let{size:[n,r]}=this.transformParagraph(t,e);const{fontSize:i}=this.state.fontAtlasManager.props;n/=i,r/=i;const{getTextAnchor:o,getAlignmentBaseline:s}=this.props;return[(C["function"==typeof o?o(t,e):o]-1)*n/2,(S["function"==typeof s?s(t,e):s]-1)*r/2,n,r]})),(0,r.A)(this,"getIconOffsets",((t,e)=>{const{getTextAnchor:n,getAlignmentBaseline:r}=this.props,{x:i,y:o,rowWidth:s,size:[a,l]}=this.transformParagraph(t,e),u=C["function"==typeof n?n(t,e):n],c=S["function"==typeof r?r(t,e):r],h=i.length,d=new Array(2*h);let f=0;for(let t=0;t<h;t++){const e=(1-u)*(a-s[t])/2;d[f++]=(u-1)*a/2+e+i[t],d[f++]=(c-1)*l/2+o[t]}return d}))}initializeState(){this.state={styleVersion:0,fontAtlasManager:new x},this.props.maxWidth>0&&o.A.warn("v8.9 breaking change: TextLayer maxWidth is now relative to text size")()}updateState(t){const{props:e,oldProps:n,changeFlags:r}=t;(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getText))&&this._updateText(),(this._updateFontAtlas()||e.lineHeight!==n.lineHeight||e.wordBreak!==n.wordBreak||e.maxWidth!==n.maxWidth)&&this.setState({styleVersion:this.state.styleVersion+1})}getPickingInfo({info:t}){return t.object=t.index>=0?this.props.data[t.index]:null,t}_updateFontAtlas(){const{fontSettings:t,fontFamily:e,fontWeight:n}=this.props,{fontAtlasManager:r,characterSet:i}=this.state,o={...t,characterSet:i,fontFamily:e,fontWeight:n};if(!r.mapping)return r.setProps(o),!0;for(const t in o)if(o[t]!==r.props[t])return r.setProps(o),!0;return!1}_updateText(){var t;const{data:e,characterSet:n}=this.props,r=null===(t=e.attributes)||void 0===t?void 0:t.getText;let i,{getText:o}=this.props,a=e.startIndices;const l="auto"===n&&new Set;if(r&&a){const{texts:t,characterCount:n}=function({value:t,length:e,stride:n,offset:r,startIndices:i,characterSet:o}){const s=t.BYTES_PER_ELEMENT,a=n?n/s:1,l=r?r/s:0,u=i[e]||Math.ceil((t.length-l)/a),c=o&&new Set,h=new Array(e);let d=t;if(a>1||l>0){d=new(0,t.constructor)(u);for(let e=0;e<u;e++)d[e]=t[e*a+l]}for(let t=0;t<e;t++){const e=i[t],n=i[t+1]||u,r=d.subarray(e,n);h[t]=String.fromCodePoint.apply(null,r),c&&r.forEach(c.add,c)}if(c)for(const t of c)o.add(String.fromCodePoint(t));return{texts:h,characterCount:u}}({...ArrayBuffer.isView(r)?{value:r}:r,length:e.length,startIndices:a,characterSet:l});i=n,o=(e,{index:n})=>t[n]}else{const{iterable:t,objectInfo:n}=(0,s.X)(e);a=[0],i=0;for(const e of t){n.index++;const t=Array.from(o(e,n)||"");l&&t.forEach(l.add,l),i+=t.length,a.push(i)}}this.setState({getText:o,startIndices:a,numInstances:i,characterSet:l||n})}transformParagraph(t,e){const{fontAtlasManager:n}=this.state,r=n.mapping,i=this.state.getText,{wordBreak:o,lineHeight:s,maxWidth:a}=this.props;return function(t,e,n,r,i){const o=Array.from(t),s=o.length,a=new Array(s),l=new Array(s),u=new Array(s),c=("break-word"===n||"break-all"===n)&&isFinite(r)&&r>0,h=[0,0],f=[0,0];let p=0,m=0,v=0;for(let t=0;t<=s;t++){const _=o[t];if("\n"!==_&&t!==s||(v=t),v>m){const t=c?g(o,n,r,i,m,v):d;for(let n=0;n<=t.length;n++){const r=0===n?m:t[n-1],s=n<t.length?t[n]:v;y(o,r,s,i,a,f);for(let t=r;t<s;t++){var b;const e=(null===(b=i[o[t]])||void 0===b?void 0:b.layoutOffsetY)||0;l[t]=p+f[1]/2+e,u[t]=f[0]}p+=f[1]*e,h[0]=Math.max(h[0],f[0])}m=v}"\n"===_&&(a[m]=0,l[m]=0,u[m]=0,m++)}return h[1]=p,{x:a,y:l,rowWidth:u,size:h}}(i(t,e)||"",s,o,a*n.props.fontSize,r)}renderLayers(){const{startIndices:t,numInstances:e,getText:n,fontAtlasManager:{scale:r,texture:i,mapping:o},styleVersion:s}=this.state,{data:l,_dataDiff:u,getPosition:c,getColor:h,getSize:d,getAngle:f,getPixelOffset:p,getBackgroundColor:g,getBorderColor:y,getBorderWidth:m,backgroundPadding:b,background:_,billboard:A,fontSettings:x,outlineWidth:C,outlineColor:S,sizeScale:E,sizeUnits:M,sizeMinPixels:P,sizeMaxPixels:T,transitions:O,updateTriggers:I}=this.props,R=this.getSubLayerClass("characters",a.A),B=this.getSubLayerClass("background",w.A);return[_&&new B({getFillColor:g,getLineColor:y,getLineWidth:m,padding:b,getPosition:c,getSize:d,getAngle:f,getPixelOffset:p,billboard:A,sizeScale:E,sizeUnits:M,sizeMinPixels:P,sizeMaxPixels:T,transitions:O&&{getPosition:O.getPosition,getAngle:O.getAngle,getSize:O.getSize,getFillColor:O.getBackgroundColor,getLineColor:O.getBorderColor,getLineWidth:O.getBorderWidth,getPixelOffset:O.getPixelOffset}},this.getSubLayerProps({id:"background",updateTriggers:{getPosition:I.getPosition,getAngle:I.getAngle,getSize:I.getSize,getFillColor:I.getBackgroundColor,getLineColor:I.getBorderColor,getLineWidth:I.getBorderWidth,getPixelOffset:I.getPixelOffset,getBoundingRect:{getText:I.getText,getTextAnchor:I.getTextAnchor,getAlignmentBaseline:I.getAlignmentBaseline,styleVersion:s}}}),{data:l.attributes&&l.attributes.background?{length:l.length,attributes:l.attributes.background}:l,_dataDiff:u,autoHighlight:!1,getBoundingRect:this.getBoundingRect}),new R({sdf:x.sdf,smoothing:Number.isFinite(x.smoothing)?x.smoothing:v.smoothing,outlineWidth:C/(x.radius||v.radius),outlineColor:S,iconAtlas:i,iconMapping:o,getPosition:c,getColor:h,getSize:d,getAngle:f,getPixelOffset:p,billboard:A,sizeScale:E*r,sizeUnits:M,sizeMinPixels:P*r,sizeMaxPixels:T*r,transitions:O&&{getPosition:O.getPosition,getAngle:O.getAngle,getColor:O.getColor,getSize:O.getSize,getPixelOffset:O.getPixelOffset}},this.getSubLayerProps({id:"characters",updateTriggers:{all:I.getText,getPosition:I.getPosition,getAngle:I.getAngle,getColor:I.getColor,getSize:I.getSize,getPixelOffset:I.getPixelOffset,getIconOffsets:{getTextAnchor:I.getTextAnchor,getAlignmentBaseline:I.getAlignmentBaseline,styleVersion:s}}}),{data:l,_dataDiff:u,startIndices:t,numInstances:e,getIconOffsets:this.getIconOffsets,getIcon:n})]}static set fontAtlasCacheLimit(t){!function(t){o.A.assert(Number.isFinite(t)&&t>=3,"Invalid cache limit"),b=new m(t)}(t)}}(0,r.A)(P,"defaultProps",M),(0,r.A)(P,"layerName","TextLayer")},53986:(t,e,n)=>{"use strict";function r({data:t,getIndex:e,dataRange:n,replace:r}){const{startRow:i=0,endRow:o=1/0}=n,s=t.length;let a=s,l=s;for(let n=0;n<s;n++){const r=e(t[n]);if(a>n&&r>=i&&(a=n),r>=o){l=n;break}}let u=a;const c=l-a!==r.length?t.slice(l):void 0;for(let e=0;e<r.length;e++)t[u++]=r[e];if(c){for(let e=0;e<c.length;e++)t[u++]=c[e];t.length=u}return{startRow:a,endRow:a+r.length}}n.d(e,{J:()=>r})},57231:(t,e,n)=>{"use strict";n.r(e),n.d(e,{ScenegraphLayer:()=>i.A,SimpleMeshLayer:()=>r.A});var r=n(4437),i=n(26578)},26578:(t,e,n)=>{"use strict";n.d(e,{A:()=>F});var r=n(67136),i=n(36179),o=n(79464),s=n(70560),a=n(26820),l=n(8282),u=n(64506),c=n(22466),h=n(98569),d=n(33185),f=n(55992);class p{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{id:e}=t;this.id=e||(0,d.Ld)(this.constructor.name),this.display=!0,this.position=new c.A,this.rotation=new c.A,this.scale=new c.A(1,1,1),this.matrix=new h.A,this.userData={},this.props={},this._setScenegraphNodeProps(t)}delete(){}setProps(t){return this._setScenegraphNodeProps(t),this}toString(){return"{type: ScenegraphNode, id: ".concat(this.id,")}")}getBounds(){return null}setPosition(t){return(0,f.v)(3===t.length,"setPosition requires vector argument"),this.position=t,this}setRotation(t){return(0,f.v)(3===t.length,"setRotation requires vector argument"),this.rotation=t,this}setScale(t){return(0,f.v)(3===t.length,"setScale requires vector argument"),this.scale=t,this}setMatrix(t){arguments.length>1&&void 0!==arguments[1]&&!arguments[1]?this.matrix=t:this.matrix.copy(t)}setMatrixComponents(t){let{position:e,rotation:n,scale:r,update:i=!0}=t;return e&&this.setPosition(e),n&&this.setRotation(n),r&&this.setScale(r),i&&this.updateMatrix(),this}updateMatrix(){const t=this.position,e=this.rotation,n=this.scale;return this.matrix.identity(),this.matrix.translate(t),this.matrix.rotateXYZ(e),this.matrix.scale(n),this}update(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{position:e,rotation:n,scale:r}=t;return e&&this.setPosition(e),n&&this.setRotation(n),r&&this.setScale(r),this.updateMatrix(),this}getCoordinateUniforms(t,e){(0,f.v)(t),e=e||this.matrix;const n=new h.A(t).multiplyRight(e),r=n.invert(),i=r.transpose();return{viewMatrix:t,modelMatrix:e,objectMatrix:e,worldMatrix:n,worldInverseMatrix:r,worldInverseTransposeMatrix:i}}_setScenegraphNodeProps(t){"display"in t&&(this.display=t.display),"position"in t&&this.setPosition(t.position),"rotation"in t&&this.setRotation(t.rotation),"scale"in t&&this.setScale(t.scale),"matrix"in t&&this.setMatrix(t.matrix),Object.assign(this.props,t)}}var g=n(62671),y=n(72590);class m extends p{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t=Array.isArray(t)?{children:t}:t;const{children:e=[]}=t;l.Rm.assert(e.every((t=>t instanceof p)),"every child must an instance of ScenegraphNode"),super(t),this.children=e}add(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(const t of e)Array.isArray(t)?this.add(...t):this.children.push(t);return this}remove(t){const e=this.children,n=e.indexOf(t);return n>-1&&e.splice(n,1),this}removeAll(){return this.children=[],this}delete(){this.children.forEach((t=>t.delete())),this.removeAll(),super.delete()}getBounds(){const t=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]];return this.traverse(((e,n)=>{let{worldMatrix:r}=n;const i=e.getBounds();if(!i)return;const[o,s]=i,a=new c.A(o).add(s).divide([2,2,2]);r.transformAsPoint(a,a);const l=new c.A(s).subtract(o).divide([2,2,2]);r.transformAsVector(l,l);for(let e=0;e<8;e++){const n=new c.A(1&e?-1:1,2&e?-1:1,4&e?-1:1).multiply(l).add(a);for(let e=0;e<3;e++)t[0][e]=Math.min(t[0][e],n[e]),t[1][e]=Math.max(t[1][e],n[e])}})),Number.isFinite(t[0][0])?t:null}traverse(t){let{worldMatrix:e=new h.A}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=new h.A(e).multiplyRight(this.matrix);for(const e of this.children)e instanceof m?e.traverse(t,{worldMatrix:n}):t(e,{worldMatrix:n})}}var v=n(5521);const b={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},_={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function A(t){if(!t._animation){const e=_[t.componentType],n=b[t.type],r=n*t.count,{buffer:i,byteOffset:o}=t.bufferView.data,s=new e(i,o+(t.byteOffset||0),r);if(1===n)t._animation=Array.from(s);else{const e=[];for(let t=0;t<s.length;t+=n)e.push(Array.from(s.slice(t,t+n)));t._animation=e}}return t._animation}const x=new h.A,w=new v.A;class C{constructor(t){this.startTime=0,this.playing=!0,this.speed=1,this.channels=[],Object.assign(this,t)}animate(t){if(!this.playing)return;const e=(t/1e3-this.startTime)*this.speed;this.channels.forEach((t=>{let{sampler:n,target:r,path:i}=t;(function(t,e,n,r){let{input:i,interpolation:o,output:s}=e;const a=t%i[i.length-1],u=i.findIndex((t=>t>=a)),c=Math.max(0,u-1);if(!Array.isArray(n[r]))switch(r){case"translation":n[r]=[0,0,0];break;case"rotation":n[r]=[0,0,0,1];break;case"scale":n[r]=[1,1,1];break;default:l.Rm.warn("Bad animation path ".concat(r))()}(0,f.v)(n[r].length===s[c].length);const h=i[c],d=i[u];switch(o){case"STEP":!function(t,e,n){for(let r=0;r<n.length;r++)t[e][r]=n[r]}(n,r,s[c]);break;case"LINEAR":if(d>h){const t=(a-h)/(d-h);!function(t,e,n,r,i){if("rotation"===e){w.slerp({start:n,target:r,ratio:i});for(let n=0;n<w.length;n++)t[e][n]=w[n]}else for(let o=0;o<n.length;o++)t[e][o]=i*r[o]+(1-i)*n[o]}(n,r,s[c],s[u],t)}break;case"CUBICSPLINE":if(d>h){const t=(a-h)/(d-h),e=d-h;!function(t,e,n){let{p0:r,outTangent0:i,inTangent1:o,p1:s,tDiff:a,ratio:l}=n;for(let n=0;n<t[e].length;n++){const u=i[n]*a,c=o[n]*a;t[e][n]=(2*Math.pow(l,3)-3*Math.pow(l,2)+1)*r[n]+(Math.pow(l,3)-2*Math.pow(l,2)+l)*u+(-2*Math.pow(l,3)+3*Math.pow(l,2))*s[n]+(Math.pow(l,3)-Math.pow(l,2))*c}}(n,r,{p0:s[3*c+1],outTangent0:s[3*c+2],inTangent1:s[3*u+0],p1:s[3*u+1],tDiff:e,ratio:t})}break;default:l.Rm.warn("Interpolation ".concat(o," not supported"))()}})(e,n,r,i),function(t,e){if(e.matrix.identity(),t.translation&&e.matrix.translate(t.translation),t.rotation){const n=x.fromQuaternion(t.rotation);e.matrix.multiplyRight(n)}t.scale&&e.matrix.scale(t.scale)}(r,r._node)}))}}class S{constructor(t){this.animations=t.animations.map(((e,n)=>{const r=e.name||"Animation-".concat(n),i=e.samplers.map((e=>{let{input:n,interpolation:r="LINEAR",output:i}=e;return{input:A(t.accessors[n]),interpolation:r,output:A(t.accessors[i])}})),o=e.channels.map((e=>{let{sampler:n,target:r}=e;return{sampler:i[n],target:t.nodes[r.node],path:r.path}}));return new C({name:r,channels:o})}))}animate(t){this.setTime(t)}setTime(t){this.animations.forEach((e=>e.animate(t)))}getAnimations(){return this.animations}}var E=n(76694);class M extends p{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e),this.onBeforeRender=null,this.AfterRender=null,t instanceof E.A?(this.model=t,this._setModelNodeProps(e)):this.model=new E.A(t,e),this.bounds=null,this.managedResources=e.managedResources||[]}setProps(t){return super.setProps(t),this._setModelNodeProps(t),this}getBounds(){return this.bounds}delete(){this.model&&(this.model.delete(),this.model=null),this.managedResources.forEach((t=>t.delete())),this.managedResources=[]}draw(){return this.model.draw(...arguments)}setUniforms(){return this.model.setUniforms(...arguments),this}setAttributes(){return this.model.setAttributes(...arguments),this}updateModuleSettings(){return this.model.updateModuleSettings(...arguments),this}_setModelNodeProps(t){this.model.setProps(t)}}var P=n(36830);function T(t,e){return(0,l.C6)(t)?"#version 300 es\n".concat(e):e}const O={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},I={modelOptions:{},pbrDebug:!1,imageBasedLightingEnvironment:null,lights:!0,useTangents:!1};class R{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.gl=t,this.options=Object.assign({},I,e)}instantiate(t){return this.gltf=t,(t.scenes||[]).map((t=>this.createScene(t)))}createAnimator(){return Array.isArray(this.gltf.animations)?new S(this.gltf):null}createScene(t){const e=(t.nodes||[]).map((t=>this.createNode(t)));return new m({id:t.name||t.id,children:e})}createNode(t){if(!t._node){const e=(t.children||[]).map((t=>this.createNode(t)));t.mesh&&e.push(this.createMesh(t.mesh));const n=new m({id:t.name||t.id,children:e});if(t.matrix)n.setMatrix(t.matrix);else{if(n.matrix.identity(),t.translation&&n.matrix.translate(t.translation),t.rotation){const e=(new h.A).fromQuaternion(t.rotation);n.matrix.multiplyRight(e)}t.scale&&n.matrix.scale(t.scale)}t._node=n}return t._node}createMesh(t){if(!t._mesh){const e=(t.primitives||[]).map(((e,n)=>this.createPrimitive(e,n,t))),n=new m({id:t.name||t.id,children:e});t._mesh=n}return t._mesh}getVertexCount(t){l.Rm.warn("getVertexCount() not found")()}createPrimitive(t,e,n){const r=function(t,e){const{id:n,drawMode:r,vertexCount:i,attributes:o,modelOptions:s}=e,a=new P.A(t,e);l.Rm.info(4,"createGLTFModel defines: ",a.defines)();const c=[];c.push(...a.generatedTextures),c.push(...Object.values(o).map((t=>t.buffer)));const h=new M(t,{id:n,drawMode:r,vertexCount:i,modules:[u.R],parameters:a.parameters,vs:T(t,"\n#if (__VERSION__ < 300)\n  #define _attr attribute\n#else\n  #define _attr in\n#endif\n\n  _attr vec4 POSITION;\n\n  #ifdef HAS_NORMALS\n    _attr vec4 NORMAL;\n  #endif\n\n  #ifdef HAS_TANGENTS\n    _attr vec4 TANGENT;\n  #endif\n\n  #ifdef HAS_UV\n    _attr vec2 TEXCOORD_0;\n  #endif\n\n  void main(void) {\n    vec4 _NORMAL = vec4(0.);\n    vec4 _TANGENT = vec4(0.);\n    vec2 _TEXCOORD_0 = vec2(0.);\n\n    #ifdef HAS_NORMALS\n      _NORMAL = NORMAL;\n    #endif\n\n    #ifdef HAS_TANGENTS\n      _TANGENT = TANGENT;\n    #endif\n\n    #ifdef HAS_UV\n      _TEXCOORD_0 = TEXCOORD_0;\n    #endif\n\n    pbr_setPositionNormalTangentUV(POSITION, _NORMAL, _TANGENT, _TEXCOORD_0);\n    gl_Position = u_MVPMatrix * POSITION;\n  }\n"),fs:T(t,"\n#if (__VERSION__ < 300)\n  #define fragmentColor gl_FragColor\n#else\n  out vec4 fragmentColor;\n#endif\n\n  void main(void) {\n    fragmentColor = pbr_filterColor(vec4(0));\n  }\n"),managedResources:c,...s,defines:{...a.defines,...s.defines}});return h.setProps({attributes:o}),h.setUniforms(a.uniforms),h}(this.gl,Object.assign({id:t.name||"".concat(n.name||n.id,"-primitive-").concat(e),drawMode:t.mode||4,vertexCount:t.indices?t.indices.count:this.getVertexCount(t.attributes),attributes:this.createAttributes(t.attributes,t.indices),material:t.material},this.options));return r.bounds=[t.attributes.POSITION.min,t.attributes.POSITION.max],r}createAttributes(t,e){const n={};return Object.keys(t).forEach((e=>{n[e]=this.createAccessor(t[e],this.createBuffer(t[e],this.gl.ARRAY_BUFFER))})),e&&(n.indices=this.createAccessor(e,this.createBuffer(e,this.gl.ELEMENT_ARRAY_BUFFER))),l.Rm.info(4,"glTF Attributes",{attributes:t,indices:e,generated:n})(),n}createBuffer(t,e){t.bufferView||(t.bufferView={});const{bufferView:n}=t;return n.lumaBuffers||(n.lumaBuffers={}),n.lumaBuffers[e]||(n.lumaBuffers[e]=new g.A(this.gl,{id:"from-".concat(n.id),data:n.data||t.value,target:e})),n.lumaBuffers[e]}createAccessor(t,e){return new y.A({buffer:e,offset:t.byteOffset||0,stride:t.bufferView.byteStride||0,type:t.componentType,size:O[t.type]})}createSampler(t){return t}needsPOT(){return!1}}var B=n(65771);var L=n(12116);const k=[255,255,255,255],D={scenegraph:{type:"object",value:null,async:!0},getScene:t=>t&&t.scenes?"object"==typeof t.scene?t.scene:t.scenes[t.scene||0]:t,getAnimator:t=>t&&t.animator,_animations:null,sizeScale:{type:"number",value:1,min:0},sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:k},_lighting:"flat",_imageBasedLightingEnvironment:null,getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]},loaders:[B.B]};class F extends i.A{constructor(...t){super(...t),(0,r.A)(this,"state",void 0)}getShaders(){const t=[o.A,s.A];return"pbr"===this.props._lighting&&t.push(u.R),super.getShaders({vs:"#version 300 es\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nin mat3 instanceModelMatrix;\nin vec3 instanceTranslation;\nuniform float sizeScale;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform mat4 sceneModelMatrix;\nuniform bool composeModelMatrix;\nin vec4 POSITION;\n\n#ifdef HAS_UV\n  in vec2 TEXCOORD_0;\n#endif\n\n#ifdef MODULE_PBR\n  #ifdef HAS_NORMALS\n    in vec4 NORMAL;\n  #endif\n#endif\nout vec4 vColor;\n#ifndef MODULE_PBR\n  #ifdef HAS_UV\n    out vec2 vTEXCOORD_0;\n  #endif\n#endif\nvoid main(void) {\n  #if defined(HAS_UV) && !defined(MODULE_PBR)\n    vTEXCOORD_0 = TEXCOORD_0;\n    geometry.uv = vTEXCOORD_0;\n  #endif\n\n  geometry.worldPosition = instancePositions;\n  geometry.pickingColor = instancePickingColors;\n\n  vec3 normal = vec3(0.0, 0.0, 1.0);\n  #ifdef MODULE_PBR\n    #ifdef HAS_NORMALS\n      normal = instanceModelMatrix * (sceneModelMatrix * vec4(NORMAL.xyz, 0.0)).xyz;\n    #endif\n  #endif\n\n  float originalSize = project_size_to_pixel(sizeScale);\n  float clampedSize = clamp(originalSize, sizeMinPixels, sizeMaxPixels);\n\n  vec3 pos = (instanceModelMatrix * (sceneModelMatrix * POSITION).xyz) * sizeScale * (clampedSize / originalSize) + instanceTranslation;\n  if(composeModelMatrix) {\n    DECKGL_FILTER_SIZE(pos, geometry);\n    geometry.normal = project_normal(normal);\n    geometry.worldPosition += pos;\n    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n  }\n  else {\n    pos = project_size(pos);\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, geometry.position);\n    geometry.normal = project_normal(normal);\n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  #ifdef MODULE_PBR\n    pbr_vPosition = geometry.position.xyz;\n    #ifdef HAS_NORMALS\n      pbr_vNormal = geometry.normal;\n    #endif\n\n    #ifdef HAS_UV\n      pbr_vUV = TEXCOORD_0;\n    #else\n      pbr_vUV = vec2(0., 0.);\n    #endif\n    geometry.uv = pbr_vUV;\n  #endif\n\n  vColor = instanceColors;\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#version 300 es\nuniform float opacity;\nin vec4 vColor;\n\nout vec4 fragmentColor;\n#ifndef MODULE_PBR\n  #if defined(HAS_UV) && defined(HAS_BASECOLORMAP)\n    in vec2 vTEXCOORD_0;\n    uniform sampler2D u_BaseColorSampler;\n  #endif\n#endif\n\nvoid main(void) {\n  #ifdef MODULE_PBR\n    fragmentColor = vColor * pbr_filterColor(vec4(0));\n    geometry.uv = pbr_vUV;\n  #else\n    #if defined(HAS_UV) && defined(HAS_BASECOLORMAP)\n      fragmentColor = vColor * texture2D(u_BaseColorSampler, vTEXCOORD_0);\n      geometry.uv = vTEXCOORD_0;\n    #else\n      fragmentColor = vColor;\n    #endif\n  #endif\n\n  fragmentColor.a *= opacity;\n  DECKGL_FILTER_COLOR(fragmentColor, geometry);\n}\n",modules:t})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),accessor:"getPosition",transition:!0},instanceColors:{type:5121,size:this.props.colorFormat.length,accessor:"getColor",normalized:!0,defaultValue:k,transition:!0},instanceModelMatrix:L.U})}updateState(t){super.updateState(t);const{props:e,oldProps:n}=t;e.scenegraph!==n.scenegraph?this._updateScenegraph():e._animations!==n._animations&&this._applyAnimationsProp(this.state.scenegraph,this.state.animator,e._animations)}finalizeState(t){super.finalizeState(t),this._deleteScenegraph()}get isLoaded(){var t;return(null===(t=this.state)||void 0===t?void 0:t.scenegraph)&&super.isLoaded}_updateScenegraph(){const t=this.props,{gl:e}=this.context;let n=null;if(t.scenegraph instanceof p)n={scenes:[t.scenegraph]};else if(t.scenegraph&&!t.scenegraph.gltf){const r=t.scenegraph,i=function(t,e,n){const r=new R(t,n);return{scenes:r.instantiate(e),animator:r.createAnimator()}}(e,r,this._getModelOptions());n={gltf:r,...i},async function(t){const e=[];return t.scenes.forEach((t=>{t.traverse((t=>{Object.values(t.model.getUniforms()).forEach((t=>{!1===t.loaded&&e.push(t)}))}))})),await async function(){for(;e.some((t=>!t.loaded));)await new Promise((t=>requestAnimationFrame(t)))}()}(i).then((()=>this.setNeedsRedraw()))}else t.scenegraph&&(a.A.deprecated("ScenegraphLayer.props.scenegraph","Use GLTFLoader instead of GLTFScenegraphLoader")(),n=t.scenegraph);const r={layer:this,gl:e},i=t.getScene(n,r),o=t.getAnimator(n,r);i instanceof p?(this._deleteScenegraph(),this._applyAllAttributes(i),this._applyAnimationsProp(i,o,t._animations),this.setState({scenegraph:i,animator:o})):null!==i&&a.A.warn("invalid scenegraph:",i)()}_applyAllAttributes(t){if(this.state.attributesAvailable){const e=this.getAttributeManager().getAttributes();t.traverse((t=>{this._setModelAttributes(t.model,e)}))}}_applyAnimationsProp(t,e,n){if(!t||!e||!n)return;const r=e.getAnimations();Object.keys(n).sort().forEach((t=>{const e=n[t];if("*"===t)r.forEach((t=>{Object.assign(t,e)}));else if(Number.isFinite(Number(t))){const n=Number(t);n>=0&&n<r.length?Object.assign(r[n],e):a.A.warn("animation ".concat(t," not found"))()}else{const n=r.find((({name:e})=>e===t));n?Object.assign(n,e):a.A.warn("animation ".concat(t," not found"))()}}))}_deleteScenegraph(){const{scenegraph:t}=this.state;t instanceof p&&t.delete()}_getModelOptions(){const{_imageBasedLightingEnvironment:t}=this.props;let e=null;return t&&(e="function"==typeof t?t({gl:this.context.gl,layer:this}):t),{gl:this.context.gl,waitForFullLoad:!0,imageBasedLightingEnvironment:e,modelOptions:{isInstanced:!0,transpileToGLSL100:!(0,l.C6)(this.context.gl),...this.getShaders()},useTangents:!1}}updateAttributes(t){this.setState({attributesAvailable:!0}),this.state.scenegraph&&this.state.scenegraph.traverse((e=>{this._setModelAttributes(e.model,t)}))}draw({moduleParameters:t=null,parameters:e={},context:n}){if(!this.state.scenegraph)return;this.props._animations&&this.state.animator&&(this.state.animator.animate(n.timeline.getTime()),this.setNeedsRedraw());const{viewport:r}=this.context,{sizeScale:i,sizeMinPixels:o,sizeMaxPixels:s,opacity:a,coordinateSystem:l}=this.props,u=this.getNumInstances();this.state.scenegraph.traverse(((n,{worldMatrix:c})=>{n.model.setInstanceCount(u),n.updateModuleSettings(t),n.draw({parameters:e,uniforms:{sizeScale:i,opacity:a,sizeMinPixels:o,sizeMaxPixels:s,composeModelMatrix:(0,L.w)(r,l),sceneModelMatrix:c,u_Camera:n.model.getUniforms().project_uCameraPosition}})}))}}(0,r.A)(F,"defaultProps",D),(0,r.A)(F,"layerName","ScenegraphLayer")},4437:(t,e,n)=>{"use strict";n.d(e,{A:()=>v});var r=n(67136),i=n(26820),o=n(36179),s=n(79464),a=n(44123),l=n(70560),u=n(82170),c=n(8282),h=n(26107),d=n(76694),f=n(77325),p=n(38404),g=n(12116);function y(t,e){(t.COLOR_0||t.colors)&&e||(t.colors={constant:!0,value:new Float32Array([1,1,1])}),i.A.assert(t.positions||t.POSITION,'no "postions" or "POSITION" attribute in mesh')}function m(t,e){if(t.attributes)return y(t.attributes,e),t instanceof u.A?t:new u.A(t);if(t.positions||t.POSITION)return y(t,e),new u.A({attributes:t});throw Error("Invalid mesh")}class v extends o.A{constructor(...t){super(...t),(0,r.A)(this,"state",void 0)}getShaders(){const t=!(0,c.C6)(this.context.gl),e={};return(0,f.jI)(this.context.gl,p.G.GLSL_DERIVATIVES)&&(e.DERIVATIVES_AVAILABLE=1),super.getShaders({vs:"#version 300 es\n#define SHADER_NAME simple-mesh-layer-vs\nuniform float sizeScale;\nuniform bool composeModelMatrix;\nin vec3 positions;\nin vec3 normals;\nin vec3 colors;\nin vec2 texCoords;\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nin mat3 instanceModelMatrix;\nin vec3 instanceTranslation;\nout vec2 vTexCoord;\nout vec3 cameraPosition;\nout vec3 normals_commonspace;\nout vec4 position_commonspace;\nout vec4 vColor;\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = texCoords;\n  geometry.pickingColor = instancePickingColors;\n\n  vTexCoord = texCoords;\n  cameraPosition = project_uCameraPosition;\n  vColor = vec4(colors * instanceColors.rgb, instanceColors.a);\n\n  vec3 pos = (instanceModelMatrix * positions) * sizeScale + instanceTranslation;\n\n  if (composeModelMatrix) {\n    DECKGL_FILTER_SIZE(pos, geometry);\n    normals_commonspace = project_normal(instanceModelMatrix * normals);\n    geometry.worldPosition += pos;\n    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), position_commonspace);\n    geometry.position = position_commonspace;\n  }\n  else {\n    pos = project_size(pos);\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, position_commonspace);\n    geometry.position = position_commonspace;\n    normals_commonspace = project_normal(instanceModelMatrix * normals);\n  }\n\n  geometry.normal = normals_commonspace;\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#version 300 es\n#define SHADER_NAME simple-mesh-layer-fs\n\nprecision highp float;\n\nuniform bool hasTexture;\nuniform sampler2D sampler;\nuniform bool flatShading;\nuniform float opacity;\n\nin vec2 vTexCoord;\nin vec3 cameraPosition;\nin vec3 normals_commonspace;\nin vec4 position_commonspace;\nin vec4 vColor;\n\nout vec4 fragColor;\n\nvoid main(void) {\n  geometry.uv = vTexCoord;\n\n  vec3 normal;\n  if (flatShading) {\n#ifdef DERIVATIVES_AVAILABLE\n    normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));\n#else\n    normal = vec3(0.0, 0.0, 1.0);\n#endif\n  } else {\n    normal = normals_commonspace;\n  }\n\n  vec4 color = hasTexture ? texture(sampler, vTexCoord) : vColor;\n  DECKGL_FILTER_COLOR(color, geometry);\n\n  vec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);\n  fragColor = vec4(lightColor, color.a * opacity);\n}\n",modules:[s.A,a.p,l.A],transpileToGLSL100:t,defines:e})}getBounds(){var t;if(this.props._instanced)return super.getBounds();let e=this.state.positionBounds;if(e)return e;const{mesh:n}=this.props;if(!n)return null;if(e=null===(t=n.header)||void 0===t?void 0:t.boundingBox,!e){const{attributes:t}=m(n,this.props._useMeshColors);t.POSITION=t.POSITION||t.positions,e=function(t){let e=1/0,n=1/0,r=1/0,i=-1/0,o=-1/0,s=-1/0;const a=t.POSITION?t.POSITION.value:[],l=a&&a.length;for(let t=0;t<l;t+=3){const l=a[t],u=a[t+1],c=a[t+2];e=l<e?l:e,n=u<n?u:n,r=c<r?c:r,i=l>i?l:i,o=u>o?u:o,s=c>s?c:s}return[[e,n,r],[i,o,s]]}(t)}return this.state.positionBounds=e,e}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{transition:!0,type:5130,fp64:this.use64bitPositions(),size:3,accessor:"getPosition"},instanceColors:{type:5121,transition:!0,size:this.props.colorFormat.length,normalized:!0,accessor:"getColor",defaultValue:[0,0,0,255]},instanceModelMatrix:g.U}),this.setState({emptyTexture:new h.A(this.context.gl,{data:new Uint8Array(4),width:1,height:1})})}updateState(t){super.updateState(t);const{props:e,oldProps:n,changeFlags:r}=t;if(e.mesh!==n.mesh||r.extensionsChanged){var i;if(this.state.positionBounds=null,null===(i=this.state.model)||void 0===i||i.delete(),e.mesh){this.state.model=this.getModel(e.mesh);const t=e.mesh.attributes||e.mesh;this.setState({hasNormals:Boolean(t.NORMAL||t.normals)})}this.getAttributeManager().invalidateAll()}e.texture!==n.texture&&this.setTexture(e.texture),this.state.model&&this.state.model.setDrawMode(this.props.wireframe?3:4)}finalizeState(t){super.finalizeState(t),this.state.emptyTexture.delete()}draw({uniforms:t}){if(!this.state.model)return;const{viewport:e}=this.context,{sizeScale:n,coordinateSystem:r,_instanced:i}=this.props;this.state.model.setUniforms(t).setUniforms({sizeScale:n,composeModelMatrix:!i||(0,g.w)(e,r),flatShading:!this.state.hasNormals}).draw()}get isLoaded(){var t;return(null===(t=this.state)||void 0===t?void 0:t.model)&&super.isLoaded}getModel(t){const e=new d.A(this.context.gl,{...this.getShaders(),id:this.props.id,geometry:m(t,this.props._useMeshColors),isInstanced:!0}),{texture:n}=this.props,{emptyTexture:r}=this.state;return e.setUniforms({sampler:n||r,hasTexture:Boolean(n)}),e}setTexture(t){const{emptyTexture:e,model:n}=this.state;n&&n.setUniforms({sampler:t||e,hasTexture:Boolean(t)})}}(0,r.A)(v,"defaultProps",{mesh:{type:"object",value:null,async:!0},texture:{type:"image",value:null,async:!0},sizeScale:{type:"number",value:1,min:0},_useMeshColors:{type:"boolean",value:!1},_instanced:!0,wireframe:!1,material:!0,getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:[0,0,0,255]},getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]},textureParameters:{type:"object",ignore:!0}}),(0,r.A)(v,"layerName","SimpleMeshLayer")},12116:(t,e,n)=>{"use strict";n.d(e,{U:()=>c,w:()=>h});var r=n(97870),i=n(1597);const o=Math.PI/180,s=new Float32Array(16),a=new Float32Array(12);function l(t,e,n){const r=e[0]*o,i=e[1]*o,s=e[2]*o,a=Math.sin(s),l=Math.sin(r),u=Math.sin(i),c=Math.cos(s),h=Math.cos(r),d=Math.cos(i),f=n[0],p=n[1],g=n[2];t[0]=f*d*h,t[1]=f*u*h,t[2]=f*-l,t[3]=p*(-u*c+d*l*a),t[4]=p*(d*c+u*l*a),t[5]=p*h*a,t[6]=g*(u*a+d*l*c),t[7]=g*(-d*a+u*l*c),t[8]=g*h*c}function u(t){return t[0]=t[0],t[1]=t[1],t[2]=t[2],t[3]=t[4],t[4]=t[5],t[5]=t[6],t[6]=t[8],t[7]=t[9],t[8]=t[10],t[9]=t[12],t[10]=t[13],t[11]=t[14],t.subarray(0,12)}const c={size:12,accessor:["getOrientation","getScale","getTranslation","getTransformMatrix"],shaderAttributes:{instanceModelMatrix__LOCATION_0:{size:3,elementOffset:0},instanceModelMatrix__LOCATION_1:{size:3,elementOffset:3},instanceModelMatrix__LOCATION_2:{size:3,elementOffset:6},instanceTranslation:{size:3,elementOffset:9}},update(t,{startRow:e,endRow:n}){const{data:i,getOrientation:o,getScale:c,getTranslation:h,getTransformMatrix:d}=this.props,f=Array.isArray(d),p=f&&16===d.length,g=Array.isArray(c),y=Array.isArray(o),m=Array.isArray(h),v=p||!f&&Boolean(d(i[0]));t.constant=v?p:y&&g&&m;const b=t.value;if(t.constant){let e;v?(s.set(d),e=u(s)):(e=a,l(e,o,c),e.set(h,9)),t.value=new Float32Array(e)}else{let f=e*t.size;const{iterable:_,objectInfo:A}=(0,r.X)(i,e,n);for(const t of _){let e;A.index++,v?(s.set(p?d:d(t,A)),e=u(s)):(e=a,l(e,y?o:o(t,A),g?c:c(t,A)),e.set(m?h:h(t,A),9)),b[f++]=e[0],b[f++]=e[1],b[f++]=e[2],b[f++]=e[3],b[f++]=e[4],b[f++]=e[5],b[f++]=e[6],b[f++]=e[7],b[f++]=e[8],b[f++]=e[9],b[f++]=e[10],b[f++]=e[11]}}}};function h(t,e){return e===i.rf.CARTESIAN||e===i.rf.METER_OFFSETS||e===i.rf.DEFAULT&&!t.isGeospatial}},56784:(t,e,n)=>{"use strict";var r=n(58784),i=n(95709);Object.defineProperty(e,"__esModule",{value:!0}),e.Base=void 0;var o=i(n(16193)),s=i(n(39892)),a=i(n(82274)),l=i(n(65044)),u=i(n(56994)),c=i(n(65611)),h=i(n(18337)),d=i(n(26396)),f=r(n(93345));var p=function(){},g=function(t){(0,u.default)(i,t);var e,n,r=(e=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=(0,h.default)(e);if(n){var i=(0,h.default)(this).constructor;t=Reflect.construct(r,arguments,i)}else t=r.apply(this,arguments);return(0,c.default)(this,t)});function i(){return(0,a.default)(this,i),r.apply(this,arguments)}return(0,l.default)(i,[{key:"render",value:function(){var t=this.props,e=t.height,n=t.width,r=t.viewBox,i=t.style,a=t.children,l=t.predefinedClassName,u=t.className,c=t.colors,h=t.totalColor,d=(0,s.default)(t,["height","width","viewBox","style","children","predefinedClassName","className","colors","totalColor"]),g=e,y=n||g,m=Array.isArray(c)&&h&&function(t,e){return new Array(t).fill(1).reduce((function(t,n,r){return"".concat(t,".cr").concat(r+1," {fill:").concat(e[r%e.length],";}")}),"")}(h,c);return f.default.createElement("svg",(0,o.default)({viewBox:r,width:y,height:g,style:i,className:"".concat(l," ").concat(u),onClick:p},d),m?f.default.createElement("style",{type:"text/css"},m):null,a)}}]),i}(f.Component);e.Base=g,(0,d.default)(g,"displayName","Base Icon"),(0,d.default)(g,"defaultProps",{height:null,width:null,viewBox:"0 0 64 64",predefinedClassName:"",className:"",style:{fill:"currentColor"}})},12117:(t,e,n)=>{"use strict";var r=n(95709),i=n(58784);Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"Provider",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(e,"FILE_CONFLICT_MSG",{enumerable:!0,get:function(){return o.FILE_CONFLICT_MSG}}),Object.defineProperty(e,"KEPLER_FORMAT",{enumerable:!0,get:function(){return o.KEPLER_FORMAT}}),Object.defineProperty(e,"Upload",{enumerable:!0,get:function(){return s.default}});var o=i(n(11088)),s=r(n(88488))},11088:(t,e,n)=>{"use strict";var r=n(95709);Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.FILE_CONFLICT_MSG=e.KEPLER_FORMAT=void 0;var i=r(n(92207)),o=r(n(79092)),s=r(n(82274)),a=r(n(65044)),l=r(n(26396)),u=r(n(88488)),c={width:300,height:200},h=u.default;e.KEPLER_FORMAT="keplergl";var d="file_conflict";e.FILE_CONFLICT_MSG=d;var f=function(){function t(e){(0,s.default)(this,t),(0,l.default)(this,"name",void 0),(0,l.default)(this,"displayName",void 0),(0,l.default)(this,"icon",void 0),(0,l.default)(this,"thumbnail",void 0),(0,l.default)(this,"isNew",!1),this.name=e.name||"cloud-provider",this.displayName=e.displayName||"Cloud Provider",this.icon=e.icon||h,this.thumbnail=e.thumbnail||c}var e,n,r,u,f,p,g;return(0,a.default)(t,[{key:"hasPrivateStorage",value:function(){return!0}},{key:"hasSharingUrl",value:function(){return!1}},{key:"getShareUrl",value:function(){return""}},{key:"getMapUrl",value:function(t){return""}},{key:"getAccessToken",value:(g=(0,o.default)(i.default.mark((function t(){return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Promise.reject("You must implement getAccessToken"));case 1:case"end":return t.stop()}}),t)}))),function(){return g.apply(this,arguments)})},{key:"getUserName",value:function(){return""}},{key:"getUser",value:(p=(0,o.default)(i.default.mark((function t(){return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Promise.reject("You must implement getUser"));case 1:case"end":return t.stop()}}),t)}))),function(){return p.apply(this,arguments)})},{key:"getFileConflictError",value:function(){return new Error(d)}},{key:"login",value:(f=(0,o.default)(i.default.mark((function t(){return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Promise.reject(new Error("you must implement the `login` method")));case 1:case"end":return t.stop()}}),t)}))),function(){return f.apply(this,arguments)})},{key:"logout",value:(u=(0,o.default)(i.default.mark((function t(){return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Promise.reject(new Error("you must implement the `logout` method")));case 1:case"end":return t.stop()}}),t)}))),function(){return u.apply(this,arguments)})},{key:"uploadMap",value:(r=(0,o.default)(i.default.mark((function t(e){return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.mapData,e.options,t.abrupt("return",Promise.reject("You must implement uploadMap"));case 2:case"end":return t.stop()}}),t)}))),function(t){return r.apply(this,arguments)})},{key:"listMaps",value:(n=(0,o.default)(i.default.mark((function t(){return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",[]);case 1:case"end":return t.stop()}}),t)}))),function(){return n.apply(this,arguments)})},{key:"downloadMap",value:(e=(0,o.default)(i.default.mark((function t(e){return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Promise.reject("You must implement downloadMap"));case 1:case"end":return t.stop()}}),t)}))),function(t){return e.apply(this,arguments)})},{key:"getManagementUrl",value:function(){throw new Error("You must implement getManagementUrl")}}]),t}();e.default=f},88488:(t,e,n)=>{"use strict";var r=n(58784),i=n(95709);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=i(n(82274)),s=i(n(65044)),a=i(n(56994)),l=i(n(65611)),u=i(n(18337)),c=i(n(26396)),h=r(n(93345)),d=n(56784);var f=function(t){(0,a.default)(i,t);var e,n,r=(e=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=(0,u.default)(e);if(n){var i=(0,u.default)(this).constructor;t=Reflect.construct(r,arguments,i)}else t=r.apply(this,arguments);return(0,l.default)(this,t)});function i(){return(0,o.default)(this,i),r.apply(this,arguments)}return(0,s.default)(i,[{key:"render",value:function(){return h.default.createElement(d.Base,this.props,h.default.createElement("path",{d:"M52 9v6a1 1 0 0 1-1 1H13a1 1 0 0 1-1-1V9a1 1 0 0 1 1-1h38a1 1 0 0 1 1 1zm-4 31L34.426 21.336a3 3 0 0 0-4.852 0L16 40h8v16h16V40h8z"}))}}]),i}(h.Component);e.default=f,(0,c.default)(f,"defaultProps",{height:"16px",predefinedClassName:"data-ex-icons-upload"})},29697:(t,e,n)=>{"use strict";var r=n(95709);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r(n(26396)),o=r(n(82274)),s=r(n(65044)),a=r(n(56994)),l=r(n(65611)),u=r(n(18337)),c=r(n(4390)),h=n(98265),d=n(64949),f=n(23863),p=n(30545);function g(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function y(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?g(Object(n),!0).forEach((function(e){(0,i.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var m=function(t){(0,a.default)(i,t);var e,n,r=(e=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=(0,u.default)(e);if(n){var i=(0,u.default)(this).constructor;t=Reflect.construct(r,arguments,i)}else t=r.apply(this,arguments);return(0,l.default)(this,t)});function i(){return(0,o.default)(this,i),r.apply(this,arguments)}return(0,s.default)(i,[{key:"renderSubLayers",value:function(t){return new f.SolidPolygonLayer(y(y({},t),{},{parameters:{blendFunc:[c.default.SRC_ALPHA,c.default.ONE_MINUS_SRC_ALPHA,c.default.ONE,c.default.ONE_MINUS_SRC_ALPHA],blendEquation:[c.default.FUNC_ADD,c.default.FUNC_ADD]},extruded:!0,opacity:1,filled:!0,getElevation:function(t){return t.properties.height||0},getPolygon:function(t){return t.coordinates},getFillColor:this.props.threeDBuildingColor}))}},{key:"renderLayers",value:function(){var t=this;return[new d.TileLayer({id:"".concat(this.id,"-deck-3d-building"),getTileData:function(e){return(0,p.getTileData)(t.props.mapboxApiUrl,t.props.mapboxApiAccessToken,e)},minZoom:13,renderSubLayers:this.renderSubLayers.bind(this),updateTriggers:this.props.updateTriggers})]}}]),i}(h.CompositeLayer);e.default=m},30545:(t,e,n)=>{"use strict";var r=n(95709);Object.defineProperty(e,"__esModule",{value:!0}),e.getTileData=function(t,e,n){var r=n.index,i=r.x,o=r.y,s=r.z,a="".concat(t||l).concat(u,"/").concat(s,"/").concat(i,"/").concat(o,".vector.pbf?access_token=").concat(e);return fetch(a).then((function(t){return t.arrayBuffer()})).then((function(t){return c(i,o,s,t)}))},e.decodeTile=c,e.vectorTileFeatureToProp=d;var i=r(n(15335)),o=n(94537),s=n(16366),a=512,l="https://a.tiles.mapbox.com",u="/v4/mapbox.mapbox-streets-v7";function c(t,e,n,r){var s=new o.VectorTile(new i.default(r)),l=[],u=t*a,c=e*a,f=Math.pow(2,n),p=h.bind(null,u,c,f),g="building",y=s.layers[g];if(!y)return[];for(var m=0;m<y.length;m++)d(y.feature(m),p).forEach((function(t){t.properties.layer=g,t.properties.height&&l.push(t)}));return l}function h(t,e,n,r,i){for(var o=i/a,l=0;l<r.length;l++){var u=r[l];r[l]=(0,s.worldToLngLat)([t+u[0]/o,e+u[1]/o],n)}}function d(t,e){var n,r,i=function(t){var e=t._pbf;e.pos=t._geometry;for(var n,r=e.readVarint()+e.pos,i=1,o=0,s=0,a=0,l=[];e.pos<r;){if(o<=0){var u=e.readVarint();i=7&u,o=u>>3}if(o--,1===i||2===i)s+=e.readSVarint(),a+=e.readSVarint(),1===i&&(n&&l.push(n),n=[]),n&&n.push([s,a]);else{if(7!==i)throw new Error("unknown command ".concat(i));n&&n.push(n[0].slice())}}return n&&l.push(n),l}(t),o=t.extent;for(i=function(t){var e=t.length;if(e<=1)return[t];for(var n,r,i=[],o=0;o<e;o++){var s=f(t[o]);0!==s&&(void 0===r&&(r=s<0),r===s<0?(n&&i.push(n),n=[t[o]]):n&&n.push(t[o]))}return n&&i.push(n),i}(i),n=0;n<i.length;n++)for(r=0;r<i[n].length;r++)e(i[n][r],o);return i.map((function(e){return{coordinates:e,properties:t.properties}}))}function f(t){for(var e,n,r=0,i=0,o=t.length,s=o-1;i<o;s=i++)e=t[i],r+=((n=t[s])[0]-e[0])*(e[1]+n[1]);return r}},52330:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})},6213:(t,e,n)=>{"use strict";var r=n(58784),i=n(95709);Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.clusterAggregation=void 0;var o=i(n(26396)),s=i(n(82274)),a=i(n(65044)),l=i(n(56994)),u=i(n(65611)),c=i(n(18337)),h=n(23863),d=n(31874),f=i(n(26439)),p=r(n(46606)),g=n(16366),y=n(55332),m=n(13848),v=r(n(18686));function b(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}var _=m.LAYER_VIS_CONFIGS.clusterRadius.defaultValue,A=m.LAYER_VIS_CONFIGS.clusterRadiusRange.defaultValue,x={key:"position",updateSteps:[{key:"geojson",triggers:{position:{prop:"getPosition",updateTrigger:"getPosition"},filterData:{prop:"filterData",updateTrigger:"filterData"}},updater:function(t,e,n,r){r.viewport;var i=e.data,o=e.getPosition,s=e.filterData,a=(0,v.getGeoJSON)(i,o,s),l=new v.default;this.setState({geoJSON:a,clusterBuilder:l})}},{key:"clustering",triggers:{clusterRadius:{prop:"clusterRadius"},zoom:{prop:"zoom"},width:{prop:"width"},height:{prop:"height"}},updater:function(t,e,n,r){var i=r.viewport,o=this.state,s=o.geoJSON,a=o.clusterBuilder,l=e.clusterRadius,u=e.zoom,c=e.width,h=e.height,d=i.longitude,p=i.latitude,g=f.default.bounds([d,p],u,[c,h]),y=a.clustersAtZoom({bbox:g,clusterRadius:l,geoJSON:s,zoom:u});this.setState({layerData:{data:y}})}}]};e.clusterAggregation=x;var w=[p.defaultColorDimension,{key:"radius",accessor:"getRadius",nullValue:0,updateSteps:[{key:"getDomain",triggers:{value:{prop:"getRadiusValue",updateTrigger:"getRadiusValue"}},updater:function(t,e,n){var r=n.key,i=e.getRadiusValue,o=this.state.layerData,s=[0,(0,y.max)(o.data,i)];this._setDimensionState(r,{valueDomain:s})}},{key:"getScaleFunc",triggers:{domain:{prop:"radiusDomain"},range:{prop:"radiusRange"},scaleType:{prop:"radiusScaleType"}},updater:p.getDimensionScale}],getSubLayerAccessor:function(t,e,n){return function(e){var r=n.getRadiusValue;return(0,t.scaleFunc)(r(e))}},getPickingInfo:function(t,e,n){return{radiusValue:n.getRadiusValue(e)}}}],C={clusterRadius:_,colorDomain:null,colorRange:m.DEFAULT_COLOR_RANGE,colorScaleType:m.SCALE_TYPES.quantize,radiusScaleType:m.SCALE_TYPES.sqrt,radiusRange:A,getPosition:{type:"accessor",value:function(t){return t.position}},getColorValue:{type:"accessor",value:function(t){return t.length}},getRadiusValue:{type:"accessor",value:function(t){return t.filteredPoints?t.filteredPoints.length:t.points.length}}},S=function(t){(0,l.default)(i,t);var e,n,r=(e=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=(0,c.default)(e);if(n){var i=(0,c.default)(this).constructor;t=Reflect.construct(r,arguments,i)}else t=r.apply(this,arguments);return(0,u.default)(this,t)});function i(){return(0,s.default)(this,i),r.apply(this,arguments)}return(0,a.default)(i,[{key:"initializeState",value:function(){var t=new p.default({aggregation:x,dimensions:w});this.state={cpuAggregator:t,aggregatorState:t.state},this.getAttributeManager().add({positions:{size:3,accessor:"getPosition"}})}},{key:"updateState",value:function(t){var e=t.oldProps,n=t.props,r=t.changeFlags;this.setState({aggregatorState:this.state.cpuAggregator.updateState({oldProps:e,props:n,changeFlags:r},{viewport:this.context.viewport,attributes:this.getAttributes(),numInstances:this.getNumInstances(n)})})}},{key:"getPickingInfo",value:function(t){var e=t.info;return this.state.cpuAggregator.getPickingInfo({info:e},this.props)}},{key:"_getSublayerUpdateTriggers",value:function(){return this.state.cpuAggregator.getUpdateTriggers(this.props)}},{key:"_getSubLayerAccessors",value:function(){return{getRadius:this.state.cpuAggregator.getAccessor("radius",this.props),getFillColor:this.state.cpuAggregator.getAccessor("fillColor",this.props)}}},{key:"renderLayers",value:function(){var t=this.props,e=t.id,n=t.radiusScale,r=this.state.cpuAggregator,i=this.props,s=i.visible,a=i.opacity,l=i.pickable,u=i.autoHighlight,c=i.highlightColor,d=this._getSublayerUpdateTriggers(),f=this._getSubLayerAccessors(),p=(0,g.getDistanceScales)(this.context.viewport).metersPerPixel[0];return new h.ScatterplotLayer(function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?b(Object(n),!0).forEach((function(e){(0,o.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({id:"".concat(e,"-cluster"),data:r.state.layerData.data,radiusScale:p*n,visible:s,opacity:a,pickable:l,autoHighlight:u,highlightColor:c,updateTriggers:d,parameters:{depthMask:!1}},f))}}]),i}(d._AggregationLayer);e.default=S,S.layerName="ClusterLayer",S.defaultProps=C},8970:(t,e,n)=>{"use strict";var r=n(95709);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r(n(26396)),o=r(n(82274)),s=r(n(65044)),a=r(n(96220)),l=r(n(56994)),u=r(n(65611)),c=r(n(18337)),h=n(98265),d=n(23863),f=r(n(4390)),p=n(29294);function g(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function y(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?g(Object(n),!0).forEach((function(e){(0,i.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var m=function(t){(0,l.default)(i,t);var e,n,r=(e=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=(0,c.default)(e);if(n){var i=(0,c.default)(this).constructor;t=Reflect.construct(r,arguments,i)}else t=r.apply(this,arguments);return(0,u.default)(this,t)});function i(){return(0,o.default)(this,i),r.apply(this,arguments)}return(0,s.default)(i,[{key:"getShaders",value:function(){var t,e,n=(0,a.default)((0,c.default)(i.prototype),"getShaders",this).call(this);return y(y({},n),{},{vs:(t=n.vs,e=(0,p.editShader)(t,"hexagon cell vs add instance 1","in vec3 instancePickingColors;","in vec3 instancePickingColors;\n     in float instanceCoverage;"),(0,p.editShader)(e,"hexagon cell vs add instance 2","float dotRadius = radius * coverage * shouldRender;","float dotRadius = radius * coverage * instanceCoverage * shouldRender;"))})}},{key:"initializeState",value:function(){var t;(0,a.default)((0,c.default)(i.prototype),"initializeState",this).call(this),null===(t=this.getAttributeManager())||void 0===t||t.addInstanced({instanceCoverage:{size:1,accessor:"getCoverage"}})}},{key:"draw",value:function(t){var e=t.uniforms,n=this.props,r=n.lineWidthUnits,i=n.lineWidthScale,o=n.lineWidthMinPixels,s=n.lineWidthMaxPixels,a=n.radiusUnits,l=n.elevationScale,u=n.extruded,c=n.filled,d=n.stroked,p=n.strokeOpacity,g=n.wireframe,y=n.offset,m=n.coverage,v=n.radius,b=n.angle,_=this.state,A=_.model,x=_.fillVertexCount,w=_.wireframeVertexCount,C=_.edgeDistance;A.setUniforms(e).setUniforms({radius:v,angle:b/180*Math.PI,offset:y,extruded:u,stroked:d,coverage:m,elevationScale:l,edgeDistance:C,radiusUnits:h.UNIT[a],widthUnits:h.UNIT[r],widthScale:i,widthMinPixels:o,widthMaxPixels:s}),u&&g&&(A.setProps({isIndexed:!0}),A.setVertexCount(w).setDrawMode(f.default.LINES).setUniforms({isStroke:!0}).draw()),c&&(A.setProps({isIndexed:!1}),A.setVertexCount(x).setDrawMode(f.default.TRIANGLE_STRIP).setUniforms({isStroke:!1}).draw()),!u&&d&&(A.setProps({isIndexed:!1}),A.setVertexCount(2*x/3).setDrawMode(f.default.TRIANGLE_STRIP).setUniforms({isStroke:!0,opacity:p}).draw())}}]),i}(d.ColumnLayer);m.layerName="EnhancedColumnLayer";var v=m;e.default=v},71026:(t,e,n)=>{"use strict";var r=n(95709);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r(n(82274)),o=r(n(65044)),s=r(n(56994)),a=r(n(65611)),l=r(n(18337)),u=r(n(26396)),c=n(98265),h=r(n(4390)),d=r(n(76867));var f=function(t){(0,s.default)(u,t);var e,n,r=(e=u,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=(0,l.default)(e);if(n){var i=(0,l.default)(this).constructor;t=Reflect.construct(r,arguments,i)}else t=r.apply(this,arguments);return(0,a.default)(this,t)});function u(){return(0,i.default)(this,u),r.apply(this,arguments)}return(0,o.default)(u,[{key:"getShaders",value:function(t){return{modules:[d.default],defines:{}}}},{key:"initializeState",value:function(t,e){var n=this.getAttributeManager();n&&n.add({filtered:{size:1,type:h.default.FLOAT,accessor:"getFiltered",shaderAttributes:{filtered:{divisor:0},instanceFiltered:{divisor:1}}}})}}]),u}(c.LayerExtension);e.default=f,(0,u.default)(f,"defaultProps",{getFiltered:{type:"accessor",value:1}}),(0,u.default)(f,"extensionName","FilterArrowExtension")},76867:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r={name:"filter-arrow",dependencies:[n(98265).project],vs:"\n  #ifdef NON_INSTANCED_MODEL\n    #define FILTER_ARROW_ATTRIB filtered\n  #else\n    #define FILTER_ARROW_ATTRIB instanceFiltered\n  #endif\n  attribute float FILTER_ARROW_ATTRIB;\n",fs:"",inject:{"vs:#decl":"\n    varying float is_filtered;\n  ","vs:#main-end":"\n    is_filtered = FILTER_ARROW_ATTRIB;\n  ","fs:#decl":"\n    varying float is_filtered;\n  ","fs:DECKGL_FILTER_COLOR":"\n    // abandon the fragments if  it is not filtered\n    if (is_filtered == 0.) {\n      discard;\n    }\n  "},getUniforms:function(){}};e.default=r},69659:(t,e,n)=>{"use strict";var r=n(58784),i=n(95709);Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.gridAggregation=void 0;var o=i(n(82274)),s=i(n(65044)),a=i(n(56994)),l=i(n(65611)),u=i(n(18337)),c=n(31874),h=r(n(46606));var d={key:"position",updateSteps:[{key:"aggregate",triggers:{cellSize:{prop:"cellSize"},position:{prop:"getPosition",updateTrigger:"getPosition"},aggregator:{prop:"gridAggregator"}},updater:h.getAggregatedData}]};e.gridAggregation=d;var f=function(t){(0,a.default)(i,t);var e,n,r=(e=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=(0,u.default)(e);if(n){var i=(0,u.default)(this).constructor;t=Reflect.construct(r,arguments,i)}else t=r.apply(this,arguments);return(0,l.default)(this,t)});function i(){return(0,o.default)(this,i),r.apply(this,arguments)}return(0,s.default)(i,[{key:"initializeState",value:function(){var t=new h.default({aggregation:d});this.state={cpuAggregator:t,aggregatorState:t.state},this.getAttributeManager().add({positions:{size:3,accessor:"getPosition"}})}}]),i}(c.CPUGridLayer);e.default=f,f.layerName="ScaleEnhancedGridLayer"},5690:(t,e,n)=>{"use strict";var r=n(58784),i=n(95709);Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.hexagonAggregation=void 0;var o=i(n(82274)),s=i(n(65044)),a=i(n(56994)),l=i(n(65611)),u=i(n(18337)),c=n(31874),h=r(n(46606));var d={key:"position",updateSteps:[{key:"aggregate",triggers:{cellSize:{prop:"radius"},position:{prop:"getPosition",updateTrigger:"getPosition"},aggregator:{prop:"hexagonAggregator"}},updater:h.getAggregatedData}]};e.hexagonAggregation=d;var f=function(t){(0,a.default)(i,t);var e,n,r=(e=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=(0,u.default)(e);if(n){var i=(0,u.default)(this).constructor;t=Reflect.construct(r,arguments,i)}else t=r.apply(this,arguments);return(0,l.default)(this,t)});function i(){return(0,o.default)(this,i),r.apply(this,arguments)}return(0,s.default)(i,[{key:"initializeState",value:function(){var t=new h.default({aggregation:d});this.state={cpuAggregator:t,aggregatorState:t.state},this.getAttributeManager().add({positions:{size:3,accessor:"getPosition"}})}}]),i}(c.HexagonLayer);e.default=f,f.layerName="ScaleEnhancedHexagonLayer"},29294:(t,e,n)=>{"use strict";var r=n(95709);Object.defineProperty(e,"__esModule",{value:!0});var i={ThreeDBuildingLayer:!0,DeckGLClusterLayer:!0,EnhancedColumnLayer:!0,EnhancedGridLayer:!0,EnhancedHexagonLayer:!0,EnhancedLineLayer:!0,SvgIconLayer:!0,FilterArrowExtension:!0};Object.defineProperty(e,"ThreeDBuildingLayer",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(e,"DeckGLClusterLayer",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(e,"EnhancedColumnLayer",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(e,"EnhancedGridLayer",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(e,"EnhancedHexagonLayer",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(e,"EnhancedLineLayer",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(e,"SvgIconLayer",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(e,"FilterArrowExtension",{enumerable:!0,get:function(){return d.default}});var o=r(n(29697)),s=r(n(6213)),a=r(n(8970)),l=r(n(69659)),u=r(n(5690)),c=r(n(99395)),h=r(n(63551)),d=r(n(71026)),f=n(3167);Object.keys(f).forEach((function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(i,t)||t in e&&e[t]===f[t]||Object.defineProperty(e,t,{enumerable:!0,get:function(){return f[t]}}))}));var p=n(52330);Object.keys(p).forEach((function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(i,t)||t in e&&e[t]===p[t]||Object.defineProperty(e,t,{enumerable:!0,get:function(){return p[t]}}))}));var g=n(30545);Object.keys(g).forEach((function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(i,t)||t in e&&e[t]===g[t]||Object.defineProperty(e,t,{enumerable:!0,get:function(){return g[t]}}))}))},18686:(t,e,n)=>{"use strict";var r=n(95709);Object.defineProperty(e,"__esModule",{value:!0}),e.getGeoJSON=function(t,e,n){return("function"==typeof n?t.filter(n):t).map((function(t){return{type:"Point",properties:{data:t,points:[t],point_count:1,point_count_abbreviated:"1"},geometry:{coordinates:e(t)}}})).filter((function(t){return t.geometry.coordinates.every(Number.isFinite)}))},e.default=void 0;var i=r(n(82274)),o=r(n(65044)),s=r(n(26396)),a=r(n(21259)),l=r(n(59138)),u=r(n(47654)),c=function(t){var e=t.clusterRadius;return"".concat(e)},h=function(t){var e=t.clusterRadius,n=t.geoJSON;return new l.default({maxZoom:20,radius:e,reduce:function(t,e){t.points=[].concat((0,a.default)(t.points),(0,a.default)(e.points))},map:function(t){return{points:[t.data]}}}).load(n)},d=function(){function t(){(0,i.default)(this,t),(0,s.default)(this,"clusterer",void 0),this.clusterer=(0,u.default)(h,c)}return(0,o.default)(t,[{key:"clustersAtZoom",value:function(t){var e=t.bbox,n=t.clusterRadius,r=t.geoJSON,i=t.zoom;return this.clusterer({clusterRadius:n,geoJSON:r}).getClusters(e,i).map((function(t,e){return{points:t.properties.points,position:t.geometry.coordinates,index:e}}))}},{key:"clearClustererCache",value:function(){var t,e;null===(t=(e=this.clusterer.cache).clear)||void 0===t||t.call(e)}}]),t}();e.default=d},46606:(t,e,n)=>{"use strict";var r=n(95709);Object.defineProperty(e,"__esModule",{value:!0}),e.getValueFunc=g,e.getScaleFunctor=y,e.getGetValue=v,e.getDimensionSortedBins=b,e.getDimensionValueDomain=_,e.getDimensionScale=A,e.getAggregatedData=w,e.default=e.defaultDimensions=e.defaultElevationDimension=e.defaultColorDimension=e.defaultAggregation=e.DECK_AGGREGATION_MAP=void 0;var i,o=r(n(82274)),s=r(n(65044)),a=r(n(85735)),l=r(n(26396)),u=n(31874),c=n(89840),h=n(77244),d=n(13848);function f(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}var p=(i={},(0,l.default)(i,u.AGGREGATION_OPERATION.SUM,d.AGGREGATION_TYPES.sum),(0,l.default)(i,u.AGGREGATION_OPERATION.MEAN,d.AGGREGATION_TYPES.average),(0,l.default)(i,u.AGGREGATION_OPERATION.MIN,d.AGGREGATION_TYPES.minimum),(0,l.default)(i,u.AGGREGATION_OPERATION.MAX,d.AGGREGATION_TYPES.maximum),i);function g(t,e){t&&u.AGGREGATION_OPERATION[t.toUpperCase()]||c.console.warn("Aggregation ".concat(t," is not supported"));var n=u.AGGREGATION_OPERATION[t.toUpperCase()]||u.AGGREGATION_OPERATION.SUM,r=p[n];return function(t){return(0,h.aggregate)(t.map(e),r)}}function y(t){return t&&d.SCALE_FUNC[t]||c.console.warn("Scale ".concat(t," is not supported")),d.SCALE_FUNC[t]||d.SCALE_FUNC.quantize}function m(){}function v(t,e,n){var r=n.key,i=t.triggers,o=i.value,s=i.weight,a=i.aggregation,l=e[o.prop];null===l&&(l=g(e[a.prop],e[s.prop])),l&&this._setDimensionState(r,{getValue:l})}function b(t,e,n){var r=n.key,i=this.state.dimensions[r].getValue,o=new u._BinSorter(this.state.layerData.data||[],{getValue:i,filterData:e._filterData});this._setDimensionState(r,{sortedBins:o})}function _(t,e,n){var r=n.key,i=t.triggers,o=i.lowerPercentile,s=i.upperPercentile,a=i.scaleType;if(this.state.dimensions[r].sortedBins){var l=this.state.dimensions[r].sortedBins.getValueDomainByScale(e[a.prop],[e[o.prop],e[s.prop]]);this._setDimensionState(r,{valueDomain:l})}}function A(t,e,n){var r=n.key,i=t.triggers,o=i.domain,s=i.range,l=i.scaleType,u=t.onSet;if(this.state.dimensions[r].valueDomain){var c=e[s.prop],h=e[o.prop]||this.state.dimensions[r].valueDomain,d=y(l&&e[l.prop])().domain(h).range(c);"object"===(0,a.default)(u)&&"function"==typeof e[u.props]&&e[u.props](d.domain()),this._setDimensionState(r,{scaleFunc:d})}}function x(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t.hexagons?Object.assign({data:t.hexagons},t):t.layerData?Object.assign({data:t.layerData},t):t}function w(t,e,n,r){var i=(0,e[t.triggers.aggregator.prop])(e,r);this.setState({layerData:x(i)})}e.DECK_AGGREGATION_MAP=p;var C={key:"position",updateSteps:[{key:"aggregate",triggers:{cellSize:{prop:"cellSize"},position:{prop:"getPosition",updateTrigger:"getPosition"},aggregator:{prop:"gridAggregator"}},updater:w}]};function S(t,e,n){return function(n){var r=t.sortedBins,i=t.scaleFunc,o=r.binMap[n.index];if(o&&0===o.counts)return e.nullValue;var s=o&&o.value,a=i.domain();return s>=a[0]&&s<=a[a.length-1]?i(s):e.nullValue}}e.defaultAggregation=C;var E={key:"fillColor",accessor:"getFillColor",getPickingInfo:function(t,e){if(!e)return{};var n=t.sortedBins;return{colorValue:n.binMap[e.index]&&n.binMap[e.index].value}},nullValue:[0,0,0,0],updateSteps:[{key:"getValue",triggers:{value:{prop:"getColorValue",updateTrigger:"getColorValue"},weight:{prop:"getColorWeight",updateTrigger:"getColorWeight"},aggregation:{prop:"colorAggregation"}},updater:v},{key:"getBins",triggers:{_filterData:{prop:"_filterData",updateTrigger:"_filterData"}},updater:b},{key:"getDomain",triggers:{lowerPercentile:{prop:"lowerPercentile"},upperPercentile:{prop:"upperPercentile"},scaleType:{prop:"colorScaleType"}},updater:_},{key:"getScaleFunc",triggers:{domain:{prop:"colorDomain"},range:{prop:"colorRange"},scaleType:{prop:"colorScaleType"}},onSet:{props:"onSetColorDomain"},updater:A}],getSubLayerAccessor:S};e.defaultColorDimension=E;var M={key:"elevation",accessor:"getElevation",getPickingInfo:function(t,e){if(!e)return{};var n=t.sortedBins;return{elevationValue:n.binMap[e.index]&&n.binMap[e.index].value}},nullValue:-1,updateSteps:[{key:"getValue",triggers:{value:{prop:"getElevationValue",updateTrigger:"getElevationValue"},weight:{prop:"getElevationWeight",updateTrigger:"getElevationWeight"},aggregation:{prop:"elevationAggregation"}},updater:v},{key:"getBins",triggers:{_filterData:{prop:"_filterData",updateTrigger:"_filterData"}},updater:b},{key:"getDomain",triggers:{lowerPercentile:{prop:"elevationLowerPercentile"},upperPercentile:{prop:"elevationUpperPercentile"},scaleType:{prop:"elevationScaleType"}},updater:_},{key:"getScaleFunc",triggers:{domain:{prop:"elevationDomain"},range:{prop:"elevationRange"},scaleType:{prop:"elevationScaleType"}},onSet:{props:"onSetElevationDomain"},updater:A}],getSubLayerAccessor:S};e.defaultElevationDimension=M;var P=[E,M];e.defaultDimensions=P;var T=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,o.default)(this,t),(0,l.default)(this,"state",void 0),(0,l.default)(this,"dimensionUpdaters",void 0),(0,l.default)(this,"aggregationUpdater",void 0),this.state=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?f(Object(n),!0).forEach((function(e){(0,l.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({layerData:{},dimensions:{}},e.initialState),this.dimensionUpdaters={},this.aggregationUpdater=e.aggregation||C,this._addDimension(e.dimensions||P)}return(0,s.default)(t,[{key:"updateAllDimensions",value:function(t){var e=[];for(var n in this.dimensionUpdaters){var r=this._accumulateUpdaters(0,t,this.dimensionUpdaters[n]);e=e.concat(r)}e.forEach((function(t){return"function"==typeof t&&t()}))}},{key:"updateAggregation",value:function(t,e){this._accumulateUpdaters(0,t,this.aggregationUpdater).forEach((function(t){return"function"==typeof t&&t(e)}))}},{key:"updateState",value:function(t,e){var n=t.oldProps,r=t.props,i=t.changeFlags;if(i.dataChanged)return this.updateAggregation(r,e),this.updateAllDimensions(r),this.state;var o=this._getAggregationChanges(n,r,i);return o&&o.length?(o.forEach((function(t){return"function"==typeof t&&t(e)})),this.updateAllDimensions(r)):(this._getDimensionChanges(n,r,i)||[]).forEach((function(t){return"function"==typeof t&&t()})),this.state}},{key:"setState",value:function(t){this.state=Object.assign({},this.state,t)}},{key:"_setDimensionState",value:function(t,e){this.setState({dimensions:Object.assign({},this.state.dimensions,(0,l.default)({},t,Object.assign({},this.state.dimensions[t],e)))})}},{key:"_addAggregation",value:function(t){this.aggregationUpdater=t}},{key:"_addDimension",value:function(){var t=this;(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach((function(e){var n=e.key;t.dimensionUpdaters[n]=e}))}},{key:"_needUpdateStep",value:function(t,e,n,r){return Object.values(t.triggers).some((function(t){return t.updateTrigger?r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged[t.updateTrigger]):e[t.prop]!==n[t.prop]}))}},{key:"_accumulateUpdaters",value:function(t,e,n){for(var r=[],i=t;i<n.updateSteps.length;i++){var o=n.updateSteps[i].updater;"function"==typeof o&&r.push(o.bind(this,n.updateSteps[i],e,n))}return r}},{key:"_getAllUpdaters",value:function(t,e,n,r){var i=this,o=[],s=t.updateSteps.findIndex((function(t){return i._needUpdateStep(t,e,n,r)}));return s>-1&&(o=o.concat(this._accumulateUpdaters(s,n,t))),o}},{key:"_getAggregationChanges",value:function(t,e,n){var r=this._getAllUpdaters(this.aggregationUpdater,t,e,n);return r.length?r:null}},{key:"_getDimensionChanges",value:function(t,e,n){var r=[];for(var i in this.dimensionUpdaters){var o=this.dimensionUpdaters[i],s=this._getAllUpdaters(o,t,e,n);r=r.concat(s)}return r.length?r:null}},{key:"getUpdateTriggers",value:function(t){var e=this,n=t.updateTriggers||{},r={},i=function(i){var o=e.dimensionUpdaters[i],s=o.accessor,l=o.updateSteps;r[s]={},l.forEach((function(e){Object.values(e.triggers||[]).forEach((function(e){var i=e.prop,o=e.updateTrigger;if(o){var l=n[o];"object"!==(0,a.default)(l)||Array.isArray(l)?void 0!==l&&(r[s][i]=l):Object.assign(r[s],l)}else r[s][i]=t[i]}))}))};for(var o in this.dimensionUpdaters)i(o);return r}},{key:"getPickingInfo",value:function(t,e){var n=t.info,r=null,i=n.picked&&n.index>-1?this.state.layerData.data[n.index]:null;if(i){var o={};for(var s in this.dimensionUpdaters){var a=this.dimensionUpdaters[s].getPickingInfo;"function"==typeof a&&(o=Object.assign({},o,a(this.state.dimensions[s],i,e)))}r=Object.assign(o,i,{points:i.filteredPoints||i.points})}return Object.assign(n,{picked:Boolean(r),object:r})}},{key:"getAccessor",value:function(t,e){return this.dimensionUpdaters.hasOwnProperty(t)?this.dimensionUpdaters[t].getSubLayerAccessor(this.state.dimensions[t],this.dimensionUpdaters[t],e):m}}],[{key:"defaultDimensions",value:function(){return P}}]),t}();e.default=T,(0,l.default)(T,"getDimensionScale",void 0),T.getDimensionScale=A},3167:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.editShader=function(t,e,n,i){return t.includes(n)?t.replace(n,i):(r.console.error("Cannot edit ".concat(e," layer shader")),t)};var r=n(89840)},99395:(t,e,n)=>{"use strict";var r=n(95709);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r(n(82274)),o=r(n(65044)),s=r(n(96220)),a=r(n(56994)),l=r(n(65611)),u=r(n(18337)),c=r(n(26396)),h=n(23863),d=r(n(4390)),f=n(29294);function p(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function g(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?p(Object(n),!0).forEach((function(e){(0,c.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var y=g(g({},h.LineLayer.defaultProps),{},{getTargetColor:function(t){return t.color||[0,0,0,255]}}),m=function(t){(0,a.default)(c,t);var e,n,r=(e=c,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=(0,u.default)(e);if(n){var i=(0,u.default)(this).constructor;t=Reflect.construct(r,arguments,i)}else t=r.apply(this,arguments);return(0,l.default)(this,t)});function c(){return(0,i.default)(this,c),r.apply(this,arguments)}return(0,o.default)(c,[{key:"getShaders",value:function(){var t=(0,s.default)((0,u.default)(c.prototype),"getShaders",this).call(this),e=function(t){var e=(0,f.editShader)(t,"line target color vs","attribute vec4 instanceColors;","attribute vec4 instanceColors; attribute vec4 instanceTargetColors;");return(0,f.editShader)(e,"line color vs","vColor = vec4(instanceColors.rgb, instanceColors.a * opacity);","vec4 color = mix(instanceColors, instanceTargetColors, positions.x);vColor = vec4(color.rgb, color.a * opacity);")}(t.vs);return e=function(t){var e=(0,f.editShader)(t,"line elevation scale 1 vs - inject elevation scale","uniform float widthMaxPixels;","uniform float widthMaxPixels;\n     uniform float elevationScale;");return e=(0,f.editShader)(e,"line elevation scale 2 vs - multiply by elevation scale","geometry.worldPosition = instanceSourcePositions;\n  geometry.worldPositionAlt = instanceTargetPositions;","vec3 source_world = instanceSourcePositions;\n     vec3 target_world = instanceTargetPositions;\n     source_world.z *= elevationScale;\n     target_world.z *= elevationScale;\n     \n     geometry.worldPosition = source_world;\n     geometry.worldPositionAlt = target_world;"),(0,f.editShader)(e,"line elevation scale 3 vs","vec3 source_world = instanceSourcePositions;\n  vec3 target_world = instanceTargetPositions;","")}(e),g(g({},t),{},{vs:e})}},{key:"draw",value:function(t){var e=t.uniforms,n=this.props.elevationScale;(0,s.default)((0,u.default)(c.prototype),"draw",this).call(this,{uniforms:g(g({},e),{},{elevationScale:n})})}},{key:"initializeState",value:function(){var t;(0,s.default)((0,u.default)(c.prototype),"initializeState",this).call(this,void 0),this.state.attributeManager.addInstanced({instanceTargetColors:{size:null===(t=this.props.colorFormat)||void 0===t?void 0:t.length,type:d.default.UNSIGNED_BYTE,normalized:!0,transition:!0,accessor:"getTargetColor",defaultValue:[0,0,0,255]}})}}]),c}(h.LineLayer);e.default=m,m.layerName="EnhancedLineLayer",m.defaultProps=y},12282:(t,e,n)=>{"use strict";var r=n(95709);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r(n(26396)),o=r(n(82274)),s=r(n(65044)),a=r(n(56994)),l=r(n(65611)),u=r(n(18337)),c=n(23863),h=n(81251),d=r(n(4390));function f(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function p(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?f(Object(n),!0).forEach((function(e){(0,i.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var g=[-1,-1,0,-1,1,0,1,1,0,1,-1,0],y=function(t){(0,a.default)(i,t);var e,n,r=(e=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=(0,u.default)(e);if(n){var i=(0,u.default)(this).constructor;t=Reflect.construct(r,arguments,i)}else t=r.apply(this,arguments);return(0,l.default)(this,t)});function i(){return(0,o.default)(this,i),r.apply(this,arguments)}return(0,s.default)(i,[{key:"_getModel",value:function(t){var e=this.getShaders(void 0),n=this.props.iconGeometry,r=n?new h.Geometry({drawMode:d.default.TRIANGLES,attributes:{positions:new Float32Array(n)}}):new h.Geometry({drawMode:d.default.TRIANGLE_FAN,attributes:{positions:new Float32Array(g)}});return new h.Model(t,p(p({},e),{},{id:this.props.id,geometry:r,isInstanced:!0,shaderCache:this.context.shaderCache}))}}]),i}(c.ScatterplotLayer);e.default=y,y.layerName="ScatterplotIconLayer"},63551:(t,e,n)=>{"use strict";var r=n(95709);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r(n(26396)),o=r(n(82274)),s=r(n(65044)),a=r(n(56994)),l=r(n(65611)),u=r(n(18337)),c=n(98265),h=r(n(12282));function d(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function f(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?d(Object(n),!0).forEach((function(e){(0,i.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var p=[1,1,0,1,-1,0,-1,-1,0,-1,-1,0,-1,1,0,1,1,0],g={getIconGeometry:function(t){return p},getIcon:function(t){return t.icon}},y=function(t){(0,a.default)(i,t);var e,n,r=(e=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=(0,u.default)(e);if(n){var i=(0,u.default)(this).constructor;t=Reflect.construct(r,arguments,i)}else t=r.apply(this,arguments);return(0,l.default)(this,t)});function i(){return(0,o.default)(this,i),r.apply(this,arguments)}return(0,s.default)(i,[{key:"initializeState",value:function(){this.state={data:{}}}},{key:"updateState",value:function(t){t.changeFlags.dataChanged&&this._extractSublayers()}},{key:"_extractSublayers",value:function(){for(var t=this.props,e=t.data,n=t.getIconGeometry,r=t.getIcon,i={},o=0;o<e.length;o++){var s=r(e[o]);i[s]=i[s]||{id:s,geometry:n(s)||p,data:[]},i[s].data.push(e[o])}this.setState({data:Object.values(i)})}},{key:"_updateAutoHighlight",value:function(t){var e;null==t||null===(e=t.sourceLayer)||void 0===e||e.updateAutoHighlight(t)}},{key:"renderLayers",value:function(){var t=this,e=this.props.id,n=this.state.data&&this.state.data.length&&this.state.data.map((function(n){var r=n.id,i=n.data,o=n.geometry;return new h.default(f(f({},t.props),{},{id:"".concat(e,"-").concat(r),data:i,iconGeometry:o}))}));return n&&n.length>0?n:null}}]),i}(c.CompositeLayer);e.default=y,y.layerName="SvgIconLayer",y.defaultProps=g},39095:(t,e,n)=>{"use strict";var r=n(95709);Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.aggregateRequiredColumns=e.getFilterDataFunc=e.getValueAggrFunc=e.pointPosResolver=e.pointPosAccessor=void 0;var i=r(n(21259)),o=r(n(82274)),s=r(n(65044)),a=r(n(41972)),l=r(n(96220)),u=r(n(56994)),c=r(n(65611)),h=r(n(18337)),d=r(n(26396)),f=r(n(47654)),p=r(n(37576)),g=n(77244),y=n(13848);function m(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function v(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?m(Object(n),!0).forEach((function(e){(0,d.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var b=function(t){var e=t.lat,n=t.lng;return function(t){return function(r){return[t.valueAt(r.index,n.fieldIdx),t.valueAt(r.index,e.fieldIdx)]}}};e.pointPosAccessor=b,e.pointPosResolver=function(t){var e=t.lat,n=t.lng;return"".concat(e.fieldIdx,"-").concat(n.fieldIdx)};var _=function(t){return function(e,n){return function(r){return e?(0,g.aggregate)(r.map((function(n){return e.valueAccessor(t(n))})),n):r.length}}};e.getValueAggrFunc=_;var A=function(t,e){return function(n){return e(n).every((function(e,n){return e>=t[n][0]&&e<=t[n][1]}))}};e.getFilterDataFunc=A;var x=function(t){return t.colors.map(g.hexToRgb)},w=["lat","lng"];e.aggregateRequiredColumns=w;var C=function(t){(0,u.default)(p,t);var e,n,r=(e=p,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=(0,h.default)(e);if(n){var i=(0,h.default)(this).constructor;t=Reflect.construct(r,arguments,i)}else t=r.apply(this,arguments);return(0,c.default)(this,t)});function p(t){var e;return(0,o.default)(this,p),e=r.call(this,t),(0,d.default)((0,a.default)(e),"getColorRange",void 0),e.getPositionAccessor=function(t){return b(e.config.columns)(t)},e.getColorRange=(0,f.default)(x),e.getPointData=function(t){return t.source},e.gpuFilterGetIndex=function(t){return e.getPointData(t).index},e.gpuFilterGetData=function(t,e,n){return t.valueAt(e.index,n)},e}return(0,s.default)(p,[{key:"isAggregated",get:function(){return!0}},{key:"requiredLayerColumns",get:function(){return w}},{key:"columnPairs",get:function(){return this.defaultPointColumnPairs}},{key:"noneLayerDataAffectingProps",get:function(){return[].concat((0,i.default)((0,l.default)((0,h.default)(p.prototype),"noneLayerDataAffectingProps",this)),["enable3d","colorRange","colorDomain","sizeRange","sizeScale","sizeDomain","percentile","coverage","elevationPercentile","elevationScale","enableElevationZoomFactor"])}},{key:"visualChannels",get:function(){return{color:{aggregation:"colorAggregation",channelScaleType:y.CHANNEL_SCALES.colorAggr,defaultMeasure:"property.pointCount",domain:"colorDomain",field:"colorField",key:"color",property:"color",range:"colorRange",scale:"colorScale"},size:{aggregation:"sizeAggregation",channelScaleType:y.CHANNEL_SCALES.sizeAggr,condition:function(t){return t.visConfig.enable3d},defaultMeasure:"property.pointCount",domain:"sizeDomain",field:"sizeField",key:"size",property:"height",range:"sizeRange",scale:"sizeScale"}}}},{key:"getVisualChannelDescription",value:function(t){var e,n=this.visualChannels[t];if(!n)return{label:"",measure:void 0};var r=n.range,i=n.field,o=n.defaultMeasure,s=n.aggregation,a=this.config[i],l=null===(e=this.visConfigSettings[r])||void 0===e?void 0:e.label;return{label:"function"==typeof l?l(this.config):l||"",measure:a&&s?"".concat(this.config.visConfig[s]," of ").concat(a.displayName||a.name):o}}},{key:"getHoverData",value:function(t){return t}},{key:"updateLayerVisualChannel",value:function(t,e){t.dataContainer,this.validateVisualChannel(e)}},{key:"validateVisualChannel",value:function(t){this.validateFieldType(t),this.validateAggregationType(t),this.validateScale(t)}},{key:"validateAggregationType",value:function(t){var e=this.visualChannels[t],n=e.field,r=e.aggregation,i=this.getAggregationOptions(t);r&&(i.length?i.includes(this.config.visConfig[r])||this.updateLayerVisConfig((0,d.default)({},r,i[0])):this.updateLayerConfig((0,d.default)({},n,null)))}},{key:"getAggregationOptions",value:function(t){var e=this.visualChannels[t],n=e.field,r=e.channelScaleType;return Object.keys(this.config[n]?y.FIELD_OPTS[this.config[n].type].scale[r]:y.DEFAULT_AGGREGATION[r])}},{key:"getScaleOptions",value:function(t){var e=this.visualChannels[t],n=e.field,r=e.aggregation,i=e.channelScaleType,o=r?this.config.visConfig[r]:null;return o?this.config[n]?y.FIELD_OPTS[this.config[n].type].scale[i][o]:y.DEFAULT_AGGREGATION[i][o]:[]}},{key:"updateLayerDomain",value:function(t,e){return this}},{key:"updateLayerMeta",value:function(t,e){var n=this.getPointsBounds(t,e);this.updateMeta({bounds:n})}},{key:"calculateDataAttribute",value:function(t,e){t.dataContainer;for(var n=t.filteredIndex,r=[],i=0;i<n.length;i++){var o=n[i];e({index:o}).every(Number.isFinite)&&r.push({index:o})}return r}},{key:"formatLayerData",value:function(t,e){if(null===this.config.dataId)return{};var n=t[this.config.dataId],r=n.gpuFilter,i=n.dataContainer,o=this.getPositionAccessor(i),s=_(this.getPointData),a=s(this.config.colorField,this.config.visConfig.colorAggregation),l=s(this.config.sizeField,this.config.visConfig.sizeAggregation),u=Object.values(r.filterRange).some((function(t){return t.some((function(t){return 0!==t}))})),c=r.filterValueAccessor(i)(this.gpuFilterGetIndex,this.gpuFilterGetData),h=u?A(r.filterRange,c):void 0;return v(v({data:this.updateData(t,e).data,getPosition:o,_filterData:h},a?{getColorValue:a}:{}),l?{getElevationValue:l}:{})}},{key:"getDefaultDeckLayerProps",value:function(t){return v(v({},(0,l.default)((0,h.default)(p.prototype),"getDefaultDeckLayerProps",this).call(this,t)),{},{highlightColor:y.HIGHLIGH_COLOR_3D,extensions:[],autoHighlight:this.config.visConfig.enable3d})}},{key:"getDefaultAggregationLayerProp",value:function(t){var e=t.gpuFilter,n=t.mapState,r=t.layerCallbacks,i=void 0===r?{}:r,o=this.config.visConfig,s=this.getElevationZoomFactor(n),a={getColorValue:{colorField:this.config.colorField,colorAggregation:this.config.visConfig.colorAggregation},getElevationValue:{sizeField:this.config.sizeField,sizeAggregation:this.config.visConfig.sizeAggregation},_filterData:v({filterRange:e.filterRange},e.filterValueUpdateTriggers)};return v(v({},this.getDefaultDeckLayerProps(t)),{},{coverage:o.coverage,colorRange:this.getColorRange(o.colorRange),colorScaleType:this.config.colorScale,upperPercentile:o.percentile[1],lowerPercentile:o.percentile[0],colorAggregation:o.colorAggregation,extruded:o.enable3d,elevationScale:o.elevationScale*s,elevationScaleType:this.config.sizeScale,elevationRange:o.sizeRange,elevationLowerPercentile:o.elevationPercentile[0],elevationUpperPercentile:o.elevationPercentile[1],updateTriggers:a,onSetColorDomain:i.onSetLayerDomain})}}]),p}(p.default);e.default=C},30958:(t,e,n)=>{"use strict";var r=n(58784),i=n(95709);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=i(n(82274)),s=i(n(65044)),a=i(n(56994)),l=i(n(65611)),u=i(n(18337)),c=i(n(26396)),h=r(n(93345)),d=i(n(5556)),f=n(32268);var p=function(t){(0,a.default)(i,t);var e,n,r=(e=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=(0,u.default)(e);if(n){var i=(0,u.default)(this).constructor;t=Reflect.construct(r,arguments,i)}else t=r.apply(this,arguments);return(0,l.default)(this,t)});function i(){return(0,o.default)(this,i),r.apply(this,arguments)}return(0,s.default)(i,[{key:"render",value:function(){return h.default.createElement(f.Base,this.props,h.default.createElement("path",{d:"M34.5,34.4c-0.6,0-1.2-0.4-1.4-1c-2.7-9.9-8.8-21.7-16.8-22.3c-3.1-0.2-5.6,1.5-7,4.8c-0.3,0.7-1.1,1.1-1.9,0.7 c-0.7-0.3-1.1-1.1-0.7-1.9c1.9-4.3,5.6-6.8,9.8-6.5c9.5,0.7,16.3,13,19.4,24.4c0.2,0.8-0.2,1.5-1,1.7C34.8,34.3,34.6,34.4,34.5,34.4 z",className:"cr1"}),h.default.createElement("path",{d:"M6.7,57c0,0-0.1,0-0.1,0c-0.5-0.1-0.9-0.6-0.8-1.1c2.4-17.3,9.6-30.3,17.5-31.8c3.1-0.6,7.8,0.4,12.1,8.3 c0.3,0.5,0.1,1-0.4,1.3c-0.5,0.3-1,0.1-1.3-0.4c-2.1-3.8-5.6-8.2-10.1-7.4C16.6,27.3,9.9,40,7.6,56.2C7.6,56.7,7.2,57,6.7,57z",className:"cr2"}),h.default.createElement("path",{d:"M56.8,56.4c-0.8,0-1.4-0.6-1.4-1.4c0-13.5-6.8-24.4-12.9-25.8c-3.5-0.8-5.6,2-6.7,4.4c-0.3,0.7-1.2,1-1.9,0.7 c-0.7-0.3-1-1.2-0.7-1.9c2.2-4.7,5.8-6.9,9.9-6c9,2,15.1,16.4,15.1,28.6C58.3,55.7,57.6,56.4,56.8,56.4z",className:"cr3"}),h.default.createElement("path",{d:"M34.5,32.7c-0.2,0-0.3,0-0.5,0c-1.3-0.3-2.1-1.5-1.8-2.8c3.5-17.4,10.3-20.7,14-21.2c4.4-0.5,8.6,2.3,11,7.4 c0.6,1.2,0,2.6-1.1,3.1c-1.2,0.6-2.6,0-3.1-1.1c-1.5-3.2-3.8-5-6.1-4.7c-1.5,0.2-6.8,2-9.9,17.4C36.6,32,35.6,32.7,34.5,32.7z",className:"cr4"}))}}]),i}(h.Component);(0,c.default)(p,"propTypes",{height:d.default.string,colors:d.default.arrayOf(d.default.string)}),(0,c.default)(p,"defaultProps",{height:"16px",predefinedClassName:"point-layer-icon",totalColor:4});var g=p;e.default=g},9714:(t,e,n)=>{"use strict";var r=n(95709);Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.arcVisConfigs=e.arcColumnLabels=e.arcRequiredColumns=e.arcPosAccessor=void 0;var i=r(n(21259)),o=r(n(26396)),s=r(n(82274)),a=r(n(65044)),l=r(n(96220)),u=r(n(56994)),c=r(n(65611)),h=r(n(18337)),d=r(n(37576)),f=n(74704),p=n(23863),g=n(77244),y=r(n(30958)),m=n(13848);function v(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function b(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?v(Object(n),!0).forEach((function(e){(0,o.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var _=function(t){var e=t.lat0,n=t.lng0,r=t.lat1,i=t.lng1;return function(t){return function(o){return[t.valueAt(o.index,n.fieldIdx),t.valueAt(o.index,e.fieldIdx),0,t.valueAt(o.index,i.fieldIdx),t.valueAt(o.index,r.fieldIdx),0]}}};e.arcPosAccessor=_;var A=["lat0","lng0","lat1","lng1"];e.arcRequiredColumns=A;var x={lat0:"arc.lat0",lng0:"arc.lng0",lat1:"arc.lat1",lng1:"arc.lng1"};e.arcColumnLabels=x;var w={opacity:"opacity",thickness:"thickness",colorRange:"colorRange",sizeRange:"strokeWidthRange",targetColor:"targetColor"};e.arcVisConfigs=w;var C=function(t){(0,u.default)(o,t);var e,n,r=(e=o,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=(0,h.default)(e);if(n){var i=(0,h.default)(this).constructor;t=Reflect.construct(r,arguments,i)}else t=r.apply(this,arguments);return(0,c.default)(this,t)});function o(t){var e;return(0,s.default)(this,o),(e=r.call(this,t)).registerVisConfig(w),e.getPositionAccessor=function(t){return _(e.config.columns)(t)},e}return(0,a.default)(o,[{key:"type",get:function(){return"arc"}},{key:"isAggregated",get:function(){return!1}},{key:"layerIcon",get:function(){return y.default}},{key:"requiredLayerColumns",get:function(){return A}},{key:"columnLabels",get:function(){return x}},{key:"columnPairs",get:function(){return this.defaultLinkColumnPairs}},{key:"visualChannels",get:function(){return{sourceColor:b(b({},(0,l.default)((0,h.default)(o.prototype),"visualChannels",this).color),{},{property:"color",key:"sourceColor",accessor:"getSourceColor",defaultValue:function(t){return t.color}}),targetColor:b(b({},(0,l.default)((0,h.default)(o.prototype),"visualChannels",this).color),{},{property:"targetColor",key:"targetColor",accessor:"getTargetColor",defaultValue:function(t){return t.visConfig.targetColor||t.color}}),size:b(b({},(0,l.default)((0,h.default)(o.prototype),"visualChannels",this).size),{},{accessor:"getWidth",property:"stroke"})}}},{key:"calculateDataAttribute",value:function(t,e){t.dataContainer;for(var n=t.filteredIndex,r=[],i=0;i<n.length;i++){var o=n[i],s=e({index:o});s.every(Number.isFinite)&&r.push({index:o,sourcePosition:[s[0],s[1],s[2]],targetPosition:[s[3],s[4],s[5]]})}return r}},{key:"formatLayerData",value:function(t,e){if(null===this.config.dataId)return{};var n=t[this.config.dataId],r=n.gpuFilter,i=n.dataContainer,o=this.updateData(t,e).data,s=this.getAttributeAccessors({dataContainer:i});return b({data:o,getFilterValue:r.filterValueAccessor(i)()},s)}},{key:"updateLayerMeta",value:function(t){var e=this.getPositionAccessor(t),n=this.getPointsBounds(t,(function(t){var n=e(t);return[n[0],n[1]]})),r=this.getPointsBounds(t,(function(t){var n=e(t);return[n[3],n[4]]})),i=r&&n?[Math.min(n[0],r[0]),Math.min(n[1],r[1]),Math.max(n[2],r[2]),Math.max(n[3],r[3])]:n||r;this.updateMeta({bounds:i})}},{key:"renderLayer",value:function(t){var e=t.data,n=t.gpuFilter,r=t.objectHovered,o=t.interactionConfig,s=b({getPosition:this.config.columns,getFilterValue:n.filterValueUpdateTriggers},this.getVisualChannelUpdateTriggers()),a=this.config.visConfig.thickness*m.PROJECTED_PIXEL_SIZE_MULTIPLIER,l=this.getDefaultDeckLayerProps(t),u=this.hasHoveredObject(r);return[new p.ArcLayer(b(b(b(b({},l),this.getBrushingExtensionProps(o,"source_target")),e),{},{widthScale:a,updateTriggers:s,extensions:[].concat((0,i.default)(l.extensions),[new f.BrushingExtension])}))].concat((0,i.default)(u?[new p.ArcLayer(b(b({},this.getDefaultHoverLayerProps()),{},{visible:l.visible,data:[u],widthScale:a,getSourceColor:this.config.highlightColor,getTargetColor:this.config.highlightColor,getWidth:e.getWidth}))]:[]))}}],[{key:"findDefaultLayerProps",value:function(t){var e=t.fieldPairs,n=void 0===e?[]:e;return n.length<2?{props:[]}:{props:[{color:(0,g.hexToRgb)(m.DEFAULT_LAYER_COLOR.tripArc),columns:{lat0:n[0].pair.lat,lng0:n[0].pair.lng,lat1:n[1].pair.lat,lng1:n[1].pair.lng},label:"".concat(n[0].defaultName," -> ").concat(n[1].defaultName," arc")}]}}}]),o}(d.default);e.default=C},37576:(t,e,n)=>{"use strict";var r=n(95709);Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.colorMaker=e.layerColors=e.OVERLAY_TYPE_CONST=e.LAYER_ID_LENGTH=void 0;var i=r(n(21259)),o=r(n(22056)),s=r(n(85735)),a=r(n(82274)),l=r(n(65044)),u=r(n(26396)),c=r(n(92207)),h=n(89840),d=r(n(25499)),f=n(74704),p=n(98265),g=n(23863),y=r(n(60164)),m=n(3372),v=n(13848),b=n(77244);function _(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function A(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?_(Object(n),!0).forEach((function(e){(0,u.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var x=c.default.mark(T);e.LAYER_ID_LENGTH=6;var w=[0,1],C=new f.DataFilterExtension({filterSize:v.MAX_GPU_FILTERS}),S=function(t){return function(t){return t}},E=function(t,e){return t.valueAccessor(e)},M=(0,d.default)({deckgl:null,mapboxgl:null});e.OVERLAY_TYPE_CONST=M;var P=Object.values(v.DataVizColors).map(b.hexToRgb);function T(){var t;return c.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=0;case 1:if(!(t<P.length+1)){e.next=7;break}return t===P.length&&(t=0),e.next=5,P[t++];case 5:e.next=1;break;case 7:case"end":return e.stop()}}),x)}e.layerColors=P;var O=T();e.colorMaker=O;var I=function(){function t(e){(0,a.default)(this,t),(0,u.default)(this,"id",void 0),(0,u.default)(this,"meta",void 0),(0,u.default)(this,"visConfigSettings",void 0),(0,u.default)(this,"config",void 0),(0,u.default)(this,"_oldDataUpdateTriggers",void 0),(0,u.default)(this,"isValid",void 0),(0,u.default)(this,"errorMessage",void 0),this.id=e.id||(0,b.generateHashId)(6),this.meta={},this.visConfigSettings={},this.config=this.getDefaultLayerConfig(A({columns:this.getLayerColumns()},e)),this.isValid=!0,this.errorMessage=null}return(0,l.default)(t,[{key:"layerIcon",get:function(){return y.default}},{key:"overlayType",get:function(){return M.deckgl}},{key:"type",get:function(){return null}},{key:"name",get:function(){return this.type}},{key:"isAggregated",get:function(){return!1}},{key:"requiredLayerColumns",get:function(){return[]}},{key:"optionalColumns",get:function(){return[]}},{key:"noneLayerDataAffectingProps",get:function(){return["label","opacity","thickness","isVisible","hidden"]}},{key:"visualChannels",get:function(){return{color:{property:"color",field:"colorField",scale:"colorScale",domain:"colorDomain",range:"colorRange",key:"color",channelScaleType:v.CHANNEL_SCALES.color,nullValue:v.NO_VALUE_COLOR,defaultValue:function(t){return t.color}},size:{property:"size",field:"sizeField",scale:"sizeScale",domain:"sizeDomain",range:"sizeRange",key:"size",channelScaleType:v.CHANNEL_SCALES.size,nullValue:0,defaultValue:1}}}},{key:"columnValidators",get:function(){return{}}},{key:"columnPairs",get:function(){return null}},{key:"defaultPointColumnPairs",get:function(){return{lat:{pair:"lng",fieldPairKey:"lat"},lng:{pair:"lat",fieldPairKey:"lng"}}}},{key:"defaultLinkColumnPairs",get:function(){return{lat0:{pair:"lng0",fieldPairKey:"lat"},lng0:{pair:"lat0",fieldPairKey:"lng"},lat1:{pair:"lng1",fieldPairKey:"lat"},lng1:{pair:"lat1",fieldPairKey:"lng"}}}},{key:"layerInfoModal",get:function(){return null}},{key:"supportedDatasetTypes",get:function(){return null}},{key:"getDefaultLayerConfig",value:function(t){return{dataId:t.dataId,label:t.label||v.DEFAULT_LAYER_LABEL,color:t.color||O.next().value,columns:t.columns||{},isVisible:t.isVisible||!1,isConfigActive:t.isConfigActive||!1,highlightColor:t.highlightColor||v.DEFAULT_HIGHLIGHT_COLOR,hidden:t.hidden||!1,colorField:null,colorDomain:[0,1],colorScale:v.SCALE_TYPES.quantile,sizeDomain:[0,1],sizeScale:v.SCALE_TYPES.linear,sizeField:null,visConfig:{},textLabel:[v.DEFAULT_TEXT_LABEL],colorUI:{color:v.DEFAULT_COLOR_UI,colorRange:v.DEFAULT_COLOR_UI},animation:{enabled:!1}}}},{key:"getVisualChannelDescription",value:function(t){var e=this.visualChannels[t];if(!e)return{label:"",measure:void 0};var n=this.visConfigSettings[e.range],r=this.config[e.field],i=null==n?void 0:n.label;return{label:"function"==typeof i?i(this.config):i||"",measure:r?r.displayName||r.name:e.defaultMeasure}}},{key:"assignColumn",value:function(t,e){var n=e?{value:e.name,fieldIdx:e.fieldIdx}:{value:null,fieldIdx:-1};return A(A({},this.config.columns),{},(0,u.default)({},t,A(A({},this.config.columns[t]),n)))}},{key:"assignColumnPairs",value:function(t,e){var n,r,i,o;if(!this.columnPairs||null===(n=this.columnPairs)||void 0===n||!n[t])return this.config.columns;var s=null===(r=this.columnPairs)||void 0===r?void 0:r[t],a=s.pair,l=s.fieldPairKey;if(!e[l])return this.config.columns;var c=(null===(i=this.columnPairs)||void 0===i?void 0:i[a]).fieldPairKey;return A(A({},this.config.columns),{},(o={},(0,u.default)(o,t,e[l]),(0,u.default)(o,a,e[c]),o))}},{key:"getZoomFactor",value:function(t){var e=t.zoom,n=t.zoomOffset,r=void 0===n?0:n;return Math.pow(2,Math.max(14-e+r,0))}},{key:"getElevationZoomFactor",value:function(t){var e=t.zoom,n=t.zoomOffset,r=void 0===n?0:n;return this.config.visConfig.enableElevationZoomFactor?Math.pow(2,Math.max(8-e+r,0)):1}},{key:"formatLayerData",value:function(t,e){return{}}},{key:"renderLayer",value:function(){return[]}},{key:"getHoverData",value:function(t,e,n){return t?e.row(t.index):null}},{key:"assignConfigToLayer",value:function(t,e){var n=this,r=["colorRange","strokeColorRange"].concat(Object.values(this.visualChannels).map((function(t){return t.field}))),i=["animation"].concat(Object.values(this.visualChannels).map((function(t){return t.domain})));Object.values(this.visualChannels).forEach((function(r){t.visConfig[r.range]&&n.visConfigSettings[r.range]&&e[r.range].group!==n.visConfigSettings[r.range].group&&i.push(r.range)}));var o=this.config,s=this.copyLayerConfig(o,t,{shallowCopy:r,notToCopy:i});this.updateLayerConfig(s),Object.keys(this.visualChannels).forEach((function(t){n.validateVisualChannel(t)}))}},{key:"copyLayerConfig",value:function(t,e){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=r.shallowCopy,o=void 0===i?[]:i,s=r.notToCopy,a=void 0===s?[]:s,l={};return Object.keys(t).forEach((function(r){(0,b.isPlainObject)(t[r])&&(0,b.isPlainObject)(e[r])&&!o.includes(r)&&!a.includes(r)?l[r]=n.copyLayerConfig(t[r],e[r],{shallowCopy:o,notToCopy:a}):(0,b.notNullorUndefined)(e[r])&&!a.includes(r)?l[r]=e[r]:l[r]=t[r]})),l}},{key:"registerVisConfig",value:function(t){var e=this;Object.keys(t).forEach((function(n){var r=t[n];"string"==typeof r&&v.LAYER_VIS_CONFIGS[r]?(e.config.visConfig[n]=v.LAYER_VIS_CONFIGS[r].defaultValue,e.visConfigSettings[n]=v.LAYER_VIS_CONFIGS[r]):"object"===(0,s.default)(r)&&["type","defaultValue"].every((function(t){return r.hasOwnProperty(t)}))&&(e.config.visConfig[n]=r.defaultValue,e.visConfigSettings[n]=r)}))}},{key:"getLayerColumns",value:function(){var t=this.columnValidators,e=this.requiredLayerColumns.reduce((function(e,n){return A(A({},e),{},(0,u.default)({},n,t[n]?{value:null,fieldIdx:-1,validator:t[n]}:{value:null,fieldIdx:-1}))}),{}),n=this.optionalColumns.reduce((function(t,e){return A(A({},t),{},(0,u.default)({},e,{value:null,fieldIdx:-1,optional:!0}))}),{});return A(A({},e),n)}},{key:"updateLayerConfig",value:function(t){return this.config=A(A({},this.config),t),this}},{key:"updateLayerVisConfig",value:function(t){return this.config.visConfig=A(A({},this.config.visConfig),t),this}},{key:"updateLayerColorUI",value:function(t,e){var n=this.config,r=n.colorUI,i=n.visConfig;if(!(0,b.isPlainObject)(e)||"string"!=typeof t)return this;var s=Object.entries(e).reduce((function(t,e){var n=(0,o.default)(e,2),r=n[0],i=n[1];return A(A({},t),{},(0,u.default)({},r,(0,b.isPlainObject)(t[r])&&(0,b.isPlainObject)(i)?A(A({},t[r]),i):i))}),r[t]||v.DEFAULT_COLOR_UI),a=A(A({},r),{},(0,u.default)({},t,s));return this.updateLayerConfig({colorUI:a}),i[t]&&i[t].colors&&(this.updateColorUIByColorRange(e,t),this.updateColorRangeByColorUI(e,r,t),this.updateCustomPalette(e,r,t)),this}},{key:"updateCustomPalette",value:function(t,e,n){if(t.colorRangeConfig&&t.colorRangeConfig.custom){var r=this.config,o=r.colorUI,s=r.visConfig;if(s[n]){var a=s[n].colors,l=A(A({},o[n].customPalette),{},{name:"Custom Palette",colors:(0,i.default)(a)});this.updateLayerConfig({colorUI:A(A({},o),{},(0,u.default)({},n,A(A({},o[n]),{},{customPalette:l})))})}}}},{key:"updateColorUIByColorRange",value:function(t,e){if("number"==typeof t.showDropdown){var n=this.config,r=n.colorUI,i=n.visConfig;this.updateLayerConfig({colorUI:A(A({},r),{},(0,u.default)({},e,A(A({},r[e]),{},{colorRangeConfig:A(A({},r[e].colorRangeConfig),{},{steps:i[e].colors.length,reversed:Boolean(i[e].reversed)})})))})}}},{key:"updateColorRangeByColorUI",value:function(t,e,n){if(t.colorRangeConfig&&["reversed","steps"].some((function(r){return t.colorRangeConfig.hasOwnProperty(r)&&t.colorRangeConfig[r]!==(e[n]||v.DEFAULT_COLOR_UI).colorRangeConfig[r]}))){var r,i=this.config,o=i.colorUI,s=i.visConfig,a=o[n].colorRangeConfig,l=a.steps,c=a.reversed,h=s[n];if(t.colorRangeConfig.hasOwnProperty("steps")){var d=(0,b.getColorGroupByName)(h);d&&(r=v.COLOR_RANGES.filter((function(t){return(0,b.getColorGroupByName)(t)===d})).find((function(t){return t.colors.length===l})))&&h.reversed&&(r=(0,b.reverseColorRange)(!0,r))}t.colorRangeConfig.hasOwnProperty("reversed")&&(r=(0,b.reverseColorRange)(c,r||h)),r&&this.updateLayerVisConfig((0,u.default)({},n,r))}}},{key:"hasAllColumns",value:function(){var t=this.config.columns;return t&&Object.values(t).every((function(t){return Boolean(t&&(t.optional||t.value&&t.fieldIdx>-1))}))}},{key:"hasLayerData",value:function(t){return!!t&&Boolean(t.data&&t.data.length)}},{key:"isValidToSave",value:function(){return Boolean(this.type&&this.hasAllColumns())}},{key:"shouldRenderLayer",value:function(t){return Boolean(this.type)&&this.hasAllColumns()&&this.hasLayerData(t)&&"function"==typeof this.renderLayer}},{key:"getColorScale",value:function(t,e,n){if(Array.isArray(n.colorMap)){var r=new Map;return n.colorMap.forEach((function(t){var e=(0,o.default)(t,2),n=e[0],i=e[1];r.set(n,"string"==typeof i?(0,b.hexToRgb)(i):i)})),v.SCALE_FUNC[v.SCALE_TYPES.ordinal]().domain(r.keys()).range(r.values()).unknown(r.get(v.UNKNOWN_COLOR_KEY)||v.NO_VALUE_COLOR)}return this.getVisChannelScale(t,e,n.colors.map(b.hexToRgb))}},{key:"getAttributeAccessors",value:function(t){var e=this,n=t.dataAccessor,r=void 0===n?S:n,i=t.dataContainer,o={};return Object.keys(this.visualChannels).forEach((function(t){var n=e.visualChannels[t],s=n.field,a=n.fixed,l=n.scale,u=n.domain,c=n.range,d=n.accessor,f=n.defaultValue,p=n.getAttributeValue,g=n.nullValue,y=n.channelScaleType;if(d){if(e.config[s]){var m=a&&e.config.visConfig[a],b=y===v.CHANNEL_SCALES.color?e.getColorScale(e.config[l],e.config[u],e.config.visConfig[c]):e.getVisChannelScale(e.config[l],e.config[u],e.config.visConfig[c],m);o[d]=function(t){return e.getEncodedChannelValue(b,r(i)(t),e.config[s],g)}}else o[d]="function"==typeof p?p(e.config):"function"==typeof f?f(e.config):f;o[d]||h.console.warn("Failed to provide accessor function for ".concat(d||t))}})),o}},{key:"getVisChannelScale",value:function(t,e,n,r){return v.SCALE_FUNC[r?"linear":t]().domain(e).range(r?e:n)}},{key:"getPointsBounds",value:function(t,e){var n=t.numRows()>5e3?(0,b.getSampleContainerData)(t,5e3):t,r=e?n.mapIndex(e):[],i=(0,b.getLatLngBounds)(r,1,[-90,90]),o=(0,b.getLatLngBounds)(r,0,[-180,180]);return i&&o?[o[0],i[0],o[1],i[1]]:null}},{key:"getChangedTriggers",value:function(t){var e=(0,m.diffUpdateTriggers)(t,this._oldDataUpdateTriggers);return this._oldDataUpdateTriggers=t,e}},{key:"getEncodedChannelValue",value:function(t,e,n){var r,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:v.NO_VALUE_COLOR,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:E,s=n.type,a=o(n,e);return(0,b.notNullorUndefined)(a)?(r=s===v.ALL_FIELD_TYPES.timestamp?t(new Date(a)):t(a),(0,b.notNullorUndefined)(r)||(r=i),r):i}},{key:"updateMeta",value:function(t){this.meta=A(A({},this.meta),t)}},{key:"getDataUpdateTriggers",value:function(t){var e=t.filteredIndex,n=t.id,r=t.dataContainer,i=this.config.columns;return A({getData:{datasetId:n,dataContainer:r,columns:i,filteredIndex:e},getMeta:{datasetId:n,dataContainer:r,columns:i}},(this.config.textLabel||[]).reduce((function(t,e,n){return A(A({},t),{},(0,u.default)({},"getLabelCharacterSet-".concat(n),e.field?e.field.name:null))}),{}))}},{key:"updateData",value:function(t,e){if(!this.config.dataId)return{};var n=t[this.config.dataId],r=n.dataContainer,i=this.getPositionAccessor(r),o=this.getDataUpdateTriggers(n),s=this.getChangedTriggers(o);return s&&(s.getMeta||s.getData)&&this.updateLayerMeta(r,i),{data:s&&s.getData||!e||!e.data?this.calculateDataAttribute(n,i):e.data,triggerChanged:s}}},{key:"updateLayerDomain",value:function(t,e){var n=this,r=this.getDataset(t);return r?(Object.values(this.visualChannels).forEach((function(t){var i=t.scale,o=n.config[i];if(!e||o!==v.SCALE_TYPES.ordinal){var s=t.domain,a=n.calculateLayerDomain(r,t);n.updateLayerConfig((0,u.default)({},s,a))}})),this):this}},{key:"getDataset",value:function(t){return this.config.dataId?t[this.config.dataId]:null}},{key:"validateVisualChannel",value:function(t){this.validateFieldType(t),this.validateScale(t)}},{key:"validateFieldType",value:function(t){var e=this.visualChannels[t],n=e.field,r=e.channelScaleType,i=e.supportedFieldTypes;this.config[n]&&((i||v.CHANNEL_SCALE_SUPPORTED_FIELDS[r]).includes(this.config[n].type)||this.updateLayerConfig((0,u.default)({},n,null)))}},{key:"validateScale",value:function(t){var e=this.visualChannels[t].scale;if(e){var n=this.getScaleOptions(t);n.includes(this.config[e])||this.updateLayerConfig((0,u.default)({},e,n[0]))}}},{key:"getScaleOptions",value:function(t){var e=this.visualChannels[t],n=e.field,r=e.scale,i=e.channelScaleType;return this.config[n]?v.FIELD_OPTS[this.config[n].type].scale[i]:[this.getDefaultLayerConfig({dataId:""})[r]]}},{key:"updateLayerVisualChannel",value:function(t,e){var n=this.visualChannels[e];this.validateVisualChannel(e);var r=this.calculateLayerDomain(t,n);this.updateLayerConfig((0,u.default)({},n.domain,r))}},{key:"getVisualChannelUpdateTriggers",value:function(){var t=this,e={};return Object.values(this.visualChannels).forEach((function(n){var r,i=n.accessor,o=n.field,s=n.scale,a=n.domain,l=n.range,c=n.defaultValue,h=n.fixed;i&&(e[i]=A((r={},(0,u.default)(r,o,t.config[o]),(0,u.default)(r,s,t.config[s]),(0,u.default)(r,a,t.config[a]),(0,u.default)(r,l,t.config.visConfig[l]),(0,u.default)(r,"defaultValue","function"==typeof c?c(t.config):c),r),h?(0,u.default)({},h,t.config.visConfig[h]):{}))})),e}},{key:"calculateLayerDomain",value:function(t,e){var n=e.scale,r=this.config[n],i=this.config[e.field];return i&&t.getColumnLayerDomain(i,r)||w}},{key:"hasHoveredObject",value:function(t){return this.isLayerHovered(t)&&t.object?t.object:null}},{key:"isLayerHovered",value:function(t){var e,n;return(null==t?void 0:t.picked)&&(null==t||null===(e=t.layer)||void 0===e||null===(n=e.props)||void 0===n?void 0:n.id)===this.id}},{key:"getRadiusScaleByZoom",value:function(t,e){var n=Object.values(this.visualChannels).find((function(t){return"radius"===t.property}));if(!n)return 1;var r=n.field,i=void 0===e?this.config.visConfig.fixedRadius:e,o=this.config.visConfig.radius;return i?1:(this.config[r]?1:o)*this.getZoomFactor(t)}},{key:"shouldCalculateLayerData",value:function(t){var e=this;return t.some((function(t){return!e.noneLayerDataAffectingProps.includes(t)}))}},{key:"getBrushingExtensionProps",value:function(t,e){var n=t.brush;return{autoHighlight:!n.enabled,brushingRadius:1e3*n.config.size,brushingTarget:e||"source",brushingEnabled:n.enabled}}},{key:"getDefaultDeckLayerProps",value:function(t){var e=t.idx,n=t.gpuFilter,r=t.mapState,i=t.visible;return{id:this.id,idx:e,coordinateSystem:p.COORDINATE_SYSTEM.LNGLAT,pickable:!0,wrapLongitude:!0,parameters:{depthTest:Boolean(r.dragRotate||this.config.visConfig.enable3d)},hidden:this.config.hidden,opacity:this.config.visConfig.opacity,highlightColor:this.config.highlightColor,extensions:[C],filterRange:n?n.filterRange:void 0,visible:this.config.isVisible&&i}}},{key:"getDefaultHoverLayerProps",value:function(){return{id:"".concat(this.id,"-hovered"),pickable:!1,wrapLongitude:!0,coordinateSystem:p.COORDINATE_SYSTEM.LNGLAT}}},{key:"renderTextLabelLayer",value:function(t,e){var n=this,r=t.getPosition,i=t.getPixelOffset,o=t.backgroundProps,s=t.updateTriggers,a=t.sharedProps,l=e.data,u=e.mapState,c=this.config.textLabel;return l.textLabels.reduce((function(t,e,h){if(e.getText){var d,f,p=c[h].background||(null==o?void 0:o.background);t.push(new g.TextLayer(A(A({},a),{},{id:"".concat(n.id,"-label-").concat(null===(d=c[h].field)||void 0===d?void 0:d.name),data:l.data,visible:n.config.isVisible,getText:e.getText,getPosition:r,characterSet:e.characterSet,getPixelOffset:i(c[h]),getSize:v.PROJECTED_PIXEL_SIZE_MULTIPLIER,sizeScale:c[h].size,getTextAnchor:c[h].anchor,getAlignmentBaseline:c[h].alignment,getColor:c[h].color,outlineWidth:c[h].outlineWidth*v.TEXT_OUTLINE_MULTIPLIER,outlineColor:c[h].outlineColor,background:p,getBackgroundColor:c[h].backgroundColor,fontSettings:{sdf:c[h].outlineWidth>0},parameters:{depthTest:!1},getFilterValue:l.getFilterValue,updateTriggers:A(A({},s),{},{getText:null===(f=c[h].field)||void 0===f?void 0:f.name,getPixelOffset:A(A({},s.getRadius),{},{mapState:u,anchor:c[h].anchor,alignment:c[h].alignment}),getTextAnchor:c[h].anchor,getAlignmentBaseline:c[h].alignment,getColor:c[h].color}),_subLayerProps:A({},p?{background:{parameters:{cull:!1}}}:null)})))}return t}),[])}},{key:"calculateDataAttribute",value:function(t,e){return[]}},{key:"updateLayerMeta",value:function(t,e){}},{key:"getPositionAccessor",value:function(t){return function(){return null}}}],[{key:"findDefaultLayerProps",value:function(t,e){return{props:[],foundLayers:e}}},{key:"findDefaultColumnField",value:function(t,e){var n=Object.keys(t).reduce((function(n,r){var i=e.filter((function(e){return e.name===t[r]||t[r].includes(e.name)}));return n[r]=i.length?i.map((function(t){return{value:t.name,fieldIdx:t.fieldIdx}})):null,n}),{});return Object.values(n).every(Boolean)?this.getAllPossibleColumnParis(n):null}},{key:"getAllPossibleColumnParis",value:function(t){for(var e=Object.keys(t),n=e.map((function(t,n){return n===e.length-1?-1:0})),r=e.map((function(e){return t[e].length})),i=[];s(n,r,n.length-1);){var o=n.reduce((function(n,r,i){return n[e[i]]=t[e[i]][r],n}),{});i.push(o)}function s(t,e,n){return(0!==n||t[0]!==e[0]-1)&&(t[n]+1<e[n]?(t[n]=t[n]+1,!0):(t[n]=0,s(t,e,n-1)))}return i}},{key:"hexToRgb",value:function(t){return(0,b.hexToRgb)(t)}}]),t}();e.default=I},32268:(t,e,n)=>{"use strict";var r=n(58784),i=n(95709);Object.defineProperty(e,"__esModule",{value:!0}),e.Base=void 0;var o=i(n(16193)),s=i(n(39892)),a=i(n(82274)),l=i(n(65044)),u=i(n(56994)),c=i(n(65611)),h=i(n(18337)),d=i(n(26396)),f=r(n(93345));var p=function(){},g=function(t){(0,u.default)(i,t);var e,n,r=(e=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=(0,h.default)(e);if(n){var i=(0,h.default)(this).constructor;t=Reflect.construct(r,arguments,i)}else t=r.apply(this,arguments);return(0,c.default)(this,t)});function i(){return(0,a.default)(this,i),r.apply(this,arguments)}return(0,l.default)(i,[{key:"render",value:function(){var t=this.props,e=t.height,n=t.width,r=t.viewBox,i=t.style,a=t.children,l=t.predefinedClassName,u=t.className,c=t.colors,h=t.totalColor,d=(0,s.default)(t,["height","width","viewBox","style","children","predefinedClassName","className","colors","totalColor"]),g=e,y=n||g,m=Array.isArray(c)&&h&&function(t,e){return new Array(t).fill(1).reduce((function(t,n,r){return"".concat(t,".cr").concat(r+1," {fill:").concat(e[r%e.length],";}")}),"")}(h,c);return f.default.createElement("svg",(0,o.default)({viewBox:r,width:y,height:g,style:i,className:"".concat(l," ").concat(u),onClick:p},d),m?f.default.createElement("style",{type:"text/css"},m):null,a)}}]),i}(f.Component);e.Base=g,(0,d.default)(g,"displayName","Base Icon"),(0,d.default)(g,"defaultProps",{height:null,width:null,viewBox:"0 0 64 64",predefinedClassName:"",className:"",style:{fill:"currentColor"}})},65150:(t,e,n)=>{"use strict";var r=n(58784),i=n(95709);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=i(n(82274)),s=i(n(65044)),a=i(n(56994)),l=i(n(65611)),u=i(n(18337)),c=i(n(26396)),h=r(n(93345)),d=i(n(5556)),f=n(32268);var p=function(t){(0,a.default)(i,t);var e,n,r=(e=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=(0,u.default)(e);if(n){var i=(0,u.default)(this).constructor;t=Reflect.construct(r,arguments,i)}else t=r.apply(this,arguments);return(0,l.default)(this,t)});function i(){return(0,o.default)(this,i),r.apply(this,arguments)}return(0,s.default)(i,[{key:"render",value:function(){return h.default.createElement(f.Base,this.props,h.default.createElement("path",{d:"M13.6,22.7c2.9-3.6,4.4-6.3,4.4-8c0-2.7-2.2-4.9-4.9-4.9S8.2,12,8.2,14.7c0,1.7,1.5,4.4,4.4,8l0,0 C12.8,23,13.2,23,13.6,22.7C13.5,22.8,13.6,22.7,13.6,22.7z",className:"cr1"}),h.default.createElement("path",{d:"M22.9,57.4c2.5-3.1,3.8-5.5,3.8-7c0-2.4-2-4.4-4.4-4.4S18,48,18,50.4c0,1.5,1.3,3.8,3.8,7l0,0 c0.3,0.3,0.7,0.4,1,0.1C22.9,57.4,22.9,57.4,22.9,57.4z",className:"cr2"}),h.default.createElement("path",{d:"M51.4,22.5c2.8-3.4,4.2-6,4.2-7.6c0-2.6-2.1-4.8-4.8-4.8c-2.6,0-4.8,2.1-4.8,4.8c0,1.6,1.4,4.2,4.2,7.6 l0,0c0.3,0.3,0.8,0.4,1.1,0.1C51.3,22.5,51.4,22.5,51.4,22.5z",className:"cr3"}),h.default.createElement("path",{d:"M49.2,53.8c3.7-4.5,5.5-7.8,5.5-9.9c0-3.3-2.7-6.1-6.1-6.1c-3.3,0-6.1,2.7-6.1,6.1 c0,2.1,1.8,5.4,5.5,9.9l0,0c0.3,0.3,0.7,0.4,1.1,0.1C49.1,53.8,49.1,53.8,49.2,53.8z",className:"cr4"}),h.default.createElement("path",{d:"M31.4,39.6C36.5,33.5,39,29,39,26.1c0-4.4-3.6-8-8-8s-8,3.6-8,8c0,2.9,2.5,7.4,7.6,13.5l0,0 C30.8,39.8,31.1,39.9,31.4,39.6C31.3,39.7,31.4,39.6,31.4,39.6z",className:"cr5"}))}}]),i}(h.Component);(0,c.default)(p,"propTypes",{height:d.default.string,colors:d.default.arrayOf(d.default.string)}),(0,c.default)(p,"defaultProps",{height:"16px",predefinedClassName:"cluster-layer-icon",totalColor:5});var g=p;e.default=g},65154:(t,e,n)=>{"use strict";var r=n(95709);Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.clusterVisConfigs=void 0;var i=r(n(21259)),o=r(n(39892)),s=r(n(26396)),a=r(n(82274)),l=r(n(65044)),u=r(n(56994)),c=r(n(65611)),h=r(n(18337)),d=r(n(39095)),f=n(23863),p=n(29294),g=r(n(65150)),y=n(13848);function m(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function v(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?m(Object(n),!0).forEach((function(e){(0,s.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var b={opacity:"opacity",clusterRadius:"clusterRadius",colorRange:"colorRange",radiusRange:"clusterRadiusRange",colorAggregation:"colorAggregation"};e.clusterVisConfigs=b;var _=function(t){(0,u.default)(s,t);var e,n,r=(e=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=(0,h.default)(e);if(n){var i=(0,h.default)(this).constructor;t=Reflect.construct(r,arguments,i)}else t=r.apply(this,arguments);return(0,c.default)(this,t)});function s(t){var e;return(0,a.default)(this,s),(e=r.call(this,t)).registerVisConfig(b),e.getPointData=function(t){return t},e}return(0,l.default)(s,[{key:"type",get:function(){return"cluster"}},{key:"layerIcon",get:function(){return g.default}},{key:"visualChannels",get:function(){return{color:{aggregation:"colorAggregation",channelScaleType:y.CHANNEL_SCALES.colorAggr,defaultMeasure:"property.pointCount",domain:"colorDomain",field:"colorField",key:"color",property:"color",range:"colorRange",scale:"colorScale"}}}},{key:"renderLayer",value:function(t){var e=this.config.visConfig,n=t.data,r=t.gpuFilter,s=t.objectHovered,a=t.mapState,l=t.layerCallbacks,u={getColorValue:{colorField:this.config.colorField,colorAggregation:this.config.visConfig.colorAggregation},filterData:v({filterRange:r.filterRange},r.filterValueUpdateTriggers)},c=this.getDefaultDeckLayerProps(t),h=n._filterData,d=(0,o.default)(n,["_filterData"]),g=this.hasHoveredObject(s);return[new p.DeckGLClusterLayer(v(v(v({},c),d),{},{filterData:h,radiusScale:1,radiusRange:e.radiusRange,clusterRadius:e.clusterRadius,colorRange:this.getColorRange(e.colorRange),colorScaleType:this.config.colorScale,colorAggregation:e.colorAggregation,zoom:Math.round(a.zoom),width:a.width,height:a.height,updateTriggers:u,onSetColorDomain:l.onSetLayerDomain}))].concat((0,i.default)(g?[new f.ScatterplotLayer({id:"".concat(this.id,"-hovered"),visible:c.visible,data:[g],getFillColor:this.config.highlightColor,getRadius:function(t){return t.radius},radiusScale:1,pickable:!1})]:[]))}}]),s}(d.default);e.default=_},60164:(t,e,n)=>{"use strict";var r=n(58784),i=n(95709);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=i(n(82274)),s=i(n(65044)),a=i(n(56994)),l=i(n(65611)),u=i(n(18337)),c=i(n(26396)),h=r(n(93345)),d=i(n(5556)),f=n(32268);var p=function(t){(0,a.default)(i,t);var e,n,r=(e=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=(0,u.default)(e);if(n){var i=(0,u.default)(this).constructor;t=Reflect.construct(r,arguments,i)}else t=r.apply(this,arguments);return(0,l.default)(this,t)});function i(){return(0,o.default)(this,i),r.apply(this,arguments)}return(0,s.default)(i,[{key:"render",value:function(){return h.default.createElement(f.Base,this.props,h.default.createElement("circle",{cx:"29.4",cy:"31.6",r:"8.4"}),h.default.createElement("circle",{cx:"48.5",cy:"15.7",r:"6.5"}),h.default.createElement("circle",{cx:"11",cy:"44.2",r:"3"}),h.default.createElement("circle",{cx:"50",cy:"44.2",r:"5"}),h.default.createElement("circle",{cx:"34",cy:"54.2",r:"3"}),h.default.createElement("circle",{cx:"14",cy:"16.2",r:"4"}))}}]),i}(h.Component);(0,c.default)(p,"propTypes",{height:d.default.string,colors:d.default.arrayOf(d.default.string)}),(0,c.default)(p,"defaultProps",{height:"16px",predefinedClassName:"default-layer-icon"});var g=p;e.default=g},39886:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EDIT_TYPES=e.COLORS=void 0,e.COLORS={PRIMARY:[38,181,242],SECONDARY:[170,170,170],HIGHLIGHT:[255,255,0]},e.EDIT_TYPES={ADD_POSITION:"addPosition",MOVE_POSITION:"movePosition",TRANSLATING:"translating",ADD_FEATURE:"addFeature"}},36754:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.isDrawingActive=i,e.onClick=function(t,e,n){var o,s=n.editorMenuActive,a=n.editor,l=n.setSelectedFeature,u=n.onLayerClick,c=n.mapIndex,h=void 0===c?0:c,d=i(s,a.mode);if((null==t||null===(o=t.layer)||void 0===o?void 0:o.id)===r.EDITOR_LAYER_ID&&null!=t&&t.object){var f,p=null===(f=t.object.geometry)||void 0===f?void 0:f.type;if(d)a.selectedFeature&&l(null);else if(null!=p&&p.endsWith("Polygon")||null!=p&&p.endsWith("Point")){var g,y;if(e.rightButton&&Array.isArray(null===(g=e.srcEvent)||void 0===g?void 0:g.point)){var m=e.srcEvent.point;y={mapIndex:h,rightClick:!0,position:{x:m[0],y:m[1]}}}null!=p&&p.endsWith("Polygon")?l(t.object,y):l(a.selectedFeature,y)}u(null,e)}else{if(!d){if(a.selectedFeature){if(e.rightButton)return!0;l(null)}return!1}u(null,e)}return!0},e.onHover=function(t,e){var n,o,s=e.hoverInfo,a=e.editor;return!!i(e.editorMenuActive,a.mode)||(null==t||null===(n=t.layer)||void 0===n?void 0:n.id)===r.EDITOR_LAYER_ID&&(null==s||null===(o=s.layer)||void 0===o?void 0:o.id)===r.EDITOR_LAYER_ID},e.getTooltip=function(t,e){var n,l,u,c,h=e.editor,d=e.theme,f=e.editorMenuActive,p=t.object,g=t.layer,y=t.viewport,m=void 0===y?{}:y,v=t.pixel,b=void 0===v?[]:v,_=(null==m?void 0:m.width)-b[0]<o,A=(null==m?void 0:m.height)-b[1]<s;if(null!==(n=h.selectionContext)&&void 0!==n&&n.rightClick)return null;if(i(f,h.mode))return null!=g&&null!==(l=g.state)&&void 0!==l&&null!==(u=l.mode)&&void 0!==u&&null!==(c=u._clickSequence)&&void 0!==c&&c.length?null:a("Click to start new feature",d,{leftOfCursor:_,aboveCursor:A});if((null==g?void 0:g.id)===r.EDITOR_LAYER_ID){var x,w,C,S=h.selectedFeature;return S&&(!p||p.id&&p.id===S.id)?a("Right click to view options\nDrag to move the feature",d,{leftOfCursor:_,aboveCursor:A}):"intermediate"===(null==p||null===(x=p.properties)||void 0===x?void 0:x.editHandleType)?a("Click to insert a point",d,{leftOfCursor:_,aboveCursor:A}):"Point"===(null==p||null===(w=p.geometry)||void 0===w?void 0:w.type)||"tentative"===(null==p||null===(C=p.properties)||void 0===C?void 0:C.guideType)?a("Drag to move the point",d,{leftOfCursor:_,aboveCursor:A}):a("Click to select the feature\nRight click to view options",d,{leftOfCursor:_,aboveCursor:A})}return null},e.getCursor=function(t){var e,n=t.editorMenuActive,o=t.editor,s=t.hoverInfo;return i(n,o.mode)?"crosshair":(null==s||null===(e=s.layer)||void 0===e?void 0:e.id)===r.EDITOR_LAYER_ID&&o.selectedFeature?"move":null};var r=n(13848);function i(t,e){return t&&(e===r.EDITOR_MODES.DRAW_POLYGON||e===r.EDITOR_MODES.DRAW_RECTANGLE)}var o=200,s=100;function a(t,e,n){var r=n.leftOfCursor;return{text:t,style:{"margin-top":n.aboveCursor?"-70px":"15px","margin-left":r?"-200px":"15px","font-family":e.fontFamily,"font-size":e.tooltipFontSize,"font-weight":400,padding:"7px 18px","box-shadow":e.tooltipBoxShadow,"background-color":e.tooltipBg,color:e.tooltipColor,"border-radius":e.primaryBtnRadius}}}},51762:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getEditorLayer=function(t){var e=t.editorMenuActive,n=t.editor,c=t.onSetFeatures,f=t.setSelectedFeature,p=t.featureCollection,g=t.selectedFeatureIndexes,y=t.viewport,m=n.mode,v=d;return e&&(m===s.EDITOR_MODES.DRAW_POLYGON?v=i.DrawPolygonMode:m===s.EDITOR_MODES.DRAW_RECTANGLE&&(v=i.DrawRectangleMode)),new r.EditableGeoJsonLayer({id:s.EDITOR_LAYER_ID,mode:v,data:p,selectedFeatureIndexes:g,visible:n.visible,pickable:!0,pickingRadius:s.EDITOR_LAYER_PICKING_RADIUS,modeConfig:{viewport:y,screenSpace:!0,lockRectangles:!0},pickingLineWidthExtraPixels:5,filled:g.length>0,onEdit:function(t){var e=t.updatedData;switch(t.editType){case l.EDIT_TYPES.ADD_FEATURE:var n=e.features;if(n.length){var r=n[n.length-1];r.properties.isClosed=!0,r.id=(0,a.generateHashId)(6),c(e.features),f(r)}break;case l.EDIT_TYPES.ADD_POSITION:case l.EDIT_TYPES.MOVE_POSITION:case l.EDIT_TYPES.TRANSLATING:c(e.features)}},autoHighlight:!(0,h.isDrawingActive)(e,m),highlightColor:function(t){var e=t.object;if(e){var r;if(e.id===(null===(r=n.selectedFeature)||void 0===r?void 0:r.id))return u.FEATURE_STYLE.highlightMultiplierNone;var i=e.properties.editHandleType;if("intermediate"===i)return u.EDIT_HANDLE_STYLE.highlightMultiplierNone;if("existing"===i)return u.EDIT_HANDLE_STYLE.highlightMultiplier}return g.length?u.FEATURE_STYLE.highlightMultiplier:u.LINE_STYLE.highlightMultiplier},extensions:[new o.PathStyleExtension({dash:!0})],dashGapPickable:!0,getDashArray:function(t,e){var r,i;return"tentative"===(null==t||null===(r=t.properties)||void 0===r?void 0:r.guideType)?u.LINE_STYLE.dashArray:(null==t?void 0:t.id)===(null===(i=n.selectedFeature)||void 0===i?void 0:i.id)?u.LINE_STYLE.solidArray:u.LINE_STYLE.dashArray},getLineColor:u.LINE_STYLE.getColor,getFillColor:u.FEATURE_STYLE.getColor,getRadius:u.EDIT_HANDLE_STYLE.getRadius,getLineWidth:u.LINE_STYLE.getWidth,getEditHandlePointRadius:u.EDIT_HANDLE_STYLE.getRadius,getEditHandlePointColor:u.EDIT_HANDLE_STYLE.getFillColor,getEditHandlePointOutlineColor:u.EDIT_HANDLE_STYLE.getOutlineColor,getTentativeLineColor:u.LINE_STYLE.getTentativeLineColor,getTentativeLineWidth:u.LINE_STYLE.getTentativeLineWidth,getTentativeFillColor:u.LINE_STYLE.getTentativeFillColor,parameters:{}})};var r=n(75130),i=n(13343),o=n(74704),s=n(13848),a=n(77244),l=n(39886),u=n(43696),c=n(7035),h=n(36754),d=new i.CompositeMode([new i.TranslateMode,new c.ModifyModeExtended])},43696:(t,e,n)=>{"use strict";var r=n(95709);Object.defineProperty(e,"__esModule",{value:!0}),e.LINE_STYLE=e.FEATURE_STYLE=e.EDIT_HANDLE_STYLE=void 0;var i=r(n(21259)),o=n(39886),s=[].concat((0,i.default)(o.COLORS.PRIMARY),[26]),a=[].concat((0,i.default)(o.COLORS.PRIMARY),[255]),l=[].concat((0,i.default)(o.COLORS.SECONDARY),[0]),u=[].concat((0,i.default)(o.COLORS.SECONDARY),[255]),c=[].concat((0,i.default)(o.COLORS.SECONDARY),[13]),h={getRadius:5,getFillColor:l,getOutlineColor:function(t){var e;return(null==t||null===(e=t.properties)||void 0===e?void 0:e.featureIndex)<0?u:a},highlightMultiplier:[].concat((0,i.default)(o.COLORS.HIGHLIGHT),[128]),highlightMultiplierNone:l};e.EDIT_HANDLE_STYLE=h;var d={getColor:function(t,e){return e?s:l},highlightMultiplier:[].concat((0,i.default)(o.COLORS.HIGHLIGHT),[26]),highlightMultiplierNone:l};e.FEATURE_STYLE=d;var f={getColor:function(t,e,n){return a},getWidth:function(t,e,n){return e?2.5:2},getTentativeLineColor:function(t,e){return u},getTentativeLineWidth:function(t,e){return 2},getTentativeFillColor:c,dashArray:[4,3],solidArray:[0,0],highlightMultiplier:[].concat((0,i.default)(o.COLORS.HIGHLIGHT),[255])};e.LINE_STYLE=f},7035:(t,e,n)=>{"use strict";var r=n(95709);Object.defineProperty(e,"__esModule",{value:!0}),e.ModifyModeExtended=void 0;var i=r(n(82274)),o=r(n(65044)),s=r(n(96220)),a=r(n(56994)),l=r(n(65611)),u=r(n(18337)),c=n(13343),h=n(13848);var d=function(t){(0,a.default)(c,t);var e,n,r=(e=c,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=(0,u.default)(e);if(n){var i=(0,u.default)(this).constructor;t=Reflect.construct(r,arguments,i)}else t=r.apply(this,arguments);return(0,l.default)(this,t)});function c(){return(0,i.default)(this,c),r.apply(this,arguments)}return(0,o.default)(c,[{key:"getNearestPoint",value:function(t,e,n){var r=(0,s.default)((0,u.default)(c.prototype),"getNearestPoint",this).call(this,t,e,n);if(r&&n){var i=n.project(r.geometry.coordinates),o=n.project(e.geometry.coordinates);if(Math.sqrt(Math.pow(i[0]-o[0],2)+Math.pow(i[1]-o[1],2))>h.EDITOR_LAYER_PICKING_RADIUS)return}return r}},{key:"handleClick",value:function(t,e){var n;2!==(null==t||null===(n=t.sourceEvent)||void 0===n?void 0:n.button)&&(0,s.default)((0,u.default)(c.prototype),"handleClick",this).call(this,t,e)}}]),c}(c.ModifyMode);e.ModifyModeExtended=d},97958:(t,e,n)=>{"use strict";var r=n(58784),i=n(95709);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=i(n(82274)),s=i(n(65044)),a=i(n(56994)),l=i(n(65611)),u=i(n(18337)),c=i(n(26396)),h=r(n(93345)),d=i(n(5556)),f=n(32268);var p=function(t){(0,a.default)(i,t);var e,n,r=(e=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=(0,u.default)(e);if(n){var i=(0,u.default)(this).constructor;t=Reflect.construct(r,arguments,i)}else t=r.apply(this,arguments);return(0,l.default)(this,t)});function i(){return(0,o.default)(this,i),r.apply(this,arguments)}return(0,s.default)(i,[{key:"render",value:function(){return h.default.createElement(f.Base,this.props,h.default.createElement("polygon",{className:"cr1",points:"25.04 23.08 9.72 31.79 8.19 43.2 19.57 53.83 28.79 53.83 35.6 46.57 39.45 30.08 25.04 23.08"}),h.default.createElement("polygon",{className:"cr2",points:"52.8 26.3 41.74 30.32 37.9 46.75 45.26 53.83 51.45 53.83 55.07 43.51 52.8 26.3",style:{opacity:.8}}),h.default.createElement("polygon",{className:"cr3",points:"36.69 48.75 31.93 53.83 41.96 53.83 36.69 48.75",style:{opacity:.4}}),h.default.createElement("polygon",{className:"cr3",points:"25.95 20.98 40.84 28.22 52.57 24.06 50.89 11.5 23.24 11.5 25.95 20.98",style:{opacity:.4}}),h.default.createElement("polygon",{className:"cr4",points:"20.79 11.9 11.73 15.72 10.08 28.96 23.64 21.25 20.79 11.9",style:{opacity:.8}}))}}]),i}(h.Component);e.default=p,(0,c.default)(p,"propTypes",{height:d.default.string,colors:d.default.arrayOf(d.default.string)}),(0,c.default)(p,"defaultProps",{height:null,size:"tiny",predefinedClassName:"geojson-layer-icon"})},93658:(t,e,n)=>{"use strict";var r=n(95709),i=n(58784);Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.defaultRadius=e.defaultLineWidth=e.defaultElevation=e.featureAccessor=e.geoJsonRequiredColumns=e.geojsonVisConfigs=void 0;var o,s=r(n(39892)),a=r(n(21259)),l=r(n(22056)),u=r(n(82274)),c=r(n(65044)),h=r(n(41972)),d=r(n(96220)),f=r(n(56994)),p=r(n(65611)),g=r(n(18337)),y=r(n(26396)),m=n(26652),v=r(n(74960)),b=r(n(90879)),_=n(53214),A=i(n(37576)),x=n(23863),w=n(10962),C=n(80456),S=r(n(97958)),E=n(13848),M=n(77244),P=n(29294);function T(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function O(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?T(Object(n),!0).forEach((function(e){(0,y.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):T(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var I=(o={},(0,y.default)(o,_.DATA_TYPES.GEOMETRY,!0),(0,y.default)(o,_.DATA_TYPES.GEOMETRY_FROM_STRING,!0),(0,y.default)(o,_.DATA_TYPES.PAIR_GEOMETRY_FROM_STRING,!0),o),R={opacity:"opacity",strokeOpacity:O(O({},E.LAYER_VIS_CONFIGS.opacity),{},{property:"strokeOpacity"}),thickness:O(O({},E.LAYER_VIS_CONFIGS.thickness),{},{defaultValue:.5}),strokeColor:"strokeColor",colorRange:"colorRange",strokeColorRange:"strokeColorRange",radius:"radius",sizeRange:"strokeWidthRange",radiusRange:"radiusRange",heightRange:"elevationRange",elevationScale:"elevationScale",enableElevationZoomFactor:"enableElevationZoomFactor",stroked:"stroked",filled:"filled",enable3d:"enable3d",wireframe:"wireframe"};e.geojsonVisConfigs=R;var B=["geojson"];e.geoJsonRequiredColumns=B;var L=function(t){var e=t.geojson;return function(t){return function(n){return t.valueAt(n.index,e.fieldIdx)}}};e.featureAccessor=L;var k=function(t){var e=t.geojson;return function(t){var n;return null===(n=t.getColumn)||void 0===n?void 0:n.call(t,e.fieldIdx)}},D=function(t){var e=t.geojson;return function(t){return t.getField?t.getField(e.fieldIdx):null}};e.defaultElevation=500,e.defaultLineWidth=1,e.defaultRadius=1;var F=function(t){(0,f.default)(i,t);var e,n,r=(e=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=(0,g.default)(e);if(n){var i=(0,g.default)(this).constructor;t=Reflect.construct(r,arguments,i)}else t=r.apply(this,arguments);return(0,p.default)(this,t)});function i(t){var e;return(0,u.default)(this,i),e=r.call(this,t),(0,y.default)((0,h.default)(e),"dataToFeature",[]),(0,y.default)((0,h.default)(e),"dataContainer",null),(0,y.default)((0,h.default)(e),"filteredIndex",null),(0,y.default)((0,h.default)(e),"filteredIndexTrigger",null),(0,y.default)((0,h.default)(e),"centroids",[]),e.registerVisConfig(R),e.getPositionAccessor=function(t){return L(e.config.columns)(t)},e}return(0,c.default)(i,[{key:"type",get:function(){return i.type}},{key:"name",get:function(){return"Polygon"}},{key:"layerIcon",get:function(){return S.default}},{key:"requiredLayerColumns",get:function(){return B}},{key:"visualChannels",get:function(){var t=(0,d.default)((0,g.default)(i.prototype),"visualChannels",this);return{color:O(O({},t.color),{},{accessor:"getFillColor",condition:function(t){return t.visConfig.filled},nullValue:t.color.nullValue,getAttributeValue:function(t){return function(e){return e.properties.fillColor||t.color}},defaultValue:function(t){return t.color}}),strokeColor:{property:"strokeColor",field:"strokeColorField",scale:"strokeColorScale",domain:"strokeColorDomain",range:"strokeColorRange",key:"strokeColor",channelScaleType:E.CHANNEL_SCALES.color,accessor:"getLineColor",condition:function(t){return t.visConfig.stroked},nullValue:t.color.nullValue,getAttributeValue:function(t){return function(e){return e.properties.lineColor||t.visConfig.strokeColor||t.color}},defaultValue:function(t){return t.visConfig.strokeColor||t.color}},size:O(O({},t.size),{},{property:"stroke",accessor:"getLineWidth",condition:function(t){return t.visConfig.stroked},nullValue:0,getAttributeValue:function(){return function(t){return t.properties.lineWidth||1}}}),height:{property:"height",field:"heightField",scale:"heightScale",domain:"heightDomain",range:"heightRange",key:"height",channelScaleType:E.CHANNEL_SCALES.size,accessor:"getElevation",condition:function(t){return t.visConfig.enable3d},nullValue:0,getAttributeValue:function(){return function(t){return t.properties.elevation||500}}},radius:{property:"radius",field:"radiusField",scale:"radiusScale",domain:"radiusDomain",range:"radiusRange",key:"radius",channelScaleType:E.CHANNEL_SCALES.radius,accessor:"getPointRadius",nullValue:0,getAttributeValue:function(){return function(t){return t.properties.radius||1}}}}}},{key:"getDefaultLayerConfig",value:function(t){return O(O({},(0,d.default)((0,g.default)(i.prototype),"getDefaultLayerConfig",this).call(this,t)),{},{heightField:null,heightDomain:[0,1],heightScale:"linear",radiusField:null,radiusDomain:[0,1],radiusScale:"linear",strokeColorField:null,strokeColorDomain:[0,1],strokeColorScale:"quantile"})}},{key:"getHoverData",value:function(t,e){var n,r=e instanceof M.ArrowDataContainer?t:null==t||null===(n=t.properties)||void 0===n?void 0:n.index;return r>=0?e.row(r):null}},{key:"calculateDataAttribute",value:function(t,e){var n=this,r=t.dataContainer,i=t.filteredIndex;if(r instanceof M.ArrowDataContainer){if(this.filteredIndex&&this.filteredIndex.length===r.numRows()||(this.filteredIndex=new Uint8ClampedArray(r.numRows()),this.filteredIndex.fill(1)),!i||i.length!==r.numRows()||null!==this.filteredIndexTrigger){this.filteredIndex.fill(0);for(var o=0;o<i.length;++o)this.filteredIndex[i[o]]=1;this.filteredIndexTrigger=i}return this.dataToFeature}return i.map((function(t){return n.dataToFeature[t]})).filter((function(t){return t}))}},{key:"formatLayerData",value:function(t,e){var n=this;if(null===this.config.dataId)return{};var r=t[this.config.dataId],i=r.gpuFilter,o=r.dataContainer,s=this.updateData(t,e).data,a=this.getAttributeAccessors({dataAccessor:function(t){return function(t){return{index:t.properties.index}}},dataContainer:o});return O({data:s,getFilterValue:i.filterValueAccessor(o)((function(t){return t.properties.index}),(function(t,e,n){return t.valueAt(e.properties.index,n)})),getFiltered:function(t){return n.filteredIndex?n.filteredIndex[t.properties.index]:1}},a)}},{key:"isInPolygon",value:function(t,e,n){var r,i;if(0===this.centroids.length||!this.centroids[e])return!1;var o="Rectangle"===(null===(r=n.properties)||void 0===r?void 0:r.shape),s=this.centroids[e];if(!s)return!1;if(o&&null!==(i=n.properties)&&void 0!==i&&i.bbox){var a,u=null===(a=n.properties)||void 0===a?void 0:a.bbox,c=(0,l.default)(u,4),h=c[0],d=c[1],f=c[2],p=c[3];return s[0]>=h&&s[0]<=f&&s[1]>=d&&s[1]<=p}return(0,v.default)((0,m.point)(s),n)}},{key:"updateLayerMeta",value:function(t){this.dataContainer=t;var e=this.getPositionAccessor(t),n=k(this.config.columns),r=D(this.config.columns);if(t instanceof M.ArrowDataContainer){if(this.dataToFeature.length<t.numChunks()){var i=t.numChunks()-this.dataToFeature.length==1,o=(0,C.getGeojsonLayerMetaFromArrow)(O({dataContainer:t,getGeoColumn:n,getGeoField:r},i?{chunkIndex:this.dataToFeature.length}:null)),s=o.dataToFeature,l=o.bounds,u=o.fixedRadius,c=o.featureTypes,h=o.centroids;h&&(this.centroids=this.centroids.concat(h)),this.updateMeta({bounds:l,fixedRadius:u,featureTypes:c}),this.dataToFeature=[].concat((0,a.default)(this.dataToFeature),(0,a.default)(s))}}else if(0===this.dataToFeature.length){var d=(0,w.getGeojsonLayerMeta)({dataContainer:t,getFeature:e}),f=d.dataToFeature,p=d.bounds,g=d.fixedRadius,y=d.featureTypes,m=d.centroids;m&&(this.centroids=m),this.dataToFeature=f,this.updateMeta({bounds:p,fixedRadius:g,featureTypes:y})}}},{key:"setInitialLayerConfig",value:function(t){var e=t.dataContainer;if(!e.numRows())return this;this.updateLayerMeta(e);var n=this.meta.featureTypes;return n&&n.polygon?this.updateLayerVisConfig({filled:!0,stroked:!0,strokeColor:A.colorMaker.next().value}):n&&n.point?this.updateLayerVisConfig({filled:!0,stroked:!1}):this}},{key:"isLayerHovered",value:function(t){return this.dataContainer instanceof M.ArrowDataContainer?(0,C.isLayerHoveredFromArrow)(t,this.id):(0,d.default)((0,g.default)(i.prototype),"isLayerHovered",this).call(this,t)}},{key:"hasHoveredObject",value:function(t){return this.dataContainer instanceof M.ArrowDataContainer?(0,C.getHoveredObjectFromArrow)(t,this.dataContainer,this.id,k(this.config.columns),D(this.config.columns)):(0,d.default)((0,g.default)(i.prototype),"hasHoveredObject",this).call(this,t)}},{key:"renderLayer",value:function(t){var e=this,n=t.data,r=t.gpuFilter,i=t.objectHovered,o=t.mapState,l=t.interactionConfig,u=this.meta,c=u.fixedRadius,h=u.featureTypes,d=this.getRadiusScaleByZoom(o,c),f=this.getZoomFactor(o),p=this.getElevationZoomFactor(o),g=this.config.visConfig,y={lineWidthScale:g.thickness*f*8,elevationScale:g.elevationScale*p,pointRadiusScale:d,lineMiterLimit:4},m=O(O({},this.getVisualChannelUpdateTriggers()),{},{getFilterValue:r.filterValueUpdateTriggers,getFiltered:this.filteredIndexTrigger}),v=this.getDefaultDeckLayerProps(t),b={opacity:g.strokeOpacity},_=l.tooltip.enabled,A=this.hasHoveredObject(i),w=n.data,C=(0,s.default)(n,["data"]),S=this.dataContainer instanceof M.ArrowDataContainer?w:[w],T=S.map((function(t,n){return new x.GeoJsonLayer(O(O(O(O({},v),y),C),{},{data:t,id:S.length>1?"".concat(e.id,"-").concat(n):e.id,pickable:_,highlightColor:E.HIGHLIGH_COLOR_3D,autoHighlight:g.enable3d&&_,stroked:g.stroked,filled:g.filled,extruded:g.enable3d,wireframe:g.wireframe,wrapLongitude:!1,lineMiterLimit:2,capRounded:!0,jointRounded:!0,updateTriggers:m,extensions:[].concat((0,a.default)(v.extensions),[new P.FilterArrowExtension]),_subLayerProps:O(O(O({},null!=h&&h.polygon?{"polygons-stroke":b}:{}),null!=h&&h.line?{linestrings:b}:{}),null!=h&&h.point?{points:{lineOpacity:g.strokeOpacity}}:{})}))}));return[].concat((0,a.default)(T),(0,a.default)(A&&!g.enable3d?[new x.GeoJsonLayer(O(O(O({},this.getDefaultHoverLayerProps()),y),{},{visible:v.visible,wrapLongitude:!1,data:[A],getLineWidth:C.getLineWidth,getPointRadius:C.getPointRadius,getElevation:C.getElevation,getLineColor:this.config.highlightColor,getFillColor:this.config.highlightColor,stroked:!0,filled:!1}))]:[]))}}],[{key:"type",get:function(){return"geojson"}},{key:"findDefaultLayerProps",value:function(t){var e=this,n=t.label,r=t.fields,i=void 0===r?[]:r,o=i.filter((function(t){return("geojson"===t.type||"geoarrow"===t.type)&&I[t.analyzerType]})).map((function(t){return t.name})),s={geojson:(0,b.default)([].concat((0,a.default)(E.GEOJSON_FIELDS.geojson),(0,a.default)(o)))},l=this.findDefaultColumnField(s,i);return l&&l.length?{props:l.map((function(t){return{label:"string"==typeof n&&n.replace(/\.[^/.]+$/,"")||e.type,columns:t,isVisible:!0}}))}:{props:[]}}}]),i}(A.default);e.default=F},10962:(t,e,n)=>{"use strict";var r=n(95709);Object.defineProperty(e,"__esModule",{value:!0}),e.parseGeoJsonRawFeature=y,e.getGeojsonLayerMeta=function(t){for(var e=m(t.dataContainer,t.getFeature),n=b(e),r=Boolean(e.find((function(t){var e;return t&&"properties"in t&&(null===(e=t.properties)||void 0===e?void 0:e.radius)}))),i=A(e),o=[],s=0;s<e.length;s++){var a=e[s];if(a)try{var l=(0,u.default)(a);o.push(l.geometry.coordinates)}catch(t){o.push(null)}}return{dataToFeature:e,bounds:n,fixedRadius:r,featureTypes:i,centroids:o}},e.getGeojsonDataMaps=m,e.parseGeometryFromString=v,e.getGeojsonBounds=b,e.getGeojsonFeatureTypes=A,e.featureToDeckGlGeoType=e.FeatureTypes=void 0;var i,o=r(n(26396)),s=r(n(85735)),a=r(n(8186)),l=r(n(44798)),u=r(n(26140)),c=n(70108),h=n(36520),d=n(24059),f=n(77244);function p(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function g(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?p(Object(n),!0).forEach((function(e){(0,o.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function y(t){if("object"===(0,s.default)(t)){var e=(0,a.default)(t);return e&&Array.isArray(e.features)?e.features[0]:null}return"string"==typeof t?v(t):Array.isArray(t)?{type:"Feature",geometry:{coordinates:t.map((function(t){return[t[1],t[0]]})),type:"LineString"},properties:{}}:null}function m(t,e){for(var n=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon","GeometryCollection"],r=[],i=0;i<t.numRows();i++){var o=y(e({index:i}));if(o&&o.geometry&&n.includes(o.geometry.type)){var s=g(g({},o),{},{properties:g(g({},o.properties),{},{index:i})});r[i]=s}else r[i]=null}return r}function v(t){var e;try{e=JSON.parse(t)}catch(t){}if(!e)try{e=(0,c.parseSync)(t,h.WKTLoader)}catch(t){return null}if(!e)try{var n=Buffer.from(t,"hex"),r=(0,c.parseSync)(n,h.WKBLoader);e=(0,d.binaryToGeometry)(r)}catch(t){return null}if(!e)return null;var i=(0,a.default)(e);return i&&Array.isArray(i.features)?i.features[0]:null}function b(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=(t.length>1e4?(0,f.getSampleData)(t,1e4):t).filter((function(t){return t&&t.geometry&&t.geometry.coordinates&&t.geometry.coordinates.length}));try{return(0,l.default)({type:"FeatureCollection",features:e})}catch(t){return null}}e.FeatureTypes=i,function(t){t.Point="Point",t.MultiPoint="MultiPoint",t.LineString="LineString",t.MultiLineString="MultiLineString",t.Polygon="Polygon",t.MultiPolygon="MultiPolygon"}(i||(e.FeatureTypes=i={}));var _={Point:"point",MultiPoint:"point",LineString:"line",MultiLineString:"line",Polygon:"polygon",MultiPolygon:"polygon"};function A(t){for(var e={},n=0;n<t.length;n++){var r=t[n];if(r&&"geometry"in r){var i=_[r.geometry&&r.geometry.type];i&&(e[i]=!0)}}return e}e.featureToDeckGlGeoType=_},9380:(t,e,n)=>{"use strict";var r=n(58784),i=n(95709);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=i(n(82274)),s=i(n(65044)),a=i(n(56994)),l=i(n(65611)),u=i(n(18337)),c=i(n(26396)),h=r(n(93345)),d=i(n(5556)),f=n(32268);var p=function(t){(0,a.default)(i,t);var e,n,r=(e=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=(0,u.default)(e);if(n){var i=(0,u.default)(this).constructor;t=Reflect.construct(r,arguments,i)}else t=r.apply(this,arguments);return(0,l.default)(this,t)});function i(){return(0,o.default)(this,i),r.apply(this,arguments)}return(0,s.default)(i,[{key:"render",value:function(){return h.default.createElement(f.Base,this.props,h.default.createElement("rect",{x:"11.2",y:"11.2",className:"cr1",width:"13.1",height:"13.1",style:{opacity:.8}}),h.default.createElement("rect",{x:"25.4",y:"11.2",className:"cr2",width:"13.1",height:"13.1",style:{opacity:.8}}),h.default.createElement("rect",{x:"39.6",y:"11.2",width:"13.1",height:"13.1",className:"cr3"}),h.default.createElement("rect",{x:"11.2",y:"25.4",className:"cr4",width:"13.1",height:"13.1",style:{opacity:.4}}),h.default.createElement("rect",{x:"25.4",y:"25.4",className:"cr5",width:"13.1",height:"13.1"}),h.default.createElement("rect",{x:"39.6",y:"25.4",className:"cr6",width:"13.1",height:"13.1",style:{opacity:.8}}),h.default.createElement("rect",{x:"11.2",y:"39.6",width:"13.1",className:"cr1",height:"13.1"}),h.default.createElement("rect",{x:"25.4",y:"39.6",className:"cr2",width:"13.1",height:"13.1",style:{opacity:.4}}),h.default.createElement("rect",{x:"39.6",y:"39.6",className:"cr3",width:"13.1",height:"13.1",style:{opacity:.4}}))}}]),i}(h.Component);e.default=p,(0,c.default)(p,"propTypes",{height:d.default.string,colors:d.default.arrayOf(d.default.string)}),(0,c.default)(p,"defaultProps",{height:"16px",predefinedClassName:"grid-layer-icon",totalColor:6})},488:(t,e,n)=>{"use strict";var r=n(95709);Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.gridVisConfigs=void 0;var i=r(n(26396)),o=r(n(21259)),s=r(n(82274)),a=r(n(65044)),l=r(n(56994)),u=r(n(65611)),c=r(n(18337)),h=n(23863),d=n(29294),f=r(n(39095)),p=n(72040),g=r(n(9380));function y(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function m(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?y(Object(n),!0).forEach((function(e){(0,i.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var v={opacity:"opacity",worldUnitSize:"worldUnitSize",colorRange:"colorRange",coverage:"coverage",sizeRange:"elevationRange",percentile:"percentile",elevationPercentile:"elevationPercentile",elevationScale:"elevationScale",enableElevationZoomFactor:"enableElevationZoomFactor",colorAggregation:"colorAggregation",sizeAggregation:"sizeAggregation",enable3d:"enable3d"};e.gridVisConfigs=v;var b=function(t){(0,l.default)(i,t);var e,n,r=(e=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=(0,c.default)(e);if(n){var i=(0,c.default)(this).constructor;t=Reflect.construct(r,arguments,i)}else t=r.apply(this,arguments);return(0,u.default)(this,t)});function i(t){var e;return(0,s.default)(this,i),(e=r.call(this,t)).registerVisConfig(v),e.visConfigSettings.worldUnitSize.label="columns.grid.worldUnitSize",e}return(0,a.default)(i,[{key:"type",get:function(){return"grid"}},{key:"layerIcon",get:function(){return g.default}},{key:"renderLayer",value:function(t){var e=t.data,n=t.objectHovered,r=t.mapState,i=this.getDefaultAggregationLayerProp(t),s=this.getZoomFactor(r),a=this.config.visConfig,l=1e3*a.worldUnitSize,u=this.hasHoveredObject(n);return[new d.EnhancedGridLayer(m(m(m({},i),e),{},{wrapLongitude:!1,cellSize:l}))].concat((0,o.default)(u&&!a.enable3d?[new h.GeoJsonLayer(m(m({},this.getDefaultHoverLayerProps()),{},{visible:i.visible,wrapLongitude:!1,data:[(0,p.pointToPolygonGeo)({object:u,cellSize:l,coverage:a.coverage,mapState:r})],getLineColor:this.config.highlightColor,lineWidthScale:8*s}))]:[]))}}]),i}(f.default);e.default=b},72040:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.pointToPolygonGeo=function(t){var e=t.object,n=t.cellSize,i=t.coverage,o=t.properties,s=t.mapState,a=e.position,l=new r.WebMercatorViewport(s);return a?{geometry:{coordinates:[l.addMetersToLngLat(a,[n*(.5-i/2),n*(.5-i/2)]),l.addMetersToLngLat(a,[n*(.5+i/2),n*(.5-i/2)]),l.addMetersToLngLat(a,[n*(.5+i/2),n*(.5+i/2)]),l.addMetersToLngLat(a,[n*(.5-i/2),n*(.5+i/2)]),l.addMetersToLngLat(a,[n*(.5-i/2),n*(.5-i/2)])],type:"LineString"},properties:o}:null};var r=n(98265)},780:(t,e,n)=>{"use strict";var r=n(58784),i=n(95709);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=i(n(82274)),s=i(n(65044)),a=i(n(56994)),l=i(n(65611)),u=i(n(18337)),c=i(n(26396)),h=r(n(93345)),d=i(n(5556)),f=n(32268);var p=function(t){(0,a.default)(i,t);var e,n,r=(e=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=(0,u.default)(e);if(n){var i=(0,u.default)(this).constructor;t=Reflect.construct(r,arguments,i)}else t=r.apply(this,arguments);return(0,l.default)(this,t)});function i(){return(0,o.default)(this,i),r.apply(this,arguments)}return(0,s.default)(i,[{key:"render",value:function(){return h.default.createElement(f.Base,this.props,h.default.createElement("path",{d:"M44.59,54.5H19.41L6.81,32.68,19.41,10.87H44.59L57.19,32.68Zm-23-3.83H42.38l10.38-18-10.38-18H21.62l-10.38,18Z"}),h.default.createElement("polygon",{points:"24.65 32.86 24.65 37.79 22.53 37.79 22.53 26.3 24.65 26.3 24.65 30.91 29.32 30.91 29.32 26.3 31.43 26.3 31.43 37.79 29.32 37.79 29.32 32.86 24.65 32.86"}),h.default.createElement("path",{d:"M33.79,37.05l.6-1.67a5.86,5.86,0,0,0,1.39.61,5.59,5.59,0,0,0,1.5.19A2.57,2.57,0,0,0,39,35.66a1.81,1.81,0,0,0,.61-1.46A1.29,1.29,0,0,0,38.94,33a4.55,4.55,0,0,0-2.05-.32H35.74V31h1.1A5.4,5.4,0,0,0,38,30.85a2.1,2.1,0,0,0,.77-.29,1.53,1.53,0,0,0,.51-.54,1.58,1.58,0,0,0,.15-.73,1.14,1.14,0,0,0-.51-1,2.67,2.67,0,0,0-1.5-.34,4.56,4.56,0,0,0-1.51.24,5,5,0,0,0-1.34.73l-.7-1.61a4.92,4.92,0,0,1,1.66-.83,6.91,6.91,0,0,1,2-.31,4.41,4.41,0,0,1,2.81.79,2.71,2.71,0,0,1,1,2.24,2.33,2.33,0,0,1-.54,1.62,3.45,3.45,0,0,1-1.46.93v0a3,3,0,0,1,1.67.81,2.3,2.3,0,0,1,.64,1.7A3.27,3.27,0,0,1,40.48,37a5,5,0,0,1-3.16.91A6.77,6.77,0,0,1,33.79,37.05Z"}))}}]),i}(h.Component);(0,c.default)(p,"propTypes",{height:d.default.string,colors:d.default.arrayOf(d.default.string)}),(0,c.default)(p,"defaultProps",{height:"16px",predefinedClassName:"h3-hexagon-layer-icon",totalColor:4});var g=p;e.default=g},64800:(t,e,n)=>{"use strict";var r=n(95709);Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.HexagonIdVisConfigs=e.defaultCoverage=e.defaultElevation=e.hexIdAccessor=e.hexIdRequiredColumns=void 0;var i=r(n(21259)),o=r(n(82274)),s=r(n(65044)),a=r(n(41972)),l=r(n(96220)),u=r(n(56994)),c=r(n(65611)),h=r(n(18337)),d=r(n(26396)),f=r(n(37576)),p=n(74704),g=n(23863),y=n(64949),m=n(29294),v=n(77244),b=r(n(780)),_=n(13848),A=n(18521);function x(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function w(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?x(Object(n),!0).forEach((function(e){(0,d.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var C=["hex_id"];e.hexIdRequiredColumns=C;var S=function(t){var e=t.hex_id;return function(t){return function(n){return t.valueAt(n.index,e.fieldIdx)}}};e.hexIdAccessor=S,e.defaultElevation=500,e.defaultCoverage=1;var E={colorRange:"colorRange",filled:w(w({},_.LAYER_VIS_CONFIGS.filled),{},{defaultValue:!0}),opacity:w(w({},_.LAYER_VIS_CONFIGS.opacity),{},{label:"Fill Opacity",range:[0,1],property:"opacity"}),outline:"outline",strokeColor:"strokeColor",strokeColorRange:"strokeColorRange",strokeOpacity:w(w({},_.LAYER_VIS_CONFIGS.opacity),{},{label:"Stroke Opacity",range:[0,1],property:"strokeOpacity"}),thickness:"thickness",coverage:"coverage",enable3d:"enable3d",sizeRange:"elevationRange",coverageRange:"coverageRange",elevationScale:"elevationScale",enableElevationZoomFactor:"enableElevationZoomFactor"};e.HexagonIdVisConfigs=E;var M=new p.BrushingExtension,P=function(t){(0,u.default)(f,t);var e,n,r=(e=f,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=(0,h.default)(e);if(n){var i=(0,h.default)(this).constructor;t=Reflect.construct(r,arguments,i)}else t=r.apply(this,arguments);return(0,c.default)(this,t)});function f(t){var e;return(0,o.default)(this,f),e=r.call(this,t),(0,d.default)((0,a.default)(e),"dataToFeature",void 0),e.dataToFeature={centroids:[]},e.registerVisConfig(E),e.getPositionAccessor=function(t){return S(e.config.columns)(t)},e}return(0,s.default)(f,[{key:"type",get:function(){return"hexagonId"}},{key:"name",get:function(){return"H3"}},{key:"requiredLayerColumns",get:function(){return C}},{key:"layerIcon",get:function(){return b.default}},{key:"visualChannels",get:function(){var t=(0,l.default)((0,h.default)(f.prototype),"visualChannels",this);return{color:w(w({},t.color),{},{accessor:"getFillColor",condition:function(t){return t.visConfig.filled}}),strokeColor:{property:"strokeColor",key:"strokeColor",field:"strokeColorField",scale:"strokeColorScale",domain:"strokeColorDomain",range:"strokeColorRange",channelScaleType:_.CHANNEL_SCALES.color,accessor:"getLineColor",condition:function(t){return t.visConfig.outline},defaultValue:function(t){return t.visConfig.strokeColor||t.color}},size:w(w({},t.size),{},{property:"height",accessor:"getElevation",nullValue:0,condition:function(t){return t.visConfig.enable3d},defaultValue:500}),coverage:{property:"coverage",field:"coverageField",scale:"coverageScale",domain:"coverageDomain",range:"coverageRange",key:"coverage",channelScaleType:_.CHANNEL_SCALES.radius,accessor:"getCoverage",nullValue:0,defaultValue:1}}}},{key:"setInitialLayerConfig",value:function(t){if(!t.dataContainer.numRows())return this;var e=(0,v.findDefaultColorField)(t);return e&&(this.updateLayerConfig({colorField:e}),this.updateLayerVisualChannel(t,"color")),this}},{key:"getDefaultLayerConfig",value:function(t){var e=(0,l.default)((0,h.default)(f.prototype),"getDefaultLayerConfig",this).call(this,t);return w(w({},e),{},{strokeColorField:null,strokeColorDomain:[0,1],strokeColorScale:"quantile",colorUI:w(w({},e.colorUI),{},{strokeColorRange:_.DEFAULT_COLOR_UI}),coverageField:null,coverageDomain:[0,1],coverageScale:"linear",textLabel:[w(w({},_.DEFAULT_TEXT_LABEL),{},{anchor:"middle"})]})}},{key:"calculateDataAttribute",value:function(t,e){t.dataContainer;for(var n=t.filteredIndex,r=[],i=0;i<n.length;i++){var o=n[i],s=e({index:o}),a=this.dataToFeature.centroids[o];a&&r.push({index:o,id:s,centroid:a})}return r}},{key:"formatLayerData",value:function(t,e){if(null===this.config.dataId)return{};var n=t[this.config.dataId],r=n.gpuFilter,i=n.dataContainer,o=this.getPositionAccessor(i),s=this.updateData(t,e),a=s.data,l=s.triggerChanged,u=this.getAttributeAccessors({dataContainer:i}),c=this.config.textLabel,h=(0,A.formatTextLabelData)({textLabel:c,triggerChanged:l,oldLayerData:e,data:a,dataContainer:i});return w({data:a,getHexId:o,getFilterValue:r.filterValueAccessor(i)(),textLabels:h,getPosition:function(t){return t.centroid}},u)}},{key:"updateLayerMeta",value:function(t,e){var n=t.map((function(t,n){var r=e({index:n});return(0,v.h3IsValid)(r)?(0,v.getCentroid)({id:r}):null}),!0),r=(0,v.createDataContainer)(n),i=this.getPointsBounds(r,(function(t,e){return[e.valueAt(t.index,0),e.valueAt(t.index,1)]}));this.dataToFeature={centroids:n},this.updateMeta({bounds:i})}},{key:"renderLayer",value:function(t){var e=t.data,n=t.gpuFilter,r=t.objectHovered,o=t.mapState,s=t.interactionConfig,a=this.getZoomFactor(o),l=this.getElevationZoomFactor(o),u=this.config,c=u.visConfig,h=this.getVisualChannelUpdateTriggers(),d={getHexagon:this.config.columns,getFillColor:h.getFillColor,getLineColor:h.getLineColor,getElevation:h.getElevation,getFilterValue:n.filterValueUpdateTriggers},f={getCoverage:h.getCoverage},p=this.getDefaultDeckLayerProps(t),b=this.hasHoveredObject(r),x=(0,A.getTextOffsetByRadius)(1,null,o),C=this.getBrushingExtensionProps(s),S=[].concat((0,i.default)(p.extensions),[M]),E=w({getFilterValue:e.getFilterValue,extensions:S,filterRange:p.filterRange,visible:p.visible},C);return[new y.H3HexagonLayer(w(w(w(w({},p),e),C),{},{extensions:S,wrapLongitude:!1,filled:c.filled,stroked:c.outline,lineWidthScale:c.thickness,getHexagon:function(t){return t.id},coverage:u.coverageField?1:c.coverage,autoHighlight:c.enable3d,highlightColor:_.HIGHLIGH_COLOR_3D,extruded:c.enable3d,elevationScale:c.elevationScale*l,updateTriggers:d,_subLayerProps:{"hexagon-cell":{type:m.EnhancedColumnLayer,getCoverage:e.getCoverage,updateTriggers:f,strokeOpacity:c.strokeOpacity}}}))].concat((0,i.default)(b&&!u.sizeField?[new g.GeoJsonLayer(w(w({},this.getDefaultHoverLayerProps()),{},{visible:p.visible,data:[(0,v.idToPolygonGeo)(b)],getLineColor:u.highlightColor,lineWidthScale:8*a,wrapLongitude:!1}))]:[]),(0,i.default)(this.renderTextLabelLayer({getPosition:e.getPosition,sharedProps:E,getPixelOffset:x,updateTriggers:h},t)))}}],[{key:"findDefaultLayerProps",value:function(t){var e=t.fields,n=void 0===e?[]:e,r=t.dataContainer,i=t.label,o=(0,v.getHexFields)(n,r);return o.length?{props:o.map((function(t){return{isVisible:!0,label:i,columns:{hex_id:{value:t.name,fieldIdx:n.findIndex((function(e){return e.name===t.name}))}}}}))}:{props:[]}}}]),f}(f.default);e.default=P},45778:(t,e,n)=>{"use strict";var r=n(95709);Object.defineProperty(e,"__esModule",{value:!0});var i={H3HexagonLayerIcon:!0};Object.defineProperty(e,"H3HexagonLayerIcon",{enumerable:!0,get:function(){return o.default}});var o=r(n(780)),s=n(64800);Object.keys(s).forEach((function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(i,t)||t in e&&e[t]===s[t]||Object.defineProperty(e,t,{enumerable:!0,get:function(){return s[t]}}))}))},94738:(t,e,n)=>{"use strict";var r=n(58784),i=n(95709);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=i(n(82274)),s=i(n(65044)),a=i(n(56994)),l=i(n(65611)),u=i(n(18337)),c=i(n(26396)),h=r(n(93345)),d=i(n(5556)),f=n(32268);var p=function(t){(0,a.default)(i,t);var e,n,r=(e=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=(0,u.default)(e);if(n){var i=(0,u.default)(this).constructor;t=Reflect.construct(r,arguments,i)}else t=r.apply(this,arguments);return(0,l.default)(this,t)});function i(){return(0,o.default)(this,i),r.apply(this,arguments)}return(0,s.default)(i,[{key:"render",value:function(){return h.default.createElement(f.Base,this.props,h.default.createElement("path",{d:"M51.87,21C49.55,16.67,43.77,15.29,39,18a11.42,11.42,0,0,0-1.65,1.13c-2.73,2.14-2.12,3-6,4.89-2.27,1.07-3.42,1.08-6.88,1.4l-2.24.21a14,14,0,0,0-2.86.84c-6.64,2.73-10.11,9.86-7.76,15.94s9.63,8.79,16.27,6.07A14,14,0,0,0,31.77,46l0,0,.06-.07c.43-.4.8-.78,1.14-1.14a2.66,2.66,0,0,0,.32-.36l.17-.19c3-3.53,2-5,4.9-7.39,2.38-1.93,5.41-.95,9-3C52.19,31.15,54.19,25.43,51.87,21ZM26,44.59a8.7,8.7,0,0,1-2.26.59A7.16,7.16,0,0,1,16,40.85c-1.44-3.72.68-8.08,4.73-9.74A8.33,8.33,0,0,1,23,30.53a7.15,7.15,0,0,1,7.71,4.32C32.19,38.57,30.06,42.93,26,44.59Z",className:"cr2",style:{opacity:.8}}),h.default.createElement("path",{d:"M57,18.18A14.56,14.56,0,0,0,42.25,10.7a16.62,16.62,0,0,0-6.12,2,17.35,17.35,0,0,0-2.39,1.65,20.15,20.15,0,0,0-2.83,2.73,4.52,4.52,0,0,1-2,1.45,5.88,5.88,0,0,1-2.26.63l-1.45.14-1.27.12-2.33.22-.2,0-.18,0a18.88,18.88,0,0,0-4,1.18c-9.6,3.93-14.51,14.57-11,23.71A17.59,17.59,0,0,0,24.81,55.4,20.19,20.19,0,0,0,30,54.05a20,20,0,0,0,5.26-3.19l.82-.71.05-.08,1-1c.21-.22.41-.45.59-.66l.13-.15a20,20,0,0,0,3.39-5.48c.36-.87.36-.87.68-1.14a9.09,9.09,0,0,1,1.56-.32,18.79,18.79,0,0,0,6.69-2.19,16.56,16.56,0,0,0,7.88-9.9A14.93,14.93,0,0,0,57,18.18ZM47.63,34.27a13.93,13.93,0,0,1-5.06,1.61,7.75,7.75,0,0,0-3.86,1.36,7.06,7.06,0,0,0-2.33,3.24,14.17,14.17,0,0,1-2.51,4.09l-.1.11a5.11,5.11,0,0,1-.43.47c-.31.35-.7.73-1.14,1.14l-.09.09-.12.09a14.4,14.4,0,0,1-4,2.44,14.73,14.73,0,0,1-3.84,1c-5.87.69-11.13-2.27-13.08-7.35-2.45-6.32,1.16-13.76,8-16.59a15,15,0,0,1,3-.87l2.29-.22.9-.07,2-.2a10.88,10.88,0,0,0,3.85-1.08,9.43,9.43,0,0,0,3.77-2.76A14.75,14.75,0,0,1,37,18.71a11.5,11.5,0,0,1,1.71-1.17,11.08,11.08,0,0,1,4.16-1.36,9.26,9.26,0,0,1,9.42,4.64C54.75,25.42,52.65,31.47,47.63,34.27Z",className:"cr1",style:{opacity:.36}}),h.default.createElement("path",{d:"M33,44.79a9.53,9.53,0,0,1-1.13,1.14C32.3,45.53,32.67,45.15,33,44.79Z",className:"cr1",style:{opacity:.36}}),h.default.createElement("path",{d:"M25.83,44.13c-3.82,1.55-8,0-9.33-3.46s.65-7.55,4.45-9.1,8,0,9.33,3.46S29.63,42.57,25.83,44.13Z",className:"cr3"}),h.default.createElement("path",{d:"M31.81,46a.09.09,0,0,1,0,0h0Z",className:"cr3"}))}}]),i}(h.Component);e.default=p,(0,c.default)(p,"propTypes",{height:d.default.string,colors:d.default.arrayOf(d.default.string)}),(0,c.default)(p,"defaultProps",{height:"16px",predefinedClassName:"heatmap-layer-icon",totalColor:3})},91974:(t,e,n)=>{"use strict";var r=n(95709);Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.heatmapVisConfigs=e.pointColResolver=e.pointPosAccessor=e.MAX_ZOOM_LEVEL=void 0;var i=r(n(39892)),o=r(n(82274)),s=r(n(65044)),a=r(n(41972)),l=r(n(96220)),u=r(n(56994)),c=r(n(65611)),h=r(n(18337)),d=r(n(26396)),f=r(n(21259)),p=n(38909),g=r(n(47654)),y=n(13848),m=r(n(76965)),v=r(n(94738)),b=n(77244);function _(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function A(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?_(Object(n),!0).forEach((function(e){(0,d.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}e.MAX_ZOOM_LEVEL=18;var x=function(t){var e=t.lat,n=t.lng;return function(t){return function(r){return[t.valueAt(r.index,n.fieldIdx),t.valueAt(r.index,e.fieldIdx)]}}};e.pointPosAccessor=x;var w=function(t){var e=t.lat,n=t.lng;return"".concat(e.fieldIdx,"-").concat(n.fieldIdx)};e.pointColResolver=w;var C={opacity:"opacity",colorRange:"colorRange",radius:"heatmapRadius"};e.heatmapVisConfigs=C;var S=function(t){(0,u.default)(m,t);var e,n,r=(e=m,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=(0,h.default)(e);if(n){var i=(0,h.default)(this).constructor;t=Reflect.construct(r,arguments,i)}else t=r.apply(this,arguments);return(0,c.default)(this,t)});function m(t){var e;return(0,o.default)(this,m),e=r.call(this,t),(0,d.default)((0,a.default)(e),"getPosition",void 0),(0,d.default)((0,a.default)(e),"columnsSelector",(function(t){return w(t.columns)})),(0,d.default)((0,a.default)(e),"visConfigSelector",(function(t){return t.visConfig})),(0,d.default)((0,a.default)(e),"weightFieldSelector",(function(t){return t.weightField?t.weightField.name:null})),(0,d.default)((0,a.default)(e),"weightDomainSelector",(function(t){return t.weightDomain})),(0,d.default)((0,a.default)(e),"paintSelector",(0,p.createSelector)(e.visConfigSelector,e.weightFieldSelector,e.weightDomainSelector,(function(t,e,n){return{"heatmap-weight":e?["interpolate",["linear"],["get",e],n[0],0,n[1],1]:1,"heatmap-intensity":["interpolate",["linear"],["zoom"],0,1,18,3],"heatmap-color":["interpolate",["linear"],["heatmap-density"]].concat((0,f.default)((r=t.colorRange,i=y.SCALE_FUNC.quantize,o=["#000000"].concat((0,f.default)(r.colors)),s=i().domain([0,1]).range(o),a=s.range().reduce((function(t,e){var n=s.invertExtent(e);return[].concat((0,f.default)(t),[n[0],"rgb(".concat((0,b.hexToRgb)(e).join(","),")")])}),[]),a[1]="rgba(0,0,0,0)",a))),"heatmap-radius":["interpolate",["linear"],["zoom"],0,2,18,t.radius],"heatmap-opacity":t.opacity};var r,i,o,s,a}))),(0,d.default)((0,a.default)(e),"computeHeatmapConfiguration",(0,p.createSelector)(e.sourceSelector,e.filterSelector,e.paintSelector,(function(t,n,r){return A({type:"heatmap",id:e.id,source:t,layout:{visibility:"visible"},paint:r},e.isValidFilter(n)?{filter:n}:{})}))),e.registerVisConfig(C),e.getPosition=(0,g.default)(x,w),e}return(0,s.default)(m,[{key:"type",get:function(){return"heatmap"}},{key:"visualChannels",get:function(){return{weight:{property:"weight",field:"weightField",scale:"weightScale",domain:"weightDomain",key:"weight",defaultMeasure:"property.density",supportedFieldTypes:[y.ALL_FIELD_TYPES.real,y.ALL_FIELD_TYPES.integer],channelScaleType:y.CHANNEL_SCALES.size}}}},{key:"layerIcon",get:function(){return v.default}},{key:"getVisualChannelDescription",value:function(t){return"color"===t?{label:"property.color",measure:"property.density"}:{label:"property.weight",measure:this.config.weightField?this.config.weightField.name:"property.density"}}},{key:"getDefaultLayerConfig",value:function(t){var e=A(A({},(0,l.default)((0,h.default)(m.prototype),"getDefaultLayerConfig",this).call(this,t)),{},{weightField:null,weightDomain:[0,1],weightScale:"linear"});return e.colorField,e.colorDomain,e.colorScale,(0,i.default)(e,["colorField","colorDomain","colorScale"])}},{key:"getPositionAccessor",value:function(t){return this.getPosition(this.config.columns)(t)}},{key:"updateLayerMeta",value:function(t){var e=this.getPositionAccessor(t),n=this.getPointsBounds(t,e);this.updateMeta({bounds:n})}},{key:"formatLayerData",value:function(t,e){if(null===this.config.dataId)return{};var n=this.config.weightField,r=t[this.config.dataId].dataContainer,i=this.getPositionAccessor(r),o=this.updateData(t,e).data,s=this.computeHeatmapConfiguration(this.config,t);return s.id=this.id,{columns:this.config.columns,config:s,data:o,weightField:n,getPosition:i}}}]),m}(m.default);e.default=S},84794:(t,e,n)=>{"use strict";var r=n(58784),i=n(95709);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=i(n(82274)),s=i(n(65044)),a=i(n(56994)),l=i(n(65611)),u=i(n(18337)),c=i(n(26396)),h=r(n(93345)),d=i(n(5556)),f=n(32268);var p=function(t){(0,a.default)(i,t);var e,n,r=(e=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=(0,u.default)(e);if(n){var i=(0,u.default)(this).constructor;t=Reflect.construct(r,arguments,i)}else t=r.apply(this,arguments);return(0,l.default)(this,t)});function i(){return(0,o.default)(this,i),r.apply(this,arguments)}return(0,s.default)(i,[{key:"render",value:function(){return h.default.createElement(f.Base,this.props,h.default.createElement("polygon",{className:"cr1",points:"23.9,10 30.9,14 30.9,22.1 23.9,26.2 16.8,22.1 16.8,14 ",style:{opacity:.6}}),h.default.createElement("polygon",{className:"cr2",points:"23.9,37.8 30.9,41.9 30.9,50 23.9,54 16.8,50 16.8,41.9 ",style:{opacity:.4}}),h.default.createElement("polygon",{className:"cr6",points:"40.1,10 47.2,14 47.2,22.1 40.1,26.2 33.1,22.1 33.1,14 "}),h.default.createElement("polygon",{className:"cr3",points:"40.1,37.8 47.2,41.9 47.2,50 40.1,54 33.1,50 33.1,41.9 ",style:{opacity:.8}}),h.default.createElement("polygon",{className:"cr1",points:"15.8,23.9 22.8,27.9 22.8,36.1 15.8,40.1 8.7,36.1 8.7,27.9 "}),h.default.createElement("polygon",{className:"cr4",points:"32,23.9 39,27.9 39,36.1 32,40.1 25,36.1 25,27.9 ",style:{opacity:.8}}),h.default.createElement("polygon",{className:"cr5",points:"48.2,23.9 55.3,27.9 55.3,36.1 48.2,40.1 41.2,36.1 41.2,27.9 ",style:{opacity:.4}}))}}]),i}(h.Component);e.default=p,(0,c.default)(p,"propTypes",{height:d.default.string,colors:d.default.arrayOf(d.default.string)}),(0,c.default)(p,"defaultProps",{height:"16px",predefinedClassName:"hexagon-layer-icon",totalColor:6})},36414:(t,e,n)=>{"use strict";var r=n(95709);Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.hexagonVisConfigs=void 0;var i=r(n(26396)),o=r(n(21259)),s=r(n(82274)),a=r(n(65044)),l=r(n(56994)),u=r(n(65611)),c=r(n(18337)),h=n(23863),d=r(n(39095)),f=n(29294),p=n(83598),g=r(n(84794)),y=n(77244);function m(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function v(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?m(Object(n),!0).forEach((function(e){(0,i.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var b={opacity:"opacity",worldUnitSize:"worldUnitSize",resolution:"resolution",colorRange:"colorRange",coverage:"coverage",sizeRange:"elevationRange",percentile:"percentile",elevationPercentile:"elevationPercentile",elevationScale:"elevationScale",enableElevationZoomFactor:"enableElevationZoomFactor",colorAggregation:"colorAggregation",sizeAggregation:"sizeAggregation",enable3d:"enable3d"};e.hexagonVisConfigs=b;var _=function(t){(0,l.default)(i,t);var e,n,r=(e=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=(0,c.default)(e);if(n){var i=(0,c.default)(this).constructor;t=Reflect.construct(r,arguments,i)}else t=r.apply(this,arguments);return(0,u.default)(this,t)});function i(t){var e;return(0,s.default)(this,i),(e=r.call(this,t)).registerVisConfig(b),e.visConfigSettings.worldUnitSize.label="columns.hexagon.worldUnitSize",e}return(0,a.default)(i,[{key:"type",get:function(){return"hexagon"}},{key:"name",get:function(){return"Hexbin"}},{key:"layerIcon",get:function(){return g.default}},{key:"renderLayer",value:function(t){var e=t.data,n=t.objectHovered,r=t.mapState,i=this.getDefaultAggregationLayerProp(t),s=this.getZoomFactor(r),a=this.config.visConfig,l=1e3*a.worldUnitSize,u=this.hasHoveredObject(n);return[new f.EnhancedHexagonLayer(v(v(v({},i),e),{},{wrapLongitude:!1,radius:l}))].concat((0,o.default)(u&&!a.enable3d?[new h.GeoJsonLayer(v(v({},this.getDefaultHoverLayerProps()),{},{visible:i.visible,wrapLongitude:!1,data:[(0,p.hexagonToPolygonGeo)(u,{},l*a.coverage,r)].filter((function(t){return t})),getLineColor:this.config.highlightColor,lineWidthScale:(0,y.clamp)([1,100],.1*l*s)}))]:[]))}}]),i}(d.default);e.default=_},83598:(t,e,n)=>{"use strict";var r=n(95709);Object.defineProperty(e,"__esModule",{value:!0}),e.hexagonToPolygonGeo=function(t,e,n,r){var a=new i.WebMercatorViewport(r);if(!Array.isArray(t.position))return null;var l=a.projectFlat(t.position),u=a.getDistanceScales(t.position).unitsPerMeter;if(!Array.isArray(u))return o.default.warn("unitsPerMeter is undefined"),null;for(var c=n*u[0],h=[],d=0;d<6;d++){var f=s(l,c,d);h.push(a.unprojectFlat(f))}return h.push(h[0]),{geometry:{coordinates:h,type:"LineString"},properties:e}};var i=n(98265),o=r(n(45439));function s(t,e,n){var r=60*n+30,i=Math.PI/180*r;return[t[0]+e*Math.cos(i),t[1]+e*Math.sin(i)]}},23883:(t,e,n)=>{"use strict";var r=n(95709);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i,o,s,a,l,u=r(n(72189)),c=r(n(93345)),h=r(n(17850)),d=n(56048),f=n(80652),p=r(n(91241)),g=h.default.div(i||(i=(0,u.default)(["\n  display: flex;\n  align-items: center;\n"]))),y=(0,d.line)().x((function(t){return 10*t[0]})).y((function(t){return 10*t[1]})),m=function(t){var e=t.mesh;return t.className,c.default.createElement("svg",{width:"20px",height:"20px"},c.default.createElement("g",{transform:"translate(10, 10)"},e.cells.map((function(t,n){return c.default.createElement("path",{key:n,fill:"#000000",d:y(t.map((function(t){return e.positions[t]})))})}))))},v=(0,h.default)(g)(o||(o=(0,u.default)(["\n  padding-left: 6px;\n  width: 180px;\n  height: 48px;\n  margin-right: 12px;\n\n  .icon-table_item__name {\n    margin-left: 12px;\n  }\n"]))),b=h.default.code(s||(s=(0,u.default)(["\n  color: ",";\n"])),(function(t){return t.theme.titleColorLT})),_=h.default.div(a||(a=(0,u.default)(["\n  font-size: 20px;\n  letter-spacing: 1.25px;\n  margin: 18px 0 14px 0;\n  color: ",";\n"])),(function(t){return t.theme.titleColorLT})),A=function(t){var e=t.icon,n=e.id,r=e.mesh;return c.default.createElement(v,{className:"icon-table__item"},c.default.createElement(m,{className:"icon-table__item__shape",mesh:r}),c.default.createElement("div",{className:"icon-table_item__name"},c.default.createElement(b,null,n)))},x=function(){return c.default.createElement(p.default,{className:"icon-example-table"},c.default.createElement("thead",null,c.default.createElement("tr",null,c.default.createElement("th",null,"point_lat"),c.default.createElement("th",null,"point_lng"),c.default.createElement("th",null,"icon"))),c.default.createElement("tbody",null,c.default.createElement("tr",null,c.default.createElement("td",null,"37.769897"),c.default.createElement("td",null,"-122.41168"),c.default.createElement("td",null,c.default.createElement(b,null,"android"))),c.default.createElement("tr",null,c.default.createElement("td",null,"37.806928"),c.default.createElement("td",null,"-122.40218"),c.default.createElement("td",null)),c.default.createElement("tr",null,c.default.createElement("td",null,"37.778564"),c.default.createElement("td",null,"-122.39096"),c.default.createElement("td",null,c.default.createElement(b,null,"calendar"))),c.default.createElement("tr",null,c.default.createElement("td",null,"37.745995"),c.default.createElement("td",null,"-122.30220"),c.default.createElement("td",null)),c.default.createElement("tr",null,c.default.createElement("td",null,"37.329841"),c.default.createElement("td",null,"-122.103847"),c.default.createElement("td",null,c.default.createElement(b,null,"control-off")))))},w=h.default.div(l||(l=(0,u.default)(["\n  display: flex;\n  align-items: flex-start;\n  flex-wrap: wrap;\n"])));e.default=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return function(){return c.default.createElement("div",{className:"icon-info-modal"},c.default.createElement("div",{className:"icon-info-modal__description"},c.default.createElement(f.FormattedMessage,{id:"modal.iconInfo.description1"})," ",c.default.createElement("code",null,c.default.createElement(f.FormattedMessage,{id:"modal.iconInfo.code"})),c.default.createElement(f.FormattedMessage,{id:"modal.iconInfo.description2"})),c.default.createElement("div",{className:"icon-info-modal__example"},c.default.createElement(_,null,c.default.createElement(f.FormattedMessage,{id:"modal.iconInfo.example"})),c.default.createElement(x,null)),c.default.createElement("div",{className:"icon-info-modal__icons"},c.default.createElement(_,null,c.default.createElement(f.FormattedMessage,{id:"modal.iconInfo.icons"})),c.default.createElement(w,{className:"icon-info-modal__icons__table"},t.map((function(t){return c.default.createElement(A,{key:t.id,icon:t})})))))}}},7738:(t,e,n)=>{"use strict";var r=n(58784),i=n(95709);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=i(n(82274)),s=i(n(65044)),a=i(n(56994)),l=i(n(65611)),u=i(n(18337)),c=i(n(26396)),h=r(n(93345)),d=i(n(5556)),f=n(32268);var p=function(t){(0,a.default)(i,t);var e,n,r=(e=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=(0,u.default)(e);if(n){var i=(0,u.default)(this).constructor;t=Reflect.construct(r,arguments,i)}else t=r.apply(this,arguments);return(0,l.default)(this,t)});function i(){return(0,o.default)(this,i),r.apply(this,arguments)}return(0,s.default)(i,[{key:"render",value:function(){return h.default.createElement(f.Base,this.props,h.default.createElement("path",{className:"cr1",d:"M42.27,33.59l-4.34,4.34-4.34-4.34a13.25,13.25,0,0,1-8.9-12.52h0A13.24,13.24,0,0,1,37.93,7.83h0A13.24,13.24,0,0,1,51.17,21.07h0A13.25,13.25,0,0,1,42.27,33.59ZM37.93,28.3a7.22,7.22,0,1,0-7.22-7.22A7.22,7.22,0,0,0,37.93,28.3Z"}),h.default.createElement("path",{className:"cr2",d:"M18.68,48.79l-2.44,2.44L13.8,48.79a7.44,7.44,0,0,1-5-7h0a7.44,7.44,0,0,1,7.44-7.44h0a7.44,7.44,0,0,1,7.44,7.44h0A7.44,7.44,0,0,1,18.68,48.79Zm-2.44-3a4.06,4.06,0,1,0-4.06-4.06A4.06,4.06,0,0,0,16.24,45.81Z"}),h.default.createElement("path",{className:"cr3",d:"M48.85,55.52l-2.2,2.2-2.2-2.2a6.73,6.73,0,0,1-4.52-6.36h0a6.72,6.72,0,0,1,6.72-6.72h0a6.72,6.72,0,0,1,6.72,6.72h0A6.73,6.73,0,0,1,48.85,55.52Zm-2.2-2.69A3.67,3.67,0,1,0,43,49.17,3.67,3.67,0,0,0,46.65,52.83Z"}))}}]),i}(h.Component);e.default=p,(0,c.default)(p,"propTypes",{height:d.default.string,colors:d.default.arrayOf(d.default.string)}),(0,c.default)(p,"defaultProps",{height:"16px",predefinedClassName:"icon-layer-icon",totalColor:3})},8798:(t,e,n)=>{"use strict";var r=n(95709);Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.pointVisConfigs=e.iconOptionalColumns=e.iconRequiredColumns=e.iconAccessor=e.iconPosAccessor=e.SVG_ICON_URL=void 0;var i=r(n(21259)),o=r(n(82274)),s=r(n(65044)),a=r(n(41972)),l=r(n(96220)),u=r(n(56994)),c=r(n(65611)),h=r(n(18337)),d=r(n(26396)),f=r(n(89840)),p=n(74704),g=r(n(4390)),y=n(29294),m=r(n(7738)),v=n(13848),b=r(n(23883)),_=r(n(37576)),A=n(80456),x=n(77244),w=n(18521);function C(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function S(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?C(Object(n),!0).forEach((function(e){(0,d.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var E=new p.BrushingExtension,M="".concat(v.KEPLER_UNFOLDED_BUCKET,"/icons/svg-icons.json");e.SVG_ICON_URL=M;var P=function(t){var e=t.lat,n=t.lng,r=t.altitude;return function(t){return function(i){return[t.valueAt(i.index,n.fieldIdx),t.valueAt(i.index,e.fieldIdx),(null==r?void 0:r.fieldIdx)>-1?t.valueAt(i.index,r.fieldIdx):0]}}};e.iconPosAccessor=P;var T=function(t){var e=t.icon;return function(t){return function(n){return t.valueAt(n.index,e.fieldIdx)}}};e.iconAccessor=T;var O=["lat","lng","icon"];e.iconRequiredColumns=O;var I=["altitude"];e.iconOptionalColumns=I;var R={radius:"radius",fixedRadius:"fixedRadius",opacity:"opacity",colorRange:"colorRange",radiusRange:"radiusRange"};e.pointVisConfigs=R;var B=function(t){(0,u.default)(p,t);var e,n,r=(e=p,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=(0,h.default)(e);if(n){var i=(0,h.default)(this).constructor;t=Reflect.construct(r,arguments,i)}else t=r.apply(this,arguments);return(0,c.default)(this,t)});function p(t){var e;return(0,o.default)(this,p),e=r.call(this,t),(0,d.default)((0,a.default)(e),"getIconAccessor",void 0),(0,d.default)((0,a.default)(e),"_layerInfoModal",void 0),(0,d.default)((0,a.default)(e),"iconGeometry",void 0),e.registerVisConfig(R),e.getPositionAccessor=function(t){return P(e.config.columns)(t)},e.getIconAccessor=function(t){return T(e.config.columns)(t)},e._layerInfoModal=(0,b.default)(t.svgIcons),e.iconGeometry=t.iconGeometry||null,(0,x.isTest)()?(0,c.default)(e):(t.svgIcons?e.setSvgIcons(t.svgIcons):e.getSvgIcons(),e)}return(0,s.default)(p,[{key:"svgIconUrl",get:function(){return M}},{key:"type",get:function(){return"icon"}},{key:"requiredLayerColumns",get:function(){return O}},{key:"optionalColumns",get:function(){return I}},{key:"columnPairs",get:function(){return this.defaultPointColumnPairs}},{key:"layerIcon",get:function(){return m.default}},{key:"visualChannels",get:function(){return{color:S(S({},(0,l.default)((0,h.default)(p.prototype),"visualChannels",this).color),{},{accessor:"getFillColor",defaultValue:function(t){return t.color}}),size:S(S({},(0,l.default)((0,h.default)(p.prototype),"visualChannels",this).size),{},{property:"radius",range:"radiusRange",channelScaleType:"radius",accessor:"getRadius",defaultValue:1})}}},{key:"layerInfoModal",get:function(){return{id:"iconInfo",template:this._layerInfoModal,modalProps:{title:"modal.iconInfo.title"}}}},{key:"getSvgIcons",value:function(){var t=this;f.default.fetch&&this.svgIconUrl&&f.default.fetch(this.svgIconUrl,{method:"GET",mode:"cors",cache:"no-cache"}).then((function(t){return t.json()})).then((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.setSvgIcons(e.svgIcons)}))}},{key:"setSvgIcons",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.iconGeometry=t.reduce((function(t,e){return S(S({},t),{},(0,d.default)({},e.id,(n=e).mesh.cells.reduce((function(t,e){return e.forEach((function(e){t.push.apply(t,[n.mesh.positions[e][0],-n.mesh.positions[e][1],n.mesh.positions[e][2]])})),t}),[])));var n}),{}),this._layerInfoModal=(0,b.default)(t)}},{key:"calculateDataAttribute",value:function(t,e){for(var n=t.dataContainer,r=t.filteredIndex,i=this.getIconAccessor(n),o=[],s=0;s<r.length;s++){var a=r[s],l={index:a},u=e(l),c=i(l);u.every(Number.isFinite)&&"string"==typeof c&&o.push({index:a,icon:c})}return o}},{key:"formatLayerData",value:function(t,e){if(null===this.config.dataId)return{};var n=this.config.textLabel,r=t[this.config.dataId],i=r.gpuFilter,o=r.dataContainer,s=this.getPositionAccessor(o),a=this.updateData(t,e),l=a.data,u=a.triggerChanged,c=(0,w.formatTextLabelData)({textLabel:n,triggerChanged:u,oldLayerData:e,data:l,dataContainer:o}),h=this.getAttributeAccessors({dataContainer:o});return S({data:l,getPosition:s,getFilterValue:i.filterValueAccessor(o)(),textLabels:c},h)}},{key:"updateLayerMeta",value:function(t,e){var n=this.getPointsBounds(t,e);this.updateMeta({bounds:n})}},{key:"renderLayer",value:function(t){var e,n=this,r=t.data,o=t.gpuFilter,s=t.objectHovered,a=t.mapState,l=t.interactionConfig,u=this.getRadiusScaleByZoom(a),c=S({radiusScale:u},this.config.visConfig.fixedRadius?{}:{radiusMaxPixels:500}),h=S({getPosition:this.config.columns,getFilterValue:o.filterValueUpdateTriggers},this.getVisualChannelUpdateTriggers()),d=this.getDefaultDeckLayerProps(t),f=this.getBrushingExtensionProps(l),p=(0,w.getTextOffsetByRadius)(u,r.getRadius,a),m=[].concat((0,i.default)(d.extensions),[E]),v=S({getFilterValue:r.getFilterValue,extensions:m,filterRange:d.filterRange},f),b=(0,i.default)(this.renderTextLabelLayer({getPosition:r.getPosition,sharedProps:v,getPixelOffset:p,updateTriggers:h},t)),_=this.hasHoveredObject(s),A={depthTest:(null===(e=this.config.columns.altitude)||void 0===e?void 0:e.fieldIdx)>-1,cullFace:g.default.FRONT};return this.iconGeometry?[new y.SvgIconLayer(S(S(S(S(S({},d),f),c),r),{},{parameters:A,getIconGeometry:function(t){var e;return null===(e=n.iconGeometry)||void 0===e?void 0:e[t]},updateTriggers:h,extensions:m}))].concat((0,i.default)(_?[new y.SvgIconLayer(S(S(S({},this.getDefaultHoverLayerProps()),c),{},{visible:d.visible,data:[_],parameters:A,getPosition:r.getPosition,getRadius:r.getRadius,getFillColor:this.config.highlightColor,getIconGeometry:function(t){var e;return null===(e=n.iconGeometry)||void 0===e?void 0:e[t]}}))]:[]),(0,i.default)(b)):[]}}],[{key:"findDefaultLayerProps",value:function(t){var e=t.fieldPairs,n=void 0===e?[]:e,r=t.fields,i=void 0===r?[]:r,o={props:[]};if(!n.length||!i.length)return o;var s=i.filter((function(t){return t.name.replace(/[_,.]+/g," ").trim().split(" ").some((function(t){return v.ICON_FIELDS.icon.some((function(e){return e.includes(t)}))}))}));if(!s.length)return o;var a=n[0],l=(0,A.assignPointPairToLayerColumn)(a,!0);return{props:s.map((function(t){return{label:t.name.replace(/[_,.]+/g," ").trim(),columns:S(S({},l),{},{icon:{value:t.name,fieldIdx:t.fieldIdx}}),isVisible:!0}}))}}}]),p}(_.default);e.default=B},40441:(t,e,n)=>{"use strict";var r=n(95709),i=n(58784);Object.defineProperty(e,"__esModule",{value:!0});var o={KeplerGlLayers:!0,LayerClasses:!0,EditorLayerUtils:!0,Layer:!0,OVERLAY_TYPE_CONST:!0,LAYER_ID_LENGTH:!0,colorMaker:!0,layerColors:!0,pointToPolygonGeo:!0,defaultElevation:!0,defaultLineWidth:!0,defaultRadius:!0,MAX_ZOOM_LEVEL:!0,h3DefaultElevation:!0,ScenegraphLayer:!0,scenegraphVisConfigs:!0,tripDefaultLineWidth:!0,coordHasLength4:!0,containValidTime:!0,isTripGeoJsonField:!0,parseTripGeoJsonTimestamp:!0,getAnimationDomainFromTimestamps:!0,s2DefaultElevation:!0,getS2Center:!0,AggregationLayer:!0,getFilterDataFunc:!0,parseGeoJsonRawFeature:!0,Table:!0,getEditorLayer:!0,ScenegraphLayerIcon:!0};Object.defineProperty(e,"Layer",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(e,"OVERLAY_TYPE_CONST",{enumerable:!0,get:function(){return a.OVERLAY_TYPE_CONST}}),Object.defineProperty(e,"LAYER_ID_LENGTH",{enumerable:!0,get:function(){return a.LAYER_ID_LENGTH}}),Object.defineProperty(e,"colorMaker",{enumerable:!0,get:function(){return a.colorMaker}}),Object.defineProperty(e,"layerColors",{enumerable:!0,get:function(){return a.layerColors}}),Object.defineProperty(e,"pointToPolygonGeo",{enumerable:!0,get:function(){return d.pointToPolygonGeo}}),Object.defineProperty(e,"defaultElevation",{enumerable:!0,get:function(){return p.defaultElevation}}),Object.defineProperty(e,"defaultLineWidth",{enumerable:!0,get:function(){return p.defaultLineWidth}}),Object.defineProperty(e,"defaultRadius",{enumerable:!0,get:function(){return p.defaultRadius}}),Object.defineProperty(e,"MAX_ZOOM_LEVEL",{enumerable:!0,get:function(){return m.MAX_ZOOM_LEVEL}}),Object.defineProperty(e,"h3DefaultElevation",{enumerable:!0,get:function(){return v.defaultElevation}}),Object.defineProperty(e,"ScenegraphLayer",{enumerable:!0,get:function(){return b.default}}),Object.defineProperty(e,"scenegraphVisConfigs",{enumerable:!0,get:function(){return b.scenegraphVisConfigs}}),Object.defineProperty(e,"tripDefaultLineWidth",{enumerable:!0,get:function(){return _.defaultLineWidth}}),Object.defineProperty(e,"coordHasLength4",{enumerable:!0,get:function(){return A.coordHasLength4}}),Object.defineProperty(e,"containValidTime",{enumerable:!0,get:function(){return A.containValidTime}}),Object.defineProperty(e,"isTripGeoJsonField",{enumerable:!0,get:function(){return A.isTripGeoJsonField}}),Object.defineProperty(e,"parseTripGeoJsonTimestamp",{enumerable:!0,get:function(){return A.parseTripGeoJsonTimestamp}}),Object.defineProperty(e,"getAnimationDomainFromTimestamps",{enumerable:!0,get:function(){return A.getAnimationDomainFromTimestamps}}),Object.defineProperty(e,"s2DefaultElevation",{enumerable:!0,get:function(){return x.defaultElevation}}),Object.defineProperty(e,"getS2Center",{enumerable:!0,get:function(){return w.getS2Center}}),Object.defineProperty(e,"AggregationLayer",{enumerable:!0,get:function(){return C.default}}),Object.defineProperty(e,"getFilterDataFunc",{enumerable:!0,get:function(){return C.getFilterDataFunc}}),Object.defineProperty(e,"parseGeoJsonRawFeature",{enumerable:!0,get:function(){return E.parseGeoJsonRawFeature}}),Object.defineProperty(e,"Table",{enumerable:!0,get:function(){return O.default}}),Object.defineProperty(e,"getEditorLayer",{enumerable:!0,get:function(){return I.getEditorLayer}}),Object.defineProperty(e,"ScenegraphLayerIcon",{enumerable:!0,get:function(){return R.default}}),e.EditorLayerUtils=e.LayerClasses=e.KeplerGlLayers=void 0;var s=r(n(26396)),a=i(n(37576));Object.keys(a).forEach((function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(o,t)||t in e&&e[t]===a[t]||Object.defineProperty(e,t,{enumerable:!0,get:function(){return a[t]}}))}));var l=r(n(29518)),u=r(n(9714)),c=r(n(99136)),h=r(n(488)),d=n(72040),f=r(n(36414)),p=i(n(93658)),g=r(n(65154)),y=r(n(8798)),m=i(n(91974)),v=i(n(64800)),b=i(n(31044)),_=i(n(70890)),A=n(77346),x=i(n(39522)),w=n(35865),C=i(n(39095)),S=n(13848),E=n(10962),M=n(42558);Object.keys(M).forEach((function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(o,t)||t in e&&e[t]===M[t]||Object.defineProperty(e,t,{enumerable:!0,get:function(){return M[t]}}))}));var P=n(45778);Object.keys(P).forEach((function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(o,t)||t in e&&e[t]===P[t]||Object.defineProperty(e,t,{enumerable:!0,get:function(){return P[t]}}))}));var T,O=r(n(91241)),I=n(51762),R=r(n(3216)),B=n(36754),L=n(3372);Object.keys(L).forEach((function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(o,t)||t in e&&e[t]===L[t]||Object.defineProperty(e,t,{enumerable:!0,get:function(){return L[t]}}))}));var k={PointLayer:l.default,ArcLayer:u.default,LineLayer:c.default,GridLayer:h.default,HexagonLayer:f.default,GeojsonLayer:p.default,ClusterLayer:g.default,IconLayer:y.default,HeatmapLayer:m.default,H3Layer:v.default,ScenegraphLayer:b.default,TripLayer:_.default,S2GeometryLayer:x.default};e.KeplerGlLayers=k;var D=(T={},(0,s.default)(T,S.LAYER_TYPES.point,l.default),(0,s.default)(T,S.LAYER_TYPES.arc,u.default),(0,s.default)(T,S.LAYER_TYPES.line,c.default),(0,s.default)(T,S.LAYER_TYPES.grid,h.default),(0,s.default)(T,S.LAYER_TYPES.hexagon,f.default),(0,s.default)(T,S.LAYER_TYPES.geojson,p.default),(0,s.default)(T,S.LAYER_TYPES.cluster,g.default),(0,s.default)(T,S.LAYER_TYPES.icon,y.default),(0,s.default)(T,S.LAYER_TYPES.heatmap,m.default),(0,s.default)(T,S.LAYER_TYPES.hexagonId,v.default),(0,s.default)(T,S.LAYER_TYPES["3D"],b.default),(0,s.default)(T,S.LAYER_TYPES.trip,_.default),(0,s.default)(T,S.LAYER_TYPES.s2,x.default),T);e.LayerClasses=D;var F={isDrawingActive:B.isDrawingActive,onClick:B.onClick,onHover:B.onHover,getTooltip:B.getTooltip,getCursor:B.getCursor};e.EditorLayerUtils=F},18521:(t,e,n)=>{"use strict";var r=n(95709);Object.defineProperty(e,"__esModule",{value:!0}),e.getTextOffsetByRadius=function(t,e,n){return function(r){var o=(0,i.getDistanceScales)(n),s="middle"===r.anchor?0:"start"===r.anchor?1:-1,l="center"===r.alignment?0:"bottom"===r.alignment?1:-1,u="center"===r.alignment?0:(r.alignment,r.size),c=t*o.pixelsPerMeter[0],h=a;return"function"==typeof e?function(t){return[s*(e(t)*c+h),l*(e(t)*c+h+u)]}:[s*(e*c+h),l*(e*c+h+u)]}},e.formatTextLabelData=e.textLabelAccessor=e.defaultPadding=void 0;var i=n(16366),o=n(77244),s=r(n(90879)),a=20;e.defaultPadding=a;var l=function(t){return function(e){return function(e){var n=t.field.valueAccessor(e);return(0,o.notNullorUndefined)(n)?String(n):""}}};e.textLabelAccessor=l,e.formatTextLabelData=function(t){var e=t.textLabel,n=t.triggerChanged,r=t.oldLayerData,i=t.data,o=t.dataContainer;return e.map((function(t,e){if(!t.field)return{getText:null,characterSet:[]};var a,u=l(t)(o);if(!n["getLabelCharacterSet-".concat(e)]&&r&&r.textLabels&&r.textLabels[e])a=r.textLabels[e].characterSet;else{var c=t.field?i.map(u):[];a=(0,s.default)(c.join(""))}return{characterSet:a,getText:u}}))}},3372:(t,e,n)=>{"use strict";var r=n(95709);Object.defineProperty(e,"__esModule",{value:!0}),e.diffUpdateTriggers=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={},r=!1;for(var i in t)o(t[i]||{},e[i]||{},i)&&(n[i]=!0,r=n);return r};var i=r(n(85735));function o(t,e,n){if("object"!==(0,i.default)(e))return e===t?null:"".concat(n," changed shallowly");for(var r in e){if(!(r in t))return"".concat(n,".").concat(r," deleted");if(e[r]!==t[r])return"".concat(n,".").concat(r," changed shallowly")}for(var o in t)if(!(o in e))return"".concat(n,".").concat(o," added");return null}},80456:(t,e,n)=>{"use strict";var r=n(95709);Object.defineProperty(e,"__esModule",{value:!0}),e.assignPointPairToLayerColumn=function(t,e){var n=t.pair,r=n.lat,i=n.lng,o=n.alt;if(!e)return{lat:r,lng:i};var s={value:null,fieldIdx:-1,optional:!0};return{lat:r,lng:i,altitude:o?a(a({},s),o):s}},e.getGeojsonLayerMetaFromArrow=function(t){var e,n=t.dataContainer,r=t.getGeoColumn,i=t.getGeoField,s=t.chunkIndex,l=r(n),u=i(n),c=null==u||null===(e=u.metadata)||void 0===e?void 0:e.get("ARROW:extension:name"),h=a(a({},void 0!==s&&s>=0?{chunkIndex:s,chunkOffset:l.data[0].length*s}:{}),{},{triangulate:!0,calculateMeanCenters:!0}),d=(0,o.getBinaryGeometriesFromArrow)(l,c,h);return{dataToFeature:d.binaryGeometries,featureTypes:d.featureTypes,bounds:d.bounds,fixedRadius:!1,centroids:d.meanCenters}},e.isLayerHoveredFromArrow=l,e.getHoveredObjectFromArrow=function(t,e,n,r,i){if(l(t,n)&&t.index>=0&&e){var s,u=r(e),c=null==u?void 0:u.get(t.index),h=i(e),d=null==h||null===(s=h.metadata)||void 0===s?void 0:s.get("ARROW:extension:name"),f=(0,o.parseGeometryFromArrow)(c,d),p=e.rowAsArray(t.index).reduce((function(t,n,r){var i,o=null==e||null===(i=e.getField)||void 0===i?void 0:i.call(e,r).name;return o!==h.name&&(t[o]=n),t}),{});return f?{type:"Feature",geometry:f,properties:a(a({},p),{},{index:t.index})}:null}return null};var i=r(n(26396)),o=n(82062);function s(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function a(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?s(Object(n),!0).forEach((function(e){(0,i.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function l(t,e){var n,r;return!(null==t||!t.picked)&&(null==t||null===(n=t.layer)||void 0===n||null===(r=n.props)||void 0===r?void 0:r.id).startsWith(e)}},37420:(t,e,n)=>{"use strict";var r=n(58784),i=n(95709);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=i(n(82274)),s=i(n(65044)),a=i(n(56994)),l=i(n(65611)),u=i(n(18337)),c=i(n(26396)),h=r(n(93345)),d=i(n(5556)),f=n(32268);var p=function(t){(0,a.default)(i,t);var e,n,r=(e=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=(0,u.default)(e);if(n){var i=(0,u.default)(this).constructor;t=Reflect.construct(r,arguments,i)}else t=r.apply(this,arguments);return(0,l.default)(this,t)});function i(){return(0,o.default)(this,i),r.apply(this,arguments)}return(0,s.default)(i,[{key:"render",value:function(){return h.default.createElement(f.Base,this.props,h.default.createElement("path",{d:"M57.8,58.3c-0.4,0-0.8-0.2-1.1-0.5L33.1,32.1c-0.6-0.6-0.5-1.6,0.1-2.1c0.6-0.6,1.6-0.5,2.1,0.1l23.7,25.8 c0.6,0.6,0.5,1.6-0.1,2.1C58.5,58.2,58.2,58.3,57.8,58.3z",className:"cr1"}),h.default.createElement("path",{d:"M34.2,33.6c-0.6,0-1.2-0.2-1.7-0.6c-1-0.9-1.1-2.5-0.2-3.5l18.5-21c0.9-1,2.5-1.1,3.5-0.2c1,0.9,1.1,2.5,0.2,3.5L36,32.7 C35.5,33.3,34.9,33.6,34.2,33.6z",className:"cr2"}),h.default.createElement("path",{d:"M34.2,32.6c-0.5,0-1-0.3-1.3-0.8L20.7,10.2c-0.4-0.7-0.1-1.6,0.6-2c0.7-0.4,1.6-0.1,2,0.6l12.1,21.6c0.4,0.7,0.1,1.6-0.6,2 C34.7,32.5,34.4,32.6,34.2,32.6z",className:"cr3"}),h.default.createElement("path",{d:"M15.8,58.4c-0.3,0-0.6-0.1-0.9-0.3c-0.7-0.5-0.8-1.4-0.4-2.1l18.3-25.8c0.5-0.7,1.4-0.8,2.1-0.4s0.8,1.4,0.4,2.1L17.1,57.7 C16.8,58.2,16.3,58.4,15.8,58.4z",className:"cr4"}),h.default.createElement("path",{d:"M34.2,32.1c-0.1,0-0.3,0-0.4-0.1l-28.5-14c-0.5-0.2-0.7-0.8-0.5-1.3c0.2-0.5,0.8-0.7,1.3-0.5l28.5,14 c0.5,0.2,0.7,0.8,0.5,1.3C34.9,31.9,34.5,32.1,34.2,32.1z",className:"cr5"}))}}]),i}(h.Component);e.default=p,(0,c.default)(p,"propTypes",{height:d.default.string,colors:d.default.arrayOf(d.default.string)}),(0,c.default)(p,"defaultProps",{height:"16px",predefinedClassName:"line-layer-icon",totalColor:5})},99136:(t,e,n)=>{"use strict";var r=n(95709);Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.lineVisConfigs=e.lineColumnLabels=e.lineOptionalColumns=e.lineRequiredColumns=e.linePosAccessor=void 0;var i=r(n(21259)),o=r(n(82274)),s=r(n(65044)),a=r(n(96220)),l=r(n(56994)),u=r(n(65611)),c=r(n(18337)),h=r(n(26396)),d=n(74704),f=n(29294),p=r(n(37420)),g=r(n(9714)),y=n(13848);function m(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function v(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?m(Object(n),!0).forEach((function(e){(0,h.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var b=function(t){var e=t.lat0,n=t.lng0,r=t.lat1,i=t.lng1,o=t.alt0,s=t.alt1;return function(t){return function(a){return[t.valueAt(a.index,n.fieldIdx),t.valueAt(a.index,e.fieldIdx),o&&o.fieldIdx>-1?t.valueAt(a.index,o.fieldIdx):0,t.valueAt(a.index,i.fieldIdx),t.valueAt(a.index,r.fieldIdx),s&&(null==s?void 0:s.fieldIdx)>-1?t.valueAt(a.index,s.fieldIdx):0]}}};e.linePosAccessor=b;var _=["lat0","lng0","lat1","lng1"];e.lineRequiredColumns=_;var A=["alt0","alt1"];e.lineOptionalColumns=A;var x={lat0:"arc.lat0",lng0:"arc.lng0",lat1:"arc.lat1",lng1:"arc.lng1",alt0:"line.alt0",alt1:"line.alt1"};e.lineColumnLabels=x;var w={opacity:"opacity",thickness:"thickness",colorRange:"colorRange",sizeRange:"strokeWidthRange",targetColor:"targetColor",elevationScale:v(v({},y.LAYER_VIS_CONFIGS.elevationScale),{},{defaultValue:1})};e.lineVisConfigs=w;var C=function(t){(0,l.default)(h,t);var e,n,r=(e=h,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=(0,c.default)(e);if(n){var i=(0,c.default)(this).constructor;t=Reflect.construct(r,arguments,i)}else t=r.apply(this,arguments);return(0,u.default)(this,t)});function h(t){var e;return(0,o.default)(this,h),(e=r.call(this,t)).registerVisConfig(w),e.getPositionAccessor=function(t){return b(e.config.columns)(t)},e}return(0,s.default)(h,[{key:"type",get:function(){return"line"}},{key:"layerIcon",get:function(){return p.default}},{key:"requiredLayerColumns",get:function(){return _}},{key:"optionalColumns",get:function(){return A}},{key:"columnLabels",get:function(){return x}},{key:"visualChannels",get:function(){var t=(0,a.default)((0,c.default)(h.prototype),"visualChannels",this);return v(v({},t),{},{sourceColor:v(v({},t.sourceColor),{},{accessor:"getColor"})})}},{key:"renderLayer",value:function(t){var e=t.data,n=t.gpuFilter,r=t.objectHovered,o=t.interactionConfig,s={widthScale:this.config.visConfig.thickness*y.PROJECTED_PIXEL_SIZE_MULTIPLIER,elevationScale:this.config.visConfig.elevationScale},a=v({getPosition:this.config.columns,getFilterValue:n.filterValueUpdateTriggers},this.getVisualChannelUpdateTriggers()),l=this.getDefaultDeckLayerProps(t),u=this.hasHoveredObject(r);return[new f.EnhancedLineLayer(v(v(v(v(v({},l),this.getBrushingExtensionProps(o,"source_target")),e),s),{},{updateTriggers:a,extensions:[].concat((0,i.default)(l.extensions),[new d.BrushingExtension])}))].concat((0,i.default)(u?[new f.EnhancedLineLayer(v(v(v({},this.getDefaultHoverLayerProps()),s),{},{data:[u],getColor:this.config.highlightColor,getTargetColor:this.config.highlightColor,getWidth:e.getWidth}))]:[]))}}],[{key:"findDefaultLayerProps",value:function(t){var e=t.fieldPairs,n=void 0===e?[]:e;return n.length<2?{props:[]}:{props:[{columns:{lat0:n[0].pair.lat,lng0:n[0].pair.lng,alt0:{value:null,fieldIdx:-1,optional:!0},lat1:n[1].pair.lat,lng1:n[1].pair.lng,alt1:{value:null,fieldIdx:-1,optional:!0}},label:"".concat(n[0].defaultName," -> ").concat(n[1].defaultName," line")}]}}}]),h}(g.default);e.default=C},42558:(t,e,n)=>{"use strict";var r=n(95709);Object.defineProperty(e,"__esModule",{value:!0}),e.generateMapboxLayers=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return e.length>0?n.slice().reverse().filter((function(e){var n=(0,a.findById)(e)(t);return(null==n?void 0:n.overlayType)===s.OVERLAY_TYPE_CONST.mapboxgl&&r[e]})).reduce((function(n,i){var a=t.findIndex((function(t){return t.id===i}));if(-1===a)return n;var l=t[a];return l.overlayType===s.OVERLAY_TYPE_CONST.mapboxgl&&r[i]?u(u({},n),{},(0,o.default)({},l.id,{id:l.id,data:e[a].data,isVisible:l.config.isVisible,config:e[a].config,hidden:l.config.hidden,sourceId:e[a].config.source})):n}),{}):{}},e.updateMapboxLayers=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;n&&function(t,e,n){Object.keys(e).forEach((function(e){n[e]||t.removeLayer(e)}))}(t,n,e),Object.values(e).forEach((function(e){var r=e.id,i=e.config,o=e.data,s=e.sourceId,a=e.isVisible;if(o||i){var l=n&&n[r]||{},u=l.data,c=l.config;o&&o!==u&&function(t,e,n){var r=t.getSource(e);r?r.setData(n):t.addSource(e,{type:"geojson",data:n})}(t,s,o),c!==i&&function(t,e,n,r){t.getLayer(e)&&t.removeLayer(e),t.addLayer(n),t.setLayoutProperty(e,"visibility",r?"visible":"none")}(t,r,i,a)}}))},e.geoJsonFromData=function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(t){},r={type:"FeatureCollection",features:[]},i=0;i<t.length;i++){var o=t[i],s={index:o},a=e(s);a&&r.features.push({type:"Feature",properties:u({index:o},n(s)),geometry:a})}return r},e.gpuFilterToMapboxFilter=function(t){var e=t.filterRange,n=t.filterValueUpdateTriggers;return Object.values(n).filter((function(t){return t})).length?Object.values(n).reduce((function(t,n,r){return n?[].concat((0,i.default)(t),[[">=",c(n),e[r][0]],["<=",c(n),e[r][1]]]):t}),["all"]):null},e.prefixGpuField=void 0;var i=r(n(21259)),o=r(n(26396)),s=n(37576),a=n(77244);function l(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function u(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?l(Object(n),!0).forEach((function(e){(0,o.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var c=function(t){return"gpu:".concat(t)};e.prefixGpuField=c},76965:(t,e,n)=>{"use strict";var r=n(58784),i=n(95709);Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.pointColResolver=e.mapboxRequiredColumns=void 0;var o=i(n(82274)),s=i(n(65044)),a=i(n(41972)),l=i(n(56994)),u=i(n(65611)),c=i(n(18337)),h=i(n(26396)),d=r(n(37576)),f=n(38909),p=n(42558);function g(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function y(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?g(Object(n),!0).forEach((function(e){(0,h.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var m=["lat","lng"];e.mapboxRequiredColumns=m;var v=function(t){var e=t.lat,n=t.lng;return"".concat(e.fieldIdx,"-").concat(n.fieldIdx)};e.pointColResolver=v;var b=function(t){(0,l.default)(i,t);var e,n,r=(e=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=(0,c.default)(e);if(n){var i=(0,c.default)(this).constructor;t=Reflect.construct(r,arguments,i)}else t=r.apply(this,arguments);return(0,u.default)(this,t)});function i(){var t;(0,o.default)(this,i);for(var e=arguments.length,n=new Array(e),s=0;s<e;s++)n[s]=arguments[s];return t=r.call.apply(r,[this].concat(n)),(0,h.default)((0,a.default)(t),"datasetSelector",(function(t){return t.dataId})),(0,h.default)((0,a.default)(t),"gpuFilterSelector",(function(t,e){return(t.dataId&&e[t.dataId]||{}).gpuFilter})),(0,h.default)((0,a.default)(t),"columnsSelector",(function(t){return v(t.columns)})),(0,h.default)((0,a.default)(t),"sourceSelector",(0,f.createSelector)(t.datasetSelector,t.columnsSelector,(function(t,e){return"".concat(t,"-").concat(e)}))),(0,h.default)((0,a.default)(t),"filterSelector",(0,f.createSelector)(t.gpuFilterSelector,(function(t){return(0,p.gpuFilterToMapboxFilter)(t)}))),t}return(0,s.default)(i,[{key:"overlayType",get:function(){return d.OVERLAY_TYPE_CONST.mapboxgl}},{key:"type",get:function(){return null}},{key:"isAggregated",get:function(){return!0}},{key:"requiredLayerColumns",get:function(){return m}},{key:"columnPairs",get:function(){return this.defaultPointColumnPairs}},{key:"noneLayerDataAffectingProps",get:function(){return[]}},{key:"visualChannels",get:function(){return{}}},{key:"isValidFilter",value:function(t){return Array.isArray(t)&&t.length}},{key:"getDataUpdateTriggers",value:function(t){var e=this,n=t.filteredIndex,r=t.gpuFilter,i=t.id,o=this.config.columns,s=Object.values(this.visualChannels).reduce((function(t,n){return y(y({},t),e.config[n.field]?(0,h.default)({},n.field,e.config[n.field].name):{})}),{});return{getData:y(y({datasetId:i,columns:o,filteredIndex:n},s),r.filterValueUpdateTriggers),getMeta:{datasetId:i,columns:o}}}},{key:"getGeometry",value:function(t){return t.every(Number.isFinite)?{type:"Point",coordinates:t}:null}},{key:"calculateDataAttribute",value:function(t,e){var n=this,r=t.dataContainer,i=t.filteredIndex,o=t.gpuFilter,s=Object.values(this.visualChannels).map((function(t){return n.config[t.field]})).filter((function(t){return t})),a=s.length?function(t){return s.reduce((function(e,n){return y(y({},e),{},(0,h.default)({},n.name,n.valueAccessor(t)))}),{})}:function(t){return{}},l=o.filterValueUpdateTriggers,u=o.filterValueAccessor,c=Object.values(l).filter((function(t){return t})).length,d=u(r)(),f=c?function(t){var e=d(t);return Object.values(l).reduce((function(t,n,r){return y(y({},t),n?(0,h.default)({},(0,p.prefixGpuField)(n),e[r]):{})}),{})}:function(t){return{}};return(0,p.geoJsonFromData)(i,(function(t){return n.getGeometry(e(t))}),(function(t){return y(y({},a(t)),f(t))}))}},{key:"shouldRenderLayer",value:function(){return"string"==typeof this.type&&this.config.isVisible&&this.hasAllColumns()}}]),i}(d.default);e.default=b},76650:(t,e,n)=>{"use strict";var r=n(58784),i=n(95709);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=i(n(82274)),s=i(n(65044)),a=i(n(56994)),l=i(n(65611)),u=i(n(18337)),c=i(n(26396)),h=r(n(93345)),d=i(n(5556)),f=n(32268);var p=function(t){(0,a.default)(i,t);var e,n,r=(e=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=(0,u.default)(e);if(n){var i=(0,u.default)(this).constructor;t=Reflect.construct(r,arguments,i)}else t=r.apply(this,arguments);return(0,l.default)(this,t)});function i(){return(0,o.default)(this,i),r.apply(this,arguments)}return(0,s.default)(i,[{key:"render",value:function(){return h.default.createElement(f.Base,this.props,h.default.createElement("circle",{cx:"29.4",cy:"31.6",r:"8.4",className:"cr1"}),h.default.createElement("circle",{cx:"48.5",cy:"15.7",r:"6.5",className:"cr2"}),h.default.createElement("circle",{cx:"11",cy:"44.2",r:"3",className:"cr3"}),h.default.createElement("circle",{cx:"50",cy:"44.2",r:"5",className:"cr4"}),h.default.createElement("circle",{cx:"34",cy:"54.2",r:"3",className:"cr5"}),h.default.createElement("circle",{cx:"14",cy:"16.2",r:"4",className:"cr6"}))}}]),i}(h.Component);(0,c.default)(p,"propTypes",{height:d.default.string,colors:d.default.arrayOf(d.default.string)}),(0,c.default)(p,"defaultProps",{height:"16px",predefinedClassName:"point-layer-icon",totalColor:6});var g=p;e.default=g},29518:(t,e,n)=>{"use strict";var r=n(95709);Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.pointVisConfigs=e.pointOptionalColumns=e.pointRequiredColumns=e.pointPosAccessor=void 0;var i=r(n(21259)),o=r(n(82274)),s=r(n(65044)),a=r(n(96220)),l=r(n(56994)),u=r(n(65611)),c=r(n(18337)),h=r(n(26396)),d=n(74704),f=n(23863),p=r(n(37576)),g=n(77244),y=r(n(76650)),m=n(13848),v=n(18521),b=n(80456);function _(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function A(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?_(Object(n),!0).forEach((function(e){(0,h.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var x=function(t){var e=t.lat,n=t.lng,r=t.altitude;return function(t){return function(i){return[t.valueAt(i.index,n.fieldIdx),t.valueAt(i.index,e.fieldIdx),r&&r.fieldIdx>-1?t.valueAt(i.index,r.fieldIdx):0]}}};e.pointPosAccessor=x;var w=["lat","lng"];e.pointRequiredColumns=w;var C=["altitude"];e.pointOptionalColumns=C;var S=new d.BrushingExtension,E={radius:"radius",fixedRadius:"fixedRadius",opacity:"opacity",outline:"outline",thickness:"thickness",strokeColor:"strokeColor",colorRange:"colorRange",strokeColorRange:"strokeColorRange",radiusRange:"radiusRange",filled:A(A({},m.LAYER_VIS_CONFIGS.filled),{},{type:"boolean",label:"layer.fillColor",defaultValue:!0,property:"filled"})};e.pointVisConfigs=E;var M=function(t){(0,l.default)(h,t);var e,n,r=(e=h,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=(0,c.default)(e);if(n){var i=(0,c.default)(this).constructor;t=Reflect.construct(r,arguments,i)}else t=r.apply(this,arguments);return(0,u.default)(this,t)});function h(t){var e;return(0,o.default)(this,h),(e=r.call(this,t)).registerVisConfig(E),e.getPositionAccessor=function(t){return x(e.config.columns)(t)},e}return(0,s.default)(h,[{key:"type",get:function(){return"point"}},{key:"isAggregated",get:function(){return!1}},{key:"layerIcon",get:function(){return y.default}},{key:"requiredLayerColumns",get:function(){return w}},{key:"optionalColumns",get:function(){return C}},{key:"columnPairs",get:function(){return this.defaultPointColumnPairs}},{key:"noneLayerDataAffectingProps",get:function(){return[].concat((0,i.default)((0,a.default)((0,c.default)(h.prototype),"noneLayerDataAffectingProps",this)),["radius"])}},{key:"visualChannels",get:function(){return{color:A(A({},(0,a.default)((0,c.default)(h.prototype),"visualChannels",this).color),{},{accessor:"getFillColor",condition:function(t){return t.visConfig.filled},defaultValue:function(t){return t.color}}),strokeColor:{property:"strokeColor",key:"strokeColor",field:"strokeColorField",scale:"strokeColorScale",domain:"strokeColorDomain",range:"strokeColorRange",channelScaleType:m.CHANNEL_SCALES.color,accessor:"getLineColor",condition:function(t){return t.visConfig.outline},defaultValue:function(t){return t.visConfig.strokeColor||t.color}},size:A(A({},(0,a.default)((0,c.default)(h.prototype),"visualChannels",this).size),{},{property:"radius",range:"radiusRange",fixed:"fixedRadius",channelScaleType:"radius",accessor:"getRadius",defaultValue:1})}}},{key:"setInitialLayerConfig",value:function(t){if(!t.dataContainer.numRows())return this;var e=(0,g.findDefaultColorField)(t);return e&&(this.updateLayerConfig({colorField:e}),this.updateLayerVisualChannel(t,"color")),this}},{key:"getDefaultLayerConfig",value:function(t){return A(A({},(0,a.default)((0,c.default)(h.prototype),"getDefaultLayerConfig",this).call(this,t)),{},{strokeColorField:null,strokeColorDomain:[0,1],strokeColorScale:"quantile"})}},{key:"calculateDataAttribute",value:function(t,e){for(var n=t.filteredIndex,r=[],i=0;i<n.length;i++){var o=n[i],s=e({index:o});s.every(Number.isFinite)&&r.push({position:s,index:o})}return r}},{key:"formatLayerData",value:function(t,e){if(null===this.config.dataId)return{};var n=this.config.textLabel,r=t[this.config.dataId],i=r.gpuFilter,o=r.dataContainer,s=this.updateData(t,e),a=s.data,l=s.triggerChanged,u=this.getPositionAccessor(o),c=(0,v.formatTextLabelData)({textLabel:n,triggerChanged:l,oldLayerData:e,data:a,dataContainer:o}),h=this.getAttributeAccessors({dataContainer:o});return A({data:a,getPosition:u,getFilterValue:i.filterValueAccessor(o)(),textLabels:c},h)}},{key:"updateLayerMeta",value:function(t){var e=this.getPositionAccessor(t),n=this.getPointsBounds(t,e);this.updateMeta({bounds:n})}},{key:"renderLayer",value:function(t){var e,n=t.data,r=t.gpuFilter,o=t.objectHovered,s=t.mapState,a=t.interactionConfig,l=this.config.visConfig.fixedRadius&&Boolean(this.config.sizeField),u=this.getRadiusScaleByZoom(s,l),c=A({stroked:this.config.visConfig.outline,filled:this.config.visConfig.filled,lineWidthScale:this.config.visConfig.thickness,radiusScale:u},this.config.visConfig.fixedRadius?{}:{radiusMaxPixels:500}),h=A({getPosition:this.config.columns,getFilterValue:r.filterValueUpdateTriggers},this.getVisualChannelUpdateTriggers()),d=this.getDefaultDeckLayerProps(t),p=this.getBrushingExtensionProps(a),g=(0,v.getTextOffsetByRadius)(u,n.getRadius,s),y=[].concat((0,i.default)(d.extensions),[S]),m=A({getFilterValue:n.getFilterValue,extensions:y,filterRange:d.filterRange,visible:d.visible},p),b=this.hasHoveredObject(o);return[new f.ScatterplotLayer(A(A(A(A(A({},d),p),c),n),{},{parameters:{depthTest:(null===(e=this.config.columns.altitude)||void 0===e?void 0:e.fieldIdx)>-1},lineWidthUnits:"pixels",updateTriggers:h,extensions:y}))].concat((0,i.default)(b?[new f.ScatterplotLayer(A(A(A({},this.getDefaultHoverLayerProps()),c),{},{visible:d.visible,data:[b],getLineColor:this.config.highlightColor,getFillColor:this.config.highlightColor,getRadius:n.getRadius,getPosition:n.getPosition}))]:[]),(0,i.default)(this.renderTextLabelLayer({getPosition:n.getPosition,sharedProps:m,getPixelOffset:g,updateTriggers:h},t)))}}],[{key:"findDefaultLayerProps",value:function(t){var e=t.fieldPairs,n=[];return(void 0===e?[]:e).forEach((function(t){var e=t.pair.lat,r={label:t.defaultName||"Point"};e.value in m.DEFAULT_LAYER_COLOR&&(r.color=(0,g.hexToRgb)(m.DEFAULT_LAYER_COLOR[e.value])),0===n.length&&(r.isVisible=!0),r.columns=(0,b.assignPointPairToLayerColumn)(t,!0),n.push(r)})),{props:n}}}]),h}(p.default);e.default=M},39522:(t,e,n)=>{"use strict";var r=n(95709);Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.S2VisConfigs=e.defaultLineWidth=e.defaultElevation=e.S2TokenAccessor=e.s2RequiredColumns=e.S2_TOKEN_FIELDS=void 0;var i=r(n(82274)),o=r(n(65044)),s=r(n(41972)),a=r(n(96220)),l=r(n(56994)),u=r(n(65611)),c=r(n(18337)),h=r(n(26396)),d=n(64949),f=n(13848),p=r(n(37576)),g=r(n(65787)),y=n(35865),m=n(77244);function v(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function b(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?v(Object(n),!0).forEach((function(e){(0,h.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var _={token:["s2","s2_token"]};e.S2_TOKEN_FIELDS=_;var A=["token"];e.s2RequiredColumns=A;var x=function(t){var e=t.token;return function(t){return function(n){return t.valueAt(n.index,e.fieldIdx)}}};e.S2TokenAccessor=x,e.defaultElevation=500,e.defaultLineWidth=1;var w={opacity:"opacity",colorRange:"colorRange",filled:b(b({},f.LAYER_VIS_CONFIGS.filled),{},{type:"boolean",label:"Fill Color",defaultValue:!0,property:"filled"}),thickness:b(b({},f.LAYER_VIS_CONFIGS.thickness),{},{defaultValue:.5}),strokeColor:"strokeColor",strokeColorRange:"strokeColorRange",sizeRange:"strokeWidthRange",stroked:"stroked",enable3d:"enable3d",elevationScale:"elevationScale",enableElevationZoomFactor:"enableElevationZoomFactor",heightRange:"elevationRange",wireframe:"wireframe"};e.S2VisConfigs=w;var C=function(t){(0,l.default)(p,t);var e,n,r=(e=p,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=(0,c.default)(e);if(n){var i=(0,c.default)(this).constructor;t=Reflect.construct(r,arguments,i)}else t=r.apply(this,arguments);return(0,u.default)(this,t)});function p(t){var e;return(0,i.default)(this,p),e=r.call(this,t),(0,h.default)((0,s.default)(e),"dataToFeature",void 0),e.registerVisConfig(w),e.getPositionAccessor=function(t){return x(e.config.columns)(t)},e}return(0,o.default)(p,[{key:"type",get:function(){return"s2"}},{key:"name",get:function(){return"S2"}},{key:"requiredLayerColumns",get:function(){return A}},{key:"layerIcon",get:function(){return g.default}},{key:"visualChannels",get:function(){var t=(0,a.default)((0,c.default)(p.prototype),"visualChannels",this);return{color:b(b({},t.color),{},{accessor:"getFillColor"}),size:b(b({},t.size),{},{property:"stroke",accessor:"getLineWidth",condition:function(t){return t.visConfig.stroked},defaultValue:1}),strokeColor:{property:"strokeColor",field:"strokeColorField",scale:"strokeColorScale",domain:"strokeColorDomain",range:"strokeColorRange",key:"strokeColor",channelScaleType:f.CHANNEL_SCALES.color,accessor:"getLineColor",condition:function(t){return t.visConfig.stroked},nullValue:t.color.nullValue,defaultValue:function(t){return t.visConfig.strokeColor||t.color}},height:{property:"height",field:"heightField",scale:"heightScale",domain:"heightDomain",range:"heightRange",key:"height",channelScaleType:f.CHANNEL_SCALES.size,accessor:"getElevation",condition:function(t){return t.visConfig.enable3d},nullValue:0,defaultValue:500}}}},{key:"getDefaultLayerConfig",value:function(t){return b(b({},(0,a.default)((0,c.default)(p.prototype),"getDefaultLayerConfig",this).call(this,t)),{},{heightField:null,heightDomain:[0,1],heightScale:"linear",strokeColorField:null,strokeColorDomain:[0,1],strokeColorScale:"quantile"})}},{key:"calculateDataAttribute",value:function(t,e){t.dataContainer;for(var n=t.filteredIndex,r=[],i=0;i<n.length;i++){var o=n[i],s=e({index:o});(0,y.validS2Token)(s)&&r.push({index:o,token:s})}return r}},{key:"updateLayerMeta",value:function(t,e){var n=t.reduce((function(t,n,r){var i=e({index:r});return(0,y.validS2Token)(i)&&t.push((0,y.getS2Center)(i)),t}),[],!0),r=(0,m.createDataContainer)(n),i=this.getPointsBounds(r,(function(t,e){return[e.valueAt(t.index,0),e.valueAt(t.index,1)]}));this.dataToFeature={centroids:n},this.updateMeta({bounds:i})}},{key:"formatLayerData",value:function(t,e){if(null===this.config.dataId)return{};var n=t[this.config.dataId],r=n.gpuFilter,i=n.dataContainer,o=this.getPositionAccessor(i),s=this.updateData(t,e).data,a=this.getAttributeAccessors({dataContainer:i});return b({data:s,getS2Token:o,getFilterValue:r.filterValueAccessor(i)()},a)}},{key:"renderLayer",value:function(t){var e=t.data,n=t.gpuFilter,r=t.interactionConfig,i=t.mapState,o=this.getDefaultDeckLayerProps(t),s=this.getElevationZoomFactor(i),a=this.getZoomFactor(i),l=this.config.visConfig,u=b(b({},this.getVisualChannelUpdateTriggers()),{},{getFilterValue:n.filterValueUpdateTriggers});return[new d.S2Layer(b(b(b(b({},o),r),e),{},{getS2Token:function(t){return t.token},autoHighlight:l.enable3d,highlightColor:f.HIGHLIGH_COLOR_3D,lineWidthScale:l.thickness*a*8,stroked:l.stroked,lineMiterLimit:2,filled:l.filled,opacity:l.opacity,wrapLongitude:!1,elevationScale:l.elevationScale*s,extruded:l.enable3d,wireframe:l.wireframe,pickable:!0,updateTriggers:u}))]}}],[{key:"findDefaultLayerProps",value:function(t){var e=t.fields,n=void 0===e?[]:e,r=this.findDefaultColumnField(_,n);return r&&r.length?{props:r.map((function(t){return{isVisible:!0,label:"S2",columns:t}}))}:{props:[]}}}]),p}(p.default);e.default=C},65787:(t,e,n)=>{"use strict";var r=n(58784),i=n(95709);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=i(n(82274)),s=i(n(65044)),a=i(n(56994)),l=i(n(65611)),u=i(n(18337)),c=i(n(26396)),h=r(n(93345)),d=i(n(5556)),f=n(32268);var p=function(t){(0,a.default)(i,t);var e,n,r=(e=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=(0,u.default)(e);if(n){var i=(0,u.default)(this).constructor;t=Reflect.construct(r,arguments,i)}else t=r.apply(this,arguments);return(0,l.default)(this,t)});function i(){return(0,o.default)(this,i),r.apply(this,arguments)}return(0,s.default)(i,[{key:"render",value:function(){return h.default.createElement(f.Base,this.props,h.default.createElement("path",{d:"M14.76,58,15,20.54,50.06,6.75V44Zm4-34.86L18.6,52.38l27.66-11V12.33Z"}),h.default.createElement("path",{d:"M27.21,38.58a7.38,7.38,0,0,1-3.62-.9l.3-2a6.49,6.49,0,0,0,3.3.9c1.49,0,2.18-.59,2.18-1.63,0-2.26-5.71-1.28-5.71-5.3,0-2,1.26-3.54,4.16-3.54a8.38,8.38,0,0,1,3.28.64l-.29,1.9a8.41,8.41,0,0,0-2.88-.54c-1.63,0-2.14.66-2.14,1.42,0,2.19,5.71,1.18,5.71,5.27C31.5,37.16,29.93,38.58,27.21,38.58Z"}),h.default.createElement("path",{d:"M36.17,36.36v0h5.06l0,2H33.32V36.9c3-2.88,5.67-5.09,5.67-7,0-1-.64-1.67-2.19-1.67a5,5,0,0,0-3,1.1l-.53-1.79a6.31,6.31,0,0,1,3.91-1.28c2.66,0,4,1.34,4,3.41C41.21,31.94,39.13,33.89,36.17,36.36Z"}))}}]),i}(h.Component);(0,c.default)(p,"propTypes",{height:d.default.string,colors:d.default.arrayOf(d.default.string)}),(0,c.default)(p,"defaultProps",{height:"18px",predefinedClassName:"s2-layer-icon"});var g=p;e.default=g},35865:(t,e,n)=>{"use strict";var r=n(95709);Object.defineProperty(e,"__esModule",{value:!0}),e.getS2Center=function(t){var e=t.toString().padEnd(s,"0"),n=i.default.fromString(e,s),r=o.S2.idToLatLng(n.toString()),a=r.lat;return[r.lng,a]},e.validS2Token=function(t){return"string"==typeof t&&Boolean(t.match(a))};var i=r(n(83669)),o=n(96309),s=16,a=new RegExp("^[0-9a-z]*$","g")},21305:(t,e,n)=>{"use strict";var r=n(95709);Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.Table=void 0;var i,o,s=r(n(72189)),a=r(n(93345)),l=r(n(17850)),u=l.default.table(i||(i=(0,s.default)(["\n  width: 100%;\n  border-spacing: 0;\n\n  thead {\n    tr th {\n      background: ",";\n      color: ",";\n      padding: 18px 12px;\n      text-align: start;\n    }\n  }\n\n  tbody {\n    tr td {\n      border-bottom: ",";\n      padding: 12px;\n    }\n  }\n"])),(function(t){return t.theme.panelBackgroundLT}),(function(t){return t.theme.titleColorLT}),(function(t){return t.theme.panelBorderLT}));e.Table=u;var c=l.default.div(o||(o=(0,s.default)(["\n  font-size: 20px;\n  letter-spacing: 1.25px;\n  margin: 18px 0 14px 0;\n  color: ",";\n"])),(function(t){return t.theme.titleColorLT})),h=function(){return a.default.createElement(u,{className:"scenegraph-example-table"},a.default.createElement("thead",null,a.default.createElement("tr",null,a.default.createElement("th",null,"point_lat"),a.default.createElement("th",null,"point_lng"),a.default.createElement("th",null,"alt"))),a.default.createElement("tbody",null,a.default.createElement("tr",null,a.default.createElement("td",null,"37.769897"),a.default.createElement("td",null,"-122.41168"),a.default.createElement("td",null,"0")),a.default.createElement("tr",null,a.default.createElement("td",null,"37.806928"),a.default.createElement("td",null,"-122.40218"),a.default.createElement("td",null,"0")),a.default.createElement("tr",null,a.default.createElement("td",null,"37.778564"),a.default.createElement("td",null,"-122.39096"),a.default.createElement("td",null,"1000")),a.default.createElement("tr",null,a.default.createElement("td",null,"37.745995"),a.default.createElement("td",null,"-122.30220"),a.default.createElement("td",null,"2000")),a.default.createElement("tr",null,a.default.createElement("td",null,"37.329841"),a.default.createElement("td",null,"-122.103847"),a.default.createElement("td",null,"3000"))))};e.default=function(){return function(){return a.default.createElement("div",{className:"scenegraph-info-modal"},a.default.createElement("div",{className:"scenegraph-info-modal__description"},a.default.createElement("span",null,"In your csv you can specify points with optional altitude. The models will show at each point you specify. You can use a sample model or upload one in"," "),a.default.createElement("code",null,"glTF (GLB or Embedded)"),a.default.createElement("span",null," format.")),a.default.createElement("div",{className:"scenegraph-info-modal__example"},a.default.createElement(c,null,"Example:"),a.default.createElement(h,null)),a.default.createElement("div",{className:"scenegraph-info-modal__icons"},a.default.createElement(c,null,"Sample Models"),a.default.createElement("div",null,"Duck"),a.default.createElement("div",null,"Use your own model")))}}},3216:(t,e,n)=>{"use strict";var r=n(58784),i=n(95709);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=i(n(82274)),s=i(n(65044)),a=i(n(56994)),l=i(n(65611)),u=i(n(18337)),c=i(n(26396)),h=r(n(93345)),d=i(n(5556)),f=n(32268);var p=function(t){(0,a.default)(i,t);var e,n,r=(e=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=(0,u.default)(e);if(n){var i=(0,u.default)(this).constructor;t=Reflect.construct(r,arguments,i)}else t=r.apply(this,arguments);return(0,l.default)(this,t)});function i(){return(0,o.default)(this,i),r.apply(this,arguments)}return(0,s.default)(i,[{key:"render",value:function(){return h.default.createElement(f.Base,this.props,h.default.createElement("g",{transform:"translate(-20, -99)",id:"layer1"},h.default.createElement("g",{transform:"matrix(0.26458333,0,0,0.26458333,-191.59545,42.388813)",id:"g3042"},h.default.createElement("ellipse",{id:"path2999",cx:"931.42627",cy:"431.70096",rx:"62.283249",ry:"3.8673975",transform:"matrix(1.0332818,0,0,0.76491127,-30.674511,101.23938)"}),h.default.createElement("g",{id:"g7696",transform:"translate(525.68251,-207.68859)"},h.default.createElement("path",{id:"path7668",d:"m 393.98828,480.0918 c -10.68594,0.80336 -21.57673,7.18633 -28.60547,16.5332 -1.00324,0.62224 -3.5626,2.19214 -5.32812,2.97656 -2.56279,1.13864 -5.17733,2.74246 -7.98047,2.66016 -1.90943,-0.0561 -3.53566,-1.4477 -5.32031,-2.12891 -4.53998,-1.72443 -9.58546,-5.01773 -13.83594,-1.06445 -1.06796,1.52824 -0.66318,3.76636 -0.26563,5.58789 0.61739,2.82883 2.18398,5.45191 3.99024,7.71484 2.3163,2.9019 8.51367,7.1836 8.51367,7.1836 0,0 -5.90097,1.56898 -7.18164,3.99023 -0.45797,0.86587 -0.24013,2.08692 0.26562,2.92578 1.09219,1.81161 3.30762,2.80797 5.32032,3.45899 4.02627,1.30232 8.51745,-0.13838 12.67968,0.625 1.31495,0.24117 2.49566,1.01912 3.81446,1.23828 0.60636,0.10077 1.45382,0.0869 2.07422,0.0664 1.72295,3.33668 4.08103,6.36876 7.15625,8.80468 0,0 -2.22425,5.11025 -3.72266,7.44532 -8.94053,13.58909 -24.40686,25.32714 -26.73438,43.99218 0.0505,12.91431 6.57316,25.37407 16.24415,32.82422 16.96401,13.06839 41.70379,15.60258 62.9414,12.85938 19.21169,-2.48152 39.64942,-10.88975 52.11328,-25.71875 8.24478,-9.80932 10.46731,-24.07583 10.82813,-36.88477 0.29354,-10.4205 0.0459,-22.87017 -7.10547,-30.45508 -2.17907,-2.31118 -6.14999,-3.78838 -9.13672,-2.70703 -3.82412,1.38452 -4.00601,7.16466 -6.76758,10.15039 -2.72735,2.94875 -5.62298,6.30576 -9.47461,7.44531 -2.38943,0.70694 -5.03518,-0.0449 -7.44531,-0.67773 -7.17835,-1.88468 -13.0331,-7.65187 -20.30469,-9.13672 -5.52704,-1.1286 -16.91992,0.33984 -16.91992,0.33984 l 6.0918,-3.38476 c 0,0 10.28858,-6.55346 13.53515,-11.50586 4.26486,-6.50575 7.12111,-14.56296 6.76758,-22.33398 -0.86105,-19.16955 -13.62762,-32.46378 -36.20703,-32.82422 z"}),h.default.createElement("path",{id:"path7007",d:"m 338.82884,592.10146 c 2.32751,-18.66504 17.79291,-30.40265 26.73344,-43.99174 1.49841,-2.33507 3.72237,-7.44474 3.72237,-7.44474 -9.72152,-7.70054 -12.30749,-21.34514 -10.15193,-31.80941 4.68877,-15.70277 19.97053,-27.64482 34.85497,-28.76382 22.57941,0.36044 35.34754,13.65505 36.20859,32.8246 0.35353,7.77102 -2.5031,15.82851 -6.76796,22.33426 -3.24657,4.9524 -13.53592,11.50552 -13.53592,11.50552 l -6.09116,3.38399 c 0,0 11.39286,-1.467 16.9199,-0.3384 7.27159,1.48485 13.12552,7.25206 20.30387,9.13674 2.41013,0.63278 5.05533,1.38374 7.44476,0.6768 3.85163,-1.13955 6.74779,-4.496 9.47514,-7.44475 2.76157,-2.98573 2.94384,-8.76743 6.76796,-10.15195 2.98673,-1.08135 6.95767,0.39601 9.13674,2.70719 7.15138,7.58491 7.3999,20.03532 7.10636,30.45582 -0.36082,12.80894 -2.58395,27.07605 -10.82873,36.88537 -12.46386,14.829 -32.9016,23.23673 -52.11329,25.71825 -21.23761,2.7432 -45.97799,0.20927 -62.942,-12.85912 -9.67099,-7.45015 -16.19266,-19.9103 -16.24311,-32.82461 z"}),h.default.createElement("path",{id:"path7009",d:"m 338.82929,592.10139 c 0.0504,12.91431 6.57076,25.37435 16.24175,32.82449 16.96402,13.0684 41.70592,15.60201 62.94353,12.85882 16.49647,-2.13082 33.88089,-8.64571 46.3608,-19.82886 -11.1421,7.01421 -24.41974,11.29014 -37.17209,12.93733 -21.23762,2.74319 -45.97952,0.20958 -62.94353,-12.85882 -9.67099,-7.45014 -16.19132,-13.1378 -16.24175,-26.05211 1.29011,-12.22719 20.91701,-42.26515 18.15858,-41.25572 -2.75843,1.00943 -27.16334,24.82083 -27.34729,41.37487 z"}),h.default.createElement("path",{id:"path7019",d:"m 377.39451,569.59751 c 5.20454,-4.30421 12.0709,-7.93589 18.81215,-7.52486 10.1405,0.6183 16.82414,12.34588 26.71325,14.67347 9.16319,2.15674 28.21822,-1.12873 28.21822,-1.12873 0,0 -5.26736,15.74679 -10.91105,21.44586 -7.06529,7.13462 -16.80867,12.27156 -26.71325,13.92098 -8.25808,1.37523 -17.24717,-0.21883 -24.83203,-3.76243 -6.52035,-3.04627 -12.9578,-7.86122 -16.17845,-14.29723 -2.08339,-4.16338 -2.25437,-9.40356 -1.12872,-13.92099 0.90003,-3.61206 3.15128,-7.0337 6.01988,-9.40607 z"}),h.default.createElement("circle",{transform:"matrix(1.0416624,0,0,1.0416624,-10.12887,-52.065753)",r:"8",cy:"542.64807",cx:"388.79144",id:"path7031"}),h.default.createElement("circle",{transform:"matrix(1.1485883,0,0,1.1485883,-51.700726,-110.08886)",id:"circle7125",cx:"384.53302",cy:"599.31769",r:"8"}),h.default.createElement("path",{id:"path7130",d:"m 362.8314,531.83625 c 0,0 -1.86312,0.10762 -2.77606,-0.0441 -1.3188,-0.21916 -2.50024,-0.99563 -3.81519,-1.2368 -4.16223,-0.76338 -8.65327,0.67681 -12.67954,-0.62551 -2.0127,-0.65102 -4.22868,-1.64695 -5.32087,-3.45856 -0.50575,-0.83886 -0.72402,-2.06062 -0.26605,-2.92649 1.28067,-2.42125 7.18318,-3.99065 7.18318,-3.99065 0,0 -6.1971,-4.28129 -8.5134,-7.18319 -1.80626,-2.26293 -3.37327,-4.88645 -3.99066,-7.71528 -0.39755,-1.82153 -0.80191,-4.05867 0.26605,-5.58691 4.25048,-3.95328 9.29431,-0.66025 13.83429,1.06418 1.78465,0.68121 3.41144,2.07223 5.32087,2.12834 2.80314,0.0823 5.41853,-1.5218 7.98132,-2.66044 2.14112,-0.9513 6.11901,-3.45857 6.11901,-3.45857 0,0 -2.51761,3.36571 -3.19252,5.32088 -0.6999,2.02751 -0.77532,4.24025 -0.79815,6.38505 -0.0274,2.58533 0.36815,5.1658 0.79815,7.71527 0.51514,3.05437 2.24347,5.95014 2.12834,9.0455 -0.0938,2.52426 -2.27877,7.22725 -2.27877,7.22725 z"}),h.default.createElement("ellipse",{transform:"rotate(-70.917917)",ry:"8.876749",rx:"11.292704",cy:"523.04565",cx:"-351.69467",id:"path7132"}),h.default.createElement("ellipse",{id:"ellipse7134",cx:"-371.65863",cy:"539.63354",rx:"6.4400997",ry:"5.6922021",transform:"matrix(0.3727878,-0.92791662,0.95838646,0.28547397,0,0)"}),h.default.createElement("ellipse",{transform:"matrix(1.2858994,0,0,1.2858994,493.87481,-538.72884)",ry:"1.7910415",rx:"1.877719",cy:"810.7829",cx:"-89.047676",id:"path7136"}),h.default.createElement("path",{transform:"matrix(1.1485883,0,0,1.1485883,-51.700726,-110.08886)",id:"path7198",d:"m 383.88781,586.81856 c 0,0 4.75583,1.20253 7.03749,2.08594 2.91222,1.12756 8.43329,4.0806 8.43329,4.0806 l 2.17633,-1.0882 c 0,0 -6.13833,-5.82773 -10.06554,-6.2569 -5.46591,-0.59732 -7.58157,1.17856 -7.58157,1.17856 z"}),h.default.createElement("path",{transform:"matrix(1.1485883,0,0,1.1485883,-51.700726,-110.08886)",id:"path7248",d:"m 397.87853,516.42095 v 2 c 11.54716,4.14107 17.99592,13.80846 18.56055,26.37891 9.2e-4,0.0202 9.5e-4,0.0404 0.002,0.0605 0.0245,-0.68856 0.0292,-1.37543 -0.002,-2.06054 -0.56463,-12.57045 -7.01339,-22.23784 -18.56055,-26.37891 z m -43.76562,25.92578 c -0.13422,1.35759 -0.19199,2.74885 -0.14649,4.16016 0.0423,-1.42272 0.18091,-2.81599 0.4043,-4.16016 z"}),h.default.createElement("ellipse",{transform:"matrix(1.1796431,0.18084016,-0.22761203,0.93723889,-70.598803,-9.4836272)",ry:"2.1433234",rx:"6.0402751",cy:"433.62253",cx:"484.71768",id:"path7276"}),h.default.createElement("path",{transform:"matrix(1.1485883,0,0,1.1485883,-51.700726,-110.08886)",id:"path7358",d:"m 450.56176,570.21133 c 0.31422,-0.51687 0.84685,-1.08434 1.45172,-1.08879 0.8227,-0.006 1.51933,0.78122 1.99611,1.45172 1.20869,1.69982 1.81464,5.98831 1.81464,5.98831 0,0 -4.7514,-2.00855 -5.62539,-4.17367 -0.27546,-0.68237 -0.0193,-1.54878 0.36292,-2.17757 z"}),h.default.createElement("path",{transform:"matrix(1.1485883,0,0,1.1485883,-51.700726,-110.08886)",id:"path7436",d:"m 399.55635,576.28702 c 0,0 5.77103,-0.38519 8.54224,0.27556 7.19511,1.71555 13.03674,7.22358 20.1156,9.36891 2.31239,0.7008 7.16446,1.10222 7.16446,1.10222 0,0 -9.1879,1.00957 -13.50225,-0.27555 -4.98282,-1.48424 -8.43433,-6.25057 -13.22669,-8.26669 -2.87487,-1.20944 -9.09336,-2.20445 -9.09336,-2.20445 z"})))))}}]),i}(h.Component);e.default=p,(0,c.default)(p,"propTypes",{height:d.default.string,colors:d.default.arrayOf(d.default.string)}),(0,c.default)(p,"defaultProps",{height:"16px",predefinedClassName:"scenegraph-layer-icon",totalColor:3})},31044:(t,e,n)=>{"use strict";var r=n(95709);Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.scenegraphVisConfigs=e.scenegraphPosAccessor=e.scenegraphOptionalColumns=e.scenegraphRequiredColumns=void 0;var i=r(n(82274)),o=r(n(65044)),s=r(n(41972)),a=r(n(56994)),l=r(n(65611)),u=r(n(18337)),c=r(n(26396)),h=n(57231),d=n(70108),f=n(9256),p=r(n(37576)),g=r(n(3216)),y=r(n(21305)),m=n(13848);function v(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function b(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?v(Object(n),!0).forEach((function(e){(0,c.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var _=["lat","lng"];e.scenegraphRequiredColumns=_;var A=["altitude"];function x(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.propName,r=e.layer;return"scenegraph"===n?(0,d.load)(t,f.GLTFLoader,r.getLoadOptions()):x(t).then((function(t){return t.json()}))}e.scenegraphOptionalColumns=A;var w=function(t){var e=t.lat,n=t.lng,r=t.altitude;return function(t){return function(i){return[t.valueAt(i.index,n.fieldIdx),t.valueAt(i.index,e.fieldIdx),r&&r.fieldIdx>-1?t.valueAt(i.index,r.fieldIdx):0]}}};e.scenegraphPosAccessor=w;var C={opacity:"opacity",colorRange:"colorRange",sizeScale:"sizeScale",angleX:b(b({},m.LAYER_VIS_CONFIGS.angle),{},{property:"angleX",label:"angle X"}),angleY:b(b({},m.LAYER_VIS_CONFIGS.angle),{},{property:"angleY",label:"angle Y"}),angleZ:b(b({},m.LAYER_VIS_CONFIGS.angle),{},{property:"angleZ",defaultValue:90,label:"angle Z"})};e.scenegraphVisConfigs=C;var S=[0,0,0],E=[1,1,1],M=[255,255,255,255],P=function(t){(0,a.default)(d,t);var e,n,r=(e=d,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=(0,u.default)(e);if(n){var i=(0,u.default)(this).constructor;t=Reflect.construct(r,arguments,i)}else t=r.apply(this,arguments);return(0,l.default)(this,t)});function d(t){var e;return(0,i.default)(this,d),e=r.call(this,t),(0,c.default)((0,s.default)(e),"_layerInfoModal",void 0),e.registerVisConfig(C),e.getPositionAccessor=function(t){return w(e.config.columns)(t)},e._layerInfoModal=(0,y.default)(),e}return(0,o.default)(d,[{key:"type",get:function(){return"3D"}},{key:"requiredLayerColumns",get:function(){return _}},{key:"optionalColumns",get:function(){return A}},{key:"columnPairs",get:function(){return this.defaultPointColumnPairs}},{key:"layerIcon",get:function(){return g.default}},{key:"layerInfoModal",get:function(){return{id:"scenegraphInfo",template:this._layerInfoModal,modalProps:{title:"How to use Scenegraph"}}}},{key:"calculateDataAttribute",value:function(t,e){t.dataContainer;for(var n=t.filteredIndex,r=[],i=0;i<n.length;i++){var o=n[i],s=e({index:o});s.every(Number.isFinite)&&r.push({position:s,index:o})}return r}},{key:"formatLayerData",value:function(t,e){if(null===this.config.dataId)return{};var n=t[this.config.dataId],r=n.gpuFilter,i=n.dataContainer;return{data:this.updateData(t,e).data,getPosition:this.getPositionAccessor(i),getFilterValue:r.filterValueAccessor(i)()}}},{key:"updateLayerMeta",value:function(t,e){var n=this.getPointsBounds(t,e);this.updateMeta({bounds:n})}},{key:"renderLayer",value:function(t){var e=t.data,n=t.gpuFilter,r=this.config.visConfig,i=r.sizeScale,o=void 0===i?1:i,s=r.angleX,a=void 0===s?0:s,l=r.angleY,u=void 0===l?0:l,c=r.angleZ,d=void 0===c?90:c;return[new h.ScenegraphLayer(b(b(b({},this.getDefaultDeckLayerProps(t)),{},{extensions:[]},e),{},{fetch:x,scenegraph:this.config.visConfig.scenegraph||"https://raw.githubusercontent.com/KhronosGroup/glTF-Sample-Models/master/2.0/Duck/glTF-Binary/Duck.glb",sizeScale:o,getTranslation:S,getScale:E,getOrientation:[a,u,d],getColor:M,parameters:{depthTest:!0,blend:!1},updateTriggers:{getOrientation:{angleX:a,angleY:u,angleZ:d},getPosition:this.config.columns,getFilterValue:n.filterValueUpdateTriggers}}))]}}]),d}(p.default);e.default=P},91241:(t,e,n)=>{"use strict";var r=n(58784),i=n(95709);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=i(n(82274)),s=i(n(65044)),a=i(n(56994)),l=i(n(65611)),u=i(n(18337)),c=i(n(26396)),h=r(n(93345)),d=n(32268);var f=function(t){(0,a.default)(i,t);var e,n,r=(e=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=(0,u.default)(e);if(n){var i=(0,u.default)(this).constructor;t=Reflect.construct(r,arguments,i)}else t=r.apply(this,arguments);return(0,l.default)(this,t)});function i(){return(0,o.default)(this,i),r.apply(this,arguments)}return(0,s.default)(i,[{key:"render",value:function(){return h.default.createElement(d.Base,this.props,h.default.createElement("path",{d:"M56.0384598,50.5v-8.3076935H8.9615383V50.5H56.0384598z M8.9615383,22.8076916h13.8461533V14.5H8.9615383 V22.8076916z M25.5769234,22.8076916h13.8461533V14.5H25.5769234V22.8076916z M42.1923065,22.8076916h13.8461533V14.5H42.1923065 V22.8076916z M8.9615383,36.6538467h47.0769196v-8.3076935H8.9615383V36.6538467z"}))}}]),i}(h.Component);e.default=f,(0,c.default)(f,"defaultProps",{height:"16px",predefinedClassName:"data-ex-icons-table"})},98575:(t,e,n)=>{"use strict";var r=n(95709);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i,o,s=r(n(72189)),a=r(n(93345)),l=r(n(17850)),u=n(80652),c=l.default.code(i||(i=(0,s.default)(["\n  color: ",";\n"])),(function(t){return t.theme.titleColorLT})),h=l.default.div(o||(o=(0,s.default)(["\n  font-size: 20px;\n  letter-spacing: 1.25px;\n  margin: 18px 0 14px 0;\n  color: ",";\n"])),(function(t){return t.theme.titleColorLT}));e.default=function(){return function(){return a.default.createElement("div",{className:"trip-info-modal"},a.default.createElement("div",{className:"trip-info-modal__description"},a.default.createElement("p",null,a.default.createElement(u.FormattedMessage,{id:"modal.tripInfo.description1"}),a.default.createElement("code",null,a.default.createElement(u.FormattedMessage,{id:"modal.tripInfo.code"})),a.default.createElement(u.FormattedMessage,{id:"modal.tripInfo.description2"}))),a.default.createElement("div",{className:"trip-info-modal__example"},a.default.createElement(h,null,a.default.createElement(u.FormattedMessage,{id:"modal.tripInfo.example"})),a.default.createElement("pre",null,a.default.createElement(c,null,'\n              {\n                "type": "FeatureCollection",\n                "features": [\n                  {\n                    "type": "Feature",\n                    "properties": { "vendor":  "A",\n                    "vol":20},\n                    "geometry": {\n                      "type": "LineString",\n                      "coordinates": [\n                        [-74.20986, 40.81773, 0, 1564184363],\n                        [-74.20987, 40.81765, 0, 1564184396],\n                        [-74.20998, 40.81746, 0, 1564184409]\n                      ]\n                    }\n                  }\n                ]\n              }\n            '))))}}},40438:(t,e,n)=>{"use strict";var r=n(58784),i=n(95709);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=i(n(82274)),s=i(n(65044)),a=i(n(56994)),l=i(n(65611)),u=i(n(18337)),c=i(n(26396)),h=r(n(93345)),d=i(n(5556)),f=n(32268);var p=function(t){(0,a.default)(i,t);var e,n,r=(e=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=(0,u.default)(e);if(n){var i=(0,u.default)(this).constructor;t=Reflect.construct(r,arguments,i)}else t=r.apply(this,arguments);return(0,l.default)(this,t)});function i(){return(0,o.default)(this,i),r.apply(this,arguments)}return(0,s.default)(i,[{key:"render",value:function(){return h.default.createElement(f.Base,this.props,h.default.createElement("g",{clipPath:"url(#clip0)",className:"cr1"},h.default.createElement("path",{d:"M53.025 4.85005C50.25 2.07505 45.75 2.07505 42.975 4.85005C40.2 7.62505 40.2 12.2 42.975 14.975L48 20L53.025 14.9C55.8 12.2 55.8 7.62505 53.025 4.85005ZM48 11.375C47.175 11.375 46.5 10.7 46.5 9.87505C46.5 9.05005 47.175 8.37505 48 8.37505C48.825 8.37505 49.5 9.05005 49.5 9.87505C49.5 10.7 48.825 11.375 48 11.375Z"})),h.default.createElement("g",{clipPath:"url(#clip1)",className:"cr2"},h.default.createElement("path",{d:"M20.025 36.85C17.25 34.075 12.75 34.075 9.97502 36.85C7.20002 39.625 7.20002 44.2 9.97502 46.975L15 52L20.025 46.9C22.8 44.2 22.8 39.625 20.025 36.85ZM15 43.375C14.175 43.375 13.5 42.7 13.5 41.875C13.5 41.05 14.175 40.375 15 40.375C15.825 40.375 16.5 41.05 16.5 41.875C16.5 42.7 15.825 43.375 15 43.375Z"})),h.default.createElement("path",{className:"cr3",d:"M45.9943 19.8697C46.0661 20.6951 45.4552 21.4223 44.6299 21.4941L34.782 22.3504L38.1515 40.1604L17.8748 54.7185C17.2019 55.2016 16.2647 55.0478 15.7815 54.3748C15.2984 53.7019 15.4522 52.7647 16.1252 52.2815L34.8483 38.8389L31.2177 19.6491L44.37 18.5053C45.1953 18.4336 45.9225 19.0444 45.9943 19.8697Z"}),h.default.createElement("defs",null,h.default.createElement("clipPath",{id:"clip0"},h.default.createElement("rect",{width:"18",height:"18",transform:"translate(39 2)"})),h.default.createElement("clipPath",{id:"clip1"},h.default.createElement("rect",{width:"18",height:"18",transform:"translate(6 34)"}))))}}]),i}(h.Component);e.default=p,(0,c.default)(p,"propTypes",{height:d.default.string,colors:d.default.arrayOf(d.default.string)}),(0,c.default)(p,"defaultProps",{size:"tiny",height:"16px",predefinedClassName:"trip-layer-icon"})},70890:(t,e,n)=>{"use strict";var r=n(95709);Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.featureResolver=e.featureAccessor=e.geoJsonRequiredColumns=e.tripVisConfigs=e.defaultLineWidth=e.defaultThickness=void 0;var i=r(n(21259)),o=r(n(82274)),s=r(n(65044)),a=r(n(41972)),l=r(n(96220)),u=r(n(56994)),c=r(n(65611)),h=r(n(18337)),d=r(n(26396)),f=r(n(47654)),p=r(n(90879)),g=r(n(37576)),y=n(64949),m=n(13848),v=r(n(40438)),b=n(10962),_=n(77346),A=r(n(98575));function x(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function w(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?x(Object(n),!0).forEach((function(e){(0,d.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}e.defaultThickness=.5,e.defaultLineWidth=1;var C={opacity:"opacity",thickness:{type:"number",defaultValue:.5,label:"Stroke Width",isRanged:!1,range:[0,100],step:.1,group:"stroke",property:"thickness"},colorRange:"colorRange",trailLength:"trailLength",sizeRange:"strokeWidthRange"};e.tripVisConfigs=C;var S=["geojson"];e.geoJsonRequiredColumns=S;var E=function(t){var e=t.geojson;return function(t){return function(n){return t.valueAt(n.index,e.fieldIdx)}}};e.featureAccessor=E;var M=function(t){return t.geojson.fieldIdx};e.featureResolver=M;var P=function(t){(0,u.default)(g,t);var e,n,r=(e=g,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=(0,h.default)(e);if(n){var i=(0,h.default)(this).constructor;t=Reflect.construct(r,arguments,i)}else t=r.apply(this,arguments);return(0,c.default)(this,t)});function g(t){var e;return(0,o.default)(this,g),e=r.call(this,t),(0,d.default)((0,a.default)(e),"dataToFeature",void 0),(0,d.default)((0,a.default)(e),"dataToTimeStamp",void 0),(0,d.default)((0,a.default)(e),"getFeature",void 0),(0,d.default)((0,a.default)(e),"_layerInfoModal",void 0),e.dataToFeature=[],e.dataToTimeStamp=[],e.registerVisConfig(C),e.getFeature=(0,f.default)(E,M),e._layerInfoModal=(0,A.default)(),e}return(0,s.default)(g,[{key:"type",get:function(){return g.type}},{key:"name",get:function(){return"Trip"}},{key:"layerIcon",get:function(){return v.default}},{key:"columnPairs",get:function(){return this.defaultPointColumnPairs}},{key:"requiredLayerColumns",get:function(){return S}},{key:"visualChannels",get:function(){var t=(0,l.default)((0,h.default)(g.prototype),"visualChannels",this);return w(w({},t),{},{color:w(w({},t.color),{},{accessor:"getColor",nullValue:t.color.nullValue,getAttributeValue:function(t){return function(e){return e.properties.lineColor||t.color}},defaultValue:function(t){return t.color}}),size:w(w({},t.size),{},{property:"stroke",accessor:"getWidth",condition:function(t){return t.visConfig.stroked},nullValue:0,getAttributeValue:function(){return function(t){return t.properties.lineWidth||1}}})})}},{key:"animationDomain",get:function(){return this.config.animation.domain}},{key:"layerInfoModal",get:function(){return{id:"iconInfo",template:this._layerInfoModal,modalProps:{title:"modal.tripInfo.title"}}}},{key:"getPositionAccessor",value:function(t){return this.getFeature(this.config.columns)(t)}},{key:"getDefaultLayerConfig",value:function(t){return w(w({},(0,l.default)((0,h.default)(g.prototype),"getDefaultLayerConfig",this).call(this,t)),{},{animation:{enabled:!0,domain:null}})}},{key:"getHoverData",value:function(t,e){return e.row(t.properties.index)}},{key:"calculateDataAttribute",value:function(t,e){var n=this;return t.dataContainer,t.filteredIndex.map((function(t){return n.dataToFeature[t]})).filter((function(t){return t&&"LineString"===t.geometry.type}))}},{key:"formatLayerData",value:function(t,e){var n=this;if(null===this.config.dataId)return{};var r=t[this.config.dataId],i=r.dataContainer,o=r.gpuFilter,s=this.updateData(t,e).data,a=this.getAttributeAccessors({dataAccessor:function(t){return function(t){return{index:t.properties.index}}},dataContainer:i});return w({data:s,getFilterValue:o.filterValueAccessor(i)((function(t){return t.properties.index}),(function(t,e,n){return t.valueAt(e.properties.index,n)})),getPath:function(t){return t.geometry.coordinates},getTimestamps:function(t){return n.dataToTimeStamp[t.properties.index]}},a)}},{key:"updateAnimationDomain",value:function(t){this.updateLayerConfig({animation:w(w({},this.config.animation),{},{domain:t})})}},{key:"updateLayerMeta",value:function(t){var e=this.getPositionAccessor(t);if(e!==this.meta.getFeature){this.dataToFeature=(0,b.getGeojsonDataMaps)(t,e);var n=(0,_.parseTripGeoJsonTimestamp)(this.dataToFeature),r=n.dataToTimeStamp,i=n.animationDomain;this.dataToTimeStamp=r,this.updateAnimationDomain(i);var o=(0,b.getGeojsonBounds)(this.dataToFeature),s=(0,b.getGeojsonFeatureTypes)(this.dataToFeature);this.updateMeta({bounds:o,featureTypes:s,getFeature:e})}}},{key:"setInitialLayerConfig",value:function(t){var e=t.dataContainer;return e.numRows()?(this.updateLayerMeta(e),this):this}},{key:"renderLayer",value:function(t){var e,n=t.data,r=t.gpuFilter,i=t.mapState,o=t.animationConfig,s=this.config.visConfig,a=this.getZoomFactor(i);if(!(o&&Array.isArray(o.domain)&&o.domain.every(Number.isFinite)&&Number.isFinite(o.currentTime)))return[];var l=null===(e=o.domain)||void 0===e?void 0:e[0],u=w(w({},this.getVisualChannelUpdateTriggers()),{},{getTimestamps:{columns:this.config.columns,domain0:l},getFilterValue:r.filterValueUpdateTriggers}),c=this.getDefaultDeckLayerProps(t);return[new y.TripsLayer(w(w(w({},c),n),{},{getTimestamps:function(t){return(n.getTimestamps(t)||[]).map((function(t){return t-l}))},widthScale:this.config.visConfig.thickness*a*8,capRounded:!0,jointRounded:!0,wrapLongitude:!1,parameters:{depthTest:i.dragRotate,depthMask:!1},trailLength:1e3*s.trailLength,currentTime:o.currentTime-l,updateTriggers:u}))]}}],[{key:"type",get:function(){return"trip"}},{key:"findDefaultLayerProps",value:function(t,e){var n=this,r=t.label,o=t.fields,s=void 0===o?[]:o,a=t.dataContainer,l=t.id,u=s.filter((function(t){return"geojson"===t.type})).map((function(t){return t.name})),c={geojson:(0,p.default)([].concat((0,i.default)(m.GEOJSON_FIELDS.geojson),(0,i.default)(u)))},h=(this.findDefaultColumnField(c,s)||[]).filter((function(t){return(0,_.isTripGeoJsonField)(a,s[t.geojson.fieldIdx])}));return h.length?{props:h.map((function(t){return{label:"string"==typeof r&&r.replace(/\.[^/.]+$/,"")||n.type,columns:t,isVisible:!0}})),foundLayers:e.filter((function(t){return"geojson"!==t.type||t.dataId!==l||!h.find((function(e){return t.columns.geojson.name===e.geojson.name}))}))}:{props:[]}}}]),g}(g.default);e.default=P},77346:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.coordHasLength4=s,e.containValidTime=a,e.isTripGeoJsonField=function(t,e){if(t.numRows()<1)return!1;var n=(t.numRows()>1e4?(0,o.getSampleContainerData)(t,1e4):t).mapIndex(e.valueAccessor).map(i.parseGeoJsonRawFeature).filter(o.notNullorUndefined);if(!(0,i.getGeojsonFeatureTypes)(n).line)return!1;if(!s(n))return!1;var r=n[0].geometry.coordinates.map((function(t){return t[3]}));return Boolean(a(r))},e.parseTripGeoJsonTimestamp=function(t){var e={dataToTimeStamp:[],animationDomain:null},n=t.find((function(t){var e,n,r;return(null==t||null===(e=t.geometry)||void 0===e||null===(n=e.coordinates)||void 0===n||null===(r=n[0])||void 0===r?void 0:r.length)>3}));if(!n)return e;var r=a(n.geometry.coordinates.map((function(t){return t[3]})));if(!r)return e;var i=r.format,s=function(t){return t&&(0,o.notNullorUndefined)(t[3])?(0,o.timeToUnixMilli)(t[3],i):null},u=t.map((function(t){return t&&t.geometry&&Array.isArray(t.geometry.coordinates)?t.geometry.coordinates.map(s):null}));return{dataToTimeStamp:u,animationDomain:l(u)}},e.getAnimationDomainFromTimestamps=l;var r=n(53214),i=n(10962),o=n(77244);function s(t){for(var e=!0,n=0;n<t.length;n+=1){var r,i;if(!(e=Array.isArray(null===(r=t[n])||void 0===r||null===(i=r.geometry)||void 0===i?void 0:i.coordinates)&&!t[n].geometry.coordinates.find((function(t){return t.length<4}))))break}return e}function a(t){var e=t.map((function(t){return{ts:t}})),n=Object.keys(r.DATA_TYPES).filter((function(t){return![r.DATA_TYPES.TIME,r.DATA_TYPES.DATETIME].includes(t)})),i=r.Analyzer.computeColMeta(e,[],{ignoredDataTypes:n})[0];return i&&"TIME"===i.category?i:null}function l(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).reduce((function(t,e){var n,r=(null==(n=e)?void 0:n.find((function(t){return(0,o.notNullorUndefined)(t)&&Number.isFinite(t)})))||null,i=function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=t.length-1;e>0;){if((0,o.notNullorUndefined)(t[e])&&Number.isFinite(t[e]))return t[e];e--}return null}(e);return(0,o.notNullorUndefined)(r)&&(0,o.notNullorUndefined)(i)&&Number.isFinite(r)&&Number.isFinite(i)&&(t[0]=Math.min(t[0],r),t[1]=Math.max(t[1],i)),t}),[1/0,-1/0])}},44798:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(43968);function i(t){var e=[1/0,1/0,-1/0,-1/0];return r.coordEach(t,(function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])})),e}i.default=i,e.default=i},26140:function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var i=r(n(44798)),o=n(26652);e.default=function(t,e){void 0===e&&(e={});var n=i.default(t),r=(n[0]+n[2])/2,s=(n[1]+n[3])/2;return o.point([r,s],e.properties,e)}},26652:(t,e)=>{"use strict";function n(t,e,n){void 0===n&&(n={});var r={type:"Feature"};return(0===n.id||n.id)&&(r.id=n.id),n.bbox&&(r.bbox=n.bbox),r.properties=e||{},r.geometry=t,r}function r(t,e,r){if(void 0===r&&(r={}),!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!f(t[0])||!f(t[1]))throw new Error("coordinates must contain numbers");return n({type:"Point",coordinates:t},e,r)}function i(t,e,r){void 0===r&&(r={});for(var i=0,o=t;i<o.length;i++){var s=o[i];if(s.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var a=0;a<s[s.length-1].length;a++)if(s[s.length-1][a]!==s[0][a])throw new Error("First and last Position are not equivalent.")}return n({type:"Polygon",coordinates:t},e,r)}function o(t,e,r){if(void 0===r&&(r={}),t.length<2)throw new Error("coordinates must be an array of two or more positions");return n({type:"LineString",coordinates:t},e,r)}function s(t,e){void 0===e&&(e={});var n={type:"FeatureCollection"};return e.id&&(n.id=e.id),e.bbox&&(n.bbox=e.bbox),n.features=t,n}function a(t,e,r){return void 0===r&&(r={}),n({type:"MultiLineString",coordinates:t},e,r)}function l(t,e,r){return void 0===r&&(r={}),n({type:"MultiPoint",coordinates:t},e,r)}function u(t,e,r){return void 0===r&&(r={}),n({type:"MultiPolygon",coordinates:t},e,r)}function c(t,n){void 0===n&&(n="kilometers");var r=e.factors[n];if(!r)throw new Error(n+" units is invalid");return t*r}function h(t,n){void 0===n&&(n="kilometers");var r=e.factors[n];if(!r)throw new Error(n+" units is invalid");return t/r}function d(t){return t%(2*Math.PI)*180/Math.PI}function f(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.earthRadius=6371008.8,e.factors={centimeters:100*e.earthRadius,centimetres:100*e.earthRadius,degrees:e.earthRadius/111325,feet:3.28084*e.earthRadius,inches:39.37*e.earthRadius,kilometers:e.earthRadius/1e3,kilometres:e.earthRadius/1e3,meters:e.earthRadius,metres:e.earthRadius,miles:e.earthRadius/1609.344,millimeters:1e3*e.earthRadius,millimetres:1e3*e.earthRadius,nauticalmiles:e.earthRadius/1852,radians:1,yards:1.0936*e.earthRadius},e.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/e.earthRadius,yards:1.0936133},e.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},e.feature=n,e.geometry=function(t,e,n){switch(void 0===n&&(n={}),t){case"Point":return r(e).geometry;case"LineString":return o(e).geometry;case"Polygon":return i(e).geometry;case"MultiPoint":return l(e).geometry;case"MultiLineString":return a(e).geometry;case"MultiPolygon":return u(e).geometry;default:throw new Error(t+" is invalid")}},e.point=r,e.points=function(t,e,n){return void 0===n&&(n={}),s(t.map((function(t){return r(t,e)})),n)},e.polygon=i,e.polygons=function(t,e,n){return void 0===n&&(n={}),s(t.map((function(t){return i(t,e)})),n)},e.lineString=o,e.lineStrings=function(t,e,n){return void 0===n&&(n={}),s(t.map((function(t){return o(t,e)})),n)},e.featureCollection=s,e.multiLineString=a,e.multiPoint=l,e.multiPolygon=u,e.geometryCollection=function(t,e,r){return void 0===r&&(r={}),n({type:"GeometryCollection",geometries:t},e,r)},e.round=function(t,e){if(void 0===e&&(e=0),e&&!(e>=0))throw new Error("precision must be a positive number");var n=Math.pow(10,e||0);return Math.round(t*n)/n},e.radiansToLength=c,e.lengthToRadians=h,e.lengthToDegrees=function(t,e){return d(h(t,e))},e.bearingToAzimuth=function(t){var e=t%360;return e<0&&(e+=360),e},e.radiansToDegrees=d,e.degreesToRadians=function(t){return t%360*Math.PI/180},e.convertLength=function(t,e,n){if(void 0===e&&(e="kilometers"),void 0===n&&(n="kilometers"),!(t>=0))throw new Error("length must be a positive number");return c(h(t,e),n)},e.convertArea=function(t,n,r){if(void 0===n&&(n="meters"),void 0===r&&(r="kilometers"),!(t>=0))throw new Error("area must be a positive number");var i=e.areaFactors[n];if(!i)throw new Error("invalid original units");var o=e.areaFactors[r];if(!o)throw new Error("invalid final units");return t/i*o},e.isNumber=f,e.isObject=function(t){return!!t&&t.constructor===Object},e.validateBBox=function(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach((function(t){if(!f(t))throw new Error("bbox must only contain numbers")}))},e.validateId=function(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof t))throw new Error("id must be a number or a string")}},43968:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(26652);function i(t,e,n){if(null!==t)for(var r,o,s,a,l,u,c,h,d=0,f=0,p=t.type,g="FeatureCollection"===p,y="Feature"===p,m=g?t.features.length:1,v=0;v<m;v++){l=(h=!!(c=g?t.features[v].geometry:y?t.geometry:t)&&"GeometryCollection"===c.type)?c.geometries.length:1;for(var b=0;b<l;b++){var _=0,A=0;if(null!==(a=h?c.geometries[b]:c)){u=a.coordinates;var x=a.type;switch(d=!n||"Polygon"!==x&&"MultiPolygon"!==x?0:1,x){case null:break;case"Point":if(!1===e(u,f,v,_,A))return!1;f++,_++;break;case"LineString":case"MultiPoint":for(r=0;r<u.length;r++){if(!1===e(u[r],f,v,_,A))return!1;f++,"MultiPoint"===x&&_++}"LineString"===x&&_++;break;case"Polygon":case"MultiLineString":for(r=0;r<u.length;r++){for(o=0;o<u[r].length-d;o++){if(!1===e(u[r][o],f,v,_,A))return!1;f++}"MultiLineString"===x&&_++,"Polygon"===x&&A++}"Polygon"===x&&_++;break;case"MultiPolygon":for(r=0;r<u.length;r++){for(A=0,o=0;o<u[r].length;o++){for(s=0;s<u[r][o].length-d;s++){if(!1===e(u[r][o][s],f,v,_,A))return!1;f++}A++}_++}break;case"GeometryCollection":for(r=0;r<a.geometries.length;r++)if(!1===i(a.geometries[r],e,n))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function o(t,e){var n;switch(t.type){case"FeatureCollection":for(n=0;n<t.features.length&&!1!==e(t.features[n].properties,n);n++);break;case"Feature":e(t.properties,0)}}function s(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var n=0;n<t.features.length&&!1!==e(t.features[n],n);n++);}function a(t,e){var n,r,i,o,s,a,l,u,c,h,d=0,f="FeatureCollection"===t.type,p="Feature"===t.type,g=f?t.features.length:1;for(n=0;n<g;n++){for(a=f?t.features[n].geometry:p?t.geometry:t,u=f?t.features[n].properties:p?t.properties:{},c=f?t.features[n].bbox:p?t.bbox:void 0,h=f?t.features[n].id:p?t.id:void 0,s=(l=!!a&&"GeometryCollection"===a.type)?a.geometries.length:1,i=0;i<s;i++)if(null!==(o=l?a.geometries[i]:a))switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===e(o,d,u,c,h))return!1;break;case"GeometryCollection":for(r=0;r<o.geometries.length;r++)if(!1===e(o.geometries[r],d,u,c,h))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===e(null,d,u,c,h))return!1;d++}}function l(t,e){a(t,(function(t,n,i,o,s){var a,l=null===t?null:t.type;switch(l){case null:case"Point":case"LineString":case"Polygon":return!1!==e(r.feature(t,i,{bbox:o,id:s}),n,0)&&void 0}switch(l){case"MultiPoint":a="Point";break;case"MultiLineString":a="LineString";break;case"MultiPolygon":a="Polygon"}for(var u=0;u<t.coordinates.length;u++){var c={type:a,coordinates:t.coordinates[u]};if(!1===e(r.feature(c,i),n,u))return!1}}))}function u(t,e){l(t,(function(t,n,o){var s=0;if(t.geometry){var a=t.geometry.type;if("Point"!==a&&"MultiPoint"!==a){var l,u=0,c=0,h=0;return!1!==i(t,(function(i,a,d,f,p){if(void 0===l||n>u||f>c||p>h)return l=i,u=n,c=f,h=p,void(s=0);var g=r.lineString([l,i],t.properties);if(!1===e(g,n,o,p,s))return!1;s++,l=i}))&&void 0}}}))}function c(t,e){if(!t)throw new Error("geojson is required");l(t,(function(t,n,i){if(null!==t.geometry){var o=t.geometry.type,s=t.geometry.coordinates;switch(o){case"LineString":if(!1===e(t,n,i,0,0))return!1;break;case"Polygon":for(var a=0;a<s.length;a++)if(!1===e(r.lineString(s[a],t.properties),n,i,a))return!1}}}))}e.coordAll=function(t){var e=[];return i(t,(function(t){e.push(t)})),e},e.coordEach=i,e.coordReduce=function(t,e,n,r){var o=n;return i(t,(function(t,r,i,s,a){o=0===r&&void 0===n?t:e(o,t,r,i,s,a)}),r),o},e.featureEach=s,e.featureReduce=function(t,e,n){var r=n;return s(t,(function(t,i){r=0===i&&void 0===n?t:e(r,t,i)})),r},e.findPoint=function(t,e){if(e=e||{},!r.isObject(e))throw new Error("options is invalid");var n,i=e.featureIndex||0,o=e.multiFeatureIndex||0,s=e.geometryIndex||0,a=e.coordIndex||0,l=e.properties;switch(t.type){case"FeatureCollection":i<0&&(i=t.features.length+i),l=l||t.features[i].properties,n=t.features[i].geometry;break;case"Feature":l=l||t.properties,n=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":n=t;break;default:throw new Error("geojson is invalid")}if(null===n)return null;var u=n.coordinates;switch(n.type){case"Point":return r.point(u,l,e);case"MultiPoint":return o<0&&(o=u.length+o),r.point(u[o],l,e);case"LineString":return a<0&&(a=u.length+a),r.point(u[a],l,e);case"Polygon":return s<0&&(s=u.length+s),a<0&&(a=u[s].length+a),r.point(u[s][a],l,e);case"MultiLineString":return o<0&&(o=u.length+o),a<0&&(a=u[o].length+a),r.point(u[o][a],l,e);case"MultiPolygon":return o<0&&(o=u.length+o),s<0&&(s=u[o].length+s),a<0&&(a=u[o][s].length-a),r.point(u[o][s][a],l,e)}throw new Error("geojson is invalid")},e.findSegment=function(t,e){if(e=e||{},!r.isObject(e))throw new Error("options is invalid");var n,i=e.featureIndex||0,o=e.multiFeatureIndex||0,s=e.geometryIndex||0,a=e.segmentIndex||0,l=e.properties;switch(t.type){case"FeatureCollection":i<0&&(i=t.features.length+i),l=l||t.features[i].properties,n=t.features[i].geometry;break;case"Feature":l=l||t.properties,n=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":n=t;break;default:throw new Error("geojson is invalid")}if(null===n)return null;var u=n.coordinates;switch(n.type){case"Point":case"MultiPoint":return null;case"LineString":return a<0&&(a=u.length+a-1),r.lineString([u[a],u[a+1]],l,e);case"Polygon":return s<0&&(s=u.length+s),a<0&&(a=u[s].length+a-1),r.lineString([u[s][a],u[s][a+1]],l,e);case"MultiLineString":return o<0&&(o=u.length+o),a<0&&(a=u[o].length+a-1),r.lineString([u[o][a],u[o][a+1]],l,e);case"MultiPolygon":return o<0&&(o=u.length+o),s<0&&(s=u[o].length+s),a<0&&(a=u[o][s].length-a-1),r.lineString([u[o][s][a],u[o][s][a+1]],l,e)}throw new Error("geojson is invalid")},e.flattenEach=l,e.flattenReduce=function(t,e,n){var r=n;return l(t,(function(t,i,o){r=0===i&&0===o&&void 0===n?t:e(r,t,i,o)})),r},e.geomEach=a,e.geomReduce=function(t,e,n){var r=n;return a(t,(function(t,i,o,s,a){r=0===i&&void 0===n?t:e(r,t,i,o,s,a)})),r},e.lineEach=c,e.lineReduce=function(t,e,n){var r=n;return c(t,(function(t,i,o,s){r=0===i&&void 0===n?t:e(r,t,i,o,s)})),r},e.propEach=o,e.propReduce=function(t,e,n){var r=n;return o(t,(function(t,i){r=0===i&&void 0===n?t:e(r,t,i)})),r},e.segmentEach=u,e.segmentReduce=function(t,e,n){var r=n,i=!1;return u(t,(function(t,o,s,a,l){r=!1===i&&void 0===n?t:e(r,t,o,s,a,l),i=!0})),r}},83669:t=>{t.exports=n;var e=null;try{e=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(t){}function n(t,e,n){this.low=0|t,this.high=0|e,this.unsigned=!!n}function r(t){return!0===(t&&t.__isLong__)}n.prototype.__isLong__,Object.defineProperty(n.prototype,"__isLong__",{value:!0}),n.isLong=r;var i={},o={};function s(t,e){var n,r,s;return e?(s=0<=(t>>>=0)&&t<256)&&(r=o[t])?r:(n=l(t,(0|t)<0?-1:0,!0),s&&(o[t]=n),n):(s=-128<=(t|=0)&&t<128)&&(r=i[t])?r:(n=l(t,t<0?-1:0,!1),s&&(i[t]=n),n)}function a(t,e){if(isNaN(t))return e?m:y;if(e){if(t<0)return m;if(t>=f)return x}else{if(t<=-p)return w;if(t+1>=p)return A}return t<0?a(-t,e).neg():l(t%d|0,t/d|0,e)}function l(t,e,r){return new n(t,e,r)}n.fromInt=s,n.fromNumber=a,n.fromBits=l;var u=Math.pow;function c(t,e,n){if(0===t.length)throw Error("empty string");if("NaN"===t||"Infinity"===t||"+Infinity"===t||"-Infinity"===t)return y;if("number"==typeof e?(n=e,e=!1):e=!!e,(n=n||10)<2||36<n)throw RangeError("radix");var r;if((r=t.indexOf("-"))>0)throw Error("interior hyphen");if(0===r)return c(t.substring(1),e,n).neg();for(var i=a(u(n,8)),o=y,s=0;s<t.length;s+=8){var l=Math.min(8,t.length-s),h=parseInt(t.substring(s,s+l),n);if(l<8){var d=a(u(n,l));o=o.mul(d).add(a(h))}else o=(o=o.mul(i)).add(a(h))}return o.unsigned=e,o}function h(t,e){return"number"==typeof t?a(t,e):"string"==typeof t?c(t,e):l(t.low,t.high,"boolean"==typeof e?e:t.unsigned)}n.fromString=c,n.fromValue=h;var d=4294967296,f=d*d,p=f/2,g=s(1<<24),y=s(0);n.ZERO=y;var m=s(0,!0);n.UZERO=m;var v=s(1);n.ONE=v;var b=s(1,!0);n.UONE=b;var _=s(-1);n.NEG_ONE=_;var A=l(-1,2147483647,!1);n.MAX_VALUE=A;var x=l(-1,-1,!0);n.MAX_UNSIGNED_VALUE=x;var w=l(0,-2147483648,!1);n.MIN_VALUE=w;var C=n.prototype;C.toInt=function(){return this.unsigned?this.low>>>0:this.low},C.toNumber=function(){return this.unsigned?(this.high>>>0)*d+(this.low>>>0):this.high*d+(this.low>>>0)},C.toString=function(t){if((t=t||10)<2||36<t)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(w)){var e=a(t),n=this.div(e),r=n.mul(e).sub(this);return n.toString(t)+r.toInt().toString(t)}return"-"+this.neg().toString(t)}for(var i=a(u(t,6),this.unsigned),o=this,s="";;){var l=o.div(i),c=(o.sub(l.mul(i)).toInt()>>>0).toString(t);if((o=l).isZero())return c+s;for(;c.length<6;)c="0"+c;s=""+c+s}},C.getHighBits=function(){return this.high},C.getHighBitsUnsigned=function(){return this.high>>>0},C.getLowBits=function(){return this.low},C.getLowBitsUnsigned=function(){return this.low>>>0},C.getNumBitsAbs=function(){if(this.isNegative())return this.eq(w)?64:this.neg().getNumBitsAbs();for(var t=0!=this.high?this.high:this.low,e=31;e>0&&!(t&1<<e);e--);return 0!=this.high?e+33:e+1},C.isZero=function(){return 0===this.high&&0===this.low},C.eqz=C.isZero,C.isNegative=function(){return!this.unsigned&&this.high<0},C.isPositive=function(){return this.unsigned||this.high>=0},C.isOdd=function(){return!(1&~this.low)},C.isEven=function(){return!(1&this.low)},C.equals=function(t){return r(t)||(t=h(t)),(this.unsigned===t.unsigned||this.high>>>31!=1||t.high>>>31!=1)&&this.high===t.high&&this.low===t.low},C.eq=C.equals,C.notEquals=function(t){return!this.eq(t)},C.neq=C.notEquals,C.ne=C.notEquals,C.lessThan=function(t){return this.comp(t)<0},C.lt=C.lessThan,C.lessThanOrEqual=function(t){return this.comp(t)<=0},C.lte=C.lessThanOrEqual,C.le=C.lessThanOrEqual,C.greaterThan=function(t){return this.comp(t)>0},C.gt=C.greaterThan,C.greaterThanOrEqual=function(t){return this.comp(t)>=0},C.gte=C.greaterThanOrEqual,C.ge=C.greaterThanOrEqual,C.compare=function(t){if(r(t)||(t=h(t)),this.eq(t))return 0;var e=this.isNegative(),n=t.isNegative();return e&&!n?-1:!e&&n?1:this.unsigned?t.high>>>0>this.high>>>0||t.high===this.high&&t.low>>>0>this.low>>>0?-1:1:this.sub(t).isNegative()?-1:1},C.comp=C.compare,C.negate=function(){return!this.unsigned&&this.eq(w)?w:this.not().add(v)},C.neg=C.negate,C.add=function(t){r(t)||(t=h(t));var e=this.high>>>16,n=65535&this.high,i=this.low>>>16,o=65535&this.low,s=t.high>>>16,a=65535&t.high,u=t.low>>>16,c=0,d=0,f=0,p=0;return f+=(p+=o+(65535&t.low))>>>16,d+=(f+=i+u)>>>16,c+=(d+=n+a)>>>16,c+=e+s,l((f&=65535)<<16|(p&=65535),(c&=65535)<<16|(d&=65535),this.unsigned)},C.subtract=function(t){return r(t)||(t=h(t)),this.add(t.neg())},C.sub=C.subtract,C.multiply=function(t){if(this.isZero())return y;if(r(t)||(t=h(t)),e)return l(e.mul(this.low,this.high,t.low,t.high),e.get_high(),this.unsigned);if(t.isZero())return y;if(this.eq(w))return t.isOdd()?w:y;if(t.eq(w))return this.isOdd()?w:y;if(this.isNegative())return t.isNegative()?this.neg().mul(t.neg()):this.neg().mul(t).neg();if(t.isNegative())return this.mul(t.neg()).neg();if(this.lt(g)&&t.lt(g))return a(this.toNumber()*t.toNumber(),this.unsigned);var n=this.high>>>16,i=65535&this.high,o=this.low>>>16,s=65535&this.low,u=t.high>>>16,c=65535&t.high,d=t.low>>>16,f=65535&t.low,p=0,m=0,v=0,b=0;return v+=(b+=s*f)>>>16,m+=(v+=o*f)>>>16,v&=65535,m+=(v+=s*d)>>>16,p+=(m+=i*f)>>>16,m&=65535,p+=(m+=o*d)>>>16,m&=65535,p+=(m+=s*c)>>>16,p+=n*f+i*d+o*c+s*u,l((v&=65535)<<16|(b&=65535),(p&=65535)<<16|(m&=65535),this.unsigned)},C.mul=C.multiply,C.divide=function(t){if(r(t)||(t=h(t)),t.isZero())throw Error("division by zero");var n,i,o;if(e)return this.unsigned||-2147483648!==this.high||-1!==t.low||-1!==t.high?l((this.unsigned?e.div_u:e.div_s)(this.low,this.high,t.low,t.high),e.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?m:y;if(this.unsigned){if(t.unsigned||(t=t.toUnsigned()),t.gt(this))return m;if(t.gt(this.shru(1)))return b;o=m}else{if(this.eq(w))return t.eq(v)||t.eq(_)?w:t.eq(w)?v:(n=this.shr(1).div(t).shl(1)).eq(y)?t.isNegative()?v:_:(i=this.sub(t.mul(n)),o=n.add(i.div(t)));if(t.eq(w))return this.unsigned?m:y;if(this.isNegative())return t.isNegative()?this.neg().div(t.neg()):this.neg().div(t).neg();if(t.isNegative())return this.div(t.neg()).neg();o=y}for(i=this;i.gte(t);){n=Math.max(1,Math.floor(i.toNumber()/t.toNumber()));for(var s=Math.ceil(Math.log(n)/Math.LN2),c=s<=48?1:u(2,s-48),d=a(n),f=d.mul(t);f.isNegative()||f.gt(i);)f=(d=a(n-=c,this.unsigned)).mul(t);d.isZero()&&(d=v),o=o.add(d),i=i.sub(f)}return o},C.div=C.divide,C.modulo=function(t){return r(t)||(t=h(t)),e?l((this.unsigned?e.rem_u:e.rem_s)(this.low,this.high,t.low,t.high),e.get_high(),this.unsigned):this.sub(this.div(t).mul(t))},C.mod=C.modulo,C.rem=C.modulo,C.not=function(){return l(~this.low,~this.high,this.unsigned)},C.and=function(t){return r(t)||(t=h(t)),l(this.low&t.low,this.high&t.high,this.unsigned)},C.or=function(t){return r(t)||(t=h(t)),l(this.low|t.low,this.high|t.high,this.unsigned)},C.xor=function(t){return r(t)||(t=h(t)),l(this.low^t.low,this.high^t.high,this.unsigned)},C.shiftLeft=function(t){return r(t)&&(t=t.toInt()),0==(t&=63)?this:t<32?l(this.low<<t,this.high<<t|this.low>>>32-t,this.unsigned):l(0,this.low<<t-32,this.unsigned)},C.shl=C.shiftLeft,C.shiftRight=function(t){return r(t)&&(t=t.toInt()),0==(t&=63)?this:t<32?l(this.low>>>t|this.high<<32-t,this.high>>t,this.unsigned):l(this.high>>t-32,this.high>=0?0:-1,this.unsigned)},C.shr=C.shiftRight,C.shiftRightUnsigned=function(t){if(r(t)&&(t=t.toInt()),0==(t&=63))return this;var e=this.high;return t<32?l(this.low>>>t|e<<32-t,e>>>t,this.unsigned):l(32===t?e:e>>>t-32,0,this.unsigned)},C.shru=C.shiftRightUnsigned,C.shr_u=C.shiftRightUnsigned,C.toSigned=function(){return this.unsigned?l(this.low,this.high,!1):this},C.toUnsigned=function(){return this.unsigned?this:l(this.low,this.high,!0)},C.toBytes=function(t){return t?this.toBytesLE():this.toBytesBE()},C.toBytesLE=function(){var t=this.high,e=this.low;return[255&e,e>>>8&255,e>>>16&255,e>>>24,255&t,t>>>8&255,t>>>16&255,t>>>24]},C.toBytesBE=function(){var t=this.high,e=this.low;return[t>>>24,t>>>16&255,t>>>8&255,255&t,e>>>24,e>>>16&255,e>>>8&255,255&e]},n.fromBytes=function(t,e,r){return r?n.fromBytesLE(t,e):n.fromBytesBE(t,e)},n.fromBytesLE=function(t,e){return new n(t[0]|t[1]<<8|t[2]<<16|t[3]<<24,t[4]|t[5]<<8|t[6]<<16|t[7]<<24,e)},n.fromBytesBE=function(t,e){return new n(t[4]<<24|t[5]<<16|t[6]<<8|t[7],t[0]<<24|t[1]<<16|t[2]<<8|t[3],e)}},55446:(t,e,n)=>{"use strict";var r=n(95709);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r(n(16193)),o=r(n(93345)),s=n(58462);e.default=function(t){return o.default.createElement(s.FormattedMessage,(0,i.default)({defaultMessage:t.defaultMessage||t.id},t))}},80652:(t,e,n)=>{"use strict";var r=n(95709);Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"messages",{enumerable:!0,get:function(){return i.messages}}),Object.defineProperty(e,"LOCALE_CODES",{enumerable:!0,get:function(){return o.LOCALE_CODES}}),Object.defineProperty(e,"LOCALES",{enumerable:!0,get:function(){return o.LOCALES}}),Object.defineProperty(e,"FormattedMessage",{enumerable:!0,get:function(){return s.default}});var i=n(99138),o=n(38911),s=r(n(55446))},38911:(t,e,n)=>{"use strict";var r=n(95709);Object.defineProperty(e,"__esModule",{value:!0}),e.LOCALE_CODES=e.LOCALES=void 0;var i=r(n(26396));function o(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function s(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?o(Object(n),!0).forEach((function(e){(0,i.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var a={en:"English",fi:"Suomi",pt:"Português",es:"Español",ca:"Català",ja:"日本語",cn:"简体中文",ru:"Русский"};e.LOCALES=a;var l=Object.keys(a).reduce((function(t,e){return s(s({},t),{},(0,i.default)({},e,e))}),{});e.LOCALE_CODES=l},99138:(t,e,n)=>{"use strict";var r=n(95709);Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.messages=e.flattenMessages=void 0;var i=r(n(26396)),o=r(n(7330)),s=r(n(70604)),a=r(n(13873)),l=r(n(85941)),u=r(n(49161)),c=r(n(9252)),h=r(n(52424)),d=r(n(26047));function f(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function p(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?f(Object(n),!0).forEach((function(e){(0,i.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var g=function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return Object.keys(e).reduce((function(r,i){var o=e[i],s=n?"".concat(n,".").concat(i):i;return"string"==typeof o?r[s]=o:Object.assign(r,t(o,s)),r}),{})};e.flattenMessages=g;var y=g(o.default),m={};e.messages=m,m.en=y,m.fi=p(p({},y),g(s.default)),m.pt=p(p({},y),g(a.default)),m.es=p(p({},y),g(l.default)),m.ca=p(p({},y),g(u.default)),m.cn=p(p({},y),g(c.default)),m.ja=p(p({},y),g(h.default)),m.ru=p(p({},y),g(d.default));var v=m;e.default=v},49161:(t,e,n)=>{"use strict";var r=n(95709);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r(n(26396));function o(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}var s={property:{weight:"pes",label:"etiqueta",fillColor:"color fons",color:"color",coverage:"cobertura",strokeColor:"color de traç",radius:"radi",outline:"outline",stroke:"traç",density:"densitat",height:"alçada",sum:"suma",pointCount:"Recompte de Punts"},placeholder:{search:"Cerca",selectField:"Selecciona un camp",yAxis:"Eix Y",selectType:"Selecciona un Tipus",selectValue:"Selecciona un Valor",enterValue:"Entra un valor",empty:"buit"},misc:{by:"",valuesIn:"Valors a",valueEquals:"Valor igual a",dataSource:"Font de dades",brushRadius:"Radi del pinzell (km)",empty:" "},mapLayers:{title:"Capes del mapa",label:"Etiqueta",road:"Carretera",border:"Frontera",building:"Edifici",water:"Aigua",land:"Terra","3dBuilding":"Edifici 3D",background:"Fons"},panel:{text:{label:"etiqueta",labelWithId:"Etiqueta {labelId}",fontSize:"Mida de la font",fontColor:"Color de la font",textAnchor:"Àncora del text",alignment:"Alineació",addMoreLabel:"Afegeix més etiquetes"}},sidebar:{panels:{layer:"Capes",filter:"Filtres",interaction:"Interaccions",basemap:"Mapa base"}},layer:{required:"Requerit*",radius:"Radi",color:"Color",fillColor:"Color fons",outline:"Contorn",weight:"Gruix",propertyBasedOn:"{property} basada en",coverage:"Cobertura",stroke:"Traç",strokeWidth:"Amplada de traç",strokeColor:"Color de traç",basic:"Basic",trailLength:"Longitud de pista",trailLengthDescription:"Nombre de segons fins que desapareix el camí",newLayer:"nova capa",elevationByDescription:"Si desactivat, l'alçada es basa en el recompte de punts",colorByDescription:"Si desactivat, el color es basa en el recompte de punts",aggregateBy:"{field} agregat per","3DModel":"Model 3D","3DModelOptions":"Opcions del model 3D",type:{point:"punt",arc:"arc",line:"línia",grid:"malla",hexbin:"hexbin",polygon:"polígon",geojson:"geojson",cluster:"cluster",icon:"icona",heatmap:"heatmap",hexagon:"hexàgon",hexagonid:"H3",trip:"viatge",s2:"S2","3d":"3D"},layerUpdateError:"S'ha produït un error durant l'actualització de la capa: {errorMessage}. Assegureu-vos que el format de les dades d’entrada sigui vàlid."},layerVisConfigs:{angle:"Angle",strokeWidth:"Amplada traç",strokeWidthRange:"Rang amplada de traç",radius:"Radi",fixedRadius:"Radi fixe a mesurar",fixedRadiusDescription:"Ajusta el radi al radi absolut en metres, p.ex 5 a 5 metres",radiusRange:"Rang de radi",clusterRadius:"Radi Cluster en Pixels",radiusRangePixels:"Rang del radi en pixels",opacity:"Opacitat",coverage:"Cobertura",outline:"Outline",colorRange:"Rang de color",stroke:"Traç",strokeColor:"Color de traç",strokeColorRange:"Rang de color de traç",targetColor:"Color destí",colorAggregation:"Agregació de color",heightAggregation:"Agregació alçada",resolutionRange:"Rang de resolució",sizeScale:"Mida escala",worldUnitSize:"Mida de la unitat mundial",elevationScale:"Escala elevació",enableElevationZoomFactor:"Utilitzeu el factor de zoom d’elevació",enableElevationZoomFactorDescription:"'Ajusteu l'alçada / elevació en funció del factor de zoom actual",enableHeightZoomFactor:"Utilitzeu el factor de zoom d’alçada",heightScale:"Escala alçada",coverageRange:"Rang ed cobertura",highPrecisionRendering:"Representació alta precisió",highPrecisionRenderingDescription:"La precisió alta tindrà rendiment més baix",height:"Alçada",heightDescription:"Fes clic al botó a dalt a la dreta del mapa per canviar a vista 3D",fill:"Omple",enablePolygonHeight:"Activa alçada del polígon",showWireframe:"Mostra Wireframe",weightIntensity:"Intensitat de pes",zoomScale:"Escala de zoom",heightRange:"Rang alçada",heightMultiplier:"Multiplicador d'alçada"},layerManager:{addData:"Afegeix Dades",addLayer:"Afegeix Capes",layerBlending:"Combinar capes"},mapManager:{mapStyle:"Estil de mapa",addMapStyle:"Afegeix estils de mapa","3dBuildingColor":"Color edifici 3D",backgroundColor:"Color de fons"},layerConfiguration:{defaultDescription:"Calcula {property} segons el camp seleccionat",howTo:"How to"},filterManager:{addFilter:"Afegeix Filtre"},datasetTitle:{showDataTable:"Mostra taula de dades",removeDataset:"Elimina conjunt de dades"},datasetInfo:{rowCount:"{rowCount} files"},tooltip:{hideLayer:"oculta la capa",showLayer:"mostra la capa",hideFeature:"Amaga l'objecte",showFeature:"Mostra l'objecte",hide:"amaga",show:"mostra",removeLayer:"Elimina capa",resetAfterError:"Intenteu habilitar la capa després dun error",layerSettings:"Configuració de capa",closePanel:"Tanca panel actual",switchToDualView:"Canvia a la vista de mapa dual",showLegend:"mostra llegenda",disable3DMap:"Desactiva mapa 3D",DrawOnMap:"Dibuixa al mapa",selectLocale:"Selecciona configuració regional",hideLayerPanel:"Oculta el tauler de capes",showLayerPanel:"Mostra el tauler de capes",moveToTop:"Desplaça a dalt de tot de les capes de dades",selectBaseMapStyle:"Selecciona estil de mapa base",delete:"Esborra",timePlayback:"Reproducció de temps",cloudStorage:"Emmagatzematge al núvol","3DMap":"Mapa 3D",animationByWindow:"Finestra Temporal Mòbil",animationByIncremental:"Finestra Temporal Incremental",speed:"velocitat",play:"iniciar",pause:"pausar",reset:"reiniciar"},toolbar:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?o(Object(n),!0).forEach((function(e){(0,i.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({exportImage:"Exporta imatge",exportData:"Exporta dades",exportMap:"Exporta mapa",shareMapURL:"Comparteix URL del mapa",saveMap:"Desa mapa",select:"selecciona",polygon:"polígon",rectangle:"rectangle",hide:"amaga",show:"mostra"},n(38911).LOCALES),modal:{title:{deleteDataset:"Esborra conjunt de dades",addDataToMap:"Afegeix dades al mapa",exportImage:"Exporta imatge",exportData:"Exporta dades",exportMap:"Exporta mapa",addCustomMapboxStyle:"Afegeix estil Mapbox propi",saveMap:"Desa mapa",shareURL:"Comparteix URL"},button:{delete:"Esborra",download:"Descarrega",export:"Exporta",addStyle:"Afegeix estil",save:"Desa",defaultCancel:"Cancel·la",defaultConfirm:"Confirma"},exportImage:{ratioTitle:"Ràtio",ratioDescription:"Escull ràtio per diversos usos.",ratioOriginalScreen:"Pantalla original",ratioCustom:"Personalitzat",ratio4_3:"4:3",ratio16_9:"16:9",resolutionTitle:"Resolució",resolutionDescription:"Alta resolució és millor per a les impressions.",mapLegendTitle:"Llegenda del mapa",mapLegendAdd:"Afegir llegenda al mapa"},exportData:{datasetTitle:"Conjunt de dades",datasetSubtitle:"Escull els conjunts de dades que vols exportar",allDatasets:"Tots",dataTypeTitle:"Tipus de dades",dataTypeSubtitle:"Escull els tipus de dades que vols exportar",filterDataTitle:"Filtra dades",filterDataSubtitle:"Pots escollir exportar les dades originals o les filtrades",filteredData:"Dades filtrades",unfilteredData:"Dades sense filtrar",fileCount:"{fileCount} Arxius",rowCount:"{rowCount} Files"},deleteData:{warning:"estàs a punt d'esborrar aquest conjunt de dades. Afectarà {length} capes"},addStyle:{publishTitle:"2. Publica el teu estil a Mapbox o proporciona el token d'accés",publishSubtitle1:"Pots crear el teu propi estil de mapa a",publishSubtitle2:"i",publishSubtitle3:"publicar",publishSubtitle4:"ho.",publishSubtitle5:"Per utilitzar un estil privat, enganxa el teu",publishSubtitle6:"token d'accés",publishSubtitle7:"aquí. *kepler.gl és una aplicació client, les dades romanen al teu navegador..",exampleToken:"p.ex. pk.abcdefg.xxxxxx",pasteTitle:"1. Enganxa la URL de l'estil",pasteSubtitle1:"Què és un",pasteSubtitle2:"URL de l'estil",namingTitle:"3. Posa nom al teu estil"},shareMap:{shareUriTitle:"Comparteix URL del mapa",shareUriSubtitle:"Genera una URL del mapa per compartir amb altri",cloudTitle:"Emmagatzematge al núvol",cloudSubtitle:"Accedeix i carrega dades de mapa al teu emmagatzematge al núvol personal",shareDisclaimer:"kepler.gl desarà les dades del mapa al teu emmagatzematge al núvol personal, només qui tingui la URL podrà accedir al mapa i a les dades . Pots editar/esborrar l'arxiu de dades en el teu compte al núvol en qualsevol moment.",gotoPage:"Ves a la pàgina de {currentProvider} de Kepler.gl"},statusPanel:{mapUploading:"Carregar un mapa",error:"Error"},saveMap:{title:"Emmagatzematge al núvol",subtitle:"Accedeix per desar el mapa al teu emmagatzematge al núvol"},exportMap:{formatTitle:"Format de mapa",formatSubtitle:"Escull el format amb què vols exportar el teu mapa",html:{selection:"Exporta el teu mapa com un arxiu HTML interactiu.",tokenTitle:"Token d'accés de Mapbox",tokenSubtitle:"Utilitza el teu token d'accés de Mapbox a l'arxiu HTML (opcional)",tokenPlaceholder:"Enganxa el teu token d'accés a Mapbox",tokenMisuseWarning:"* Si no proporciones el teu propi token, el mapa podria fallar en qualsevol moment quan reemplacem el nostre token per evitar abusos. ",tokenDisclaimer:"Pots canviar el toke de Mapbox més endavant fent servir aquestes instruccions: ",tokenUpdate:"Com actualitzar un token preexistent.",modeTitle:"Mode mapa",modeSubtitle1:"Selecciona mode app. Més ",modeSubtitle2:"informació",modeDescription:"Permet als usuaris {mode} el mapa",read:"llegir",edit:"editar"},json:{configTitle:"Configuració del mapa",configDisclaimer:"La configuració del mapa s'inclourà a l'arxiu Json. Si utilitzes kepler.gl a la teva pròpia app pots copiar aquesta configuració i passar-la a  ",selection:"Exporta les dades del mapa i la configuració en un sol arxiu Json. Més endavant pots obrir aquest mateix mapa carregant aquest mateix arxiu a kepler.gl.",disclaimer:"* La configuració del mapa es combina amb els conjunts de dades carregats. ‘dataId’ s'utilitza per lligar capes, filtres i suggeriments a un conjunt de dades específic. Quan passis aquesta configuració a addDataToMap, assegura que l'identificador del conjunt de dades coincideixi amb els ‘dataId’ d'aquesta configuració."}},loadingDialog:{loading:"Carregant..."},loadData:{upload:"Carregar arxius",storage:"Carregar des d'emmagatzematge"},tripInfo:{title:"Com habilitar l’animació de viatge",description1:"Per animar la ruta, les dades geoJSON han de contenir `LineString` en la seva geometria i les coordenades de LineString han de tenir 4 elements en els formats de ",code:" [longitude, latitude, altitude, timestamp] ",description2:"i el darrer element ha de ser la marca de temps. Els formats vàlids per a la marca de temps inclouen Unix en segons com `1564184363` o en milisegons com `1564184363000`.",example:"Exemple:"},iconInfo:{title:"Com dibuixar icones",description1:"En el teu CSV crea una columna i posa-hi el nom de la icona que vols dibuixar. Pots deixar la cel·la buida quan no vulguis que es mostri per a certs punts. Quan la columna s'anomena",code:"icon",description2:" kepler.gl automàticament crearà una capa d'icona.",example:"Exemple:",icons:"Icones"},storageMapViewer:{lastModified:"Darrera modificació fa {lastUpdated}",back:"Enrere"},overwriteMap:{title:"Desant mapa...",alreadyExists:"ja existeix a {mapSaved}. El vols sobreescriure?"},loadStorageMap:{back:"Enrere",goToPage:"Ves a la pàgina {displayName} de Kepler.gl",storageMaps:"Emmagatzematge / Mapes",noSavedMaps:"Cap mapa desat encara"}},header:{visibleLayers:"Capes visibles",layerLegend:"Llegenda de capes"},interactions:{tooltip:"Suggeriment",brush:"Pinzell",coordinate:"Coordenades",geocoder:"Geocodificador"},layerBlending:{title:"Combinació de capes",additive:"additiva",normal:"normal",subtractive:"substractiva"},columns:{title:"Columnes",lat:"lat",lng:"lon",altitude:"alçada",icon:"icona",geojson:"geojson",arc:{lat0:"lat origen",lng0:"lng origen ",lat1:"lat destinació",lng1:"lng destinació"},line:{alt0:"alçada origen",alt1:"alçada destinació"},grid:{worldUnitSize:"Mida de malla (km)"},hexagon:{worldUnitSize:"Radi d'hexàgon (km)"},hex_id:"id hex"},color:{customPalette:"Paleta personalitzada",steps:"intervals",type:"tipus",reversed:"invertida"},scale:{colorScale:"Escala de color",sizeScale:"Escala de mides",strokeScale:"Escala de traç",scale:"Escala"},fileUploader:{message:"Arrossega i deixa anar l'arxiu aquí",chromeMessage:"*usuari de Chrome: la mida màxima són 250mb, si has de carrgar un arxiu més gran fes servir Safari",disclaimer:"*kepler.gl és una aplicació a la banda client que no es recolza en cap servidor. Les dades només existeixen a la teva màquina/navegador. No s'envien dades ni mapes a cap servidor.",configUploadMessage:"Carrega {fileFormatNames} o un mapa desat en **Json**. Més informació sobre [**supported file formats**]",browseFiles:"navega pels teus arxius",uploading:"Carregant",fileNotSupported:"L'arxiu {errorFiles} no és compatible.",or:"o"},geocoder:{title:"Introdueix una adreça"},fieldSelector:{clearAll:"Treure tots",formatting:"Format"},compare:{modeLabel:"Mode Comparació",typeLabel:"Tipus de Comparació",types:{absolute:"Absoluta",relative:"Relativa"}},mapPopover:{primary:"Principal"},density:"densitat","Bug Report":"Informe d'errors","User Guide":"Guia d'usuari",Save:"Desa",Share:"Comparteix"};e.default=s},9252:(t,e,n)=>{"use strict";var r=n(95709);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r(n(26396));function o(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}var s={property:{weight:"权重",label:"标签",fillColor:"填充色",color:"颜色",coverage:"覆盖范围",strokeColor:"线条颜色",radius:"半径",outline:"轮廓线",stroke:"线条粗细",density:"密度",height:"高度",sum:"总和",pointCount:"点数"},placeholder:{search:"搜索",selectField:"选择区域",yAxis:"Y轴",selectType:"选择类型",selectValue:"选择值",enterValue:"输入值",empty:"未选择"},misc:{by:"",valuesIn:"值包含",valueEquals:"值等于",dataSource:"数据源",brushRadius:"画笔半径 (km)",empty:" "},mapLayers:{title:"图层",label:"标签",road:"道路",border:"边界线",building:"建筑物",water:"水",land:"地面","3dBuilding":"3D建筑"},panel:{text:{label:"标签",labelWithId:"标签 {labelId}",fontSize:"字体大小",fontColor:"字体颜色",textAnchor:"文本锚",alignment:"对齐方式",addMoreLabel:"添加更多标签"}},sidebar:{panels:{layer:"图层",filter:"过滤器",interaction:"交互",basemap:"底图"}},layer:{required:"必填*",radius:"半径",color:"颜色",fillColor:"填充色",outline:"轮廓线",weight:"权重",propertyBasedOn:"{property}的基准",coverage:"覆盖范围",stroke:"线条粗细",strokeWidth:"线条宽度",strokeColor:"线条颜色",basic:"基础设置",trailLength:"轨迹长度",trailLengthDescription:"轨迹淡出的秒数",newLayer:"新建图层",elevationByDescription:"关闭时，高度取决于点数",colorByDescription:"关闭时，颜色取决于点数",aggregateBy:"{field}聚合如下: ","3DModel":"3D模型","3DModelOptions":"3D模型选项",type:{point:"point",arc:"arc",line:"line",grid:"grid",hexbin:"hexbin",polygon:"polygon",geojson:"geojson",cluster:"cluster",icon:"icon",heatmap:"heatmap",hexagon:"hexagon",hexagonid:"H3",trip:"trip",s2:"S2","3d":"3D"}},layerVisConfigs:{angle:"角度",strokeWidth:"线条宽度",strokeWidthRange:"线条宽度范围",radius:"半径",fixedRadius:"以米为单位固定半径",fixedRadiusDescription:"将半径映射到以米为单位的绝对半径（例: 5 → 5米）",radiusRange:"半径范围",clusterRadius:"聚类半径",radiusRangePixels:"半径范围[像素]",opacity:"透明度",coverage:"覆盖范围",outline:"轮廓",colorRange:"色彩范围",stroke:"线",strokeColor:"线条颜色",strokeColorRange:"线条色彩范围",targetColor:"目标颜色",colorAggregation:"颜色聚合",heightAggregation:"高度聚合",resolutionRange:"分辨率范围",sizeScale:"大小比例",worldUnitSize:"世界单位大小",elevationScale:"海拔比例",enableElevationZoomFactor:"使用高程缩放系数",enableElevationZoomFactorDescription:"根据当前缩放系数调整海拔",heightScale:"高度比例",coverageRange:"覆盖范围",highPrecisionRendering:"高精度渲染",highPrecisionRenderingDescription:"高精度渲染会导致性能下降",height:"高度",heightDescription:"点击屏幕右上角的按钮切换到3D视图",fill:"填充",enablePolygonHeight:"启用多边形高度",showWireframe:"显示线框",weightIntensity:"加权强度",zoomScale:"缩放比例",heightRange:"高度范围"},layerManager:{addData:"添加数据",addLayer:"添加图层",layerBlending:"混合图层"},mapManager:{mapStyle:"地图样式",addMapStyle:"添加地图样式","3dBuildingColor":"3D 建筑颜色"},layerConfiguration:{defaultDescription:"根据所选字段计算 {property}",howTo:"使用方法"},filterManager:{addFilter:"添加过滤器"},datasetTitle:{showDataTable:"显示数据表",removeDataset:"删除数据集"},datasetInfo:{rowCount:"{rowCount}行"},tooltip:{hideLayer:"隐藏图层",showLayer:"显示图层",hideFeature:"隐藏特征",showFeature:"显示特征",hide:"隐藏",show:"显示",removeLayer:"删除图层",duplicateLayer:"复制图层",layerSettings:"图层设置",closePanel:"关闭当前面板",switchToDualView:"切换到双地图视图",showLegend:"显示图例",disable3DMap:"禁用 3D 地图",DrawOnMap:"在地图上绘制",selectLocale:"选择语言",hideLayerPanel:"隐藏图层面板",showLayerPanel:"显示图层面板",moveToTop:"移至图层顶部",selectBaseMapStyle:"选择底图样式",delete:"删除",timePlayback:"时空回放",cloudStorage:"云存储","3DMap":"3D 地图",animationByWindow:"移动时间窗口",animationByIncremental:"增量时间窗口",speed:"速度",play:"播放",pause:"暂停",reset:"重置"},toolbar:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?o(Object(n),!0).forEach((function(e){(0,i.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({exportImage:"导出图片",exportData:"导出数据",exportMap:"导出地图",shareMapURL:"分享地图网址",saveMap:"保存地图",select:"选择",polygon:"polygon",rectangle:"rectangle",hide:"隐藏",show:"显示"},n(38911).LOCALES),editor:{filterLayer:"过滤图层",copyGeometry:"复制几何图形"},modal:{title:{deleteDataset:"删除数据集",addDataToMap:"添加数据到地图",exportImage:"导出图片",exportData:"导出数据",exportMap:"导出地图",addCustomMapboxStyle:"添加自定义地图",saveMap:"保存地图",shareURL:"分享网址"},button:{delete:"删除",download:"下载",export:"出口",addStyle:"添加样式",save:"保存",defaultCancel:"取消",defaultConfirm:"确认"},exportImage:{ratioTitle:"比率",ratioDescription:"选择不同用途的比例。",ratioOriginalScreen:"原始屏幕",ratioCustom:"自定义",ratio4_3:"4:3",ratio16_9:"16:9",resolutionTitle:"分辨率",resolutionDescription:"高分辨率更适合打印。",mapLegendTitle:"地图图例",mapLegendAdd:"在地图上添加图例"},exportData:{datasetTitle:"数据集",datasetSubtitle:"选择要导出的数据集",allDatasets:"全部",dataTypeTitle:"数据类型",dataTypeSubtitle:"选择要导出的数据类型",filterDataTitle:"过滤数据",filterDataSubtitle:"可以选择导出原始数据或过滤后的数据",filteredData:"过滤数据",unfilteredData:"元数据",fileCount:"{fileCount} 个文件",rowCount:"{rowCount} 行"},deleteData:{warning:"确认要删除这个数据集。它会影响 {length} 个层"},addStyle:{publishTitle:"2. 如果在步骤1中输入了 mapbox 样式的 url，需要在 mapbox 上发布样式或提供访问令牌（access token）。（可选）",publishSubtitle1:"可以在以下位置创建自己的地图样式",publishSubtitle2:"并",publishSubtitle3:"发布",publishSubtitle4:"。",publishSubtitle5:"使用私有样式，需粘贴",publishSubtitle6:"访问令牌（access token）",publishSubtitle7:"。* Kepler.gl 是一个客户端应用程序，数据保留在您的浏览器中。",exampleToken:"例) pk.abcdefg.xxxxxx",pasteTitle:"1. 粘贴样式 url",pasteSubtitle0:"样式 url 可以是 Mapbox 的",pasteSubtitle1:"什么是",pasteSubtitle2:"样式 URL，",pasteSubtitle3:"还可以使用遵从Mapbox GL样式的style.json的url：",pasteSubtitle4:"Mapbox GL 样式规范",namingTitle:"3. 命名你的样式"},shareMap:{shareUriTitle:"分享地图网址",shareUriSubtitle:"生成分享地图的链接",cloudTitle:"云存储",cloudSubtitle:"登录并将地图数据上传到个人云存储",shareDisclaimer:"kepler.gl 将创建的地图存储在个人云存储中，因此只有知道 URL 的人才能访问地图及其数据。可以随时使用个人云存储帐户编辑/删除数据文件。",gotoPage:"跳转到Kepler.gl的{currentProvider}页面"},statusPanel:{mapUploading:"地图上传中",error:"错误"},saveMap:{title:"云存储",subtitle:"登录以将地图保存到个人云存储"},exportMap:{formatTitle:"地图的格式",formatSubtitle:"选择导出地图的格式",html:{selection:"将地图导出至交互式的html文件中。",tokenTitle:"Mapbox的访问令牌（access token）",tokenSubtitle:"在 html 中使用自己的 Mapbox 访问令牌（access token）（可选）",tokenPlaceholder:"粘贴个人的 Mapbox 访问令牌access token）",tokenMisuseWarning:"* 如果您不提供自己的令牌，则在我们更换令牌时，地图可能随时无法显示，以免被滥用。",tokenDisclaimer:"可以稍后使用以下说明更改 Mapbox 令牌：",tokenUpdate:"如何更新现有的地图令牌。",modeTitle:"地图模式",modeSubtitle1:"选择地图模式。更多的",modeSubtitle2:"信息",modeDescription:"允许用户{mode}地图",read:"阅读",edit:"编辑"},json:{configTitle:"地图配置",configDisclaimer:"地图配置将包含在 Json 文件中。如果您在自己的应用程序中使用 kepler.gl。您可以复制此配置并将其传递给",selection:"将当前地图数据和配置导出到单个 Json 文件中。稍后您可以通过将此文件上传到 kepler.gl 来打开同一张地图。",disclaimer:"* 地图配置与加载的数据集相结合。 “dataId”用于将图层、过滤器和工具提示绑定到特定数据集。将此配置传递给 addDataToMap 时，请确保数据集 ID 与此配置中的 dataId/s 匹配。"}},loadingDialog:{loading:"加载中..."},loadData:{upload:"上传文件",storage:"从存储中加载"},tripInfo:{title:"如何启用移动动画",description1:"要路径设置动画，geoJSON 数据必须包含 `LineString` 作为要素几何。此外，LineString 的坐标有四个元素",code:" [经度，纬度，高程，时间戳] ",description2:"最后一个元素是时间戳。有效的时间戳格式包括以秒为单位的 unix，例如`1564184363`或以毫秒为单位的`1564184363000`。",example:"例："},iconInfo:{title:"如何绘制图标",description1:"在您的 csv 中，创建一列，将您要绘制的图标的名称放入其中。如果不想在某些点上显示图标，可以将单元格留空。当列被命名为",code:"图标",description2:"时，kepler.gl 会自动为你创建一个图标层。",example:"例:",icons:"图标一览"},storageMapViewer:{lastModified:"上次修改 {lastUpdated} 前",back:"返回"},overwriteMap:{title:"正在保存地图...",alreadyExists:"已经存在于 {mapSaved} 中。你想覆盖吗？"},loadStorageMap:{back:"返回",goToPage:"跳转到 Kepler.gl 的 {displayName} 页面",storageMaps:"存储 / 地図",noSavedMaps:"还没有保存的地图"}},header:{visibleLayers:"可见图层",layerLegend:"图层图例"},interactions:{tooltip:"工具提示",brush:"刷",coordinate:"坐标",geocoder:"地理编码器"},layerBlending:{title:"图层混合",additive:"additive",normal:"normal",subtractive:"subtractive"},columns:{title:"列",lat:"纬度",lng:"经度",altitude:"海拔",icon:"图标",geojson:"geojson",token:"令牌",arc:{lat0:"起点 纬度",lng0:"起点 经度",lat1:"终点 纬度",lng1:"终点 经度"},grid:{worldUnitSize:"网格大小 (km)"},hexagon:{worldUnitSize:"六边形半径 (km)"},hex_id:"hex id"},color:{customPalette:"自定义调色板",steps:"步骤",type:"类型",reversed:"反转"},scale:{colorScale:"色阶",sizeScale:"大小比例",strokeScale:"描边比例",scale:"规模"},fileUploader:{message:"将您的文件拖放到此处（可多个）",chromeMessage:"*对于 Chrome 用户：文件大小最大为 250mb。如果需要上传更多文件，请尝试使用 Safari。",disclaimer:"* kepler.gl 在客户端上工作。数据仅保留在您自己的设备/浏览器中。没有信息或地图数据被发送到任何服务器。",configUploadMessage:"上传 {fileFormatNames} 或保存的地图 **Json**。阅读更多关于[**支持的文件格式**]",browseFiles:"浏览你的文件",uploading:"上传",fileNotSupported:"不支持文件 {errorFiles}。",or:"或"},geocoder:{title:"输入地址或坐标（例： 37.79,-122.40）"},fieldSelector:{clearAll:"清除所有",formatting:"格式化"},compare:{modeLabel:"比较模式",typeLabel:"比较类型",types:{absolute:"绝对",relative:"相对"}},mapPopover:{primary:"主要"},density:"密度","Bug Report":"错误报告","User Guide":"用户指南",Save:"保存",Share:"分享"};e.default=s},7330:(t,e,n)=>{"use strict";var r=n(95709);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r(n(26396));function o(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}var s={property:{weight:"weight",label:"label",fillColor:"fill color",color:"color",coverage:"coverage",strokeColor:"stroke color",radius:"radius",outline:"outline",stroke:"stroke",density:"density",height:"height",sum:"sum",pointCount:"Point Count"},placeholder:{search:"Search",selectField:"Select a field",yAxis:"Y Axis",selectType:"Select A Type",selectValue:"Select A Value",enterValue:"Enter a value",empty:"empty",selectLayer:"Select a layer"},misc:{by:"",valuesIn:"Values in",valueEquals:"Value equals",dataSource:"Data Source",brushRadius:"Brush Radius (km)",empty:" "},mapLayers:{title:"Map Layers",label:"Label",road:"Road",border:"Border",building:"Building",water:"Water",land:"Land","3dBuilding":"3d Building",background:"Background"},panel:{text:{label:"label",labelWithId:"Label {labelId}",fontSize:"Font size",fontColor:"Font color",backgroundColor:"Background color",textAnchor:"Text anchor",alignment:"Alignment",addMoreLabel:"Add More Label",outlineWidth:"Outline width",outlineColor:"Outline color"}},sidebar:{panels:{layer:"Layers",filter:"Filters",interaction:"Interactions",basemap:"Base map"},panelViewToggle:{list:"View List",byDataset:"View by Dataset"}},layer:{required:"Required*",radius:"Radius",color:"Color",fillColor:"Fill Color",outline:"Outline",weight:"Weight",propertyBasedOn:"{property} based on",coverage:"Coverage",stroke:"Stroke",strokeWidth:"Stroke Width",strokeColor:"Stroke Color",basic:"Basic",trailLength:"Trail Length",trailLengthDescription:"Number of seconds for a path to completely fade out",newLayer:"new layer",elevationByDescription:"When off, height is based on count of points",colorByDescription:"When off, color is based on count of points",aggregateBy:"Aggregate {field} by","3DModel":"3D Model","3DModelOptions":"3D Model Options",type:{point:"point",arc:"arc",line:"line",grid:"grid",hexbin:"hexbin",polygon:"polygon",geojson:"geojson",cluster:"cluster",icon:"icon",heatmap:"heatmap",hexagon:"hexagon",hexagonid:"H3",trip:"trip",s2:"S2","3d":"3D"},layerUpdateError:"An error occurred during layer update: {errorMessage}. Make sure the format of the input data is valid."},layerVisConfigs:{angle:"Angle",strokeWidth:"Stroke Width (Pixels)",strokeWidthRange:"Stroke Width Range",radius:"Radius",fixedRadius:"Fixed Radius to meter",fixedRadiusDescription:"Map radius to absolute radius in meters, e.g. 5 to 5 meters",radiusRange:"Radius Range",clusterRadius:"Cluster Radius in Pixels",radiusRangePixels:"Radius Range in pixels",opacity:"Opacity",coverage:"Coverage",outline:"Outline",colorRange:"Color range",stroke:"Stroke",strokeColor:"Stroke Color",strokeColorRange:"Stroke Color range",targetColor:"Target Color",colorAggregation:"Color Aggregation",heightAggregation:"Height Aggregation",resolutionRange:"Resolution range",sizeScale:"Size Scale",worldUnitSize:"World Unit Size",elevationScale:"Elevation Scale",enableElevationZoomFactor:"Use elevation zoom factor",enableElevationZoomFactorDescription:"Adjust height/elevation based on current zoom factor",enableHeightZoomFactor:"Use height zoom factor",heightScale:"Height Scale",coverageRange:"Coverage Range",highPrecisionRendering:"High Precision Rendering",highPrecisionRenderingDescription:"High precision will result in slower performance",height:"Height",heightDescription:"Click button at top right of the map to switch to 3d view",fill:"Fill",enablePolygonHeight:"Enable Polygon Height",showWireframe:"Show Wireframe",weightIntensity:"Weight Intensity",zoomScale:"Zoom Scale",heightRange:"Height Range",heightMultiplier:"Height Multiplier",darkModeEnabled:"Dark base map"},layerManager:{addData:"Add Data",addLayer:"Add Layer",layerBlending:"Layer Blending",overlayBlending:"Overlay Blending"},mapManager:{mapStyle:"Map style",addMapStyle:"Add Map Style","3dBuildingColor":"3D Building Color",backgroundColor:"Background Color"},effectManager:{effects:"Effects",addEffect:"Add effect",pickDateTime:"Pick date/time",currentTime:"Current time",pickCurrrentTime:"Pick current time",date:"Date",time:"Time",timezone:"Timezone"},layerConfiguration:{defaultDescription:"Calculate {property} based on selected field",howTo:"How to"},filterManager:{addFilter:"Add Filter"},datasetTitle:{showDataTable:"Show data table",removeDataset:"Remove dataset"},datasetInfo:{rowCount:"{rowCount} rows"},tooltip:{hideLayer:"Hide layer",showLayer:"Show layer",hideFeature:"Hide feature",showFeature:"Show feature",hide:"hide",show:"show",removeLayer:"Remove layer",duplicateLayer:"Duplicate layer",resetAfterError:"Try to enable the layer after an error",layerSettings:"Layer settings",closePanel:"Close current panel",switchToDualView:"Switch to dual map view",showLegend:"Show legend",disable3DMap:"Disable 3D Map",DrawOnMap:"Draw on map",selectLocale:"Select locale",hideLayerPanel:"Hide layer panel",showLayerPanel:"Show layer panel",moveToTop:"Move to top of data layers",selectBaseMapStyle:"Select base map style",removeBaseMapStyle:"Remove base map style",delete:"Delete",timePlayback:"Time Playback",cloudStorage:"Cloud Storage","3DMap":"3D Map",animationByWindow:"Moving Time Window",animationByIncremental:"Incremental Time Window",speed:"speed",play:"play",pause:"pause",reset:"reset",export:"export",showEffectPanel:"Show effect panel",hideEffectPanel:"Hide effect panel",removeEffect:"Remove effect",disableEffect:"Disable effect",effectSettings:"Effect settings"},toolbar:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?o(Object(n),!0).forEach((function(e){(0,i.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({exportImage:"Export Image",exportData:"Export Data",exportMap:"Export Map",shareMapURL:"Share Map URL",saveMap:"Save Map",select:"Select",polygon:"Polygon",rectangle:"Rectangle",hide:"Hide",show:"Show"},n(38911).LOCALES),editor:{filterLayer:"Filter Layers",copyGeometry:"Copy Geometry",noLayersToFilter:"No layers to filter"},modal:{title:{deleteDataset:"Delete Dataset",addDataToMap:"Add Data To Map",exportImage:"Export Image",exportData:"Export Data",exportMap:"Export Map",addCustomMapboxStyle:"Add Custom Map Style",saveMap:"Save Map",shareURL:"Share URL"},button:{delete:"Delete",download:"Download",export:"Export",addStyle:"Add Style",save:"Save",defaultCancel:"Cancel",defaultConfirm:"Confirm"},exportImage:{ratioTitle:"Ratio",ratioDescription:"Choose the ratio for various usages.",ratioOriginalScreen:"Original Screen",ratioCustom:"Custom",ratio4_3:"4:3",ratio16_9:"16:9",resolutionTitle:"Resolution",resolutionDescription:"High resolution is better for prints.",mapLegendTitle:"Map Legend",mapLegendAdd:"Add legend on map"},exportData:{datasetTitle:"Dataset",datasetSubtitle:"Choose the datasets you want to export",allDatasets:"All",dataTypeTitle:"Data Type",dataTypeSubtitle:"Choose the type of data you want to export",filterDataTitle:"Filter Data",filterDataSubtitle:"You can choose exporting original data or filtered data",filteredData:"Filtered data",unfilteredData:"Unfiltered Data",fileCount:"{fileCount} Files",rowCount:"{rowCount} Rows"},deleteData:{warning:"you are going to delete this dataset. It will affect {length} layers"},addStyle:{publishTitle:"2. If entered mapbox style url in step.1, publish your style at mapbox or provide access token. (Optional)",publishSubtitle1:"You can create your own map style at",publishSubtitle2:"and",publishSubtitle3:"publish",publishSubtitle4:"it.",publishSubtitle5:"To use private style, paste your",publishSubtitle6:"access token",publishSubtitle7:"here. *kepler.gl is a client-side application, data stays in your browser..",exampleToken:"e.g. pk.abcdefg.xxxxxx",pasteTitle:"1. Paste style url",pasteSubtitle0:"Style url can be a mapbox",pasteSubtitle1:"What is a",pasteSubtitle2:"style URL",pasteSubtitle3:"or a style.json using the",pasteSubtitle4:"Mapbox GL Style Spec",namingTitle:"3. Name your style"},shareMap:{title:"Share Map",shareUriTitle:"Share Map Url",shareUriSubtitle:"Generate a map url to share with others",cloudTitle:"Cloud storage",cloudSubtitle:"Login and upload map data to your personal cloud storage",shareDisclaimer:"kepler.gl will save your map data to your personal cloud storage, only people with the URL can access your map and data. You can edit/delete the data file in your cloud account anytime.",gotoPage:"Go to your Kepler.gl {currentProvider} page"},statusPanel:{mapUploading:"Map Uploading",error:"Error"},saveMap:{title:"Cloud storage",subtitle:"Login to save map to your personal cloud storage"},exportMap:{formatTitle:"Map format",formatSubtitle:"Choose the format to export your map to",html:{selection:"Export your map into an interactive html file.",tokenTitle:"Mapbox access token",tokenSubtitle:"Use your own Mapbox access token in the html (optional)",tokenPlaceholder:"Paste your Mapbox access token",tokenMisuseWarning:"* If you do not provide your own token, the map may fail to display at any time when we replace ours to avoid misuse. ",tokenDisclaimer:"You can change the Mapbox token later using the following instructions: ",tokenUpdate:"How to update an existing map token.",modeTitle:"Map Mode",modeSubtitle1:"Select the app mode. More ",modeSubtitle2:"info",modeDescription:"Allow users to {mode} the map",read:"read",edit:"edit"},json:{configTitle:"Map Config",configDisclaimer:"Map config will be included in the Json file. If you are using kepler.gl in your own app. You can copy this config and pass it to ",selection:"Export current map data and config into a single Json file. You can later open the same map by uploading this file to kepler.gl.",disclaimer:"* Map config is coupled with loaded datasets. ‘dataId’ is used to bind layers, filters, and tooltips to a specific dataset. When passing this config to addDataToMap, make sure the dataset id matches the dataId/s in this config."}},loadingDialog:{loading:"Loading..."},loadData:{upload:"Load Files",storage:"Load from Storage"},tripInfo:{title:"How to enable trip animation",description1:"In order to animate the path, the geoJSON data needs to contain `LineString` in its feature geometry, and the coordinates in the LineString need to have 4 elements in the formats of",code:" [longitude, latitude, altitude, timestamp] ",description2:"with the last element being a timestamp. Valid timestamp formats include unix in seconds such as `1564184363` or in milliseconds such as `1564184363000`.",example:"Example:"},iconInfo:{title:"How to draw icons",description1:"In your csv, create a column, put the name of the icon you want to draw in it. You can leave the cell empty if you do not want the icon to show for some points. When the column is named",code:"icon",description2:" kepler.gl will automatically create a icon layer for you.",example:"Example:",icons:"Icons"},storageMapViewer:{lastModified:"Last modified {lastUpdated} ago",back:"Back"},overwriteMap:{title:"Saving map...",alreadyExists:"already exists in your {mapSaved}. Would you like to overwrite it?"},loadStorageMap:{back:"Back",goToPage:"Go to your Kepler.gl {displayName} page",storageMaps:"Storage / Maps",noSavedMaps:"No saved maps yet"}},header:{visibleLayers:"Visible layers",layerLegend:"Legend"},interactions:{tooltip:"Tooltip",brush:"Brush",coordinate:"Coordinates",geocoder:"Geocoder"},layerBlending:{title:"Layer Blending",additive:"additive",normal:"normal",subtractive:"subtractive"},overlayBlending:{title:"Map overlay blending",description:"Blend layers with the base map so that both are visible.",screen:"dark base map",normal:"normal",darken:"light base map"},columns:{title:"Columns",lat:"lat",lng:"lon",altitude:"altitude",icon:"icon",geojson:"geojson",token:"token",arc:{lat0:"source lat",lng0:"source lng",lat1:"target lat",lng1:"target lng"},line:{alt0:"source altitude",alt1:"target altitude"},grid:{worldUnitSize:"Grid Size (km)"},hexagon:{worldUnitSize:"Hexagon Radius (km)"},hex_id:"hex id"},color:{customPalette:"Custom Palette",steps:"steps",type:"type",reversed:"reversed",opacity:"Opacity"},scale:{colorScale:"Color Scale",sizeScale:"Size Scale",strokeScale:"Stroke Scale",strokeColorScale:"Stroke Color Scale",scale:"Scale"},fileUploader:{message:"Drag & Drop Your File(s) Here",chromeMessage:"*Chrome user: Limit file size to 250mb, if need to upload larger file, try Safari",disclaimer:"*kepler.gl is a client-side application with no server backend. Data lives only on your machine/browser. No information or map data is sent to any server.",configUploadMessage:"Upload {fileFormatNames} or saved map **Json**. Read more about [**supported file formats**]",browseFiles:"browse your files",uploading:"Uploading",fileNotSupported:"File {errorFiles} is not supported.",or:"or"},geocoder:{title:"Enter an address or coordinates, ex 37.79,-122.40"},fieldSelector:{clearAll:"Clear All",formatting:"Formatting"},compare:{modeLabel:"Comparison Mode",typeLabel:"Comparison Type",types:{absolute:"Absolute",relative:"Relative"}},mapPopover:{primary:"Primary"},density:"density","Bug Report":"Bug Report","User Guide":"User Guide",Save:"Save",Share:"Share"};e.default=s},85941:(t,e,n)=>{"use strict";var r=n(95709);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r(n(26396));function o(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}var s={property:{weight:"peso",label:"etiqueta",fillColor:"color de relleno",color:"color",coverage:"cobertura",strokeColor:"color de trazo",radius:"radio",outline:"contorno",stroke:"trazo",density:"densidad",height:"altura",sum:"suma",pointCount:"Recuento de puntos"},placeholder:{search:"Busqueda",selectField:"Selecciona un campo",yAxis:"Eje Y",selectType:"Selecciona un Tipo",selectValue:"Selecciona un Valor",enterValue:"Entra un valor",empty:"vacio"},misc:{by:"",valuesIn:"Valores en",valueEquals:"Valor igual a",dataSource:"Fuente de datos",brushRadius:"Radio del pincel (km)",empty:" "},mapLayers:{title:"Capas del mapa",label:"Etiqueta",road:"Carretera",border:"Frontera",building:"Edificio",water:"Agua",land:"Tierra","3dBuilding":"Edificio 3D",background:"Fondo"},panel:{text:{label:"etiqueta",labelWithId:"Etiqueta {labelId}",fontSize:"Tamaño de fuente",fontColor:"Color de fuente",textAnchor:"Anclaje del texto",alignment:"Alineación",addMoreLabel:"Añadir más etiquetas"}},sidebar:{panels:{layer:"Capas",filter:"Filtros",interaction:"Interacciones",basemap:"Mapa base"}},layer:{required:"Requerido*",radius:"Radio",color:"Color",fillColor:"Color de relleno",outline:"Contorno",weight:"Grueso",propertyBasedOn:"{property} basado en",coverage:"Cobertura",stroke:"Trazo",strokeWidth:"Grosor de trazo",strokeColor:"Color de trazo",basic:"Básico",trailLength:"Longitud de pista",trailLengthDescription:"Numero de segundos hasta que desaparezca el camino",newLayer:"nueva capa",elevationByDescription:"Si desactivado, la altura se basa en el recuento de puntos",colorByDescription:"Si desactivado, el color se basa en el recuento de puntos",aggregateBy:"{field} agregado por","3DModel":"Modelo 3D","3DModelOptions":"Opciones del modelo 3D",type:{point:"punto",arc:"arco",line:"línea",grid:"malla",hexbin:"hexbin",polygon:"polígono",geojson:"geojson",cluster:"cluster",icon:"icono",heatmap:"concentración",hexagon:"hexágono",hexagonid:"H3",trip:"viaje",s2:"S2","3d":"3D"},layerUpdateError:"Se produjo un error durante la actualización de la capa: {errorMessage}. Asegúrese de que el formato de los datos de entrada sea válido."},layerVisConfigs:{angle:"Ángulo",strokeWidth:"Ancho del trazo",strokeWidthRange:"Rango del ancho del trazo",radius:"Radio",fixedRadius:"Radio fijo a medir",fixedRadiusDescription:"Ajustar el radio al radio absoluto en metros, p.e. 5 a 5 metros",radiusRange:"Rango de radio",clusterRadius:"Radio del cluster en píxeles",radiusRangePixels:"Rango del radio en píxeles",opacity:"Opacidad",coverage:"Cobertura",outline:"Contorno",colorRange:"Rango de color",stroke:"Trazo",strokeColor:"Color de trazo",strokeColorRange:"Rango de color de trazo",targetColor:"Color destino",colorAggregation:"Agregación de color",heightAggregation:"Agregación de la altura",resolutionRange:"Rango de resolución",sizeScale:"Medida de escala",worldUnitSize:"Medida de la unidad mundial",elevationScale:"Escala de elevación",enableElevationZoomFactor:"Usar factor de zoom de elevación",enableElevationZoomFactorDescription:"Ajuste la altura / elevación según el factor de zoom actual",enableHeightZoomFactor:"Usar factor de zoom de altura",heightScale:"Escala de altura",coverageRange:"Rango de cobertura",highPrecisionRendering:"Representación de alta precisión",highPrecisionRenderingDescription:"La precisión alta tendrá un rendimiento más bajo",height:"Altura",heightDescription:"Haz clic en el botón de arriba a la derecha del mapa per cambiar a vista 3D",fill:"Rellenar",enablePolygonHeight:"Activar la altura del polígono",showWireframe:"Muestra esquemàtico",weightIntensity:"Intensidad de peso",zoomScale:"Escala de zoom",heightRange:"Rango de alturas",heightMultiplier:"Multiplicador de altura"},layerManager:{addData:"Añadir datos",addLayer:"Añadir capa",layerBlending:"Combinar capas"},mapManager:{mapStyle:"Estilo de mapa",addMapStyle:"Añadir estilo de mapa","3dBuildingColor":"Color edificios 3D",backgroundColor:"Color de fondo"},layerConfiguration:{defaultDescription:"Calcular {property} según el campo seleccionado",howTo:"How to"},filterManager:{addFilter:"Añadir filtro"},datasetTitle:{showDataTable:"Mostar la tabla de datos",removeDataset:"Eliminar conjunto de datos"},datasetInfo:{rowCount:"{rowCount} files"},tooltip:{hideLayer:"Ocultar la capa",showLayer:"Mostrar la capa",hideFeature:"Ocultar el objeto",showFeature:"Mostrar el objeto",hide:"Ocultar",show:"Mostrar",removeLayer:"Eliminar capa",resetAfterError:"Intente habilitar la capa después de un error",layerSettings:"Configuración de capa",closePanel:"Cerrar el panel actual",switchToDualView:"Cambiar a la vista de mapa dual",showLegend:"Mostrar leyenda",disable3DMap:"Desactivar mapa 3D",DrawOnMap:"Dibujar en el mapa",selectLocale:"Seleccionar configuración regional",hideLayerPanel:"Ocultar la tabla de capas",showLayerPanel:"Mostrar la tabla  de capas",moveToTop:"Desplazar arriba de las capas de datos",selectBaseMapStyle:"Seleccionar estilo de mapa base",delete:"Borrar",timePlayback:"Reproducción de tiempo",cloudStorage:"Almacenaje en la nube","3DMap":"Mapa 3D",animationByWindow:"Ventana Temporal Móvil",animationByIncremental:"Ventana Temporal Incremental",speed:"velocidad",play:"iniciar",pause:"pausar",reset:"reiniciar"},toolbar:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?o(Object(n),!0).forEach((function(e){(0,i.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({exportImage:"Exportar imagen",exportData:"Exportar datos",exportMap:"Exportar mapa",shareMapURL:"Compartir el enlace del mapa",saveMap:"Guardar mapa",select:"selecciona",polygon:"polígono",rectangle:"rectángulo",hide:"esconder",show:"mostrar"},n(38911).LOCALES),modal:{title:{deleteDataset:"Borrar conjunto de datos",addDataToMap:"Añadir datos al mapa",exportImage:"Exportar imagen",exportData:"Exportar datos",exportMap:"Exportar mapa",addCustomMapboxStyle:"Añadir estilo de Mapbox propio",saveMap:"Guardar mapa",shareURL:"Compartir enlace"},button:{delete:"Borrar",download:"Descargar",export:"Exportar",addStyle:"Añadir estilo",save:"Guardar",defaultCancel:"Cancelar",defaultConfirm:"Confirmar"},exportImage:{ratioTitle:"Ratio",ratioDescription:"Esoger ratio por diversos usos.",ratioOriginalScreen:"Pantalla original",ratioCustom:"Personalizado",ratio4_3:"4:3",ratio16_9:"16:9",resolutionTitle:"Resolución",resolutionDescription:"Una alta resolución es mejor para las impresiones.",mapLegendTitle:"Leyenda del mapa",mapLegendAdd:"Añadir leyenda al mapa"},exportData:{datasetTitle:"Conjunto de datos",datasetSubtitle:"Escoger los conjuntos de datos a exportar",allDatasets:"Todos",dataTypeTitle:"Tipo de datos",dataTypeSubtitle:"Escoger el tipo de datos a exportar",filterDataTitle:"Filtrar datos",filterDataSubtitle:"Se puede escoger exportar los datos originales o filtrados",filteredData:"Datos filtrados",unfilteredData:"Datos sin filtrar",fileCount:"{fileCount} Archivos",rowCount:"{rowCount} Files"},deleteData:{warning:"estás a punto de borrar este conjunto de datos. Afectará a {length} capas"},addStyle:{publishTitle:"1. Publicar tu estilo en Mapbox o proporcionar el token de acceso",publishSubtitle1:"Puedes crear el tu propio estilo de mapa en",publishSubtitle2:"y",publishSubtitle3:"publicar",publishSubtitle4:"lo.",publishSubtitle5:"Para utilizar un estilo privado, engancha tu",publishSubtitle6:"token de acceso",publishSubtitle7:"aquí. *kepler.gl es una aplicación cliente, los datos quedan en tu navegador..",exampleToken:"p.e. pk.abcdefg.xxxxxx",pasteTitle:"2. Engancha el enlace del estilo",pasteSubtitle1:"Qué es un",pasteSubtitle2:"enlace del estilo",namingTitle:"3. Poner nombre a tu estilo"},shareMap:{shareUriTitle:"Compartir el enlace del mapa",shareUriSubtitle:"Generar un enlace del mapa para compartir con otros",cloudTitle:"Almacenage en la nube",cloudSubtitle:"Acceder y cargar datos del mapa a tu almacenage a la nube personal",shareDisclaimer:"kepler.gl guardará los datos del mapa en el almacenage de tu nube personal, sólo quien tenga el enlace podra acceder al mapa y a los datos . Puedes editar/borrar el archivo de datos en tu cuenta en la nube en cualquier momento.",gotoPage:"Ves a la página de {currentProvider} de Kepler.gl"},statusPanel:{mapUploading:"Cargar un mapa",error:"Error"},saveMap:{title:"Almacentage en la nube",subtitle:"Acceder para guardar el mapa en teu almacenage en la nube"},exportMap:{formatTitle:"Formato de mapa",formatSubtitle:"Escoger el formato al que se desea exportar el mapa",html:{selection:"Exportar tu mapa como un archivo HTML interactivo.",tokenTitle:"Token de acceso de Mapbox",tokenSubtitle:"Utilizar tu token de acceso a Mapbox al archivo HTML (opcional)",tokenPlaceholder:"Enganchar tu token de acceso a Mapbox",tokenMisuseWarning:"* Si no proporcionas tu propio token, el mapa podría fallar en cualquier momento cuando reemplacemos nuestro token para evitar abusos. ",tokenDisclaimer:"Puedes cambiar el token de Mapbox posteriormente utilizando estas instrucciones: ",tokenUpdate:"Como actualitzar un token preexistente.",modeTitle:"Modo mapa",modeSubtitle1:"Seleccionar modo app. Más ",modeSubtitle2:"información",modeDescription:"Permmite a los usuarios {modo} el mapa",read:"leer",edit:"editar"},json:{configTitle:"Configuración del mapa",configDisclaimer:"La configuración del mapa será incluida en el archivo Json. Si utilitzas kepler.gl en tu propia app puedes copiar esta configuración y pasarla a  ",selection:"Exportar los datos del mapa y la configuración en un solo archivo Json. Posteriormente puedes abrir este mismo mapa cargando este mismo archivo a kepler.gl.",disclaimer:"* La configuración del mapa se combina con los conjuntos de datos cargados. ‘dataId’ se utiliza para vincular capas, filtros y sugerencias a un conjunto de datos específico. Cuando pases esta configuración a addDataToMap, asegura que el identificador del conjunto de datos coincida con los ‘dataId’ de esta configuración."}},loadingDialog:{loading:"Cargando..."},loadData:{upload:"Cargar archivos",storage:"Cargar desde almacenage"},tripInfo:{title:"Como habilitar la animación de viaje",description1:"Para animar la ruta, los datos geoJSON han de contener `LineString` en su geometría y las coordenadas de LineString deben tener 4 elementos en los formats de ",code:" [longitude, latitude, altitude, timestamp] ",description2:"y el último elemento debe ser la marca del tiempo. Los formatos válidos para la marca de tiempo incluyen Unix en segundos como `1564184363` o en milisegundos como `1564184363000`.",example:"Ejemplo:"},iconInfo:{title:"Como dibujar íconos",description1:"En tu CSV crea una columna y pon el nombre del ícono que quieres dibujar. Puedes dejar la celda vacía cuando no quieras que se muestre para ciertos puntos. Cuando la columna se llama",code:"ícono",description2:" kepler.gl automáticamente creará una capa de ícono.",example:"Ejemplo:",icons:"Iconos"},storageMapViewer:{lastModified:"Última modificación hace {lastUpdated}",back:"Atrás"},overwriteMap:{title:"Guardando el mapa...",alreadyExists:"ja existe en {mapSaved}. Lo quieres sobreescrivir?"},loadStorageMap:{back:"Atrás",goToPage:"Ves a la página {displayName} de Kepler.gl",storageMaps:"Almancenage / Mapas",noSavedMaps:"No hay ningún mapa guardado todavía"}},header:{visibleLayers:"Capas visibles",layerLegend:"Capa de leyenda"},interactions:{tooltip:"Sugerencias",brush:"Pincel",coordinate:"Coordenadas",geocoder:"Geocodificador"},layerBlending:{title:"Combinación de capas",additive:"aditiva",normal:"normal",subtractive:"substractiva"},columns:{title:"Columnas",lat:"lat",lng:"lon",altitude:"altura",icon:"ícono",geojson:"geojson",arc:{lat0:"lat origen",lng0:"lng origen ",lat1:"lat destino",lng1:"lng destino"},line:{alt0:"altura origen",alt1:"altura destino"},grid:{worldUnitSize:"Tamaño de la malla (km)"},hexagon:{worldUnitSize:"Radio de hexágono (km)"},hex_id:"id hex"},color:{customPalette:"Paleta personalizada",steps:"pasos",type:"tipo",reversed:"invertida"},scale:{colorScale:"Escala de color",sizeScale:"Escala de medidas",strokeScale:"Escala de trazo",scale:"Escala"},fileUploader:{message:"Arrastra y suelta el archivo aquí",chromeMessage:"*usuario de Chrome: la medida máxima son 250mb, si debes cargar un archivo más grande utiliza Safari",disclaimer:"*kepler.gl es una aplicación al lado cliente que no utiliza ningún servidor. Los datos sólo existen en tu máquina/navegador. No se envian datos ni mapas a ningún servidor.",configUploadMessage:"Cargar {fileFormatNames} o un mapa guardado en **Json**. Más información sobre [**supported file formats**]",browseFiles:"navega por tus archivos",uploading:"Cargando",fileNotSupported:"El archivo {errorFiles} no es compatible.",or:"o"},geocoder:{title:"Introduce una dirección"},fieldSelector:{clearAll:"Quitar todos",formatting:"Formato"},compare:{modeLabel:"Modo Comparación",typeLabel:"Tipo de Comparación",types:{absolute:"Absoluta",relative:"Relativa"}},mapPopover:{primary:"Principal"},density:"densidad","Bug Report":"Informe de errores","User Guide":"Guía de usuario",Save:"Guadar",Share:"Compartir"};e.default=s},70604:(t,e,n)=>{"use strict";var r=n(95709);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r(n(26396));function o(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}var s={property:{weight:"painotus",label:"nimiö",fillColor:"täyttöväri",color:"väri",strokeColor:"viivan väri",radius:"säde",outline:"ääriviiva",stroke:"viiva",density:"tiheys",coverage:"kattavuus",sum:"summa",pointCount:"pisteiden lukumäärä"},placeholder:{search:"Etsi",selectField:"Valitse kenttä",yAxis:"Y-akseli",selectType:"Valitse tyyppi",selectValue:"Valitse arvo",enterValue:"Anna arvo",empty:"tyhjä"},misc:{by:"",valuesIn:"Arvot joukossa:",valueEquals:"Arvo on yhtäsuuri kuin",dataSource:"Aineistolähde",brushRadius:"Harjan säde (km)",empty:" "},mapLayers:{title:"Kartan tasot",label:"Nimiöt",road:"Tiet",border:"Rajat",building:"Rakennukset",water:"Vesi",land:"Maa","3dBuilding":"3d-rakennukset",background:"Tausta"},panel:{text:{label:"Nimiö",labelWithId:"Nimiö {labelId}",fontSize:"Fontin koko",fontColor:"Fontin väri",textAnchor:"Tekstin ankkuri",alignment:"Sijoittelu",addMoreLabel:"Lisää uusia nimiöitä"}},sidebar:{panels:{layer:"Tasot",filter:"Suodattimet",interaction:"Interaktiot",basemap:"Taustakartta"}},layer:{required:"Pakollinen*",radius:"Säde",weight:"Painotus",propertyBasedOn:"{property} perustuen arvoon",color:"Väri",fillColor:"Täytön väri",outline:"ääriviiva",coverage:"Kattavuus",stroke:"Viiva",strokeWidth:"Viivan paksuus",strokeColor:"Viivan väri",basic:"Perus",trailLength:"Jäljen pituus",trailLengthDescription:"Jäljen kesto sekunteina, ennenkuin se himmenee näkyvistä",newLayer:"uusi taso",elevationByDescription:"Kun asetus on pois päältä, korkeus perustuu pisteiden määrään",colorByDescription:"Kun asetus on pois päältä, väri perustuu pisteiden määrään",aggregateBy:"Aggregoi kenttä {field} by","3DModel":"3D-malli","3DModelOptions":"3D-mallin asetukset",type:{point:"piste",arc:"kaari",line:"viiva",grid:"ruudukko",hexbin:"hexbin",polygon:"polygoni",geojson:"geojson",cluster:"klusteri",icon:"kuva",heatmap:"lämpökartta",hexagon:"kuusikulmio",hexagonid:"H3",trip:"matka",s2:"S2","3d":"3D"},layerUpdateError:"Tason päivityksen aikana tapahtui virhe: {errorMessage}. Varmista, että syötetietojen muoto on kelvollinen."},layerVisConfigs:{strokeWidth:"Viivan paksuus",strokeWidthRange:"Viivan paksuuden rajat",radius:"Säde",fixedRadius:"Vakiosäde metreinä",fixedRadiusDescription:"Kartan säde absoluuttiseksi säteeksi metreinä, esim. 5 -> 5 metriin",radiusRange:"Säteen rajat",clusterRadius:"Klusterien säde pikseleinä",radiusRangePixels:"Säteen rajat pikseleinä",opacity:"Läpinäkyvyys",coverage:"Kattavuus",outline:"Ääriviiva",colorRange:"Värien rajat",stroke:"Viiva",strokeColor:"Viivan väri",strokeColorRange:"Viivan värin rajat",targetColor:"Kohteen väri",colorAggregation:"Värien aggregointi",heightAggregation:"Korkeuden aggregointi",resolutionRange:"Resoluution rajat",sizeScale:"Koon skaala",worldUnitSize:"Yksikkö",elevationScale:"Korottamisen skaala",enableElevationZoomFactor:"Käytä korkeuden zoomauskerrointa",enableElevationZoomFactorDescription:"Säädä korkeus / korkeus nykyisen zoomauskertoimen perusteella",enableHeightZoomFactor:"Käytä korkeuden zoomauskerrointa",heightScale:"Korkeuden skaala",coverageRange:"Peittävyyden rajat",highPrecisionRendering:"Tarkka renderöinti",highPrecisionRenderingDescription:"Tarkka renderöinti johtaa hitaampaan suorittamiseen",height:"Korkeus",heightDescription:"Klikkaa oikeasta ylänurkasta nappia vaihtaaksesi 3D-näkymään",fill:"Täyttö",enablePolygonHeight:"Salli polygonien korkeus",showWireframe:"Näytä rautalankamalli",weightIntensity:"Painotuksen intensiteetti",zoomScale:"Zoomausskaala",heightRange:"Korkeuden rajat",heightMultiplier:"Korkeuskerroin"},layerManager:{addData:"Lisää aineisto",addLayer:"Lisää taso",layerBlending:"Tasojen sekoittuvuus"},mapManager:{mapStyle:"Kartan tyyli",addMapStyle:"Lisää tyyli kartalle","3dBuildingColor":"3D-rakennusten väri",backgroundColor:"Taustaväri"},layerConfiguration:{defaultDescription:"Laske suureen {property} arvo valitun kentän perusteella",howTo:"Miten toimii"},filterManager:{addFilter:"Lisää suodatin"},datasetTitle:{showDataTable:"Näytä attribuuttitaulu",removeDataset:"Poista aineisto"},datasetInfo:{rowCount:"{rowCount} riviä"},tooltip:{hideLayer:"Piilota taso",showLayer:"Näytä taso",hideFeature:"Piilota kohde",showFeature:"Näytä kohde",hide:"piilota",show:"näytä",removeLayer:"Poista taso",resetAfterError:"Yritä ottaa taso käyttöön virheen jälkeen",layerSettings:"Tason asetukset",closePanel:"Sulje paneeli",switchToDualView:"Vaihda kaksoiskarrtanäkymään",showLegend:"Näytä selite",disable3DMap:"Poistu 3D-näkymästä",DrawOnMap:"Piirrä kartalle",selectLocale:"Valitse kielisyys",hideLayerPanel:"Piilota tasopaneeli",showLayerPanel:"Näytä tasopaneeli",moveToTop:"Siirrä tasojen päällimmäiseksi",selectBaseMapStyle:"Valitse taustakarttatyyli",delete:"Poista",timePlayback:"Ajan animointi",cloudStorage:"Pilvitallennus","3DMap":"3D-näkymä"},toolbar:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?o(Object(n),!0).forEach((function(e){(0,i.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({exportImage:"Vie kuva",exportData:"Vie aineistot",exportMap:"Vie kartta",shareMapURL:"Jaa kartan URL",saveMap:"Tallenna kartta",select:"valitse",polygon:"polygoni",rectangle:"nelikulmio",hide:"piilota",show:"näytä"},n(38911).LOCALES),modal:{title:{deleteDataset:"Poista aineisto",addDataToMap:"Lisää aineistoja kartalle",exportImage:"Vie kuva",exportData:"Vie aineistot",exportMap:"Vie kartta",addCustomMapboxStyle:"Lisää oma Mapbox-tyyli",saveMap:"Tallenna kartta",shareURL:"Jaa URL"},button:{delete:"Poista",download:"Lataa",export:"Vie",addStyle:"Lisää tyyli",save:"Tallenna",defaultCancel:"Peru",defaultConfirm:"Vahvista"},exportImage:{ratioTitle:"Kuvasuhde",ratioDescription:"Valitse sopiva kuvasuhde käyttötapaustasi varten.",ratioOriginalScreen:"Alkuperäinen näyttö",ratioCustom:"Kustomoitu",ratio4_3:"4:3",ratio16_9:"16:9",resolutionTitle:"Resoluutio",resolutionDescription:"Korkea resoluutio on parempi tulostamista varten.",mapLegendTitle:"Kartan selite",mapLegendAdd:"Lisää selite karttaan"},exportData:{datasetTitle:"Aineistot",datasetSubtitle:"Valitse aineisto, jonka aiot viedä",allDatasets:"Kaikki",dataTypeTitle:"Aineistojen formaatti",dataTypeSubtitle:"Valitse aineistoformaatti valitsemillesi aineistoille",filterDataTitle:"Suodata aineistoja",filterDataSubtitle:"Voit viedä joko alkuperäiset aineistot tai suodatetut aineistot",filteredData:"Suodatetut aineistot",unfilteredData:"Suodattamattomat aineistot",fileCount:"{fileCount} tiedostoa",rowCount:"{rowCount} riviä"},deleteData:{warning:"aiot poistaa tämän aineiston. Aineostoa käyttävien tasojen lukumäärä: {length}"},addStyle:{publishTitle:"1. Julkaise tyylisi Mapboxissa tai anna tunniste",publishSubtitle1:"Voit luoda oman karttatyylisi sivulla",publishSubtitle2:"ja",publishSubtitle3:"julkaista",publishSubtitle4:"sen.",publishSubtitle5:"Käyttääksesi yksityistä tyyliä, liitä",publishSubtitle6:"tunnisteesi",publishSubtitle7:"tänne. *kepler.gl on client-side sovellus, data pysyy vain selaimessasi...",exampleToken:"esim. pk.abcdefg.xxxxxx",pasteTitle:"2. Liitä tyyli-URL",pasteSubtitle1:"Mikä on",pasteSubtitle2:"tyyli-URL?",namingTitle:"3. Nimeä tyylisi"},shareMap:{shareUriTitle:"Jaa kartan URL",shareUriSubtitle:"Luo kartalle URL, jonka voit jakaa muiden kanssa",cloudTitle:"Pilvitallennus",cloudSubtitle:"Kirjaudu sisään ja lataa kartta ja aineistot henkilökohtaiseen pilvipalveluun",shareDisclaimer:"kepler.gl tallentaa kartan datan henkilökohtaiseen pilvitallennustilaasi, vain ihmiset, joilla on URL, voivat päästä käsiksi karttaan ja aineistoihin. Voit muokata tiedostoja tai poistaa ne pilvipalvelustasi milloin vain.",gotoPage:"Mene Kepler.gl {currentProvider} sivullesi"},statusPanel:{mapUploading:"Karttaa ladataan",error:"Virhe"},saveMap:{title:"Pilvitallennus",subtitle:"Kirjaudu sisään pilvipalveluusi tallentaaksesi kartan"},exportMap:{formatTitle:"Kartan formaatti",formatSubtitle:"Valitse formaatti, jossa viet kartan",html:{selection:"Vie kartta interaktiivisena html-tiedostona",tokenTitle:"Mapbox-tunniste",tokenSubtitle:"Käytä omaa Mapbox-tunnistettasi html-tiedostossa (valinnainen)",tokenPlaceholder:"Liitä Mapbox-tunnisteesi",tokenMisuseWarning:"* Jos et käytä omaa tunnistettasi, kartta voi lakata toimimasta milloin vain kun vaihdamme omaa tunnistettamme väärinkäytön estämiseksi. ",tokenDisclaimer:"Voit vaihtaa Mapbox-tunnisteesi näiden ohjeiden avulla: ",tokenUpdate:"Kuinka vaihtaa olemassaoleva Mapbox-tunniste",modeTitle:"Kartan tila",modeSubtitle1:"Valitse kartan tila.",modeSubtitle2:"Lisätietoja",modeDescription:"Anna käyttäjien {mode} karttaa",read:"lukea",edit:"muokata"},json:{configTitle:"Kartan asetukset",configDisclaimer:"Kartan asetukset sisältyvät Json-tiedostoon. Jos käytät kirjastoa kepler.gl omassa sovelluksessasi. Voit kopioida asetukset ja antaa ne funktiolle: ",selection:"Vie kyseisen kartan aineistot ja asetukset yhdessä json-tiedostossa. Voit myöhemmin avata saman kartan lataamalla tiedoston kepler.gl:n",disclaimer:"* Kartan asetukset ovat sidoksissa ladattuihin aineistoihin. Arvoa ‘dataId’ käytetään tasojen, suodattimien ja vihjeiden liittämiseksi tiettyyn aineistoon. Varmista, että aineiston dataId:t vastaavat asetusten arvoja jos lataat asetukset käyttäen `addDataToMap`-funktiolle."}},loadingDialog:{loading:"Ladataan..."},loadData:{upload:"Lataa tiedostot",storage:"Lataa tallennustilasta"},tripInfo:{title:"Kuinka käyttää matka-animaatiota",description1:"Reitin animoimiseksi geoJSON-aineiston täytyy olla geometriatyypiltään `LineString`, LineString-koordinaattien täytyy sisältää 4 elementtiä formaatissa:",code:" [pituusaste, leveysaste, korkeus, aikaleima] ",description2:"siten, että viimeinen elementti on aikaleima. Aikaleima voi olla muodoltaan unix-sekunteja, kuten `1564184363` tai millisekunteja, kuten `1564184363000`.",example:"Esimerkki:"},iconInfo:{title:"Miten piirtää kuvia",description1:"csv-tiedostossasi, luo sarake nimeltä icon. Voit jättää sen tyhjäksi jos et halua piirtää kuvaa joillain pisteillä. Kun sarakkeen nimi on ",code:"icon",description2:" kepler.gl luo automaattisesti kuvatason sinua varten.",example:"Esimerkki:",icons:"Kuvat"},storageMapViewer:{lastModified:"Viimeksi muokattu {lastUpdated} sitten",back:"Takaisin"},overwriteMap:{title:"Tallennetaan karttaa...",alreadyExists:"on jo {mapSaved}:ssa. Haluatko ylikirjoittaa sen?"},loadStorageMap:{back:"Takaisin",goToPage:"Mene Kepler.gl {displayName} sivullesi",storageMaps:"Tallennus / Kartat",noSavedMaps:"Ei tallennettuja karttoja vielä"}},header:{visibleLayers:"Näkyvissä olevat tasot",layerLegend:"Tason selite"},interactions:{tooltip:"Vihje",brush:"Harja",coordinate:"Koordinaatit"},layerBlending:{title:"Tasojen sekoittuvuus",additive:"lisäävä",normal:"normaali",subtractive:"vähentävä"},columns:{title:"Sarakkeet",lat:"lat",lng:"lng",altitude:"korkeus",icon:"kuva",geojson:"geojson",arc:{lat0:"lähdön lat",lng0:"lähdön lng",lat1:"kohteen lat",lng1:"kohteen lng"},line:{alt0:"lähteen korkeus",alt1:"kohde korkeus"},grid:{worldUnitSize:"Ruutujen koko (km)"},hexagon:{worldUnitSize:"Hexagonien säde (km)"}},color:{customPalette:"Mukautettu paletti",steps:"askeleet",type:"tyyppi",reversed:"käänteinen"},scale:{colorScale:"Värin skaala",sizeScale:"Koon skaala",strokeScale:"Viivan paksuuden skaala",scale:"Skaala"},fileUploader:{message:"Raahaa ja pudota tiedostosi tänne",chromeMessage:"*Chromen käyttäjä: Rajoita tiedostokokosi 250Mb:hen. Jos haluat suurempia tiedostoja, kokeile Safaria",disclaimer:"*kepler.gl on client-side sovellus, data pysyy vain selaimessasi...Tietoja ei lähetetä palvelimelle.",configUploadMessage:"Lisää {fileFormatNames} tai tallennettu kartta **Json**. Lue lisää [**tuetuista formaateista**]",browseFiles:"selaa tiedostojasi",uploading:"ladataan",fileNotSupported:"Tiedosto {errorFiles} ei ole tuettu.",or:"tai"},density:"tiheys","Bug Report":"Bugiraportointi","User Guide":"Opas",Save:"Tallenna",Share:"Jaa"};e.default=s},52424:(t,e,n)=>{"use strict";var r=n(95709);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r(n(26396));function o(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}var s={property:{weight:"重み",label:"ラベル",fillColor:"塗りつぶしの色",color:"色",coverage:"カバー率",strokeColor:"線の色",radius:"半径",outline:"輪郭線",stroke:"線の太さ",density:"密度",height:"高さ",sum:"合計",pointCount:"点の数"},placeholder:{search:"検索",selectField:"フィールドを選択",yAxis:"Y軸",selectType:"タイプを選択",selectValue:"値を選択",enterValue:"値を入力",empty:"未選択"},misc:{by:"",valuesIn:"値が以下に含まれる",valueEquals:"値が以下に等しい",dataSource:"データソース",brushRadius:"ブラシ半径 (km)",empty:" "},mapLayers:{title:"地図レイヤ",label:"ラベル",road:"道路",border:"境界線",building:"建物",water:"水",land:"地面","3dBuilding":"3D建物",background:"背景"},panel:{text:{label:"ラベル",labelWithId:"ラベル {labelId}",fontSize:"文字サイズ",fontColor:"文字色",textAnchor:"文字左右",alignment:"文字上下",addMoreLabel:"ラベルを追加"}},sidebar:{panels:{layer:"レイヤ",filter:"フィルター",interaction:"インタラクション",basemap:"ベースマップ"}},layer:{required:"必須*",radius:"半径",color:"色",fillColor:"塗りつぶしの色",outline:"輪郭線",weight:"重み",propertyBasedOn:"{property}の基準",coverage:"カバー率",stroke:"線",strokeWidth:"線の太さ",strokeColor:"線の色",basic:"基本設定",trailLength:"痕跡の長さ",trailLengthDescription:"痕跡が完全に消えるまでの秒数",newLayer:"新しいレイヤ",elevationByDescription:"オフの場合、高さは点の数に応じて決まります",colorByDescription:"オフの場合、色は点の数に応じて決まります",aggregateBy:"{field}を以下で集計: ","3DModel":"3Dモデル","3DModelOptions":"3Dモデルのオプション",type:{point:"point",arc:"arc",line:"line",grid:"grid",hexbin:"hexbin",polygon:"polygon",geojson:"geojson",cluster:"cluster",icon:"icon",heatmap:"heatmap",hexagon:"hexagon",hexagonid:"H3",trip:"trip",s2:"S2","3d":"3D"}},layerVisConfigs:{angle:"角度",strokeWidth:"線の太さ (ピクセル)",strokeWidthRange:"線の太さの範囲",radius:"半径",fixedRadius:"半径をメートルで固定",fixedRadiusDescription:"半径をメートル単位の絶対半径に変換します（例: 5 → 5メートル）",radiusRange:"半径の範囲",clusterRadius:"クラスターの範囲[ピクセル]",radiusRangePixels:"半径の範囲[ピクセル]",opacity:"不透明度",coverage:"カバー率",outline:"輪郭線",colorRange:"色の範囲",stroke:"線",strokeColor:"線の色",strokeColorRange:"線の色の範囲",targetColor:"Targetの色",colorAggregation:"色の集計",heightAggregation:"高さの集計",resolutionRange:"解像度の範囲",sizeScale:"サイズのスケール",worldUnitSize:"World Unit Size",elevationScale:"標高のスケール",enableElevationZoomFactor:"標高ズーム係数を使用する",enableElevationZoomFactorDescription:"現在のズーム率に基づいて高さ/標高を調整します",enableHeightZoomFactor:"高さズーム係数を使用する",heightScale:"高さのスケール",coverageRange:"カバー率の範囲",highPrecisionRendering:"高精度レンダリング",highPrecisionRenderingDescription:"高精度にすると速度は低下します",height:"高さ",heightDescription:"3Dビューに切り替えるには画面右上のボタンをクリックします",fill:"塗りつぶし",enablePolygonHeight:"ポリゴンの高さを有効にする",showWireframe:"ワイヤーフレームを表示",weightIntensity:"重みづけの強さ",zoomScale:"ズームのスケール",heightRange:"高さの範囲",heightMultiplier:"高さ乗数"},layerManager:{addData:"データ追加",addLayer:"レイヤ追加",layerBlending:"レイヤのブレンド"},mapManager:{mapStyle:"マップスタイル",addMapStyle:"マップスタイル追加","3dBuildingColor":"3D建物の色",backgroundColor:"背景色"},layerConfiguration:{defaultDescription:"選択されたフィールドに基づいて{property}を計算します",howTo:"使い方"},filterManager:{addFilter:"フィルター追加"},datasetTitle:{showDataTable:"データ表を表示",removeDataset:"データセットを削除"},datasetInfo:{rowCount:"{rowCount}行"},tooltip:{hideLayer:"レイヤを非表示",showLayer:"レイヤを表示",hideFeature:"フィーチャーを非表示",showFeature:"フィーチャーを表示",hide:"非表示にする",show:"表示する",removeLayer:"レイヤを削除",duplicateLayer:"レイヤを複製",layerSettings:"レイヤ設定",closePanel:"このパネルを閉じる",switchToDualView:"デュアルビューに切り替え",showLegend:"凡例を表示",disable3DMap:"3D地図を無効化",DrawOnMap:"地図上に図形を描画",selectLocale:"言語設定",hideLayerPanel:"レイヤパネルを非表示",showLayerPanel:"レイヤパネルを表示",moveToTop:"データレイヤの手前に移動",selectBaseMapStyle:"ベースマップのスタイルを選択",delete:"削除",timePlayback:"時系列で再生",cloudStorage:"クラウドストレージ","3DMap":"3D地図",animationByWindow:"時間枠を移動",animationByIncremental:"時間枠を増加",speed:"速度",play:"再生",pause:"一時停止",reset:"リセット"},toolbar:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?o(Object(n),!0).forEach((function(e){(0,i.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({exportImage:"画像を出力",exportData:"データを出力",exportMap:"地図を出力",shareMapURL:"地図のURLを共有",saveMap:"地図を保存",select:"選択",polygon:"ポリゴン",rectangle:"長方形",hide:"非表示",show:"表示"},n(38911).LOCALES),modal:{title:{deleteDataset:"データセットを削除",addDataToMap:"地図にデータを追加",exportImage:"画像を出力",exportData:"データを出力",exportMap:"地図を出力",addCustomMapboxStyle:"カスタムマップスタイルを追加",saveMap:"地図を保存",shareURL:"URLを共有"},button:{delete:"削除",download:"ダウンロード",export:"出力",addStyle:"スタイル追加",save:"保存",defaultCancel:"キャンセル",defaultConfirm:"確認"},exportImage:{ratioTitle:"縦横比",ratioDescription:"用途に適した縦横比を選択します。",ratioOriginalScreen:"元のスクリーンサイズ",ratioCustom:"カスタム",ratio4_3:"4:3",ratio16_9:"16:9",resolutionTitle:"解像度",resolutionDescription:"印刷には高解像度が適しています。",mapLegendTitle:"地図の凡例",mapLegendAdd:"地図に判例を追加"},exportData:{datasetTitle:"データセット",datasetSubtitle:"エクスポートしたいデータセットを選択します",allDatasets:"全て",dataTypeTitle:"データ形式",dataTypeSubtitle:"エクスポートしたいデータ形式を選択します",filterDataTitle:"データのフィルタ",filterDataSubtitle:"元データ（フィルタなし）とフィルタ済データのどちらをエクスポートするか選択します",filteredData:"フィルタ済データ",unfilteredData:"元データ",fileCount:"{fileCount}個のファイル",rowCount:"{rowCount}行"},deleteData:{warning:"このデータセットを削除します。{length}個のレイヤに影響します。"},addStyle:{publishTitle:"2. ステップ1でMapboxのスタイルURLを指定した場合、Mapboxでスタイルを公開するか、アクセストークンを以下に入力します（オプション）",publishSubtitle1:"独自のスタイルを",publishSubtitle2:"で作成し、",publishSubtitle3:"公開",publishSubtitle4:"することができます",publishSubtitle5:"非公開のスタイルを使用するには、自身の",publishSubtitle6:"アクセストークン",publishSubtitle7:"をここに入力します。*kepler.glはクライアント上で動作するため、データは自身のブラウザに保持されます。",exampleToken:"例) pk.abcdefg.xxxxxx",pasteTitle:"1. スタイルのURLをペースト",pasteSubtitle0:"スタイルのURLはMapboxの",pasteSubtitle1:"What is a",pasteSubtitle2:"スタイルURL",pasteSubtitle3:"を指定するか、Mapbox GLの仕様に沿ったstyle.jsonのURLを指定します：",pasteSubtitle4:"Mapbox GL スタイル仕様",namingTitle:"3. スタイルの名称を設定"},shareMap:{shareUriTitle:"地図のURLを共有",shareUriSubtitle:"共有用に地図のURLを生成",cloudTitle:"クラウドストレージ",cloudSubtitle:"ログインして地図データを個人用クラウドストレージにアップロード",shareDisclaimer:"kepler.glは作成した地図をあなたのクラウドストレージに保存するため、そのURLを知っている人のみが地図やそのデータにアクセス可能です。クラウドストレージのアカウントでいつでもデータファイルを編集/削除することができます。",gotoPage:"Kepler.glの{currentProvider}ページに移動"},statusPanel:{mapUploading:"地図をアップロード中",error:"エラー"},saveMap:{title:"クラウドストレージ",subtitle:"地図を個人用クラウドストレージに保存するためにログインする"},exportMap:{formatTitle:"地図の形式",formatSubtitle:"地図の出力形式を選択します",html:{selection:"地図をインタラクティブなHTMLファイルとして出力します。",tokenTitle:"Mapboxアクセストークン",tokenSubtitle:"HTMLファイルで自分のMapboxアクセストークンを使用します (オプション)",tokenPlaceholder:"自分のMapboxアクセストークンをここに貼り付け",tokenMisuseWarning:"* 自分のトークンを使用しない場合は、デフォルトのトークンが悪用防止のために更新され、地図が表示されなくなる可能性があります。  ",tokenDisclaimer:"Mapboxのトークンは下記の方法に従って後から変更することも可能です：",tokenUpdate:"既存の地図のトークンを更新する方法",modeTitle:"地図のモード",modeSubtitle1:"地図のモードを選択します。詳細は",modeSubtitle2:"こちら",modeDescription:"ユーザーに地図の{mode}を許可",read:"閲覧",edit:"編集"},json:{configTitle:"地図の設定",configDisclaimer:"地図の設定はjsonファイルに収められます。他のアプリケーションでkepler.glを使用する場合、この設定をコピーペーストすることが可能です：",selection:"現在の地図データと設定を単一のjsonファイルに出力します。このファイルをkepler.glにアップロードすることで、同じ地図を後から開くことが可能になります。",disclaimer:"* 地図の設定は読み込まれたデータセットとセットになっています。‘dataId’によってレイヤ、フィルター、ツールチップは特定のデータセットに紐づけられます。 この設定をaddDataToMapに渡す際は、データセットIDがこの設定内のdataIdと一致するようにしてください。"}},loadingDialog:{loading:"ロード中..."},loadData:{upload:"ファイルをロード",storage:"ストレージからロード"},tripInfo:{title:"移動アニメーションを有効にする方法",description1:"経路をアニメーション化するには、geoJSONデータはfeatureのgeometryとして `LineString` を含む必要があります。また、LineStringの座標は4つの要素を",code:" [経度, 緯度, 標高, timestamp] ",description2:"という形式（最後にタイムスタンプを含む）で保持する必要があります。タイムスタンプの形式は、 UNIX時間の秒単位（例: `1564184363`）またはミリ秒単位（例: `1564184363000`）が有効です。",example:"例："},iconInfo:{title:"アイコンの描画方法",description1:"CSVファイルに列を作成し、描画したいアイコンの名称を記載します。アイコンの描画が不要な点があれば、セルを空白にすることも可能です。列名が",code:"icon",description2:"の場合、kepler.glは自動的にアイコンレイヤを作成します。",example:"例:",icons:"アイコン一覧"},storageMapViewer:{lastModified:"最終編集：{lastUpdated} 前",back:"戻る"},overwriteMap:{title:"地図を保存中...",alreadyExists:"既に{mapSaved}に存在します。上書きしますか？"},loadStorageMap:{back:"戻る",goToPage:"Kepler.glの{displayName}ページに移動",storageMaps:"ストレージ / 地図",noSavedMaps:"保存済の地図はまだありません"}},header:{visibleLayers:"表示中のレイヤ",layerLegend:"レイヤ判例"},interactions:{tooltip:"ツールチップ",brush:"ブラシ",coordinate:"座標",geocoder:"ジオコーダー"},layerBlending:{title:"レイヤのブレンド",additive:"additive",normal:"normal",subtractive:"subtractive"},columns:{title:"列",lat:"緯度",lng:"経度",altitude:"標高",icon:"アイコン",geojson:"geojson",token:"トークン",arc:{lat0:"出発 緯度",lng0:"出発 経度",lat1:"到着 緯度",lng1:"到着 経度"},grid:{worldUnitSize:"グリッドサイズ (km)"},hexagon:{worldUnitSize:"六角形の半径 (km)"},hex_id:"hex id"},color:{customPalette:"カスタムパレット",steps:"段階数",type:"タイプ",reversed:"反転"},scale:{colorScale:"カラースケール",sizeScale:"サイズのスケール",strokeScale:"線のスケール",scale:"スケール"},fileUploader:{message:"ここにファイルをドロップ（複数可）",chromeMessage:"*Chromeユーザーの場合: ファイルサイズは250mbまでにしてください。それ以上のファイルをアップロードする必要がある場合、Safariを試してください。",disclaimer:"*kepler.glはクライアント上で動作します。データは自身の機器・ブラウザにのみ保持されます。情報や地図データは、いかなるサーバーにも送信されません。",configUploadMessage:"{fileFormatNames} または保存済地図の**Json**をアップロードします。詳細は以下を参照してください：[**対応ファイル形式**]",browseFiles:"デバイスのファイルを選択",uploading:"アップロード中",fileNotSupported:"{errorFiles} はサポートされていないファイルです。",or:"or"},geocoder:{title:"住所または座標を入力（例： 37.79,-122.40）"},fieldSelector:{clearAll:"全て解除",formatting:"値の形式"},compare:{modeLabel:"比較モード",typeLabel:"比較方式",types:{absolute:"絶対",relative:"相対"}},mapPopover:{primary:"プライマリ"},density:"density","Bug Report":"バグを報告","User Guide":"ユーザーガイド",Save:"保存",Share:"共有"};e.default=s},13873:(t,e,n)=>{"use strict";var r=n(95709);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r(n(26396));function o(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}var s={property:{weight:"Espessura do texto",label:"Rótulo",fillColor:"Cor do preenchimento",color:"Cor",strokeColor:"Cor da borda",radius:"Raio",outline:"Contorno",stroke:"Traçado",density:"Densidade",height:"Altura",sum:"Soma",pointCount:"Contagem de Pontos"},placeholder:{search:"Pesquisar",selectField:"Selecione um campo",yAxis:"Eixo Y",selectType:"Selecione um Tipo",selectValue:"Selecione um valor",enterValue:"Insira um valor",empty:"Vazio"},misc:{by:"",valuesIn:"Valores em",valueEquals:"Valor igual a",dataSource:"Origem dos dados",brushRadius:"Raio do Traço (km)",empty:" "},mapLayers:{title:"Camadas do mapa",label:"Rótulo",road:"Estrada",border:"Fronteira",building:"Edifícios",water:"Água",land:"Terra","3dBuilding":"Edifícios em 3d",background:"Fundo"},panel:{text:{label:"Rótulo",labelWithId:"Rótulo {labelId}",fontSize:"Tamanho da fonte",fontColor:"Cor da fonte",textAnchor:"Âncora do texto",alignment:"Alinhamento",addMoreLabel:"Adicionar mais Rótulos"}},sidebar:{panels:{layer:"Camadas",filter:"Filtros",interaction:"Interações",basemap:"Mapa base"}},layer:{required:"Obrigatório*",radius:"Raio",color:"Cor",fillColor:"Cor de preenchimento",outline:"Contorno",weight:"Espessura",propertyBasedOn:"{property} baseada em",coverage:"Cobertura",stroke:"Traço",strokeWidth:"Largura do Traçado",strokeColor:"Cor do Traçado",basic:"Básico",trailLength:"Comprimento da trilha",trailLengthDescription:"Número de segundos para um caminho completamente desaparecer",newLayer:"nova camada",elevationByDescription:"Quando desligado, a altura é baseada na contagem de pontos",colorByDescription:"Quando desligado, a cor é baseada na contagem de pontos",aggregateBy:"{field} agregado por","3DModel":"Modelo 3D","3DModelOptions":"Opções do Modelo 3D",type:{point:"ponto",arc:"arco",line:"linha",grid:"grade",hexbin:"hexágono",polygon:"polígono",geojson:"geojson",cluster:"grupo",icon:"icon",heatmap:"mapa de calor",hexagon:"hexágono",hexagonid:"H3",trip:"viagem",s2:"S2","3d":"3D"},layerUpdateError:"Ocorreu um erro ao atualizar a camada: {errorMessage}. Certifique-se de que o formato dos dados de entrada seja válido."},layerVisConfigs:{strokeWidth:"Largura do Traço",strokeWidthRange:"Alcance da Largura do Traço",radius:"Raio",fixedRadius:"Raio ajustado para metro",fixedRadiusDescription:"Raio do Mapa para Raio absoluto em metros, e.g. 5 para 5 metros",radiusRange:"Alcance do Raio",clusterRadius:"Raio do Agrupamento em pixels",radiusRangePixels:"Alcance do Raio em pixels",opacity:"Opacidade",coverage:"Cobertura",outline:"Contorno",colorRange:"Alcance da Cor",stroke:"Traçado",strokeColor:"Cor do Traçado",strokeColorRange:"Alcance da Cor do Traçado",targetColor:"Cor de destino",colorAggregation:"Agregação da Cor",heightAggregation:"Agregação da Altura",resolutionRange:"Alcance da Resolução",sizeScale:"Escala de tamanho",worldUnitSize:"Tamanho unitário do mundo",elevationScale:"Escala de Elevação",enableElevationZoomFactor:"Use fator de zoom de elevação",enableElevationZoomFactorDescription:"Ajuste a altura / elevação com base no fator de zoom atual",enableHeightZoomFactor:"Usar fator de zoom de altura",heightScale:"Escala de Altura",coverageRange:"Alcance de cobertura",highPrecisionRendering:"Renderização de Alta Precisão",highPrecisionRenderingDescription:"Alta precisão irá em resultar em baixa performance",height:"Altura",heightDescription:"Clique no botão no canto superior direito para trocar para a visualização 3d",fill:"Preenchimento",enablePolygonHeight:"Habilitar Altura de Polígono",showWireframe:"Mostrar Wireframe",weightIntensity:"Intensidade da Espessura",zoomScale:"Escala do Zoom",heightRange:"Alcance da Altura",heightMultiplier:"Multiplicador de altura"},layerManager:{addData:"Adicionar Dados",addLayer:"Adicionar Camada",layerBlending:"Mistura de Camada"},mapManager:{mapStyle:"Estilo do Mapa",addMapStyle:"Adicionar Estilo de Mapa","3dBuildingColor":"Cor do Edifício 3D",backgroundColor:"Cor de Fundo"},layerConfiguration:{defaultDescription:"Calcular {property} baseada no campo selecionado",howTo:"Como"},filterManager:{addFilter:"Adicionar Filtro"},datasetTitle:{showDataTable:"Mostrar tabela de dados",removeDataset:"Remover tabela de dados"},datasetInfo:{rowCount:"{rowCount} linhas"},tooltip:{hideLayer:"esconder camada",showLayer:"mostrar camada",hideFeature:"Esconder propriedade",showFeature:"Mostrar propriedade",hide:"esconder",show:"mostrar",removeLayer:"Remover Camada",resetAfterError:"Tente habilitar a camada após um erro",layerSettings:"Configurações de Camada",closePanel:"Fechar painel atual",switchToDualView:"Trocar para visualização dupla de mapa",showLegend:"mostrar legenda",disable3DMap:"Desabilitar Mapa 3D",DrawOnMap:"Desenhar no mapa",selectLocale:"Selecionar língua",hideLayerPanel:"Esconder painel de camada",showLayerPanel:"Mostrar painel de camada",moveToTop:"Mover para o topo das camadas",selectBaseMapStyle:"Selecionar o Estilo do Mapa Base",delete:"Deletar",timePlayback:"Tempo de reprodução",cloudStorage:"Armazenamento Cloud","3DMap":" Mapa 3D"},toolbar:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?o(Object(n),!0).forEach((function(e){(0,i.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({exportImage:"Exportar Imagem",exportData:"Exportar Dados",exportMap:"Exportar Mapa",shareMapURL:"Compartilhar URL do Mapa",saveMap:"Salvar Mapa",select:"selecionar",polygon:"polígono",rectangle:"retângulo",hide:"esconder",show:"mostrar"},n(38911).LOCALES),modal:{title:{deleteDataset:"Deletar Conjunto de Dados",addDataToMap:"Adicionar Dados ao Mapa",exportImage:"Exportar Imagem",exportData:"Exportar Dados",exportMap:"Exportar Mapa",addCustomMapboxStyle:"Adicionar Estilo Mapbox Customizado",saveMap:"Salvar Mapa",shareURL:"Compartilhar URL"},button:{delete:"Deletar",download:"Download",export:"Exportar",addStyle:"Adicionar Estilo",save:"Salvar",defaultCancel:"Cancelar",defaultConfirm:"Confirmar"},exportImage:{ratioTitle:"Proporção",ratioDescription:"Escolha a proporção para vários usos.",ratioOriginalScreen:"Tela Original",ratioCustom:"Customizado",ratio4_3:"4:3",ratio16_9:"16:9",resolutionTitle:"Resolução",resolutionDescription:"Alta resolução é melhor para impressões.",mapLegendTitle:"Legenda do Mapa",mapLegendAdd:"Adicionar Legenda no mapa"},exportData:{datasetTitle:"Conjunto de dados",datasetSubtitle:"Escolha o conjunto de dados que você quer exportar",allDatasets:"Todos",dataTypeTitle:"Tipo de Dado",dataTypeSubtitle:"Escolha o tipo de dados que você quer exportar",filterDataTitle:"Filtrar Dados",filterDataSubtitle:"Você pode escolher exportar os dados originais ou os dados filtrados",filteredData:"Dados Filtrados",unfilteredData:"Dados não filtrados",fileCount:"{fileCount} Arquivos",rowCount:"{rowCount} Linhas"},deleteData:{warning:"você irá deletar esse conjunto de dados. Isso irá afetar {length} camadas"},addStyle:{publishTitle:"1. Publique o seu Estilo no Mapbox ou providencie a chave de acesso",publishSubtitle1:"Você pode criar o seu próprio estilo em",publishSubtitle2:"e",publishSubtitle3:"publicar",publishSubtitle4:"isso.",publishSubtitle5:"Para utilizar estilo privado, cole a sua",publishSubtitle6:"chave de acesso",publishSubtitle7:"aqui. *kepler.gl é uma aplicação client-side, os dados permanecem no seu browser..",exampleToken:"e.g. pk.abcdefg.xxxxxx",pasteTitle:"2. Cole a url do seu estilo",pasteSubtitle1:"O que é uma",pasteSubtitle2:"URL de estilo",namingTitle:"3. Nomeie o seu estilo"},shareMap:{shareUriTitle:"Compartilhar a URL do Mapa",shareUriSubtitle:"Gerar a url do mapa e compartilhar com outros",cloudTitle:"Armazenamento Cloud",cloudSubtitle:"Conecte-se e envie os dados do mapa para o seu armazenamento cloud pessoal",shareDisclaimer:"kepler.gl irá salvar os dados do mapa em seu armazenamento cloud pessoal, apenas pessoas com a URL podem acessar o seu mapa e dados. Você pode editar/deletar o arquivo de dados na sua conta de armazenamento cloud em qualquer momento.",gotoPage:"Vá para a sua página Kepler.gl {currentProvider}"},statusPanel:{mapUploading:"Enviando Mapa",error:"Erro"},saveMap:{title:"Armazenamento Cloud",subtitle:"Conecte-se para salvar o mapa para o seu armazenamento cloud pessoal"},exportMap:{formatTitle:"Formato do mapa",formatSubtitle:"Escolher o formato de mapa para exportar",html:{selection:"Exportar seu mapa em um arquivo html interativo.",tokenTitle:"Chave de acesso do Mapbox",tokenSubtitle:"Use a sua própria chave de acesso Mapbox em seu arquivo html (opcional)",tokenPlaceholder:"Cole a sua chave de acesso Mapbox",tokenMisuseWarning:"* Se você não fornecer a sua própria chave de acesso, o mapa pode falhar em exibir a qualquer momento quando nós substituirmos a nossa para evitar mau uso. ",tokenDisclaimer:"Você pode trocar a sua chave de acesso Mapbox mais tarde utizando as instruções seguintes: ",tokenUpdate:"Como atualizar a chave de acesso de um mapa existente.",modeTitle:"Modo do Mapa",modeSubtitle1:"Selecionar o modo do aplicativo. Mais ",modeSubtitle2:"info",modeDescription:"Permitir usuários a {mode} o mapa",read:"ler",edit:"editar"},json:{configTitle:"Configurações do Mapa",configDisclaimer:"A configuração do mapa será incluida no arquivo Json. Se você está utilizando kepler.gl no seu próprio mapa. Você pode copiar essa configuração e passar para ele ",selection:"Exportar atuais dados e configurações do mapa em um único arquivo Json. Você pode mais tarde abrir o mesmo mapa enviando esse arquivo para o kepler.gl.",disclaimer:"* Configuração do mapa é aclopado com conjunto de dados carregados. ‘dataId’ é utilizado para ligar as camadas, filtros, e dicas de contextos a conjunto de dados expecíficos. Quando passando essa configuração para addDataToMap, tenha certeza de que o id do conjunto de dados combina com o(s) dataId/s nessa configuração."}},loadingDialog:{loading:"Carregando..."},loadData:{upload:"Carregar arquivo",storage:"Carregar do armazenamento"},tripInfo:{title:"Como habilitar animação de viagem",description1:"Para animar o caminho, o dado geoJSON deve conter `LineString` na sua propriedade geometry, e as coordenadas na LineString devem ter 4 elementos no seguinte formato",code:" [longitude, latitude, altitude, data] ",description2:"com um ultimo elemento sendo uma data. Um formato de data válida inclui segundos unix como `1564184363` ou em milisegundos como `1564184363000`.",example:"Exemplo:"},iconInfo:{title:"Como desenhar ícones",description1:"No seu csv, crie uma coluna, coloque o nome do ícone que você quer desenhar nele. Você pode deixar o campo vazio se você não desejar que o ícone apareça para alguns pontos. Quando a coluna tem nome",code:"icon",description2:" kepler.gl irá automaticamente criar uma camada de ícone para você.",example:"Exemplos:",icons:"Ícones"},storageMapViewer:{lastModified:"Modificado há {lastUpdated}",back:"Voltar"},overwriteMap:{title:"Salvando mapa...",alreadyExists:"já existe no mapa {mapSaved}. Você desejaria sobrescrever o mapa?"},loadStorageMap:{back:"Voltar",goToPage:"Vá para a sua página {displayName} do Kepler.gl",storageMaps:"Armazenamento / Mapas",noSavedMaps:"Nenhum mapa salvo"}},header:{visibleLayers:"Camadas Visíveis",layerLegend:"Legenda da Camada"},interactions:{tooltip:"Dica de contexto",brush:"Pincel",coordinate:"Coordenadas"},layerBlending:{title:"Mistura de Camadas",additive:"aditivo",normal:"normal",subtractive:"subtrativo"},columns:{title:"Colunas",lat:"lat",lng:"lon",altitude:"altitude",icon:"ícone",geojson:"geojson",arc:{lat0:"origem lat",lng0:"origem lng",lat1:"destino lat",lng1:"destino lng"},line:{alt0:"origem altitude",alt1:"destino altitude"},grid:{worldUnitSize:"Tamanho da Grade (km)"},hexagon:{worldUnitSize:"Raio do Hexágono (km)"}},color:{customPalette:"Paletas customizadas",steps:"caminhos",type:"tipo",reversed:"reverso"},scale:{colorScale:"Escala da Cor",sizeScale:"Tamanho da Escala",strokeScale:"Escala do Traço",scale:"Escala"},fileUploader:{message:"Arraste e solte seu(s) arquivo(s) aqui",chromeMessage:"*Usuários do chrome: O limite de tamanho de arquivo é 250mb, se você precisa fazer upload de arquivos maiores tente o Safari",disclaimer:"*kepler.gl é uma aplicação client-side, sem um servidor backend. Os dados ficam apenas na sua máquina/browser. Nenhuma informação ou dados de mapa é enviado para qualquer server.",configUploadMessage:"Envie {fileFormatNames} ou mapas salvos **Json**. Leia mais sobre [**tipos de arquivos suportados**]",browseFiles:"procure seus arquivos",uploading:"Enviando",fileNotSupported:"Arquivo {errorFiles} não é suportado.",or:"ou"},density:"densidade","Bug Report":"Reportar Bug","User Guide":"Guia do Usuário",Save:"Salvar",Share:"Compartilhar"};e.default=s},26047:(t,e,n)=>{"use strict";var r=n(95709);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r(n(26396));function o(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}var s={property:{weight:"вес",label:"ярлык",fillColor:"цвет заливки",color:"цвет",coverage:"покрытие",strokeColor:"цвет обводки",radius:"радиус",outline:"контур",stroke:"обводка",density:"плотность",height:"высота",sum:"сумма",pointCount:"Кол-во точек"},placeholder:{search:"Поиск",selectField:"Выберите поле",yAxis:"Y Ось",selectType:"Выберите A тип",selectValue:"Выберите A значение",enterValue:"Введите значение",empty:"пустой"},misc:{by:"",valuesIn:"Значение в",valueEquals:"Значение равно",dataSource:"Источник данных",brushRadius:"Радиус кисти (km)",empty:" "},mapLayers:{title:"Слои карты",label:"Обозначения",road:"Дороги",border:"Границы",building:"Здания",water:"Вода",land:"Земля","3dBuilding":"3d здания"},panel:{text:{label:"Ярлык",labelWithId:"Ярлык {labelId}",fontSize:"Размер шрифта",fontColor:"Цвет шрифта",textAnchor:"Анкор текста",alignment:"Положение",addMoreLabel:"Добавить еще ярлык"}},sidebar:{panels:{layer:"Слои",filter:"Фильтры",interaction:"Взаимодействия",basemap:"Базовая карта"}},layer:{required:"Требования*",radius:"Радиус",color:"Цвет",fillColor:"Цвет заливки",outline:"Контур",weight:"Вес",propertyBasedOn:"{property} на основе",coverage:"Покрытие",stroke:"Обводка",strokeWidth:"Ширина обводки",strokeColor:"Цвет обводки",basic:"Basic",trailLength:"Trail Length",trailLengthDescription:"Number of seconds for a path to completely fade out",newLayer:"new layer",elevationByDescription:"When off, height is based on count of points",colorByDescription:"When off, color is based on count of points",aggregateBy:"Aggregate {field} by","3DModel":"3D Model","3DModelOptions":"3D Model Options",type:{point:"точки",arc:"дуги",line:"линии",grid:"сетка",hexbin:"hexbin",polygon:"многоугольники",geojson:"geojson",cluster:"кластеры",icon:"значки",heatmap:"тепловая карта",hexagon:"шестиугольник",hexagonid:"H3",trip:"пути",s2:"S2","3d":"3D"}},layerVisConfigs:{angle:"Угол",strokeWidth:"Ширина штриха (в пикселях)",strokeWidthRange:"Диапазон ширины штриха",radius:"Радиус",fixedRadius:"Фиксированный радиус в метрах",fixedRadiusDescription:"Сопоставьте радиус с абсолютным радиусом в метрах, например От 5 до 5 метров",radiusRange:"Диапазон радиуса",clusterRadius:"Радиус кластера в пикселях",radiusRangePixels:"Диапазон радиуса в пикселях",opacity:"Непрозрачность",coverage:"Покрытие",outline:"Контур",colorRange:"Цветовая гамма",stroke:"Обводка",strokeColor:"Цвет обводки",strokeColorRange:"Обводка Цветовой диапазон",targetColor:"Целевой цвет",colorAggregation:"Цветовая агрегация",heightAggregation:"Агрегация по высоте",resolutionRange:"Диапазон разрешения",sizeScale:"Шкала размеров",worldUnitSize:"Мировые ед.изм.",elevationScale:"Шкала возвышения",enableElevationZoomFactor:"Использовать коэффициент увеличения по высоте",enableElevationZoomFactorDescription:"Отрегулируйте высоту / возвышение на основе текущего коэффициента масштабирования",enableHeightZoomFactor:"вкл. коэффициент масштабирования по высоте",heightScale:"Масштаб высоты",coverageRange:"Диапазон покрытия",highPrecisionRendering:"Высокая точность рендеринга",highPrecisionRenderingDescription:"Высокая точность приведет к снижению производительности",height:"Высота",heightDescription:"Нажмите кнопку в правом верхнем углу карты, чтобы переключиться в 3D-вид",fill:"Наполнить",enablePolygonHeight:"Включить высоту многоугольника",showWireframe:"Показать каркас",weightIntensity:"Вес Интенсивность",zoomScale:"Масштаб увеличения",heightRange:"Диапазон высоты",heightMultiplier:"Множитель высоты"},layerManager:{addData:"Добавить данные",addLayer:"Добавить слой",layerBlending:"Смешивание слоев"},mapManager:{mapStyle:"Стиль карты",addMapStyle:"Добавить стиль карты","3dBuildingColor":"3D Цвет здания"},layerConfiguration:{defaultDescription:"Рассчитать {property} на основе выбранного поля",howTo:"How to"},filterManager:{addFilter:"Добавить фильтр"},datasetTitle:{showDataTable:"Показать таблицу данных ",removeDataset:"Удалить набор данных"},datasetInfo:{rowCount:"{rowCount} строк"},tooltip:{hideLayer:"скрыть слой",showLayer:"показать слой",hideFeature:"Скрыть функцию",showFeature:"Показать функцию",hide:"скрыть",show:"показать",removeLayer:"Удалить слой",duplicateLayer:"Дублировать слой",layerSettings:"Настройки слоя",closePanel:"Закрыть текущую панель",switchToDualView:"Перейти в режим двойной карты",showLegend:"Показать легенду",disable3DMap:"Отключить 3D Карту",DrawOnMap:"Рисовать на карте",selectLocale:"Выберите регион",hideLayerPanel:"Скрыть панель слоев",showLayerPanel:"Показать панель слоев",moveToTop:"Перейти к верхним слоям данных",selectBaseMapStyle:"Выберите стиль базовой карты",delete:"Удалить",timePlayback:"Воспроизведение времени",cloudStorage:"Облачное хранилище","3DMap":"3D Карта",animationByWindow:"Перемещение временного окна",animationByIncremental:"Дополнительное временное окно",speed:"скорость",play:"проиграть",pause:"пауза",reset:"перезапустить"},toolbar:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?o(Object(n),!0).forEach((function(e){(0,i.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({exportImage:"Экспорт изображения",exportData:"Экспорт данных",exportMap:"Экспорт карты",shareMapURL:"Share Map URL",saveMap:"Сохарнить Карту",select:"Выбрать",polygon:"Многоугольник",rectangle:"Квадрат",hide:"Скрыть",show:"Показать"},n(38911).LOCALES),editor:{filterLayer:"Слои фильтров",copyGeometry:"Копировать геометрию"},modal:{title:{deleteDataset:"Удалить данные",addDataToMap:"Добавить данные на карту",exportImage:"Экспорт изображения",exportData:"Экспорт данных",exportMap:"Экспорт карты",addCustomMapboxStyle:"Добавить собственный стиль карты",saveMap:"Поделиться Картой",shareURL:"Поделиться URL"},button:{delete:"Удалить",download:"Скачать",export:"Экспортировать",addStyle:"Добавить стиль",save:"Сохранить",defaultCancel:"Отменить",defaultConfirm:"Подтвердить"},exportImage:{ratioTitle:"Ratio",ratioDescription:"Выберите соотношение для различного использования",ratioOriginalScreen:"Исходный экран",ratioCustom:"Настройки",ratio4_3:"4:3",ratio16_9:"16:9",resolutionTitle:"Разрешение",resolutionDescription:"Для печати лучше использовать высокое разрешение",mapLegendTitle:"Легенда карты",mapLegendAdd:"Добавить легенду на карту"},exportData:{datasetTitle:"Набор данных",datasetSubtitle:"Выберите наборы данных, которые хотите экспортировать",allDatasets:"Все",dataTypeTitle:"Тип данных",dataTypeSubtitle:"Выберите тип данных, которые вы хотите экспортировать",filterDataTitle:"Отфильтрованные данные",filterDataSubtitle:"Вы можете выбрать экспорт исходных данных или отфильтрованных данных",filteredData:"Отфильтрованные данные",unfilteredData:"Нефильтрованные данные",fileCount:"{fileCount} Файлов",rowCount:"{rowCount} Строк"},deleteData:{warning:"вы собираетесь удалить этот набор данных. Это повлияет на {length} слой"},addStyle:{publishTitle:"2. Если вы указали URL-адрес файла mapbox на шаге 1, опубликуйте свой стиль на mapbox или предоставьте токен доступа. (Необязательно)",publishSubtitle1:"Вы можете создать свой собственный стиль карты",publishSubtitle2:"и",publishSubtitle3:"опубликовать",publishSubtitle4:"его.",publishSubtitle5:"Чтобы использовать частный стиль, вставьте свой",publishSubtitle6:"token доступа",publishSubtitle7:"прим. kepler.gl - это клиентское приложение, данные остаются в вашем браузере .",exampleToken:"например pk.abcdefg.xxxxxx",pasteTitle:"1. Вставить URL стиля",pasteSubtitle0:"URL стиля может быть mapbox",pasteSubtitle1:"Или",pasteSubtitle2:"URL стиля",pasteSubtitle3:"style.json используя",pasteSubtitle4:"Mapbox GL Style Spec",namingTitle:"3. Назови свой стиль"},shareMap:{shareUriTitle:"Поделиться URL карты",shareUriSubtitle:"Создать URL карты, чтобы поделиться с другими",cloudTitle:"Облачное хранилище",cloudSubtitle:"Войдите и загрузите данные карты в свое личное облачное хранилище",shareDisclaimer:"kepler.gl сохранит данные вашей карты в вашем личном облачном хранилище, только люди с URL-адресом могут получить доступ к вашей карте и данным. Вы можете редактировать / удалить файл данных в своей облачной учетной записи в любое время.",gotoPage:"Перейти на страницу Kepler.gl {currentProvider}"},statusPanel:{mapUploading:"Загрузка карты",error:"Ошибка"},saveMap:{title:"Облачное хранилище",subtitle:"Авторизуйтесь, чтобы сохранить карту в вашем личном облачном хранилище"},exportMap:{formatTitle:"Формат карты",formatSubtitle:"Выберите формат для экспорта карты",html:{selection:"Экспорт карты в интерактивный файл HTML.",tokenTitle:"Токен доступа к Mapbox",tokenSubtitle:"Используйте свой токен доступа Mapbox в html(необязательно)",tokenPlaceholder:"Вставьте токен доступа Mapbox",tokenMisuseWarning:"* If you do not provide your own token, the map may fail to display at any time when we replace ours to avoid misuse. ",tokenDisclaimer:"Если вы не предоставите свой собственный токен, карта может не отображаться в любое время, когда мы заменяем наш, чтобы избежать неправильного использования.",tokenUpdate:"Как обновить существующий токен карты.",modeTitle:"Режим карты",modeSubtitle1:"Выберите режим приложения. Подробнее",modeSubtitle2:"Информация",modeDescription:"Разрешить пользователям {mode} карту",read:"чтение",edit:"редактирование"},json:{configTitle:"Конфигурация карты",configDisclaimer:"Конфигурация карты будет включена в файл Json. Если вы используете kepler.gl в своем собственном приложении. Вы можете скопировать этот конфиг и передать его ",selection:"Экспорт текущих данных карты и конфигурации в один файл Json. Позже вы сможете открыть ту же карту, загрузив этот файл на kepler.gl.",disclaimer:"* Конфигурация карты связана с загруженными наборами данных. DataId используется для привязки слоев, фильтров и всплывающих подсказок к определенному набору данных. При передаче этой конфигурации addDataToMap, убедитесь, что идентификатор набора данных совпадает с dataId / s в этой конфигурации."}},loadingDialog:{loading:"Загрузка..."},loadData:{upload:"Загрузить файлы",storage:"Загрузить из хранилища"},tripInfo:{title:"Как включить анимацию поездки",description1:"Чтобы анимировать путь, данные geoJSON должны содержать LineString в своей геометрии объекта, а координаты в LineString должны иметь 4 элемента в форматах",code:" [longitude, latitude, altitude, timestamp] ",description2:"с последним элементом, являющимся отметкой времени. Допустимые форматы меток времени включают unix в секундах, например 1564184363, или в миллисекундах, например 1564184363000",example:",Пример:"},iconInfo:{title:"Как рисовать значки",description1:"В вашем csv создайте столбец, поместите в него имя значка, который вы хотите нарисовать. Вы можете оставить ячейку пустой, если не хотите, чтобы значок отображался для некоторых точек. Когда столбец назван",code:"значек",description2:" kepler.gl автоматически создаст для вас слой значков.",example:"Пример:",icons:"Значки"},storageMapViewer:{lastModified:"Последнее изменение {lastUpdated} назад",back:"Назад"},overwriteMap:{title:"Сохранение карты...",alreadyExists:"уже существует в вашем {mapSaved}. Хотите его перезаписать?"},loadStorageMap:{back:"Назад",goToPage:"Перейти на страницу Kepler.gl {displayName}",storageMaps:"Хранилище / Карты",noSavedMaps:"Нет сохраненных карт"}},header:{visibleLayers:"Видимые слои",layerLegend:"Легенда слоя"},interactions:{tooltip:"Подсказка",brush:"Кисть",coordinate:"Координаты",geocoder:"Геокодер"},layerBlending:{title:"Смешивание слоев",additive:"добавление",normal:"нормальное",subtractive:"вычитание"},columns:{title:"Столбцы",lat:"lat",lng:"lon",altitude:"высота",icon:"значек",geojson:"geojson",token:"token",arc:{lat0:"lat источника",lng0:"lng источника",lat1:"lat цели",lng1:"lng цели"},line:{alt0:"высота источника",alt1:"высота цели"},grid:{worldUnitSize:"Размер сетки (km)"},hexagon:{worldUnitSize:"Hexagon радиус (km)"},hex_id:"hex id"},color:{customPalette:"Ваша палитра",steps:"шагов",type:"тип",reversed:"перевернуть"},scale:{colorScale:"Цветовая шкала",sizeScale:"Масштаб размера",strokeScale:"Масштаб штриха",scale:"Масштаб"},fileUploader:{message:"Перетащите сюда ваши файлы",chromeMessage:"*Пользователь Chrome: ограничьте размер файла до 250 МБ, если нужно загрузить файл большего размера, попробуйте Safari",disclaimer:"*kepler.gl - это клиентское приложение без серверной части. Данные живут только на вашем компьютере. Никакая информация или данные карты не отправляются ни на один сервер.",configUploadMessage:"Загрузите {fileFormatNames} или сохраненную карту **Json**. Подробнее [**supported file formats**]",browseFiles:"Просматреть файлы",uploading:"Загрузка",fileNotSupported:"File {errorFiles} is not supported.",or:"or"},geocoder:{title:"Введите адрес или координаты, например 37.79, -122.40"},fieldSelector:{clearAll:"Очистить все",formatting:"Форматирование"},compare:{modeLabel:"Режим сравнения",typeLabel:"Тип сравнения",types:{absolute:"Абсолютный",relative:"Относительный"}},mapPopover:{primary:"Первичный"},density:"density","Bug Report":"Отчет об ошибках","User Guide":"Инструкции",Save:"Сохранить",Share:"Поделиться"};e.default=s},22308:(t,e,n)=>{"use strict";n.d(e,{Vl:()=>et});var r={};n.r(r),n.d(r,{readFileAsArrayBuffer:()=>V,readFileAsText:()=>H,requireFromFile:()=>q,requireFromString:()=>W});var i=n(65606);const o={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:void 0!==n.g&&n.g,document:"undefined"!=typeof document&&document},s=o.global||o.self||o.window||{},a="object"!=typeof i||"[object process]"!==String(i)||i.browser,l="function"==typeof importScripts,u=("undefined"!=typeof window&&window.orientation,void 0!==i&&i.version&&/v([0-9]*)/.exec(i.version)),c=(u&&parseFloat(u[1]),"3.4.15"),h={draco:{decoderType:"object"==typeof WebAssembly?"wasm":"js",libraryPath:"libs/",extraAttributes:{},attributeNameEntry:void 0}},d={name:"Draco",id:a?"draco":"draco-nodejs",module:"draco",shapes:["mesh"],version:c,worker:!0,extensions:["drc"],mimeTypes:["application/octet-stream"],binary:!0,tests:["DRACO"],options:h};var f=n(67136);class p{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Map;(0,f.A)(this,"name",void 0),(0,f.A)(this,"type",void 0),(0,f.A)(this,"nullable",void 0),(0,f.A)(this,"metadata",void 0),this.name=t,this.type=e,this.nullable=n,this.metadata=r}get typeId(){return this.type&&this.type.typeId}clone(){return new p(this.name,this.type,this.nullable,this.metadata)}compareTo(t){return this.name===t.name&&this.type===t.type&&this.nullable===t.nullable&&this.metadata===t.metadata}toString(){return"".concat(this.type).concat(this.nullable?", nullable":"").concat(this.metadata?", metadata: ".concat(this.metadata):"")}}let g,y,m,v,b,_,A,x,w=function(t){return t[t.NONE=0]="NONE",t[t.Null=1]="Null",t[t.Int=2]="Int",t[t.Float=3]="Float",t[t.Binary=4]="Binary",t[t.Utf8=5]="Utf8",t[t.Bool=6]="Bool",t[t.Decimal=7]="Decimal",t[t.Date=8]="Date",t[t.Time=9]="Time",t[t.Timestamp=10]="Timestamp",t[t.Interval=11]="Interval",t[t.List=12]="List",t[t.Struct=13]="Struct",t[t.Union=14]="Union",t[t.FixedSizeBinary=15]="FixedSizeBinary",t[t.FixedSizeList=16]="FixedSizeList",t[t.Map=17]="Map",t[t.Dictionary=-1]="Dictionary",t[t.Int8=-2]="Int8",t[t.Int16=-3]="Int16",t[t.Int32=-4]="Int32",t[t.Int64=-5]="Int64",t[t.Uint8=-6]="Uint8",t[t.Uint16=-7]="Uint16",t[t.Uint32=-8]="Uint32",t[t.Uint64=-9]="Uint64",t[t.Float16=-10]="Float16",t[t.Float32=-11]="Float32",t[t.Float64=-12]="Float64",t[t.DateDay=-13]="DateDay",t[t.DateMillisecond=-14]="DateMillisecond",t[t.TimestampSecond=-15]="TimestampSecond",t[t.TimestampMillisecond=-16]="TimestampMillisecond",t[t.TimestampMicrosecond=-17]="TimestampMicrosecond",t[t.TimestampNanosecond=-18]="TimestampNanosecond",t[t.TimeSecond=-19]="TimeSecond",t[t.TimeMillisecond=-20]="TimeMillisecond",t[t.TimeMicrosecond=-21]="TimeMicrosecond",t[t.TimeNanosecond=-22]="TimeNanosecond",t[t.DenseUnion=-23]="DenseUnion",t[t.SparseUnion=-24]="SparseUnion",t[t.IntervalDayTime=-25]="IntervalDayTime",t[t.IntervalYearMonth=-26]="IntervalYearMonth",t}({});class C{static isNull(t){return t&&t.typeId===w.Null}static isInt(t){return t&&t.typeId===w.Int}static isFloat(t){return t&&t.typeId===w.Float}static isBinary(t){return t&&t.typeId===w.Binary}static isUtf8(t){return t&&t.typeId===w.Utf8}static isBool(t){return t&&t.typeId===w.Bool}static isDecimal(t){return t&&t.typeId===w.Decimal}static isDate(t){return t&&t.typeId===w.Date}static isTime(t){return t&&t.typeId===w.Time}static isTimestamp(t){return t&&t.typeId===w.Timestamp}static isInterval(t){return t&&t.typeId===w.Interval}static isList(t){return t&&t.typeId===w.List}static isStruct(t){return t&&t.typeId===w.Struct}static isUnion(t){return t&&t.typeId===w.Union}static isFixedSizeBinary(t){return t&&t.typeId===w.FixedSizeBinary}static isFixedSizeList(t){return t&&t.typeId===w.FixedSizeList}static isMap(t){return t&&t.typeId===w.Map}static isDictionary(t){return t&&t.typeId===w.Dictionary}get typeId(){return w.NONE}compareTo(t){return this===t}}Symbol.toStringTag,Symbol.toStringTag,g=Symbol.toStringTag;class S extends C{constructor(t,e){super(),(0,f.A)(this,"isSigned",void 0),(0,f.A)(this,"bitWidth",void 0),this.isSigned=t,this.bitWidth=e}get typeId(){return w.Int}get[g](){return"Int"}toString(){return"".concat(this.isSigned?"I":"Ui","nt").concat(this.bitWidth)}}class E extends S{constructor(){super(!0,8)}}class M extends S{constructor(){super(!0,16)}}class P extends S{constructor(){super(!0,32)}}class T extends S{constructor(){super(!1,8)}}class O extends S{constructor(){super(!1,16)}}class I extends S{constructor(){super(!1,32)}}y=Symbol.toStringTag;class R extends C{constructor(t){super(),(0,f.A)(this,"precision",void 0),this.precision=t}get typeId(){return w.Float}get[y](){return"Float"}toString(){return"Float".concat(this.precision)}}class B extends R{constructor(){super(32)}}class L extends R{constructor(){super(64)}}Symbol.toStringTag,Symbol.toStringTag,m=Symbol.toStringTag,v=Symbol.toStringTag,b=Symbol.toStringTag,_=Symbol.toStringTag,A=Symbol.toStringTag;class k extends C{constructor(t,e){super(),(0,f.A)(this,"listSize",void 0),(0,f.A)(this,"children",void 0),this.listSize=t,this.children=[e]}get typeId(){return w.FixedSizeList}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get[A](){return"FixedSizeList"}toString(){return"FixedSizeList[".concat(this.listSize,"]<").concat(this.valueType,">")}}x=Symbol.toStringTag;class D{constructor(t,e){(0,f.A)(this,"fields",void 0),(0,f.A)(this,"metadata",void 0),function(t){if(!t)throw new Error("loader assertion failed.")}(Array.isArray(t)),function(t){const e={};for(const n of t)e[n.name]&&console.warn("Schema: duplicated field name",n.name,n),e[n.name]=!0}(t),this.fields=t,this.metadata=e||new Map}compareTo(t){if(this.metadata!==t.metadata)return!1;if(this.fields.length!==t.fields.length)return!1;for(let e=0;e<this.fields.length;++e)if(!this.fields[e].compareTo(t.fields[e]))return!1;return!0}select(){const t=Object.create(null);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];for(const e of n)t[e]=!0;const i=this.fields.filter((e=>t[e.name]));return new D(i,this.metadata)}selectAt(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const r=e.map((t=>this.fields[t])).filter(Boolean);return new D(r,this.metadata)}assign(t){let e,n=this.metadata;if(t instanceof D){const r=t;e=r.fields,n=F(F(new Map,this.metadata),r.metadata)}else e=t;const r=Object.create(null);for(const t of this.fields)r[t.name]=t;for(const t of e)r[t.name]=t;const i=Object.values(r);return new D(i,n)}}function F(t,e){return new Map([...t||new Map,...e||new Map])}function N(t,e,n){return function(t,e,n){const r=function(t){switch(t.constructor){case Int8Array:return new E;case Uint8Array:return new T;case Int16Array:return new M;case Uint16Array:return new O;case Int32Array:return new P;case Uint32Array:return new I;case Float32Array:return new B;case Float64Array:return new L;default:throw new Error("array type not supported")}}(e.value),i=n||function(t){const e=new Map;return"byteOffset"in t&&e.set("byteOffset",t.byteOffset.toString(10)),"byteStride"in t&&e.set("byteStride",t.byteStride.toString(10)),"normalized"in t&&e.set("normalized",t.normalized.toString()),e}(e);return new p(t,new k(e.size,new p("value",r)),!1,i)}(t,e,n?j(n.metadata):void 0)}function j(t){const e=new Map;for(const n in t)e.set("".concat(n,".string"),JSON.stringify(t[n]));return e}const G={POSITION:"POSITION",NORMAL:"NORMAL",COLOR:"COLOR_0",TEX_COORD:"TEXCOORD_0"},U={1:Int8Array,2:Uint8Array,3:Int16Array,4:Uint16Array,5:Int32Array,6:Uint32Array,9:Float32Array};class z{constructor(t){(0,f.A)(this,"draco",void 0),(0,f.A)(this,"decoder",void 0),(0,f.A)(this,"metadataQuerier",void 0),this.draco=t,this.decoder=new this.draco.Decoder,this.metadataQuerier=new this.draco.MetadataQuerier}destroy(){this.draco.destroy(this.decoder),this.draco.destroy(this.metadataQuerier)}parseSync(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=new this.draco.DecoderBuffer;n.Init(new Int8Array(t),t.byteLength),this._disableAttributeTransforms(e);const r=this.decoder.GetEncodedGeometryType(n),i=r===this.draco.TRIANGULAR_MESH?new this.draco.Mesh:new this.draco.PointCloud;try{let t;switch(r){case this.draco.TRIANGULAR_MESH:t=this.decoder.DecodeBufferToMesh(n,i);break;case this.draco.POINT_CLOUD:t=this.decoder.DecodeBufferToPointCloud(n,i);break;default:throw new Error("DRACO: Unknown geometry type.")}if(!t.ok()||!i.ptr){const e="DRACO decompression failed: ".concat(t.error_msg());throw new Error(e)}const o=this._getDracoLoaderData(i,r,e),s=this._getMeshData(i,o,e),a=function(t){let e=1/0,n=1/0,r=1/0,i=-1/0,o=-1/0,s=-1/0;const a=t.POSITION?t.POSITION.value:[],l=a&&a.length;for(let t=0;t<l;t+=3){const l=a[t],u=a[t+1],c=a[t+2];e=l<e?l:e,n=u<n?u:n,r=c<r?c:r,i=l>i?l:i,o=u>o?u:o,s=c>s?c:s}return[[e,n,r],[i,o,s]]}(s.attributes),l=function(t,e,n){const r=j(e.metadata),i=[],o=function(t){const e={};for(const n in t){const r=t[n];e[r.name||"undefined"]=r}return e}(e.attributes);for(const e in t){const n=N(e,t[e],o[e]);i.push(n)}if(n){const t=N("indices",n);i.push(t)}return new D(i,r)}(s.attributes,o,s.indices);return{loader:"draco",loaderData:o,header:{vertexCount:i.num_points(),boundingBox:a},...s,schema:l}}finally{this.draco.destroy(n),i&&this.draco.destroy(i)}}_getDracoLoaderData(t,e,n){const r=this._getTopLevelMetadata(t),i=this._getDracoAttributes(t,n);return{geometry_type:e,num_attributes:t.num_attributes(),num_points:t.num_points(),num_faces:t instanceof this.draco.Mesh?t.num_faces():0,metadata:r,attributes:i}}_getDracoAttributes(t,e){const n={};for(let r=0;r<t.num_attributes();r++){const i=this.decoder.GetAttribute(t,r),o=this._getAttributeMetadata(t,r);n[i.unique_id()]={unique_id:i.unique_id(),attribute_type:i.attribute_type(),data_type:i.data_type(),num_components:i.num_components(),byte_offset:i.byte_offset(),byte_stride:i.byte_stride(),normalized:i.normalized(),attribute_index:r,metadata:o};const s=this._getQuantizationTransform(i,e);s&&(n[i.unique_id()].quantization_transform=s);const a=this._getOctahedronTransform(i,e);a&&(n[i.unique_id()].octahedron_transform=a)}return n}_getMeshData(t,e,n){const r=this._getMeshAttributes(e,t,n);if(!r.POSITION)throw new Error("DRACO: No position attribute found.");return t instanceof this.draco.Mesh?"triangle-strip"===n.topology?{topology:"triangle-strip",mode:4,attributes:r,indices:{value:this._getTriangleStripIndices(t),size:1}}:{topology:"triangle-list",mode:5,attributes:r,indices:{value:this._getTriangleListIndices(t),size:1}}:{topology:"point-list",mode:0,attributes:r}}_getMeshAttributes(t,e,n){const r={};for(const i of Object.values(t.attributes)){const t=this._deduceAttributeName(i,n);i.name=t;const{value:o,size:s}=this._getAttributeValues(e,i);r[t]={value:o,size:s,byteOffset:i.byte_offset,byteStride:i.byte_stride,normalized:i.normalized}}return r}_getTriangleListIndices(t){const e=3*t.num_faces(),n=4*e,r=this.draco._malloc(n);try{return this.decoder.GetTrianglesUInt32Array(t,n,r),new Uint32Array(this.draco.HEAPF32.buffer,r,e).slice()}finally{this.draco._free(r)}}_getTriangleStripIndices(t){const e=new this.draco.DracoInt32Array;try{return this.decoder.GetTriangleStripsFromMesh(t,e),function(t){const e=t.size(),n=new Int32Array(e);for(let r=0;r<e;r++)n[r]=t.GetValue(r);return n}(e)}finally{this.draco.destroy(e)}}_getAttributeValues(t,e){const n=U[e.data_type],r=e.num_components,i=t.num_points()*r,o=i*n.BYTES_PER_ELEMENT,s=function(t,e){switch(e){case Float32Array:return t.DT_FLOAT32;case Int8Array:return t.DT_INT8;case Int16Array:return t.DT_INT16;case Int32Array:return t.DT_INT32;case Uint8Array:return t.DT_UINT8;case Uint16Array:return t.DT_UINT16;case Uint32Array:return t.DT_UINT32;default:return t.DT_INVALID}}(this.draco,n);let a;const l=this.draco._malloc(o);try{const r=this.decoder.GetAttribute(t,e.attribute_index);this.decoder.GetAttributeDataArrayForAllPoints(t,r,s,o,l),a=new n(this.draco.HEAPF32.buffer,l,i).slice()}finally{this.draco._free(l)}return{value:a,size:r}}_deduceAttributeName(t,e){const n=t.unique_id;for(const[t,r]of Object.entries(e.extraAttributes||{}))if(r===n)return t;const r=t.attribute_type;for(const t in G)if(this.draco[t]===r)return G[t];const i=e.attributeNameEntry||"name";return t.metadata[i]?t.metadata[i].string:"CUSTOM_ATTRIBUTE_".concat(n)}_getTopLevelMetadata(t){const e=this.decoder.GetMetadata(t);return this._getDracoMetadata(e)}_getAttributeMetadata(t,e){const n=this.decoder.GetAttributeMetadata(t,e);return this._getDracoMetadata(n)}_getDracoMetadata(t){if(!t||!t.ptr)return{};const e={},n=this.metadataQuerier.NumEntries(t);for(let r=0;r<n;r++){const n=this.metadataQuerier.GetEntryName(t,r);e[n]=this._getDracoMetadataField(t,n)}return e}_getDracoMetadataField(t,e){const n=new this.draco.DracoInt32Array;try{this.metadataQuerier.GetIntEntryArray(t,e,n);const r=function(t){const e=t.size(),n=new Int32Array(e);for(let r=0;r<e;r++)n[r]=t.GetValue(r);return n}(n);return{int:this.metadataQuerier.GetIntEntry(t,e),string:this.metadataQuerier.GetStringEntry(t,e),double:this.metadataQuerier.GetDoubleEntry(t,e),intArray:r}}finally{this.draco.destroy(n)}}_disableAttributeTransforms(t){const{quantizedAttributes:e=[],octahedronAttributes:n=[]}=t,r=[...e,...n];for(const t of r)this.decoder.SkipAttributeTransform(this.draco[t])}_getQuantizationTransform(t,e){const{quantizedAttributes:n=[]}=e,r=t.attribute_type();if(n.map((t=>this.decoder[t])).includes(r)){const e=new this.draco.AttributeQuantizationTransform;try{if(e.InitFromAttribute(t))return{quantization_bits:e.quantization_bits(),range:e.range(),min_values:new Float32Array([1,2,3]).map((t=>e.min_value(t)))}}finally{this.draco.destroy(e)}}return null}_getOctahedronTransform(t,e){const{octahedronAttributes:n=[]}=e,r=t.attribute_type();if(n.map((t=>this.decoder[t])).includes(r)){const e=new this.draco.AttributeQuantizationTransform;try{if(e.InitFromAttribute(t))return{quantization_bits:e.quantization_bits()}}finally{this.draco.destroy(e)}}return null}}const V=null,H=null,q=null,W=null,J="3.4.15",Y={};async function X(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return e&&(t=function(t,e,n){if(t.startsWith("http"))return t;const r=n.modules||{};return r[t]?r[t]:a?n.CDN?(function(t){if(!t)throw new Error("loaders.gl assertion failed.")}(n.CDN.startsWith("http")),"".concat(n.CDN,"/").concat(e,"@").concat(J,"/dist/libs/").concat(t)):l?"../src/libs/".concat(t):"modules/".concat(e,"/src/libs/").concat(t):"modules/".concat(e,"/dist/libs/").concat(t)}(t,e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{})),Y[t]=Y[t]||async function(t){if(t.endsWith("wasm")){const e=await fetch(t);return await e.arrayBuffer()}if(!a)try{return r&&q&&await q(t)}catch{return null}if(l)return importScripts(t);const e=await fetch(t);return function(t,e){if(!a)return W&&W(t,e);if(l)return eval.call(s,t),null;const n=document.createElement("script");n.id=e;try{n.appendChild(document.createTextNode(t))}catch(e){n.text=t}return document.body.appendChild(n),null}(await e.text(),t)}(t),await Y[t]}const K="https://www.gstatic.com/draco/versioned/decoders/".concat("1.5.5"),Z="".concat(K,"/draco_decoder.js"),Q="".concat(K,"/draco_wasm_wrapper.js"),$="".concat(K,"/draco_decoder.wasm");let tt;"https://raw.githubusercontent.com/google/draco/".concat("1.4.1","/javascript/draco_encoder.js");const et={...d,parse:async function(t,e){const{draco:n}=await async function(t){const e=t.modules||{};return tt=e.draco3d?tt||e.draco3d.createDecoderModule({}).then((t=>({draco:t}))):tt||async function(t){let e,n;return"js"===(t.draco&&t.draco.decoderType)?e=await X(Z,"draco",t):[e,n]=await Promise.all([await X(Q,"draco",t),await X($,"draco",t)]),e=e||globalThis.DracoDecoderModule,await function(t,e){const n={};return e&&(n.wasmBinary=e),new Promise((e=>{t({...n,onModuleLoaded:t=>e({draco:t})})}))}(e,n)}(t),await tt}(e),r=new z(n);try{return r.parseSync(t,null==e?void 0:e.draco)}finally{r.destroy()}}}},65771:(t,e,n)=>{"use strict";n.d(e,{B:()=>Ge});var r={};n.r(r),n.d(r,{readFileAsArrayBuffer:()=>b,readFileAsText:()=>_,requireFromFile:()=>A,requireFromString:()=>x});var i={};n.r(i),n.d(i,{decode:()=>ft,name:()=>dt});var o={};n.r(o),n.d(o,{name:()=>bt,preprocess:()=>_t});var s={};n.r(s),n.d(s,{name:()=>xt,preprocess:()=>wt});var a={};n.r(a),n.d(a,{decode:()=>Tt,encode:()=>Ot,name:()=>Mt,preprocess:()=>Pt});var l={};n.r(l),n.d(l,{decode:()=>Vt,name:()=>jt});var u={};n.r(u),n.d(u,{decode:()=>Xt,encode:()=>Kt,name:()=>Yt});var c={};n.r(c),n.d(c,{decode:()=>$t,encode:()=>te,name:()=>Qt});var h={};n.r(h),n.d(h,{decode:()=>re,encode:()=>ie,name:()=>ne});var d={};n.r(d),n.d(d,{decode:()=>le,name:()=>ae});var f=n(65606);const p={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:void 0!==n.g&&n.g,document:"undefined"!=typeof document&&document},g=p.global||p.self||p.window||{},y="object"!=typeof f||"[object process]"!==String(f)||f.browser,m="function"==typeof importScripts,v=("undefined"!=typeof window&&window.orientation,void 0!==f&&f.version&&/v([0-9]*)/.exec(f.version)),b=(v&&parseFloat(v[1]),null),_=null,A=null,x=null,w="3.4.15",C={};async function S(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return e&&(t=function(t,e,n){if(t.startsWith("http"))return t;const r=n.modules||{};return r[t]?r[t]:y?n.CDN?(function(t){if(!t)throw new Error("loaders.gl assertion failed.")}(n.CDN.startsWith("http")),"".concat(n.CDN,"/").concat(e,"@").concat(w,"/dist/libs/").concat(t)):m?"../src/libs/".concat(t):"modules/".concat(e,"/src/libs/").concat(t):"modules/".concat(e,"/dist/libs/").concat(t)}(t,e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{})),C[t]=C[t]||async function(t){if(t.endsWith("wasm")){const e=await fetch(t);return await e.arrayBuffer()}if(!y)try{return r&&A&&await A(t)}catch{return null}if(m)return importScripts(t);const e=await fetch(t);return function(t,e){if(!y)return x&&x(t,e);if(m)return eval.call(g,t),null;const n=document.createElement("script");n.id=e;try{n.appendChild(document.createTextNode(t))}catch(e){n.text=t}return document.body.appendChild(n),null}(await e.text(),t)}(t),await C[t]}const E="3.4.15",M="https://unpkg.com/@loaders.gl/textures@".concat(E,"/dist/libs/basis_encoder.wasm"),P="https://unpkg.com/@loaders.gl/textures@".concat(E,"/dist/libs/basis_encoder.js");let T,O;async function I(t){const e=t.modules||{};return e.basis?e.basis:(T=T||async function(t){let e=null,n=null;return[e,n]=await Promise.all([await S("basis_transcoder.js","textures",t),await S("basis_transcoder.wasm","textures",t)]),e=e||globalThis.BASIS,await function(t,e){const n={};return e&&(n.wasmBinary=e),new Promise((e=>{t(n).then((t=>{const{BasisFile:n,initializeBasis:r}=t;r(),e({BasisFile:n})}))}))}(e,n)}(t),await T)}async function R(t){const e=t.modules||{};return e.basisEncoder?e.basisEncoder:(O=O||async function(t){let e=null,n=null;return[e,n]=await Promise.all([await S(P,"textures",t),await S(M,"textures",t)]),e=e||globalThis.BASIS,await function(t,e){const n={};return e&&(n.wasmBinary=e),new Promise((e=>{t(n).then((t=>{const{BasisFile:n,KTX2File:r,initializeBasis:i,BasisEncoder:o}=t;i(),e({BasisFile:n,KTX2File:r,BasisEncoder:o})}))}))}(e,n)}(t),await O)}const B=["","WEBKIT_","MOZ_"],L={WEBGL_compressed_texture_s3tc:"dxt",WEBGL_compressed_texture_s3tc_srgb:"dxt-srgb",WEBGL_compressed_texture_etc1:"etc1",WEBGL_compressed_texture_etc:"etc2",WEBGL_compressed_texture_pvrtc:"pvrtc",WEBGL_compressed_texture_atc:"atc",WEBGL_compressed_texture_astc:"astc",EXT_texture_compression_rgtc:"rgtc"};let k=null;n(43853);const D=[171,75,84,88,32,50,48,187,13,10,26,10],F={etc1:{basisFormat:0,compressed:!0,format:36196},etc2:{basisFormat:1,compressed:!0},bc1:{basisFormat:2,compressed:!0,format:33776},bc3:{basisFormat:3,compressed:!0,format:33779},bc4:{basisFormat:4,compressed:!0},bc5:{basisFormat:5,compressed:!0},"bc7-m6-opaque-only":{basisFormat:6,compressed:!0},"bc7-m5":{basisFormat:7,compressed:!0},"pvrtc1-4-rgb":{basisFormat:8,compressed:!0,format:35840},"pvrtc1-4-rgba":{basisFormat:9,compressed:!0,format:35842},"astc-4x4":{basisFormat:10,compressed:!0,format:37808},"atc-rgb":{basisFormat:11,compressed:!0},"atc-rgba-interpolated-alpha":{basisFormat:12,compressed:!0},rgba32:{basisFormat:13,compressed:!1},rgb565:{basisFormat:14,compressed:!1},bgr565:{basisFormat:15,compressed:!1},rgba4444:{basisFormat:16,compressed:!1}};function N(t,e,n){const r=new t(new Uint8Array(e));try{if(!r.startTranscoding())throw new Error("Failed to start basis transcoding");const t=r.getNumImages(),e=[];for(let i=0;i<t;i++){const t=r.getNumLevels(i),o=[];for(let e=0;e<t;e++)o.push(j(r,i,e,n));e.push(o)}return e}finally{r.close(),r.delete()}}function j(t,e,n,r){const i=t.getImageWidth(e,n),o=t.getImageHeight(e,n),s=t.getHasAlpha(),{compressed:a,format:l,basisFormat:u}=z(r,s),c=t.getImageTranscodedSizeInBytes(e,n,u),h=new Uint8Array(c);if(!t.transcodeImage(h,e,n,u,0,0))throw new Error("failed to start Basis transcoding");return{width:i,height:o,data:h,compressed:a,format:l,hasAlpha:s}}function G(t,e,n){const r=new t(new Uint8Array(e));try{if(!r.startTranscoding())throw new Error("failed to start KTX2 transcoding");const t=r.getLevels(),e=[];for(let i=0;i<t;i++){e.push(U(r,i,n));break}return[e]}finally{r.close(),r.delete()}}function U(t,e,n){const{alphaFlag:r,height:i,width:o}=t.getImageLevelInfo(e,0,0),{compressed:s,format:a,basisFormat:l}=z(n,r),u=t.getImageTranscodedSizeInBytes(e,0,0,l),c=new Uint8Array(u);if(!t.transcodeImage(c,e,0,0,l,0,-1,-1))throw new Error("Failed to transcode KTX2 image");return{width:o,height:i,data:c,compressed:s,levelSize:u,hasAlpha:r,format:a}}function z(t,e){let n=t&&t.basis&&t.basis.format;return"auto"===n&&(n=V()),"object"==typeof n&&(n=e?n.alpha:n.noAlpha),n=n.toLowerCase(),F[n]}function V(){const t=function(t){if(!k){t=t||function(){try{return document.createElement("canvas").getContext("webgl")}catch(t){return null}}()||void 0,k=new Set;for(const e of B)for(const n in L)if(t&&t.getExtension("".concat(e).concat(n))){const t=L[n];k.add(t)}}return k}();return t.has("astc")?"astc-4x4":t.has("dxt")?{alpha:"bc3",noAlpha:"bc1"}:t.has("pvrtc")?{alpha:"pvrtc1-4-rgba",noAlpha:"pvrtc1-4-rgb"}:t.has("etc1")?"etc1":t.has("etc2")?"etc2":"rgb565"}const H={...{name:"Basis",id:y?"basis":"basis-nodejs",module:"textures",version:"3.4.15",worker:!0,extensions:["basis","ktx2"],mimeTypes:["application/octet-stream","image/ktx2"],tests:["sB"],binary:!0,options:{basis:{format:"auto",libraryPath:"libs/",containerFormat:"auto",module:"transcoder"}}},parse:async function(t,e){if("auto"===e.basis.containerFormat){if(function(t){const e=new Uint8Array(t);return!(e.byteLength<D.length||e[0]!==D[0]||e[1]!==D[1]||e[2]!==D[2]||e[3]!==D[3]||e[4]!==D[4]||e[5]!==D[5]||e[6]!==D[6]||e[7]!==D[7]||e[8]!==D[8]||e[9]!==D[9]||e[10]!==D[10]||e[11]!==D[11])}(t))return G((await R(e)).KTX2File,t,e);const{BasisFile:n}=await I(e);return N(n,t,e)}if("encoder"===e.basis.module){const n=await R(e);return"ktx2"===e.basis.containerFormat?G(n.KTX2File,t,e):N(n.BasisFile,t,e)}{const{BasisFile:n}=await I(e);return N(n,t,e)}}};var q=n(94557);function W(t,e,n){if(t.byteLength<=e+n)return"";const r=new DataView(t);let i="";for(let t=0;t<n;t++)i+=String.fromCharCode(r.getUint8(e+t));return i}var J=n(57345),Y=n(89359);function X(t,e){if(t.startsWith("data:")||t.startsWith("http:")||t.startsWith("https:"))return t;const n=e.baseUri||e.uri;if(!n)throw new Error("'baseUri' must be provided to resolve relative url ".concat(t));return n.substr(0,n.lastIndexOf("/")+1)+t}var K=n(67136),Z=n(51434),Q=n(17243);function $(t,e){return(0,Q.v)(t>=0),(0,Q.v)(e>0),t+(e-1)&~(e-1)}function tt(t,e,n){let r;if(t instanceof ArrayBuffer)r=new Uint8Array(t);else{const e=t.byteOffset,n=t.byteLength;r=new Uint8Array(t.buffer||t.arrayBuffer,e,n)}return e.set(r,n),n+$(r.byteLength,4)}var et=n(6440);const nt={asset:{version:"2.0",generator:"loaders.gl"},buffers:[]};class rt{constructor(t){(0,K.A)(this,"gltf",void 0),(0,K.A)(this,"sourceBuffers",void 0),(0,K.A)(this,"byteLength",void 0),this.gltf=t||{json:{...nt},buffers:[]},this.sourceBuffers=[],this.byteLength=0,this.gltf.buffers&&this.gltf.buffers[0]&&(this.byteLength=this.gltf.buffers[0].byteLength,this.sourceBuffers=[this.gltf.buffers[0]])}get json(){return this.gltf.json}getApplicationData(t){return this.json[t]}getExtraData(t){return(this.json.extras||{})[t]}getExtension(t){const e=this.getUsedExtensions().find((e=>e===t)),n=this.json.extensions||{};return e?n[t]||!0:null}getRequiredExtension(t){return this.getRequiredExtensions().find((e=>e===t))?this.getExtension(t):null}getRequiredExtensions(){return this.json.extensionsRequired||[]}getUsedExtensions(){return this.json.extensionsUsed||[]}getRemovedExtensions(){return this.json.extensionsRemoved||[]}getObjectExtension(t,e){return(t.extensions||{})[e]}getScene(t){return this.getObject("scenes",t)}getNode(t){return this.getObject("nodes",t)}getSkin(t){return this.getObject("skins",t)}getMesh(t){return this.getObject("meshes",t)}getMaterial(t){return this.getObject("materials",t)}getAccessor(t){return this.getObject("accessors",t)}getTexture(t){return this.getObject("textures",t)}getSampler(t){return this.getObject("samplers",t)}getImage(t){return this.getObject("images",t)}getBufferView(t){return this.getObject("bufferViews",t)}getBuffer(t){return this.getObject("buffers",t)}getObject(t,e){if("object"==typeof e)return e;const n=this.json[t]&&this.json[t][e];if(!n)throw new Error("glTF file error: Could not find ".concat(t,"[").concat(e,"]"));return n}getTypedArrayForBufferView(t){const e=(t=this.getBufferView(t)).buffer,n=this.gltf.buffers[e];(0,Y.v)(n);const r=(t.byteOffset||0)+n.byteOffset;return new Uint8Array(n.arrayBuffer,r,t.byteLength)}getTypedArrayForAccessor(t){t=this.getAccessor(t);const e=this.getBufferView(t.bufferView),n=this.getBuffer(e.buffer).data,{ArrayType:r,length:i}=(0,et.aF)(t,e);return new r(n,e.byteOffset+t.byteOffset,i)}getTypedArrayForImageData(t){t=this.getAccessor(t);const e=this.getBufferView(t.bufferView),n=this.getBuffer(e.buffer).data,r=e.byteOffset||0;return new Uint8Array(n,r,e.byteLength)}addApplicationData(t,e){return this.json[t]=e,this}addExtraData(t,e){return this.json.extras=this.json.extras||{},this.json.extras[t]=e,this}addObjectExtension(t,e,n){return t.extensions=t.extensions||{},t.extensions[e]=n,this.registerUsedExtension(e),this}setObjectExtension(t,e,n){(t.extensions||{})[e]=n}removeObjectExtension(t,e){const n=t.extensions||{},r=n[e];return delete n[e],r}addExtension(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,Y.v)(e),this.json.extensions=this.json.extensions||{},this.json.extensions[t]=e,this.registerUsedExtension(t),e}addRequiredExtension(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,Y.v)(e),this.addExtension(t,e),this.registerRequiredExtension(t),e}registerUsedExtension(t){this.json.extensionsUsed=this.json.extensionsUsed||[],this.json.extensionsUsed.find((e=>e===t))||this.json.extensionsUsed.push(t)}registerRequiredExtension(t){this.registerUsedExtension(t),this.json.extensionsRequired=this.json.extensionsRequired||[],this.json.extensionsRequired.find((e=>e===t))||this.json.extensionsRequired.push(t)}removeExtension(t){if(!this.getExtension(t))return;this.json.extensionsRequired&&this._removeStringFromArray(this.json.extensionsRequired,t),this.json.extensionsUsed&&this._removeStringFromArray(this.json.extensionsUsed,t),this.json.extensions&&delete this.json.extensions[t],Array.isArray(this.json.extensionsRemoved)||(this.json.extensionsRemoved=[]);const e=this.json.extensionsRemoved;e.includes(t)||e.push(t)}setDefaultScene(t){this.json.scene=t}addScene(t){const{nodeIndices:e}=t;return this.json.scenes=this.json.scenes||[],this.json.scenes.push({nodes:e}),this.json.scenes.length-1}addNode(t){const{meshIndex:e,matrix:n}=t;this.json.nodes=this.json.nodes||[];const r={mesh:e};return n&&(r.matrix=n),this.json.nodes.push(r),this.json.nodes.length-1}addMesh(t){const{attributes:e,indices:n,material:r,mode:i=4}=t,o={primitives:[{attributes:this._addAttributes(e),mode:i}]};if(n){const t=this._addIndices(n);o.primitives[0].indices=t}return Number.isFinite(r)&&(o.primitives[0].material=r),this.json.meshes=this.json.meshes||[],this.json.meshes.push(o),this.json.meshes.length-1}addPointCloud(t){const e={primitives:[{attributes:this._addAttributes(t),mode:0}]};return this.json.meshes=this.json.meshes||[],this.json.meshes.push(e),this.json.meshes.length-1}addImage(t,e){const n=(0,Z.m)(t),r=e||(null==n?void 0:n.mimeType),i={bufferView:this.addBufferView(t),mimeType:r};return this.json.images=this.json.images||[],this.json.images.push(i),this.json.images.length-1}addBufferView(t){const e=t.byteLength;(0,Y.v)(Number.isFinite(e)),this.sourceBuffers=this.sourceBuffers||[],this.sourceBuffers.push(t);const n={buffer:0,byteOffset:this.byteLength,byteLength:e};return this.byteLength+=$(e,4),this.json.bufferViews=this.json.bufferViews||[],this.json.bufferViews.push(n),this.json.bufferViews.length-1}addAccessor(t,e){const n={bufferView:t,type:(0,et.v7)(e.size),componentType:e.componentType,count:e.count,max:e.max,min:e.min};return this.json.accessors=this.json.accessors||[],this.json.accessors.push(n),this.json.accessors.length-1}addBinaryBuffer(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{size:3};const n=this.addBufferView(t);let r={min:e.min,max:e.max};r.min&&r.max||(r=this._getAccessorMinMax(t,e.size));const i={size:e.size,componentType:(0,et.rA)(t),count:Math.round(t.length/e.size),min:r.min,max:r.max};return this.addAccessor(n,Object.assign(i,e))}addTexture(t){const{imageIndex:e}=t,n={source:e};return this.json.textures=this.json.textures||[],this.json.textures.push(n),this.json.textures.length-1}addMaterial(t){return this.json.materials=this.json.materials||[],this.json.materials.push(t),this.json.materials.length-1}createBinaryChunk(){var t,e;this.gltf.buffers=[];const n=this.byteLength,r=new ArrayBuffer(n),i=new Uint8Array(r);let o=0;for(const t of this.sourceBuffers||[])o=tt(t,i,o);null!==(t=this.json)&&void 0!==t&&null!==(e=t.buffers)&&void 0!==e&&e[0]?this.json.buffers[0].byteLength=n:this.json.buffers=[{byteLength:n}],this.gltf.binary=r,this.sourceBuffers=[r]}_removeStringFromArray(t,e){let n=!0;for(;n;){const r=t.indexOf(e);r>-1?t.splice(r,1):n=!1}}_addAttributes(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e={};for(const n in t){const r=t[n],i=this._getGltfAttributeName(n),o=this.addBinaryBuffer(r.value,r);e[i]=o}return e}_addIndices(t){return this.addBinaryBuffer(t,{size:1})}_getGltfAttributeName(t){switch(t.toLowerCase()){case"position":case"positions":case"vertices":return"POSITION";case"normal":case"normals":return"NORMAL";case"color":case"colors":return"COLOR_0";case"texcoord":case"texcoords":return"TEXCOORD_0";default:return t}}_getAccessorMinMax(t,e){const n={min:null,max:null};if(t.length<e)return n;n.min=[],n.max=[];const r=t.subarray(0,e);for(const t of r)n.min.push(t),n.max.push(t);for(let r=e;r<t.length;r+=e)for(let i=0;i<e;i++)n.min[0+i]=Math.min(n.min[0+i],t[r+i]),n.max[0+i]=Math.max(n.max[0+i],t[r+i]);return n}}const it="B9h9z9tFBBBF8fL9gBB9gLaaaaaFa9gEaaaB9gFaFa9gEaaaFaEMcBFFFGGGEIIILF9wFFFLEFBFKNFaFCx/IFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBF8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBGy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBEn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBIi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBKI9z9iqlBOc+x8ycGBM/qQFTa8jUUUUBCU/EBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAGTkUUUBRNCUoBAG9uC/wgBZHKCUGAKCUG9JyRVAECFJRICBRcGXEXAcAF9PQFAVAFAclAcAVJAF9JyRMGXGXAG9FQBAMCbJHKC9wZRSAKCIrCEJCGrRQANCUGJRfCBRbAIRTEXGXAOATlAQ9PQBCBRISEMATAQJRIGXAS9FQBCBRtCBREEXGXAOAIlCi9PQBCBRISLMANCU/CBJAEJRKGXGXGXGXGXATAECKrJ2BBAtCKZrCEZfIBFGEBMAKhB83EBAKCNJhB83EBSEMAKAI2BIAI2BBHmCKrHYAYCE6HYy86BBAKCFJAICIJAYJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCGJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCEJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCIJAYAmJHY2BBAI2BFHmCKrHPAPCE6HPy86BBAKCLJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCKJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCOJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCNJAYAmJHY2BBAI2BGHmCKrHPAPCE6HPy86BBAKCVJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCcJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCMJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCSJAYAmJHm2BBAI2BEHICKrHYAYCE6HYy86BBAKCQJAmAYJHm2BBAICIrCEZHYAYCE6HYy86BBAKCfJAmAYJHm2BBAICGrCEZHYAYCE6HYy86BBAKCbJAmAYJHK2BBAICEZHIAICE6HIy86BBAKAIJRISGMAKAI2BNAI2BBHmCIrHYAYCb6HYy86BBAKCFJAICNJAYJHY2BBAmCbZHmAmCb6Hmy86BBAKCGJAYAmJHm2BBAI2BFHYCIrHPAPCb6HPy86BBAKCEJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCIJAmAYJHm2BBAI2BGHYCIrHPAPCb6HPy86BBAKCLJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCKJAmAYJHm2BBAI2BEHYCIrHPAPCb6HPy86BBAKCOJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCNJAmAYJHm2BBAI2BIHYCIrHPAPCb6HPy86BBAKCVJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCcJAmAYJHm2BBAI2BLHYCIrHPAPCb6HPy86BBAKCMJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCSJAmAYJHm2BBAI2BKHYCIrHPAPCb6HPy86BBAKCQJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCfJAmAYJHm2BBAI2BOHICIrHYAYCb6HYy86BBAKCbJAmAYJHK2BBAICbZHIAICb6HIy86BBAKAIJRISFMAKAI8pBB83BBAKCNJAICNJ8pBB83BBAICTJRIMAtCGJRtAECTJHEAS9JQBMMGXAIQBCBRISEMGXAM9FQBANAbJ2BBRtCBRKAfREEXAEANCU/CBJAKJ2BBHTCFrCBATCFZl9zAtJHt86BBAEAGJREAKCFJHKAM9HQBMMAfCFJRfAIRTAbCFJHbAG9HQBMMABAcAG9sJANCUGJAMAG9sTkUUUBpANANCUGJAMCaJAG9sJAGTkUUUBpMAMCBAIyAcJRcAIQBMC9+RKSFMCBC99AOAIlAGCAAGCA9Ly6yRKMALCU/EBJ8kUUUUBAKM+OmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUFT+JUUUBpALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM+lLKFaF99GaG99FaG99GXGXAGCI9HQBAF9FQFEXGXGX9DBBB8/9DBBB+/ABCGJHG1BB+yAB1BBHE+yHI+L+TABCFJHL1BBHK+yHO+L+THN9DBBBB9gHVyAN9DBB/+hANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE86BBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG86BBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG86BBABCIJRBAFCaJHFQBSGMMAF9FQBEXGXGX9DBBB8/9DBBB+/ABCIJHG8uFB+yAB8uFBHE+yHI+L+TABCGJHL8uFBHK+yHO+L+THN9DBBBB9gHVyAN9DB/+g6ANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE87FBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG87FBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG87FBABCNJRBAFCaJHFQBMMM/SEIEaE99EaF99GXAF9FQBCBREABRIEXGXGX9D/zI818/AICKJ8uFBHLCEq+y+VHKAI8uFB+y+UHO9DB/+g6+U9DBBB8/9DBBB+/AO9DBBBB9gy+SHN+L9DBBB9P9d9FQBAN+oRVSFMCUUUU94RVMAICIJ8uFBRcAICGJ8uFBRMABALCFJCEZAEqCFWJAV87FBGXGXAKAM+y+UHN9DB/+g6+U9DBBB8/9DBBB+/AN9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRMSFMCUUUU94RMMABALCGJCEZAEqCFWJAM87FBGXGXAKAc+y+UHK9DB/+g6+U9DBBB8/9DBBB+/AK9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRcSFMCUUUU94RcMABALCaJCEZAEqCFWJAc87FBGXGX9DBBU8/AOAO+U+TANAN+U+TAKAK+U+THO9DBBBBAO9DBBBB9gy+R9DB/+g6+U9DBBB8/+SHO+L9DBBB9P9d9FQBAO+oRcSFMCUUUU94RcMABALCEZAEqCFWJAc87FBAICNJRIAECIJREAFCaJHFQBMMM9JBGXAGCGrAF9sHF9FQBEXABAB8oGBHGCNWCN91+yAGCi91CnWCUUU/8EJ+++U84GBABCIJRBAFCaJHFQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEM/lFFFaGXGXAFABqCEZ9FQBABRESFMGXGXAGCT9PQBABRESFMABREEXAEAF8oGBjGBAECIJAFCIJ8oGBjGBAECNJAFCNJ8oGBjGBAECSJAFCSJ8oGBjGBAECTJREAFCTJRFAGC9wJHGCb9LQBMMAGCI9JQBEXAEAF8oGBjGBAFCIJRFAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF2BB86BBAECFJREAFCFJRFAGCaJHGQBMMABMoFFGaGXGXABCEZ9FQBABRESFMAFCgFZC+BwsN9sRIGXGXAGCT9PQBABRESFMABREEXAEAIjGBAECSJAIjGBAECNJAIjGBAECIJAIjGBAECTJREAGC9wJHGCb9LQBMMAGCI9JQBEXAEAIjGBAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF86BBAECFJREAGCaJHGQBMMABMMMFBCUNMIT9kBB",ot="B9h9z9tFBBBF8dL9gBB9gLaaaaaFa9gEaaaB9gGaaB9gFaFaEQSBBFBFFGEGEGIILF9wFFFLEFBFKNFaFCx/aFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBG8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBIy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBKi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBNn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBcI9z9iqlBMc/j9JSIBTEM9+FLa8jUUUUBCTlRBCBRFEXCBRGCBREEXABCNJAGJAECUaAFAGrCFZHIy86BBAEAIJREAGCFJHGCN9HQBMAFCx+YUUBJAE86BBAFCEWCxkUUBJAB8pEN83EBAFCFJHFCUG9HQBMMkRIbaG97FaK978jUUUUBCU/KBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAG/8cBBCUoBAG9uC/wgBZHKCUGAKCUG9JyRNAECFJRKCBRVGXEXAVAF9PQFANAFAVlAVANJAF9JyRcGXGXAG9FQBAcCbJHIC9wZHMCE9sRSAMCFWRQAICIrCEJCGrRfCBRbEXAKRTCBRtGXEXGXAOATlAf9PQBCBRKSLMALCU/CBJAtAM9sJRmATAfJRKCBREGXAMCoB9JQBAOAKlC/gB9JQBCBRIEXAmAIJREGXGXGXGXGXATAICKrJ2BBHYCEZfIBFGEBMAECBDtDMIBSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMIBAKCTJRKMGXGXGXGXGXAYCGrCEZfIBFGEBMAECBDtDMITSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMITAKCTJRKMGXGXGXGXGXAYCIrCEZfIBFGEBMAECBDtDMIASEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMIAAKCTJRKMGXGXGXGXGXAYCKrfIBFGEBMAECBDtDMI8wSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCIJAnDeBJAYCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCNJAnDeBJAYCx+YUUBJ2BBJRKSFMAEAKDBBBDMI8wAKCTJRKMAICoBJREAICUFJAM9LQFAERIAOAKlC/fB9LQBMMGXAEAM9PQBAECErRIEXGXAOAKlCi9PQBCBRKSOMAmAEJRYGXGXGXGXGXATAECKrJ2BBAICKZrCEZfIBFGEBMAYCBDtDMIBSEMAYAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAYAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAYAKDBBBDMIBAKCTJRKMAICGJRIAECTJHEAM9JQBMMGXAK9FQBAKRTAtCFJHtCI6QGSFMMCBRKSEMGXAM9FQBALCUGJAbJREALAbJDBGBRnCBRYEXAEALCU/CBJAYJHIDBIBHdCFD9tAdCFDbHPD9OD9hD9RHdAIAMJDBIBHiCFD9tAiAPD9OD9hD9RHiDQBTFtGmEYIPLdKeOnH8ZAIAQJDBIBHpCFD9tApAPD9OD9hD9RHpAIASJDBIBHyCFD9tAyAPD9OD9hD9RHyDQBTFtGmEYIPLdKeOnH8cDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGEAnD9uHnDyBjGBAEAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnA8ZA8cDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnAdAiDQNiV8ZcpMyS8cQ8df8eb8fHdApAyDQNiV8ZcpMyS8cQ8df8eb8fHiDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnAdAiDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJREAYCTJHYAM9JQBMMAbCIJHbAG9JQBMMABAVAG9sJALCUGJAcAG9s/8cBBALALCUGJAcCaJAG9sJAG/8cBBMAcCBAKyAVJRVAKQBMC9+RKSFMCBC99AOAKlAGCAAGCA9Ly6yRKMALCU/KBJ8kUUUUBAKMNBT+BUUUBM+KmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUF/8MBALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM/xLGEaK978jUUUUBCAlHE8kUUUUBGXGXAGCI9HQBGXAFC98ZHI9FQBABRGCBRLEXAGAGDBBBHKCiD+rFCiD+sFD/6FHOAKCND+rFCiD+sFD/6FAOD/gFAKCTD+rFCiD+sFD/6FHND/gFD/kFD/lFHVCBDtD+2FHcAOCUUUU94DtHMD9OD9RD/kFHO9DBB/+hDYAOAOD/mFAVAVD/mFANAcANAMD9OD9RD/kFHOAOD/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHcD/kFCgFDtD9OAKCUUU94DtD9OD9QAOAND/mFAcD/kFCND+rFCU/+EDtD9OD9QAVAND/mFAcD/kFCTD+rFCUU/8ODtD9OD9QDMBBAGCTJRGALCIJHLAI9JQBMMAIAF9PQFAEAFCEZHLCGWHGqCBCTAGl/8MBAEABAICGWJHIAG/8cBBGXAL9FQBAEAEDBIBHKCiD+rFCiD+sFD/6FHOAKCND+rFCiD+sFD/6FAOD/gFAKCTD+rFCiD+sFD/6FHND/gFD/kFD/lFHVCBDtD+2FHcAOCUUUU94DtHMD9OD9RD/kFHO9DBB/+hDYAOAOD/mFAVAVD/mFANAcANAMD9OD9RD/kFHOAOD/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHcD/kFCgFDtD9OAKCUUU94DtD9OD9QAOAND/mFAcD/kFCND+rFCU/+EDtD9OD9QAVAND/mFAcD/kFCTD+rFCUU/8ODtD9OD9QDMIBMAIAEAG/8cBBSFMABAFC98ZHGT+HUUUBAGAF9PQBAEAFCEZHICEWHLJCBCAALl/8MBAEABAGCEWJHGAL/8cBBAEAIT+HUUUBAGAEAL/8cBBMAECAJ8kUUUUBM+yEGGaO97GXAF9FQBCBRGEXABCTJHEAEDBBBHICBDtHLCUU98D8cFCUU98D8cEHKD9OABDBBBHOAIDQILKOSQfbPden8c8d8e8fCggFDtD9OD/6FAOAIDQBFGENVcMTtmYi8ZpyHICTD+sFD/6FHND/gFAICTD+rFCTD+sFD/6FHVD/gFD/kFD/lFHI9DB/+g6DYAVAIALD+2FHLAVCUUUU94DtHcD9OD9RD/kFHVAVD/mFAIAID/mFANALANAcD9OD9RD/kFHIAID/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHLD/kFCTD+rFAVAND/mFALD/kFCggEDtD9OD9QHVAIAND/mFALD/kFCaDbCBDnGCBDnECBDnKCBDnOCBDncCBDnMCBDnfCBDnbD9OHIDQNVi8ZcMpySQ8c8dfb8e8fD9QDMBBABAOAKD9OAVAIDQBFTtGEmYILPdKOenD9QDMBBABCAJRBAGCIJHGAF9JQBMMM94FEa8jUUUUBCAlHE8kUUUUBABAFC98ZHIT+JUUUBGXAIAF9PQBAEAFCEZHLCEWHFJCBCAAFl/8MBAEABAICEWJHBAF/8cBBAEALT+JUUUBABAEAF/8cBBMAECAJ8kUUUUBM/hEIGaF97FaL978jUUUUBCTlRGGXAF9FQBCBREEXAGABDBBBHIABCTJHLDBBBHKDQILKOSQfbPden8c8d8e8fHOCTD+sFHNCID+rFDMIBAB9DBBU8/DY9D/zI818/DYANCEDtD9QD/6FD/nFHNAIAKDQBFGENVcMTtmYi8ZpyHICTD+rFCTD+sFD/6FD/mFHKAKD/mFANAICTD+sFD/6FD/mFHVAVD/mFANAOCTD+rFCTD+sFD/6FD/mFHOAOD/mFD/kFD/kFD/lFCBDtD+4FD/jF9DB/+g6DYHND/mF9DBBX9LDYHID/kFCggEDtHcD9OAVAND/mFAID/kFCTD+rFD9QHVAOAND/mFAID/kFCTD+rFAKAND/mFAID/kFAcD9OD9QHNDQBFTtGEmYILPdKOenHID8dBAGDBIBDyB+t+J83EBABCNJAID8dFAGDBIBDyF+t+J83EBALAVANDQNVi8ZcMpySQ8c8dfb8e8fHND8dBAGDBIBDyG+t+J83EBABCiJAND8dFAGDBIBDyE+t+J83EBABCAJRBAECIJHEAF9JQBMMM/3FGEaF978jUUUUBCoBlREGXAGCGrAF9sHIC98ZHL9FQBCBRGABRFEXAFAFDBBBHKCND+rFCND+sFD/6FAKCiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMBBAFCTJRFAGCIJHGAL9JQBMMGXALAI9PQBAEAICEZHGCGWHFqCBCoBAFl/8MBAEABALCGWJHLAF/8cBBGXAG9FQBAEAEDBIBHKCND+rFCND+sFD/6FAKCiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMIBMALAEAF/8cBBMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEMMMFBCUNMIT9tBB",st=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),at=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]),lt={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},ut={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};let ct;const ht="EXT_meshopt_compression",dt=ht;async function ft(t,e){var n;const r=new rt(t);if(null==e||null===(n=e.gltf)||void 0===n||!n.decompressMeshes)return;const i=[];for(const e of t.json.bufferViews||[])i.push(pt(r,e));await Promise.all(i),r.removeExtension(ht)}async function pt(t,e){const n=t.getObjectExtension(e,ht);if(n){const{byteOffset:r=0,byteLength:i=0,byteStride:o,count:s,mode:a,filter:l="NONE",buffer:u}=n,c=t.gltf.buffers[u],h=new Uint8Array(c.arrayBuffer,c.byteOffset+r,i),d=new Uint8Array(t.gltf.buffers[e.buffer].arrayBuffer,e.byteOffset,e.byteLength);return await async function(t,e,n,r,i){let o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NONE";const s=await async function(){return ct||(ct=async function(){let t=it;WebAssembly.validate(st)&&(t=ot,console.log("Warning: meshopt_decoder is using experimental SIMD support"));const e=await WebAssembly.instantiate(function(t){const e=new Uint8Array(t.length);for(let n=0;n<t.length;++n){const r=t.charCodeAt(n);e[n]=r>96?r-71:r>64?r-65:r>47?r+4:r>46?63:62}let n=0;for(let r=0;r<t.length;++r)e[n++]=e[r]<60?at[e[r]]:64*(e[r]-60)+e[++r];return e.buffer.slice(0,n)}(t),{});return await e.instance.exports.__wasm_call_ctors(),e.instance}()),ct}();!function(t,e,n,r,i,o,s){const a=t.exports.sbrk,l=r+3&-4,u=a(l*i),c=a(o.length),h=new Uint8Array(t.exports.memory.buffer);h.set(o,c);const d=e(u,r,i,c,o.length);if(0===d&&s&&s(u,l,i),n.set(h.subarray(u,u+r*i)),a(u-a(0)),0!==d)throw new Error("Malformed buffer data: ".concat(d))}(s,s.exports[ut[i]],t,e,n,r,s.exports[lt[o||"NONE"]])}(d,s,o,h,a,l),d}return null}var gt=n(83921);const yt={};function mt(t){if(void 0===yt[t]){const e=gt.Bd?function(t){switch(t){case"image/avif":case"image/webp":return function(t){try{return 0===document.createElement("canvas").toDataURL(t).indexOf("data:".concat(t))}catch{return!1}}(t);default:return!0}}(t):function(t){const e=["image/png","image/jpeg","image/gif"],{_parseImageNode:n,_imageFormatsNode:r=e}=globalThis;return Boolean(n)&&r.includes(t)}(t);yt[t]=e}return yt[t]}const vt="EXT_texture_webp",bt=vt;function _t(t,e){const n=new rt(t);if(!mt("image/webp")){if(n.getRequiredExtensions().includes(vt))throw new Error("gltf: Required extension ".concat(vt," not supported by browser"));return}const{json:r}=n;for(const t of r.textures||[]){const e=n.getObjectExtension(t,vt);e&&(t.source=e.source),n.removeObjectExtension(t,vt)}n.removeExtension(vt)}const At="KHR_texture_basisu",xt=At;function wt(t,e){const n=new rt(t),{json:r}=n;for(const t of r.textures||[]){const e=n.getObjectExtension(t,At);e&&(t.source=e.source),n.removeObjectExtension(t,At)}n.removeExtension(At)}var Ct=n(22308);function St(t){const{buffer:e,size:n,count:r}=function(t){let e=t,n=1,r=0;return t&&t.value&&(e=t.value,n=t.size||1),e&&(ArrayBuffer.isView(e)||(e=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return t?Array.isArray(t)?new e(t):!n||t instanceof e?t:new e(t):null}(e,Float32Array)),r=e.length/n),{buffer:e,size:n,count:r}}(t);return{value:e,size:n,byteOffset:0,count:r,type:(0,et.v7)(n),componentType:(0,et.rA)(e)}}const Et="KHR_draco_mesh_compression",Mt=Et;function Pt(t,e,n){const r=new rt(t);for(const t of Bt(r))r.getObjectExtension(t,Et)}async function Tt(t,e,n){var r;if(null==e||null===(r=e.gltf)||void 0===r||!r.decompressMeshes)return;const i=new rt(t),o=[];for(const t of Bt(i))i.getObjectExtension(t,Et)&&o.push(It(i,t,e,n));await Promise.all(o),i.removeExtension(Et)}function Ot(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=new rt(t);for(const t of n.json.meshes||[])Rt(t,e),n.addRequiredExtension(Et)}async function It(t,e,n,r){const i=t.getObjectExtension(e,Et);if(!i)return;const o=t.getTypedArrayForBufferView(i.bufferView),s=(0,J._m)(o.buffer,o.byteOffset),{parse:a}=r,l={...n};delete l["3d-tiles"];const u=await a(s,Ct.Vl,l,r),c=function(t){const e={};for(const n in t){const r=t[n];if("indices"!==n){const t=St(r);e[n]=t}}return e}(u.attributes);for(const[n,r]of Object.entries(c))if(n in e.attributes){const i=e.attributes[n],o=t.getAccessor(i);null!=o&&o.min&&null!=o&&o.max&&(r.min=o.min,r.max=o.max)}e.attributes=c,u.indices&&(e.indices=St(u.indices)),function(t){if(!t.attributes&&Object.keys(t.attributes).length>0)throw new Error("glTF: Empty primitive detected: Draco decompression failure?")}(e)}function Rt(t,e){var n;let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,i=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;if(!i.DracoWriter)throw new Error("options.gltf.DracoWriter not provided");const s=i.DracoWriter.encodeSync({attributes:t}),a=null==o||null===(n=o.parseSync)||void 0===n?void 0:n.call(o,{attributes:t}),l=i._addFauxAttributes(a.attributes),u=i.addBufferView(s);return{primitives:[{attributes:l,mode:r,extensions:{[Et]:{bufferView:u,attributes:l}}}]}}function*Bt(t){for(const e of t.json.meshes||[])for(const t of e.primitives)yield t}var Lt=n(22466),kt=n(50108);const Dt={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Ft={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},Nt="KHR_texture_transform",jt=Nt,Gt=new Lt.A,Ut=new kt.A,zt=new kt.A;async function Vt(t,e){if(!new rt(t).getExtension(Nt))return;const n=t.json.materials||[];for(let e=0;e<n.length;e++)Ht(e,t)}function Ht(t,e){var n,r,i;const o=[],s=null===(n=e.json.materials)||void 0===n?void 0:n[t],a=null==s||null===(r=s.pbrMetallicRoughness)||void 0===r?void 0:r.baseColorTexture;a&&qt(e,t,a,o);const l=null==s?void 0:s.emissiveTexture;l&&qt(e,t,l,o);const u=null==s?void 0:s.normalTexture;u&&qt(e,t,u,o);const c=null==s?void 0:s.occlusionTexture;c&&qt(e,t,c,o);const h=null==s||null===(i=s.pbrMetallicRoughness)||void 0===i?void 0:i.metallicRoughnessTexture;h&&qt(e,t,h,o)}function qt(t,e,n,r){const i=function(t,e){var n;const r=null===(n=t.extensions)||void 0===n?void 0:n[Nt],{texCoord:i=0}=t,{texCoord:o=i}=r;if(!(-1!==e.findIndex((t=>{let[e,n]=t;return e===i&&n===o})))){const n=function(t){const{offset:e=[0,0],rotation:n=0,scale:r=[1,1]}=t,i=(new kt.A).set(1,0,0,0,1,0,e[0],e[1],1),o=Ut.set(Math.cos(n),Math.sin(n),0,-Math.sin(n),Math.cos(n),0,0,0,1),s=zt.set(r[0],0,0,0,r[1],0,0,0,1);return i.multiplyRight(o).multiplyRight(s)}(r);return i!==o&&(t.texCoord=o),e.push([i,o]),{originalTexCoord:i,texCoord:o,matrix:n}}return null}(n,r);if(!i)return;const o=t.json.meshes||[];for(const n of o)for(const r of n.primitives){const n=r.material;Number.isFinite(n)&&e===n&&Wt(t,r,i)}}function Wt(t,e,n){const{originalTexCoord:r,texCoord:i,matrix:o}=n,s=e.attributes["TEXCOORD_".concat(r)];if(Number.isFinite(s)){var a;const n=null===(a=t.json.accessors)||void 0===a?void 0:a[s];if(n&&n.bufferView){var l;const s=null===(l=t.json.bufferViews)||void 0===l?void 0:l[n.bufferView];if(s){const{arrayBuffer:a,byteOffset:l}=t.buffers[s.buffer],u=(l||0)+(n.byteOffset||0)+(s.byteOffset||0),{ArrayType:c,length:h}=(0,et.aF)(n,s),d=Ft[n.componentType],f=Dt[n.type],p=s.byteStride||d*f,g=new Float32Array(h);for(let t=0;t<n.count;t++){const e=new c(a,u+t*p,2);Gt.set(e[0],e[1],1),Gt.transformByMatrix3(o),g.set([Gt[0],Gt[1]],t*f)}r===i?function(t,e,n,r){t.componentType=5126,n.push({arrayBuffer:r.buffer,byteOffset:0,byteLength:r.buffer.byteLength}),e.buffer=n.length-1,e.byteLength=r.buffer.byteLength,e.byteOffset=0,delete e.byteStride}(n,s,t.buffers,g):function(t,e,n,r,i){r.buffers.push({arrayBuffer:i.buffer,byteOffset:0,byteLength:i.buffer.byteLength});const o=r.json.bufferViews;if(!o)return;o.push({buffer:r.buffers.length-1,byteLength:i.buffer.byteLength,byteOffset:0});const s=r.json.accessors;s&&(s.push({bufferView:(null==o?void 0:o.length)-1,byteOffset:0,componentType:5126,count:e.count,type:"VEC2"}),n.attributes["TEXCOORD_".concat(t)]=s.length-1)}(i,n,e,t,g)}}}}const Jt="KHR_lights_punctual",Yt=Jt;async function Xt(t){const e=new rt(t),{json:n}=e,r=e.getExtension(Jt);r&&(e.json.lights=r.lights,e.removeExtension(Jt));for(const t of n.nodes||[]){const n=e.getObjectExtension(t,Jt);n&&(t.light=n.light),e.removeObjectExtension(t,Jt)}}async function Kt(t){const e=new rt(t),{json:n}=e;if(n.lights){const t=e.addExtension(Jt);(0,Y.v)(!t.lights),t.lights=n.lights,delete n.lights}if(e.json.lights){for(const t of e.json.lights){const n=t.node;e.addObjectExtension(n,Jt,t)}delete e.json.lights}}const Zt="KHR_materials_unlit",Qt=Zt;async function $t(t){const e=new rt(t),{json:n}=e;for(const t of n.materials||[])t.extensions&&t.extensions.KHR_materials_unlit&&(t.unlit=!0),e.removeObjectExtension(t,Zt);e.removeExtension(Zt)}function te(t){const e=new rt(t),{json:n}=e;if(e.materials)for(const t of n.materials||[])t.unlit&&(delete t.unlit,e.addObjectExtension(t,Zt,{}),e.addExtension(Zt))}const ee="KHR_techniques_webgl",ne=ee;async function re(t){const e=new rt(t),{json:n}=e,r=e.getExtension(ee);if(r){const t=function(t,e){const{programs:n=[],shaders:r=[],techniques:i=[]}=t,o=new TextDecoder;return r.forEach((t=>{if(!Number.isFinite(t.bufferView))throw new Error("KHR_techniques_webgl: no shader code");t.code=o.decode(e.getTypedArrayForBufferView(t.bufferView))})),n.forEach((t=>{t.fragmentShader=r[t.fragmentShader],t.vertexShader=r[t.vertexShader]})),i.forEach((t=>{t.program=n[t.program]})),i}(r,e);for(const r of n.materials||[]){const n=e.getObjectExtension(r,ee);n&&(r.technique=Object.assign({},n,t[n.technique]),r.technique.values=oe(r.technique,e)),e.removeObjectExtension(r,ee)}e.removeExtension(ee)}}async function ie(t,e){}function oe(t,e){const n=Object.assign({},t.values);return Object.keys(t.uniforms||{}).forEach((e=>{t.uniforms[e].value&&!(e in n)&&(n[e]=t.uniforms[e].value)})),Object.keys(n).forEach((t=>{"object"==typeof n[t]&&void 0!==n[t].index&&(n[t].texture=e.getTexture(n[t].index))})),n}const se="EXT_feature_metadata",ae=se;async function le(t){!function(t){var e;const n=t.getExtension(se),r=null==n||null===(e=n.schema)||void 0===e?void 0:e.classes,i=null==n?void 0:n.featureTables;if((null==n?void 0:n.featureTextures)&&console.warn('featureTextures is not yet supported in the "EXT_feature_metadata" extension.'),r&&i)for(const e in r){const n=r[e],o=he(i,e);o&&ue(t,o,n)}}(new rt(t))}function ue(t,e,n){for(const i in n.properties){var r;const o=n.properties[i],s=null==e||null===(r=e.properties)||void 0===r?void 0:r[i],a=e.count;if(s){const e=ce(t,o,a,s);s.data=e}}}function ce(t,e,n,r){const i=r.bufferView;let o=t.getTypedArrayForBufferView(i);switch(e.type){case"STRING":{const e=r.stringOffsetBufferView;o=function(t,e,n){const r=[],i=new TextDecoder("utf8");let o=0;for(let s=0;s<n;s++){const n=e[4*(s+1)]-e[4*s],a=t.subarray(o,n+o),l=i.decode(a);r.push(l),o+=n}return r}(o,t.getTypedArrayForBufferView(e),n);break}}return o}function he(t,e){for(const n in t){const r=t[n];if(r.class===e)return r}return null}const de=[i,o,s,a,u,c,h,l,d];function fe(t,e){var n;const r=(null==e||null===(n=e.gltf)||void 0===n?void 0:n.excludeExtensions)||{};return!(t in r&&!r[t])}const pe="KHR_binary_glTF",ge={accessors:"accessor",animations:"animation",buffers:"buffer",bufferViews:"bufferView",images:"image",materials:"material",meshes:"mesh",nodes:"node",samplers:"sampler",scenes:"scene",skins:"skin",textures:"texture"},ye={accessor:"accessors",animations:"animation",buffer:"buffers",bufferView:"bufferViews",image:"images",material:"materials",mesh:"meshes",node:"nodes",sampler:"samplers",scene:"scenes",skin:"skins",texture:"textures"};class me{constructor(){(0,K.A)(this,"idToIndexMap",{animations:{},accessors:{},buffers:{},bufferViews:{},images:{},materials:{},meshes:{},nodes:{},samplers:{},scenes:{},skins:{},textures:{}}),(0,K.A)(this,"json",void 0)}normalize(t,e){this.json=t.json;const n=t.json;switch(n.asset&&n.asset.version){case"2.0":return;case void 0:case"1.0":break;default:return void console.warn("glTF: Unknown version ".concat(n.asset.version))}if(!e.normalize)throw new Error("glTF v1 is not supported.");console.warn("Converting glTF v1 to glTF v2 format. This is experimental and may fail."),this._addAsset(n),this._convertTopLevelObjectsToArrays(n),function(t){const e=new rt(t),{json:n}=e;for(const t of n.images||[]){const n=e.getObjectExtension(t,pe);n&&Object.assign(t,n),e.removeObjectExtension(t,pe)}n.buffers&&n.buffers[0]&&delete n.buffers[0].uri,e.removeExtension(pe)}(t),this._convertObjectIdsToArrayIndices(n),this._updateObjects(n),this._updateMaterial(n)}_addAsset(t){t.asset=t.asset||{},t.asset.version="2.0",t.asset.generator=t.asset.generator||"Normalized to glTF 2.0 by loaders.gl"}_convertTopLevelObjectsToArrays(t){for(const e in ge)this._convertTopLevelObjectToArray(t,e)}_convertTopLevelObjectToArray(t,e){const n=t[e];if(n&&!Array.isArray(n)){t[e]=[];for(const r in n){const i=n[r];i.id=i.id||r;const o=t[e].length;t[e].push(i),this.idToIndexMap[e][r]=o}}}_convertObjectIdsToArrayIndices(t){for(const e in ge)this._convertIdsToIndices(t,e);"scene"in t&&(t.scene=this._convertIdToIndex(t.scene,"scene"));for(const e of t.textures)this._convertTextureIds(e);for(const e of t.meshes)this._convertMeshIds(e);for(const e of t.nodes)this._convertNodeIds(e);for(const e of t.scenes)this._convertSceneIds(e)}_convertTextureIds(t){t.source&&(t.source=this._convertIdToIndex(t.source,"image"))}_convertMeshIds(t){for(const e of t.primitives){const{attributes:t,indices:n,material:r}=e;for(const e in t)t[e]=this._convertIdToIndex(t[e],"accessor");n&&(e.indices=this._convertIdToIndex(n,"accessor")),r&&(e.material=this._convertIdToIndex(r,"material"))}}_convertNodeIds(t){t.children&&(t.children=t.children.map((t=>this._convertIdToIndex(t,"node")))),t.meshes&&(t.meshes=t.meshes.map((t=>this._convertIdToIndex(t,"mesh"))))}_convertSceneIds(t){t.nodes&&(t.nodes=t.nodes.map((t=>this._convertIdToIndex(t,"node"))))}_convertIdsToIndices(t,e){t[e]||(console.warn("gltf v1: json doesn't contain attribute ".concat(e)),t[e]=[]);for(const n of t[e])for(const t in n){const e=n[t],r=this._convertIdToIndex(e,t);n[t]=r}}_convertIdToIndex(t,e){const n=ye[e];if(n in this.idToIndexMap){const r=this.idToIndexMap[n][t];if(!Number.isFinite(r))throw new Error("gltf v1: failed to resolve ".concat(e," with id ").concat(t));return r}return t}_updateObjects(t){for(const t of this.json.buffers)delete t.type}_updateMaterial(t){for(const i of t.materials){var e,n,r;i.pbrMetallicRoughness={baseColorFactor:[1,1,1,1],metallicFactor:1,roughnessFactor:1};const o=(null===(e=i.values)||void 0===e?void 0:e.tex)||(null===(n=i.values)||void 0===n?void 0:n.texture2d_0)||(null===(r=i.values)||void 0===r?void 0:r.diffuseTex),s=t.textures.findIndex((t=>t.id===o));-1!==s&&(i.pbrMetallicRoughness.baseColorTexture={index:s})}}}const ve={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},be={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},_e=10240,Ae=10241,xe=10242,we=10243,Ce={magFilter:10240,minFilter:10241,wrapS:10242,wrapT:10243},Se={[_e]:9729,[Ae]:9986,[xe]:10497,[we]:10497};class Ee{constructor(){(0,K.A)(this,"baseUri",""),(0,K.A)(this,"json",{}),(0,K.A)(this,"buffers",[]),(0,K.A)(this,"images",[])}postProcess(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{json:n,buffers:r=[],images:i=[],baseUri:o=""}=t;return(0,Y.v)(n),this.baseUri=o,this.json=n,this.buffers=r,this.images=i,this._resolveTree(this.json,e),this.json}_resolveTree(t){t.bufferViews&&(t.bufferViews=t.bufferViews.map(((t,e)=>this._resolveBufferView(t,e)))),t.images&&(t.images=t.images.map(((t,e)=>this._resolveImage(t,e)))),t.samplers&&(t.samplers=t.samplers.map(((t,e)=>this._resolveSampler(t,e)))),t.textures&&(t.textures=t.textures.map(((t,e)=>this._resolveTexture(t,e)))),t.accessors&&(t.accessors=t.accessors.map(((t,e)=>this._resolveAccessor(t,e)))),t.materials&&(t.materials=t.materials.map(((t,e)=>this._resolveMaterial(t,e)))),t.meshes&&(t.meshes=t.meshes.map(((t,e)=>this._resolveMesh(t,e)))),t.nodes&&(t.nodes=t.nodes.map(((t,e)=>this._resolveNode(t,e)))),t.skins&&(t.skins=t.skins.map(((t,e)=>this._resolveSkin(t,e)))),t.scenes&&(t.scenes=t.scenes.map(((t,e)=>this._resolveScene(t,e)))),void 0!==t.scene&&(t.scene=t.scenes[this.json.scene])}getScene(t){return this._get("scenes",t)}getNode(t){return this._get("nodes",t)}getSkin(t){return this._get("skins",t)}getMesh(t){return this._get("meshes",t)}getMaterial(t){return this._get("materials",t)}getAccessor(t){return this._get("accessors",t)}getCamera(t){return null}getTexture(t){return this._get("textures",t)}getSampler(t){return this._get("samplers",t)}getImage(t){return this._get("images",t)}getBufferView(t){return this._get("bufferViews",t)}getBuffer(t){return this._get("buffers",t)}_get(t,e){if("object"==typeof e)return e;const n=this.json[t]&&this.json[t][e];return n||console.warn("glTF file error: Could not find ".concat(t,"[").concat(e,"]")),n}_resolveScene(t,e){return t.id=t.id||"scene-".concat(e),t.nodes=(t.nodes||[]).map((t=>this.getNode(t))),t}_resolveNode(t,e){return t.id=t.id||"node-".concat(e),t.children&&(t.children=t.children.map((t=>this.getNode(t)))),void 0!==t.mesh?t.mesh=this.getMesh(t.mesh):void 0!==t.meshes&&t.meshes.length&&(t.mesh=t.meshes.reduce(((t,e)=>{const n=this.getMesh(e);return t.id=n.id,t.primitives=t.primitives.concat(n.primitives),t}),{primitives:[]})),void 0!==t.camera&&(t.camera=this.getCamera(t.camera)),void 0!==t.skin&&(t.skin=this.getSkin(t.skin)),t}_resolveSkin(t,e){return t.id=t.id||"skin-".concat(e),t.inverseBindMatrices=this.getAccessor(t.inverseBindMatrices),t}_resolveMesh(t,e){return t.id=t.id||"mesh-".concat(e),t.primitives&&(t.primitives=t.primitives.map((t=>{const e=(t={...t}).attributes;t.attributes={};for(const n in e)t.attributes[n]=this.getAccessor(e[n]);return void 0!==t.indices&&(t.indices=this.getAccessor(t.indices)),void 0!==t.material&&(t.material=this.getMaterial(t.material)),t}))),t}_resolveMaterial(t,e){if(t.id=t.id||"material-".concat(e),t.normalTexture&&(t.normalTexture={...t.normalTexture},t.normalTexture.texture=this.getTexture(t.normalTexture.index)),t.occlusionTexture&&(t.occlustionTexture={...t.occlustionTexture},t.occlusionTexture.texture=this.getTexture(t.occlusionTexture.index)),t.emissiveTexture&&(t.emmisiveTexture={...t.emmisiveTexture},t.emissiveTexture.texture=this.getTexture(t.emissiveTexture.index)),t.emissiveFactor||(t.emissiveFactor=t.emmisiveTexture?[1,1,1]:[0,0,0]),t.pbrMetallicRoughness){t.pbrMetallicRoughness={...t.pbrMetallicRoughness};const e=t.pbrMetallicRoughness;e.baseColorTexture&&(e.baseColorTexture={...e.baseColorTexture},e.baseColorTexture.texture=this.getTexture(e.baseColorTexture.index)),e.metallicRoughnessTexture&&(e.metallicRoughnessTexture={...e.metallicRoughnessTexture},e.metallicRoughnessTexture.texture=this.getTexture(e.metallicRoughnessTexture.index))}return t}_resolveAccessor(t,e){var n,r;if(t.id=t.id||"accessor-".concat(e),void 0!==t.bufferView&&(t.bufferView=this.getBufferView(t.bufferView)),t.bytesPerComponent=(n=t.componentType,be[n]),t.components=(r=t.type,ve[r]),t.bytesPerElement=t.bytesPerComponent*t.components,t.bufferView){const e=t.bufferView.buffer,{ArrayType:n,byteLength:r}=(0,et.aF)(t,t.bufferView),i=(t.bufferView.byteOffset||0)+(t.byteOffset||0)+e.byteOffset;let o=e.arrayBuffer.slice(i,i+r);t.bufferView.byteStride&&(o=this._getValueFromInterleavedBuffer(e,i,t.bufferView.byteStride,t.bytesPerElement,t.count)),t.value=new n(o)}return t}_getValueFromInterleavedBuffer(t,e,n,r,i){const o=new Uint8Array(i*r);for(let s=0;s<i;s++){const i=e+s*n;o.set(new Uint8Array(t.arrayBuffer.slice(i,i+r)),s*r)}return o.buffer}_resolveTexture(t,e){return t.id=t.id||"texture-".concat(e),t.sampler="sampler"in t?this.getSampler(t.sampler):Se,t.source=this.getImage(t.source),t}_resolveSampler(t,e){t.id=t.id||"sampler-".concat(e),t.parameters={};for(const e in t){const n=this._enumSamplerParameter(e);void 0!==n&&(t.parameters[n]=t[e])}return t}_enumSamplerParameter(t){return Ce[t]}_resolveImage(t,e){t.id=t.id||"image-".concat(e),void 0!==t.bufferView&&(t.bufferView=this.getBufferView(t.bufferView));const n=this.images[e];return n&&(t.image=n),t}_resolveBufferView(t,e){const n=t.buffer,r={id:"bufferView-".concat(e),...t,buffer:this.buffers[n]},i=this.buffers[n].arrayBuffer;let o=this.buffers[n].byteOffset||0;return"byteOffset"in t&&(o+=t.byteOffset),r.data=new Uint8Array(i,o,t.byteLength),r}_resolveCamera(t,e){return t.id=t.id||"camera-".concat(e),t.perspective,t.orthographic,t}}const Me=1735152710,Pe=12,Te=8,Oe=1313821514,Ie=5130562,Re=0,Be=1,Le=0,ke=!0;function De(t,e,n,r){const i=new Uint8Array(e.buffer,n,r),o=new TextDecoder("utf8").decode(i);return t.json=JSON.parse(o),$(r,4)}function Fe(t,e,n,r){return t.header.hasBinChunk=!0,t.binChunks.push({byteOffset:n,byteLength:r,arrayBuffer:e.buffer}),$(r,4)}async function Ne(t,e){var n,r,i,o;let s=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;!function(t,e,n,r){if(r.uri&&(t.baseUri=r.uri),e instanceof ArrayBuffer&&!function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new DataView(t),{magic:i=Me}=n,o=r.getUint32(e,!1);return o===i||o===Me}(e,n,r)&&(e=(new TextDecoder).decode(e)),"string"==typeof e)t.json=function(t){try{return JSON.parse(t)}catch(e){throw new Error('Failed to parse JSON from data starting with "'.concat(function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;return"string"==typeof t?t.slice(0,e):ArrayBuffer.isView(t)?W(t.buffer,t.byteOffset,e):t instanceof ArrayBuffer?W(t,0,e):""}(t),'"'))}}(e);else if(e instanceof ArrayBuffer){const i={};n=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const i=new DataView(e),o=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return"".concat(String.fromCharCode(t.getUint8(e+0))).concat(String.fromCharCode(t.getUint8(e+1))).concat(String.fromCharCode(t.getUint8(e+2))).concat(String.fromCharCode(t.getUint8(e+3)))}(i,n+0),s=i.getUint32(n+4,ke),a=i.getUint32(n+8,ke);switch(Object.assign(t,{header:{byteOffset:n,byteLength:a,hasBinChunk:!1},type:o,version:s,json:{},binChunks:[]}),n+=Pe,t.version){case 1:return function(t,e,n){(0,Q.v)(t.header.byteLength>Pe+Te);const r=e.getUint32(n+0,ke),i=e.getUint32(n+4,ke);return n+=Te,(0,Q.v)(i===Le),De(t,e,n,r),(n+=r)+Fe(t,e,n,t.header.byteLength)}(t,i,n);case 2:return function(t,e,n,r){return(0,Q.v)(t.header.byteLength>Pe+Te),function(t,e,n,r){for(;n+8<=t.header.byteLength;){const i=e.getUint32(n+0,ke),o=e.getUint32(n+4,ke);switch(n+=Te,o){case Oe:De(t,e,n,i);break;case Ie:Fe(t,e,n,i);break;case Re:r.strict||De(t,e,n,i);break;case Be:r.strict||Fe(t,e,n,i)}n+=$(i,4)}}(t,e,n,r),n+t.header.byteLength}(t,i,n,r={});default:throw new Error("Invalid GLB version ".concat(t.version,". Only supports v1 and v2."))}}(i,e,n,r.glb),(0,Y.v)("glTF"===i.type,"Invalid GLB magic string ".concat(i.type)),t._glb=i,t.json=i.json}else(0,Y.v)(!1,"GLTF: must be ArrayBuffer or string");const i=t.json.buffers||[];if(t.buffers=new Array(i.length).fill(null),t._glb&&t._glb.header.hasBinChunk){const{binChunks:e}=t._glb;t.buffers[0]={arrayBuffer:e[0].arrayBuffer,byteOffset:e[0].byteOffset,byteLength:e[0].byteLength}}const o=t.json.images||[];t.images=new Array(o.length).fill({})}(t,e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s),function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(new me).normalize(t,e)}(t,{normalize:null==s||null===(n=s.gltf)||void 0===n?void 0:n.normalize}),function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;const r=de.filter((t=>fe(t.name,e)));for(const o of r){var i;null===(i=o.preprocess)||void 0===i||i.call(o,t,e,n)}}(t,s,a);const l=[];if(null!=s&&null!==(r=s.gltf)&&void 0!==r&&r.loadBuffers&&t.json.buffers&&await async function(t,e,n){const r=t.json.buffers||[];for(let s=0;s<r.length;++s){const a=r[s];if(a.uri){var i,o;const{fetch:r}=n;(0,Y.v)(r);const l=X(a.uri,e),u=await(null==n||null===(i=n.fetch)||void 0===i?void 0:i.call(n,l)),c=await(null==u||null===(o=u.arrayBuffer)||void 0===o?void 0:o.call(u));t.buffers[s]={arrayBuffer:c,byteOffset:0,byteLength:c.byteLength},delete a.uri}else null===t.buffers[s]&&(t.buffers[s]={arrayBuffer:new ArrayBuffer(a.byteLength),byteOffset:0,byteLength:a.byteLength})}}(t,s,a),null!=s&&null!==(i=s.gltf)&&void 0!==i&&i.loadImages){const e=async function(t,e,n){const r=function(t){const e=new Set,n=t.json.textures||[];for(const t of n)void 0!==t.source&&e.add(t.source);return Array.from(e).sort()}(t),i=t.json.images||[],o=[];for(const s of r)o.push(je(t,i[s],s,e,n));return await Promise.all(o)}(t,s,a);l.push(e)}const u=async function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;const r=de.filter((t=>fe(t.name,e)));for(const o of r){var i;await(null===(i=o.decode)||void 0===i?void 0:i.call(o,t,e,n))}}(t,s,a);return l.push(u),await Promise.all(l),null!=s&&null!==(o=s.gltf)&&void 0!==o&&o.postProcess?function(t,e){return(new Ee).postProcess(t,e)}(t,s):t}async function je(t,e,n,r,i){const{fetch:o,parse:s}=i;let a;if(e.uri&&!e.hasOwnProperty("bufferView")){const t=X(e.uri,r),n=await o(t);a=await n.arrayBuffer(),e.bufferView={data:a}}if(Number.isFinite(e.bufferView)){const n=function(t,e,n){const r=t.bufferViews[n];(0,Y.v)(r);const i=e[r.buffer];(0,Y.v)(i);const o=(r.byteOffset||0)+i.byteOffset;return new Uint8Array(i.arrayBuffer,o,r.byteLength)}(t.json,t.buffers,e.bufferView);a=(0,J._m)(n.buffer,n.byteOffset,n.byteLength)}(0,Y.v)(a,"glTF image has no data");let l=await s(a,[q.$,H],{mimeType:e.mimeType,basis:r.basis||{format:V()}},i);l&&l[0]&&(l={compressed:!0,mipmaps:!1,width:l[0].width,height:l[0].height,data:l[0]}),t.images=t.images||[],t.images[n]=l}const Ge={name:"glTF",id:"gltf",module:"gltf",version:"3.4.15",extensions:["gltf","glb"],mimeTypes:["model/gltf+json","model/gltf-binary"],text:!0,binary:!0,tests:["glTF"],parse:async function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;e={...Ge.options,...e},e.gltf={...Ge.options.gltf,...e.gltf};const{byteOffset:r=0}=e;return await Ne({},t,r,e,n)},options:{gltf:{normalize:!0,loadBuffers:!0,loadImages:!0,decompressMeshes:!0,postProcess:!0},log:console},deprecatedOptions:{fetchImages:"gltf.loadImages",createImages:"gltf.loadImages",decompress:"gltf.decompressMeshes",postProcess:"gltf.postProcess",gltf:{decompress:"gltf.decompressMeshes"}}}},6440:(t,e,n)=>{"use strict";n.d(e,{S3:()=>f,aF:()=>d,rA:()=>h,v7:()=>c});var r=n(89359);const i=["SCALAR","VEC2","VEC3","VEC4"],o=[[Int8Array,5120],[Uint8Array,5121],[Int16Array,5122],[Uint16Array,5123],[Uint32Array,5125],[Float32Array,5126],[Float64Array,5130]],s=new Map(o),a={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},l={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},u={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function c(t){return i[t-1]||i[0]}function h(t){const e=s.get(t.constructor);if(!e)throw new Error("Illegal typed array");return e}function d(t,e){const n=u[t.componentType],i=a[t.type],o=l[t.componentType],s=t.count*i,c=t.count*i*o;return(0,r.v)(c>=0&&c<=e.byteLength),{ArrayType:n,length:s,byteLength:c}}function f(t){let{images:e,bufferViews:n}=t;e=e||[],n=n||[];const r=e.map((t=>t.bufferView));n=n.filter((t=>!r.includes(t)));const i=n.reduce(((t,e)=>t+e.byteLength),0),o=e.reduce(((t,e)=>{const{width:n,height:r}=e.image;return t+n*r}),0);return i+Math.ceil(4*o*1.33)}},89359:(t,e,n)=>{"use strict";function r(t,e){if(!t)throw new Error(e||"assert failed: gltf")}n.d(e,{v:()=>r})},94557:(t,e,n)=>{"use strict";n.d(e,{$:()=>b});var r=n(17243),i=n(83921);const{_parseImageNode:o}=globalThis,s="undefined"!=typeof Image,a="undefined"!=typeof ImageBitmap,l=Boolean(o),u=!!i.Bd||l;function c(t){const e=function(t){return"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap?"imagebitmap":"undefined"!=typeof Image&&t instanceof Image?"image":t&&"object"==typeof t&&t.data&&t.width&&t.height?"data":null}(t);if(!e)throw new Error("Not an image");return e}const h=/^data:image\/svg\+xml/,d=/\.svg((\?|#).*)?$/;function f(t){return t&&(h.test(t)||d.test(t))}function p(t,e){if(f(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(t)])}async function g(t,e,n){const r=function(t,e){if(f(e)){let e=(new TextDecoder).decode(t);try{"function"==typeof unescape&&"function"==typeof encodeURIComponent&&(e=unescape(encodeURIComponent(e)))}catch(t){throw new Error(t.message)}return"data:image/svg+xml;base64,".concat(btoa(e))}return p(t,e)}(t,n),i=self.URL||self.webkitURL,o="string"!=typeof r&&i.createObjectURL(r);try{return await async function(t,e){const n=new Image;return n.src=t,e.image&&e.image.decode&&n.decode?(await n.decode(),n):await new Promise(((e,r)=>{try{n.onload=()=>e(n),n.onerror=e=>r(new Error("Could not load image ".concat(t,": ").concat(e)))}catch(t){r(t)}}))}(o||r,e)}finally{o&&i.revokeObjectURL(o)}}const y={};let m=!0;var v=n(51434);const b={id:"image",module:"images",name:"Images",version:"3.4.15",mimeTypes:["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],extensions:["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],parse:async function(t,e,n){const i=((e=e||{}).image||{}).type||"auto",{url:o}=n||{};let l;switch(function(t){switch(t){case"auto":case"data":return function(){if(a)return"imagebitmap";if(s)return"image";if(u)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}();default:return function(t){switch(t){case"auto":return a||s||u;case"imagebitmap":return a;case"image":return s;case"data":return u;default:throw new Error("@loaders.gl/images: image ".concat(t," not supported in this environment"))}}(t),t}}(i)){case"imagebitmap":l=await async function(t,e,n){let r;r=f(n)?await g(t,e,n):p(t,n);const i=e&&e.imagebitmap;return await async function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!function(t){for(const e in t||y)return!1;return!0}(e)&&m||(e=null),e)try{return await createImageBitmap(t,e)}catch(t){console.warn(t),m=!1}return await createImageBitmap(t)}(r,i)}(t,e,o);break;case"image":l=await g(t,e,o);break;case"data":l=await async function(t){const{mimeType:e}=(0,v.m)(t)||{},n=globalThis._parseImageNode;return(0,r.v)(n),await n(t,e)}(t);break;default:(0,r.v)(!1)}return"data"===i&&(l=function(t){switch(c(t)){case"data":return t;case"image":case"imagebitmap":const e=document.createElement("canvas"),n=e.getContext("2d");if(!n)throw new Error("getImageData");return e.width=t.width,e.height=t.height,n.drawImage(t,0,0),n.getImageData(0,0,t.width,t.height);default:throw new Error("getImageData")}}(l)),l},tests:[t=>Boolean((0,v.m)(new DataView(t)))],options:{image:{type:"auto",decode:!0}}}},51434:(t,e,n)=>{"use strict";n.d(e,{m:()=>o});const r=!1,i=!0;function o(t){const e=s(t);return function(t){const e=s(t);return e.byteLength>=24&&2303741511===e.getUint32(0,r)?{mimeType:"image/png",width:e.getUint32(16,r),height:e.getUint32(20,r)}:null}(e)||function(t){const e=s(t);if(!(e.byteLength>=3&&65496===e.getUint16(0,r)&&255===e.getUint8(2)))return null;const{tableMarkers:n,sofMarkers:i}=function(){const t=new Set([65499,65476,65484,65501,65534]);for(let e=65504;e<65520;++e)t.add(e);return{tableMarkers:t,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}();let o=2;for(;o+9<e.byteLength;){const t=e.getUint16(o,r);if(i.has(t))return{mimeType:"image/jpeg",height:e.getUint16(o+5,r),width:e.getUint16(o+7,r)};if(!n.has(t))return null;o+=2,o+=e.getUint16(o,r)}return null}(e)||function(t){const e=s(t);return e.byteLength>=10&&1195984440===e.getUint32(0,r)?{mimeType:"image/gif",width:e.getUint16(6,i),height:e.getUint16(8,i)}:null}(e)||function(t){const e=s(t);return e.byteLength>=14&&16973===e.getUint16(0,r)&&e.getUint32(2,i)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,i),height:e.getUint32(22,i)}:null}(e)||function(t){const e=function(t){return function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const r=(i=e,[...i].map((t=>t.charCodeAt(0))));var i;for(let e=0;e<r.length;++e)if(r[e]!==t[e+n])return!1;return!0}(t,"ftyp",4)&&96&t[8]?function(t){switch((e=t,String.fromCharCode(...e.slice(8,12))).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}var e}(t):null}(new Uint8Array(t instanceof DataView?t.buffer:t));return e?{mimeType:e.mimeType,width:0,height:0}:null}(e)}function s(t){if(t instanceof DataView)return t;if(ArrayBuffer.isView(t))return new DataView(t.buffer);if(t instanceof ArrayBuffer)return new DataView(t);throw new Error("toDataView")}},57345:(t,e,n)=>{"use strict";function r(t,e,n){if(n=n||t.byteLength,t.byteLength<n||e.byteLength<n)return!1;const r=new Uint8Array(t),i=new Uint8Array(e);for(let t=0;t<r.length;++t)if(r[t]!==i[t])return!1;return!0}function i(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const r=e.map((t=>t instanceof ArrayBuffer?new Uint8Array(t):t)),i=r.reduce(((t,e)=>t+e.byteLength),0),o=new Uint8Array(i);let s=0;for(const t of r)o.set(t,s),s+=t.byteLength;return o.buffer}function o(t,e,n){const r=void 0!==n?new Uint8Array(t).subarray(e,e+n):new Uint8Array(t).subarray(e);return new Uint8Array(r).buffer}n.d(e,{AQ:()=>i,YV:()=>r,_m:()=>o})},17243:(t,e,n)=>{"use strict";function r(t,e){if(!t)throw new Error(e||"loader assertion failed.")}n.d(e,{v:()=>r})},83921:(t,e,n)=>{"use strict";n.d(e,{Al:()=>l,Bd:()=>u,Sf:()=>a,bg:()=>o,x:()=>s,xD:()=>c});var r=n(65606);const i={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:void 0!==n.g&&n.g,document:"undefined"!=typeof document&&document},o=i.self||i.window||i.global||{},s=i.window||i.self||i.global||{},a=i.global||i.self||i.window||{},l=i.document||{},u=Boolean("object"!=typeof r||"[object process]"!==String(r)||r.browser),c="function"==typeof importScripts,h=void 0!==r&&r.version&&/v([0-9]*)/.exec(r.version);h&&parseFloat(h[1])},16562:(t,e,n)=>{"use strict";function r(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(e+1):""}function i(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(0,e):""}n.d(e,{iW:()=>r,pD:()=>i})},31726:(t,e,n)=>{"use strict";n.d(e,{A:()=>s});var r=n(67136),i=n(35520);const o={id:"request-scheduler",throttleRequests:!0,maxRequests:6};class s{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,r.A)(this,"props",void 0),(0,r.A)(this,"stats",void 0),(0,r.A)(this,"activeRequestCount",0),(0,r.A)(this,"requestQueue",[]),(0,r.A)(this,"requestMap",new Map),(0,r.A)(this,"deferredUpdate",null),this.props={...o,...t},this.stats=new i.Uz({id:this.props.id}),this.stats.get("Queued Requests"),this.stats.get("Active Requests"),this.stats.get("Cancelled Requests"),this.stats.get("Queued Requests Ever"),this.stats.get("Active Requests Ever")}scheduleRequest(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>0;if(!this.props.throttleRequests)return Promise.resolve({done:()=>{}});if(this.requestMap.has(t))return this.requestMap.get(t);const n={handle:t,priority:0,getPriority:e},r=new Promise((t=>(n.resolve=t,n)));return this.requestQueue.push(n),this.requestMap.set(t,r),this._issueNewRequests(),r}_issueRequest(t){const{handle:e,resolve:n}=t;let r=!1;const i=()=>{r||(r=!0,this.requestMap.delete(e),this.activeRequestCount--,this._issueNewRequests())};return this.activeRequestCount++,n?n({done:i}):Promise.resolve({done:i})}_issueNewRequests(){this.deferredUpdate||(this.deferredUpdate=setTimeout((()=>this._issueNewRequestsAsync()),0))}_issueNewRequestsAsync(){this.deferredUpdate=null;const t=Math.max(this.props.maxRequests-this.activeRequestCount,0);if(0!==t){this._updateAllRequests();for(let e=0;e<t;++e){const t=this.requestQueue.shift();t&&this._issueRequest(t)}}}_updateAllRequests(){const t=this.requestQueue;for(let e=0;e<t.length;++e){const n=t[e];this._updateRequest(n)||(t.splice(e,1),this.requestMap.delete(n.handle),e--)}t.sort(((t,e)=>t.priority-e.priority))}_updateRequest(t){return t.priority=t.getPriority(t.handle),!(t.priority<0&&(t.resolve(null),1))}}},36830:(t,e,n)=>{"use strict";n.d(e,{A:()=>a});var r=n(77325),i=n(38404),o=n(26107),s=n(8282);class a{constructor(t,e){let{attributes:n,material:o,pbrDebug:s,imageBasedLightingEnvironment:a,lights:l,useTangents:u}=e;this.gl=t,this.defines={MANUAL_SRGB:1,SRGB_FAST_APPROXIMATION:1},(0,r.jI)(t,i.G.GLSL_TEXTURE_LOD)&&(this.defines.USE_TEX_LOD=1),this.uniforms={u_Camera:[0,0,0],u_MetallicRoughnessValues:[1,1]},this.parameters={},this.generatedTextures=[],a&&(this.uniforms.u_DiffuseEnvSampler=a.getDiffuseEnvSampler(),this.uniforms.u_SpecularEnvSampler=a.getSpecularEnvSampler(),this.uniforms.u_brdfLUT=a.getBrdfTexture(),this.uniforms.u_ScaleIBLAmbient=[1,1]),s&&(this.uniforms.u_ScaleDiffBaseMR=[0,0,0,0],this.uniforms.u_ScaleFGDSpec=[0,0,0,0]),this.defineIfPresent(n.NORMAL,"HAS_NORMALS"),this.defineIfPresent(n.TANGENT&&u,"HAS_TANGENTS"),this.defineIfPresent(n.TEXCOORD_0,"HAS_UV"),this.defineIfPresent(a,"USE_IBL"),this.defineIfPresent(l,"USE_LIGHTS"),this.defineIfPresent(s,"PBR_DEBUG"),o&&this.parseMaterial(o)}defineIfPresent(t,e){t&&(this.defines[e]=1)}parseTexture(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const r=t.texture&&t.texture.sampler&&t.texture.sampler.parameters||{},i=t.texture.source.image;let s,a={};i.compressed?(s=i,a={[this.gl.TEXTURE_MIN_FILTER]:i.data.length>1?this.gl.LINEAR_MIPMAP_NEAREST:this.gl.LINEAR}):s={data:i};const l=new o.A(this.gl,{id:t.name||t.id,parameters:{...r,...a},pixelStore:{[this.gl.UNPACK_FLIP_Y_WEBGL]:!1},...s});this.uniforms[e]=l,this.defineIfPresent(n,n),this.generatedTextures.push(l)}parsePbrMetallicRoughness(t){t.baseColorTexture&&this.parseTexture(t.baseColorTexture,"u_BaseColorSampler","HAS_BASECOLORMAP"),this.uniforms.u_BaseColorFactor=t.baseColorFactor||[1,1,1,1],t.metallicRoughnessTexture&&this.parseTexture(t.metallicRoughnessTexture,"u_MetallicRoughnessSampler","HAS_METALROUGHNESSMAP");const{metallicFactor:e=1,roughnessFactor:n=1}=t;this.uniforms.u_MetallicRoughnessValues=[e,n]}parseMaterial(t){if(this.uniforms.pbr_uUnlit=Boolean(t.unlit),t.pbrMetallicRoughness&&this.parsePbrMetallicRoughness(t.pbrMetallicRoughness),t.normalTexture){this.parseTexture(t.normalTexture,"u_NormalSampler","HAS_NORMALMAP");const{scale:e=1}=t.normalTexture;this.uniforms.u_NormalScale=e}if(t.occlusionTexture){this.parseTexture(t.occlusionTexture,"u_OcclusionSampler","HAS_OCCLUSIONMAP");const{strength:e=1}=t.occlusionTexture;this.uniforms.u_OcclusionStrength=e}if(t.emissiveTexture&&(this.parseTexture(t.emissiveTexture,"u_EmissiveSampler","HAS_EMISSIVEMAP"),this.uniforms.u_EmissiveFactor=t.emissiveFactor||[0,0,0]),"MASK"===t.alphaMode){const{alphaCutoff:e=.5}=t;this.defines.ALPHA_CUTOFF=1,this.uniforms.u_AlphaCutoff=e}else"BLEND"===t.alphaMode&&(s.Rm.warn("BLEND alphaMode might not work well because it requires mesh sorting")(),Object.assign(this.parameters,{blend:!0,blendEquation:this.gl.FUNC_ADD,blendFunc:[this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA,this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA]}))}delete(){this.generatedTextures.forEach((t=>t.delete()))}}},8186:t=>{t.exports=function(t){if(!t||!t.type)return null;var n=e[t.type];return n?"geometry"===n?{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:t}]}:"feature"===n?{type:"FeatureCollection",features:[t]}:"featurecollection"===n?t:void 0:null};var e={Point:"geometry",MultiPoint:"geometry",LineString:"geometry",MultiLineString:"geometry",Polygon:"geometry",MultiPolygon:"geometry",GeometryCollection:"geometry",Feature:"feature",FeatureCollection:"featurecollection"}},4748:t=>{"use strict";function e(t,e){this.x=t,this.y=e}t.exports=e,e.prototype={clone:function(){return new e(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,n=t.y-this.y;return e*e+n*n},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[0]*this.x+t[1]*this.y,n=t[2]*this.x+t[3]*this.y;return this.x=e,this.y=n,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),n=Math.sin(t),r=e*this.x-n*this.y,i=n*this.x+e*this.y;return this.x=r,this.y=i,this},_rotateAround:function(t,e){var n=Math.cos(t),r=Math.sin(t),i=e.x+n*(this.x-e.x)-r*(this.y-e.y),o=e.y+r*(this.x-e.x)+n*(this.y-e.y);return this.x=i,this.y=o,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},e.convert=function(t){return t instanceof e?t:Array.isArray(t)?new e(t[0],t[1]):t}},94537:(t,e,n)=>{t.exports.VectorTile=n(37054),t.exports.VectorTileFeature=n(31110),t.exports.VectorTileLayer=n(16241)},37054:(t,e,n)=>{"use strict";var r=n(16241);function i(t,e,n){if(3===t){var i=new r(n,n.readVarint()+n.pos);i.length&&(e[i.name]=i)}}t.exports=function(t,e){this.layers=t.readFields(i,{},e)}},31110:(t,e,n)=>{"use strict";var r=n(4748);function i(t,e,n,r,i){this.properties={},this.extent=n,this.type=0,this._pbf=t,this._geometry=-1,this._keys=r,this._values=i,t.readFields(o,this,e)}function o(t,e,n){1==t?e.id=n.readVarint():2==t?function(t,e){for(var n=t.readVarint()+t.pos;t.pos<n;){var r=e._keys[t.readVarint()],i=e._values[t.readVarint()];e.properties[r]=i}}(n,e):3==t?e.type=n.readVarint():4==t&&(e._geometry=n.pos)}function s(t){for(var e,n,r=0,i=0,o=t.length,s=o-1;i<o;s=i++)e=t[i],r+=((n=t[s]).x-e.x)*(e.y+n.y);return r}t.exports=i,i.types=["Unknown","Point","LineString","Polygon"],i.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e,n=t.readVarint()+t.pos,i=1,o=0,s=0,a=0,l=[];t.pos<n;){if(o<=0){var u=t.readVarint();i=7&u,o=u>>3}if(o--,1===i||2===i)s+=t.readSVarint(),a+=t.readSVarint(),1===i&&(e&&l.push(e),e=[]),e.push(new r(s,a));else{if(7!==i)throw new Error("unknown command "+i);e&&e.push(e[0].clone())}}return e&&l.push(e),l},i.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,n=1,r=0,i=0,o=0,s=1/0,a=-1/0,l=1/0,u=-1/0;t.pos<e;){if(r<=0){var c=t.readVarint();n=7&c,r=c>>3}if(r--,1===n||2===n)(i+=t.readSVarint())<s&&(s=i),i>a&&(a=i),(o+=t.readSVarint())<l&&(l=o),o>u&&(u=o);else if(7!==n)throw new Error("unknown command "+n)}return[s,l,a,u]},i.prototype.toGeoJSON=function(t,e,n){var r,o,a=this.extent*Math.pow(2,n),l=this.extent*t,u=this.extent*e,c=this.loadGeometry(),h=i.types[this.type];function d(t){for(var e=0;e<t.length;e++){var n=t[e],r=180-360*(n.y+u)/a;t[e]=[360*(n.x+l)/a-180,360/Math.PI*Math.atan(Math.exp(r*Math.PI/180))-90]}}switch(this.type){case 1:var f=[];for(r=0;r<c.length;r++)f[r]=c[r][0];d(c=f);break;case 2:for(r=0;r<c.length;r++)d(c[r]);break;case 3:for(c=function(t){var e=t.length;if(e<=1)return[t];for(var n,r,i=[],o=0;o<e;o++){var a=s(t[o]);0!==a&&(void 0===r&&(r=a<0),r===a<0?(n&&i.push(n),n=[t[o]]):n.push(t[o]))}return n&&i.push(n),i}(c),r=0;r<c.length;r++)for(o=0;o<c[r].length;o++)d(c[r][o])}1===c.length?c=c[0]:h="Multi"+h;var p={type:"Feature",geometry:{type:h,coordinates:c},properties:this.properties};return"id"in this&&(p.id=this.id),p}},16241:(t,e,n)=>{"use strict";var r=n(31110);function i(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(o,this,e),this.length=this._features.length}function o(t,e,n){15===t?e.version=n.readVarint():1===t?e.name=n.readString():5===t?e.extent=n.readVarint():2===t?e._features.push(n.pos):3===t?e._keys.push(n.readString()):4===t&&e._values.push(function(t){for(var e=null,n=t.readVarint()+t.pos;t.pos<n;){var r=t.readVarint()>>3;e=1===r?t.readString():2===r?t.readFloat():3===r?t.readDouble():4===r?t.readVarint64():5===r?t.readVarint():6===r?t.readSVarint():7===r?t.readBoolean():null}return e}(n))}t.exports=i,i.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new r(this._pbf,e,this.extent,this._keys,this._values)}},50108:(t,e,n)=>{"use strict";n.d(e,{A:()=>h});var r,i=n(92129),o=n(66654),s=n(52760),a=n(91409),l=n(40842),u=n(30329);!function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL1ROW0=3]="COL1ROW0",t[t.COL1ROW1=4]="COL1ROW1",t[t.COL1ROW2=5]="COL1ROW2",t[t.COL2ROW0=6]="COL2ROW0",t[t.COL2ROW1=7]="COL2ROW1",t[t.COL2ROW2=8]="COL2ROW2"}(r||(r={}));const c=Object.freeze([1,0,0,0,1,0,0,0,1]);class h extends i.A{static get IDENTITY(){return f||(f=new h,Object.freeze(f)),f}static get ZERO(){return d||(d=new h([0,0,0,0,0,0,0,0,0]),Object.freeze(d)),d}get ELEMENTS(){return 9}get RANK(){return 3}get INDICES(){return r}constructor(t,...e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(t)?this.copy(t):e.length>0?this.copy([t,...e]):this.identity()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this.check()}identity(){return this.copy(c)}fromObject(t){return this.check()}fromQuaternion(t){return a.I0(this,t),this.check()}set(t,e,n,r,i,o,s,a,l){return this[0]=t,this[1]=e,this[2]=n,this[3]=r,this[4]=i,this[5]=o,this[6]=s,this[7]=a,this[8]=l,this.check()}setRowMajor(t,e,n,r,i,o,s,a,l){return this[0]=t,this[1]=r,this[2]=s,this[3]=e,this[4]=i,this[5]=a,this[6]=n,this[7]=o,this[8]=l,this.check()}determinant(){return a.a4(this)}transpose(){return a.mg(this,this),this.check()}invert(){return a.B8(this,this),this.check()}multiplyLeft(t){return a.lw(this,t,this),this.check()}multiplyRight(t){return a.lw(this,this,t),this.check()}rotate(t){return a.e$(this,this,t),this.check()}scale(t){return Array.isArray(t)?a.hs(this,this,t):a.hs(this,this,[t,t]),this.check()}translate(t){return a.Tl(this,this,t),this.check()}transform(t,e){let n;switch(t.length){case 2:n=l.ei(e||[-0,-0],t,this);break;case 3:n=u.ei(e||[-0,-0,-0],t,this);break;case 4:n=(0,s.vE)(e||[-0,-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return(0,o.qk)(n,t.length),n}transformVector(t,e){return this.transform(t,e)}transformVector2(t,e){return this.transform(t,e)}transformVector3(t,e){return this.transform(t,e)}}let d,f},5521:(t,e,n)=>{"use strict";n.d(e,{A:()=>S});var r=n(46094),i=n(66654),o=n(82251),s=n(17823),a=n(91409),l=n(30329),u=n(94796);function c(){var t=new s.tb(4);return s.tb!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function h(t,e,n){n*=.5;var r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t}function d(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=n[0],l=n[1],u=n[2],c=n[3];return t[0]=r*c+s*a+i*u-o*l,t[1]=i*c+s*l+o*a-r*u,t[2]=o*c+s*u+r*l-i*a,t[3]=s*c-r*a-i*l-o*u,t}u.o8,u.fA,u.C,u.hZ;var f,p,g,y=u.WQ,m=u.hs,v=u.Om,b=u.Cc,_=u.Bw,A=u.m3,x=u.S8,w=(u.t2,u.aI,f=l.vt(),p=l.fA(1,0,0),g=l.fA(0,1,0),function(t,e,n){var r=l.Om(e,n);return r<-.999999?(l.$A(f,p,e),l.Il(f)<1e-6&&l.$A(f,g,e),l.S8(f,f),h(t,f,Math.PI),t):r>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(l.$A(f,e,n),t[0]=f[0],t[1]=f[1],t[2]=f[2],t[3]=1+r,x(t,t))});c(),c(),a.vt();const C=[0,0,0,1];class S extends r.A{constructor(t=0,e=0,n=0,r=1){super(-0,-0,-0,-0),Array.isArray(t)&&1===arguments.length?this.copy(t):this.set(t,e,n,r)}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this.check()}set(t,e,n,r){return this[0]=t,this[1]=e,this[2]=n,this[3]=r,this.check()}fromObject(t){return this[0]=t.x,this[1]=t.y,this[2]=t.z,this[3]=t.w,this.check()}fromMatrix3(t){return function(t,e){var n,r=e[0]+e[4]+e[8];if(r>0)n=Math.sqrt(r+1),t[3]=.5*n,n=.5/n,t[0]=(e[5]-e[7])*n,t[1]=(e[6]-e[2])*n,t[2]=(e[1]-e[3])*n;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[3*i+i]&&(i=2);var o=(i+1)%3,s=(i+2)%3;n=Math.sqrt(e[3*i+i]-e[3*o+o]-e[3*s+s]+1),t[i]=.5*n,n=.5/n,t[3]=(e[3*o+s]-e[3*s+o])*n,t[o]=(e[3*o+i]+e[3*i+o])*n,t[s]=(e[3*s+i]+e[3*i+s])*n}}(this,t),this.check()}fromAxisRotation(t,e){return h(this,t,e),this.check()}identity(){var t;return(t=this)[0]=0,t[1]=0,t[2]=0,t[3]=1,this.check()}setAxisAngle(t,e){return this.fromAxisRotation(t,e)}get ELEMENTS(){return 4}get x(){return this[0]}set x(t){this[0]=(0,i.ws)(t)}get y(){return this[1]}set y(t){this[1]=(0,i.ws)(t)}get z(){return this[2]}set z(t){this[2]=(0,i.ws)(t)}get w(){return this[3]}set w(t){this[3]=(0,i.ws)(t)}len(){return _(this)}lengthSquared(){return A(this)}dot(t){return v(this,t)}rotationTo(t,e){return w(this,t,e),this.check()}add(t){return y(this,this,t),this.check()}calculateW(){var t,e,n,r;return t=this,e=this[0],n=this[1],r=this[2],t[0]=e,t[1]=n,t[2]=r,t[3]=Math.sqrt(Math.abs(1-e*e-n*n-r*r)),this.check()}conjugate(){var t,e;return e=this,(t=this)[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],this.check()}invert(){return function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],s=n*n+r*r+i*i+o*o,a=s?1/s:0;t[0]=-n*a,t[1]=-r*a,t[2]=-i*a,t[3]=o*a}(this,this),this.check()}lerp(t,e,n){return void 0===n?this.lerp(this,t,e):(b(this,t,e,n),this.check())}multiplyRight(t){return d(this,this,t),this.check()}multiplyLeft(t){return d(this,t,this),this.check()}normalize(){const t=this.len(),e=t>0?1/t:0;return this[0]=this[0]*e,this[1]=this[1]*e,this[2]=this[2]*e,this[3]=this[3]*e,0===t&&(this[3]=1),this.check()}rotateX(t){return function(t,e,n){n*=.5;var r=e[0],i=e[1],o=e[2],s=e[3],a=Math.sin(n),l=Math.cos(n);t[0]=r*l+s*a,t[1]=i*l+o*a,t[2]=o*l-i*a,t[3]=s*l-r*a}(this,this,t),this.check()}rotateY(t){return function(t,e,n){n*=.5;var r=e[0],i=e[1],o=e[2],s=e[3],a=Math.sin(n),l=Math.cos(n);t[0]=r*l-o*a,t[1]=i*l+s*a,t[2]=o*l+r*a,t[3]=s*l-i*a}(this,this,t),this.check()}rotateZ(t){return function(t,e,n){n*=.5;var r=e[0],i=e[1],o=e[2],s=e[3],a=Math.sin(n),l=Math.cos(n);t[0]=r*l+i*a,t[1]=i*l-r*a,t[2]=o*l+s*a,t[3]=s*l-o*a}(this,this,t),this.check()}scale(t){return m(this,this,t),this.check()}slerp(t,e,n){let r,i,o;switch(arguments.length){case 1:({start:r=C,target:i,ratio:o}=t);break;case 2:r=this,i=t,o=e;break;default:r=t,i=e,o=n}return a=this,u=i,c=o,y=(l=r)[0],m=l[1],v=l[2],b=l[3],_=u[0],A=u[1],x=u[2],w=u[3],(d=y*_+m*A+v*x+b*w)<0&&(d=-d,_=-_,A=-A,x=-x,w=-w),1-d>s.p8?(h=Math.acos(d),f=Math.sin(h),p=Math.sin((1-c)*h)/f,g=Math.sin(c*h)/f):(p=1-c,g=c),a[0]=p*y+g*_,a[1]=p*m+g*A,a[2]=p*v+g*x,a[3]=p*b+g*w,this.check();var a,l,u,c,h,d,f,p,g,y,m,v,b,_,A,x,w}transformVector4(t,e=new o.A){return u.gL(e,t,this),(0,i.qk)(e,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(t,e){return this.setAxisAngle(t,e)}premultiply(t){return this.multiplyLeft(t)}multiply(t){return this.multiplyRight(t)}}},27539:(t,e,n)=>{"use strict";n.d(e,{A:()=>l});var r=n(67136),i=n(22466),o=n(54692),s=n(30329);const a=1e-6;class l{constructor({phi:t=0,theta:e=0,radius:n=1,bearing:i,pitch:o,altitude:s,radiusScale:a=6371e3}={}){(0,r.A)(this,"phi",void 0),(0,r.A)(this,"theta",void 0),(0,r.A)(this,"radius",void 0),(0,r.A)(this,"radiusScale",void 0),this.phi=t,this.theta=e,this.radius=n||s||1,this.radiusScale=a||1,void 0!==i&&(this.bearing=i),void 0!==o&&(this.pitch=o),this.check()}toString(){return this.formatString(o.$W)}formatString({printTypes:t=!1}){const e=o.Fl;return"".concat(t?"Spherical":"","[rho:").concat(e(this.radius),",theta:").concat(e(this.theta),",phi:").concat(e(this.phi),"]")}equals(t){return(0,o.aI)(this.radius,t.radius)&&(0,o.aI)(this.theta,t.theta)&&(0,o.aI)(this.phi,t.phi)}exactEquals(t){return this.radius===t.radius&&this.theta===t.theta&&this.phi===t.phi}get bearing(){return 180-(0,o.uj)(this.phi)}set bearing(t){this.phi=Math.PI-(0,o.F2)(t)}get pitch(){return(0,o.uj)(this.theta)}set pitch(t){this.theta=(0,o.F2)(t)}get longitude(){return(0,o.uj)(this.phi)}get latitude(){return(0,o.uj)(this.theta)}get lng(){return(0,o.uj)(this.phi)}get lat(){return(0,o.uj)(this.theta)}get z(){return(this.radius-1)*this.radiusScale}set(t,e,n){return this.radius=t,this.phi=e,this.theta=n,this.check()}clone(){return(new l).copy(this)}copy(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this.check()}fromLngLatZ([t,e,n]){return this.radius=1+n/this.radiusScale,this.phi=(0,o.F2)(e),this.theta=(0,o.F2)(t),this.check()}fromVector3(t){return this.radius=s.Bw(t),this.radius>0&&(this.theta=Math.atan2(t[0],t[1]),this.phi=Math.acos((0,o.qE)(t[2]/this.radius,-1,1))),this.check()}toVector3(){return new i.A(0,0,this.radius).rotateX({radians:this.theta}).rotateZ({radians:this.phi})}makeSafe(){return this.phi=Math.max(a,Math.min(Math.PI-a,this.phi)),this}check(){if(!(Number.isFinite(this.phi)&&Number.isFinite(this.theta)&&this.radius>0))throw new Error("SphericalCoordinates: some fields set to invalid numbers");return this}}},90353:(t,e,n)=>{"use strict";n.d(e,{A:()=>l});var r=n(7295),i=n(54692),o=n(66654),s=n(40842),a=n(52760);class l extends r.A{constructor(t=0,e=0){super(2),(0,i.cy)(t)&&1===arguments.length?this.copy(t):(i.$W.debug&&((0,o.ws)(t),(0,o.ws)(e)),this[0]=t,this[1]=e)}set(t,e){return this[0]=t,this[1]=e,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this.check()}fromObject(t){return i.$W.debug&&((0,o.ws)(t.x),(0,o.ws)(t.y)),this[0]=t.x,this[1]=t.y,this.check()}toObject(t){return t.x=this[0],t.y=this[1],t}get ELEMENTS(){return 2}horizontalAngle(){return Math.atan2(this.y,this.x)}verticalAngle(){return Math.atan2(this.x,this.y)}transform(t){return this.transformAsPoint(t)}transformAsPoint(t){return s.Z0(this,this,t),this.check()}transformAsVector(t){return(0,a.B$)(this,this,t),this.check()}transformByMatrix3(t){return s.ei(this,this,t),this.check()}transformByMatrix2x3(t){return s.l0(this,this,t),this.check()}transformByMatrix2(t){return s.ZF(this,this,t),this.check()}}},82251:(t,e,n)=>{"use strict";n.d(e,{A:()=>u});var r=n(7295),i=n(54692),o=n(66654),s=n(30329),a=n(52760);let l;class u extends r.A{static get ZERO(){return l||(l=new u(0,0,0,0),Object.freeze(l)),l}constructor(t=0,e=0,n=0,r=0){super(-0,-0,-0,-0),(0,i.cy)(t)&&1===arguments.length?this.copy(t):(i.$W.debug&&((0,o.ws)(t),(0,o.ws)(e),(0,o.ws)(n),(0,o.ws)(r)),this[0]=t,this[1]=e,this[2]=n,this[3]=r)}set(t,e,n,r){return this[0]=t,this[1]=e,this[2]=n,this[3]=r,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this.check()}fromObject(t){return i.$W.debug&&((0,o.ws)(t.x),(0,o.ws)(t.y),(0,o.ws)(t.z),(0,o.ws)(t.w)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this[3]=t.w,this}toObject(t){return t.x=this[0],t.y=this[1],t.z=this[2],t.w=this[3],t}get ELEMENTS(){return 4}get z(){return this[2]}set z(t){this[2]=(0,o.ws)(t)}get w(){return this[3]}set w(t){this[3]=(0,o.ws)(t)}transform(t){return s.Z0(this,this,t),this.check()}transformByMatrix3(t){return(0,a.vE)(this,this,t),this.check()}transformByMatrix2(t){return(0,a.Cg)(this,this,t),this.check()}transformByQuaternion(t){return s.gL(this,this,t),this.check()}applyMatrix4(t){return t.transform(this,this),this}}},33067:(t,e,n)=>{"use strict";n.d(e,{A:()=>r});const r={EPSILON1:.1,EPSILON2:.01,EPSILON3:.001,EPSILON4:1e-4,EPSILON5:1e-5,EPSILON6:1e-6,EPSILON7:1e-7,EPSILON8:1e-8,EPSILON9:1e-9,EPSILON10:1e-10,EPSILON11:1e-11,EPSILON12:1e-12,EPSILON13:1e-13,EPSILON14:1e-14,EPSILON15:1e-15,EPSILON16:1e-16,EPSILON17:1e-17,EPSILON18:1e-18,EPSILON19:1e-19,EPSILON20:1e-20,PI_OVER_TWO:Math.PI/2,PI_OVER_FOUR:Math.PI/4,PI_OVER_SIX:Math.PI/6,TWO_PI:2*Math.PI}},34439:(t,e,n)=>{"use strict";n.d(e,{rJ:()=>r,wk:()=>G,Eg:()=>J,Mk:()=>D,Iy:()=>W,hY:()=>s,IC:()=>o,UD:()=>i});const r={CLOCKWISE:1,COUNTER_CLOCKWISE:-1};function i(t,e,n={}){const r=function(t,e={}){return Math.sign(o(t,e))}(t,n);return r!==e&&(function(t,e){const{start:n=0,end:r=t.length,size:i=2}=e,o=(r-n)/i,s=Math.floor(o/2);for(let e=0;e<s;++e){const r=n+e*i,s=n+(o-1-e)*i;for(let e=0;e<i;++e){const n=t[r+e];t[r+e]=t[s+e],t[s+e]=n}}}(t,n),!0)}function o(t,e={}){const{start:n=0,end:r=t.length}=e,i=e.size||2;let o=0;for(let e=n,s=r-i;e<r;e+=i)o+=(t[e]-t[s])*(t[e+1]+t[s+1]),s=e;return o/2}function s(t,e,n=2,r){const i=e&&e.length,o=i?e[0]*n:t.length;let s=a(t,0,o,n,!0,r&&r[0]);const c=[];if(!s||s.next===s.prev)return c;let h,d,f,y,m,b,_;if(i&&(s=function(t,e,n,r,i){const o=[];let s,u,c,h,d;for(s=0,u=e.length;s<u;s++)c=e[s]*r,h=s<u-1?e[s+1]*r:t.length,d=a(t,c,h,r,!1,i&&i[s+1]),d===d.next&&(d.steiner=!0),o.push(v(d));for(o.sort(p),s=0;s<o.length;s++)g(o[s],n),n=l(n,n.next);return n}(t,e,s,n,r)),t.length>80*n){y=d=t[0],m=f=t[1];for(let e=n;e<o;e+=n)b=t[e],_=t[e+1],b<y&&(y=b),_<m&&(m=_),b>d&&(d=b),_>f&&(f=_);h=Math.max(d-y,f-m),h=0!==h?1/h:0}return u(s,c,n,y,m,h),c}function a(t,e,n,r,i,s){let a,l;if(void 0===s&&(s=o(t,{start:e,end:n,size:r})),i===s<0)for(a=e;a<n;a+=r)l=P(a,t[a],t[a+1],l);else for(a=n-r;a>=e;a-=r)l=P(a,t[a],t[a+1],l);return l&&x(l,l.next)&&(T(l),l=l.next),l}function l(t,e){if(!t)return t;e||(e=t);let n,r=t;do{if(n=!1,r.steiner||!x(r,r.next)&&0!==A(r.prev,r,r.next))r=r.next;else{if(T(r),r=e=r.prev,r===r.next)break;n=!0}}while(n||r!==e);return e}function u(t,e,n,r,i,o,s){if(!t)return;!s&&o&&function(t,e,n,r){let i=t;do{null===i.z&&(i.z=m(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,function(t){let e,n,r,i,o,s,a,l,u=1;do{for(i=t,t=null,l=null,r=0;i;){for(r++,s=i,o=0,n=0;n<u&&(o++,s=s.nextZ,s);n++);for(a=u;o>0||a>0&&s;)0!==o&&(0===a||!s||i.z<=s.z)?(e=i,i=i.nextZ,o--):(e=s,s=s.nextZ,a--),l?l.nextZ=e:t=e,e.prevZ=l,l=e;i=s}l.nextZ=null,u*=2}while(r>1)}(i)}(t,r,i,o);let a,p,g=t;for(;t.prev!==t.next;)if(a=t.prev,p=t.next,o?h(t,r,i,o):c(t))e.push(a.i/n),e.push(t.i/n),e.push(p.i/n),T(t),t=p.next,g=p.next;else if((t=p)===g){s?1===s?u(t=d(l(t),e,n),e,n,r,i,o,2):2===s&&f(t,e,n,r,i,o):u(l(t),e,n,r,i,o,1);break}}function c(t){const e=t.prev,n=t,r=t.next;if(A(e,n,r)>=0)return!1;let i=t.next.next;for(;i!==t.prev;){if(b(e.x,e.y,n.x,n.y,r.x,r.y,i.x,i.y)&&A(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function h(t,e,n,r){const i=t.prev,o=t,s=t.next;if(A(i,o,s)>=0)return!1;const a=i.x<o.x?i.x<s.x?i.x:s.x:o.x<s.x?o.x:s.x,l=i.y<o.y?i.y<s.y?i.y:s.y:o.y<s.y?o.y:s.y,u=i.x>o.x?i.x>s.x?i.x:s.x:o.x>s.x?o.x:s.x,c=i.y>o.y?i.y>s.y?i.y:s.y:o.y>s.y?o.y:s.y,h=m(a,l,e,n,r),d=m(u,c,e,n,r);let f=t.prevZ,p=t.nextZ;for(;f&&f.z>=h&&p&&p.z<=d;){if(f!==t.prev&&f!==t.next&&b(i.x,i.y,o.x,o.y,s.x,s.y,f.x,f.y)&&A(f.prev,f,f.next)>=0)return!1;if(f=f.prevZ,p!==t.prev&&p!==t.next&&b(i.x,i.y,o.x,o.y,s.x,s.y,p.x,p.y)&&A(p.prev,p,p.next)>=0)return!1;p=p.nextZ}for(;f&&f.z>=h;){if(f!==t.prev&&f!==t.next&&b(i.x,i.y,o.x,o.y,s.x,s.y,f.x,f.y)&&A(f.prev,f,f.next)>=0)return!1;f=f.prevZ}for(;p&&p.z<=d;){if(p!==t.prev&&p!==t.next&&b(i.x,i.y,o.x,o.y,s.x,s.y,p.x,p.y)&&A(p.prev,p,p.next)>=0)return!1;p=p.nextZ}return!0}function d(t,e,n){let r=t;do{const i=r.prev,o=r.next.next;!x(i,o)&&w(i,r,r.next,o)&&E(i,o)&&E(o,i)&&(e.push(i.i/n),e.push(r.i/n),e.push(o.i/n),T(r),T(r.next),r=t=o),r=r.next}while(r!==t);return l(r)}function f(t,e,n,r,i,o){let s=t;do{let t=s.next.next;for(;t!==s.prev;){if(s.i!==t.i&&_(s,t)){let a=M(s,t);return s=l(s,s.next),a=l(a,a.next),u(s,e,n,r,i,o),void u(a,e,n,r,i,o)}t=t.next}s=s.next}while(s!==t)}function p(t,e){return t.x-e.x}function g(t,e){if(e=function(t,e){let n=e;const r=t.x,i=t.y;let o,s=-1/0;do{if(i<=n.y&&i>=n.next.y&&n.next.y!==n.y){const t=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(t<=r&&t>s){if(s=t,t===r){if(i===n.y)return n;if(i===n.next.y)return n.next}o=n.x<n.next.x?n:n.next}}n=n.next}while(n!==e);if(!o)return null;if(r===s)return o;const a=o,l=o.x,u=o.y;let c,h=1/0;n=o;do{r>=n.x&&n.x>=l&&r!==n.x&&b(i<u?r:s,i,l,u,i<u?s:r,i,n.x,n.y)&&(c=Math.abs(i-n.y)/(r-n.x),E(n,t)&&(c<h||c===h&&(n.x>o.x||n.x===o.x&&y(o,n)))&&(o=n,h=c)),n=n.next}while(n!==a);return o}(t,e),e){const n=M(e,t);l(e,e.next),l(n,n.next)}}function y(t,e){return A(t.prev,t,e.prev)<0&&A(e.next,t,t.next)<0}function m(t,e,n,r,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*i)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*i)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function v(t){let e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function b(t,e,n,r,i,o,s,a){return(i-s)*(e-a)-(t-s)*(o-a)>=0&&(t-s)*(r-a)-(n-s)*(e-a)>=0&&(n-s)*(o-a)-(i-s)*(r-a)>=0}function _(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){let n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&w(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(E(t,e)&&E(e,t)&&function(t,e){let n=t,r=!1;const i=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)&&(A(t.prev,t,e.prev)||A(t,e.prev,e))||x(t,e)&&A(t.prev,t,t.next)>0&&A(e.prev,e,e.next)>0)}function A(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function x(t,e){return t.x===e.x&&t.y===e.y}function w(t,e,n,r){const i=S(A(t,e,n)),o=S(A(t,e,r)),s=S(A(n,r,t)),a=S(A(n,r,e));return i!==o&&s!==a||!(0!==i||!C(t,n,e))||!(0!==o||!C(t,r,e))||!(0!==s||!C(n,t,r))||!(0!==a||!C(n,e,r))}function C(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function S(t){return t>0?1:t<0?-1:0}function E(t,e){return A(t.prev,t,t.next)<0?A(t,e,t.next)>=0&&A(t,t.prev,e)>=0:A(t,e,t.prev)<0||A(t,t.next,e)<0}function M(t,e){const n=new O(t.i,t.x,t.y),r=new O(e.i,e.x,e.y),i=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function P(t,e,n,r){const i=new O(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function T(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function O(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function I(t,e,n,r,i=[]){let o,s;if(8&n)o=(r[3]-t[1])/(e[1]-t[1]),s=3;else if(4&n)o=(r[1]-t[1])/(e[1]-t[1]),s=1;else if(2&n)o=(r[2]-t[0])/(e[0]-t[0]),s=2;else{if(!(1&n))return null;o=(r[0]-t[0])/(e[0]-t[0]),s=0}for(let n=0;n<t.length;n++)i[n]=(1&s)===n?r[s]:o*(e[n]-t[n])+t[n];return i}function R(t,e){let n=0;return t[0]<e[0]?n|=1:t[0]>e[2]&&(n|=2),t[1]<e[1]?n|=4:t[1]>e[3]&&(n|=8),n}function B(t,e){const n=e.length,r=t.length;if(r>0){let i=!0;for(let o=0;o<n;o++)if(t[r-n+o]!==e[o]){i=!1;break}if(i)return!1}for(let i=0;i<n;i++)t[r+i]=e[i];return!0}function L(t,e){const n=e.length;for(let r=0;r<n;r++)t[r]=e[r]}function k(t,e,n,r,i=[]){const o=r+e*n;for(let e=0;e<n;e++)i[e]=t[o+e];return i}function D(t,e){const{size:n=2,broken:r=!1,gridResolution:i=10,gridOffset:o=[0,0],startIndex:s=0,endIndex:a=t.length}=e||{},l=(a-s)/n;let u=[];const c=[u],h=k(t,0,n,s);let d,f;const p=z(h,i,o,[]),g=[];B(u,h);for(let e=1;e<l;e++){for(d=k(t,e,n,s,d),f=R(d,p);f;){I(h,d,f,p,g);const t=R(g,p);t&&(I(h,g,t,p,g),f=t),B(u,g),L(h,g),V(p,i,f),r&&u.length>n&&(u=[],c.push(u),B(u,h)),f=R(d,p)}B(u,d),L(h,d)}return r?c:c[0]}const F=0,N=1;function j(t,e){for(let n=0;n<e.length;n++)t.push(e[n]);return t}function G(t,e=null,n){if(!t.length)return[];const{size:r=2,gridResolution:i=10,gridOffset:o=[0,0],edgeTypes:s=!1}=n||{},a=[],l=[{pos:t,types:s?new Array(t.length/r).fill(N):null,holes:e||[]}],u=[[],[]];let c=[];for(;l.length;){const{pos:t,types:e,holes:n}=l.shift();H(t,r,n[0]||t.length,u),c=z(u[0],i,o,c);const h=R(u[1],c);if(h){let i=U(t,e,r,0,n[0]||t.length,c,h);const o={pos:i[0].pos,types:i[0].types,holes:[]},a={pos:i[1].pos,types:i[1].types,holes:[]};l.push(o,a);for(let l=0;l<n.length;l++)i=U(t,e,r,n[l],n[l+1]||t.length,c,h),i[0]&&(o.holes.push(o.pos.length),o.pos=j(o.pos,i[0].pos),s&&(o.types=j(o.types,i[0].types))),i[1]&&(a.holes.push(a.pos.length),a.pos=j(a.pos,i[1].pos),s&&(a.types=j(a.types,i[1].types)))}else{const r={positions:t};s&&(r.edgeTypes=e),n.length&&(r.holeIndices=n),a.push(r)}}return a}function U(t,e,n,r,i,o,s){const a=(i-r)/n,l=[],u=[],c=[],h=[],d=[];let f,p,g;const y=k(t,a-1,n,r);let m=Math.sign(8&s?y[1]-o[3]:y[0]-o[2]),v=e&&e[a-1],b=0,_=0;for(let i=0;i<a;i++)f=k(t,i,n,r,f),p=Math.sign(8&s?f[1]-o[3]:f[0]-o[2]),g=e&&e[r/n+i],p&&m&&m!==p&&(I(y,f,s,o,d),B(l,d)&&c.push(v),B(u,d)&&h.push(v)),p<=0?(B(l,f)&&c.push(g),b-=p):c.length&&(c[c.length-1]=F),p>=0?(B(u,f)&&h.push(g),_+=p):h.length&&(h[h.length-1]=F),L(y,f),m=p,v=g;return[b?{pos:l,types:e&&c}:null,_?{pos:u,types:e&&h}:null]}function z(t,e,n,r){const i=Math.floor((t[0]-n[0])/e)*e+n[0],o=Math.floor((t[1]-n[1])/e)*e+n[1];return r[0]=i,r[1]=o,r[2]=i+e,r[3]=o+e,r}function V(t,e,n){8&n?(t[1]+=e,t[3]+=e):4&n?(t[1]-=e,t[3]-=e):2&n?(t[0]+=e,t[2]+=e):1&n&&(t[0]-=e,t[2]-=e)}function H(t,e,n,r){let i=1/0,o=-1/0,s=1/0,a=-1/0;for(let r=0;r<n;r+=e){const e=t[r],n=t[r+1];i=e<i?e:i,o=e>o?e:o,s=n<s?n:s,a=n>a?n:a}return r[0][0]=i,r[0][1]=s,r[1][0]=o,r[1][1]=a,r}const q=85.051129;function W(t,e){const{size:n=2,startIndex:r=0,endIndex:i=t.length,normalize:o=!0}=e||{},s=t.slice(r,i);K(s,n,0,i-r);const a=D(s,{size:n,broken:!0,gridResolution:360,gridOffset:[-180,-180]});if(o)for(const t of a)Z(t,n);return a}function J(t,e=null,n){const{size:r=2,normalize:i=!0,edgeTypes:o=!1}=n||{};e=e||[];const s=[],a=[];let l=0,u=0;for(let i=0;i<=e.length;i++){const o=e[i]||t.length,c=u,h=Y(t,r,l,o);for(let e=h;e<o;e++)s[u++]=t[e];for(let e=l;e<h;e++)s[u++]=t[e];K(s,r,c,u),X(s,r,c,u,null==n?void 0:n.maxLatitude),l=o,a[i]=u}a.pop();const c=G(s,a,{size:r,gridResolution:360,gridOffset:[-180,-180],edgeTypes:o});if(i)for(const t of c)Z(t.positions,r);return c}function Y(t,e,n,r){let i=-1,o=-1;for(let s=n+1;s<r;s+=e){const e=Math.abs(t[s]);e>i&&(i=e,o=s-1)}return o}function X(t,e,n,r,i=q){const o=t[n],s=t[r-e];if(Math.abs(o-s)>180){const r=k(t,0,e,n);r[0]+=360*Math.round((s-o)/360),B(t,r),r[1]=Math.sign(r[1])*i,B(t,r),r[0]=o,B(t,r)}}function K(t,e,n,r){let i,o=t[0];for(let s=n;s<r;s+=e){i=t[s];const e=i-o;(e>180||e<-180)&&(i-=360*Math.round(e/360)),t[s]=o=i}}function Z(t,e){let n;const r=t.length/e;for(let i=0;i<r&&(n=t[i*e],(n+180)%360==0);i++);const i=360*-Math.round(n/360);if(0!==i)for(let n=0;n<r;n++)t[n*e]+=i}},649:(t,e,n)=>{"use strict";n.r(e),n.d(e,{MAX_LATITUDE:()=>b,WebMercatorViewport:()=>G,addMetersToLngLat:()=>P,altitudeToFovy:()=>R,default:()=>G,fitBounds:()=>D,flyToViewport:()=>W,fovyToAltitude:()=>B,getBounds:()=>N,getDistanceScales:()=>M,getFlyToDuration:()=>J,getMeterZoom:()=>S,getProjectionMatrix:()=>I,getProjectionParameters:()=>O,getViewMatrix:()=>T,lngLatToWorld:()=>w,normalizeViewportProps:()=>z,pixelsToWorld:()=>k,scaleToZoom:()=>x,unitsPerMeter:()=>E,worldToLngLat:()=>C,worldToPixels:()=>L,zoomToScale:()=>A});var r=n(67136),i=n(94796);function o(t,e){const n=(0,i.Z0)([],e,t);return(0,i.hs)(n,n,1/n[3]),n}function s(t,e){const n=t%e;return n<0?e+n:n}function a(t,e,n){return t<e?e:t>n?n:t}const l=Math.log2||function(t){return Math.log(t)*Math.LOG2E};var u=n(67684),c=n(40842),h=n(30329);function d(t,e){if(!t)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const f=Math.PI,p=f/4,g=f/180,y=180/f,m=512,v=4003e4,b=85.051129,_=1.5;function A(t){return Math.pow(2,t)}function x(t){return l(t)}function w(t){const[e,n]=t;d(Number.isFinite(e)),d(Number.isFinite(n)&&n>=-90&&n<=90,"invalid latitude");const r=n*g;return[m*(e*g+f)/(2*f),m*(f+Math.log(Math.tan(p+.5*r)))/(2*f)]}function C(t){const[e,n]=t,r=e/m*(2*f)-f,i=2*(Math.atan(Math.exp(n/m*(2*f)-f))-p);return[r*y,i*y]}function S(t){const{latitude:e}=t;d(Number.isFinite(e));const n=Math.cos(e*g);return x(v*n)-9}function E(t){const e=Math.cos(t*g);return m/v/e}function M(t){const{latitude:e,longitude:n,highPrecision:r=!1}=t;d(Number.isFinite(e)&&Number.isFinite(n));const i=m,o=Math.cos(e*g),s=i/360,a=s/o,l=i/v/o,u={unitsPerMeter:[l,l,l],metersPerUnit:[1/l,1/l,1/l],unitsPerDegree:[s,a,l],degreesPerUnit:[1/s,1/a,1/l]};if(r){const t=g*Math.tan(e*g)/o,n=s*t/2,r=i/v*t,c=r/a*l;u.unitsPerDegree2=[0,n,r],u.unitsPerMeter2=[c,0,c]}return u}function P(t,e){const[n,r,i]=t,[o,s,a]=e,{unitsPerMeter:l,unitsPerMeter2:u}=M({longitude:n,latitude:r,highPrecision:!0}),c=w(t);c[0]+=o*(l[0]+u[0]*s),c[1]+=s*(l[1]+u[1]*s);const h=C(c),d=(i||0)+(a||0);return Number.isFinite(i)||Number.isFinite(a)?[h[0],h[1],d]:h}function T(t){const{height:e,pitch:n,bearing:r,altitude:i,scale:o,center:s}=t,a=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];u.Tl(a,a,[0,0,-i]),u.eL(a,a,-n*g),u.Qr(a,a,r*g);const l=o/e;return u.hs(a,a,[l,l,l]),s&&u.Tl(a,a,h.ze([],s)),a}function O(t){const{width:e,height:n,altitude:r,pitch:i=0,offset:o,center:s,scale:l,nearZMultiplier:u=1,farZMultiplier:c=1}=t;let{fovy:h=R(_)}=t;void 0!==r&&(h=R(r));const d=h*g,f=i*g,p=B(h);let y=p;s&&(y+=s[2]*l/Math.cos(f)/n);const m=d*(.5+(o?o[1]:0)/n),v=Math.sin(m)*y/Math.sin(a(Math.PI/2-f-m,.01,Math.PI-.01)),b=Math.sin(f)*v+y,A=10*y;return{fov:d,aspect:e/n,focalDistance:p,near:u,far:Math.min(b*c,A)}}function I(t){const{fov:e,aspect:n,near:r,far:i}=O(t);return u.fN([],e,n,r,i)}function R(t){return 2*Math.atan(.5/t)*y}function B(t){return.5/Math.tan(.5*t*g)}function L(t,e){const[n,r,i=0]=t;return d(Number.isFinite(n)&&Number.isFinite(r)&&Number.isFinite(i)),o(e,[n,r,i,1])}function k(t,e,n=0){const[r,i,s]=t;if(d(Number.isFinite(r)&&Number.isFinite(i),"invalid pixel coordinate"),Number.isFinite(s))return o(e,[r,i,s,1]);const a=o(e,[r,i,0,1]),l=o(e,[r,i,1,1]),u=a[2],h=l[2],f=u===h?0:((n||0)-u)/(h-u);return c.Cc([],a,l,f)}function D(t){const{width:e,height:n,bounds:r,minExtent:i=0,maxZoom:o=24,offset:s=[0,0]}=t,[[u,c],[h,f]]=r,p=function(t=0){return"number"==typeof t?{top:t,bottom:t,left:t,right:t}:(d(Number.isFinite(t.top)&&Number.isFinite(t.bottom)&&Number.isFinite(t.left)&&Number.isFinite(t.right)),t)}(t.padding),g=w([u,a(f,-b,b)]),y=w([h,a(c,-b,b)]),m=[Math.max(Math.abs(y[0]-g[0]),i),Math.max(Math.abs(y[1]-g[1]),i)],v=[e-p.left-p.right-2*Math.abs(s[0]),n-p.top-p.bottom-2*Math.abs(s[1])];d(v[0]>0&&v[1]>0);const _=v[0]/m[0],A=v[1]/m[1],x=(p.right-p.left)/2/_,S=(p.top-p.bottom)/2/A,E=C([(y[0]+g[0])/2+x,(y[1]+g[1])/2+S]),M=Math.min(o,l(Math.abs(Math.min(_,A))));return d(Number.isFinite(M)),{longitude:E[0],latitude:E[1],zoom:M}}const F=Math.PI/180;function N(t,e=0){const{width:n,height:r,unproject:i}=t,o={targetZ:e},s=i([0,r],o),a=i([n,r],o);let l,u;return(t.fovy?.5*t.fovy*F:Math.atan(.5/t.altitude))>(90-t.pitch)*F-.01?(l=j(t,0,e),u=j(t,n,e)):(l=i([0,0],o),u=i([n,0],o)),[s,a,u,l]}function j(t,e,n){const{pixelUnprojectionMatrix:r}=t,i=o(r,[e,0,1,1]),s=o(r,[e,t.height,1,1]),a=(n*t.distanceScales.unitsPerMeter[2]-i[2])/(s[2]-i[2]),l=C(c.Cc([],i,s,a));return l.push(n),l}class G{constructor(t={width:1,height:1}){(0,r.A)(this,"latitude",void 0),(0,r.A)(this,"longitude",void 0),(0,r.A)(this,"zoom",void 0),(0,r.A)(this,"pitch",void 0),(0,r.A)(this,"bearing",void 0),(0,r.A)(this,"altitude",void 0),(0,r.A)(this,"fovy",void 0),(0,r.A)(this,"meterOffset",void 0),(0,r.A)(this,"center",void 0),(0,r.A)(this,"width",void 0),(0,r.A)(this,"height",void 0),(0,r.A)(this,"scale",void 0),(0,r.A)(this,"distanceScales",void 0),(0,r.A)(this,"viewMatrix",void 0),(0,r.A)(this,"projectionMatrix",void 0),(0,r.A)(this,"viewProjectionMatrix",void 0),(0,r.A)(this,"pixelProjectionMatrix",void 0),(0,r.A)(this,"pixelUnprojectionMatrix",void 0),(0,r.A)(this,"equals",(t=>t instanceof G&&t.width===this.width&&t.height===this.height&&u.aI(t.projectionMatrix,this.projectionMatrix)&&u.aI(t.viewMatrix,this.viewMatrix))),(0,r.A)(this,"project",((t,e={})=>{const{topLeft:n=!0}=e,r=L(this.projectPosition(t),this.pixelProjectionMatrix),[i,o]=r,s=n?o:this.height-o;return 2===t.length?[i,s]:[i,s,r[2]]})),(0,r.A)(this,"unproject",((t,e={})=>{const{topLeft:n=!0,targetZ:r}=e,[i,o,s]=t,a=n?o:this.height-o,l=r&&r*this.distanceScales.unitsPerMeter[2],u=k([i,a,s],this.pixelUnprojectionMatrix,l),[c,h,d]=this.unprojectPosition(u);return Number.isFinite(s)?[c,h,d]:Number.isFinite(r)?[c,h,r]:[c,h]})),(0,r.A)(this,"projectPosition",(t=>{const[e,n]=w(t);return[e,n,(t[2]||0)*this.distanceScales.unitsPerMeter[2]]})),(0,r.A)(this,"unprojectPosition",(t=>{const[e,n]=C(t);return[e,n,(t[2]||0)*this.distanceScales.metersPerUnit[2]]}));let{width:e,height:n,altitude:i=null,fovy:o=null}=t;const{latitude:s=0,longitude:a=0,zoom:l=0,pitch:c=0,bearing:d=0,position:f=null,nearZMultiplier:p=.02,farZMultiplier:g=1.01}=t;e=e||1,n=n||1,null===o&&null===i?(i=_,o=R(i)):null===o?o=R(i):null===i&&(i=B(o));const y=A(l);i=Math.max(.75,i);const m=M({longitude:a,latitude:s}),v=w([a,s]);v.push(0),f&&h.WQ(v,v,h.lK([],f,m.unitsPerMeter)),this.projectionMatrix=I({width:e,height:n,scale:y,center:v,pitch:c,fovy:o,nearZMultiplier:p,farZMultiplier:g}),this.viewMatrix=T({height:n,scale:y,center:v,pitch:c,bearing:d,altitude:i}),this.width=e,this.height=n,this.scale=y,this.latitude=s,this.longitude=a,this.zoom=l,this.pitch=c,this.bearing=d,this.altitude=i,this.fovy=o,this.center=v,this.meterOffset=f||[0,0,0],this.distanceScales=m,this._initMatrices(),Object.freeze(this)}_initMatrices(){const{width:t,height:e,projectionMatrix:n,viewMatrix:r}=this,i=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];u.lw(i,i,n),u.lw(i,i,r),this.viewProjectionMatrix=i;const o=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];u.hs(o,o,[t/2,-e/2,1]),u.Tl(o,o,[1,-1,0]),u.lw(o,o,i);const s=u.B8([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],o);if(!s)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=o,this.pixelUnprojectionMatrix=s}projectFlat(t){return w(t)}unprojectFlat(t){return C(t)}getMapCenterByLngLatPosition({lngLat:t,pos:e}){const n=k(e,this.pixelUnprojectionMatrix),r=w(t),i=c.WQ([],r,c.ze([],n));return C(c.WQ([],this.center,i))}fitBounds(t,e={}){const{width:n,height:r}=this,{longitude:i,latitude:o,zoom:s}=D(Object.assign({width:n,height:r,bounds:t},e));return new G({width:n,height:r,longitude:i,latitude:o,zoom:s})}getBounds(t){const e=this.getBoundingRegion(t),n=Math.min(...e.map((t=>t[0]))),r=Math.max(...e.map((t=>t[0])));return[[n,Math.min(...e.map((t=>t[1])))],[r,Math.max(...e.map((t=>t[1])))]]}getBoundingRegion(t={}){return N(this,t.z||0)}getLocationAtPoint({lngLat:t,pos:e}){return this.getMapCenterByLngLatPosition({lngLat:t,pos:e})}}const U=512;function z(t){const{width:e,height:n,pitch:r=0}=t;let{longitude:i,latitude:o,zoom:a,bearing:u=0}=t;(i<-180||i>180)&&(i=s(i+180,360)-180),(u<-180||u>180)&&(u=s(u+180,360)-180);const c=l(n/U);if(a<=c)a=c,o=0;else{const t=n/2/Math.pow(2,a),e=C([0,t])[1];if(o<e)o=e;else{const e=C([0,U-t])[1];o>e&&(o=e)}}return{width:e,height:n,longitude:i,latitude:o,zoom:a,pitch:r,bearing:u}}const V=.01,H=["longitude","latitude","zoom"],q={curve:1.414,speed:1.2};function W(t,e,n,r){const{startZoom:i,startCenterXY:o,uDelta:s,w0:a,u1:l,S:u,rho:h,rho2:d,r0:f}=Y(t,e,r);if(l<V){const r={};for(const i of H){const o=t[i],s=e[i];r[i]=(p=n)*s+(1-p)*o}return r}var p;const g=n*u,y=Math.cosh(f)/Math.cosh(f+h*g),m=a*((Math.cosh(f)*Math.tanh(f+h*g)-Math.sinh(f))/d)/l,v=i+x(1/y),b=c.hs([],s,m);c.WQ(b,b,o);const _=C(b);return{longitude:_[0],latitude:_[1],zoom:v}}function J(t,e,n){const r={...q,...n},{screenSpeed:i,speed:o,maxDuration:s}=r,{S:a,rho:l}=Y(t,e,r),u=1e3*a;let c;return c=Number.isFinite(i)?u/(i/l):u/o,Number.isFinite(s)&&c>s?0:c}function Y(t,e,n){const r=(n=Object.assign({},q,n)).curve,i=t.zoom,o=[t.longitude,t.latitude],s=A(i),a=e.zoom,l=[e.longitude,e.latitude],u=A(a-i),h=w(o),d=w(l),f=c.jb([],d,h),p=Math.max(t.width,t.height),g=p/u,y=c.Bw(f)*s,m=Math.max(y,V),v=r*r,b=(g*g-p*p+v*v*m*m)/(2*p*v*m),_=(g*g-p*p-v*v*m*m)/(2*g*v*m),x=Math.log(Math.sqrt(b*b+1)-b),C=Math.log(Math.sqrt(_*_+1)-_);return{startZoom:i,startCenterXY:h,uDelta:f,w0:p,u1:y,S:(C-x)/r,rho:r,rho2:v,r0:x,r1:C}}},13343:(t,e,n)=>{"use strict";function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"GeoJsonEditMode",{enumerable:!0,get:function(){return o.GeoJsonEditMode}}),Object.defineProperty(e,"ModifyMode",{enumerable:!0,get:function(){return s.ModifyMode}}),Object.defineProperty(e,"ResizeCircleMode",{enumerable:!0,get:function(){return a.ResizeCircleMode}}),Object.defineProperty(e,"TranslateMode",{enumerable:!0,get:function(){return l.TranslateMode}}),Object.defineProperty(e,"ScaleMode",{enumerable:!0,get:function(){return u.ScaleMode}}),Object.defineProperty(e,"RotateMode",{enumerable:!0,get:function(){return c.RotateMode}}),Object.defineProperty(e,"DuplicateMode",{enumerable:!0,get:function(){return h.DuplicateMode}}),Object.defineProperty(e,"ExtendLineStringMode",{enumerable:!0,get:function(){return d.ExtendLineStringMode}}),Object.defineProperty(e,"SplitPolygonMode",{enumerable:!0,get:function(){return f.SplitPolygonMode}}),Object.defineProperty(e,"ExtrudeMode",{enumerable:!0,get:function(){return p.ExtrudeMode}}),Object.defineProperty(e,"ElevationMode",{enumerable:!0,get:function(){return g.ElevationMode}}),Object.defineProperty(e,"TransformMode",{enumerable:!0,get:function(){return y.TransformMode}}),Object.defineProperty(e,"DrawPointMode",{enumerable:!0,get:function(){return m.DrawPointMode}}),Object.defineProperty(e,"DrawLineStringMode",{enumerable:!0,get:function(){return v.DrawLineStringMode}}),Object.defineProperty(e,"DrawPolygonMode",{enumerable:!0,get:function(){return b.DrawPolygonMode}}),Object.defineProperty(e,"DrawRectangleMode",{enumerable:!0,get:function(){return _.DrawRectangleMode}}),Object.defineProperty(e,"DrawRectangleFromCenterMode",{enumerable:!0,get:function(){return A.DrawRectangleFromCenterMode}}),Object.defineProperty(e,"DrawSquareFromCenterMode",{enumerable:!0,get:function(){return x.DrawSquareFromCenterMode}}),Object.defineProperty(e,"DrawCircleByDiameterMode",{enumerable:!0,get:function(){return w.DrawCircleByDiameterMode}}),Object.defineProperty(e,"DrawCircleFromCenterMode",{enumerable:!0,get:function(){return C.DrawCircleFromCenterMode}}),Object.defineProperty(e,"DrawEllipseByBoundingBoxMode",{enumerable:!0,get:function(){return S.DrawEllipseByBoundingBoxMode}}),Object.defineProperty(e,"DrawEllipseUsingThreePointsMode",{enumerable:!0,get:function(){return E.DrawEllipseUsingThreePointsMode}}),Object.defineProperty(e,"DrawRectangleUsingThreePointsMode",{enumerable:!0,get:function(){return M.DrawRectangleUsingThreePointsMode}}),Object.defineProperty(e,"Draw90DegreePolygonMode",{enumerable:!0,get:function(){return P.Draw90DegreePolygonMode}}),Object.defineProperty(e,"DrawPolygonByDraggingMode",{enumerable:!0,get:function(){return T.DrawPolygonByDraggingMode}}),Object.defineProperty(e,"ImmutableFeatureCollection",{enumerable:!0,get:function(){return O.ImmutableFeatureCollection}}),Object.defineProperty(e,"ViewMode",{enumerable:!0,get:function(){return I.ViewMode}}),Object.defineProperty(e,"MeasureDistanceMode",{enumerable:!0,get:function(){return R.MeasureDistanceMode}}),Object.defineProperty(e,"MeasureAreaMode",{enumerable:!0,get:function(){return B.MeasureAreaMode}}),Object.defineProperty(e,"MeasureAngleMode",{enumerable:!0,get:function(){return L.MeasureAngleMode}}),Object.defineProperty(e,"CompositeMode",{enumerable:!0,get:function(){return k.CompositeMode}}),Object.defineProperty(e,"SnappableMode",{enumerable:!0,get:function(){return D.SnappableMode}}),Object.defineProperty(e,"_memoize",{enumerable:!0,get:function(){return F.default}}),e.utils=void 0;var i,o=n(22861),s=n(70365),a=n(77970),l=n(99461),u=n(56585),c=n(62458),h=n(18144),d=n(44112),f=n(17186),p=n(27884),g=n(64290),y=n(64639),m=n(77384),v=n(32530),b=n(83136),_=n(68069),A=n(5503),x=n(7940),w=n(51826),C=n(24293),S=n(35895),E=n(94402),M=n(54965),P=n(27046),T=n(18332),O=n(96397),I=n(81872),R=n(4987),B=n(52929),L=n(6365),k=n(14646),D=n(46279),F=(i=n(67095))&&i.__esModule?i:{default:i},N=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==r(t)&&"function"!=typeof t)return{default:t};var e=j();if(e&&e.has(t))return e.get(t);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)){var s=i?Object.getOwnPropertyDescriptor(t,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=t[o]}return n.default=t,e&&e.set(t,n),n}(n(5050));function j(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return j=function(){return t},t}e.utils=N},14646:(t,e,n)=>{"use strict";function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function i(t,e){if(t){if("string"==typeof t)return o(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(t,e):void 0}}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l(t){return l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},l(t)}function u(t,e){return u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},u(t,e)}Object.defineProperty(e,"__esModule",{value:!0}),e.CompositeMode=void 0;var c=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(d,t);var e,n,c,h=(c=d,function(){var t,e=l(c);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}()){var n=l(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?a(t):e}(this,t)});function d(t){var e,n,r,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,d),i=void 0,(r="_modes")in(n=a(e=h.call(this)))?Object.defineProperty(n,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[r]=i,e._modes=t,e}return e=d,n=[{key:"_coalesce",value:function(t){for(var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=0;r<this._modes.length&&(e=t(this._modes[r]),!(n?n(e):e));r++);return e}},{key:"handleClick",value:function(t,e){this._coalesce((function(n){return n.handleClick(t,e)}))}},{key:"handlePointerMove",value:function(t,e){return this._coalesce((function(n){return n.handlePointerMove(t,e)}))}},{key:"handleStartDragging",value:function(t,e){return this._coalesce((function(n){return n.handleStartDragging(t,e)}))}},{key:"handleStopDragging",value:function(t,e){return this._coalesce((function(n){return n.handleStopDragging(t,e)}))}},{key:"handleDragging",value:function(t,e){return this._coalesce((function(n){return n.handleDragging(t,e)}))}},{key:"getGuides",value:function(t){var e,n,r=[],s=function(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=i(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o,s=!0,a=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return s=t.done,t},e:function(t){a=!0,o=t},f:function(){try{s||null==r.return||r.return()}finally{if(a)throw o}}}}(this._modes);try{for(s.s();!(e=s.n()).done;){var a=e.value;r.push.apply(r,function(t){if(Array.isArray(t))return o(t)}(n=a.getGuides(t).features)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(n)||i(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())}}catch(t){s.e(t)}finally{s.f()}return{type:"FeatureCollection",features:r}}}],n&&s(e.prototype,n),d}(n(22861).GeoJsonEditMode);e.CompositeMode=c},27046:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Draw90DegreePolygonMode=void 0;var r=u(n(92091)),i=u(n(17021)),o=u(n(38937)),s=u(n(78208)),a=n(85846),l=n(5050);function u(t){return t&&t.__esModule?t:{default:t}}function c(t){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c(t)}function h(t){return function(t){if(Array.isArray(t))return f(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||d(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(t,e){if(t){if("string"==typeof t)return f(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(t,e):void 0}}function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function p(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function g(t,e,n){return g="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=y(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}},g(t,e,n||t)}function y(t){return y=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},y(t)}function m(t,e){return m=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},m(t,e)}var v=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&m(t,e)}(v,t);var e,n,u,f=(u=v,function(){var t,e=y(u);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}()){var n=y(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){return!e||"object"!==c(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,t)});function v(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,v),f.apply(this,arguments)}return e=v,(n=[{key:"createTentativeFeature",value:function(t){var e,n,r,i=this.getClickSequence(),o=t.lastPointerMoveEvent.mapCoords;if(1===i.length)e=o;else{var s=i[i.length-2],a=i[i.length-1];e=(n=(0,l.generatePointsParallelToLinePoints)(s,a,o),r=1,function(t){if(Array.isArray(t))return t}(n)||function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}}(n,r)||d(n,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0]}return i.length<3?{type:"Feature",properties:{guideType:"tentative"},geometry:{type:"LineString",coordinates:[].concat(h(i),[e])}}:{type:"Feature",properties:{guideType:"tentative"},geometry:{type:"Polygon",coordinates:[[].concat(h(i),[e,i[0]])]}}}},{key:"getGuides",value:function(t){var e={type:"FeatureCollection",features:[]};if(0===this.getClickSequence().length||!t.lastPointerMoveEvent)return e;var n=this.createTentativeFeature(t);return e.features.push(n),e.features=e.features.concat((0,l.getEditHandlesForGeometry)(n.geometry,-1)),e.features=e.features.slice(0,-1),e}},{key:"handlePointerMove",value:function(t,e){e.onUpdateCursor("cell"),g(y(v.prototype),"handlePointerMove",this).call(this,t,e)}},{key:"handleClick",value:function(t,e){var n=t.picks,r=this.getTentativeGuide(e);this.addClickSequence(t);var i=this.getClickSequence();if(r){if(3===i.length&&"LineString"===r.geometry.type){var o=r.geometry;i[i.length-1]=o.coordinates[o.coordinates.length-1]}else if(i.length>3&&"Polygon"===r.geometry.type){var s=r.geometry;i[i.length-1]=s.coordinates[0][s.coordinates[0].length-2];var a=(0,l.getPickedEditHandle)(n);if(a&&Array.isArray(a.properties.positionIndexes)&&(0===a.properties.positionIndexes[1]||a.properties.positionIndexes[1]===s.coordinates[0].length-3)){var u={type:"Polygon",coordinates:this.finalizedCoordinates(h(s.coordinates[0]))};this.resetClickSequence();var c=this.getAddFeatureOrBooleanPolygonAction(u,e);c&&e.onEdit(c)}}var d={screenCoords:[-1,-1],mapCoords:t.mapCoords,picks:[],pointerDownPicks:null,pointerDownScreenCoords:null,pointerDownMapCoords:null,cancelPan:function(){},sourceEvent:null};this.handlePointerMove(d,e)}}},{key:"finalizedCoordinates",value:function(t){var e=[[].concat(h(t.slice(0,-2)),[t[0]])],n=this.getIntermediatePoint(h(t));if(n)e=[[].concat(h(t.slice(0,-2)),[n,t[0]])];else{var r=h(t);r.splice(-3,1),(n=this.getIntermediatePoint(h(r)))&&(e=[[].concat(h(t.slice(0,-3)),[n,t[0]])])}return e}},{key:"getIntermediatePoint",value:function(t){var e;if(t.length>4){var n=h(t),l=n[0],u=n[1],c=(0,i.default)(l,u),d=t[t.length-3],f=t[t.length-4],p=(0,i.default)(d,f),g={first:[],second:[]};[1,2,3].forEach((function(t){var e=c+90*t;g.first.push(e>180?e-360:e);var n=p+90*t;g.second.push(n>180?n-360:n)}));var y=(0,s.default)((0,a.point)(l),(0,a.point)(d));[0,1,2].forEach((function(t){var n=(0,a.lineString)([l,(0,r.default)(l,y,g.first[t]).geometry.coordinates]);[0,1,2].forEach((function(t){var i=(0,a.lineString)([d,(0,r.default)(d,y,g.second[t]).geometry.coordinates]),s=(0,o.default)(n,i);s&&s.features.length&&(e=s.features[0].geometry.coordinates)}))}))}return e}}])&&p(e.prototype,n),v}(n(22861).GeoJsonEditMode);e.Draw90DegreePolygonMode=v},51826:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DrawCircleByDiameterMode=void 0;var r=s(n(37879)),i=s(n(78208)),o=n(22861);function s(t){return t&&t.__esModule?t:{default:t}}function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}function l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function u(t){return u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},u(t)}function c(t,e){return c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},c(t,e)}var h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(d,t);var e,n,s,h=(s=d,function(){var t,e=u(s);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}()){var n=u(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){return!e||"object"!==a(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,t)});function d(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,d),h.apply(this,arguments)}return e=d,(n=[{key:"getTwoClickPolygon",value:function(t,e,n){var s=(n||{}).steps,a=void 0===s?64:s,l={steps:a};a<4&&(console.warn("Minimum steps to draw a circle is 4 "),l.steps=4);var u=(0,o.getIntermediatePosition)(t,e),c=Math.max((0,i.default)(t,u),.001),h=(0,r.default)(u,c,l);return h.properties=h.properties||{},h.properties.shape="Circle",h}}])&&l(e.prototype,n),d}(n(98675).TwoClickPolygonMode);e.DrawCircleByDiameterMode=h},24293:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DrawCircleFromCenterMode=void 0;var r=o(n(37879)),i=o(n(78208));function o(t){return t&&t.__esModule?t:{default:t}}function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function l(t){return l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},l(t)}function u(t,e){return u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},u(t,e)}var c=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(h,t);var e,n,o,c=(o=h,function(){var t,e=l(o);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}()){var n=l(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){return!e||"object"!==s(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,t)});function h(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h),c.apply(this,arguments)}return e=h,(n=[{key:"getTwoClickPolygon",value:function(t,e,n){var o=(n||{}).steps,s=void 0===o?64:o,a={steps:s};s<4&&(console.warn("Minimum steps to draw a circle is 4 "),a.steps=4);var l=Math.max((0,i.default)(t,e),.001),u=(0,r.default)(t,l,a);return u.properties=u.properties||{},u.properties.shape="Circle",u}}])&&a(e.prototype,n),h}(n(98675).TwoClickPolygonMode);e.DrawCircleFromCenterMode=c},35895:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DrawEllipseByBoundingBoxMode=void 0;var r=l(n(6039)),i=l(n(78208)),o=l(n(61021)),s=n(85846),a=n(22861);function l(t){return t&&t.__esModule?t:{default:t}}function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function c(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function h(t){return h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},h(t)}function d(t,e){return d=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},d(t,e)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&d(t,e)}(p,t);var e,n,l,f=(l=p,function(){var t,e=h(l);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}()){var n=h(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){return!e||"object"!==u(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,t)});function p(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,p),f.apply(this,arguments)}return e=p,(n=[{key:"getTwoClickPolygon",value:function(t,e,n){var l=Math.min(t[0],e[0]),u=Math.min(t[1],e[1]),c=Math.max(t[0],e[0]),h=Math.max(t[1],e[1]),d=(0,r.default)([l,u,c,h]).geometry.coordinates[0],f=(0,a.getIntermediatePosition)(t,e),p=Math.max((0,i.default)((0,s.point)(d[0]),(0,s.point)(d[1])),.001),g=Math.max((0,i.default)((0,s.point)(d[0]),(0,s.point)(d[3])),.001);return(0,o.default)(f,p,g)}}])&&c(e.prototype,n),p}(n(98675).TwoClickPolygonMode);e.DrawEllipseByBoundingBoxMode=f},94402:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DrawEllipseUsingThreePointsMode=void 0;var r=l(n(78208)),i=l(n(61021)),o=l(n(17021)),s=n(85846),a=n(22861);function l(t){return t&&t.__esModule?t:{default:t}}function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function c(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function h(t){return h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},h(t)}function d(t,e){return d=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},d(t,e)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&d(t,e)}(p,t);var e,n,l,f=(l=p,function(){var t,e=h(l);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}()){var n=h(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){return!e||"object"!==u(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,t)});function p(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,p),f.apply(this,arguments)}return e=p,(n=[{key:"getThreeClickPolygon",value:function(t,e,n,l){var u=(0,a.getIntermediatePosition)(t,e),c=Math.max((0,r.default)(u,(0,s.point)(n)),.001),h=Math.max((0,r.default)(t,e),.001)/2,d={angle:(0,o.default)(t,e)};return(0,i.default)(u,c,h,d)}}])&&c(e.prototype,n),p}(n(49841).ThreeClickPolygonMode);e.DrawEllipseUsingThreePointsMode=f},32530:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DrawLineStringMode=void 0;var r=n(5050);function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function o(t){return function(t){if(Array.isArray(t))return s(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return s(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function l(t){return l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},l(t)}function u(t,e){return u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},u(t,e)}var c=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(h,t);var e,n,s,c=(s=h,function(){var t,e=l(s);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}()){var n=l(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){return!e||"object"!==i(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,t)});function h(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h),c.apply(this,arguments)}return e=h,(n=[{key:"handleClick",value:function(t,e){var n=t.picks,i=(0,r.getPickedEditHandle)(n),s=!1;i||(this.addClickSequence(t),s=!0);var a=this.getClickSequence();if(a.length>1&&i&&Array.isArray(i.properties.positionIndexes)&&i.properties.positionIndexes[0]===a.length-1){var l={type:"LineString",coordinates:o(a)};this.resetClickSequence();var u=this.getAddFeatureAction(l,e.data);u&&e.onEdit(u)}else s&&e.onEdit({updatedData:e.data,editType:"addTentativePosition",editContext:{position:t.mapCoords}})}},{key:"handleKeyUp",value:function(t,e){if("Enter"===t.key){var n=this.getClickSequence();if(n.length>1){var r={type:"LineString",coordinates:o(n)};this.resetClickSequence();var i=this.getAddFeatureAction(r,e.data);i&&e.onEdit(i)}}}},{key:"getGuides",value:function(t){var e,n,r=t.lastPointerMoveEvent,i=this.getClickSequence(),s=r?[r.mapCoords]:[],a={type:"FeatureCollection",features:[]};i.length>0&&(n={type:"Feature",properties:{guideType:"tentative"},geometry:{type:"LineString",coordinates:[].concat(o(i),s)}}),n&&a.features.push(n);var l=i.map((function(t,e){return{type:"Feature",properties:{guideType:"editHandle",editHandleType:"existing",featureIndex:-1,positionIndexes:[e]},geometry:{type:"Point",coordinates:t}}}));return(e=a.features).push.apply(e,o(l)),a}},{key:"handlePointerMove",value:function(t,e){e.onUpdateCursor("cell")}}])&&a(e.prototype,n),h}(n(22861).GeoJsonEditMode);e.DrawLineStringMode=c},77384:(t,e,n)=>{"use strict";function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function o(t,e,n){return o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=s(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}},o(t,e,n||t)}function s(t){return s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},s(t)}function a(t,e){return a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},a(t,e)}Object.defineProperty(e,"__esModule",{value:!0}),e.DrawPointMode=void 0;var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(c,t);var e,n,l,u=(l=c,function(){var t,e=s(l);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}()){var n=s(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,t)});function c(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),u.apply(this,arguments)}return e=c,(n=[{key:"createTentativeFeature",value:function(t){var e=t.lastPointerMoveEvent;return{type:"Feature",properties:{guideType:"tentative"},geometry:{type:"Point",coordinates:(e?[e.mapCoords]:[])[0]}}}},{key:"handleClick",value:function(t,e){var n={type:"Point",coordinates:t.mapCoords};e.onEdit(this.getAddFeatureAction(n,e.data))}},{key:"handlePointerMove",value:function(t,e){e.onUpdateCursor("cell"),o(s(c.prototype),"handlePointerMove",this).call(this,t,e)}}])&&i(e.prototype,n),c}(n(22861).GeoJsonEditMode);e.DrawPointMode=l},18332:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DrawPolygonByDraggingMode=void 0;var r,i=(r=n(25858))&&r.__esModule?r:{default:r},o=n(5050);function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function u(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function c(t){return c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},c(t)}function h(t,e){return h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},h(t,e)}var d=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&h(t,e)}(f,t);var e,n,r,d=(r=f,function(){var t,e=c(r);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}()){var n=c(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){return!e||"object"!==s(e)&&"function"!=typeof e?u(t):e}(this,t)});function f(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return function(t,e){e in t?Object.defineProperty(t,e,{value:null,enumerable:!0,configurable:!0,writable:!0}):t[e]=null}(u(t=d.call.apply(d,[this].concat(n))),"handleDraggingThrottled"),t}return e=f,(n=[{key:"handleClick",value:function(t,e){}},{key:"handleStartDragging",value:function(t,e){t.cancelPan(),e.modeConfig&&e.modeConfig.throttleMs?this.handleDraggingThrottled=(0,i.default)(this.handleDraggingAux,e.modeConfig.throttleMs):this.handleDraggingThrottled=this.handleDraggingAux}},{key:"handleStopDragging",value:function(t,e){this.addClickSequence(t);var n,r=this.getClickSequence();if(this.handleDraggingThrottled&&this.handleDraggingThrottled.cancel&&this.handleDraggingThrottled.cancel(),r.length>2){var i={type:"Polygon",coordinates:[[].concat((n=r,function(t){if(Array.isArray(t))return a(t)}(n)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(n)||function(t,e){if(t){if("string"==typeof t)return a(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(t,e):void 0}}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),[r[0]])]};this.resetClickSequence();var o=this.getAddFeatureOrBooleanPolygonAction(i,e);o&&e.onEdit(o)}}},{key:"handleDraggingAux",value:function(t,e){var n=t.picks;(0,o.getPickedEditHandle)(n)||this.addClickSequence(t)}},{key:"handleDragging",value:function(t,e){this.handleDraggingThrottled&&this.handleDraggingThrottled(t,e)}}])&&l(e.prototype,n),f}(n(83136).DrawPolygonMode);e.DrawPolygonByDraggingMode=d},83136:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DrawPolygonMode=void 0;var r=n(5050);function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function o(t){return function(t){if(Array.isArray(t))return s(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return s(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function l(t,e,n){return l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=u(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}},l(t,e,n||t)}function u(t){return u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},u(t)}function c(t,e){return c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},c(t,e)}var h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(d,t);var e,n,s,h=(s=d,function(){var t,e=u(s);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}()){var n=u(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){return!e||"object"!==i(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,t)});function d(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,d),h.apply(this,arguments)}return e=d,(n=[{key:"createTentativeFeature",value:function(t){var e,n=t.lastPointerMoveEvent,r=this.getClickSequence(),i=n?[n.mapCoords]:[];return 1===r.length||2===r.length?e={type:"Feature",properties:{guideType:"tentative"},geometry:{type:"LineString",coordinates:[].concat(o(r),i)}}:r.length>2&&(e={type:"Feature",properties:{guideType:"tentative"},geometry:{type:"Polygon",coordinates:[[].concat(o(r),i,[r[0]])]}}),e}},{key:"getGuides",value:function(t){var e,n=this.getClickSequence(),r={type:"FeatureCollection",features:[]},i=this.createTentativeFeature(t);i&&r.features.push(i);var s=n.map((function(t,e){return{type:"Feature",properties:{guideType:"editHandle",editHandleType:"existing",featureIndex:-1,positionIndexes:[e]},geometry:{type:"Point",coordinates:t}}}));return(e=r.features).push.apply(e,o(s)),r}},{key:"handleClick",value:function(t,e){var n=t.picks,i=(0,r.getPickedEditHandle)(n),s=!1;i||(this.addClickSequence(t),s=!0);var a=this.getClickSequence();if(a.length>2&&i&&Array.isArray(i.properties.positionIndexes)&&(0===i.properties.positionIndexes[0]||i.properties.positionIndexes[0]===a.length-1)){var l={type:"Polygon",coordinates:[[].concat(o(a),[a[0]])]};this.resetClickSequence();var u=this.getAddFeatureOrBooleanPolygonAction(l,e);u&&e.onEdit(u)}else s&&e.onEdit({updatedData:e.data,editType:"addTentativePosition",editContext:{position:t.mapCoords}})}},{key:"handleKeyUp",value:function(t,e){if("Enter"===t.key){var n=this.getClickSequence();if(n.length>2){var r={type:"Polygon",coordinates:[[].concat(o(n),[n[0]])]};this.resetClickSequence();var i=this.getAddFeatureOrBooleanPolygonAction(r,e);i&&e.onEdit(i)}}}},{key:"handlePointerMove",value:function(t,e){e.onUpdateCursor("cell"),l(u(d.prototype),"handlePointerMove",this).call(this,t,e)}}])&&a(e.prototype,n),d}(n(22861).GeoJsonEditMode);e.DrawPolygonMode=h},5503:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DrawRectangleFromCenterMode=void 0;var r,i=(r=n(6039))&&r.__esModule?r:{default:r};function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t){return a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},a(t)}function l(t,e){return l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},l(t,e)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(c,t);var e,n,r,u=(r=c,function(){var t,e=a(r);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}()){var n=a(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,t)});function c(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),u.apply(this,arguments)}return e=c,(n=[{key:"getTwoClickPolygon",value:function(t,e,n){var r=t[0]>e[0]?t[0]+Math.abs(t[0]-e[0]):t[0]-Math.abs(t[0]-e[0]),o=t[1]>e[1]?t[1]+Math.abs(t[1]-e[1]):t[1]-Math.abs(t[1]-e[1]),s=(0,i.default)([r,o,e[0],e[1]]);return s.properties=s.properties||{},s.properties.shape="Rectangle",s}}])&&s(e.prototype,n),c}(n(98675).TwoClickPolygonMode);e.DrawRectangleFromCenterMode=u},68069:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DrawRectangleMode=void 0;var r,i=(r=n(6039))&&r.__esModule?r:{default:r};function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t){return a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},a(t)}function l(t,e){return l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},l(t,e)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(c,t);var e,n,r,u=(r=c,function(){var t,e=a(r);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}()){var n=a(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,t)});function c(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),u.apply(this,arguments)}return e=c,(n=[{key:"getTwoClickPolygon",value:function(t,e,n){var r=(0,i.default)([t[0],t[1],e[0],e[1]]);return r.properties=r.properties||{},r.properties.shape="Rectangle",r}}])&&s(e.prototype,n),c}(n(98675).TwoClickPolygonMode);e.DrawRectangleMode=u},54965:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DrawRectangleUsingThreePointsMode=void 0;var r=n(5050);function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t){return a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},a(t)}function l(t,e){return l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},l(t,e)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(h,t);var e,n,u,c=(u=h,function(){var t,e=a(u);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}()){var n=a(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){return!e||"object"!==i(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,t)});function h(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h),c.apply(this,arguments)}return e=h,(n=[{key:"getThreeClickPolygon",value:function(t,e,n,i){var s,a,l=(s=(0,r.generatePointsParallelToLinePoints)(t,e,n),a=2,function(t){if(Array.isArray(t))return t}(s)||function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}}(s,a)||function(t,e){if(t){if("string"==typeof t)return o(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(t,e):void 0}}(s,a)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());return{type:"Feature",properties:{shape:"Rectangle"},geometry:{type:"Polygon",coordinates:[[t,e,l[0],l[1],t]]}}}}])&&s(e.prototype,n),h}(n(49841).ThreeClickPolygonMode);e.DrawRectangleUsingThreePointsMode=u},7940:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DrawSquareFromCenterMode=void 0;var r=a(n(6039)),i=a(n(78208)),o=a(n(23478)),s=n(85846);function a(t){return t&&t.__esModule?t:{default:t}}function l(t){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l(t)}function u(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function c(t){return c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},c(t)}function h(t,e){return h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},h(t,e)}var d=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&h(t,e)}(f,t);var e,n,a,d=(a=f,function(){var t,e=c(a);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}()){var n=c(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){return!e||"object"!==l(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,t)});function f(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),d.apply(this,arguments)}return e=f,(n=[{key:"getTwoClickPolygon",value:function(t,e,n){var a=[e[0],t[1]],l=[t[0],e[1]],u=(0,i.default)((0,s.point)(a),(0,s.point)(t)),c=(0,i.default)((0,s.point)(l),(0,s.point)(t)),h=u<=c?u:c,d=u<=c?a:l,f=(0,s.lineString)([d,e]),p=(0,o.default)(f,h).geometry.coordinates,g=t[0]>p[0]?t[0]+Math.abs(t[0]-p[0]):t[0]-Math.abs(t[0]-p[0]),y=t[1]>p[1]?t[1]+Math.abs(t[1]-p[1]):t[1]-Math.abs(t[1]-p[1]),m=(0,r.default)([g,y,p[0],p[1]]);return m.properties=m.properties||{},m.properties.shape="Square",m}}])&&u(e.prototype,n),f}(n(98675).TwoClickPolygonMode);e.DrawSquareFromCenterMode=d},18144:(t,e,n)=>{"use strict";function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function o(t,e,n){return o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=s(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}},o(t,e,n||t)}function s(t){return s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},s(t)}function a(t,e){return a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},a(t,e)}Object.defineProperty(e,"__esModule",{value:!0}),e.DuplicateMode=void 0;var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(c,t);var e,n,l,u=(l=c,function(){var t,e=s(l);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}()){var n=s(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,t)});function c(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),u.apply(this,arguments)}return e=c,(n=[{key:"handleStartDragging",value:function(t,e){o(s(c.prototype),"handleStartDragging",this).call(this,t,e),this._geometryBeforeTranslate&&e.onEdit(this.getAddManyFeaturesAction(this._geometryBeforeTranslate,e.data))}},{key:"updateCursor",value:function(t){this._isTranslatable?t.onUpdateCursor("copy"):t.onUpdateCursor(null)}}])&&i(e.prototype,n),c}(n(99461).TranslateMode);e.DuplicateMode=l},64290:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ElevationMode=void 0;var r=n(5050);function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function s(t,e,n){return s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=a(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}},s(t,e,n||t)}function a(t){return a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},a(t)}function l(t,e){return l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},l(t,e)}function u(t){var e=t.pointerDownScreenCoords,n=t.screenCoords;return 10*(e[1]-n[1])}var c=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(f,t);var e,n,c,h,d=(h=f,function(){var t,e=a(h);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}()){var n=a(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){return!e||"object"!==i(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,t)});function f(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),d.apply(this,arguments)}return e=f,c=[{key:"calculateElevationChangeWithViewport",value:function(t,e){var n=e.pointerDownScreenCoords,r=e.screenCoords;return 156543.03392*Math.cos(t.latitude*Math.PI/180)/Math.pow(2,t.zoom)*(n[1]-r[1])/2}}],(n=[{key:"makeElevatedEvent",value:function(t,e,n){var r=n.modeConfig||{},i=r.minElevation,o=void 0===i?0:i,s=r.maxElevation,a=void 0===s?2e4:s,l=r.calculateElevationChange,c=void 0===l?u:l;if(!t.pointerDownScreenCoords)return t;var h=3===e.length?e[2]:0;return h+=c({pointerDownScreenCoords:t.pointerDownScreenCoords,screenCoords:t.screenCoords}),h=Math.min(h,a),h=Math.max(h,o),Object.assign({},t,{mapCoords:[e[0],e[1],h]})}},{key:"handlePointerMove",value:function(t,e){var n=(0,r.getPickedEditHandle)(t.pointerDownPicks),i=n?n.geometry.coordinates:t.mapCoords;s(a(f.prototype),"handlePointerMove",this).call(this,this.makeElevatedEvent(t,i,e),e)}},{key:"handleStopDragging",value:function(t,e){var n=(0,r.getPickedEditHandle)(t.picks),i=n?n.geometry.coordinates:t.mapCoords;s(a(f.prototype),"handleStopDragging",this).call(this,this.makeElevatedEvent(t,i,e),e)}},{key:"getCursor",value:function(t){var e=s(a(f.prototype),"getCursor",this).call(this,t);return"cell"===e&&(e="ns-resize"),e}}])&&o(e.prototype,n),c&&o(e,c),f}(n(70365).ModifyMode);e.ElevationMode=c},44112:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ExtendLineStringMode=void 0;var r=n(22861),i=n(96397);function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t){return a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},a(t)}function l(t,e){return l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},l(t,e)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(c,t);var e,n,r,u=(r=c,function(){var t,e=a(r);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}()){var n=a(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,t)});function c(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),u.apply(this,arguments)}return e=c,(n=[{key:"getSingleSelectedLineString",value:function(t){var e=this.getSelectedGeometry(t);return e&&"LineString"===e.type?e:null}},{key:"handleClick",value:function(t,e){var n=e.selectedIndexes,r=this.getSingleSelectedLineString(e);if(r){var o=[r.coordinates.length],s=e.modeConfig;s&&s.drawAtFront&&(o=[0]);var a=n[0],l=new i.ImmutableFeatureCollection(e.data).addPosition(a,o,t.mapCoords).getObject();e.onEdit({updatedData:l,editType:"addPosition",editContext:{featureIndexes:[a],positionIndexes:o,position:t.mapCoords}})}else console.warn("ExtendLineStringMode only supported for single LineString selection")}},{key:"getGuides",value:function(t){var e={type:"FeatureCollection",features:[]},n=this.getSingleSelectedLineString(t);if(!n)return e;var r,i=t.lastPointerMoveEvent&&t.lastPointerMoveEvent.mapCoords,o=t.modeConfig;return r=o&&o.drawAtFront?n.coordinates[0]:n.coordinates[n.coordinates.length-1],e.features.push({type:"Feature",properties:{guideType:"tentative"},geometry:{type:"LineString",coordinates:[r,i]}}),e}},{key:"handlePointerMove",value:function(t,e){e.onUpdateCursor("cell")}}])&&s(e.prototype,n),c}(r.GeoJsonEditMode);e.ExtendLineStringMode=u},27884:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ExtrudeMode=void 0;var r,i=(r=n(17021))&&r.__esModule?r:{default:r},o=n(5050),s=n(70365),a=n(96397);function l(t){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l(t)}function u(t){return function(t){if(Array.isArray(t))return d(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||h(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}}(t,e)||h(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(t,e){if(t){if("string"==typeof t)return d(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(t,e):void 0}}function d(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function f(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function p(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function g(t){return g=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},g(t)}function y(t,e){return y=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},y(t,e)}var m=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&y(t,e)}(h,t);var e,n,r,s=(r=h,function(){var t,e=g(r);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}()){var n=g(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){return!e||"object"!==l(e)&&"function"!=typeof e?p(t):e}(this,t)});function h(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return function(t,e,n){e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}(p(t=s.call.apply(s,[this].concat(n))),"isPointAdded",!1),t}return e=h,(n=[{key:"handleDragging",value:function(t,e){var n=(0,o.getPickedEditHandle)(t.pointerDownPicks);if(n){var r=n.properties.featureIndex,i=n.properties.positionIndexes,s=this.coordinatesSize(i,r,e.data);i=this.isPointAdded?this.nextPositionIndexes(i,s):i;var l=this.getPointForPositionIndexes(this.prevPositionIndexes(i,s),r,e.data),u=this.getPointForPositionIndexes(i,r,e.data);if(l&&u){var h=c((0,o.generatePointsParallelToLinePoints)(l,u,t.mapCoords),2),d=h[0],f=h[1],p=new a.ImmutableFeatureCollection(e.data).replacePosition(r,this.prevPositionIndexes(i,s),f).replacePosition(r,i,d).getObject();e.onEdit({updatedData:p,editType:"extruding",editContext:{featureIndexes:[r],positionIndexes:this.nextPositionIndexes(i,s),position:d}}),t.cancelPan()}}}},{key:"handleStartDragging",value:function(t,e){var n=e.selectedIndexes,r=(0,o.getPickedIntermediateEditHandle)(t.picks);if(n.length&&r){var i=r.properties,s=i.positionIndexes,l=i.featureIndex,u=this.coordinatesSize(s,l,e.data),c=this.getPointForPositionIndexes(this.prevPositionIndexes(s,u),l,e.data),h=this.getPointForPositionIndexes(s,l,e.data);if(c&&h){var d=new a.ImmutableFeatureCollection(e.data);this.isOrthogonal(s,l,u,e.data)||(d=d.addPosition(l,s,h)),this.isOrthogonal(this.prevPositionIndexes(s,u),l,u,e.data)||(d=d.addPosition(l,s,c),this.isPointAdded=!0),e.onEdit({updatedData:d.getObject(),editType:"startExtruding",editContext:{featureIndexes:[l],positionIndexes:s,position:c}})}}}},{key:"handleStopDragging",value:function(t,e){var n=e.selectedIndexes,r=(0,o.getPickedEditHandle)(t.pointerDownPicks);if(n.length&&r){var i=r.properties.featureIndex,s=r.properties.positionIndexes,l=this.coordinatesSize(s,i,e.data);s=this.isPointAdded?this.nextPositionIndexes(s,l):s;var u=this.getPointForPositionIndexes(this.prevPositionIndexes(s,l),i,e.data),h=this.getPointForPositionIndexes(s,i,e.data);if(u&&h){var d=c((0,o.generatePointsParallelToLinePoints)(u,h,t.mapCoords),2),f=d[0],p=d[1],g=new a.ImmutableFeatureCollection(e.data).replacePosition(i,this.prevPositionIndexes(s,l),p).replacePosition(i,s,f).getObject();e.onEdit({updatedData:g,editType:"extruded",editContext:{featureIndexes:[i],positionIndexes:s,position:f}})}}this.isPointAdded=!1}},{key:"coordinatesSize",value:function(t,e,n){var r=n.features,i=0;if(Array.isArray(t)){var o=r[e].geometry.coordinates;if(3===t.length){var s=c(t,2),a=s[0],l=s[1];o.length&&o[a].length&&(i=o[a][l].length)}else{var u=c(t,1)[0];o.length&&o[u].length&&(i=o[u].length)}}return i}},{key:"getBearing",value:function(t,e){var n=(0,i.default)(t,e);return n<0?Math.floor(360+n):Math.floor(n)}},{key:"isOrthogonal",value:function(t,e,n,r){if(!Array.isArray(t))return!1;t[t.length-1]===n-1&&(t[t.length-1]=0);var i=this.getPointForPositionIndexes(this.prevPositionIndexes(t,n),e,r),o=this.getPointForPositionIndexes(this.nextPositionIndexes(t,n),e,r),s=this.getPointForPositionIndexes(t,e,r),a=this.getBearing(s,i),l=this.getBearing(s,o);return[89,90,91,269,270,271].includes(Math.abs(a-l))}},{key:"nextPositionIndexes",value:function(t,e){if(!Array.isArray(t))return[];var n=u(t);return n.length&&(n[n.length-1]=n[n.length-1]===e-1?0:n[n.length-1]+1),n}},{key:"prevPositionIndexes",value:function(t,e){if(!Array.isArray(t))return[];var n=u(t);return n.length&&(n[n.length-1]=0===n[n.length-1]?e-2:n[n.length-1]-1),n}},{key:"getPointForPositionIndexes",value:function(t,e,n){var r,i=n.features;if(Array.isArray(t)){var o=i[e].geometry.coordinates;if(3===t.length){var s=c(t,3),a=s[0],l=s[1],u=s[2];o.length&&o[a].length&&(r=o[a][l][u])}else{var h=c(t,2),d=h[0],f=h[1];o.length&&o[d].length&&(r=o[d][f])}}return r}}])&&f(e.prototype,n),h}(s.ModifyMode);e.ExtrudeMode=m},22861:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getIntermediatePosition=function(t,e){return[(t[0]+e[0])/2,(t[1]+e[1])/2]},e.GeoJsonEditMode=void 0;var r=u(n(36112)),i=u(n(84136)),o=u(n(74)),s=u(n(76916)),a=n(5050),l=n(96397);function u(t){return t&&t.__esModule?t:{default:t}}function c(t){return function(t){if(Array.isArray(t))return d(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||h(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(t,e){if(t){if("string"==typeof t)return d(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(t,e):void 0}}function d(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function f(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var p={type:"FeatureCollection",features:[]},g=[],y=function(){function t(){var e,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),n=[],(e="_clickSequence")in this?Object.defineProperty(this,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):this[e]=n}var e,n;return e=t,(n=[{key:"getGuides",value:function(t){return p}},{key:"getTooltips",value:function(t){return g}},{key:"getSelectedFeature",value:function(t){return 1===t.selectedIndexes.length?t.data.features[t.selectedIndexes[0]]:null}},{key:"getSelectedGeometry",value:function(t){var e=this.getSelectedFeature(t);return e?e.geometry:null}},{key:"getSelectedFeaturesAsFeatureCollection",value:function(t){var e=t.data.features;return{type:"FeatureCollection",features:t.selectedIndexes.map((function(t){return e[t]}))}}},{key:"getClickSequence",value:function(){return this._clickSequence}},{key:"addClickSequence",value:function(t){var e=t.mapCoords;this._clickSequence.push(e)}},{key:"resetClickSequence",value:function(){this._clickSequence=[]}},{key:"getTentativeGuide",value:function(t){return this.getGuides(t).features.find((function(t){return t.properties&&"tentative"===t.properties.guideType}))}},{key:"isSelectionPicked",value:function(t,e){if(!t.length)return!1;var n=(0,a.getNonGuidePicks)(t).map((function(t){return t.index})),r=(0,a.getPickedEditHandles)(t).map((function(t){return t.properties.featureIndex})),i=new Set([].concat(c(n),c(r)));return e.selectedIndexes.some((function(t){return i.has(t)}))}},{key:"rewindPolygon",value:function(t){var e=t.geometry;return"Polygon"===e.type||"MultiPolygon"===e.type?(0,s.default)(t):t}},{key:"getAddFeatureAction",value:function(t,e){var n=t,r="Feature"===n.type?n:{type:"Feature",properties:{},geometry:n},i=this.rewindPolygon(r),o=new l.ImmutableFeatureCollection(e).addFeature(i).getObject();return{updatedData:o,editType:"addFeature",editContext:{featureIndexes:[o.features.length-1]}}}},{key:"getAddManyFeaturesAction",value:function(t,e){var n,r=t.features,i=new l.ImmutableFeatureCollection(e),o=i.getObject().features.length,s=[],a=function(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=h(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,s=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return o=t.done,t},e:function(t){s=!0,i=t},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw i}}}}(r);try{for(a.s();!(n=a.n()).done;){var u=n.value,c=u.properties,d=u.geometry;i=i.addFeature({type:"Feature",properties:c,geometry:d}),s.push(o+s.length)}}catch(t){a.e(t)}finally{a.f()}return{updatedData:i.getObject(),editType:"addFeature",editContext:{featureIndexes:s}}}},{key:"getAddFeatureOrBooleanPolygonAction",value:function(t,e){var n=t,s=this.getSelectedFeature(e),a=e.modeConfig;if(a&&a.booleanOperation){if(!s||"Polygon"!==s.geometry.type&&"MultiPolygon"!==s.geometry.type)return console.warn("booleanOperation only supported for single Polygon or MultiPolygon selection"),null;var u,c="Feature"===n.type?n:{type:"Feature",geometry:n};if("union"===a.booleanOperation)u=(0,r.default)(s,c);else if("difference"===a.booleanOperation)u=(0,i.default)(s,c);else{if("intersection"!==a.booleanOperation)return console.warn("Invalid booleanOperation ".concat(a.booleanOperation)),null;u=(0,o.default)(s,c)}if(!u)return console.warn("Canceling edit. Boolean operation erased entire polygon."),null;var h=e.selectedIndexes[0];return{updatedData:new l.ImmutableFeatureCollection(e.data).replaceGeometry(h,u.geometry).getObject(),editType:"unionGeometry",editContext:{featureIndexes:[h]}}}return this.getAddFeatureAction(t,e.data)}},{key:"createTentativeFeature",value:function(t){return null}},{key:"handleClick",value:function(t,e){}},{key:"handlePointerMove",value:function(t,e){var n=this.createTentativeFeature(e);n&&e.onEdit({updatedData:e.data,editType:"updateTentativeFeature",editContext:{feature:n}})}},{key:"handleStartDragging",value:function(t,e){}},{key:"handleStopDragging",value:function(t,e){}},{key:"handleDragging",value:function(t,e){}},{key:"handleKeyUp",value:function(t,e){"Escape"===t.key&&(this.resetClickSequence(),e.onEdit({updatedData:e.data,editType:"cancelFeature",editContext:{}}))}}])&&f(e.prototype,n),t}();e.GeoJsonEditMode=y},96397:(t,e)=>{"use strict";function n(t){return function(t){if(Array.isArray(t))return r(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function i(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function o(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?i(Object(n),!0).forEach((function(e){a(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Object.defineProperty(e,"__esModule",{value:!0}),e.ImmutableFeatureCollection=void 0;var l=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),a(this,"featureCollection",void 0),this.featureCollection=e}var e,r;return e=t,(r=[{key:"getObject",value:function(){return this.featureCollection}},{key:"replacePosition",value:function(t,e,n){var r=this.featureCollection.features[t].geometry,i="Polygon"===r.type||"MultiPolygon"===r.type,s=o({},r,{coordinates:c(r.coordinates,e,n,i)});return this.replaceGeometry(t,s)}},{key:"removePosition",value:function(t,e){var n=this.featureCollection.features[t].geometry;if("Point"===n.type)throw Error("Can't remove a position from a Point or there'd be nothing left");if("MultiPoint"===n.type&&n.coordinates.length<2)throw Error("Can't remove the last point of a MultiPoint or there'd be nothing left");if("LineString"===n.type&&n.coordinates.length<3)throw Error("Can't remove position. LineString must have at least two positions");if("Polygon"===n.type&&n.coordinates[0].length<5&&Array.isArray(e)&&0===e[0])throw Error("Can't remove position. Polygon's outer ring must have at least four positions");if("MultiLineString"===n.type&&1===n.coordinates.length&&n.coordinates[0].length<3)throw Error("Can't remove position. MultiLineString must have at least two positions");if("MultiPolygon"===n.type&&1===n.coordinates.length&&n.coordinates[0][0].length<5&&Array.isArray(e)&&0===e[0]&&0===e[1])throw Error("Can't remove position. MultiPolygon's outer ring must have at least four positions");var r="Polygon"===n.type||"MultiPolygon"===n.type,i=o({},n,{coordinates:h(n.coordinates,e,r)});return function(t){switch(t.type){case"Polygon":!function(t){for(var e=t.coordinates,n=1;n<e.length;n++)f(e,n)&&n--}(t);break;case"MultiLineString":!function(t){for(var e=0;e<t.coordinates.length;e++)1===t.coordinates[e].length&&(t.coordinates.splice(e,1),e--)}(t);break;case"MultiPolygon":!function(t){for(var e=0;e<t.coordinates.length;e++){var n=t.coordinates[e];n[0].length<=3&&(t.coordinates.splice(e,1),e--);for(var r=1;r<n.length;r++)f(n,r)&&r--}}(t)}}(i),this.replaceGeometry(t,i)}},{key:"addPosition",value:function(t,e,n){var r=this.featureCollection.features[t].geometry;if("Point"===r.type)throw new Error("Unable to add a position to a Point feature");var i="Polygon"===r.type||"MultiPolygon"===r.type,s=o({},r,{coordinates:d(r.coordinates,e,n,i)});return this.replaceGeometry(t,s)}},{key:"replaceGeometry",value:function(e,r){var i=o({},this.featureCollection.features[e],{geometry:r});return new t(o({},this.featureCollection,{features:[].concat(n(this.featureCollection.features.slice(0,e)),[i],n(this.featureCollection.features.slice(e+1)))}))}},{key:"addFeature",value:function(t){return this.addFeatures([t])}},{key:"addFeatures",value:function(e){return new t(o({},this.featureCollection,{features:[].concat(n(this.featureCollection.features),n(e))}))}},{key:"deleteFeature",value:function(t){return this.deleteFeatures([t])}},{key:"deleteFeatures",value:function(e){var r=n(this.featureCollection.features);e.sort();for(var i=e.length-1;i>=0;i--){var s=e[i];s>=0&&s<r.length&&r.splice(s,1)}return new t(o({},this.featureCollection,{features:r}))}}])&&s(e.prototype,r),t}();function u(t,e){if(2===t.length&&3===e.length){var n=e[2];return[t[0],t[1],n]}return t}function c(t,e,r,i){if(!e)return t;if(0===e.length)return u(r,t);if(1===e.length){var o=[].concat(n(t.slice(0,e[0])),[u(r,t[e[0]])],n(t.slice(e[0]+1)));return!i||0!==e[0]&&e[0]!==t.length-1||(o[0]=u(r,t[0]),o[t.length-1]=u(r,t[0])),o}return[].concat(n(t.slice(0,e[0])),[c(t[e[0]],e.slice(1,e.length),r,i)],n(t.slice(e[0]+1)))}function h(t,e,r){if(!e)return t;if(0===e.length)throw Error("Must specify the index of the position to remove");if(1===e.length){var i=[].concat(n(t.slice(0,e[0])),n(t.slice(e[0]+1)));return!r||0!==e[0]&&e[0]!==t.length-1||(0===e[0]?i[i.length-1]=i[0]:e[0]===t.length-1&&(i[0]=i[i.length-1])),i}return[].concat(n(t.slice(0,e[0])),[h(t[e[0]],e.slice(1,e.length),r)],n(t.slice(e[0]+1)))}function d(t,e,r,i){if(!e)return t;if(0===e.length)throw Error("Must specify the index of the position to remove");return 1===e.length?[].concat(n(t.slice(0,e[0])),[r],n(t.slice(e[0]))):[].concat(n(t.slice(0,e[0])),[d(t[e[0]],e.slice(1,e.length),r,i)],n(t.slice(e[0]+1)))}function f(t,e){return t[e].length<=3&&(t.splice(e,1),!0)}e.ImmutableFeatureCollection=l},6365:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MeasureAngleMode=void 0;var r=a(n(17021)),i=a(n(38622)),o=a(n(67095)),s=n(22861);function a(t){return t&&t.__esModule?t:{default:t}}function l(t){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l(t)}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function c(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function h(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function d(t){return d=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},d(t)}function f(t,e){return f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},f(t,e)}var p=[],g=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&f(t,e)}(g,t);var e,n,s,a=(s=g,function(){var t,e=d(s);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}()){var n=d(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){return!e||"object"!==l(e)&&"function"!=typeof e?h(t):e}(this,t)});function g(){var t,e,n,s;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,g);for(var l=arguments.length,u=new Array(l),c=0;c<l;c++)u[c]=arguments[c];return e=h(t=a.call.apply(a,[this].concat(u))),n="_getTooltips",s=(0,o.default)((function(t){var e=t.modeConfig,n=t.vertex,o=t.point1,s=t.point2,a=p;if(n&&o&&s){var l,u=e||{},c=u.formatTooltip,h=u.measurementCallback,d=(0,r.default)(n,o),f=(0,r.default)(n,s),g=Math.abs(d-f);g>180&&(g=360-g),l=c?c(g):"".concat(parseFloat(g).toFixed(2)," ").concat("deg"),h&&h(g),a=[{position:(0,i.default)({type:"FeatureCollection",features:[o,s].map((function(t){return{type:"Feature",geometry:{type:"Point",coordinates:t}}}))}).geometry.coordinates,text:l}]}return a})),n in e?Object.defineProperty(e,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[n]=s,t}return e=g,(n=[{key:"handleClick",value:function(t,e){this.getClickSequence().length>=3&&this.resetClickSequence(),this.addClickSequence(t)}},{key:"handlePointerMove",value:function(t,e){e.onUpdateCursor("cell")}},{key:"getPoints",value:function(t){var e,n=this.getClickSequence(),r=function(t){if(Array.isArray(t))return u(t)}(e=n)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(e)||function(t,e){if(t){if("string"==typeof t)return u(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(t,e):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}();return n.length<3&&t.lastPointerMoveEvent&&r.push(t.lastPointerMoveEvent.mapCoords),r}},{key:"getGuides",value:function(t){var e={type:"FeatureCollection",features:[]},n=e.features,r=this.getPoints(t);return r.length>2?n.push({type:"Feature",properties:{guideType:"tentative"},geometry:{type:"LineString",coordinates:[r[1],r[0],r[2]]}}):r.length>1&&n.push({type:"Feature",properties:{guideType:"tentative"},geometry:{type:"LineString",coordinates:[r[1],r[0]]}}),e}},{key:"getTooltips",value:function(t){var e=this.getPoints(t);return this._getTooltips({modeConfig:t.modeConfig,vertex:e[0],point1:e[1],point2:e[2]})}}])&&c(e.prototype,n),g}(s.GeoJsonEditMode);e.MeasureAngleMode=g},52929:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MeasureAreaMode=void 0;var r=s(n(61990)),i=s(n(30035)),o=n(83136);function s(t){return t&&t.__esModule?t:{default:t}}function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}function l(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function u(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function c(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function h(t,e,n){return h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=d(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}},h(t,e,n||t)}function d(t){return d=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},d(t)}function f(t,e){return f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},f(t,e)}var p=[],g=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&f(t,e)}(g,t);var e,n,o,s=(o=g,function(){var t,e=d(o);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}()){var n=d(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){return!e||"object"!==a(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,t)});function g(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,g),s.apply(this,arguments)}return e=g,n=[{key:"handleClick",value:function(t,e){var n=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?l(Object(n),!0).forEach((function(e){u(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},e,{onEdit:function(){}});h(d(g.prototype),"handleClick",this).call(this,t,n)}},{key:"getTooltips",value:function(t){var e=this.getTentativeGuide(t);if(e&&"Polygon"===e.geometry.type){var n,o=t.modeConfig||{},s=o.formatTooltip,a=o.measurementCallback,l=(0,i.default)(e),u=(0,r.default)(e);return n=s?s(u):"".concat(parseFloat(u).toFixed(2)," ").concat("sq. m"),a&&a(u),[{position:l.geometry.coordinates,text:n}]}return p}}],n&&c(e.prototype,n),g}(o.DrawPolygonMode);e.MeasureAreaMode=g},4987:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MeasureDistanceMode=void 0;var r,i=(r=n(78208))&&r.__esModule?r:{default:r},o=n(5050);function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function a(t){return function(t){if(Array.isArray(t))return l(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return l(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function u(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function h(t){return h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},h(t)}function d(t,e){return d=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},d(t,e)}function f(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&d(t,e)}(p,t);var e,n,r,l=(r=p,function(){var t,e=h(r);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}()){var n=h(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){return!e||"object"!==s(e)&&"function"!=typeof e?c(t):e}(this,t)});function p(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,p);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return f(c(t=l.call.apply(l,[this].concat(n))),"_isMeasuringSessionFinished",!1),f(c(t),"_currentTooltips",[]),f(c(t),"_currentDistance",0),f(c(t),"_calculateDistanceForTooltip",(function(t){var e=t.positionA,n=t.positionB,r=t.modeConfig||{},o=r.turfOptions,s=r.measurementCallback,a=(0,i.default)(e,n,o);return s&&s(a),a})),t}return e=p,(n=[{key:"_formatTooltip",value:function(t,e){var n=e||{},r=n.formatTooltip,i=n.turfOptions,o=i&&i.units||"kilometers";return r?r(t):"".concat(parseFloat(t).toFixed(2)," ").concat(o)}},{key:"handleClick",value:function(t,e){var n=e.modeConfig,r=e.data,i=e.onEdit;this._isMeasuringSessionFinished&&(this._isMeasuringSessionFinished=!1,this.resetClickSequence(),this._currentTooltips=[],this._currentDistance=0);var s=t.picks,a=(0,o.getPickedEditHandle)(s),l=!1;a||(this.addClickSequence(t),l=!0);var u=this.getClickSequence();u.length>1&&a&&Array.isArray(a.properties.positionIndexes)&&a.properties.positionIndexes[0]===u.length-1?this._isMeasuringSessionFinished=!0:l&&(u.length>1&&(this._currentDistance+=this._calculateDistanceForTooltip({positionA:u[u.length-2],positionB:u[u.length-1],modeConfig:n}),this._currentTooltips.push({position:t.mapCoords,text:this._formatTooltip(this._currentDistance,n)})),i({updatedData:r,editType:"addTentativePosition",editContext:{position:t.mapCoords}}))}},{key:"handleKeyUp",value:function(t,e){if(!this._isMeasuringSessionFinished){t.stopPropagation();var n=t.key,r=this.getClickSequence().length;switch(n){case"Escape":this._isMeasuringSessionFinished=!0,1===r&&(this.resetClickSequence(),this._currentTooltips=[]),e.onUpdateCursor("cell");break;case"Enter":this.handleClick(e.lastPointerMoveEvent,e),this._isMeasuringSessionFinished=!0}}}},{key:"getGuides",value:function(t){var e,n=t.lastPointerMoveEvent,r=this.getClickSequence(),i=n&&!this._isMeasuringSessionFinished?[n.mapCoords]:[],o={type:"FeatureCollection",features:[]};r.length>0&&o.features.push({type:"Feature",properties:{guideType:"tentative"},geometry:{type:"LineString",coordinates:[].concat(a(r),i)}});var s=r.map((function(t,e){return{type:"Feature",properties:{guideType:"editHandle",editHandleType:"existing",featureIndex:-1,positionIndexes:[e]},geometry:{type:"Point",coordinates:t}}}));return(e=o.features).push.apply(e,a(s)),o}},{key:"handlePointerMove",value:function(t,e){e.onUpdateCursor("cell")}},{key:"getTooltips",value:function(t){var e=t.lastPointerMoveEvent,n=t.modeConfig,r=this.getClickSequence();if(r.length>0&&e&&!this._isMeasuringSessionFinished){var i=this._calculateDistanceForTooltip({positionA:r[r.length-1],positionB:e.mapCoords,modeConfig:t.modeConfig});return[].concat(a(this._currentTooltips),[{position:e.mapCoords,text:this._formatTooltip(this._currentDistance+i,n)}])}return this._currentTooltips}}])&&u(e.prototype,n),p}(n(22861).GeoJsonEditMode);e.MeasureDistanceMode=p},70365:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ModifyMode=void 0;var r=n(85846),i=n(5050),o=n(22861),s=n(96397);function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}function l(t){return function(t){if(Array.isArray(t))return c(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||u(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(t,e){if(t){if("string"==typeof t)return c(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(t,e):void 0}}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function h(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function d(t){return d=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},d(t)}function f(t,e){return f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},f(t,e)}var p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&f(t,e)}(p,t);var e,n,o,c=(o=p,function(){var t,e=d(o);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}()){var n=d(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){return!e||"object"!==a(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,t)});function p(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,p),c.apply(this,arguments)}return e=p,(n=[{key:"getGuides",value:function(t){var e,n=this,o=[],s=t.data,a=t.lastPointerMoveEvent,c=s.features,h=a&&a.picks,d=a&&a.mapCoords,f=function(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=u(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,s=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return o=t.done,t},e:function(t){s=!0,i=t},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw i}}}}(t.selectedIndexes);try{for(f.s();!(e=f.n()).done;){var p=e.value;if(p<c.length){var g=c[p].geometry;o.push.apply(o,l((0,i.getEditHandlesForGeometry)(g,p)))}else console.warn("selectedFeatureIndexes out of range ".concat(p))}}catch(t){f.e(t)}finally{f.f()}if(h&&h.length&&d){var y,m=!(0,i.getPickedExistingEditHandle)(h)&&h.find((function(t){return!t.isGuide}));if(m&&!m.object.geometry.type.includes("Point")&&(!(null===(y=t.modeConfig)||void 0===y?void 0:y.lockRectangles)||"Rectangle"!==m.object.properties.shape)&&t.selectedIndexes.includes(m.index)){var v=null,b=[],_=(0,r.point)(d);if((0,i.recursivelyTraverseNestedArrays)(m.object.geometry.coordinates,[],(function(e,i){var o=(0,r.lineString)(e),s=n.getNearestPoint(o,_,t.modeConfig&&t.modeConfig.viewport);(!v||s.properties.dist<v.properties.dist)&&(v=s,b=i)})),v){var A=v,x=A.geometry.coordinates,w=A.properties.index;o.push({type:"Feature",properties:{guideType:"editHandle",editHandleType:"intermediate",featureIndex:m.index,positionIndexes:[].concat(l(b),[w+1])},geometry:{type:"Point",coordinates:x}})}}}return{type:"FeatureCollection",features:o}}},{key:"getNearestPoint",value:function(t,e,n){if(t.geometry.coordinates.some((function(t){return t.length>2}))){if(n)return(0,i.nearestPointOnProjectedLine)(t,e,n);console.log("Editing 3D point but modeConfig.viewport not provided. Falling back to 2D logic.")}return(0,i.nearestPointOnLine)(t,e,n)}},{key:"handleClick",value:function(t,e){var n=(0,i.getPickedExistingEditHandle)(t.picks),r=(0,i.getPickedIntermediateEditHandle)(t.picks);if(n){var o,a=n.properties,l=a.featureIndex,u=a.positionIndexes;try{o=new s.ImmutableFeatureCollection(e.data).removePosition(l,u).getObject()}catch(t){}o&&e.onEdit({updatedData:o,editType:"removePosition",editContext:{featureIndexes:[l],positionIndexes:u,position:n.geometry.coordinates}})}else if(r){var c,h=r.properties,d=h.featureIndex,f=h.positionIndexes,p=e.data.features[d];if(!(null===(c=e.modeConfig)||void 0===c?void 0:c.lockRectangles)||"Rectangle"!==(null==p?void 0:p.properties.shape)){var g=new s.ImmutableFeatureCollection(e.data).addPosition(d,f,r.geometry.coordinates).getObject();g&&e.onEdit({updatedData:g,editType:"addPosition",editContext:{featureIndexes:[d],positionIndexes:f,position:r.geometry.coordinates}})}}}},{key:"handleDragging",value:function(t,e){var n=(0,i.getPickedEditHandle)(t.pointerDownPicks);n&&(t.cancelPan(),this._dragEditHandle("movePosition",e,n,t))}},{key:"_dragEditHandle",value:function(t,e,n,r){var o,a,l=n.properties,u=e.data.features[l.featureIndex];if((null===(o=e.modeConfig)||void 0===o?void 0:o.lockRectangles)&&"Rectangle"===u.properties.shape){var c=(0,i.updateRectanglePosition)(u,l.positionIndexes[1],r.mapCoords);a=new s.ImmutableFeatureCollection(e.data).replaceGeometry(l.featureIndex,{coordinates:c,type:"Polygon"}).getObject()}else a=new s.ImmutableFeatureCollection(e.data).replacePosition(l.featureIndex,l.positionIndexes,r.mapCoords).getObject();e.onEdit({updatedData:a,editType:t,editContext:{featureIndexes:[l.featureIndex],positionIndexes:l.positionIndexes,position:r.mapCoords}})}},{key:"handlePointerMove",value:function(t,e){var n=this.getCursor(t);e.onUpdateCursor(n)}},{key:"handleStartDragging",value:function(t,e){var n=e.selectedIndexes,r=(0,i.getPickedIntermediateEditHandle)(t.picks);if(n.length&&r){var o=r.properties,a=new s.ImmutableFeatureCollection(e.data).addPosition(o.featureIndex,o.positionIndexes,t.mapCoords).getObject();e.onEdit({updatedData:a,editType:"addPosition",editContext:{featureIndexes:[o.featureIndex],positionIndexes:o.positionIndexes,position:t.mapCoords}})}}},{key:"handleStopDragging",value:function(t,e){var n=e.selectedIndexes,r=(0,i.getPickedEditHandle)(t.picks);n.length&&r&&this._dragEditHandle("finishMovePosition",e,r,t)}},{key:"getCursor",value:function(t){var e=t&&t.picks||[];return(0,i.getPickedEditHandles)(e).length?"cell":null}}])&&h(e.prototype,n),p}(o.GeoJsonEditMode);e.ModifyMode=p},77970:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ResizeCircleMode=void 0;var r=h(n(40533)),i=n(85846),o=h(n(37879)),s=h(n(78208)),a=h(n(38622)),l=n(5050),u=n(22861),c=n(96397);function h(t){return t&&t.__esModule?t:{default:t}}function d(t){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},d(t)}function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function p(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function g(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function y(t){return y=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},y(t)}function m(t,e){return m=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},m(t,e)}function v(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var b=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&m(t,e)}(b,t);var e,n,u,h=(u=b,function(){var t,e=y(u);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}()){var n=y(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){return!e||"object"!==d(e)&&"function"!=typeof e?g(t):e}(this,t)});function b(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,b);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return v(g(t=h.call.apply(h,[this].concat(n))),"_selectedEditHandle",void 0),v(g(t),"_isResizing",!1),t}return e=b,(n=[{key:"getGuides",value:function(t){var e,n=this,r=[],o=t.selectedIndexes,s=t.lastPointerMoveEvent,a=s&&s.picks,u=s&&s.mapCoords;if(a&&a.length&&u&&1===o.length&&!this._isResizing){var c=a.find((function(t){return!t.isGuide}));if(c&&c.object.properties.shape&&c.object.properties.shape.includes("Circle")&&t.selectedIndexes.includes(c.index)){var h=null,d=[],p=(0,i.point)(u);if((0,l.recursivelyTraverseNestedArrays)(c.object.geometry.coordinates,[],(function(e,r){var o=(0,i.lineString)(e),s=n.getNearestPoint(o,p,t.modeConfig&&t.modeConfig.viewport);(!h||s.properties.dist<h.properties.dist)&&(h=s,d=r)})),h){var g=h,y=g.geometry.coordinates,m=g.properties.index;r.push({type:"Feature",properties:{guideType:"editHandle",editHandleType:"intermediate",featureIndex:c.index,positionIndexes:[].concat((e=d,function(t){if(Array.isArray(t))return f(t)}(e)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(e)||function(t,e){if(t){if("string"==typeof t)return f(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(t,e):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),[m+1])},geometry:{type:"Point",coordinates:y}})}}}return{type:"FeatureCollection",features:r}}},{key:"getNearestPoint",value:function(t,e,n){if(t.geometry.coordinates.some((function(t){return t.length>2}))){if(n)return(0,l.nearestPointOnProjectedLine)(t,e,n);console.log("Editing 3D point but modeConfig.viewport not provided. Falling back to 2D logic.")}return(0,r.default)(t,e)}},{key:"handleDragging",value:function(t,e){var n=(0,l.getPickedEditHandle)(t.pointerDownPicks);if(n){t.cancelPan();var r=n.properties,i=this.getSelectedFeature(e),u=(0,a.default)(i).geometry.coordinates,h=Object.entries(i.geometry.coordinates[0]).length-1,d=Math.max((0,s.default)(u,t.mapCoords),.001),f={}.steps,p={steps:void 0===f?h:f},g=(0,o.default)(u,d,p).geometry,y=new c.ImmutableFeatureCollection(e.data).replaceGeometry(r.featureIndex,g).getObject();e.onEdit({updatedData:y,editType:"unionGeometry",editContext:{featureIndexes:[r.featureIndex]}})}}},{key:"handlePointerMove",value:function(t,e){if(!this._isResizing){var n=(0,l.getPickedEditHandle)(t.picks);this._selectedEditHandle=n&&"intermediate"===n.properties.editHandleType?n:null}var r=this.getCursor(t);e.onUpdateCursor(r)}},{key:"handleStartDragging",value:function(t,e){this._selectedEditHandle&&(this._isResizing=!0)}},{key:"handleStopDragging",value:function(t,e){this._isResizing&&(this._selectedEditHandle=null,this._isResizing=!1)}},{key:"getCursor",value:function(t){var e=t&&t.picks||[];return(0,l.getPickedEditHandles)(e).length?"cell":null}}])&&p(e.prototype,n),b}(u.GeoJsonEditMode);e.ResizeCircleMode=b},62458:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.RotateMode=void 0;var r=y(n(25368)),i=y(n(30035)),o=y(n(17021)),s=y(n(6039)),a=y(n(78208)),l=n(66030),u=n(74955),c=n(85846),h=y(n(56183)),d=y(n(11698)),f=n(5050),p=n(22861),g=n(96397);function y(t){return t&&t.__esModule?t:{default:t}}function m(t){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},m(t)}function v(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function b(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _(t){return _=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},_(t)}function A(t,e){return A=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},A(t,e)}function x(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var w=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&A(t,e)}(C,t);var e,n,y,w=(y=C,function(){var t,e=_(y);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}()){var n=_(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){return!e||"object"!==m(e)&&"function"!=typeof e?b(t):e}(this,t)});function C(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,C);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return x(b(t=w.call.apply(w,[this].concat(n))),"_selectedEditHandle",void 0),x(b(t),"_geometryBeingRotated",void 0),x(b(t),"_isRotating",!1),x(b(t),"_isSinglePointGeometrySelected",(function(t){var e=(t||{}).features;return!(!Array.isArray(e)||1!==e.length)&&"Point"===(0,u.getGeom)(e[0]).type})),x(b(t),"getIsRotating",(function(){return t._isRotating})),t}return e=C,(n=[{key:"getGuides",value:function(t){var e=this._geometryBeingRotated||this.getSelectedFeaturesAsFeatureCollection(t);if(this._isSinglePointGeometrySelected(e))return{type:"FeatureCollection",features:[]};if(this._isRotating)return(0,c.featureCollection)([(0,i.default)(e)]);var n=(0,s.default)((0,r.default)(e)),o=null,u=null,h=0;(0,l.coordEach)(n,(function(t){if(o){var e=(0,p.getIntermediatePosition)(t,o);(!u||e[1]>u[1])&&(u=e);var n=(0,a.default)(t,o);h=Math.max(h,n)}o=t}));var f=u&&[u[0],u[1]+h/1e3],g=(0,c.lineString)([u,f]),y=(0,c.point)(f,{guideType:"editHandle",editHandleType:"rotate"});return(0,c.featureCollection)([(0,d.default)(n),y,g])}},{key:"handleDragging",value:function(t,e){if(this._isRotating){var n=this.getRotateAction(t.pointerDownMapCoords,t.mapCoords,"rotating",e);n&&e.onEdit(n),t.cancelPan()}}},{key:"handlePointerMove",value:function(t,e){if(!this._isRotating){var n=(0,f.getPickedEditHandle)(t.picks);this._selectedEditHandle=n&&"rotate"===n.properties.editHandleType?n:null}this.updateCursor(e)}},{key:"handleStartDragging",value:function(t,e){this._selectedEditHandle&&(this._isRotating=!0,this._geometryBeingRotated=this.getSelectedFeaturesAsFeatureCollection(e))}},{key:"handleStopDragging",value:function(t,e){if(this._isRotating){var n=this.getRotateAction(t.pointerDownMapCoords,t.mapCoords,"rotated",e);n&&e.onEdit(n),this._geometryBeingRotated=null,this._selectedEditHandle=null,this._isRotating=!1}}},{key:"updateCursor",value:function(t){this._selectedEditHandle?t.onUpdateCursor("crosshair"):t.onUpdateCursor(null)}},{key:"getRotateAction",value:function(t,e,n,r){if(!this._geometryBeingRotated)return null;for(var s=(0,i.default)(this._geometryBeingRotated),a=function(t,e,n){var r=(0,o.default)(t,e);return(0,o.default)(t,n)-r}(s,t,e),l=(0,h.default)(this._geometryBeingRotated,a,{pivot:s}),u=new g.ImmutableFeatureCollection(r.data),c=r.selectedIndexes,d=0;d<c.length;d++){var f=c[d],p=l.features[d];u=u.replaceGeometry(f,p.geometry)}return{updatedData:u.getObject(),editType:n,editContext:{featureIndexes:c}}}}])&&v(e.prototype,n),C}(p.GeoJsonEditMode);e.RotateMode=w},56585:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ScaleMode=void 0;var r=y(n(25368)),i=y(n(30035)),o=y(n(17021)),s=y(n(6039)),a=n(85846),l=y(n(11698)),u=n(66030),c=y(n(78208)),h=y(n(39504)),d=n(74955),f=n(5050),p=n(22861),g=n(96397);function y(t){return t&&t.__esModule?t:{default:t}}function m(t){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},m(t)}function v(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function b(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function A(t){return A=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},A(t)}function x(t,e){return x=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},x(t,e)}function w(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var C=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&x(t,e)}(C,t);var e,n,p,y=(p=C,function(){var t,e=A(p);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}()){var n=A(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){return!e||"object"!==m(e)&&"function"!=typeof e?_(t):e}(this,t)});function C(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,C);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return w(_(t=y.call.apply(y,[this].concat(n))),"_geometryBeingScaled",void 0),w(_(t),"_selectedEditHandle",void 0),w(_(t),"_cornerGuidePoints",void 0),w(_(t),"_cursor",void 0),w(_(t),"_isScaling",!1),w(_(t),"_isSinglePointGeometrySelected",(function(t){var e=(t||{}).features;return!(!Array.isArray(e)||1!==e.length)&&"Point"===(0,d.getGeom)(e[0]).type})),w(_(t),"_getOppositeScaleHandle",(function(e){var n=e&&e.properties&&Array.isArray(e.properties.positionIndexes)&&e.properties.positionIndexes[0];if("number"!=typeof n)return null;var r=t._cornerGuidePoints.length,i=(n+r/2)%r;return t._cornerGuidePoints.find((function(t){return!!Array.isArray(t.properties.positionIndexes)&&t.properties.positionIndexes[0]===i}))})),w(_(t),"_getUpdatedData",(function(t,e){for(var n=new g.ImmutableFeatureCollection(t.data),r=t.selectedIndexes,i=0;i<r.length;i++){var o=r[i],s=e.features[i];n=n.replaceGeometry(o,s.geometry)}return n.getObject()})),w(_(t),"isEditHandleSelected",(function(){return Boolean(t._selectedEditHandle)})),w(_(t),"getScaleAction",(function(e,n,r,i){if(!t._selectedEditHandle)return null;var o=t._getOppositeScaleHandle(t._selectedEditHandle),s=(0,d.getCoord)(o),a=function(t,e,n){var r=(0,c.default)(t,e);return(0,c.default)(t,n)/r}(s,e,n),l=(0,h.default)(t._geometryBeingScaled,a,{origin:s});return{updatedData:t._getUpdatedData(i,l),editType:r,editContext:{featureIndexes:i.selectedIndexes}}})),w(_(t),"updateCursor",(function(e){if(t._selectedEditHandle){t._cursor&&e.onUpdateCursor(t._cursor);var n=t.getSelectedFeaturesAsFeatureCollection(e),r=(0,i.default)(n),s=(0,o.default)(r,t._selectedEditHandle),a=s<0?s+180:s;a>=0&&a<=90||a>=180&&a<=270?(t._cursor="nesw-resize",e.onUpdateCursor("nesw-resize")):(t._cursor="nwse-resize",e.onUpdateCursor("nwse-resize"))}else e.onUpdateCursor(null),t._cursor=null})),t}return e=C,(n=[{key:"handlePointerMove",value:function(t,e){if(!this._isScaling){var n=(0,f.getPickedEditHandle)(t.picks);this._selectedEditHandle=n&&"scale"===n.properties.editHandleType?n:null,this.updateCursor(e)}}},{key:"handleStartDragging",value:function(t,e){this._selectedEditHandle&&(this._isScaling=!0,this._geometryBeingScaled=this.getSelectedFeaturesAsFeatureCollection(e))}},{key:"handleDragging",value:function(t,e){if(this._isScaling){e.onUpdateCursor(this._cursor);var n=this.getScaleAction(t.pointerDownMapCoords,t.mapCoords,"scaling",e);n&&e.onEdit(n),t.cancelPan()}}},{key:"handleStopDragging",value:function(t,e){if(this._isScaling){var n=this.getScaleAction(t.pointerDownMapCoords,t.mapCoords,"scaled",e);n&&e.onEdit(n),e.onUpdateCursor(null),this._geometryBeingScaled=null,this._selectedEditHandle=null,this._cursor=null,this._isScaling=!1}}},{key:"getGuides",value:function(t){this._cornerGuidePoints=[];var e=this.getSelectedFeaturesAsFeatureCollection(t);if(this._isSinglePointGeometrySelected(e))return{type:"FeatureCollection",features:[]};var n=(0,s.default)((0,r.default)(e));n.properties.mode="scale";var i,o=[];return(0,u.coordEach)(n,(function(t,e){if(e<4){var n=(0,a.point)(t,{guideType:"editHandle",editHandleType:"scale",positionIndexes:[e]});o.push(n)}})),this._cornerGuidePoints=o,(0,a.featureCollection)([(0,l.default)(n)].concat(function(t){if(Array.isArray(t))return v(t)}(i=this._cornerGuidePoints)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(i)||function(t,e){if(t){if("string"==typeof t)return v(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?v(t,e):void 0}}(i)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()))}}])&&b(e.prototype,n),C}(p.GeoJsonEditMode);e.ScaleMode=C},46279:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SnappableMode=void 0;var r=n(5050);function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function o(t){return function(t){if(Array.isArray(t))return a(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||s(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(t,e){if(t){if("string"==typeof t)return a(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(t,e):void 0}}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function l(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function u(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function h(t){return h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},h(t)}function d(t,e){return d=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},d(t,e)}function f(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&d(t,e)}(g,t);var e,n,a,p=(a=g,function(){var t,e=h(a);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}()){var n=h(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){return!e||"object"!==i(e)&&"function"!=typeof e?c(t):e}(this,t)});function g(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,g),f(c(e=p.call(this)),"_handler",void 0),e._handler=t,e}return e=g,n=[{key:"_getSnappedMouseEvent",value:function(t,e,n){return Object.assign(t,{mapCoords:n.geometry.coordinates,pointerDownMapCoords:e&&e.geometry.coordinates})}},{key:"_getPickedSnapTarget",value:function(t){return(0,r.getPickedEditHandles)(t).find((function(t){return"snap-target"===t.properties.editHandleType}))}},{key:"_getPickedSnapSource",value:function(t){return(0,r.getPickedSnapSourceEditHandle)(t)}},{key:"_getUpdatedSnapSourceHandle",value:function(t,e){var n=t.properties,r=n.featureIndex,i=n.positionIndexes;if(!Array.isArray(i))return t;var o=e.features[r];return function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?l(Object(n),!0).forEach((function(e){f(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},t,{geometry:{type:"Point",coordinates:i.reduce((function(t,e){return t[e]}),o.geometry.coordinates)}})}},{key:"_getSnapTargets",value:function(t){var e=(t.modeConfig||{}).additionalSnapTargets;return e=e||[],[].concat(o(t.data.features),o(e))}},{key:"_getSnapTargetHandles",value:function(t){for(var e=[],n=this._getSnapTargets(t),i=0;i<n.length;i++)if(!t.selectedIndexes.includes(i)){var s=n[i].geometry;e.push.apply(e,o((0,r.getEditHandlesForGeometry)(s,i,"snap-target")))}return e}},{key:"getGuides",value:function(t){var e=t.modeConfig,n=t.lastPointerMoveEvent,i=(e||{}).enableSnapping,a={type:"FeatureCollection",features:o(this._handler.getGuides(t).features)};if(!i)return a;var l,u=n&&this._getPickedSnapSource(n.pointerDownPicks);if(u)return(l=a.features).push.apply(l,o(this._getSnapTargetHandles(t)).concat([this._getUpdatedSnapSourceHandle(u,t.data)])),a;var c,h=t.data.features,d=function(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=s(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return o=t.done,t},e:function(t){a=!0,i=t},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}(t.selectedIndexes);try{for(d.s();!(c=d.n()).done;){var f=c.value;if(f<h.length){var p,g=h[f].geometry;(p=a.features).push.apply(p,o((0,r.getEditHandlesForGeometry)(g,f,"snap-source")))}}}catch(t){d.e(t)}finally{d.f()}return a}},{key:"_getSnapAwareEvent",value:function(t,e){var n=this._getPickedSnapSource(e.lastPointerMoveEvent.pointerDownPicks),r=this._getPickedSnapTarget(t.picks);return n&&r?this._getSnappedMouseEvent(t,n,r):t}},{key:"handleStartDragging",value:function(t,e){this._handler.handleStartDragging(t,e)}},{key:"handleStopDragging",value:function(t,e){this._handler.handleStopDragging(this._getSnapAwareEvent(t,e),e)}},{key:"handleDragging",value:function(t,e){this._handler.handleDragging(this._getSnapAwareEvent(t,e),e)}},{key:"handlePointerMove",value:function(t,e){this._handler.handlePointerMove(this._getSnapAwareEvent(t,e),e)}}],n&&u(e.prototype,n),g}(n(22861).GeoJsonEditMode);e.SnappableMode=p},17186:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SplitPolygonMode=void 0;var r=y(n(68081)),i=y(n(84136)),o=y(n(36593)),s=y(n(38937)),a=n(85846),l=y(n(17021)),u=y(n(78208)),c=y(n(92091)),h=y(n(11698)),d=y(n(40533)),f=n(5050),p=n(22861),g=n(96397);function y(t){return t&&t.__esModule?t:{default:t}}function m(t){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},m(t)}function v(t,e){if(t){if("string"==typeof t)return b(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?b(t,e):void 0}}function b(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function _(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function A(t){return A=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},A(t)}function x(t,e){return x=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},x(t,e)}var w=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&x(t,e)}(w,t);var e,n,p,y=(p=w,function(){var t,e=A(p);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}()){var n=A(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){return!e||"object"!==m(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,t)});function w(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,w),y.apply(this,arguments)}return e=w,(n=[{key:"calculateMapCoords",value:function(t,e,n){var r=n.modeConfig;if(!r||!r.lock90Degree||!t.length)return e;if(1===t.length){var i=t[0],o=this.getSelectedGeometry(n),s=(0,h.default)(o),p="FeatureCollection"===s.type?s.features:[s],g=Number.MAX_SAFE_INTEGER,y=null;if(p.forEach((function(t){var e=(0,d.default)(t,i),n=(0,u.default)(e,i);g>n&&(g=n,y=e)})),y){var m=(0,l.default)(i,y),b=(0,u.default)(i,e,{units:"meters"});return(0,c.default)(i,b,m,{units:"meters"}).geometry.coordinates}return e}var _,A,x=t[t.length-1],w=(_=(0,f.generatePointsParallelToLinePoints)(t[t.length-2],x,e),A=1,function(t){if(Array.isArray(t))return t}(_)||function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}}(_,A)||v(_,A)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0];return(0,d.default)((0,a.lineString)([x,w]),e).geometry.coordinates}},{key:"getGuides",value:function(t){var e=this.getClickSequence(),n={type:"FeatureCollection",features:[]};if(0===e.length||!t.lastPointerMoveEvent)return n;var r,i=t.lastPointerMoveEvent.mapCoords;return n.features.push({type:"Feature",properties:{guideType:"tentative"},geometry:{type:"LineString",coordinates:[].concat((r=e,function(t){if(Array.isArray(t))return b(t)}(r)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(r)||v(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),[this.calculateMapCoords(e,i,t)])}}),n}},{key:"handleClick",value:function(t,e){var n=this.getTentativeGuide(e),i=this.getSelectedGeometry(e);if(i){var o=this.getClickSequence();n&&"LineString"===n.geometry.type?o.push(n.geometry.coordinates[n.geometry.coordinates.length-1]):this.addClickSequence(t);var a={type:"Point",coordinates:o[o.length-1]},l=(0,r.default)(a,i);if(o.length>1&&n&&!l){if(this.resetClickSequence(),0===(0,s.default)(n,i).features.length)return;var u=this.splitPolygon(n,e);u&&e.onEdit(u)}}else console.warn("A polygon must be selected for splitting")}},{key:"handlePointerMove",value:function(t,e){e.onUpdateCursor("cell")}},{key:"splitPolygon",value:function(t,e){var n=this.getSelectedGeometry(e),r=e.selectedIndexes[0],s=e.modeConfig||{},a=s.gap,l=void 0===a?.1:a,u=s.units,c=void 0===u?"centimeters":u;0===l&&(l=.1,c="centimeters");var h=(0,o.default)(t,l,{units:c}),d=(0,i.default)(n,h);if(!d)return console.warn("Canceling edit. Split Polygon erased"),null;var f,p=d.geometry,y=p.type,m=p.coordinates;return f="Polygon"===y?m.map((function(t){return[t]})):m.reduce((function(t,e){return e.forEach((function(e){t.push([e])})),t}),[]),{updatedData:new g.ImmutableFeatureCollection(e.data).replaceGeometry(r,{type:"MultiPolygon",coordinates:f}).getObject(),editType:"split",editContext:{featureIndexes:[r]}}}}])&&_(e.prototype,n),w}(p.GeoJsonEditMode);e.SplitPolygonMode=w},49841:(t,e,n)=>{"use strict";function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function o(t,e,n){return o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=s(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}},o(t,e,n||t)}function s(t){return s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},s(t)}function a(t,e){return a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},a(t,e)}Object.defineProperty(e,"__esModule",{value:!0}),e.ThreeClickPolygonMode=void 0;var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(c,t);var e,n,l,u=(l=c,function(){var t,e=s(l);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}()){var n=s(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,t)});function c(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),u.apply(this,arguments)}return e=c,(n=[{key:"handleClick",value:function(t,e){this.addClickSequence(t);var n=this.getClickSequence(),r=this.getTentativeGuide(e);if(n.length>2&&r&&"Polygon"===r.geometry.type){var i=this.getAddFeatureOrBooleanPolygonAction(r.geometry,e);this.resetClickSequence(),i&&e.onEdit(i)}}},{key:"getGuides",value:function(t){var e=t.lastPointerMoveEvent,n=t.modeConfig,r=this.getClickSequence(),i={type:"FeatureCollection",features:[]};if(0===r.length)return i;var o=e.mapCoords;if(1===r.length)i.features.push({type:"Feature",properties:{guideType:"tentative"},geometry:{type:"LineString",coordinates:[r[0],o]}});else{var s=this.getThreeClickPolygon(r[0],r[1],o,n);s&&i.features.push({type:"Feature",properties:{guideType:"tentative"},geometry:s.geometry})}return i}},{key:"getThreeClickPolygon",value:function(t,e,n,r){return null}},{key:"handlePointerMove",value:function(t,e){e.onUpdateCursor("cell"),o(s(c.prototype),"handlePointerMove",this).call(this,t,e)}},{key:"createTentativeFeature",value:function(t){var e,n=t.lastPointerMoveEvent,r=this.getClickSequence(),i=n?[n.mapCoords]:[];return 2===r.length&&(e=this.getThreeClickPolygon(r[0],r[1],i[0],t.modeConfig)),e}}])&&i(e.prototype,n),c}(n(22861).GeoJsonEditMode);e.ThreeClickPolygonMode=l},64639:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TransformMode=void 0;var r=n(85846),i=n(99461),o=n(56585),s=n(62458);function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}function l(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function u(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function c(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function h(t,e,n){return h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=d(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}},h(t,e,n||t)}function d(t){return d=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},d(t)}function f(t,e){return f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},f(t,e)}var p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&f(t,e)}(y,t);var e,n,p,g=(p=y,function(){var t,e=d(p);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}()){var n=d(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){return!e||"object"!==a(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,t)});function y(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,y),g.call(this,[new i.TranslateMode,new o.ScaleMode,new s.RotateMode])}return e=y,n=[{key:"handlePointerMove",value:function(t,e){var n=null;h(d(y.prototype),"handlePointerMove",this).call(this,t,function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?l(Object(n),!0).forEach((function(e){u(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},e,{onUpdateCursor:function(t){n=t||n}})),e.onUpdateCursor(n)}},{key:"handleStartDragging",value:function(t,e){var n=null,r=null,s=[];this._modes.forEach((function(t){t instanceof i.TranslateMode?r=t:(t instanceof o.ScaleMode&&(n=t),s.push(t))})),n instanceof o.ScaleMode&&!n.isEditHandleSelected()&&s.push(r),s.filter(Boolean).forEach((function(n){return n.handleStartDragging(t,e)}))}},{key:"getGuides",value:function(t){var e=h(d(y.prototype),"getGuides",this).call(this,t),n=(this._modes||[]).find((function(t){return t instanceof s.RotateMode}));if(n instanceof s.RotateMode){var i=e.features.filter((function(t){var e=t.properties||{},r=e.editHandleType,i=[e.mode];return n.getIsRotating()&&i.push(r),!i.includes("scale")}));e=(0,r.featureCollection)(i)}return e}}],n&&c(e.prototype,n),y}(n(14646).CompositeMode);e.TransformMode=p},99461:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TranslateMode=void 0;var r=h(n(17021)),i=h(n(78208)),o=h(n(52580)),s=n(85846),a=h(n(61361)),l=n(5050),u=n(22861),c=n(96397);function h(t){return t&&t.__esModule?t:{default:t}}function d(t){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},d(t)}function f(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function p(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function g(t){return g=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},g(t)}function y(t,e){return y=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},y(t,e)}function m(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var v=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&y(t,e)}(v,t);var e,n,u,h=(u=v,function(){var t,e=g(u);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}()){var n=g(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){return!e||"object"!==d(e)&&"function"!=typeof e?p(t):e}(this,t)});function v(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,v);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return m(p(t=h.call.apply(h,[this].concat(n))),"_geometryBeforeTranslate",void 0),m(p(t),"_isTranslatable",void 0),t}return e=v,(n=[{key:"handleDragging",value:function(t,e){if(this._isTranslatable){if(this._geometryBeforeTranslate){var n=this.getTranslateAction(t.pointerDownMapCoords,t.mapCoords,"translating",e);n&&e.onEdit(n)}t.cancelPan()}}},{key:"handlePointerMove",value:function(t,e){this._isTranslatable=this.isSelectionPicked(t.pointerDownPicks||t.picks,e),this.updateCursor(e)}},{key:"handleStartDragging",value:function(t,e){this._isTranslatable&&(this._geometryBeforeTranslate=this.getSelectedFeaturesAsFeatureCollection(e))}},{key:"handleStopDragging",value:function(t,e){if(this._geometryBeforeTranslate){var n=this.getTranslateAction(t.pointerDownMapCoords,t.mapCoords,"translated",e);n&&e.onEdit(n),this._geometryBeforeTranslate=null}}},{key:"updateCursor",value:function(t){this._isTranslatable?t.onUpdateCursor("move"):t.onUpdateCursor(null)}},{key:"getTranslateAction",value:function(t,e,n,u){var h=this;if(!this._geometryBeforeTranslate)return null;var d=new c.ImmutableFeatureCollection(u.data),f=u.selectedIndexes,p=u.modeConfig||{},g=p.viewport,y=p.screenSpace;if(g&&y)!function(){for(var n=g.project?g:new a.default(g),r=n.project(t),i=n.project(e),o=i[0]-r[0],s=i[1]-r[1],u=0;u<f.length;u++){var c=f[u],p=h._geometryBeforeTranslate.features[u],y=p.geometry.coordinates;y&&(y=(0,l.mapCoords)(y,(function(t){var e=n.project(t);return e?(e[0]+=o,e[1]+=s,n.unproject(e)):null})),d=d.replaceGeometry(c,{type:p.geometry.type,coordinates:y}))}}();else for(var m=(0,s.point)(t),v=(0,s.point)(e),b=(0,i.default)(m,v),_=(0,r.default)(m,v),A=(0,o.default)(this._geometryBeforeTranslate,b,_),x=0;x<f.length;x++){var w=f[x],C=A.features[x];d=d.replaceGeometry(w,C.geometry)}return{updatedData:d.getObject(),editType:n,editContext:{featureIndexes:f}}}}])&&f(e.prototype,n),v}(u.GeoJsonEditMode);e.TranslateMode=v},98675:(t,e,n)=>{"use strict";function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function o(t,e,n){return o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=s(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}},o(t,e,n||t)}function s(t){return s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},s(t)}function a(t,e){return a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},a(t,e)}Object.defineProperty(e,"__esModule",{value:!0}),e.TwoClickPolygonMode=void 0;var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(c,t);var e,n,l,u=(l=c,function(){var t,e=s(l);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}()){var n=s(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,t)});function c(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),u.apply(this,arguments)}return e=c,(n=[{key:"handleClick",value:function(t,e){e.modeConfig&&e.modeConfig.dragToDraw||(this.addClickSequence(t),this.checkAndFinishPolygon(e))}},{key:"handleStartDragging",value:function(t,e){e.modeConfig&&e.modeConfig.dragToDraw&&(this.addClickSequence(t),t.cancelPan())}},{key:"handleStopDragging",value:function(t,e){e.modeConfig&&e.modeConfig.dragToDraw&&(this.addClickSequence(t),this.checkAndFinishPolygon(e))}},{key:"checkAndFinishPolygon",value:function(t){var e=this.getClickSequence(),n=this.getTentativeGuide(t);if(e.length>1&&n&&"Polygon"===n.geometry.type){var r={type:"Feature",properties:{shape:n.properties.shape},geometry:{type:"Polygon",coordinates:n.geometry.coordinates}},i=this.getAddFeatureOrBooleanPolygonAction(r,t);this.resetClickSequence(),i&&t.onEdit(i)}}},{key:"getGuides",value:function(t){var e=t.lastPointerMoveEvent,n=t.modeConfig,r=this.getClickSequence(),i={type:"FeatureCollection",features:[]};if(0===r.length)return i;var o=r[0],s=e.mapCoords,a=this.getTwoClickPolygon(o,s,n);return a&&i.features.push({type:"Feature",properties:{shape:a.properties&&a.properties.shape,guideType:"tentative"},geometry:a.geometry}),i}},{key:"getTwoClickPolygon",value:function(t,e,n){return null}},{key:"handlePointerMove",value:function(t,e){e.onUpdateCursor("cell"),o(s(c.prototype),"handlePointerMove",this).call(this,t,e)}},{key:"createTentativeFeature",value:function(t){var e,n=t.lastPointerMoveEvent,r=this.getClickSequence(),i=n?[n.mapCoords]:[];return 1===r.length&&(e=this.getTwoClickPolygon(r[0],i[0],t.modeConfig)),e}}])&&i(e.prototype,n),c}(n(22861).GeoJsonEditMode);e.TwoClickPolygonMode=l},81872:(t,e,n)=>{"use strict";function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function i(t){return i=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},i(t)}function o(t,e){return o=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},o(t,e)}Object.defineProperty(e,"__esModule",{value:!0}),e.ViewMode=void 0;var s=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&o(t,e)}(s,t);var e,n=(e=s,function(){var t,n=i(e);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}()){var o=i(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return function(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,t)});function s(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),n.apply(this,arguments)}return s}(n(22861).GeoJsonEditMode);e.ViewMode=s},67095:(t,e)=>{"use strict";function n(t,e){if(t===e)return!0;if(Array.isArray(t)){var n=t.length;if(!e||e.length!==n)return!1;for(var r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}return!1}Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){var e,r={};return function(i){for(var o in i)if(!n(i[o],r[o])){e=t(i),r=i;break}return e}}},5050:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.toDeckColor=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[255,0,0,255];return Array.isArray(t)?[255*t[0],255*t[1],255*t[2],255*t[3]]:e},e.recursivelyTraverseNestedArrays=function t(e,n,r){if(!Array.isArray(e[0]))return!0;for(var i=0;i<e.length;i++)if(t(e[i],[].concat(d(n),[i]),r)){r(e,n);break}return!1},e.generatePointsParallelToLinePoints=function(t,e,n){var s={type:"LineString",coordinates:[t,e]},l=(0,a.point)(n),u=(0,o.default)(l,s),c=(0,i.default)(t,e),h=(n[0]-t[0])*(e[1]-t[1])-(n[1]-t[1])*(e[0]-t[0])<0?c-90:c-270,d=(0,r.default)(e,u,h),f=(0,r.default)(t,u,h);return[d.geometry.coordinates,f.geometry.coordinates]},e.distance2d=g,e.mix=y,e.nearestPointOnProjectedLine=function(t,e,n){var r=new u.default(n),i=t.geometry.coordinates.map((function(t){var e=h(t,3),n=e[0],i=e[1],o=e[2],s=void 0===o?0:o;return r.project([n,i,s])})),o=h(r.project(e.geometry.coordinates),2),s=o[0],a=o[1],l=1/0,c={};i.forEach((function(t,e){var n=h(t,2),r=n[0],o=n[1];if(0!==e){var u=h(i[e-1],2),d=u[0],f=u[1],p=f-o,g=r-d,y=d*o-r*f,m=p*p+g*g,v=Math.abs(p*s+g*a+y)/Math.sqrt(m);v<l&&(l=v,c={index:e,x0:(g*(g*s-p*a)-p*y)/m,y0:(p*(-g*s+p*a)-g*y)/m})}}));var d=c,f=d.index,p=d.x0,m=d.y0,v=h(i[f-1],3),b=v[0],_=v[1],A=v[2],x=void 0===A?0:A,w=h(i[f],3),C=w[0],S=w[1],E=w[2],M=void 0===E?0:E,P=g(b,_,C,S),T=y(x,M,g(b,_,p,m)/P);return{type:"Feature",geometry:{type:"Point",coordinates:r.unproject([p,m,T])},properties:{dist:l,index:f-1}}},e.nearestPointOnLine=function(t,e,n){var r,i,o;n&&(o=new u.default(n));var c=(0,a.point)([1/0,1/0],{dist:1/0});return!(null===(r=t.geometry)||void 0===r?void 0:r.coordinates.length)||(null===(i=t.geometry)||void 0===i?void 0:i.coordinates.length)<2||(0,s.flattenEach)(t,(function(t){var n,r,i,s,u,h,d,f=(0,l.getCoords)(t),p=(0,l.getCoords)(e);if(f.length>1&&p.length){var g,y;o?(g=f.map((function(t){return o.project(t)})),y=o.project(p)):(g=f,y=p);for(var m=1;m<g.length;m++){if(g[m][0]!==g[m-1][0]){var v=(g[m][1]-g[m-1][1])/(g[m][0]-g[m-1][0]),b=g[m][1]-v*g[m][0];d=Math.abs(v*y[0]+b-y[1])/Math.sqrt(v*v+1)}else d=Math.abs(y[0]-g[m][0]);var _=Math.pow(g[m][1]-g[m-1][1],2)+Math.pow(g[m][0]-g[m-1][0],2),A=Math.pow(g[m][1]-y[1],2)+Math.pow(g[m][0]-y[0],2),x=Math.pow(g[m-1][1]-y[1],2)+Math.pow(g[m-1][0]-y[0],2),w=Math.pow(d,2),C=A-w+x-w;C>_&&(d=Math.sqrt(Math.min(A,x))),(null==n||n>d)&&(C>_?x<A?(r=0,i=1):(i=0,r=1):(r=Math.sqrt(x-w)/Math.sqrt(_),i=Math.sqrt(A-w)/Math.sqrt(_)),n=d,h=m)}var S=g[h-1][0]-g[h][0],E=g[h-1][1]-g[h][1];s=g[h-1][0]-S*r,u=g[h-1][1]-E*r}var M={x:s,y:u,idx:h-1,to:r,from:i};if(o){var P=o.unproject([M.x,M.y]);M={x:P[0],y:P[1],idx:h-1,to:r,from:i}}c=(0,a.point)([M.x,M.y],{dist:Math.abs(M.from-M.to),index:M.idx})})),c},e.getPickedEditHandle=function(t){var e=m(t);return e.length?e[0]:null},e.getPickedSnapSourceEditHandle=function(t){return m(t).find((function(t){return"snap-source"===t.properties.editHandleType}))},e.getNonGuidePicks=function(t){return t&&t.filter((function(t){return!t.isGuide}))},e.getPickedExistingEditHandle=function(t){return m(t).find((function(t){var e=t.properties;return e.featureIndex>=0&&"existing"===e.editHandleType}))},e.getPickedIntermediateEditHandle=function(t){return m(t).find((function(t){var e=t.properties;return e.featureIndex>=0&&"intermediate"===e.editHandleType}))},e.getPickedEditHandles=m,e.getEditHandlesForGeometry=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"existing",r=[];switch(t.type){case"Point":r=[{type:"Feature",properties:{guideType:"editHandle",editHandleType:n,positionIndexes:[],featureIndex:e},geometry:{type:"Point",coordinates:t.coordinates}}];break;case"MultiPoint":case"LineString":r=r.concat(v(t.coordinates,[],e,n));break;case"Polygon":case"MultiLineString":for(var i=0;i<t.coordinates.length;i++)r=r.concat(v(t.coordinates[i],[i],e,n)),"Polygon"===t.type&&(r=r.slice(0,-1));break;case"MultiPolygon":for(var o=0;o<t.coordinates.length;o++)for(var s=0;s<t.coordinates[o].length;s++)r=(r=r.concat(v(t.coordinates[o][s],[o,s],e,n))).slice(0,-1);break;default:throw Error("Unhandled geometry type: ".concat(t.type))}return r},e.updateRectanglePosition=function(t,e,n){var r=t.geometry.coordinates;if(!r)return null;var i=r[0].slice(0,4);i[e%4]=n;var o=i[(e+2)%4],s=i[e%4];return i[(e+1)%4]=[s[0],o[1]],i[(e+3)%4]=[o[0],s[1]],[[].concat(d(i),[i[0]])]},e.mapCoords=function t(e,n){return"number"==typeof e[0]?!isNaN(e[0])&&isFinite(e[0])?n(e):e:e.map((function(e){return t(e,n)})).filter(Boolean)};var r=c(n(92091)),i=c(n(17021)),o=c(n(92024)),s=n(66030),a=n(85846),l=n(74955),u=c(n(61361));function c(t){return t&&t.__esModule?t:{default:t}}function h(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}}(t,e)||f(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(t){return function(t){if(Array.isArray(t))return p(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||f(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(t,e){if(t){if("string"==typeof t)return p(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(t,e):void 0}}function p(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function g(t,e,n,r){var i=t-n,o=e-r;return Math.sqrt(i*i+o*o)}function y(t,e,n){return e*n+t*(1-n)}function m(t){return t&&t.filter((function(t){return t.isGuide&&"editHandle"===t.object.properties.guideType})).map((function(t){return t.object}))||[]}function v(t,e,n){for(var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"existing",i=[],o=0;o<t.length;o++){var s=t[o];i.push({type:"Feature",properties:{guideType:"editHandle",positionIndexes:[].concat(d(e),[o]),featureIndex:n,editHandleType:r},geometry:{type:"Point",coordinates:s}})}return i}},61361:(t,e,n)=>{"use strict";n.r(e),n.d(e,{MAX_LATITUDE:()=>r.MAX_LATITUDE,WebMercatorViewport:()=>r.WebMercatorViewport,addMetersToLngLat:()=>r.addMetersToLngLat,altitudeToFovy:()=>r.altitudeToFovy,default:()=>r.WebMercatorViewport,fitBounds:()=>r.fitBounds,flyToViewport:()=>r.flyToViewport,fovyToAltitude:()=>r.fovyToAltitude,getBounds:()=>r.getBounds,getDistanceScales:()=>r.getDistanceScales,getFlyToDuration:()=>r.getFlyToDuration,getMeterZoom:()=>r.getMeterZoom,getProjectionMatrix:()=>r.getProjectionMatrix,getProjectionParameters:()=>r.getProjectionParameters,getViewMatrix:()=>r.getViewMatrix,lngLatToWorld:()=>r.lngLatToWorld,normalizeViewportProps:()=>r.normalizeViewportProps,pixelsToWorld:()=>r.pixelsToWorld,scaleToZoom:()=>r.scaleToZoom,unitsPerMeter:()=>r.unitsPerMeter,worldToLngLat:()=>r.worldToLngLat,worldToPixels:()=>r.worldToPixels,zoomToScale:()=>r.zoomToScale});var r=n(649)},83723:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.UNIT=e.PROJECTED_PIXEL_SIZE_MULTIPLIER=void 0,e.PROJECTED_PIXEL_SIZE_MULTIPLIER=2/3,e.UNIT={common:0,meters:1,pixels:2}},75130:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"ArrowStyles",{enumerable:!0,get:function(){return r.ArrowStyles}}),Object.defineProperty(e,"DEFAULT_ARROWS",{enumerable:!0,get:function(){return r.DEFAULT_ARROWS}}),Object.defineProperty(e,"MAX_ARROWS",{enumerable:!0,get:function(){return r.MAX_ARROWS}}),Object.defineProperty(e,"EditableGeoJsonLayer",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(e,"EditableH3ClusterLayer",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(e,"SelectionLayer",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(e,"ElevatedEditHandleLayer",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(e,"PathOutlineLayer",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(e,"PathMarkerLayer",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(e,"JunctionScatterplotLayer",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(e,"toDeckColor",{enumerable:!0,get:function(){return h.toDeckColor}});var r=n(59155),i=d(n(94111)),o=d(n(34600)),s=d(n(7439)),a=d(n(31983)),l=d(n(23780)),u=d(n(59698)),c=d(n(4809)),h=n(65003);function d(t){return t&&t.__esModule?t:{default:t}}},94111:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n(23863),i=n(13343),o=n(83723),s=l(n(63309)),a=l(n(74697));function l(t){return t&&t.__esModule?t:{default:t}}function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function c(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function h(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function d(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function f(t,e,n){return f="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=p(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}},f(t,e,n||t)}function p(t){return p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},p(t)}function g(t,e){return g=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},g(t,e)}function y(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var m=[0,0,0,153],v=[0,0,0,144],b=[0,0,0,255],_=[0,0,144,144],A=[144,144,144,255],x=[144,144,144,144],w=[192,0,0,255],C=[0,0,0,128],S=[124,0,192,255],E=[255,255,255,255],M=32*o.PROJECTED_PIXEL_SIZE_MULTIPLIER,P=i.DrawPolygonMode;function T(t){return t&&"function"==typeof t?function(e){return t(function(t){return t.__source?t.__source.object:t.sourceFeature?t.sourceFeature.feature:t}(e))}:t}function O(t){switch(t.properties.editHandleType){case"existing":return w;case"snap-source":return S;default:return C}}var I={mode:P,onEdit:function(){},pickable:!0,pickingRadius:10,pickingDepth:5,fp64:!1,filled:!0,stroked:!0,lineWidthScale:o.PROJECTED_PIXEL_SIZE_MULTIPLIER,lineWidthMinPixels:1,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,pickingLineWidthExtraPixels:0,lineWidthUnits:"pixels",lineJointRounded:!1,lineCapRounded:!1,lineMiterLimit:4,pointRadiusScale:1,pointRadiusMinPixels:2,pointRadiusMaxPixels:Number.MAX_SAFE_INTEGER,getLineColor:function(t,e,n){return e?b:m},getFillColor:function(t,e,n){return e?_:v},getRadius:function(t){return t&&t.properties&&t.properties.radius||t&&t.properties&&t.properties.size||1},getLineWidth:function(t){return t&&t.properties&&t.properties.lineWidth||3},getTentativeLineColor:function(t){return A},getTentativeFillColor:function(t){return x},getTentativeLineWidth:function(t){return t&&t.properties&&t.properties.lineWidth||3},editHandleType:"point",editHandlePointRadiusScale:1,editHandlePointOutline:!0,editHandlePointStrokeWidth:2,editHandlePointRadiusUnits:"pixels",editHandlePointRadiusMinPixels:4,editHandlePointRadiusMaxPixels:8,getEditHandlePointColor:O,getEditHandlePointOutlineColor:function(t){return E},getEditHandlePointRadius:function(t){switch(t.properties.editHandleType){case"existing":return 5;case"snap":return 7;default:return 3}},editHandleIconAtlas:null,editHandleIconMapping:null,editHandleIconSizeScale:1,editHandleIconSizeUnits:"pixels",getEditHandleIcon:function(t){return t.properties.editHandleType},getEditHandleIconSize:10,getEditHandleIconColor:O,getEditHandleIconAngle:0,billboard:!0},R={view:i.ViewMode,modify:i.ModifyMode,translate:new i.SnappableMode(new i.TranslateMode),transform:new i.SnappableMode(new i.TransformMode),scale:i.ScaleMode,rotate:i.RotateMode,duplicate:i.DuplicateMode,split:i.SplitPolygonMode,extrude:i.ExtrudeMode,elevation:i.ElevationMode,drawPoint:i.DrawPointMode,drawLineString:i.DrawLineStringMode,drawPolygon:i.DrawPolygonMode,drawRectangle:i.DrawRectangleMode,drawRectangleFromCenter:i.DrawRectangleFromCenterMode,drawSquareFromCenter:i.DrawSquareFromCenterMode,drawCircleFromCenter:i.DrawCircleFromCenterMode,drawCircleByBoundingBox:i.DrawCircleByDiameterMode,drawEllipseByBoundingBox:i.DrawEllipseByBoundingBoxMode,drawRectangleUsing3Points:i.DrawRectangleUsingThreePointsMode,drawEllipseUsing3Points:i.DrawEllipseUsingThreePointsMode,draw90DegreePolygon:i.Draw90DegreePolygonMode,drawPolygonByDragging:i.DrawPolygonByDraggingMode},B=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&g(t,e)}(s,t);var e,n,i,o=(i=s,function(){var t,e=p(i);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}()){var n=p(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){return!e||"object"!==u(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,t)});function s(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),o.apply(this,arguments)}return e=s,n=[{key:"renderLayers",value:function(){var t=this.getSubLayerProps({id:"geojson",data:this.props.data,fp64:this.props.fp64,filled:this.props.filled,stroked:this.props.stroked,lineWidthScale:this.props.lineWidthScale,lineWidthMinPixels:this.props.lineWidthMinPixels,lineWidthMaxPixels:this.props.lineWidthMaxPixels,lineWidthUnits:this.props.lineWidthUnits,lineJointRounded:this.props.lineJointRounded,lineCapRounded:this.props.lineCapRounded,lineMiterLimit:this.props.lineMiterLimit,pointRadiusScale:this.props.pointRadiusScale,pointRadiusMinPixels:this.props.pointRadiusMinPixels,pointRadiusMaxPixels:this.props.pointRadiusMaxPixels,getLineColor:this.selectionAwareAccessor(this.props.getLineColor),getFillColor:this.selectionAwareAccessor(this.props.getFillColor),getPointRadius:this.selectionAwareAccessor(this.props.getRadius),getLineWidth:this.selectionAwareAccessor(this.props.getLineWidth),_subLayerProps:{linestrings:{billboard:this.props.billboard,updateTriggers:{all:[this.props.selectedFeatureIndexes,this.props.mode]}},"polygons-stroke":{billboard:this.props.billboard,pickingLineWidthExtraPixels:this.props.pickingLineWidthExtraPixels,type:a.default,updateTriggers:{all:[this.props.selectedFeatureIndexes,this.props.mode]}}},updateTriggers:{getLineColor:[this.props.selectedFeatureIndexes,this.props.mode],getFillColor:[this.props.selectedFeatureIndexes,this.props.mode],getPointRadius:[this.props.selectedFeatureIndexes,this.props.mode],getLineWidth:[this.props.selectedFeatureIndexes,this.props.mode]}}),e=[new r.GeoJsonLayer(t)];return e.concat(this.createGuidesLayers(),this.createTooltipsLayers())}},{key:"initializeState",value:function(){f(p(s.prototype),"initializeState",this).call(this),this.setState({selectedFeatures:[],editHandles:[]})}},{key:"shouldUpdateState",value:function(t){return f(p(s.prototype),"shouldUpdateState",this).call(this,t)||t.changeFlags.stateChanged}},{key:"updateState",value:function(t){var e,n=t.props,r=t.oldProps,i=t.changeFlags,o=t.context;f(p(s.prototype),"updateState",this).call(this,{oldProps:r,props:n,changeFlags:i,context:o}),!i.propsOrDataChanged||0!==Object.keys(r).length&&n.mode===r.mode||("function"==typeof n.mode?e=new(0,n.mode):"string"==typeof n.mode?(e=R[n.mode],console.warn("Deprecated use of passing `mode` as a string. Pass the mode's class constructor instead.")):e=n.mode,e||(console.warn("No mode configured for ".concat(String(n.mode))),e=new P),e!==this.state.mode&&this.setState({mode:e,cursor:null}));var a=[];Array.isArray(n.selectedFeatureIndexes)&&(a=n.selectedFeatureIndexes.map((function(t){return n.data.features[t]}))),this.setState({selectedFeatures:a})}},{key:"getModeProps",value:function(t){var e=this;return{modeConfig:t.modeConfig,data:t.data,selectedIndexes:t.selectedFeatureIndexes,lastPointerMoveEvent:this.state.lastPointerMoveEvent,cursor:this.state.cursor,onEdit:function(n){e.setNeedsUpdate(),t.onEdit(n)},onUpdateCursor:function(t){e.setState({cursor:t})}}}},{key:"selectionAwareAccessor",value:function(t){var e=this;return"function"!=typeof t?t:function(n){return t(n,e.isFeatureSelected(n),e.props.mode)}}},{key:"isFeatureSelected",value:function(t){if(!this.props.data||!this.props.selectedFeatureIndexes)return!1;if(!this.props.selectedFeatureIndexes.length)return!1;var e=this.props.data.features.indexOf(t);return this.props.selectedFeatureIndexes.includes(e)}},{key:"getPickingInfo",value:function(t){var e=t.info;return t.sourceLayer.id.endsWith("guides")&&(e.isGuide=!0),e}},{key:"_updateAutoHighlight",value:function(t){if(null==t?void 0:t.sourceLayer)if(t.isGuide){var e,n=function(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function(t,e){if(t){if("string"==typeof t)return h(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(t,e):void 0}}(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,s=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return o=t.done,t},e:function(t){s=!0,i=t},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw i}}}}(t.sourceLayer.getSubLayers());try{for(n.s();!(e=n.n()).done;)e.value.updateAutoHighlight(t)}catch(t){n.e(t)}finally{n.f()}}else t.sourceLayer.updateAutoHighlight(t)}},{key:"createGuidesLayers",value:function(){var t=this.getActiveMode().getGuides(this.getModeProps(this.props));if(!t||!t.features.length)return[];var e={linestrings:{billboard:this.props.billboard,autoHighlight:!1},"polygons-fill":{autoHighlight:!1},"polygons-stroke":{billboard:this.props.billboard}};return"icon"===this.props.editHandleType?e["points-icon"]={type:r.IconLayer,iconAtlas:this.props.editHandleIconAtlas,iconMapping:this.props.editHandleIconMapping,sizeUnits:this.props.editHandleIconSizeUnits,sizeScale:this.props.editHandleIconSizeScale,getIcon:T(this.props.getEditHandleIcon),getSize:T(this.props.getEditHandleIconSize),getColor:T(this.props.getEditHandleIconColor),getAngle:T(this.props.getEditHandleIconAngle)}:e["points-circle"]={type:r.ScatterplotLayer,radiusScale:this.props.editHandlePointRadiusScale,stroked:this.props.editHandlePointOutline,getLineWidth:this.props.editHandlePointStrokeWidth,radiusUnits:this.props.editHandlePointRadiusUnits,radiusMinPixels:this.props.editHandlePointRadiusMinPixels,radiusMaxPixels:this.props.editHandlePointRadiusMaxPixels,getRadius:T(this.props.getEditHandlePointRadius),getFillColor:T(this.props.getEditHandlePointColor),getLineColor:T(this.props.getEditHandlePointOutlineColor)},[new r.GeoJsonLayer(this.getSubLayerProps({id:"guides",data:t,fp64:this.props.fp64,_subLayerProps:e,lineWidthScale:this.props.lineWidthScale,lineWidthMinPixels:this.props.lineWidthMinPixels,lineWidthMaxPixels:this.props.lineWidthMaxPixels,lineWidthUnits:this.props.lineWidthUnits,lineJointRounded:this.props.lineJointRounded,lineCapRounded:this.props.lineCapRounded,lineMiterLimit:this.props.lineMiterLimit,getLineColor:T(this.props.getTentativeLineColor),getLineWidth:T(this.props.getTentativeLineWidth),getFillColor:T(this.props.getTentativeFillColor),pointType:"icon"===this.props.editHandleType?"icon":"circle",iconAtlas:this.props.editHandleIconAtlas}))]}},{key:"createTooltipsLayers",value:function(){var t=this.getActiveMode().getTooltips(this.getModeProps(this.props)),e=new r.TextLayer(function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?c(Object(n),!0).forEach((function(e){y(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({getSize:M},this.getSubLayerProps({id:"tooltips",data:t})));return[e]}},{key:"onLayerClick",value:function(t){this.getActiveMode().handleClick(t,this.getModeProps(this.props))}},{key:"onLayerKeyUp",value:function(t){this.getActiveMode().handleKeyUp(t,this.getModeProps(this.props))}},{key:"onStartDragging",value:function(t){this.getActiveMode().handleStartDragging(t,this.getModeProps(this.props))}},{key:"onDragging",value:function(t){this.getActiveMode().handleDragging(t,this.getModeProps(this.props))}},{key:"onStopDragging",value:function(t){this.getActiveMode().handleStopDragging(t,this.getModeProps(this.props))}},{key:"onPointerMove",value:function(t){this.setState({lastPointerMoveEvent:t}),this.getActiveMode().handlePointerMove(t,this.getModeProps(this.props))}},{key:"getCursor",value:function(t){var e=t.isDragging;if(null===this.state)return null;var n=this.state.cursor;return n||(n=e?"grabbing":"grab"),n}},{key:"getActiveMode",value:function(){return this.state.mode}}],n&&d(e.prototype,n),s}(s.default);e.default=B,y(B,"layerName","EditableGeoJsonLayer"),y(B,"defaultProps",I)},34600:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n(64949),i=n(13343),o=n(54923),s=n(83723),a=u(n(94111)),l=u(n(63309));function u(t){return t&&t.__esModule?t:{default:t}}function c(t){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c(t)}function h(t){return function(t){if(Array.isArray(t))return d(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return d(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function f(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function p(t,e,n){return p="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=g(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}},p(t,e,n||t)}function g(t){return g=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},g(t)}function y(t,e){return y=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},y(t,e)}function m(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function v(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?m(Object(n),!0).forEach((function(e){b(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function b(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var _=i.ViewMode,A={type:"FeatureCollection",features:[]},x=v({mode:_},a.default.defaultProps,{data:[],selectedIndexes:[],filled:!1,stroked:!0,lineWidthScale:s.PROJECTED_PIXEL_SIZE_MULTIPLIER,lineWidthMinPixels:1,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,lineWidthUnits:"pixels",getHexagons:function(t){return t.hexIds},getEditedCluster:function(t,e){return e?v({},e,{hexIds:t}):{hexIds:t}},resolution:9}),w=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&y(t,e)}(l,t);var e,n,i,s=(i=l,function(){var t,e=g(i);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}()){var n=g(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){return!e||"object"!==c(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,t)});function l(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),s.apply(this,arguments)}return e=l,(n=[{key:"initializeState",value:function(){p(g(l.prototype),"initializeState",this).call(this),this.setState({tentativeHexagonIDs:[]})}},{key:"getDerivedHexagonIDs",value:function(t){return(0,o.polyfill)(t,this.props.resolution,!0)}},{key:"getDerivedHexagonID",value:function(t){return(0,o.geoToH3)(t[1],t[0],this.props.resolution)}},{key:"renderLayers",value:function(){var t=this;return[new a.default(this.getSubLayerProps({id:"editable-geojson",mode:this.props.mode,data:A,selectedFeatureIndexes:[],onEdit:function(e){var n=e.editType,r=e.editContext;switch(n){case"updateTentativeFeature":if("Polygon"===r.feature.geometry.type){var i=r.feature.geometry.coordinates,o=t.getDerivedHexagonIDs(i);t.setState({tentativeHexagonIDs:o})}else if("Point"===r.feature.geometry.type){var s=r.feature.geometry.coordinates,a=t.getDerivedHexagonID(s);t.setState({tentativeHexagonIDs:[a]})}break;case"addFeature":var l=h(t.props.data),u=t.props.modeConfig;if(u&&u.booleanOperation)if(1!==t.props.selectedIndexes.length)console.warn("booleanOperation only supported for single cluster selection");else{var c,d=new Set(t.getSelectedHexIDs()),f=new Set(t.state.tentativeHexagonIDs);switch(u.booleanOperation){case"union":default:c=h(new Set([].concat(h(d),h(f))));break;case"intersection":c=h(d).filter((function(t){return f.has(t)}));break;case"difference":c=h(d).filter((function(t){return!f.has(t)}))}var p=t.props.selectedIndexes[0],g=t.props.data[p];l[p]=t.props.getEditedCluster(c,g)}else l.push(t.props.getEditedCluster(t.state.tentativeHexagonIDs,null));t.setState({tentativeHexagonIDs:[]}),t.props.onEdit({updatedData:l})}}})),new r.H3ClusterLayer(this.getSubLayerProps({id:"hexagons",data:this.props.data,getHexagons:this.props.getHexagons})),new r.H3ClusterLayer(this.getSubLayerProps({id:"tentative-hexagons",data:[{hexIds:this.state.tentativeHexagonIDs}],getHexagons:function(t){return t.hexIds}}))]}},{key:"getSelectedHexIDs",value:function(){var t=this,e=[];return this.props.selectedIndexes.forEach((function(n){var r=t.props.data[n],i=t.props.getHexagons(r);e=e.concat(i)})),e}},{key:"getCursor",value:function(t){var e=t.isDragging,n=(this.state||{}).cursor;return n||(n=e?"grabbing":"grab"),n}}])&&f(e.prototype,n),l}(l.default);e.default=w,b(w,"layerName","EditableH3ClusterLayer"),b(w,"defaultProps",x)},63309:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n(98265);function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function o(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function s(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?o(Object(n),!0).forEach((function(e){d(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function a(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function(t,e){if(t){if("string"==typeof t)return l(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(t,e):void 0}}(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,s=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return o=t.done,t},e:function(t){s=!0,i=t},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw i}}}}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function u(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function c(t){return c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},c(t)}function h(t,e){return h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},h(t,e)}function d(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var f=["anyclick","pointermove","panstart","panmove","panend","keyup"],p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&h(t,e)}(l,t);var e,n,r,o=(r=l,function(){var t,e=c(r);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}()){var n=c(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){return!e||"object"!==i(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,t)});function l(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),o.apply(this,arguments)}return e=l,(n=[{key:"onLayerClick",value:function(t){}},{key:"onStartDragging",value:function(t){}},{key:"onStopDragging",value:function(t){}},{key:"onDragging",value:function(t){}},{key:"onPointerMove",value:function(t){}},{key:"onLayerKeyUp",value:function(t){}},{key:"initializeState",value:function(){this.setState({_editableLayerState:{pointerDownPicks:null,pointerDownScreenCoords:null,pointerDownMapCoords:null,eventHandler:this._forwardEventToCurrentLayer.bind(this)}}),this._addEventHandlers()}},{key:"finalizeState",value:function(){this._removeEventHandlers()}},{key:"_addEventHandlers",value:function(){var t,e=this.context.deck.eventManager,n=this.state._editableLayerState.eventHandler,r=a(f);try{for(r.s();!(t=r.n()).done;){var i=t.value;e.on(i,n,{priority:100})}}catch(t){r.e(t)}finally{r.f()}}},{key:"_removeEventHandlers",value:function(){var t,e=this.context.deck.eventManager,n=this.state._editableLayerState.eventHandler,r=a(f);try{for(r.s();!(t=r.n()).done;){var i=t.value;e.off(i,n)}}catch(t){r.e(t)}finally{r.f()}}},{key:"_forwardEventToCurrentLayer",value:function(t){var e=this.getCurrentLayer(),n=e["_on".concat(t.type)].bind(e);n?n(t):console.warn("no handler for mjolnir.js event ".concat(t.type))}},{key:"_onanyclick",value:function(t){var e=t.srcEvent,n=this.getScreenCoords(e),r=this.getMapCoords(n),i=this.getPicks(n);this.onLayerClick({mapCoords:r,screenCoords:n,picks:i,sourceEvent:e})}},{key:"_onkeyup",value:function(t){var e=t.srcEvent;this.onLayerKeyUp(e)}},{key:"_onpanstart",value:function(t){var e=this.getScreenCoords(t.srcEvent),n=this.getMapCoords(e),r=this.getPicks(e);this.setState({_editableLayerState:s({},this.state._editableLayerState,{pointerDownScreenCoords:e,pointerDownMapCoords:n,pointerDownPicks:r})}),this.onStartDragging({picks:r,screenCoords:e,mapCoords:n,pointerDownScreenCoords:e,pointerDownMapCoords:n,cancelPan:t.stopImmediatePropagation,sourceEvent:t.srcEvent})}},{key:"_onpanmove",value:function(t){var e=t.srcEvent,n=this.getScreenCoords(e),r=this.getMapCoords(n),i=this.state._editableLayerState,o=i.pointerDownPicks,s=i.pointerDownScreenCoords,a=i.pointerDownMapCoords,l=this.getPicks(n);this.onDragging({screenCoords:n,mapCoords:r,picks:l,pointerDownPicks:o,pointerDownScreenCoords:s,pointerDownMapCoords:a,sourceEvent:e,cancelPan:t.stopImmediatePropagation})}},{key:"_onpanend",value:function(t){var e=t.srcEvent,n=this.getScreenCoords(e),r=this.getMapCoords(n),i=this.state._editableLayerState,o=i.pointerDownPicks,a=i.pointerDownScreenCoords,l=i.pointerDownMapCoords,u=this.getPicks(n);this.onStopDragging({picks:u,screenCoords:n,mapCoords:r,pointerDownPicks:o,pointerDownScreenCoords:a,pointerDownMapCoords:l,sourceEvent:e}),this.setState({_editableLayerState:s({},this.state._editableLayerState,{pointerDownScreenCoords:null,pointerDownMapCoords:null,pointerDownPicks:null})})}},{key:"_onpointermove",value:function(t){var e=t.srcEvent,n=this.getScreenCoords(e),r=this.getMapCoords(n),i=this.state._editableLayerState,o=i.pointerDownPicks,s=i.pointerDownScreenCoords,a=i.pointerDownMapCoords,l=this.getPicks(n);this.onPointerMove({screenCoords:n,mapCoords:r,picks:l,pointerDownPicks:o,pointerDownScreenCoords:s,pointerDownMapCoords:a,sourceEvent:e})}},{key:"getPicks",value:function(t){return this.context.deck.pickMultipleObjects({x:t[0],y:t[1],layerIds:[this.props.id],radius:this.props.pickingRadius,depth:this.props.pickingDepth})}},{key:"getScreenCoords",value:function(t){return[t.clientX-this.context.gl.canvas.getBoundingClientRect().left,t.clientY-this.context.gl.canvas.getBoundingClientRect().top]}},{key:"getMapCoords",value:function(t){return this.context.viewport.unproject([t[0],t[1]])}}])&&u(e.prototype,n),l}(r.CompositeLayer);e.default=p,d(p,"layerName","EditableLayer")},74697:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n(23863),i=n(65003);function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e,n){return a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}},a(t,e,n||t)}function l(t){return l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},l(t)}function u(t,e){return u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},u(t,e)}function c(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function h(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?c(Object(n),!0).forEach((function(e){d(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function d(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var f=h({},r.PathLayer.defaultProps,{pickingLineWidthExtraPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER}}),p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(d,t);var e,n,r,c=(r=d,function(){var t,e=l(r);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}()){var n=l(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,t)});function d(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,d),c.apply(this,arguments)}return e=d,(n=[{key:"getShaders",value:function(){var t,e=a(l(d.prototype),"getShaders",this).call(this);return e.vs=(0,i.insertBefore)(e.vs,"vec3 width;","\n       if(picking_uActive){\n        widthPixels.xy += pickingLineWidthExtraPixels;\n       }\n      "),h({},e,{inject:h({},e.inject||{},{"vs:#decl":((null===(t=e.inject)||void 0===t?void 0:t["vs:#decl"])||"").concat("uniform float pickingLineWidthExtraPixels;")})})}},{key:"draw",value:function(t){a(l(d.prototype),"draw",this).call(this,h({},t,{uniforms:h({},t.uniforms,{pickingLineWidthExtraPixels:this.props.pickingLineWidthExtraPixels})}))}}])&&s(e.prototype,n),d}(r.PathLayer);e.default=p,p.defaultProps=f,p.layerName="EditablePathLayer"},31983:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n(98265),i=n(23863);function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t){return a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},a(t)}function l(t,e){return l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},l(t,e)}function u(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var c=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(c,t);var e,n,r,u=(r=c,function(){var t,e=a(r);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}()){var n=a(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,t)});function c(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),u.apply(this,arguments)}return e=c,(n=[{key:"renderLayers",value:function(){return[new i.ScatterplotLayer(Object.assign({},this.props,{id:"".concat(this.props.id,"-ScatterplotLayer"),data:this.props.data})),new i.LineLayer(Object.assign({},this.props,{id:"".concat(this.props.id,"-LineLayer"),data:this.props.data,pickable:!1,getSourcePosition:function(t){var e=t.position;return[e[0],e[1],0]},getTargetPosition:function(t){var e=t.position;return[e[0],e[1],e[2]||0]},getColor:[150,150,150,200],getStrokeWidth:3}))]}}])&&s(e.prototype,n),c}(r.CompositeLayer);e.default=c,u(c,"layerName","ElevatedEditHandleLayer"),u(c,"defaultProps",{})},4809:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n(98265),i=n(23863);function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function s(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function a(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?s(Object(n),!0).forEach((function(e){h(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function u(t){return u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},u(t)}function c(t,e){return c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},c(t,e)}function h(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var d=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(h,t);var e,n,r,s=(r=h,function(){var t,e=u(r);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}()){var n=u(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,t)});function h(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h),s.apply(this,arguments)}return e=h,(n=[{key:"renderLayers",value:function(){var t=this.props,e=t.id,n=t.getFillColor,r=t.getStrokeColor,o=t.getInnerRadius,s=t.updateTriggers;return[new i.ScatterplotLayer(a({},this.props,{id:"".concat(e,"-full"),data:this.props.data,getLineColor:r,updateTriggers:a({},s,{getStrokeColor:s.getStrokeColor})})),new i.ScatterplotLayer(a({},this.props,{id:"".concat(e,"-inner"),data:this.props.data,getFillColor:n,getRadius:o,pickable:!1,updateTriggers:a({},s,{getFillColor:s.getFillColor,getRadius:s.getInnerRadius})}))]}}])&&l(e.prototype,n),h}(r.CompositeLayer);e.default=d,h(d,"layerName","JunctionScatterplotLayer"),h(d,"defaultProps",a({},i.ScatterplotLayer.defaultProps,{getFillColor:function(t){return[0,0,0,255]},getStrokeColor:function(t){return[255,255,255,255]},getInnerRadius:function(t){return 1}}))},19507:(t,e,n)=>{"use strict";function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function i(t){return i=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},i(t)}function o(t,e){return o=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},o(t,e)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&o(t,e)}(s,t);var e,n=(e=s,function(){var t,n=i(e);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}()){var o=i(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return function(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,t)});function s(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),n.call(this,Object.assign({},t,{attributes:a(t)}))}return s}(n(81251).Geometry);function a(t){for(var e=t.length,n=void 0===e?1:e,r=t.headSize,i=void 0===r?.2:r,o=t.tailWidth,s=void 0===o?.05:o,a=t.tailStart,l=void 0===a?.05:a,u=[.5,1,0,.5-i/2,1-i,0,.5+i/2,1-i,0,.5-s/2,l,0,.5+s/2,1-i,0,.5+s/2,l,0,.5-s/2,l,0,.5-s/2,1-i,0,.5+s/2,1-i,0],c=new Array(u.length),h=0;h<u.length/3;h++){var d=3*h;c[d+0]=(u[d+0]-.5)*n,c[d+1]=(u[d+1]-.5)*n,c[d+2]=0}return{positions:new Float32Array(c),normals:new Float32Array([0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1]),texCoords:new Float32Array(u)}}e.default=s},89636:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){var e,n=t.data,o=t.getPath,c=void 0===o?function(t){return t.path}:o,h=t.getDirection,d=void 0===h?function(t){return t.direction}:h,f=t.getColor,p=void 0===f?function(t){return a}:f,g=t.getMarkerPercentages,y=void 0===g?function(t,e){return[.5]}:g,m=t.projectFlat,v=[],b=i(n);try{for(b.s();!(e=b.n()).done;){var _,A=e.value,x=c(A),w=d(A)||l,C=p(A),S=x.map((function(t){return new r.Vector2(t)})),E=S.slice(0).reverse(),M=s(S),P=i(y(A,{lineLength:M}));try{for(P.s();!(_=P.n()).done;){var T=_.value;if(w.forward){var O=u({path:S,percentage:T,lineLength:M,color:C,object:A,projectFlat:m});v.push(O)}if(w.backward){var I=u({path:E,percentage:T,lineLength:M,color:C,object:A,projectFlat:m});v.push(I)}}}catch(t){P.e(t)}finally{P.f()}}}catch(t){b.e(t)}finally{b.f()}return v};var r=n(39861);function i(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function(t,e){if(t){if("string"==typeof t)return o(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(t,e):void 0}}(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,s=!0,a=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return s=t.done,t},e:function(t){a=!0,i=t},f:function(){try{s||null==r.return||r.return()}finally{if(a)throw i}}}}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function s(t){for(var e=0,n=0;n<t.length-1;n++)e+=t[n].distance(t[n+1]);return e}var a=[0,0,0,255],l={forward:!0,backward:!1};function u(t){for(var e=t.path,n=t.percentage,i=t.lineLength,o=t.color,s=t.object,a=t.projectFlat,l=i*n,u=0,c=0,h=0;h<e.length-1&&!((u+=e[h].distance(e[h+1]))>l);h++)c=u;var d=e[e.length-1],f=e[e.length-2],p=l-c,g=d.clone().subtract(f).normalize().clone().multiply(new r.Vector2(p,p)).add(f),y=180*new r.Vector2(a(d)).subtract(a(f)).verticalAngle()/Math.PI;return{position:[g.x,g.y,0],angle:y,color:o,object:s}}},59698:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n(98265),i=n(23863),o=n(57231),s=c(n(23780)),a=c(n(19507)),l=c(n(89636)),u=n(84992);function c(t){return t&&t.__esModule?t:{default:t}}function h(t){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},h(t)}function d(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}}(t,e)||function(t,e){if(t){if("string"==typeof t)return f(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function p(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function g(t){return g=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},g(t)}function y(t,e){return y=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},y(t,e)}function m(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var v=o.SimpleMeshLayer,b={mesh:new a.default({headSize:.2,tailWidth:.05})},_=Object.assign({},s.default.defaultProps,{MarkerLayer:v,markerLayerProps:b,sizeScale:100,fp64:!1,highlightIndex:-1,highlightPoint:null,getPath:function(t){return t.path},getColor:function(t){return t.color},getMarkerColor:function(t){return[0,0,0,255]},getDirection:function(t){return t.direction},getMarkerPercentages:function(t,e){return e.lineLength>.1?[.25,.5,.75]:[.5]}}),A=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&y(t,e)}(f,t);var e,n,o,c=(o=f,function(){var t,e=g(o);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}()){var n=g(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){return!e||"object"!==h(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,t)});function f(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),c.apply(this,arguments)}return e=f,(n=[{key:"initializeState",value:function(){this.state={markers:[],mesh:new a.default({headSize:.2,tailWidth:.05}),closestPoint:null}}},{key:"projectFlat",value:function(t,e,n,i){if(n===r.COORDINATE_SYSTEM.METER_OFFSETS){var o=d(e.metersToLngLatDelta(t),2),s=o[0],a=o[1],l=d(i,2),u=l[0],c=l[1];return e.projectFlat([u+s,a+c])}if(n===r.COORDINATE_SYSTEM.LNGLAT_OFFSETS){var h=d(t,2),f=h[0],p=h[1],g=d(i,2),y=g[0],m=g[1];return e.projectFlat([y+f,p+m])}return e.projectFlat(t)}},{key:"updateState",value:function(t){var e=this,n=t.props,r=t.oldProps,i=t.changeFlags;if(i.dataChanged||i.updateTriggersChanged){var o=this.props,s=o.data,a=o.getPath,u=o.getDirection,c=o.getMarkerColor,h=o.getMarkerPercentages,d=o.coordinateSystem,f=o.coordinateOrigin,p=this.context.viewport;this.state.markers=(0,l.default)({data:s,getPath:a,getDirection:u,getColor:c,getMarkerPercentages:h,projectFlat:function(t){return e.projectFlat(t,p,d,f)}}),this._recalculateClosestPoint()}i.propsChanged&&n.point!==r.point&&this._recalculateClosestPoint()}},{key:"_recalculateClosestPoint",value:function(){var t=this.props,e=t.highlightPoint,n=t.highlightIndex;if(e&&n>=0){var r=this.props.data[n],i=this.props.getPath(r),o=(0,u.getClosestPointOnPolyline)({points:i,p:e}).point;this.state.closestPoints=[{position:o}]}else this.state.closestPoints=[]}},{key:"getPickingInfo",value:function(t){var e=t.info;return Object.assign(e,{object:e.object&&e.object.path||e.object})}},{key:"renderLayers",value:function(){return[new s.default(this.props,this.getSubLayerProps({id:"paths",data:this.props.data})),new this.props.MarkerLayer(this.getSubLayerProps(Object.assign({},this.props.markerLayerProps,{id:"markers",data:this.state.markers,getOrientation:function(t){return[0,-t.angle,0]},getColor:function(t){return t.color},sizeScale:this.props.sizeScale,fp64:this.props.fp64,pickable:!1,parameters:{blend:!1,depthTest:!1}}))),this.state.closestPoints&&new i.ScatterplotLayer({id:"".concat(this.props.id,"-highlight"),data:this.state.closestPoints,fp64:this.props.fp64})]}}])&&p(e.prototype,n),f}(r.CompositeLayer);e.default=A,m(A,"layerName","PathMarkerLayer"),m(A,"defaultProps",_)},84992:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getClosestPointOnLine=i,e.getClosestPointOnPolyline=function(t){var e=t.p,n=t.points;e=new r.Vector3(e);for(var o=null,s=1/0,a=-1,l=0;l<n.length-1;++l){var u=i({p:e,p1:n[l],p2:n[l+1]}),c=e.distanceSquared(u);c<s&&(s=c,o=u,a=l)}return{point:o,index:a,p1:n[a],p2:n[a+1],distanceSquared:s,distance:Math.sqrt(s)}};var r=n(39861);function i(t){var e=t.p,n=t.p1,i=t.p2,o=t.clampToLine,s=void 0===o||o,a=new r.Vector3(i).subtract(n),l=new r.Vector3(e).subtract(n),u=a.dot(l);return s&&(u=(0,r.clamp)(u,0,1)),a.lerp(u)}},23780:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n(23863),i=l(n(4390)),o=n(81251),s=l(n(36966)),a=n(83723);function l(t){return t&&t.__esModule?t:{default:t}}function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function c(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function h(t,e,n){return h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=d(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}},h(t,e,n||t)}function d(t){return d=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},d(t)}function f(t,e){return f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},f(t,e)}function p(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function g(t){var e=t.source,n=t.code,r=void 0===n?"":n;return e.replace(/}[^{}]*$/,r.concat("\n}\n"))}var y=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&f(t,e)}(p,t);var e,n,r,l=(r=p,function(){var t,e=d(r);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}()){var n=d(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){return!e||"object"!==u(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,t)});function p(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,p),l.apply(this,arguments)}return e=p,(n=[{key:"getShaders",value:function(){var t=h(d(p.prototype),"getShaders",this).call(this);return Object.assign({},t,{modules:t.modules.concat([s.default]),vs:g({source:t.vs,code:"  outline_setUV(gl_Position);\n  outline_setZLevel(instanceZLevel);\n"}),fs:g({source:t.fs,code:"  gl_FragColor = outline_filterColor(gl_FragColor);\n"})})}},{key:"initializeState",value:function(t){h(d(p.prototype),"initializeState",this).call(this,t),this.setState({outlineFramebuffer:new o.Framebuffer(t.gl),dummyTexture:new o.Texture2D(t.gl)}),this.state.attributeManager.addInstanced({instanceZLevel:{size:1,type:i.default.UNSIGNED_BYTE,accessor:"getZLevel"}})}},{key:"draw",value:function(t){t.moduleParameters,t.parameters;var e=t.uniforms,n=(t.context,this.props),r=n.jointRounded,o=n.capRounded,s=n.billboard,l=n.miterLimit,u=n.widthUnits,c=n.widthScale,h=n.widthMinPixels,d=n.widthMaxPixels;e=Object.assign({},e,{jointType:Number(r),capType:Number(o),billboard:s,widthUnits:a.UNIT[u],widthScale:c,miterLimit:l,widthMinPixels:h,widthMaxPixels:d});var f=this.state,p=f.outlineFramebuffer,g=f.dummyTexture;p.resize(),p.clear({color:!0,depth:!0}),this.state.model.updateModuleSettings({outlineEnabled:!0,outlineRenderShadowmap:!0,outlineShadowmap:g}),this.state.model.draw({uniforms:Object.assign({},e,{jointType:0,widthScale:1.3*this.props.widthScale}),parameters:{depthTest:!1,blendEquation:i.default.MAX},framebuffer:p}),this.state.model.updateModuleSettings({outlineEnabled:!0,outlineRenderShadowmap:!1,outlineShadowmap:p}),this.state.model.draw({uniforms:Object.assign({},e,{jointType:Number(r),capType:Number(o),widthScale:this.props.widthScale}),parameters:{depthTest:!1}})}}])&&c(e.prototype,n),p}(r.PathLayer);e.default=y,p(y,"layerName","PathOutlineLayer"),p(y,"defaultProps",{getZLevel:function(){return 0}})},7439:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.SELECTION_TYPE=void 0;var r,i=n(98265),o=n(23863),s=n(85846),a=h(n(36593)),l=h(n(84136)),u=n(13343),c=h(n(94111));function h(t){return t&&t.__esModule?t:{default:t}}function d(t){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},d(t)}function f(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function p(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?f(Object(n),!0).forEach((function(e){x(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function g(t){return function(t){if(Array.isArray(t))return v(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||m(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}}(t,e)||m(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(t,e){if(t){if("string"==typeof t)return v(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?v(t,e):void 0}}function v(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function b(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _(t){return _=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},_(t)}function A(t,e){return A=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},A(t,e)}function x(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var w={NONE:null,RECTANGLE:"rectangle",POLYGON:"polygon"};e.SELECTION_TYPE=w;var C=(x(r={},w.RECTANGLE,u.DrawRectangleMode),x(r,w.POLYGON,u.DrawPolygonMode),r),S=x({},w.RECTANGLE,{dragToDraw:!0}),E={selectionType:w.RECTANGLE,layerIds:[],onSelect:function(){}},M={type:"FeatureCollection",features:[]},P="selection-blocker",T=["lineWidthScale","lineWidthMinPixels","lineWidthMaxPixels","lineWidthUnits","lineJointRounded","lineCapRounded","lineMiterLimit","pointRadiusScale","pointRadiusMinPixels","pointRadiusMaxPixels","lineDashJustified","getLineColor","getFillColor","getRadius","getLineWidth","getLineDashArray","getTentativeLineDashArray","getTentativeLineColor","getTentativeFillColor","getTentativeLineWidth"],O=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&A(t,e)}(h,t);var e,n,r,i=(r=h,function(){var t,e=_(r);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}()){var n=_(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){return!e||"object"!==d(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}(this,t)});function h(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h),i.apply(this,arguments)}return e=h,(n=[{key:"_selectRectangleObjects",value:function(t){var e=this.props,n=e.layerIds,r=e.onSelect,i=y(this.context.viewport.project(t[0][0]),2),o=i[0],s=i[1],a=y(this.context.viewport.project(t[0][2]),2),l=a[0],u=a[1];r({pickingInfos:this.context.deck.pickObjects({x:Math.min(o,l),y:Math.min(s,u),width:Math.abs(l-o),height:Math.abs(u-s),layerIds:n})})}},{key:"_selectPolygonObjects",value:function(t){var e,n=this,r=this.props,i=r.layerIds,o=r.onSelect,u=t[0].map((function(t){return n.context.viewport.project(t)})),c=u.map((function(t){return t[0]})),h=u.map((function(t){return t[1]})),d=Math.min.apply(Math,g(c)),f=Math.min.apply(Math,g(h)),p=Math.max.apply(Math,g(c)),y=Math.max.apply(Math,g(h)),m=(0,s.polygon)(t),v=(0,a.default)(m,50);try{e=(0,l.default)(v,m)}catch(t){return void console.log("turfDifference() error",t)}this.setState({pendingPolygonSelection:{bigPolygon:e}});var b="".concat(this.props.id,"-").concat(P);setTimeout((function(){var t=n.context.deck.pickObjects({x:d,y:f,width:p-d,height:y-f,layerIds:[b].concat(g(i))});o({pickingInfos:t.filter((function(t){return t.layer.id!==n.props.id}))})}),250)}},{key:"renderLayers",value:function(){var t=this,e=this.state.pendingPolygonSelection,n=C[this.props.selectionType]||u.ViewMode,r=S[this.props.selectionType],i={};T.forEach((function(e){void 0!==t.props[e]&&(i[e]=t.props[e])}));var s=[new c.default(this.getSubLayerProps(p({id:"selection-geojson",pickable:!0,mode:n,modeConfig:r,selectedFeatureIndexes:[],data:M,onEdit:function(e){var n=e.updatedData;if("addFeature"===e.editType){var r=n.features[0].geometry.coordinates;t.props.selectionType===w.RECTANGLE?t._selectRectangleObjects(r):t.props.selectionType===w.POLYGON&&t._selectPolygonObjects(r)}}},i)))];if(e){var a=e.bigPolygon;s.push(new o.PolygonLayer(this.getSubLayerProps({id:P,pickable:!0,stroked:!1,opacity:1,data:[a],getLineColor:function(t){return[0,0,0,1]},getFillColor:function(t){return[0,0,0,1]},getPolygon:function(t){return t.geometry.coordinates}})))}return s}},{key:"shouldUpdateState",value:function(t){var e=t.changeFlags,n=e.stateChanged,r=e.propsOrDataChanged;return n||r}}])&&b(e.prototype,n),h}(i.CompositeLayer);e.default=O,x(O,"layerName","SelectionLayer"),x(O,"defaultProps",E)},36966:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n={outlineEnabled:!1,outlineRenderShadowmap:!1,outlineShadowmap:null},r={name:"outline",vs:"attribute float instanceZLevel;\nvarying float outline_vzLevel;\nvarying vec4 outline_vPosition;\n\n// Set the z level for the outline shadowmap rendering\nvoid outline_setZLevel(float zLevel) {\n  outline_vzLevel = zLevel;\n}\n\n// Store an adjusted position for texture2DProj\nvoid outline_setUV(vec4 position) {\n  // mat4(\n  //   0.5, 0.0, 0.0, 0.0,\n  //   0.0, 0.5, 0.0, 0.0,\n  //   0.0, 0.0, 0.5, 0.0,\n  //   0.5, 0.5, 0.5, 1.0\n  // ) * position;\n  outline_vPosition = vec4(position.xyz * 0.5 + position.w * 0.5, position.w);\n}\n",fs:"uniform bool outline_uEnabled;\nuniform bool outline_uRenderOutlines;\nuniform sampler2D outline_uShadowmap;\n\nvarying float outline_vzLevel;\n// varying vec2 outline_vUV;\nvarying vec4 outline_vPosition;\n\nconst float OUTLINE_Z_LEVEL_ERROR = 0.01;\n\n// Return a darker color in shadowmap\nvec4 outline_filterShadowColor(vec4 color) {\n  return vec4(outline_vzLevel / 255., outline_vzLevel / 255., outline_vzLevel / 255., 1.);\n}\n\n// Return a darker color if in shadowmap\nvec4 outline_filterDarkenColor(vec4 color) {\n  if (outline_uEnabled) {\n    float maxZLevel;\n    if (outline_vPosition.q > 0.0) {\n      maxZLevel = texture2DProj(outline_uShadowmap, outline_vPosition).r * 255.;\n    } else {\n      discard;\n    }\n    if (maxZLevel < outline_vzLevel + OUTLINE_Z_LEVEL_ERROR) {\n      vec4(color.rgb * 0.5, color.a);\n    } else {\n      discard;\n    }\n  }\n  return color;\n}\n\n// if enabled and rendering outlines - Render depth to shadowmap\n// if enabled and rendering colors - Return a darker color if in shadowmap\n// if disabled, just return color\nvec4 outline_filterColor(vec4 color) {\n  if (outline_uEnabled) {\n    return outline_uRenderOutlines ?\n      outline_filterShadowColor(color) :\n      outline_filterDarkenColor(color);\n  }\n  return color;\n}\n",getUniforms:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n,e=t.outlineEnabled,r=t.outlineRenderShadowmap,i=t.outlineShadowmap,o={};return void 0!==e&&(o.outline_uEnabled=e),void 0!==r&&(o.outline_uRenderOutlines=r),void 0!==i&&(o.outline_uShadowmap=i),o}};e.default=r},59155:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MAX_ARROWS=e.DEFAULT_ARROWS=e.ArrowStyles=void 0,e.ArrowStyles={NONE:0,FORWARD:1,BACKWARD:2,BOTH:3},e.DEFAULT_ARROWS=1,e.MAX_ARROWS=3},65003:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.toDeckColor=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[255,0,0,255];return Array.isArray(t)?[255*t[0],255*t[1],255*t[2],255*t[3]]:e},e.recursivelyTraverseNestedArrays=function t(e,n,r){if(!Array.isArray(e[0]))return!0;for(var i=0;i<e.length;i++)if(t(e[i],[].concat(function(t){if(Array.isArray(t))return h(t)}(o=n)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(o)||c(o)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),[i]),r)){r(e,n);break}var o;return!1},e.generatePointsParallelToLinePoints=function(t,e,n){var a={type:"LineString",coordinates:[t,e]},l=(0,s.point)(n),u=(0,o.default)(l,a),c=(0,i.default)(t,e),h=(n[0]-t[0])*(e[1]-t[1])-(n[1]-t[1])*(e[0]-t[0])<0?c-90:c-270,d=(0,r.default)(e,u,h),f=(0,r.default)(t,u,h);return[d.geometry.coordinates,f.geometry.coordinates]},e.distance2d=d,e.mix=f,e.nearestPointOnProjectedLine=function(t,e,n){var r=new a.default(n),i=t.geometry.coordinates.map((function(t){var e=u(t,3),n=e[0],i=e[1],o=e[2],s=void 0===o?0:o;return r.project([n,i,s])})),o=u(r.project(e.geometry.coordinates),2),s=o[0],l=o[1],c=1/0,h={};i.forEach((function(t,e){var n=u(t,2),r=n[0],o=n[1];if(0!==e){var a=u(i[e-1],2),d=a[0],f=a[1],p=f-o,g=r-d,y=d*o-r*f,m=p*p+g*g,v=Math.abs(p*s+g*l+y)/Math.sqrt(m);v<c&&(c=v,h={index:e,x0:(g*(g*s-p*l)-p*y)/m,y0:(p*(-g*s+p*l)-g*y)/m})}}));var p=h,g=p.index,y=p.x0,m=p.y0,v=u(i[g-1],3),b=v[0],_=v[1],A=v[2],x=void 0===A?0:A,w=u(i[g],3),C=w[0],S=w[1],E=w[2],M=void 0===E?0:E,P=d(b,_,C,S),T=f(x,M,d(b,_,y,m)/P);return{type:"Feature",geometry:{type:"Point",coordinates:r.unproject([y,m,T])},properties:{dist:c,index:g-1}}},e.insertBefore=function(t,e,n){var r=t.indexOf(e);return r<0?t:t.slice(0,r)+n+t.slice(r)};var r=l(n(92091)),i=l(n(17021)),o=l(n(92024)),s=n(85846),a=l(n(62714));function l(t){return t&&t.__esModule?t:{default:t}}function u(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}}(t,e)||c(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t,e){if(t){if("string"==typeof t)return h(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(t,e):void 0}}function h(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function d(t,e,n,r){var i=t-n,o=e-r;return Math.sqrt(i*i+o*o)}function f(t,e,n){return e*n+t*(1-n)}},62714:(t,e,n)=>{"use strict";n.r(e),n.d(e,{MAX_LATITUDE:()=>r.MAX_LATITUDE,WebMercatorViewport:()=>r.WebMercatorViewport,addMetersToLngLat:()=>r.addMetersToLngLat,altitudeToFovy:()=>r.altitudeToFovy,default:()=>r.WebMercatorViewport,fitBounds:()=>r.fitBounds,flyToViewport:()=>r.flyToViewport,fovyToAltitude:()=>r.fovyToAltitude,getBounds:()=>r.getBounds,getDistanceScales:()=>r.getDistanceScales,getFlyToDuration:()=>r.getFlyToDuration,getMeterZoom:()=>r.getMeterZoom,getProjectionMatrix:()=>r.getProjectionMatrix,getProjectionParameters:()=>r.getProjectionParameters,getViewMatrix:()=>r.getViewMatrix,lngLatToWorld:()=>r.lngLatToWorld,normalizeViewportProps:()=>r.normalizeViewportProps,pixelsToWorld:()=>r.pixelsToWorld,scaleToZoom:()=>r.scaleToZoom,unitsPerMeter:()=>r.unitsPerMeter,worldToLngLat:()=>r.worldToLngLat,worldToPixels:()=>r.worldToPixels,zoomToScale:()=>r.zoomToScale});var r=n(649)},40122:(t,e,n)=>{"use strict";n.r(e),n.d(e,{COLOR:()=>i.o,LocalStorage:()=>a.D,Log:()=>r.t,addColor:()=>i.n,autobind:()=>s.d,default:()=>u,getHiResTimestamp:()=>l.i,leftPad:()=>o.PX,rightPad:()=>o.av});var r=n(91317),i=n(81435),o=n(87865),s=n(90202),a=n(1903),l=n(44280);const u=new r.t({id:"@probe.gl/log"})},53114:function(t){t.exports=function(){"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function n(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&o(t,e)}function i(t){return i=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},i(t)}function o(t,e){return o=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},o(t,e)}function s(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function a(t,e,n){return a=s()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var i=new(Function.bind.apply(t,r));return n&&o(i,n.prototype),i},a.apply(null,arguments)}function l(t){var e="function"==typeof Map?new Map:void 0;return l=function(t){if(null===t||(n=t,-1===Function.toString.call(n).indexOf("[native code]")))return t;var n;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return a(t,arguments,i(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),o(r,t)},l(t)}function u(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function c(t){var e=s();return function(){var n,r=i(t);if(e){var o=i(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return u(t)}(this,n)}}function h(t,e,n){return h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=i(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}},h(t,e,n||t)}function d(t){return function(t){if(Array.isArray(t))return p(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||f(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(t,e){if(t){if("string"==typeof t)return p(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(t,e):void 0}}function p(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function g(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=f(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){a=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}var y=function(){function e(){t(this,e),e.constructor_.apply(this,arguments)}return n(e,[{key:"getEndCapStyle",value:function(){return this._endCapStyle}},{key:"isSingleSided",value:function(){return this._isSingleSided}},{key:"setQuadrantSegments",value:function(t){this._quadrantSegments=t,0===this._quadrantSegments&&(this._joinStyle=e.JOIN_BEVEL),this._quadrantSegments<0&&(this._joinStyle=e.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments)),t<=0&&(this._quadrantSegments=1),this._joinStyle!==e.JOIN_ROUND&&(this._quadrantSegments=e.DEFAULT_QUADRANT_SEGMENTS)}},{key:"getJoinStyle",value:function(){return this._joinStyle}},{key:"setJoinStyle",value:function(t){this._joinStyle=t}},{key:"setSimplifyFactor",value:function(t){this._simplifyFactor=t<0?0:t}},{key:"getSimplifyFactor",value:function(){return this._simplifyFactor}},{key:"getQuadrantSegments",value:function(){return this._quadrantSegments}},{key:"setEndCapStyle",value:function(t){this._endCapStyle=t}},{key:"getMitreLimit",value:function(){return this._mitreLimit}},{key:"setMitreLimit",value:function(t){this._mitreLimit=t}},{key:"setSingleSided",value:function(t){this._isSingleSided=t}}],[{key:"constructor_",value:function(){if(this._quadrantSegments=e.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=e.CAP_ROUND,this._joinStyle=e.JOIN_ROUND,this._mitreLimit=e.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=e.DEFAULT_SIMPLIFY_FACTOR,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this.setQuadrantSegments(t)}else if(2===arguments.length){var n=arguments[0],r=arguments[1];this.setQuadrantSegments(n),this.setEndCapStyle(r)}else if(4===arguments.length){var i=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3];this.setQuadrantSegments(i),this.setEndCapStyle(o),this.setJoinStyle(s),this.setMitreLimit(a)}}},{key:"bufferDistanceError",value:function(t){var e=Math.PI/2/t;return 1-Math.cos(e/2)}}]),e}();y.CAP_ROUND=1,y.CAP_FLAT=2,y.CAP_SQUARE=3,y.JOIN_ROUND=1,y.JOIN_MITRE=2,y.JOIN_BEVEL=3,y.DEFAULT_QUADRANT_SEGMENTS=8,y.DEFAULT_MITRE_LIMIT=5,y.DEFAULT_SIMPLIFY_FACTOR=.01;var m=function(e){r(o,e);var i=c(o);function o(e){var n;return t(this,o),(n=i.call(this,e)).name=Object.keys({Exception:o})[0],n}return n(o,[{key:"toString",value:function(){return this.message}}]),o}(l(Error)),v=function(e){r(i,e);var n=c(i);function i(e){var r;return t(this,i),(r=n.call(this,e)).name=Object.keys({IllegalArgumentException:i})[0],r}return i}(m),b=function(){function e(){t(this,e)}return n(e,[{key:"filter",value:function(t){}}]),e}();function _(){}function A(){}function x(){}var w,C,S,E,M,P,T,O=function(){function e(){t(this,e)}return n(e,null,[{key:"equalsWithTolerance",value:function(t,e,n){return Math.abs(t-e)<=n}}]),e}(),I=function(){function e(n,r){t(this,e),this.low=r||0,this.high=n||0}return n(e,null,[{key:"toBinaryString",value:function(t){var e,n="";for(e=2147483648;e>0;e>>>=1)n+=(t.high&e)===e?"1":"0";for(e=2147483648;e>0;e>>>=1)n+=(t.low&e)===e?"1":"0";return n}}]),e}();function R(){}function B(){}R.NaN=NaN,R.isNaN=function(t){return Number.isNaN(t)},R.isInfinite=function(t){return!Number.isFinite(t)},R.MAX_VALUE=Number.MAX_VALUE,R.POSITIVE_INFINITY=Number.POSITIVE_INFINITY,R.NEGATIVE_INFINITY=Number.NEGATIVE_INFINITY,"function"==typeof Float64Array&&"function"==typeof Int32Array?(M=2146435072,P=new Float64Array(1),T=new Int32Array(P.buffer),R.doubleToLongBits=function(t){P[0]=t;var e=0|T[0],n=0|T[1];return(n&M)===M&&!!(1048575&n)&&0!==e&&(e=0,n=2146959360),new I(n,e)},R.longBitsToDouble=function(t){return T[0]=t.low,T[1]=t.high,P[0]}):(w=Math.log2,C=Math.floor,S=Math.pow,E=function(){for(var t=53;t>0;t--){var e=S(2,t)-1;if(C(w(e))+1===t)return e}return 0}(),R.doubleToLongBits=function(t){var e,n,r,i,o,s,a,l,u;if(t<0||1/t===Number.NEGATIVE_INFINITY?(s=1<<31,t=-t):s=0,0===t)return new I(l=s,u=0);if(t===1/0)return new I(l=2146435072|s,u=0);if(t!=t)return new I(l=2146959360,u=0);if(i=0,u=0,(e=C(t))>1)if(e<=E)(i=C(w(e)))<=20?(u=0,l=e<<20-i&1048575):(u=e%(n=S(2,r=i-20))<<32-r,l=e/n&1048575);else for(r=e,u=0;0!==(r=C(n=r/2));)i++,u>>>=1,u|=(1&l)<<31,l>>>=1,n!==r&&(l|=524288);if(a=i+1023,o=0===e,e=t-e,i<52&&0!==e)for(r=0;;){if((n=2*e)>=1?(e=n-1,o?(a--,o=!1):(r<<=1,r|=1,i++)):(e=n,o?0==--a&&(i++,o=!1):(r<<=1,i++)),20===i)l|=r,r=0;else if(52===i){u|=r;break}if(1===n){i<20?l|=r<<20-i:i<52&&(u|=r<<52-i);break}}return l|=a<<20,new I(l|=s,u)},R.longBitsToDouble=function(t){var e,n,r,i,o=t.high,s=t.low,a=o&1<<31?-1:1;for(r=((2146435072&o)>>20)-1023,i=0,n=1<<19,e=1;e<=20;e++)o&n&&(i+=S(2,-e)),n>>>=1;for(n=1<<31,e=21;e<=52;e++)s&n&&(i+=S(2,-e)),n>>>=1;if(-1023===r){if(0===i)return 0*a;r=-1022}else{if(1024===r)return 0===i?a/0:NaN;i+=1}return a*i*S(2,r)});var L=function(e){r(i,e);var n=c(i);function i(e){var r;return t(this,i),(r=n.call(this,e)).name=Object.keys({RuntimeException:i})[0],r}return i}(m),k=function(e){r(o,e);var i=c(o);function o(){var e;return t(this,o),e=i.call(this),o.constructor_.apply(u(e),arguments),e}return n(o,null,[{key:"constructor_",value:function(){if(0===arguments.length)L.constructor_.call(this);else if(1===arguments.length){var t=arguments[0];L.constructor_.call(this,t)}}}]),o}(L),D=function(){function e(){t(this,e)}return n(e,null,[{key:"shouldNeverReachHere",value:function(){if(0===arguments.length)e.shouldNeverReachHere(null);else if(1===arguments.length){var t=arguments[0];throw new k("Should never reach here"+(null!==t?": "+t:""))}}},{key:"isTrue",value:function(){if(1===arguments.length){var t=arguments[0];e.isTrue(t,null)}else if(2===arguments.length){var n=arguments[1];if(!arguments[0])throw null===n?new k:new k(n)}}},{key:"equals",value:function(){if(2===arguments.length){var t=arguments[0],n=arguments[1];e.equals(t,n,null)}else if(3===arguments.length){var r=arguments[0],i=arguments[1],o=arguments[2];if(!i.equals(r))throw new k("Expected "+r+" but encountered "+i+(null!==o?": "+o:""))}}}]),e}(),F=new ArrayBuffer(8),N=new Float64Array(F),j=new Int32Array(F),G=function(){function e(){t(this,e),e.constructor_.apply(this,arguments)}return n(e,[{key:"getM",value:function(){return R.NaN}},{key:"setOrdinate",value:function(t,n){switch(t){case e.X:this.x=n;break;case e.Y:this.y=n;break;case e.Z:this.setZ(n);break;default:throw new v("Invalid ordinate index: "+t)}}},{key:"equals2D",value:function(){if(1===arguments.length){var t=arguments[0];return this.x===t.x&&this.y===t.y}if(2===arguments.length){var e=arguments[0],n=arguments[1];return!!O.equalsWithTolerance(this.x,e.x,n)&&!!O.equalsWithTolerance(this.y,e.y,n)}}},{key:"setM",value:function(t){throw new v("Invalid ordinate index: "+e.M)}},{key:"getZ",value:function(){return this.z}},{key:"getOrdinate",value:function(t){switch(t){case e.X:return this.x;case e.Y:return this.y;case e.Z:return this.getZ()}throw new v("Invalid ordinate index: "+t)}},{key:"equals3D",value:function(t){return this.x===t.x&&this.y===t.y&&(this.getZ()===t.getZ()||R.isNaN(this.getZ())&&R.isNaN(t.getZ()))}},{key:"equals",value:function(t){return t instanceof e&&this.equals2D(t)}},{key:"equalInZ",value:function(t,e){return O.equalsWithTolerance(this.getZ(),t.getZ(),e)}},{key:"setX",value:function(t){this.x=t}},{key:"compareTo",value:function(t){var e=t;return this.x<e.x?-1:this.x>e.x?1:this.y<e.y?-1:this.y>e.y?1:0}},{key:"getX",value:function(){return this.x}},{key:"setZ",value:function(t){this.z=t}},{key:"clone",value:function(){try{return null}catch(t){if(t instanceof CloneNotSupportedException)return D.shouldNeverReachHere("this shouldn't happen because this class is Cloneable"),null;throw t}}},{key:"copy",value:function(){return new e(this)}},{key:"toString",value:function(){return"("+this.x+", "+this.y+", "+this.getZ()+")"}},{key:"distance3D",value:function(t){var e=this.x-t.x,n=this.y-t.y,r=this.getZ()-t.getZ();return Math.sqrt(e*e+n*n+r*r)}},{key:"getY",value:function(){return this.y}},{key:"setY",value:function(t){this.y=t}},{key:"distance",value:function(t){var e=this.x-t.x,n=this.y-t.y;return Math.sqrt(e*e+n*n)}},{key:"hashCode",value:function(){var t=17;return 37*(t=37*t+e.hashCode(this.x))+e.hashCode(this.y)}},{key:"setCoordinate",value:function(t){this.x=t.x,this.y=t.y,this.z=t.getZ()}},{key:"interfaces_",get:function(){return[_,A,x]}}],[{key:"constructor_",value:function(){if(this.x=null,this.y=null,this.z=null,0===arguments.length)e.constructor_.call(this,0,0);else if(1===arguments.length){var t=arguments[0];e.constructor_.call(this,t.x,t.y,t.getZ())}else if(2===arguments.length){var n=arguments[0],r=arguments[1];e.constructor_.call(this,n,r,e.NULL_ORDINATE)}else if(3===arguments.length){var i=arguments[0],o=arguments[1],s=arguments[2];this.x=i,this.y=o,this.z=s}}},{key:"hashCode",value:function(t){return N[0]=t,j[0]^j[1]}}]),e}(),U=function(){function e(){t(this,e),e.constructor_.apply(this,arguments)}return n(e,[{key:"compare",value:function(t,n){var r=e.compare(t.x,n.x);if(0!==r)return r;var i=e.compare(t.y,n.y);return 0!==i?i:this._dimensionsToTest<=2?0:e.compare(t.getZ(),n.getZ())}},{key:"interfaces_",get:function(){return[B]}}],[{key:"constructor_",value:function(){if(this._dimensionsToTest=2,0===arguments.length)e.constructor_.call(this,2);else if(1===arguments.length){var t=arguments[0];if(2!==t&&3!==t)throw new v("only 2 or 3 dimensions may be specified");this._dimensionsToTest=t}}},{key:"compare",value:function(t,e){return t<e?-1:t>e?1:R.isNaN(t)?R.isNaN(e)?0:-1:R.isNaN(e)?1:0}}]),e}();G.DimensionalComparator=U,G.NULL_ORDINATE=R.NaN,G.X=0,G.Y=1,G.Z=2,G.M=3;var z=function(){function e(){t(this,e),e.constructor_.apply(this,arguments)}return n(e,[{key:"getArea",value:function(){return this.getWidth()*this.getHeight()}},{key:"equals",value:function(t){if(!(t instanceof e))return!1;var n=t;return this.isNull()?n.isNull():this._maxx===n.getMaxX()&&this._maxy===n.getMaxY()&&this._minx===n.getMinX()&&this._miny===n.getMinY()}},{key:"intersection",value:function(t){if(this.isNull()||t.isNull()||!this.intersects(t))return new e;var n=this._minx>t._minx?this._minx:t._minx,r=this._miny>t._miny?this._miny:t._miny;return new e(n,this._maxx<t._maxx?this._maxx:t._maxx,r,this._maxy<t._maxy?this._maxy:t._maxy)}},{key:"isNull",value:function(){return this._maxx<this._minx}},{key:"getMaxX",value:function(){return this._maxx}},{key:"covers",value:function(){if(1===arguments.length){if(arguments[0]instanceof G){var t=arguments[0];return this.covers(t.x,t.y)}if(arguments[0]instanceof e){var n=arguments[0];return!this.isNull()&&!n.isNull()&&n.getMinX()>=this._minx&&n.getMaxX()<=this._maxx&&n.getMinY()>=this._miny&&n.getMaxY()<=this._maxy}}else if(2===arguments.length){var r=arguments[0],i=arguments[1];return!this.isNull()&&r>=this._minx&&r<=this._maxx&&i>=this._miny&&i<=this._maxy}}},{key:"intersects",value:function(){if(1===arguments.length){if(arguments[0]instanceof e){var t=arguments[0];return!this.isNull()&&!t.isNull()&&!(t._minx>this._maxx||t._maxx<this._minx||t._miny>this._maxy||t._maxy<this._miny)}if(arguments[0]instanceof G){var n=arguments[0];return this.intersects(n.x,n.y)}}else if(2===arguments.length){if(arguments[0]instanceof G&&arguments[1]instanceof G){var r=arguments[0],i=arguments[1];return!(this.isNull()||(r.x<i.x?r.x:i.x)>this._maxx||(r.x>i.x?r.x:i.x)<this._minx||(r.y<i.y?r.y:i.y)>this._maxy||(r.y>i.y?r.y:i.y)<this._miny)}if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var o=arguments[0],s=arguments[1];return!this.isNull()&&!(o>this._maxx||o<this._minx||s>this._maxy||s<this._miny)}}}},{key:"getMinY",value:function(){return this._miny}},{key:"getDiameter",value:function(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return Math.sqrt(t*t+e*e)}},{key:"getMinX",value:function(){return this._minx}},{key:"expandToInclude",value:function(){if(1===arguments.length){if(arguments[0]instanceof G){var t=arguments[0];this.expandToInclude(t.x,t.y)}else if(arguments[0]instanceof e){var n=arguments[0];if(n.isNull())return null;this.isNull()?(this._minx=n.getMinX(),this._maxx=n.getMaxX(),this._miny=n.getMinY(),this._maxy=n.getMaxY()):(n._minx<this._minx&&(this._minx=n._minx),n._maxx>this._maxx&&(this._maxx=n._maxx),n._miny<this._miny&&(this._miny=n._miny),n._maxy>this._maxy&&(this._maxy=n._maxy))}}else if(2===arguments.length){var r=arguments[0],i=arguments[1];this.isNull()?(this._minx=r,this._maxx=r,this._miny=i,this._maxy=i):(r<this._minx&&(this._minx=r),r>this._maxx&&(this._maxx=r),i<this._miny&&(this._miny=i),i>this._maxy&&(this._maxy=i))}}},{key:"minExtent",value:function(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return t<e?t:e}},{key:"getWidth",value:function(){return this.isNull()?0:this._maxx-this._minx}},{key:"compareTo",value:function(t){var e=t;return this.isNull()?e.isNull()?0:-1:e.isNull()?1:this._minx<e._minx?-1:this._minx>e._minx?1:this._miny<e._miny?-1:this._miny>e._miny?1:this._maxx<e._maxx?-1:this._maxx>e._maxx?1:this._maxy<e._maxy?-1:this._maxy>e._maxy?1:0}},{key:"translate",value:function(t,e){if(this.isNull())return null;this.init(this.getMinX()+t,this.getMaxX()+t,this.getMinY()+e,this.getMaxY()+e)}},{key:"copy",value:function(){return new e(this)}},{key:"toString",value:function(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"}},{key:"setToNull",value:function(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1}},{key:"disjoint",value:function(t){return!(!this.isNull()&&!t.isNull())||t._minx>this._maxx||t._maxx<this._minx||t._miny>this._maxy||t._maxy<this._miny}},{key:"getHeight",value:function(){return this.isNull()?0:this._maxy-this._miny}},{key:"maxExtent",value:function(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return t>e?t:e}},{key:"expandBy",value:function(){if(1===arguments.length){var t=arguments[0];this.expandBy(t,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this.isNull())return null;this._minx-=e,this._maxx+=e,this._miny-=n,this._maxy+=n,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}}},{key:"contains",value:function(){if(1===arguments.length){if(arguments[0]instanceof e){var t=arguments[0];return this.covers(t)}if(arguments[0]instanceof G){var n=arguments[0];return this.covers(n)}}else if(2===arguments.length){var r=arguments[0],i=arguments[1];return this.covers(r,i)}}},{key:"centre",value:function(){return this.isNull()?null:new G((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)}},{key:"init",value:function(){if(0===arguments.length)this.setToNull();else if(1===arguments.length){if(arguments[0]instanceof G){var t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof e){var n=arguments[0];this._minx=n._minx,this._maxx=n._maxx,this._miny=n._miny,this._maxy=n._maxy}}else if(2===arguments.length){var r=arguments[0],i=arguments[1];this.init(r.x,i.x,r.y,i.y)}else if(4===arguments.length){var o=arguments[0],s=arguments[1],a=arguments[2],l=arguments[3];o<s?(this._minx=o,this._maxx=s):(this._minx=s,this._maxx=o),a<l?(this._miny=a,this._maxy=l):(this._miny=l,this._maxy=a)}}},{key:"getMaxY",value:function(){return this._maxy}},{key:"distance",value:function(t){if(this.intersects(t))return 0;var e=0;this._maxx<t._minx?e=t._minx-this._maxx:this._minx>t._maxx&&(e=this._minx-t._maxx);var n=0;return this._maxy<t._miny?n=t._miny-this._maxy:this._miny>t._maxy&&(n=this._miny-t._maxy),0===e?n:0===n?e:Math.sqrt(e*e+n*n)}},{key:"hashCode",value:function(){var t=17;return 37*(t=37*(t=37*(t=37*t+G.hashCode(this._minx))+G.hashCode(this._maxx))+G.hashCode(this._miny))+G.hashCode(this._maxy)}},{key:"interfaces_",get:function(){return[_,x]}}],[{key:"constructor_",value:function(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,0===arguments.length)this.init();else if(1===arguments.length){if(arguments[0]instanceof G){var t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof e){var n=arguments[0];this.init(n)}}else if(2===arguments.length){var r=arguments[0],i=arguments[1];this.init(r.x,i.x,r.y,i.y)}else if(4===arguments.length){var o=arguments[0],s=arguments[1],a=arguments[2],l=arguments[3];this.init(o,s,a,l)}}},{key:"intersects",value:function(){if(3===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2];return n.x>=(t.x<e.x?t.x:e.x)&&n.x<=(t.x>e.x?t.x:e.x)&&n.y>=(t.y<e.y?t.y:e.y)&&n.y<=(t.y>e.y?t.y:e.y)}if(4===arguments.length){var r=arguments[0],i=arguments[1],o=arguments[2],s=arguments[3],a=Math.min(o.x,s.x),l=Math.max(o.x,s.x),u=Math.min(r.x,i.x),c=Math.max(r.x,i.x);return!(u>l||c<a||(a=Math.min(o.y,s.y),l=Math.max(o.y,s.y),u=Math.min(r.y,i.y),c=Math.max(r.y,i.y),u>l||c<a))}}}]),e}(),V=function(){function e(){t(this,e),e.constructor_.apply(this,arguments)}return n(e,[{key:"isGeometryCollection",value:function(){return this.getTypeCode()===e.TYPECODE_GEOMETRYCOLLECTION}},{key:"getFactory",value:function(){return this._factory}},{key:"getGeometryN",value:function(t){return this}},{key:"getArea",value:function(){return 0}},{key:"isRectangle",value:function(){return!1}},{key:"equalsExact",value:function(t){return this===t||this.equalsExact(t,0)}},{key:"geometryChanged",value:function(){this.apply(e.geometryChangedFilter)}},{key:"geometryChangedAction",value:function(){this._envelope=null}},{key:"equalsNorm",value:function(t){return null!==t&&this.norm().equalsExact(t.norm())}},{key:"getLength",value:function(){return 0}},{key:"getNumGeometries",value:function(){return 1}},{key:"compareTo",value:function(){var t;if(1===arguments.length){var e=arguments[0];return t=e,this.getTypeCode()!==t.getTypeCode()?this.getTypeCode()-t.getTypeCode():this.isEmpty()&&t.isEmpty()?0:this.isEmpty()?-1:t.isEmpty()?1:this.compareToSameClass(e)}if(2===arguments.length){var n=arguments[0],r=arguments[1];return t=n,this.getTypeCode()!==t.getTypeCode()?this.getTypeCode()-t.getTypeCode():this.isEmpty()&&t.isEmpty()?0:this.isEmpty()?-1:t.isEmpty()?1:this.compareToSameClass(n,r)}}},{key:"getUserData",value:function(){return this._userData}},{key:"getSRID",value:function(){return this._SRID}},{key:"getEnvelope",value:function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())}},{key:"checkNotGeometryCollection",value:function(t){if(t.getTypeCode()===e.TYPECODE_GEOMETRYCOLLECTION)throw new v("This method does not support GeometryCollection arguments")}},{key:"equal",value:function(t,e,n){return 0===n?t.equals(e):t.distance(e)<=n}},{key:"norm",value:function(){var t=this.copy();return t.normalize(),t}},{key:"reverse",value:function(){var t=this.reverseInternal();return null!=this.envelope&&(t.envelope=this.envelope.copy()),t.setSRID(this.getSRID()),t}},{key:"copy",value:function(){var t=this.copyInternal();return t.envelope=null==this._envelope?null:this._envelope.copy(),t._SRID=this._SRID,t._userData=this._userData,t}},{key:"getPrecisionModel",value:function(){return this._factory.getPrecisionModel()}},{key:"getEnvelopeInternal",value:function(){return null===this._envelope&&(this._envelope=this.computeEnvelopeInternal()),new z(this._envelope)}},{key:"setSRID",value:function(t){this._SRID=t}},{key:"setUserData",value:function(t){this._userData=t}},{key:"compare",value:function(t,e){for(var n=t.iterator(),r=e.iterator();n.hasNext()&&r.hasNext();){var i=n.next(),o=r.next(),s=i.compareTo(o);if(0!==s)return s}return n.hasNext()?1:r.hasNext()?-1:0}},{key:"hashCode",value:function(){return this.getEnvelopeInternal().hashCode()}},{key:"isEquivalentClass",value:function(t){return this.getClass()===t.getClass()}},{key:"isGeometryCollectionOrDerived",value:function(){return this.getTypeCode()===e.TYPECODE_GEOMETRYCOLLECTION||this.getTypeCode()===e.TYPECODE_MULTIPOINT||this.getTypeCode()===e.TYPECODE_MULTILINESTRING||this.getTypeCode()===e.TYPECODE_MULTIPOLYGON}},{key:"interfaces_",get:function(){return[A,_,x]}},{key:"getClass",value:function(){return e}}],[{key:"hasNonEmptyElements",value:function(t){for(var e=0;e<t.length;e++)if(!t[e].isEmpty())return!0;return!1}},{key:"hasNullElements",value:function(t){for(var e=0;e<t.length;e++)if(null===t[e])return!0;return!1}}]),e}();V.constructor_=function(t){t&&(this._envelope=null,this._userData=null,this._factory=t,this._SRID=t.getSRID())},V.TYPECODE_POINT=0,V.TYPECODE_MULTIPOINT=1,V.TYPECODE_LINESTRING=2,V.TYPECODE_LINEARRING=3,V.TYPECODE_MULTILINESTRING=4,V.TYPECODE_POLYGON=5,V.TYPECODE_MULTIPOLYGON=6,V.TYPECODE_GEOMETRYCOLLECTION=7,V.TYPENAME_POINT="Point",V.TYPENAME_MULTIPOINT="MultiPoint",V.TYPENAME_LINESTRING="LineString",V.TYPENAME_LINEARRING="LinearRing",V.TYPENAME_MULTILINESTRING="MultiLineString",V.TYPENAME_POLYGON="Polygon",V.TYPENAME_MULTIPOLYGON="MultiPolygon",V.TYPENAME_GEOMETRYCOLLECTION="GeometryCollection",V.geometryChangedFilter={get interfaces_(){return[b]},filter:function(t){t.geometryChangedAction()}};var H=function(){function e(){t(this,e)}return n(e,null,[{key:"toLocationSymbol",value:function(t){switch(t){case e.EXTERIOR:return"e";case e.BOUNDARY:return"b";case e.INTERIOR:return"i";case e.NONE:return"-"}throw new v("Unknown location value: "+t)}}]),e}();H.INTERIOR=0,H.BOUNDARY=1,H.EXTERIOR=2,H.NONE=-1;var q=function(){function e(){t(this,e)}return n(e,[{key:"add",value:function(){}},{key:"addAll",value:function(){}},{key:"isEmpty",value:function(){}},{key:"iterator",value:function(){}},{key:"size",value:function(){}},{key:"toArray",value:function(){}},{key:"remove",value:function(){}}]),e}(),W=function(e){r(i,e);var n=c(i);function i(e){var r;return t(this,i),(r=n.call(this,e)).name=Object.keys({NoSuchElementException:i})[0],r}return i}(m),J=function(e){r(i,e);var n=c(i);function i(e){var r;return t(this,i),(r=n.call(this,e)).name=Object.keys({UnsupportedOperationException:i})[0],r}return i}(m),Y=function(e){r(o,e);var i=c(o);function o(){return t(this,o),i.apply(this,arguments)}return n(o,[{key:"contains",value:function(){}}]),o}(q),X=function(e,i){r(s,e);var o=c(s);function s(e){var n;return t(this,s),(n=o.call(this)).map=new Map,e instanceof q&&n.addAll(e),n}return n(s,[{key:"contains",value:function(t){var e=t.hashCode?t.hashCode():t;return!!this.map.has(e)}},{key:"add",value:function(t){var e=t.hashCode?t.hashCode():t;return!this.map.has(e)&&!!this.map.set(e,t)}},{key:"addAll",value:function(t){var e,n=g(t);try{for(n.s();!(e=n.n()).done;){var r=e.value;this.add(r)}}catch(t){n.e(t)}finally{n.f()}return!0}},{key:"remove",value:function(){throw new J}},{key:"size",value:function(){return this.map.size}},{key:"isEmpty",value:function(){return 0===this.map.size}},{key:"toArray",value:function(){return Array.from(this.map.values())}},{key:"iterator",value:function(){return new K(this.map)}},{key:i,value:function(){return this.map}}]),s}(Y,Symbol.iterator),K=function(){function e(n){t(this,e),this.iterator=n.values();var r=this.iterator.next(),i=r.done,o=r.value;this.done=i,this.value=o}return n(e,[{key:"next",value:function(){if(this.done)throw new W;var t=this.value,e=this.iterator.next(),n=e.done,r=e.value;return this.done=n,this.value=r,t}},{key:"hasNext",value:function(){return!this.done}},{key:"remove",value:function(){throw new J}}]),e}(),Z=function(){function e(){t(this,e)}return n(e,null,[{key:"opposite",value:function(t){return t===e.LEFT?e.RIGHT:t===e.RIGHT?e.LEFT:t}}]),e}();Z.ON=0,Z.LEFT=1,Z.RIGHT=2;var Q=function(e){r(i,e);var n=c(i);function i(e){var r;return t(this,i),(r=n.call(this,e)).name=Object.keys({EmptyStackException:i})[0],r}return i}(m),$=function(e){r(i,e);var n=c(i);function i(e){var r;return t(this,i),(r=n.call(this,e)).name=Object.keys({IndexOutOfBoundsException:i})[0],r}return i}(m),tt=function(e){r(o,e);var i=c(o);function o(){return t(this,o),i.apply(this,arguments)}return n(o,[{key:"get",value:function(){}},{key:"set",value:function(){}},{key:"isEmpty",value:function(){}}]),o}(q),et=function(e){r(o,e);var i=c(o);function o(){var e;return t(this,o),(e=i.call(this)).array=[],e}return n(o,[{key:"add",value:function(t){return this.array.push(t),!0}},{key:"get",value:function(t){if(t<0||t>=this.size())throw new $;return this.array[t]}},{key:"push",value:function(t){return this.array.push(t),t}},{key:"pop",value:function(){if(0===this.array.length)throw new Q;return this.array.pop()}},{key:"peek",value:function(){if(0===this.array.length)throw new Q;return this.array[this.array.length-1]}},{key:"empty",value:function(){return 0===this.array.length}},{key:"isEmpty",value:function(){return this.empty()}},{key:"search",value:function(t){return this.array.indexOf(t)}},{key:"size",value:function(){return this.array.length}},{key:"toArray",value:function(){return this.array.slice()}}]),o}(tt);function nt(t,e){return t.interfaces_&&t.interfaces_.indexOf(e)>-1}var rt=function(){function e(n){t(this,e),this.str=n}return n(e,[{key:"append",value:function(t){this.str+=t}},{key:"setCharAt",value:function(t,e){this.str=this.str.substr(0,t)+e+this.str.substr(t+1)}},{key:"toString",value:function(){return this.str}}]),e}(),it=function(){function e(n){t(this,e),this.value=n}return n(e,[{key:"intValue",value:function(){return this.value}},{key:"compareTo",value:function(t){return this.value<t?-1:this.value>t?1:0}}],[{key:"compare",value:function(t,e){return t<e?-1:t>e?1:0}},{key:"isNan",value:function(t){return Number.isNaN(t)}},{key:"valueOf",value:function(t){return new e(t)}}]),e}(),ot=function(){function e(){t(this,e)}return n(e,null,[{key:"isWhitespace",value:function(t){return t<=32&&t>=0||127===t}},{key:"toUpperCase",value:function(t){return t.toUpperCase()}}]),e}(),st=function(){function e(){t(this,e),e.constructor_.apply(this,arguments)}return n(e,[{key:"le",value:function(t){return this._hi<t._hi||this._hi===t._hi&&this._lo<=t._lo}},{key:"extractSignificantDigits",value:function(t,n){var r=this.abs(),i=e.magnitude(r._hi),o=e.TEN.pow(i);(r=r.divide(o)).gt(e.TEN)?(r=r.divide(e.TEN),i+=1):r.lt(e.ONE)&&(r=r.multiply(e.TEN),i-=1);for(var s=i+1,a=new rt,l=e.MAX_PRINT_DIGITS-1,u=0;u<=l;u++){t&&u===s&&a.append(".");var c=Math.trunc(r._hi);if(c<0)break;var h=!1,d=0;c>9?(h=!0,d="9"):d="0"+c,a.append(d),r=r.subtract(e.valueOf(c)).multiply(e.TEN),h&&r.selfAdd(e.TEN);var f=!0,p=e.magnitude(r._hi);if(p<0&&Math.abs(p)>=l-u&&(f=!1),!f)break}return n[0]=i,a.toString()}},{key:"sqr",value:function(){return this.multiply(this)}},{key:"doubleValue",value:function(){return this._hi+this._lo}},{key:"subtract",value:function(){if(arguments[0]instanceof e){var t=arguments[0];return this.add(t.negate())}if("number"==typeof arguments[0]){var n=arguments[0];return this.add(-n)}}},{key:"equals",value:function(){if(1===arguments.length&&arguments[0]instanceof e){var t=arguments[0];return this._hi===t._hi&&this._lo===t._lo}}},{key:"isZero",value:function(){return 0===this._hi&&0===this._lo}},{key:"selfSubtract",value:function(){if(arguments[0]instanceof e){var t=arguments[0];return this.isNaN()?this:this.selfAdd(-t._hi,-t._lo)}if("number"==typeof arguments[0]){var n=arguments[0];return this.isNaN()?this:this.selfAdd(-n,0)}}},{key:"getSpecialNumberString",value:function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null}},{key:"min",value:function(t){return this.le(t)?this:t}},{key:"selfDivide",value:function(){if(1===arguments.length){if(arguments[0]instanceof e){var t=arguments[0];return this.selfDivide(t._hi,t._lo)}if("number"==typeof arguments[0]){var n=arguments[0];return this.selfDivide(n,0)}}else if(2===arguments.length){var r,i,o,s,a=arguments[0],l=arguments[1],u=null,c=null,h=null,d=null;return o=this._hi/a,d=(u=(h=e.SPLIT*o)-(u=h-o))*(c=(d=e.SPLIT*a)-(c=d-a))-(s=o*a)+u*(i=a-c)+(r=o-u)*c+r*i,d=o+(h=(this._hi-s-d+this._lo-o*l)/a),this._hi=d,this._lo=o-d+h,this}}},{key:"dump",value:function(){return"DD<"+this._hi+", "+this._lo+">"}},{key:"divide",value:function(){if(arguments[0]instanceof e){var t,n,r,i,o=arguments[0],s=null,a=null,l=null,u=null;return t=(r=this._hi/o._hi)-(s=(l=e.SPLIT*r)-(s=l-r)),u=s*(a=(u=e.SPLIT*o._hi)-(a=u-o._hi))-(i=r*o._hi)+s*(n=o._hi-a)+t*a+t*n,new e(u=r+(l=(this._hi-i-u+this._lo-r*o._lo)/o._hi),r-u+l)}if("number"==typeof arguments[0]){var c=arguments[0];return R.isNaN(c)?e.createNaN():e.copy(this).selfDivide(c,0)}}},{key:"ge",value:function(t){return this._hi>t._hi||this._hi===t._hi&&this._lo>=t._lo}},{key:"pow",value:function(t){if(0===t)return e.valueOf(1);var n=new e(this),r=e.valueOf(1),i=Math.abs(t);if(i>1)for(;i>0;)i%2==1&&r.selfMultiply(n),(i/=2)>0&&(n=n.sqr());else r=n;return t<0?r.reciprocal():r}},{key:"ceil",value:function(){if(this.isNaN())return e.NaN;var t=Math.ceil(this._hi),n=0;return t===this._hi&&(n=Math.ceil(this._lo)),new e(t,n)}},{key:"compareTo",value:function(t){var e=t;return this._hi<e._hi?-1:this._hi>e._hi?1:this._lo<e._lo?-1:this._lo>e._lo?1:0}},{key:"rint",value:function(){return this.isNaN()?this:this.add(.5).floor()}},{key:"setValue",value:function(){if(arguments[0]instanceof e){var t=arguments[0];return this.init(t),this}if("number"==typeof arguments[0]){var n=arguments[0];return this.init(n),this}}},{key:"max",value:function(t){return this.ge(t)?this:t}},{key:"sqrt",value:function(){if(this.isZero())return e.valueOf(0);if(this.isNegative())return e.NaN;var t=1/Math.sqrt(this._hi),n=this._hi*t,r=e.valueOf(n),i=this.subtract(r.sqr())._hi*(.5*t);return r.add(i)}},{key:"selfAdd",value:function(){if(1===arguments.length){if(arguments[0]instanceof e){var t=arguments[0];return this.selfAdd(t._hi,t._lo)}if("number"==typeof arguments[0]){var n,r,i,o,s,a=arguments[0],l=null;return l=(i=this._hi+a)-(o=i-this._hi),r=(s=(l=a-o+(this._hi-l))+this._lo)+(i-(n=i+s)),this._hi=n+r,this._lo=r+(n-this._hi),this}}else if(2===arguments.length){var u,c,h,d,f=arguments[0],p=arguments[1],g=null,y=null,m=null;h=this._hi+f,c=this._lo+p,y=h-(m=h-this._hi),g=c-(d=c-this._lo);var v=(u=h+(m=(y=f-m+(this._hi-y))+c))+(m=(g=p-d+(this._lo-g))+(m+(h-u))),b=m+(u-v);return this._hi=v,this._lo=b,this}}},{key:"selfMultiply",value:function(){if(1===arguments.length){if(arguments[0]instanceof e){var t=arguments[0];return this.selfMultiply(t._hi,t._lo)}if("number"==typeof arguments[0]){var n=arguments[0];return this.selfMultiply(n,0)}}else if(2===arguments.length){var r,i,o=arguments[0],s=arguments[1],a=null,l=null,u=null,c=null;a=(u=e.SPLIT*this._hi)-this._hi,c=e.SPLIT*o,a=u-a,r=this._hi-a,l=c-o;var h=(u=this._hi*o)+(c=a*(l=c-l)-u+a*(i=o-l)+r*l+r*i+(this._hi*s+this._lo*o)),d=c+(a=u-h);return this._hi=h,this._lo=d,this}}},{key:"selfSqr",value:function(){return this.selfMultiply(this)}},{key:"floor",value:function(){if(this.isNaN())return e.NaN;var t=Math.floor(this._hi),n=0;return t===this._hi&&(n=Math.floor(this._lo)),new e(t,n)}},{key:"negate",value:function(){return this.isNaN()?this:new e(-this._hi,-this._lo)}},{key:"clone",value:function(){try{return null}catch(t){if(t instanceof CloneNotSupportedException)return null;throw t}}},{key:"multiply",value:function(){if(arguments[0]instanceof e){var t=arguments[0];return t.isNaN()?e.createNaN():e.copy(this).selfMultiply(t)}if("number"==typeof arguments[0]){var n=arguments[0];return R.isNaN(n)?e.createNaN():e.copy(this).selfMultiply(n,0)}}},{key:"isNaN",value:function(){return R.isNaN(this._hi)}},{key:"intValue",value:function(){return Math.trunc(this._hi)}},{key:"toString",value:function(){var t=e.magnitude(this._hi);return t>=-3&&t<=20?this.toStandardNotation():this.toSciNotation()}},{key:"toStandardNotation",value:function(){var t=this.getSpecialNumberString();if(null!==t)return t;var n=new Array(1).fill(null),r=this.extractSignificantDigits(!0,n),i=n[0]+1,o=r;if("."===r.charAt(0))o="0"+r;else if(i<0)o="0."+e.stringOfChar("0",-i)+r;else if(-1===r.indexOf(".")){var s=i-r.length;o=r+e.stringOfChar("0",s)+".0"}return this.isNegative()?"-"+o:o}},{key:"reciprocal",value:function(){var t,n,r,i,o=null,s=null,a=null,l=null;t=(r=1/this._hi)-(o=(a=e.SPLIT*r)-(o=a-r)),s=(l=e.SPLIT*this._hi)-this._hi;var u=r+(a=(1-(i=r*this._hi)-(l=o*(s=l-s)-i+o*(n=this._hi-s)+t*s+t*n)-r*this._lo)/this._hi);return new e(u,r-u+a)}},{key:"toSciNotation",value:function(){if(this.isZero())return e.SCI_NOT_ZERO;var t=this.getSpecialNumberString();if(null!==t)return t;var n=new Array(1).fill(null),r=this.extractSignificantDigits(!1,n),i=e.SCI_NOT_EXPONENT_CHAR+n[0];if("0"===r.charAt(0))throw new IllegalStateException("Found leading zero: "+r);var o="";r.length>1&&(o=r.substring(1));var s=r.charAt(0)+"."+o;return this.isNegative()?"-"+s+i:s+i}},{key:"abs",value:function(){return this.isNaN()?e.NaN:this.isNegative()?this.negate():new e(this)}},{key:"isPositive",value:function(){return this._hi>0||0===this._hi&&this._lo>0}},{key:"lt",value:function(t){return this._hi<t._hi||this._hi===t._hi&&this._lo<t._lo}},{key:"add",value:function(){if(arguments[0]instanceof e){var t=arguments[0];return e.copy(this).selfAdd(t)}if("number"==typeof arguments[0]){var n=arguments[0];return e.copy(this).selfAdd(n)}}},{key:"init",value:function(){if(1===arguments.length){if("number"==typeof arguments[0]){var t=arguments[0];this._hi=t,this._lo=0}else if(arguments[0]instanceof e){var n=arguments[0];this._hi=n._hi,this._lo=n._lo}}else if(2===arguments.length){var r=arguments[0],i=arguments[1];this._hi=r,this._lo=i}}},{key:"gt",value:function(t){return this._hi>t._hi||this._hi===t._hi&&this._lo>t._lo}},{key:"isNegative",value:function(){return this._hi<0||0===this._hi&&this._lo<0}},{key:"trunc",value:function(){return this.isNaN()?e.NaN:this.isPositive()?this.floor():this.ceil()}},{key:"signum",value:function(){return this._hi>0?1:this._hi<0?-1:this._lo>0?1:this._lo<0?-1:0}},{key:"interfaces_",get:function(){return[x,_,A]}}],[{key:"constructor_",value:function(){if(this._hi=0,this._lo=0,0===arguments.length)this.init(0);else if(1===arguments.length){if("number"==typeof arguments[0]){var t=arguments[0];this.init(t)}else if(arguments[0]instanceof e){var n=arguments[0];this.init(n)}else if("string"==typeof arguments[0]){var r=arguments[0];e.constructor_.call(this,e.parse(r))}}else if(2===arguments.length){var i=arguments[0],o=arguments[1];this.init(i,o)}}},{key:"determinant",value:function(){if("number"==typeof arguments[3]&&"number"==typeof arguments[2]&&"number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],n=arguments[1],r=arguments[2],i=arguments[3];return e.determinant(e.valueOf(t),e.valueOf(n),e.valueOf(r),e.valueOf(i))}if(arguments[3]instanceof e&&arguments[2]instanceof e&&arguments[0]instanceof e&&arguments[1]instanceof e){var o=arguments[1],s=arguments[2],a=arguments[3];return arguments[0].multiply(a).selfSubtract(o.multiply(s))}}},{key:"sqr",value:function(t){return e.valueOf(t).selfMultiply(t)}},{key:"valueOf",value:function(){if("string"==typeof arguments[0]){var t=arguments[0];return e.parse(t)}if("number"==typeof arguments[0])return new e(arguments[0])}},{key:"sqrt",value:function(t){return e.valueOf(t).sqrt()}},{key:"parse",value:function(t){for(var n=0,r=t.length;ot.isWhitespace(t.charAt(n));)n++;var i=!1;if(n<r){var o=t.charAt(n);"-"!==o&&"+"!==o||(n++,"-"===o&&(i=!0))}for(var s=new e,a=0,l=0,u=0,c=!1;!(n>=r);){var h=t.charAt(n);if(n++,ot.isDigit(h)){var d=h-"0";s.selfMultiply(e.TEN),s.selfAdd(d),a++}else{if("."!==h){if("e"===h||"E"===h){var f=t.substring(n);try{u=it.parseInt(f)}catch(e){throw e instanceof NumberFormatException?new NumberFormatException("Invalid exponent "+f+" in string "+t):e}break}throw new NumberFormatException("Unexpected character '"+h+"' at position "+n+" in string "+t)}l=a,c=!0}}var p=s;c||(l=a);var g=a-l-u;if(0===g)p=s;else if(g>0){var y=e.TEN.pow(g);p=s.divide(y)}else if(g<0){var m=e.TEN.pow(-g);p=s.multiply(m)}return i?p.negate():p}},{key:"createNaN",value:function(){return new e(R.NaN,R.NaN)}},{key:"copy",value:function(t){return new e(t)}},{key:"magnitude",value:function(t){var e=Math.abs(t),n=Math.log(e)/Math.log(10),r=Math.trunc(Math.floor(n));return 10*Math.pow(10,r)<=e&&(r+=1),r}},{key:"stringOfChar",value:function(t,e){for(var n=new rt,r=0;r<e;r++)n.append(t);return n.toString()}}]),e}();st.PI=new st(3.141592653589793,12246467991473532e-32),st.TWO_PI=new st(6.283185307179586,24492935982947064e-32),st.PI_2=new st(1.5707963267948966,6123233995736766e-32),st.E=new st(2.718281828459045,14456468917292502e-32),st.NaN=new st(R.NaN,R.NaN),st.EPS=123259516440783e-46,st.SPLIT=134217729,st.MAX_PRINT_DIGITS=32,st.TEN=st.valueOf(10),st.ONE=st.valueOf(1),st.SCI_NOT_EXPONENT_CHAR="E",st.SCI_NOT_ZERO="0.0E0";var at=function(){function e(){t(this,e)}return n(e,null,[{key:"orientationIndex",value:function(t,n,r){var i=e.orientationIndexFilter(t,n,r);if(i<=1)return i;var o=st.valueOf(n.x).selfAdd(-t.x),s=st.valueOf(n.y).selfAdd(-t.y),a=st.valueOf(r.x).selfAdd(-n.x),l=st.valueOf(r.y).selfAdd(-n.y);return o.selfMultiply(l).selfSubtract(s.selfMultiply(a)).signum()}},{key:"signOfDet2x2",value:function(){if(arguments[3]instanceof st&&arguments[2]instanceof st&&arguments[0]instanceof st&&arguments[1]instanceof st){var t=arguments[1],e=arguments[2],n=arguments[3];return arguments[0].multiply(n).selfSubtract(t.multiply(e)).signum()}if("number"==typeof arguments[3]&&"number"==typeof arguments[2]&&"number"==typeof arguments[0]&&"number"==typeof arguments[1]){var r=arguments[0],i=arguments[1],o=arguments[2],s=arguments[3],a=st.valueOf(r),l=st.valueOf(i),u=st.valueOf(o),c=st.valueOf(s);return a.multiply(c).selfSubtract(l.multiply(u)).signum()}}},{key:"intersection",value:function(t,e,n,r){var i=new st(t.y).selfSubtract(e.y),o=new st(e.x).selfSubtract(t.x),s=new st(t.x).selfMultiply(e.y).selfSubtract(new st(e.x).selfMultiply(t.y)),a=new st(n.y).selfSubtract(r.y),l=new st(r.x).selfSubtract(n.x),u=new st(n.x).selfMultiply(r.y).selfSubtract(new st(r.x).selfMultiply(n.y)),c=o.multiply(u).selfSubtract(l.multiply(s)),h=a.multiply(s).selfSubtract(i.multiply(u)),d=i.multiply(l).selfSubtract(a.multiply(o)),f=c.selfDivide(d).doubleValue(),p=h.selfDivide(d).doubleValue();return R.isNaN(f)||R.isInfinite(f)||R.isNaN(p)||R.isInfinite(p)?null:new G(f,p)}},{key:"orientationIndexFilter",value:function(t,n,r){var i=null,o=(t.x-r.x)*(n.y-r.y),s=(t.y-r.y)*(n.x-r.x),a=o-s;if(o>0){if(s<=0)return e.signum(a);i=o+s}else{if(!(o<0))return e.signum(a);if(s>=0)return e.signum(a);i=-o-s}var l=e.DP_SAFE_EPSILON*i;return a>=l||-a>=l?e.signum(a):2}},{key:"signum",value:function(t){return t>0?1:t<0?-1:0}}]),e}();at.DP_SAFE_EPSILON=1e-15;var lt=function(){function e(){t(this,e)}return n(e,[{key:"getM",value:function(t){if(this.hasM()){var e=this.getDimension()-this.getMeasures();return this.getOrdinate(t,e)}return R.NaN}},{key:"setOrdinate",value:function(t,e,n){}},{key:"getZ",value:function(t){return this.hasZ()?this.getOrdinate(t,2):R.NaN}},{key:"size",value:function(){}},{key:"getOrdinate",value:function(t,e){}},{key:"getCoordinate",value:function(){}},{key:"getCoordinateCopy",value:function(t){}},{key:"createCoordinate",value:function(){}},{key:"getDimension",value:function(){}},{key:"hasM",value:function(){return this.getMeasures()>0}},{key:"getX",value:function(t){}},{key:"hasZ",value:function(){return this.getDimension()-this.getMeasures()>2}},{key:"getMeasures",value:function(){return 0}},{key:"expandEnvelope",value:function(t){}},{key:"copy",value:function(){}},{key:"getY",value:function(t){}},{key:"toCoordinateArray",value:function(){}},{key:"interfaces_",get:function(){return[A]}}]),e}();lt.X=0,lt.Y=1,lt.Z=2,lt.M=3;var ut=function(){function e(){t(this,e)}return n(e,null,[{key:"index",value:function(t,e,n){return at.orientationIndex(t,e,n)}},{key:"isCCW",value:function(){if(arguments[0]instanceof Array){var t=arguments[0],n=t.length-1;if(n<3)throw new v("Ring has fewer than 4 points, so orientation cannot be determined");for(var r=t[0],i=0,o=1;o<=n;o++){var s=t[o];s.y>r.y&&(r=s,i=o)}var a=i;do{(a-=1)<0&&(a=n)}while(t[a].equals2D(r)&&a!==i);var l=i;do{l=(l+1)%n}while(t[l].equals2D(r)&&l!==i);var u=t[a],c=t[l];if(u.equals2D(r)||c.equals2D(r)||u.equals2D(c))return!1;var h=e.index(u,r,c);return 0===h?u.x>c.x:h>0}if(nt(arguments[0],lt)){var d=arguments[0],f=d.size()-1;if(f<3)throw new v("Ring has fewer than 4 points, so orientation cannot be determined");for(var p=d.getCoordinate(0),g=0,y=1;y<=f;y++){var m=d.getCoordinate(y);m.y>p.y&&(p=m,g=y)}var b=null,_=g;do{(_-=1)<0&&(_=f),b=d.getCoordinate(_)}while(b.equals2D(p)&&_!==g);var A=null,x=g;do{x=(x+1)%f,A=d.getCoordinate(x)}while(A.equals2D(p)&&x!==g);if(b.equals2D(p)||A.equals2D(p)||b.equals2D(A))return!1;var w=e.index(b,p,A);return 0===w?b.x>A.x:w>0}}}]),e}();ut.CLOCKWISE=-1,ut.RIGHT=ut.CLOCKWISE,ut.COUNTERCLOCKWISE=1,ut.LEFT=ut.COUNTERCLOCKWISE,ut.COLLINEAR=0,ut.STRAIGHT=ut.COLLINEAR;var ct=function(){function e(){t(this,e),e.constructor_.apply(this,arguments)}return n(e,[{key:"getCoordinate",value:function(){return this._minCoord}},{key:"getRightmostSide",value:function(t,e){var n=this.getRightmostSideOfSegment(t,e);return n<0&&(n=this.getRightmostSideOfSegment(t,e-1)),n<0&&(this._minCoord=null,this.checkForRightmostCoordinate(t)),n}},{key:"findRightmostEdgeAtVertex",value:function(){var t=this._minDe.getEdge().getCoordinates();D.isTrue(this._minIndex>0&&this._minIndex<t.length,"rightmost point expected to be interior vertex of edge");var e=t[this._minIndex-1],n=t[this._minIndex+1],r=ut.index(this._minCoord,n,e),i=!1;(e.y<this._minCoord.y&&n.y<this._minCoord.y&&r===ut.COUNTERCLOCKWISE||e.y>this._minCoord.y&&n.y>this._minCoord.y&&r===ut.CLOCKWISE)&&(i=!0),i&&(this._minIndex=this._minIndex-1)}},{key:"getRightmostSideOfSegment",value:function(t,e){var n=t.getEdge().getCoordinates();if(e<0||e+1>=n.length)return-1;if(n[e].y===n[e+1].y)return-1;var r=Z.LEFT;return n[e].y<n[e+1].y&&(r=Z.RIGHT),r}},{key:"getEdge",value:function(){return this._orientedDe}},{key:"checkForRightmostCoordinate",value:function(t){for(var e=t.getEdge().getCoordinates(),n=0;n<e.length-1;n++)(null===this._minCoord||e[n].x>this._minCoord.x)&&(this._minDe=t,this._minIndex=n,this._minCoord=e[n])}},{key:"findRightmostEdgeAtNode",value:function(){var t=this._minDe.getNode().getEdges();this._minDe=t.getRightmostEdge(),this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)}},{key:"findEdge",value:function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();n.isForward()&&this.checkForRightmostCoordinate(n)}D.isTrue(0!==this._minIndex||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing"),0===this._minIndex?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this._orientedDe=this._minDe,this.getRightmostSide(this._minDe,this._minIndex)===Z.LEFT&&(this._orientedDe=this._minDe.getSym())}}],[{key:"constructor_",value:function(){this._minIndex=-1,this._minCoord=null,this._minDe=null,this._orientedDe=null}}]),e}(),ht=function(e){r(o,e);var i=c(o);function o(e,n){var r;return t(this,o),(r=i.call(this,n?e+" [ "+n+" ]":e)).pt=n?new G(n):void 0,r.name=Object.keys({TopologyException:o})[0],r}return n(o,[{key:"getCoordinate",value:function(){return this.pt}}]),o}(L),dt=function(){function e(){t(this,e),this.array=[]}return n(e,[{key:"addLast",value:function(t){this.array.push(t)}},{key:"removeFirst",value:function(){return this.array.shift()}},{key:"isEmpty",value:function(){return 0===this.array.length}}]),e}(),ft=function(e,i){r(s,e);var o=c(s);function s(e){var n;return t(this,s),(n=o.call(this)).array=[],e instanceof q&&n.addAll(e),n}return n(s,[{key:"interfaces_",get:function(){return[tt,q]}},{key:"ensureCapacity",value:function(){}},{key:"add",value:function(t){return 1===arguments.length?this.array.push(t):this.array.splice(arguments[0],0,arguments[1]),!0}},{key:"clear",value:function(){this.array=[]}},{key:"addAll",value:function(t){var e,n=g(t);try{for(n.s();!(e=n.n()).done;){var r=e.value;this.array.push(r)}}catch(t){n.e(t)}finally{n.f()}}},{key:"set",value:function(t,e){var n=this.array[t];return this.array[t]=e,n}},{key:"iterator",value:function(){return new pt(this)}},{key:"get",value:function(t){if(t<0||t>=this.size())throw new $;return this.array[t]}},{key:"isEmpty",value:function(){return 0===this.array.length}},{key:"sort",value:function(t){t?this.array.sort((function(e,n){return t.compare(e,n)})):this.array.sort()}},{key:"size",value:function(){return this.array.length}},{key:"toArray",value:function(){return this.array.slice()}},{key:"remove",value:function(t){for(var e=0,n=this.array.length;e<n;e++)if(this.array[e]===t)return!!this.array.splice(e,1);return!1}},{key:i,value:function(){return this.array.values()}}]),s}(tt,Symbol.iterator),pt=function(){function e(n){t(this,e),this.arrayList=n,this.position=0}return n(e,[{key:"next",value:function(){if(this.position===this.arrayList.size())throw new W;return this.arrayList.get(this.position++)}},{key:"hasNext",value:function(){return this.position<this.arrayList.size()}},{key:"set",value:function(t){return this.arrayList.set(this.position-1,t)}},{key:"remove",value:function(){this.arrayList.remove(this.arrayList.get(this.position))}}]),e}(),gt=function(){function e(){t(this,e),e.constructor_.apply(this,arguments)}return n(e,[{key:"clearVisitedEdges",value:function(){for(var t=this._dirEdgeList.iterator();t.hasNext();)t.next().setVisited(!1)}},{key:"getRightmostCoordinate",value:function(){return this._rightMostCoord}},{key:"computeNodeDepth",value:function(t){for(var e=null,n=t.getEdges().iterator();n.hasNext();){var r=n.next();if(r.isVisited()||r.getSym().isVisited()){e=r;break}}if(null===e)throw new ht("unable to find edge to compute depths at "+t.getCoordinate());t.getEdges().computeDepths(e);for(var i=t.getEdges().iterator();i.hasNext();){var o=i.next();o.setVisited(!0),this.copySymDepths(o)}}},{key:"computeDepth",value:function(t){this.clearVisitedEdges();var e=this._finder.getEdge();e.getNode(),e.getLabel(),e.setEdgeDepths(Z.RIGHT,t),this.copySymDepths(e),this.computeDepths(e)}},{key:"create",value:function(t){this.addReachable(t),this._finder.findEdge(this._dirEdgeList),this._rightMostCoord=this._finder.getCoordinate()}},{key:"findResultEdges",value:function(){for(var t=this._dirEdgeList.iterator();t.hasNext();){var e=t.next();e.getDepth(Z.RIGHT)>=1&&e.getDepth(Z.LEFT)<=0&&!e.isInteriorAreaEdge()&&e.setInResult(!0)}}},{key:"computeDepths",value:function(t){var e=new X,n=new dt,r=t.getNode();for(n.addLast(r),e.add(r),t.setVisited(!0);!n.isEmpty();){var i=n.removeFirst();e.add(i),this.computeNodeDepth(i);for(var o=i.getEdges().iterator();o.hasNext();){var s=o.next().getSym();if(!s.isVisited()){var a=s.getNode();e.contains(a)||(n.addLast(a),e.add(a))}}}}},{key:"compareTo",value:function(t){var e=t;return this._rightMostCoord.x<e._rightMostCoord.x?-1:this._rightMostCoord.x>e._rightMostCoord.x?1:0}},{key:"getEnvelope",value:function(){if(null===this._env){for(var t=new z,e=this._dirEdgeList.iterator();e.hasNext();)for(var n=e.next().getEdge().getCoordinates(),r=0;r<n.length-1;r++)t.expandToInclude(n[r]);this._env=t}return this._env}},{key:"addReachable",value:function(t){var e=new et;for(e.add(t);!e.empty();){var n=e.pop();this.add(n,e)}}},{key:"copySymDepths",value:function(t){var e=t.getSym();e.setDepth(Z.LEFT,t.getDepth(Z.RIGHT)),e.setDepth(Z.RIGHT,t.getDepth(Z.LEFT))}},{key:"add",value:function(t,e){t.setVisited(!0),this._nodes.add(t);for(var n=t.getEdges().iterator();n.hasNext();){var r=n.next();this._dirEdgeList.add(r);var i=r.getSym().getNode();i.isVisited()||e.push(i)}}},{key:"getNodes",value:function(){return this._nodes}},{key:"getDirectedEdges",value:function(){return this._dirEdgeList}},{key:"interfaces_",get:function(){return[_]}}],[{key:"constructor_",value:function(){this._finder=null,this._dirEdgeList=new ft,this._nodes=new ft,this._rightMostCoord=null,this._env=null,this._finder=new ct}}]),e}(),yt=function(){function e(){t(this,e)}return n(e,null,[{key:"intersection",value:function(t,e,n,r){var i=t.x<e.x?t.x:e.x,o=t.y<e.y?t.y:e.y,s=t.x>e.x?t.x:e.x,a=t.y>e.y?t.y:e.y,l=n.x<r.x?n.x:r.x,u=n.y<r.y?n.y:r.y,c=n.x>r.x?n.x:r.x,h=n.y>r.y?n.y:r.y,d=((i>l?i:l)+(s<c?s:c))/2,f=((o>u?o:u)+(a<h?a:h))/2,p=t.x-d,g=t.y-f,y=e.x-d,m=e.y-f,v=n.x-d,b=n.y-f,_=r.x-d,A=r.y-f,x=g-m,w=y-p,C=p*m-y*g,S=b-A,E=_-v,M=v*A-_*b,P=x*E-S*w,T=(w*M-E*C)/P,O=(S*C-x*M)/P;return R.isNaN(T)||R.isInfinite(T)||R.isNaN(O)||R.isInfinite(O)?null:new G(T+d,O+f)}}]),e}(),mt=function(){function e(){t(this,e)}return n(e,null,[{key:"arraycopy",value:function(t,e,n,r,i){for(var o=0,s=e;s<e+i;s++)n[r+o]=t[s],o++}},{key:"getProperty",value:function(t){return{"line.separator":"\n"}[t]}}]),e}(),vt=function(){function e(){t(this,e)}return n(e,null,[{key:"log10",value:function(t){var n=Math.log(t);return R.isInfinite(n)||R.isNaN(n)?n:n/e.LOG_10}},{key:"min",value:function(t,e,n,r){var i=t;return e<i&&(i=e),n<i&&(i=n),r<i&&(i=r),i}},{key:"clamp",value:function(){if("number"==typeof arguments[2]&&"number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1],n=arguments[2];return t<e?e:t>n?n:t}if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var r=arguments[0],i=arguments[1],o=arguments[2];return r<i?i:r>o?o:r}}},{key:"wrap",value:function(t,e){return t<0?e- -t%e:t%e}},{key:"max",value:function(){if(3===arguments.length){var t=arguments[1],e=arguments[2],n=arguments[0];return t>n&&(n=t),e>n&&(n=e),n}if(4===arguments.length){var r=arguments[1],i=arguments[2],o=arguments[3],s=arguments[0];return r>s&&(s=r),i>s&&(s=i),o>s&&(s=o),s}}},{key:"average",value:function(t,e){return(t+e)/2}}]),e}();vt.LOG_10=Math.log(10);var bt=function(){function e(){t(this,e)}return n(e,null,[{key:"segmentToSegment",value:function(t,n,r,i){if(t.equals(n))return e.pointToSegment(t,r,i);if(r.equals(i))return e.pointToSegment(i,t,n);var o=!1;if(z.intersects(t,n,r,i)){var s=(n.x-t.x)*(i.y-r.y)-(n.y-t.y)*(i.x-r.x);if(0===s)o=!0;else{var a=(t.y-r.y)*(i.x-r.x)-(t.x-r.x)*(i.y-r.y),l=((t.y-r.y)*(n.x-t.x)-(t.x-r.x)*(n.y-t.y))/s,u=a/s;(u<0||u>1||l<0||l>1)&&(o=!0)}}else o=!0;return o?vt.min(e.pointToSegment(t,r,i),e.pointToSegment(n,r,i),e.pointToSegment(r,t,n),e.pointToSegment(i,t,n)):0}},{key:"pointToSegment",value:function(t,e,n){if(e.x===n.x&&e.y===n.y)return t.distance(e);var r=(n.x-e.x)*(n.x-e.x)+(n.y-e.y)*(n.y-e.y),i=((t.x-e.x)*(n.x-e.x)+(t.y-e.y)*(n.y-e.y))/r;if(i<=0)return t.distance(e);if(i>=1)return t.distance(n);var o=((e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y))/r;return Math.abs(o)*Math.sqrt(r)}},{key:"pointToLinePerpendicular",value:function(t,e,n){var r=(n.x-e.x)*(n.x-e.x)+(n.y-e.y)*(n.y-e.y),i=((e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y))/r;return Math.abs(i)*Math.sqrt(r)}},{key:"pointToSegmentString",value:function(t,n){if(0===n.length)throw new v("Line array must contain at least one vertex");for(var r=t.distance(n[0]),i=0;i<n.length-1;i++){var o=e.pointToSegment(t,n[i],n[i+1]);o<r&&(r=o)}return r}}]),e}(),_t=function(){function e(){t(this,e)}return n(e,[{key:"create",value:function(){if(1===arguments.length)arguments[0]instanceof Array||nt(arguments[0],lt);else if(2===arguments.length);else if(3===arguments.length){var t=arguments[0],e=arguments[1];return this.create(t,e)}}}]),e}(),At=function(){function e(){t(this,e)}return n(e,[{key:"filter",value:function(t){}}]),e}(),xt=function(){function e(){t(this,e)}return n(e,null,[{key:"ofLine",value:function(t){var e=t.size();if(e<=1)return 0;var n=0,r=new G;t.getCoordinate(0,r);for(var i=r.x,o=r.y,s=1;s<e;s++){t.getCoordinate(s,r);var a=r.x,l=r.y,u=a-i,c=l-o;n+=Math.sqrt(u*u+c*c),i=a,o=l}return n}}]),e}(),wt=function e(){t(this,e)},Ct=function(){function e(){t(this,e)}return n(e,null,[{key:"copyCoord",value:function(t,e,n,r){for(var i=Math.min(t.getDimension(),n.getDimension()),o=0;o<i;o++)n.setOrdinate(r,o,t.getOrdinate(e,o))}},{key:"isRing",value:function(t){var e=t.size();return 0===e||!(e<=3)&&t.getOrdinate(0,lt.X)===t.getOrdinate(e-1,lt.X)&&t.getOrdinate(0,lt.Y)===t.getOrdinate(e-1,lt.Y)}},{key:"scroll",value:function(){if(2===arguments.length){if(nt(arguments[0],lt)&&Number.isInteger(arguments[1])){var t=arguments[0],n=arguments[1];e.scroll(t,n,e.isRing(t))}else if(nt(arguments[0],lt)&&arguments[1]instanceof G){var r=arguments[0],i=arguments[1],o=e.indexOf(i,r);if(o<=0)return null;e.scroll(r,o)}}else if(3===arguments.length){var s=arguments[0],a=arguments[1],l=arguments[2];if(a<=0)return null;for(var u=s.copy(),c=l?s.size()-1:s.size(),h=0;h<c;h++)for(var d=0;d<s.getDimension();d++)s.setOrdinate(h,d,u.getOrdinate((a+h)%c,d));if(l)for(var f=0;f<s.getDimension();f++)s.setOrdinate(c,f,s.getOrdinate(0,f))}}},{key:"isEqual",value:function(t,e){var n=t.size();if(n!==e.size())return!1;for(var r=Math.min(t.getDimension(),e.getDimension()),i=0;i<n;i++)for(var o=0;o<r;o++){var s=t.getOrdinate(i,o),a=e.getOrdinate(i,o);if(!(t.getOrdinate(i,o)===e.getOrdinate(i,o)||R.isNaN(s)&&R.isNaN(a)))return!1}return!0}},{key:"minCoordinateIndex",value:function(){if(1===arguments.length){var t=arguments[0];return e.minCoordinateIndex(t,0,t.size()-1)}if(3===arguments.length){for(var n=arguments[0],r=arguments[2],i=-1,o=null,s=arguments[1];s<=r;s++){var a=n.getCoordinate(s);(null===o||o.compareTo(a)>0)&&(o=a,i=s)}return i}}},{key:"extend",value:function(t,n,r){var i=t.create(r,n.getDimension()),o=n.size();if(e.copy(n,0,i,0,o),o>0)for(var s=o;s<r;s++)e.copy(n,o-1,i,s,1);return i}},{key:"reverse",value:function(t){for(var n=t.size()-1,r=Math.trunc(n/2),i=0;i<=r;i++)e.swap(t,i,n-i)}},{key:"swap",value:function(t,e,n){if(e===n)return null;for(var r=0;r<t.getDimension();r++){var i=t.getOrdinate(e,r);t.setOrdinate(e,r,t.getOrdinate(n,r)),t.setOrdinate(n,r,i)}}},{key:"copy",value:function(t,n,r,i,o){for(var s=0;s<o;s++)e.copyCoord(t,n+s,r,i+s)}},{key:"ensureValidRing",value:function(t,n){var r=n.size();return 0===r?n:r<=3?e.createClosedRing(t,n,4):n.getOrdinate(0,lt.X)===n.getOrdinate(r-1,lt.X)&&n.getOrdinate(0,lt.Y)===n.getOrdinate(r-1,lt.Y)?n:e.createClosedRing(t,n,r+1)}},{key:"indexOf",value:function(t,e){for(var n=0;n<e.size();n++)if(t.x===e.getOrdinate(n,lt.X)&&t.y===e.getOrdinate(n,lt.Y))return n;return-1}},{key:"createClosedRing",value:function(t,n,r){var i=t.create(r,n.getDimension()),o=n.size();e.copy(n,0,i,0,o);for(var s=o;s<r;s++)e.copy(n,0,i,s,1);return i}},{key:"minCoordinate",value:function(t){for(var e=null,n=0;n<t.size();n++){var r=t.getCoordinate(n);(null===e||e.compareTo(r)>0)&&(e=r)}return e}}]),e}(),St=function(){function e(){t(this,e)}return n(e,null,[{key:"toDimensionSymbol",value:function(t){switch(t){case e.FALSE:return e.SYM_FALSE;case e.TRUE:return e.SYM_TRUE;case e.DONTCARE:return e.SYM_DONTCARE;case e.P:return e.SYM_P;case e.L:return e.SYM_L;case e.A:return e.SYM_A}throw new v("Unknown dimension value: "+t)}},{key:"toDimensionValue",value:function(t){switch(ot.toUpperCase(t)){case e.SYM_FALSE:return e.FALSE;case e.SYM_TRUE:return e.TRUE;case e.SYM_DONTCARE:return e.DONTCARE;case e.SYM_P:return e.P;case e.SYM_L:return e.L;case e.SYM_A:return e.A}throw new v("Unknown dimension symbol: "+t)}}]),e}();St.P=0,St.L=1,St.A=2,St.FALSE=-1,St.TRUE=-2,St.DONTCARE=-3,St.SYM_FALSE="F",St.SYM_TRUE="T",St.SYM_DONTCARE="*",St.SYM_P="0",St.SYM_L="1",St.SYM_A="2";var Et=function(){function e(){t(this,e)}return n(e,[{key:"filter",value:function(t){}}]),e}(),Mt=function(){function e(){t(this,e)}return n(e,[{key:"filter",value:function(t,e){}},{key:"isDone",value:function(){}},{key:"isGeometryChanged",value:function(){}}]),e}(),Pt=function(e){r(s,e);var o=c(s);function s(){var e;return t(this,s),e=o.call(this),s.constructor_.apply(u(e),arguments),e}return n(s,[{key:"computeEnvelopeInternal",value:function(){return this.isEmpty()?new z:this._points.expandEnvelope(new z)}},{key:"isRing",value:function(){return this.isClosed()&&this.isSimple()}},{key:"getCoordinates",value:function(){return this._points.toCoordinateArray()}},{key:"copyInternal",value:function(){return new s(this._points.copy(),this._factory)}},{key:"equalsExact",value:function(){if(2===arguments.length&&"number"==typeof arguments[1]&&arguments[0]instanceof V){var t=arguments[0],e=arguments[1];if(!this.isEquivalentClass(t))return!1;var n=t;if(this._points.size()!==n._points.size())return!1;for(var r=0;r<this._points.size();r++)if(!this.equal(this._points.getCoordinate(r),n._points.getCoordinate(r),e))return!1;return!0}return h(i(s.prototype),"equalsExact",this).apply(this,arguments)}},{key:"normalize",value:function(){for(var t=0;t<Math.trunc(this._points.size()/2);t++){var e=this._points.size()-1-t;if(!this._points.getCoordinate(t).equals(this._points.getCoordinate(e))){if(this._points.getCoordinate(t).compareTo(this._points.getCoordinate(e))>0){var n=this._points.copy();Ct.reverse(n),this._points=n}return null}}}},{key:"getCoordinate",value:function(){return this.isEmpty()?null:this._points.getCoordinate(0)}},{key:"getBoundaryDimension",value:function(){return this.isClosed()?St.FALSE:0}},{key:"isClosed",value:function(){return!this.isEmpty()&&this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))}},{key:"reverseInternal",value:function(){var t=this._points.copy();return Ct.reverse(t),this.getFactory().createLineString(t)}},{key:"getEndPoint",value:function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)}},{key:"getTypeCode",value:function(){return V.TYPECODE_LINESTRING}},{key:"getDimension",value:function(){return 1}},{key:"getLength",value:function(){return xt.ofLine(this._points)}},{key:"getNumPoints",value:function(){return this._points.size()}},{key:"compareToSameClass",value:function(){if(1===arguments.length){for(var t=arguments[0],e=0,n=0;e<this._points.size()&&n<t._points.size();){var r=this._points.getCoordinate(e).compareTo(t._points.getCoordinate(n));if(0!==r)return r;e++,n++}return e<this._points.size()?1:n<t._points.size()?-1:0}if(2===arguments.length){var i=arguments[0];return arguments[1].compare(this._points,i._points)}}},{key:"apply",value:function(){if(nt(arguments[0],At))for(var t=arguments[0],e=0;e<this._points.size();e++)t.filter(this._points.getCoordinate(e));else if(nt(arguments[0],Mt)){var n=arguments[0];if(0===this._points.size())return null;for(var r=0;r<this._points.size()&&(n.filter(this._points,r),!n.isDone());r++);n.isGeometryChanged()&&this.geometryChanged()}else(nt(arguments[0],Et)||nt(arguments[0],b))&&arguments[0].filter(this)}},{key:"getBoundary",value:function(){throw new J}},{key:"isEquivalentClass",value:function(t){return t instanceof s}},{key:"getCoordinateN",value:function(t){return this._points.getCoordinate(t)}},{key:"getGeometryType",value:function(){return V.TYPENAME_LINESTRING}},{key:"getCoordinateSequence",value:function(){return this._points}},{key:"isEmpty",value:function(){return 0===this._points.size()}},{key:"init",value:function(t){if(null===t&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),1===t.size())throw new v("Invalid number of points in LineString (found "+t.size()+" - must be 0 or >= 2)");this._points=t}},{key:"isCoordinate",value:function(t){for(var e=0;e<this._points.size();e++)if(this._points.getCoordinate(e).equals(t))return!0;return!1}},{key:"getStartPoint",value:function(){return this.isEmpty()?null:this.getPointN(0)}},{key:"getPointN",value:function(t){return this.getFactory().createPoint(this._points.getCoordinate(t))}},{key:"interfaces_",get:function(){return[wt]}}],[{key:"constructor_",value:function(){if(this._points=null,0===arguments.length);else if(2===arguments.length){var t=arguments[0],e=arguments[1];V.constructor_.call(this,e),this.init(t)}}}]),s}(V),Tt=function e(){t(this,e)},Ot=function(e){r(s,e);var o=c(s);function s(){var e;return t(this,s),e=o.call(this),s.constructor_.apply(u(e),arguments),e}return n(s,[{key:"computeEnvelopeInternal",value:function(){if(this.isEmpty())return new z;var t=new z;return t.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),t}},{key:"getCoordinates",value:function(){return this.isEmpty()?[]:[this.getCoordinate()]}},{key:"copyInternal",value:function(){return new s(this._coordinates.copy(),this._factory)}},{key:"equalsExact",value:function(){if(2===arguments.length&&"number"==typeof arguments[1]&&arguments[0]instanceof V){var t=arguments[0],e=arguments[1];return!!this.isEquivalentClass(t)&&(!(!this.isEmpty()||!t.isEmpty())||this.isEmpty()===t.isEmpty()&&this.equal(t.getCoordinate(),this.getCoordinate(),e))}return h(i(s.prototype),"equalsExact",this).apply(this,arguments)}},{key:"normalize",value:function(){}},{key:"getCoordinate",value:function(){return 0!==this._coordinates.size()?this._coordinates.getCoordinate(0):null}},{key:"getBoundaryDimension",value:function(){return St.FALSE}},{key:"reverseInternal",value:function(){return this.getFactory().createPoint(this._coordinates.copy())}},{key:"getTypeCode",value:function(){return V.TYPECODE_POINT}},{key:"getDimension",value:function(){return 0}},{key:"getNumPoints",value:function(){return this.isEmpty()?0:1}},{key:"getX",value:function(){if(null===this.getCoordinate())throw new IllegalStateException("getX called on empty Point");return this.getCoordinate().x}},{key:"compareToSameClass",value:function(){if(1===arguments.length){var t=arguments[0];return this.getCoordinate().compareTo(t.getCoordinate())}if(2===arguments.length){var e=arguments[0];return arguments[1].compare(this._coordinates,e._coordinates)}}},{key:"apply",value:function(){if(nt(arguments[0],At)){var t=arguments[0];if(this.isEmpty())return null;t.filter(this.getCoordinate())}else if(nt(arguments[0],Mt)){var e=arguments[0];if(this.isEmpty())return null;e.filter(this._coordinates,0),e.isGeometryChanged()&&this.geometryChanged()}else(nt(arguments[0],Et)||nt(arguments[0],b))&&arguments[0].filter(this)}},{key:"getBoundary",value:function(){return this.getFactory().createGeometryCollection()}},{key:"getGeometryType",value:function(){return V.TYPENAME_POINT}},{key:"getCoordinateSequence",value:function(){return this._coordinates}},{key:"getY",value:function(){if(null===this.getCoordinate())throw new IllegalStateException("getY called on empty Point");return this.getCoordinate().y}},{key:"isEmpty",value:function(){return 0===this._coordinates.size()}},{key:"init",value:function(t){null===t&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),D.isTrue(t.size()<=1),this._coordinates=t}},{key:"isSimple",value:function(){return!0}},{key:"interfaces_",get:function(){return[Tt]}}],[{key:"constructor_",value:function(){this._coordinates=null;var t=arguments[0],e=arguments[1];V.constructor_.call(this,e),this.init(t)}}]),s}(V),It=function(){function e(){t(this,e)}return n(e,null,[{key:"ofRing",value:function(){if(arguments[0]instanceof Array){var t=arguments[0];return Math.abs(e.ofRingSigned(t))}if(nt(arguments[0],lt)){var n=arguments[0];return Math.abs(e.ofRingSigned(n))}}},{key:"ofRingSigned",value:function(){if(arguments[0]instanceof Array){var t=arguments[0];if(t.length<3)return 0;for(var e=0,n=t[0].x,r=1;r<t.length-1;r++){var i=t[r].x-n,o=t[r+1].y;e+=i*(t[r-1].y-o)}return e/2}if(nt(arguments[0],lt)){var s=arguments[0],a=s.size();if(a<3)return 0;var l=new G,u=new G,c=new G;s.getCoordinate(0,u),s.getCoordinate(1,c);var h=u.x;c.x-=h;for(var d=0,f=1;f<a-1;f++)l.y=u.y,u.x=c.x,u.y=c.y,s.getCoordinate(f+1,c),c.x-=h,d+=u.x*(l.y-c.y);return d/2}}}]),e}(),Rt=function(){function e(){t(this,e)}return n(e,null,[{key:"sort",value:function(){var t=arguments,e=arguments[0];if(1===arguments.length)e.sort((function(t,e){return t.compareTo(e)}));else if(2===arguments.length)e.sort((function(e,n){return t[1].compare(e,n)}));else if(3===arguments.length){var n=e.slice(arguments[1],arguments[2]);n.sort();var r=e.slice(0,arguments[1]).concat(n,e.slice(arguments[2],e.length));e.splice(0,e.length);var i,o=g(r);try{for(o.s();!(i=o.n()).done;){var s=i.value;e.push(s)}}catch(t){o.e(t)}finally{o.f()}}else if(4===arguments.length){var a=e.slice(arguments[1],arguments[2]);a.sort((function(e,n){return t[3].compare(e,n)}));var l=e.slice(0,arguments[1]).concat(a,e.slice(arguments[2],e.length));e.splice(0,e.length);var u,c=g(l);try{for(c.s();!(u=c.n()).done;){var h=u.value;e.push(h)}}catch(t){c.e(t)}finally{c.f()}}}},{key:"asList",value:function(t){var e,n=new ft,r=g(t);try{for(r.s();!(e=r.n()).done;){var i=e.value;n.add(i)}}catch(t){r.e(t)}finally{r.f()}return n}},{key:"copyOf",value:function(t,e){return t.slice(0,e)}}]),e}(),Bt=function e(){t(this,e)},Lt=function(e){r(s,e);var o=c(s);function s(){var e;return t(this,s),e=o.call(this),s.constructor_.apply(u(e),arguments),e}return n(s,[{key:"computeEnvelopeInternal",value:function(){return this._shell.getEnvelopeInternal()}},{key:"getCoordinates",value:function(){if(this.isEmpty())return[];for(var t=new Array(this.getNumPoints()).fill(null),e=-1,n=this._shell.getCoordinates(),r=0;r<n.length;r++)t[++e]=n[r];for(var i=0;i<this._holes.length;i++)for(var o=this._holes[i].getCoordinates(),s=0;s<o.length;s++)t[++e]=o[s];return t}},{key:"getArea",value:function(){var t=0;t+=It.ofRing(this._shell.getCoordinateSequence());for(var e=0;e<this._holes.length;e++)t-=It.ofRing(this._holes[e].getCoordinateSequence());return t}},{key:"copyInternal",value:function(){for(var t=this._shell.copy(),e=new Array(this._holes.length).fill(null),n=0;n<this._holes.length;n++)e[n]=this._holes[n].copy();return new s(t,e,this._factory)}},{key:"isRectangle",value:function(){if(0!==this.getNumInteriorRing())return!1;if(null===this._shell)return!1;if(5!==this._shell.getNumPoints())return!1;for(var t=this._shell.getCoordinateSequence(),e=this.getEnvelopeInternal(),n=0;n<5;n++){var r=t.getX(n);if(r!==e.getMinX()&&r!==e.getMaxX())return!1;var i=t.getY(n);if(i!==e.getMinY()&&i!==e.getMaxY())return!1}for(var o=t.getX(0),s=t.getY(0),a=1;a<=4;a++){var l=t.getX(a),u=t.getY(a);if(l!==o==(u!==s))return!1;o=l,s=u}return!0}},{key:"equalsExact",value:function(){if(2===arguments.length&&"number"==typeof arguments[1]&&arguments[0]instanceof V){var t=arguments[0],e=arguments[1];if(!this.isEquivalentClass(t))return!1;var n=t,r=this._shell,o=n._shell;if(!r.equalsExact(o,e))return!1;if(this._holes.length!==n._holes.length)return!1;for(var a=0;a<this._holes.length;a++)if(!this._holes[a].equalsExact(n._holes[a],e))return!1;return!0}return h(i(s.prototype),"equalsExact",this).apply(this,arguments)}},{key:"normalize",value:function(){if(0===arguments.length){this._shell=this.normalized(this._shell,!0);for(var t=0;t<this._holes.length;t++)this._holes[t]=this.normalized(this._holes[t],!1);Rt.sort(this._holes)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(e.isEmpty())return null;var r=e.getCoordinateSequence(),i=Ct.minCoordinateIndex(r,0,r.size()-2);Ct.scroll(r,i,!0),ut.isCCW(r)===n&&Ct.reverse(r)}}},{key:"getCoordinate",value:function(){return this._shell.getCoordinate()}},{key:"getNumInteriorRing",value:function(){return this._holes.length}},{key:"getBoundaryDimension",value:function(){return 1}},{key:"reverseInternal",value:function(){for(var t=this.getExteriorRing().reverse(),e=new Array(this.getNumInteriorRing()).fill(null),n=0;n<e.length;n++)e[n]=this.getInteriorRingN(n).reverse();return this.getFactory().createPolygon(t,e)}},{key:"getTypeCode",value:function(){return V.TYPECODE_POLYGON}},{key:"getDimension",value:function(){return 2}},{key:"getLength",value:function(){var t=0;t+=this._shell.getLength();for(var e=0;e<this._holes.length;e++)t+=this._holes[e].getLength();return t}},{key:"getNumPoints",value:function(){for(var t=this._shell.getNumPoints(),e=0;e<this._holes.length;e++)t+=this._holes[e].getNumPoints();return t}},{key:"convexHull",value:function(){return this.getExteriorRing().convexHull()}},{key:"normalized",value:function(t,e){var n=t.copy();return this.normalize(n,e),n}},{key:"compareToSameClass",value:function(){if(1===arguments.length){var t=arguments[0],e=this._shell,n=t._shell;return e.compareToSameClass(n)}if(2===arguments.length){var r=arguments[1],i=arguments[0],o=this._shell,s=i._shell,a=o.compareToSameClass(s,r);if(0!==a)return a;for(var l=this.getNumInteriorRing(),u=i.getNumInteriorRing(),c=0;c<l&&c<u;){var h=this.getInteriorRingN(c),d=i.getInteriorRingN(c),f=h.compareToSameClass(d,r);if(0!==f)return f;c++}return c<l?1:c<u?-1:0}}},{key:"apply",value:function(){if(nt(arguments[0],At)){var t=arguments[0];this._shell.apply(t);for(var e=0;e<this._holes.length;e++)this._holes[e].apply(t)}else if(nt(arguments[0],Mt)){var n=arguments[0];if(this._shell.apply(n),!n.isDone())for(var r=0;r<this._holes.length&&(this._holes[r].apply(n),!n.isDone());r++);n.isGeometryChanged()&&this.geometryChanged()}else if(nt(arguments[0],Et))arguments[0].filter(this);else if(nt(arguments[0],b)){var i=arguments[0];i.filter(this),this._shell.apply(i);for(var o=0;o<this._holes.length;o++)this._holes[o].apply(i)}}},{key:"getBoundary",value:function(){if(this.isEmpty())return this.getFactory().createMultiLineString();var t=new Array(this._holes.length+1).fill(null);t[0]=this._shell;for(var e=0;e<this._holes.length;e++)t[e+1]=this._holes[e];return t.length<=1?this.getFactory().createLinearRing(t[0].getCoordinateSequence()):this.getFactory().createMultiLineString(t)}},{key:"getGeometryType",value:function(){return V.TYPENAME_POLYGON}},{key:"getExteriorRing",value:function(){return this._shell}},{key:"isEmpty",value:function(){return this._shell.isEmpty()}},{key:"getInteriorRingN",value:function(t){return this._holes[t]}},{key:"interfaces_",get:function(){return[Bt]}}],[{key:"constructor_",value:function(){this._shell=null,this._holes=null;var t=arguments[0],e=arguments[1],n=arguments[2];if(V.constructor_.call(this,n),null===t&&(t=this.getFactory().createLinearRing()),null===e&&(e=[]),V.hasNullElements(e))throw new v("holes must not contain null elements");if(t.isEmpty()&&V.hasNonEmptyElements(e))throw new v("shell is empty but holes are not");this._shell=t,this._holes=e}}]),s}(V),kt=function(e){r(i,e);var n=c(i);function i(){return t(this,i),n.apply(this,arguments)}return i}(Y),Dt=function(e){r(o,e);var i=c(o);function o(e){var n;return t(this,o),(n=i.call(this)).array=[],e instanceof q&&n.addAll(e),n}return n(o,[{key:"contains",value:function(t){var e,n=g(this.array);try{for(n.s();!(e=n.n()).done;)if(0===e.value.compareTo(t))return!0}catch(t){n.e(t)}finally{n.f()}return!1}},{key:"add",value:function(t){if(this.contains(t))return!1;for(var e=0,n=this.array.length;e<n;e++)if(1===this.array[e].compareTo(t))return!!this.array.splice(e,0,t);return this.array.push(t),!0}},{key:"addAll",value:function(t){var e,n=g(t);try{for(n.s();!(e=n.n()).done;){var r=e.value;this.add(r)}}catch(t){n.e(t)}finally{n.f()}return!0}},{key:"remove",value:function(){throw new J}},{key:"size",value:function(){return this.array.length}},{key:"isEmpty",value:function(){return 0===this.array.length}},{key:"toArray",value:function(){return this.array.slice()}},{key:"iterator",value:function(){return new Ft(this.array)}}]),o}(kt),Ft=function(){function e(n){t(this,e),this.array=n,this.position=0}return n(e,[{key:"next",value:function(){if(this.position===this.array.length)throw new W;return this.array[this.position++]}},{key:"hasNext",value:function(){return this.position<this.array.length}},{key:"remove",value:function(){throw new J}}]),e}(),Nt=function(e){r(s,e);var o=c(s);function s(){var e;return t(this,s),e=o.call(this),s.constructor_.apply(u(e),arguments),e}return n(s,[{key:"computeEnvelopeInternal",value:function(){for(var t=new z,e=0;e<this._geometries.length;e++)t.expandToInclude(this._geometries[e].getEnvelopeInternal());return t}},{key:"getGeometryN",value:function(t){return this._geometries[t]}},{key:"getCoordinates",value:function(){for(var t=new Array(this.getNumPoints()).fill(null),e=-1,n=0;n<this._geometries.length;n++)for(var r=this._geometries[n].getCoordinates(),i=0;i<r.length;i++)t[++e]=r[i];return t}},{key:"getArea",value:function(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getArea();return t}},{key:"copyInternal",value:function(){for(var t=new Array(this._geometries.length).fill(null),e=0;e<t.length;e++)t[e]=this._geometries[e].copy();return new s(t,this._factory)}},{key:"equalsExact",value:function(){if(2===arguments.length&&"number"==typeof arguments[1]&&arguments[0]instanceof V){var t=arguments[0],e=arguments[1];if(!this.isEquivalentClass(t))return!1;var n=t;if(this._geometries.length!==n._geometries.length)return!1;for(var r=0;r<this._geometries.length;r++)if(!this._geometries[r].equalsExact(n._geometries[r],e))return!1;return!0}return h(i(s.prototype),"equalsExact",this).apply(this,arguments)}},{key:"normalize",value:function(){for(var t=0;t<this._geometries.length;t++)this._geometries[t].normalize();Rt.sort(this._geometries)}},{key:"getCoordinate",value:function(){return this.isEmpty()?null:this._geometries[0].getCoordinate()}},{key:"getBoundaryDimension",value:function(){for(var t=St.FALSE,e=0;e<this._geometries.length;e++)t=Math.max(t,this._geometries[e].getBoundaryDimension());return t}},{key:"reverseInternal",value:function(){for(var t=this._geometries.length,e=new ft(t),n=0;n<t;n++)e.add(this._geometries[n].reverse());return this.getFactory().buildGeometry(e)}},{key:"getTypeCode",value:function(){return V.TYPECODE_GEOMETRYCOLLECTION}},{key:"getDimension",value:function(){for(var t=St.FALSE,e=0;e<this._geometries.length;e++)t=Math.max(t,this._geometries[e].getDimension());return t}},{key:"getLength",value:function(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getLength();return t}},{key:"getNumPoints",value:function(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getNumPoints();return t}},{key:"getNumGeometries",value:function(){return this._geometries.length}},{key:"compareToSameClass",value:function(){if(1===arguments.length){var t=arguments[0],e=new Dt(Rt.asList(this._geometries)),n=new Dt(Rt.asList(t._geometries));return this.compare(e,n)}if(2===arguments.length){for(var r=arguments[1],i=arguments[0],o=this.getNumGeometries(),s=i.getNumGeometries(),a=0;a<o&&a<s;){var l=this.getGeometryN(a),u=i.getGeometryN(a),c=l.compareToSameClass(u,r);if(0!==c)return c;a++}return a<o?1:a<s?-1:0}}},{key:"apply",value:function(){if(nt(arguments[0],At))for(var t=arguments[0],e=0;e<this._geometries.length;e++)this._geometries[e].apply(t);else if(nt(arguments[0],Mt)){var n=arguments[0];if(0===this._geometries.length)return null;for(var r=0;r<this._geometries.length&&(this._geometries[r].apply(n),!n.isDone());r++);n.isGeometryChanged()&&this.geometryChanged()}else if(nt(arguments[0],Et)){var i=arguments[0];i.filter(this);for(var o=0;o<this._geometries.length;o++)this._geometries[o].apply(i)}else if(nt(arguments[0],b)){var s=arguments[0];s.filter(this);for(var a=0;a<this._geometries.length;a++)this._geometries[a].apply(s)}}},{key:"getBoundary",value:function(){return V.checkNotGeometryCollection(this),D.shouldNeverReachHere(),null}},{key:"getGeometryType",value:function(){return V.TYPENAME_GEOMETRYCOLLECTION}},{key:"isEmpty",value:function(){for(var t=0;t<this._geometries.length;t++)if(!this._geometries[t].isEmpty())return!1;return!0}}],[{key:"constructor_",value:function(){if(this._geometries=null,0===arguments.length);else if(2===arguments.length){var t=arguments[0],e=arguments[1];if(V.constructor_.call(this,e),null===t&&(t=[]),V.hasNullElements(t))throw new v("geometries must not contain null elements");this._geometries=t}}}]),s}(V),jt=function(e){r(s,e);var o=c(s);function s(){var e;return t(this,s),e=o.call(this),s.constructor_.apply(u(e),arguments),e}return n(s,[{key:"copyInternal",value:function(){for(var t=new Array(this._geometries.length).fill(null),e=0;e<t.length;e++)t[e]=this._geometries[e].copy();return new s(t,this._factory)}},{key:"isValid",value:function(){return!0}},{key:"equalsExact",value:function(){if(2===arguments.length&&"number"==typeof arguments[1]&&arguments[0]instanceof V){var t=arguments[0],e=arguments[1];return!!this.isEquivalentClass(t)&&h(i(s.prototype),"equalsExact",this).call(this,t,e)}return h(i(s.prototype),"equalsExact",this).apply(this,arguments)}},{key:"getCoordinate",value:function(){if(1===arguments.length&&Number.isInteger(arguments[0])){var t=arguments[0];return this._geometries[t].getCoordinate()}return h(i(s.prototype),"getCoordinate",this).apply(this,arguments)}},{key:"getBoundaryDimension",value:function(){return St.FALSE}},{key:"getTypeCode",value:function(){return V.TYPECODE_MULTIPOINT}},{key:"getDimension",value:function(){return 0}},{key:"getBoundary",value:function(){return this.getFactory().createGeometryCollection()}},{key:"getGeometryType",value:function(){return V.TYPENAME_MULTIPOINT}},{key:"interfaces_",get:function(){return[Tt]}}],[{key:"constructor_",value:function(){var t=arguments[0],e=arguments[1];Nt.constructor_.call(this,t,e)}}]),s}(Nt),Gt=function(e){r(s,e);var o=c(s);function s(){var e;return t(this,s),e=o.call(this),s.constructor_.apply(u(e),arguments),e}return n(s,[{key:"copyInternal",value:function(){return new s(this._points.copy(),this._factory)}},{key:"getBoundaryDimension",value:function(){return St.FALSE}},{key:"isClosed",value:function(){return!!this.isEmpty()||h(i(s.prototype),"isClosed",this).call(this)}},{key:"reverseInternal",value:function(){var t=this._points.copy();return Ct.reverse(t),this.getFactory().createLinearRing(t)}},{key:"getTypeCode",value:function(){return V.TYPECODE_LINEARRING}},{key:"validateConstruction",value:function(){if(!this.isEmpty()&&!h(i(s.prototype),"isClosed",this).call(this))throw new v("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<s.MINIMUM_VALID_SIZE)throw new v("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")}},{key:"getGeometryType",value:function(){return V.TYPENAME_LINEARRING}}],[{key:"constructor_",value:function(){var t=arguments[0],e=arguments[1];Pt.constructor_.call(this,t,e),this.validateConstruction()}}]),s}(Pt);Gt.MINIMUM_VALID_SIZE=4;var Ut=function(e){r(o,e);var i=c(o);function o(){var e;return t(this,o),e=i.call(this),o.constructor_.apply(u(e),arguments),e}return n(o,[{key:"setOrdinate",value:function(t,e){switch(t){case o.X:this.x=e;break;case o.Y:this.y=e;break;default:throw new v("Invalid ordinate index: "+t)}}},{key:"getZ",value:function(){return G.NULL_ORDINATE}},{key:"getOrdinate",value:function(t){switch(t){case o.X:return this.x;case o.Y:return this.y}throw new v("Invalid ordinate index: "+t)}},{key:"setZ",value:function(t){throw new v("CoordinateXY dimension 2 does not support z-ordinate")}},{key:"copy",value:function(){return new o(this)}},{key:"toString",value:function(){return"("+this.x+", "+this.y+")"}},{key:"setCoordinate",value:function(t){this.x=t.x,this.y=t.y,this.z=t.getZ()}}],[{key:"constructor_",value:function(){if(0===arguments.length)G.constructor_.call(this);else if(1===arguments.length){if(arguments[0]instanceof o){var t=arguments[0];G.constructor_.call(this,t.x,t.y)}else if(arguments[0]instanceof G){var e=arguments[0];G.constructor_.call(this,e.x,e.y)}}else if(2===arguments.length){var n=arguments[0],r=arguments[1];G.constructor_.call(this,n,r,G.NULL_ORDINATE)}}}]),o}(G);Ut.X=0,Ut.Y=1,Ut.Z=-1,Ut.M=-1;var zt=function(e){r(o,e);var i=c(o);function o(){var e;return t(this,o),e=i.call(this),o.constructor_.apply(u(e),arguments),e}return n(o,[{key:"getM",value:function(){return this._m}},{key:"setOrdinate",value:function(t,e){switch(t){case o.X:this.x=e;break;case o.Y:this.y=e;break;case o.M:this._m=e;break;default:throw new v("Invalid ordinate index: "+t)}}},{key:"setM",value:function(t){this._m=t}},{key:"getZ",value:function(){return G.NULL_ORDINATE}},{key:"getOrdinate",value:function(t){switch(t){case o.X:return this.x;case o.Y:return this.y;case o.M:return this._m}throw new v("Invalid ordinate index: "+t)}},{key:"setZ",value:function(t){throw new v("CoordinateXY dimension 2 does not support z-ordinate")}},{key:"copy",value:function(){return new o(this)}},{key:"toString",value:function(){return"("+this.x+", "+this.y+" m="+this.getM()+")"}},{key:"setCoordinate",value:function(t){this.x=t.x,this.y=t.y,this.z=t.getZ(),this._m=t.getM()}}],[{key:"constructor_",value:function(){if(this._m=null,0===arguments.length)G.constructor_.call(this),this._m=0;else if(1===arguments.length){if(arguments[0]instanceof o){var t=arguments[0];G.constructor_.call(this,t.x,t.y),this._m=t._m}else if(arguments[0]instanceof G){var e=arguments[0];G.constructor_.call(this,e.x,e.y),this._m=this.getM()}}else if(3===arguments.length){var n=arguments[0],r=arguments[1],i=arguments[2];G.constructor_.call(this,n,r,G.NULL_ORDINATE),this._m=i}}}]),o}(G);zt.X=0,zt.Y=1,zt.Z=-1,zt.M=2;var Vt=function(e){r(o,e);var i=c(o);function o(){var e;return t(this,o),e=i.call(this),o.constructor_.apply(u(e),arguments),e}return n(o,[{key:"getM",value:function(){return this._m}},{key:"setOrdinate",value:function(t,e){switch(t){case G.X:this.x=e;break;case G.Y:this.y=e;break;case G.Z:this.z=e;break;case G.M:this._m=e;break;default:throw new v("Invalid ordinate index: "+t)}}},{key:"setM",value:function(t){this._m=t}},{key:"getOrdinate",value:function(t){switch(t){case G.X:return this.x;case G.Y:return this.y;case G.Z:return this.getZ();case G.M:return this.getM()}throw new v("Invalid ordinate index: "+t)}},{key:"copy",value:function(){return new o(this)}},{key:"toString",value:function(){return"("+this.x+", "+this.y+", "+this.getZ()+" m="+this.getM()+")"}},{key:"setCoordinate",value:function(t){this.x=t.x,this.y=t.y,this.z=t.getZ(),this._m=t.getM()}}],[{key:"constructor_",value:function(){if(this._m=null,0===arguments.length)G.constructor_.call(this),this._m=0;else if(1===arguments.length){if(arguments[0]instanceof o){var t=arguments[0];G.constructor_.call(this,t),this._m=t._m}else if(arguments[0]instanceof G){var e=arguments[0];G.constructor_.call(this,e),this._m=this.getM()}}else if(4===arguments.length){var n=arguments[0],r=arguments[1],i=arguments[2],s=arguments[3];G.constructor_.call(this,n,r,i),this._m=s}}}]),o}(G),Ht=function(){function e(){t(this,e)}return n(e,null,[{key:"measures",value:function(t){return t instanceof Ut?0:t instanceof zt||t instanceof Vt?1:0}},{key:"dimension",value:function(t){return t instanceof Ut?2:t instanceof zt?3:t instanceof Vt?4:3}},{key:"create",value:function(){if(1===arguments.length){var t=arguments[0];return e.create(t,0)}if(2===arguments.length){var n=arguments[0],r=arguments[1];return 2===n?new Ut:3===n&&0===r?new G:3===n&&1===r?new zt:4===n&&1===r?new Vt:new G}}}]),e}(),qt=function(e){r(s,e);var o=c(s);function s(){var e;return t(this,s),e=o.call(this),s.constructor_.apply(u(e),arguments),e}return n(s,[{key:"getCoordinate",value:function(t){return this.get(t)}},{key:"addAll",value:function(){if(2===arguments.length&&"boolean"==typeof arguments[1]&&nt(arguments[0],q)){for(var t=arguments[1],e=!1,n=arguments[0].iterator();n.hasNext();)this.add(n.next(),t),e=!0;return e}return h(i(s.prototype),"addAll",this).apply(this,arguments)}},{key:"clone",value:function(){for(var t=h(i(s.prototype),"clone",this).call(this),e=0;e<this.size();e++)t.add(e,this.get(e).clone());return t}},{key:"toCoordinateArray",value:function(){if(0===arguments.length)return this.toArray(s.coordArrayType);if(1===arguments.length){if(arguments[0])return this.toArray(s.coordArrayType);for(var t=this.size(),e=new Array(t).fill(null),n=0;n<t;n++)e[n]=this.get(t-n-1);return e}}},{key:"add",value:function(){if(1===arguments.length){var t=arguments[0];return h(i(s.prototype),"add",this).call(this,t)}if(2===arguments.length){if(arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){var e=arguments[0],n=arguments[1];return this.add(e,n,!0),!0}if(arguments[0]instanceof G&&"boolean"==typeof arguments[1]){var r=arguments[0];if(!arguments[1]&&this.size()>=1&&this.get(this.size()-1).equals2D(r))return null;h(i(s.prototype),"add",this).call(this,r)}else if(arguments[0]instanceof Object&&"boolean"==typeof arguments[1]){var o=arguments[0],a=arguments[1];return this.add(o,a),!0}}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){var l=arguments[0],u=arguments[1];if(arguments[2])for(var c=0;c<l.length;c++)this.add(l[c],u);else for(var d=l.length-1;d>=0;d--)this.add(l[d],u);return!0}if("boolean"==typeof arguments[2]&&Number.isInteger(arguments[0])&&arguments[1]instanceof G){var f=arguments[0],p=arguments[1];if(!arguments[2]){var g=this.size();if(g>0){if(f>0&&this.get(f-1).equals2D(p))return null;if(f<g&&this.get(f).equals2D(p))return null}}h(i(s.prototype),"add",this).call(this,f,p)}}else if(4===arguments.length){var y=arguments[0],m=arguments[1],v=arguments[2],b=arguments[3],_=1;v>b&&(_=-1);for(var A=v;A!==b;A+=_)this.add(y[A],m);return!0}}},{key:"closeRing",value:function(){if(this.size()>0){var t=this.get(0).copy();this.add(t,!1)}}}],[{key:"constructor_",value:function(){if(0===arguments.length);else if(1===arguments.length){var t=arguments[0];this.ensureCapacity(t.length),this.add(t,!0)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.ensureCapacity(e.length),this.add(e,n)}}}]),s}(ft);qt.coordArrayType=new Array(0).fill(null);var Wt=function(){function e(){t(this,e)}return n(e,null,[{key:"isRing",value:function(t){return!(t.length<4||!t[0].equals2D(t[t.length-1]))}},{key:"ptNotInList",value:function(t,n){for(var r=0;r<t.length;r++){var i=t[r];if(e.indexOf(i,n)<0)return i}return null}},{key:"scroll",value:function(t,n){var r=e.indexOf(n,t);if(r<0)return null;var i=new Array(t.length).fill(null);mt.arraycopy(t,r,i,0,t.length-r),mt.arraycopy(t,0,i,t.length-r,r),mt.arraycopy(i,0,t,0,t.length)}},{key:"equals",value:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];if(t===e)return!0;if(null===t||null===e)return!1;if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].equals(e[n]))return!1;return!0}if(3===arguments.length){var r=arguments[0],i=arguments[1],o=arguments[2];if(r===i)return!0;if(null===r||null===i)return!1;if(r.length!==i.length)return!1;for(var s=0;s<r.length;s++)if(0!==o.compare(r[s],i[s]))return!1;return!0}}},{key:"intersection",value:function(t,e){for(var n=new qt,r=0;r<t.length;r++)e.intersects(t[r])&&n.add(t[r],!0);return n.toCoordinateArray()}},{key:"measures",value:function(t){if(null===t||0===t.length)return 0;var e,n=0,r=g(t);try{for(r.s();!(e=r.n()).done;){var i=e.value;n=Math.max(n,Ht.measures(i))}}catch(t){r.e(t)}finally{r.f()}return n}},{key:"hasRepeatedPoints",value:function(t){for(var e=1;e<t.length;e++)if(t[e-1].equals(t[e]))return!0;return!1}},{key:"removeRepeatedPoints",value:function(t){return e.hasRepeatedPoints(t)?new qt(t,!1).toCoordinateArray():t}},{key:"reverse",value:function(t){for(var e=t.length-1,n=Math.trunc(e/2),r=0;r<=n;r++){var i=t[r];t[r]=t[e-r],t[e-r]=i}}},{key:"removeNull",value:function(t){for(var e=0,n=0;n<t.length;n++)null!==t[n]&&e++;var r=new Array(e).fill(null);if(0===e)return r;for(var i=0,o=0;o<t.length;o++)null!==t[o]&&(r[i++]=t[o]);return r}},{key:"copyDeep",value:function(){if(1===arguments.length){for(var t=arguments[0],e=new Array(t.length).fill(null),n=0;n<t.length;n++)e[n]=t[n].copy();return e}if(5===arguments.length)for(var r=arguments[0],i=arguments[1],o=arguments[2],s=arguments[3],a=arguments[4],l=0;l<a;l++)o[s+l]=r[i+l].copy()}},{key:"isEqualReversed",value:function(t,e){for(var n=0;n<t.length;n++){var r=t[n],i=e[t.length-n-1];if(0!==r.compareTo(i))return!1}return!0}},{key:"envelope",value:function(t){for(var e=new z,n=0;n<t.length;n++)e.expandToInclude(t[n]);return e}},{key:"toCoordinateArray",value:function(t){return t.toArray(e.coordArrayType)}},{key:"dimension",value:function(t){if(null===t||0===t.length)return 3;var e,n=0,r=g(t);try{for(r.s();!(e=r.n()).done;){var i=e.value;n=Math.max(n,Ht.dimension(i))}}catch(t){r.e(t)}finally{r.f()}return n}},{key:"atLeastNCoordinatesOrNothing",value:function(t,e){return e.length>=t?e:[]}},{key:"indexOf",value:function(t,e){for(var n=0;n<e.length;n++)if(t.equals(e[n]))return n;return-1}},{key:"increasingDirection",value:function(t){for(var e=0;e<Math.trunc(t.length/2);e++){var n=t.length-1-e,r=t[e].compareTo(t[n]);if(0!==r)return r}return 1}},{key:"compare",value:function(t,e){for(var n=0;n<t.length&&n<e.length;){var r=t[n].compareTo(e[n]);if(0!==r)return r;n++}return n<e.length?-1:n<t.length?1:0}},{key:"minCoordinate",value:function(t){for(var e=null,n=0;n<t.length;n++)(null===e||e.compareTo(t[n])>0)&&(e=t[n]);return e}},{key:"extract",value:function(t,e,n){e=vt.clamp(e,0,t.length);var r=(n=vt.clamp(n,-1,t.length))-e+1;n<0&&(r=0),e>=t.length&&(r=0),n<e&&(r=0);var i=new Array(r).fill(null);if(0===r)return i;for(var o=0,s=e;s<=n;s++)i[o++]=t[s];return i}}]),e}(),Jt=function(){function e(){t(this,e)}return n(e,[{key:"compare",value:function(t,e){var n=t,r=e;return Wt.compare(n,r)}},{key:"interfaces_",get:function(){return[B]}}]),e}(),Yt=function(){function e(){t(this,e)}return n(e,[{key:"compare",value:function(t,e){var n=t,r=e;if(n.length<r.length)return-1;if(n.length>r.length)return 1;if(0===n.length)return 0;var i=Wt.compare(n,r);return Wt.isEqualReversed(n,r)?0:i}},{key:"OLDcompare",value:function(t,e){var n=t,r=e;if(n.length<r.length)return-1;if(n.length>r.length)return 1;if(0===n.length)return 0;for(var i=Wt.increasingDirection(n),o=Wt.increasingDirection(r),s=i>0?0:n.length-1,a=o>0?0:n.length-1,l=0;l<n.length;l++){var u=n[s].compareTo(r[a]);if(0!==u)return u;s+=i,a+=o}return 0}},{key:"interfaces_",get:function(){return[B]}}]),e}();Wt.ForwardComparator=Jt,Wt.BidirectionalComparator=Yt,Wt.coordArrayType=new Array(0).fill(null);var Xt=function(){function e(n){t(this,e),this.str=n}return n(e,[{key:"append",value:function(t){this.str+=t}},{key:"setCharAt",value:function(t,e){this.str=this.str.substr(0,t)+e+this.str.substr(t+1)}},{key:"toString",value:function(){return this.str}}]),e}(),Kt=function(){function e(){t(this,e),e.constructor_.apply(this,arguments)}return n(e,[{key:"getM",value:function(t){return this.hasM()?this._coordinates[t].getM():R.NaN}},{key:"setOrdinate",value:function(t,e,n){switch(e){case lt.X:this._coordinates[t].x=n;break;case lt.Y:this._coordinates[t].y=n;break;default:this._coordinates[t].setOrdinate(e,n)}}},{key:"getZ",value:function(t){return this.hasZ()?this._coordinates[t].getZ():R.NaN}},{key:"size",value:function(){return this._coordinates.length}},{key:"getOrdinate",value:function(t,e){switch(e){case lt.X:return this._coordinates[t].x;case lt.Y:return this._coordinates[t].y;default:return this._coordinates[t].getOrdinate(e)}}},{key:"getCoordinate",value:function(){if(1===arguments.length){var t=arguments[0];return this._coordinates[t]}if(2===arguments.length){var e=arguments[0];arguments[1].setCoordinate(this._coordinates[e])}}},{key:"getCoordinateCopy",value:function(t){var e=this.createCoordinate();return e.setCoordinate(this._coordinates[t]),e}},{key:"createCoordinate",value:function(){return Ht.create(this.getDimension(),this.getMeasures())}},{key:"getDimension",value:function(){return this._dimension}},{key:"getX",value:function(t){return this._coordinates[t].x}},{key:"getMeasures",value:function(){return this._measures}},{key:"expandEnvelope",value:function(t){for(var e=0;e<this._coordinates.length;e++)t.expandToInclude(this._coordinates[e]);return t}},{key:"copy",value:function(){for(var t=new Array(this.size()).fill(null),n=0;n<this._coordinates.length;n++){var r=this.createCoordinate();r.setCoordinate(this._coordinates[n]),t[n]=r}return new e(t,this._dimension,this._measures)}},{key:"toString",value:function(){if(this._coordinates.length>0){var t=new Xt(17*this._coordinates.length);t.append("("),t.append(this._coordinates[0]);for(var e=1;e<this._coordinates.length;e++)t.append(", "),t.append(this._coordinates[e]);return t.append(")"),t.toString()}return"()"}},{key:"getY",value:function(t){return this._coordinates[t].y}},{key:"toCoordinateArray",value:function(){return this._coordinates}},{key:"interfaces_",get:function(){return[lt,x]}}],[{key:"constructor_",value:function(){if(this._dimension=3,this._measures=0,this._coordinates=null,1===arguments.length){if(arguments[0]instanceof Array){var t=arguments[0];e.constructor_.call(this,t,Wt.dimension(t),Wt.measures(t))}else if(Number.isInteger(arguments[0])){var n=arguments[0];this._coordinates=new Array(n).fill(null);for(var r=0;r<n;r++)this._coordinates[r]=new G}else if(nt(arguments[0],lt)){var i=arguments[0];if(null===i)return this._coordinates=new Array(0).fill(null),null;this._dimension=i.getDimension(),this._measures=i.getMeasures(),this._coordinates=new Array(i.size()).fill(null);for(var o=0;o<this._coordinates.length;o++)this._coordinates[o]=i.getCoordinateCopy(o)}}else if(2===arguments.length){if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var s=arguments[0],a=arguments[1];e.constructor_.call(this,s,a,Wt.measures(s))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var l=arguments[0],u=arguments[1];this._coordinates=new Array(l).fill(null),this._dimension=u;for(var c=0;c<l;c++)this._coordinates[c]=Ht.create(u)}}else if(3===arguments.length)if(Number.isInteger(arguments[2])&&arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var h=arguments[0],d=arguments[1],f=arguments[2];this._dimension=d,this._measures=f,this._coordinates=null===h?new Array(0).fill(null):h}else if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var p=arguments[0],g=arguments[1],y=arguments[2];this._coordinates=new Array(p).fill(null),this._dimension=g,this._measures=y;for(var m=0;m<p;m++)this._coordinates[m]=this.createCoordinate()}}}]),e}(),Zt=function(){function e(){t(this,e)}return n(e,[{key:"readResolve",value:function(){return e.instance()}},{key:"create",value:function(){if(1===arguments.length){if(arguments[0]instanceof Array)return new Kt(arguments[0]);if(nt(arguments[0],lt))return new Kt(arguments[0])}else{if(2===arguments.length){var t=arguments[1];return t>3&&(t=3),t<2&&(t=2),new Kt(arguments[0],t)}if(3===arguments.length){var e=arguments[2],n=arguments[1]-e;return e>1&&(e=1),n>3&&(n=3),n<2&&(n=2),new Kt(arguments[0],n+e,e)}}}},{key:"interfaces_",get:function(){return[_t,x]}}],[{key:"instance",value:function(){return e.instanceObject}}]),e}();Zt.instanceObject=new Zt;var Qt=function(e){r(s,e);var o=c(s);function s(){var e;return t(this,s),e=o.call(this),s.constructor_.apply(u(e),arguments),e}return n(s,[{key:"copyInternal",value:function(){for(var t=new Array(this._geometries.length).fill(null),e=0;e<t.length;e++)t[e]=this._geometries[e].copy();return new s(t,this._factory)}},{key:"equalsExact",value:function(){if(2===arguments.length&&"number"==typeof arguments[1]&&arguments[0]instanceof V){var t=arguments[0],e=arguments[1];return!!this.isEquivalentClass(t)&&h(i(s.prototype),"equalsExact",this).call(this,t,e)}return h(i(s.prototype),"equalsExact",this).apply(this,arguments)}},{key:"getBoundaryDimension",value:function(){return 1}},{key:"getTypeCode",value:function(){return V.TYPECODE_MULTIPOLYGON}},{key:"getDimension",value:function(){return 2}},{key:"getBoundary",value:function(){if(this.isEmpty())return this.getFactory().createMultiLineString();for(var t=new ft,e=0;e<this._geometries.length;e++)for(var n=this._geometries[e].getBoundary(),r=0;r<n.getNumGeometries();r++)t.add(n.getGeometryN(r));var i=new Array(t.size()).fill(null);return this.getFactory().createMultiLineString(t.toArray(i))}},{key:"getGeometryType",value:function(){return V.TYPENAME_MULTIPOLYGON}},{key:"interfaces_",get:function(){return[Bt]}}],[{key:"constructor_",value:function(){var t=arguments[0],e=arguments[1];Nt.constructor_.call(this,t,e)}}]),s}(Nt),$t=function(){function e(){t(this,e)}return n(e,[{key:"get",value:function(){}},{key:"put",value:function(){}},{key:"size",value:function(){}},{key:"values",value:function(){}},{key:"entrySet",value:function(){}}]),e}(),te=function(e){r(o,e);var i=c(o);function o(){var e;return t(this,o),(e=i.call(this)).map=new Map,e}return n(o,[{key:"get",value:function(t){return this.map.get(t)||null}},{key:"put",value:function(t,e){return this.map.set(t,e),e}},{key:"values",value:function(){for(var t=new ft,e=this.map.values(),n=e.next();!n.done;)t.add(n.value),n=e.next();return t}},{key:"entrySet",value:function(){var t=new X;return this.map.entries().forEach((function(e){return t.add(e)})),t}},{key:"size",value:function(){return this.map.size()}}]),o}($t),ee=function(){function e(){t(this,e),e.constructor_.apply(this,arguments)}return n(e,[{key:"equals",value:function(t){if(!(t instanceof e))return!1;var n=t;return this._modelType===n._modelType&&this._scale===n._scale}},{key:"compareTo",value:function(t){var e=t,n=this.getMaximumSignificantDigits(),r=e.getMaximumSignificantDigits();return it.compare(n,r)}},{key:"getScale",value:function(){return this._scale}},{key:"isFloating",value:function(){return this._modelType===e.FLOATING||this._modelType===e.FLOATING_SINGLE}},{key:"getType",value:function(){return this._modelType}},{key:"toString",value:function(){var t="UNKNOWN";return this._modelType===e.FLOATING?t="Floating":this._modelType===e.FLOATING_SINGLE?t="Floating-Single":this._modelType===e.FIXED&&(t="Fixed (Scale="+this.getScale()+")"),t}},{key:"makePrecise",value:function(){if("number"==typeof arguments[0]){var t=arguments[0];return R.isNaN(t)||this._modelType===e.FLOATING_SINGLE?t:this._modelType===e.FIXED?Math.round(t*this._scale)/this._scale:t}if(arguments[0]instanceof G){var n=arguments[0];if(this._modelType===e.FLOATING)return null;n.x=this.makePrecise(n.x),n.y=this.makePrecise(n.y)}}},{key:"getMaximumSignificantDigits",value:function(){var t=16;return this._modelType===e.FLOATING?t=16:this._modelType===e.FLOATING_SINGLE?t=6:this._modelType===e.FIXED&&(t=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),t}},{key:"setScale",value:function(t){this._scale=Math.abs(t)}},{key:"interfaces_",get:function(){return[x,_]}}],[{key:"constructor_",value:function(){if(this._modelType=null,this._scale=null,0===arguments.length)this._modelType=e.FLOATING;else if(1===arguments.length)if(arguments[0]instanceof ne){var t=arguments[0];this._modelType=t,t===e.FIXED&&this.setScale(1)}else if("number"==typeof arguments[0]){var n=arguments[0];this._modelType=e.FIXED,this.setScale(n)}else if(arguments[0]instanceof e){var r=arguments[0];this._modelType=r._modelType,this._scale=r._scale}}},{key:"mostPrecise",value:function(t,e){return t.compareTo(e)>=0?t:e}}]),e}(),ne=function(){function e(){t(this,e),e.constructor_.apply(this,arguments)}return n(e,[{key:"readResolve",value:function(){return e.nameToTypeMap.get(this._name)}},{key:"toString",value:function(){return this._name}},{key:"interfaces_",get:function(){return[x]}}],[{key:"constructor_",value:function(){this._name=null;var t=arguments[0];this._name=t,e.nameToTypeMap.put(t,this)}}]),e}();ne.nameToTypeMap=new te,ee.Type=ne,ee.FIXED=new ne("FIXED"),ee.FLOATING=new ne("FLOATING"),ee.FLOATING_SINGLE=new ne("FLOATING SINGLE"),ee.maximumPreciseValue=9007199254740992;var re=function(e){r(s,e);var o=c(s);function s(){var e;return t(this,s),e=o.call(this),s.constructor_.apply(u(e),arguments),e}return n(s,[{key:"copyInternal",value:function(){for(var t=new Array(this._geometries.length).fill(null),e=0;e<t.length;e++)t[e]=this._geometries[e].copy();return new s(t,this._factory)}},{key:"equalsExact",value:function(){if(2===arguments.length&&"number"==typeof arguments[1]&&arguments[0]instanceof V){var t=arguments[0],e=arguments[1];return!!this.isEquivalentClass(t)&&h(i(s.prototype),"equalsExact",this).call(this,t,e)}return h(i(s.prototype),"equalsExact",this).apply(this,arguments)}},{key:"getBoundaryDimension",value:function(){return this.isClosed()?St.FALSE:0}},{key:"isClosed",value:function(){if(this.isEmpty())return!1;for(var t=0;t<this._geometries.length;t++)if(!this._geometries[t].isClosed())return!1;return!0}},{key:"getTypeCode",value:function(){return V.TYPECODE_MULTILINESTRING}},{key:"getDimension",value:function(){return 1}},{key:"getBoundary",value:function(){throw new J}},{key:"getGeometryType",value:function(){return V.TYPENAME_MULTILINESTRING}},{key:"interfaces_",get:function(){return[wt]}}],[{key:"constructor_",value:function(){var t=arguments[0],e=arguments[1];Nt.constructor_.call(this,t,e)}}]),s}(Nt),ie=function(){function e(){t(this,e),e.constructor_.apply(this,arguments)}return n(e,[{key:"createEmpty",value:function(t){switch(t){case-1:return this.createGeometryCollection();case 0:return this.createPoint();case 1:return this.createLineString();case 2:return this.createPolygon();default:throw new v("Invalid dimension: "+t)}}},{key:"toGeometry",value:function(t){return t.isNull()?this.createPoint():t.getMinX()===t.getMaxX()&&t.getMinY()===t.getMaxY()?this.createPoint(new G(t.getMinX(),t.getMinY())):t.getMinX()===t.getMaxX()||t.getMinY()===t.getMaxY()?this.createLineString([new G(t.getMinX(),t.getMinY()),new G(t.getMaxX(),t.getMaxY())]):this.createPolygon(this.createLinearRing([new G(t.getMinX(),t.getMinY()),new G(t.getMinX(),t.getMaxY()),new G(t.getMaxX(),t.getMaxY()),new G(t.getMaxX(),t.getMinY()),new G(t.getMinX(),t.getMinY())]),null)}},{key:"createLineString",value:function(){if(0===arguments.length)return this.createLineString(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof Array){var t=arguments[0];return this.createLineString(null!==t?this.getCoordinateSequenceFactory().create(t):null)}if(nt(arguments[0],lt))return new Pt(arguments[0],this)}}},{key:"createMultiLineString",value:function(){return 0===arguments.length?new re(null,this):1===arguments.length?new re(arguments[0],this):void 0}},{key:"buildGeometry",value:function(t){for(var n=null,r=!1,i=!1,o=t.iterator();o.hasNext();){var s=o.next(),a=s.getTypeCode();null===n&&(n=a),a!==n&&(r=!0),s instanceof Nt&&(i=!0)}if(null===n)return this.createGeometryCollection();if(r||i)return this.createGeometryCollection(e.toGeometryArray(t));var l=t.iterator().next();if(t.size()>1){if(l instanceof Lt)return this.createMultiPolygon(e.toPolygonArray(t));if(l instanceof Pt)return this.createMultiLineString(e.toLineStringArray(t));if(l instanceof Ot)return this.createMultiPoint(e.toPointArray(t));D.shouldNeverReachHere("Unhandled geometry type: "+l.getGeometryType())}return l}},{key:"createMultiPointFromCoords",value:function(t){return this.createMultiPoint(null!==t?this.getCoordinateSequenceFactory().create(t):null)}},{key:"createPoint",value:function(){if(0===arguments.length)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof G){var t=arguments[0];return this.createPoint(null!==t?this.getCoordinateSequenceFactory().create([t]):null)}if(nt(arguments[0],lt))return new Ot(arguments[0],this)}}},{key:"getCoordinateSequenceFactory",value:function(){return this._coordinateSequenceFactory}},{key:"createPolygon",value:function(){if(0===arguments.length)return this.createPolygon(null,null);if(1===arguments.length){if(nt(arguments[0],lt)){var t=arguments[0];return this.createPolygon(this.createLinearRing(t))}if(arguments[0]instanceof Array){var e=arguments[0];return this.createPolygon(this.createLinearRing(e))}if(arguments[0]instanceof Gt){var n=arguments[0];return this.createPolygon(n,null)}}else if(2===arguments.length)return new Lt(arguments[0],arguments[1],this)}},{key:"getSRID",value:function(){return this._SRID}},{key:"createGeometryCollection",value:function(){return 0===arguments.length?new Nt(null,this):1===arguments.length?new Nt(arguments[0],this):void 0}},{key:"getPrecisionModel",value:function(){return this._precisionModel}},{key:"createLinearRing",value:function(){if(0===arguments.length)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof Array){var t=arguments[0];return this.createLinearRing(null!==t?this.getCoordinateSequenceFactory().create(t):null)}if(nt(arguments[0],lt))return new Gt(arguments[0],this)}}},{key:"createMultiPolygon",value:function(){return 0===arguments.length?new Qt(null,this):1===arguments.length?new Qt(arguments[0],this):void 0}},{key:"createMultiPoint",value:function(){if(0===arguments.length)return new jt(null,this);if(1===arguments.length){if(arguments[0]instanceof Array)return new jt(arguments[0],this);if(nt(arguments[0],lt)){var t=arguments[0];if(null===t)return this.createMultiPoint(new Array(0).fill(null));for(var e=new Array(t.size()).fill(null),n=0;n<t.size();n++){var r=this.getCoordinateSequenceFactory().create(1,t.getDimension(),t.getMeasures());Ct.copy(t,n,r,0,1),e[n]=this.createPoint(r)}return this.createMultiPoint(e)}}}},{key:"interfaces_",get:function(){return[x]}}],[{key:"constructor_",value:function(){if(this._precisionModel=null,this._coordinateSequenceFactory=null,this._SRID=null,0===arguments.length)e.constructor_.call(this,new ee,0);else if(1===arguments.length){if(nt(arguments[0],_t)){var t=arguments[0];e.constructor_.call(this,new ee,0,t)}else if(arguments[0]instanceof ee){var n=arguments[0];e.constructor_.call(this,n,0,e.getDefaultCoordinateSequenceFactory())}}else if(2===arguments.length){var r=arguments[0],i=arguments[1];e.constructor_.call(this,r,i,e.getDefaultCoordinateSequenceFactory())}else if(3===arguments.length){var o=arguments[0],s=arguments[1],a=arguments[2];this._precisionModel=o,this._coordinateSequenceFactory=a,this._SRID=s}}},{key:"toMultiPolygonArray",value:function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)}},{key:"toGeometryArray",value:function(t){if(null===t)return null;var e=new Array(t.size()).fill(null);return t.toArray(e)}},{key:"getDefaultCoordinateSequenceFactory",value:function(){return Zt.instance()}},{key:"toMultiLineStringArray",value:function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)}},{key:"toLineStringArray",value:function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)}},{key:"toMultiPointArray",value:function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)}},{key:"toLinearRingArray",value:function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)}},{key:"toPointArray",value:function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)}},{key:"toPolygonArray",value:function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)}},{key:"createPointFromInternalCoord",value:function(t,e){return e.getPrecisionModel().makePrecise(t),e.getFactory().createPoint(t)}}]),e}(),oe="XY",se={POINT:"Point",LINE_STRING:"LineString",LINEAR_RING:"LinearRing",POLYGON:"Polygon",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon",GEOMETRY_COLLECTION:"GeometryCollection",CIRCLE:"Circle"},ae="EMPTY",le={};for(var ue in se)le[ue]=se[ue].toUpperCase();var ce=function(){function e(n){t(this,e),this.wkt=n,this.index_=-1}return n(e,[{key:"isAlpha_",value:function(t){return t>="a"&&t<="z"||t>="A"&&t<="Z"}},{key:"isNumeric_",value:function(t,e){return t>="0"&&t<="9"||"."==t&&!(void 0!==e&&e)}},{key:"isWhiteSpace_",value:function(t){return" "==t||"\t"==t||"\r"==t||"\n"==t}},{key:"nextChar_",value:function(){return this.wkt.charAt(++this.index_)}},{key:"nextToken",value:function(){var t,e=this.nextChar_(),n=this.index_,r=e;if("("==e)t=2;else if(","==e)t=5;else if(")"==e)t=3;else if(this.isNumeric_(e)||"-"==e)t=4,r=this.readNumber_();else if(this.isAlpha_(e))t=1,r=this.readText_();else{if(this.isWhiteSpace_(e))return this.nextToken();if(""!==e)throw new Error("Unexpected character: "+e);t=6}return{position:n,value:r,type:t}}},{key:"readNumber_",value:function(){var t,e=this.index_,n=!1,r=!1;do{"."==t?n=!0:"e"!=t&&"E"!=t||(r=!0),t=this.nextChar_()}while(this.isNumeric_(t,n)||!r&&("e"==t||"E"==t)||r&&("-"==t||"+"==t));return parseFloat(this.wkt.substring(e,this.index_--))}},{key:"readText_",value:function(){var t,e=this.index_;do{t=this.nextChar_()}while(this.isAlpha_(t));return this.wkt.substring(e,this.index_--).toUpperCase()}}]),e}(),he=function(){function e(n,r){t(this,e),this.lexer_=n,this.token_,this.layout_=oe,this.factory=r}return n(e,[{key:"consume_",value:function(){this.token_=this.lexer_.nextToken()}},{key:"isTokenType",value:function(t){return this.token_.type==t}},{key:"match",value:function(t){var e=this.isTokenType(t);return e&&this.consume_(),e}},{key:"parse",value:function(){return this.consume_(),this.parseGeometry_()}},{key:"parseGeometryLayout_",value:function(){var t=oe,e=this.token_;if(this.isTokenType(1)){var n=e.value;"Z"===n?t="XYZ":"M"===n?t="XYM":"ZM"===n&&(t="XYZM"),t!==oe&&this.consume_()}return t}},{key:"parseGeometryCollectionText_",value:function(){if(this.match(2)){var t=[];do{t.push(this.parseGeometry_())}while(this.match(5));if(this.match(3))return t}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parsePointText_",value:function(){if(this.match(2)){var t=this.parsePoint_();if(this.match(3))return t}else if(this.isEmptyGeometry_())return null;throw new Error(this.formatErrorMessage_())}},{key:"parseLineStringText_",value:function(){if(this.match(2)){var t=this.parsePointList_();if(this.match(3))return t}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parsePolygonText_",value:function(){if(this.match(2)){var t=this.parseLineStringTextList_();if(this.match(3))return t}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parseMultiPointText_",value:function(){var t;if(this.match(2)){if(t=2==this.token_.type?this.parsePointTextList_():this.parsePointList_(),this.match(3))return t}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parseMultiLineStringText_",value:function(){if(this.match(2)){var t=this.parseLineStringTextList_();if(this.match(3))return t}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parseMultiPolygonText_",value:function(){if(this.match(2)){var t=this.parsePolygonTextList_();if(this.match(3))return t}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parsePoint_",value:function(){for(var t=[],e=this.layout_.length,n=0;n<e;++n){var r=this.token_;if(!this.match(4))break;t.push(r.value)}if(t.length==e)return t;throw new Error(this.formatErrorMessage_())}},{key:"parsePointList_",value:function(){for(var t=[this.parsePoint_()];this.match(5);)t.push(this.parsePoint_());return t}},{key:"parsePointTextList_",value:function(){for(var t=[this.parsePointText_()];this.match(5);)t.push(this.parsePointText_());return t}},{key:"parseLineStringTextList_",value:function(){for(var t=[this.parseLineStringText_()];this.match(5);)t.push(this.parseLineStringText_());return t}},{key:"parsePolygonTextList_",value:function(){for(var t=[this.parsePolygonText_()];this.match(5);)t.push(this.parsePolygonText_());return t}},{key:"isEmptyGeometry_",value:function(){var t=this.isTokenType(1)&&this.token_.value==ae;return t&&this.consume_(),t}},{key:"formatErrorMessage_",value:function(){return"Unexpected `"+this.token_.value+"` at position "+this.token_.position+" in `"+this.lexer_.wkt+"`"}},{key:"parseGeometry_",value:function(){var t=this.factory,e=function(t){return a(G,d(t))},n=function(n){var r=n.map((function(n){return t.createLinearRing(n.map(e))}));return r.length>1?t.createPolygon(r[0],r.slice(1)):t.createPolygon(r[0])},r=this.token_;if(this.match(1)){var i=r.value;if(this.layout_=this.parseGeometryLayout_(),"GEOMETRYCOLLECTION"==i){var o=this.parseGeometryCollectionText_();return t.createGeometryCollection(o)}switch(i){case"POINT":var s=this.parsePointText_();return s?t.createPoint(a(G,d(s))):t.createPoint();case"LINESTRING":var l=this.parseLineStringText_().map(e);return t.createLineString(l);case"LINEARRING":var u=this.parseLineStringText_().map(e);return t.createLinearRing(u);case"POLYGON":var c=this.parsePolygonText_();return c&&0!==c.length?n(c):t.createPolygon();case"MULTIPOINT":var h=this.parseMultiPointText_();if(!h||0===h.length)return t.createMultiPoint();var f=h.map(e).map((function(e){return t.createPoint(e)}));return t.createMultiPoint(f);case"MULTILINESTRING":var p=this.parseMultiLineStringText_().map((function(n){return t.createLineString(n.map(e))}));return t.createMultiLineString(p);case"MULTIPOLYGON":var g=this.parseMultiPolygonText_();if(!g||0===g.length)return t.createMultiPolygon();var y=g.map(n);return t.createMultiPolygon(y);default:throw new Error("Invalid geometry type: "+i)}}throw new Error(this.formatErrorMessage_())}}]),e}();function de(t){if(t.isEmpty())return"";var e=t.getCoordinate(),n=[e.x,e.y];return void 0===e.z||Number.isNaN(e.z)||n.push(e.z),void 0===e.m||Number.isNaN(e.m)||n.push(e.m),n.join(" ")}function fe(t){for(var e=t.getCoordinates().map((function(t){var e=[t.x,t.y];return void 0===t.z||Number.isNaN(t.z)||e.push(t.z),void 0===t.m||Number.isNaN(t.m)||e.push(t.m),e})),n=[],r=0,i=e.length;r<i;++r)n.push(e[r].join(" "));return n.join(", ")}function pe(t){var e=[];e.push("("+fe(t.getExteriorRing())+")");for(var n=0,r=t.getNumInteriorRing();n<r;++n)e.push("("+fe(t.getInteriorRingN(n))+")");return e.join(", ")}var ge={Point:de,LineString:fe,LinearRing:fe,Polygon:pe,MultiPoint:function(t){for(var e=[],n=0,r=t.getNumGeometries();n<r;++n)e.push("("+de(t.getGeometryN(n))+")");return e.join(", ")},MultiLineString:function(t){for(var e=[],n=0,r=t.getNumGeometries();n<r;++n)e.push("("+fe(t.getGeometryN(n))+")");return e.join(", ")},MultiPolygon:function(t){for(var e=[],n=0,r=t.getNumGeometries();n<r;++n)e.push("("+pe(t.getGeometryN(n))+")");return e.join(", ")},GeometryCollection:function(t){for(var e=[],n=0,r=t.getNumGeometries();n<r;++n)e.push(ye(t.getGeometryN(n)));return e.join(", ")}};function ye(t){var e=t.getGeometryType(),n=ge[e];e=e.toUpperCase();var r=function(t){var e="";if(t.isEmpty())return e;var n=t.getCoordinate();return void 0===n.z||Number.isNaN(n.z)||(e+="Z"),void 0===n.m||Number.isNaN(n.m)||(e+="M"),e}(t);return r.length>0&&(e+=" "+r),t.isEmpty()?e+" "+ae:e+" ("+n(t)+")"}var me=function(){function e(n){t(this,e),this.geometryFactory=n||new ie,this.precisionModel=this.geometryFactory.getPrecisionModel()}return n(e,[{key:"read",value:function(t){var e=new ce(t);return new he(e,this.geometryFactory).parse()}},{key:"write",value:function(t){return ye(t)}}]),e}(),ve=function(){function e(n){t(this,e),this.parser=new me(n)}return n(e,[{key:"write",value:function(t){return this.parser.write(t)}}],[{key:"toLineString",value:function(t,e){if(2!==arguments.length)throw new Error("Not implemented");return"LINESTRING ( "+t.x+" "+t.y+", "+e.x+" "+e.y+" )"}}]),e}(),be=function(){function e(){t(this,e),e.constructor_.apply(this,arguments)}return n(e,[{key:"getIndexAlongSegment",value:function(t,e){return this.computeIntLineIndex(),this._intLineIndex[t][e]}},{key:"getTopologySummary",value:function(){var t=new Xt;return this.isEndPoint()&&t.append(" endpoint"),this._isProper&&t.append(" proper"),this.isCollinear()&&t.append(" collinear"),t.toString()}},{key:"computeIntersection",value:function(t,e,n,r){this._inputLines[0][0]=t,this._inputLines[0][1]=e,this._inputLines[1][0]=n,this._inputLines[1][1]=r,this._result=this.computeIntersect(t,e,n,r)}},{key:"getIntersectionNum",value:function(){return this._result}},{key:"computeIntLineIndex",value:function(){if(0===arguments.length)null===this._intLineIndex&&(this._intLineIndex=Array(2).fill().map((function(){return Array(2)})),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(1===arguments.length){var t=arguments[0];this.getEdgeDistance(t,0)>this.getEdgeDistance(t,1)?(this._intLineIndex[t][0]=0,this._intLineIndex[t][1]=1):(this._intLineIndex[t][0]=1,this._intLineIndex[t][1]=0)}}},{key:"isProper",value:function(){return this.hasIntersection()&&this._isProper}},{key:"setPrecisionModel",value:function(t){this._precisionModel=t}},{key:"isInteriorIntersection",value:function(){if(0===arguments.length)return!!this.isInteriorIntersection(0)||!!this.isInteriorIntersection(1);if(1===arguments.length){for(var t=arguments[0],e=0;e<this._result;e++)if(!this._intPt[e].equals2D(this._inputLines[t][0])&&!this._intPt[e].equals2D(this._inputLines[t][1]))return!0;return!1}}},{key:"getIntersection",value:function(t){return this._intPt[t]}},{key:"isEndPoint",value:function(){return this.hasIntersection()&&!this._isProper}},{key:"hasIntersection",value:function(){return this._result!==e.NO_INTERSECTION}},{key:"getEdgeDistance",value:function(t,n){return e.computeEdgeDistance(this._intPt[n],this._inputLines[t][0],this._inputLines[t][1])}},{key:"isCollinear",value:function(){return this._result===e.COLLINEAR_INTERSECTION}},{key:"toString",value:function(){return ve.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+ve.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()}},{key:"getEndpoint",value:function(t,e){return this._inputLines[t][e]}},{key:"isIntersection",value:function(t){for(var e=0;e<this._result;e++)if(this._intPt[e].equals2D(t))return!0;return!1}},{key:"getIntersectionAlongSegment",value:function(t,e){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[t][e]]}}],[{key:"constructor_",value:function(){this._result=null,this._inputLines=Array(2).fill().map((function(){return Array(2)})),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new G,this._intPt[1]=new G,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0}},{key:"computeEdgeDistance",value:function(t,e,n){var r=Math.abs(n.x-e.x),i=Math.abs(n.y-e.y),o=-1;if(t.equals(e))o=0;else if(t.equals(n))o=r>i?r:i;else{var s=Math.abs(t.x-e.x),a=Math.abs(t.y-e.y);0!==(o=r>i?s:a)||t.equals(e)||(o=Math.max(s,a))}return D.isTrue(!(0===o&&!t.equals(e)),"Bad distance calculation"),o}},{key:"nonRobustComputeEdgeDistance",value:function(t,e,n){var r=t.x-e.x,i=t.y-e.y,o=Math.sqrt(r*r+i*i);return D.isTrue(!(0===o&&!t.equals(e)),"Invalid distance calculation"),o}}]),e}();be.DONT_INTERSECT=0,be.DO_INTERSECT=1,be.COLLINEAR=2,be.NO_INTERSECTION=0,be.POINT_INTERSECTION=1,be.COLLINEAR_INTERSECTION=2;var _e=function(e){r(s,e);var o=c(s);function s(){return t(this,s),o.call(this)}return n(s,[{key:"isInSegmentEnvelopes",value:function(t){var e=new z(this._inputLines[0][0],this._inputLines[0][1]),n=new z(this._inputLines[1][0],this._inputLines[1][1]);return e.contains(t)&&n.contains(t)}},{key:"computeIntersection",value:function(){if(3!==arguments.length)return h(i(s.prototype),"computeIntersection",this).apply(this,arguments);var t=arguments[0],e=arguments[1],n=arguments[2];if(this._isProper=!1,z.intersects(e,n,t)&&0===ut.index(e,n,t)&&0===ut.index(n,e,t))return this._isProper=!0,(t.equals(e)||t.equals(n))&&(this._isProper=!1),this._result=be.POINT_INTERSECTION,null;this._result=be.NO_INTERSECTION}},{key:"intersection",value:function(t,e,n,r){var i=this.intersectionSafe(t,e,n,r);return this.isInSegmentEnvelopes(i)||(i=new G(s.nearestEndpoint(t,e,n,r))),null!==this._precisionModel&&this._precisionModel.makePrecise(i),i}},{key:"checkDD",value:function(t,e,n,r,i){var o=at.intersection(t,e,n,r),s=this.isInSegmentEnvelopes(o);mt.out.println("DD in env = "+s+"  --------------------- "+o),i.distance(o)>1e-4&&mt.out.println("Distance = "+i.distance(o))}},{key:"intersectionSafe",value:function(t,e,n,r){var i=yt.intersection(t,e,n,r);return null===i&&(i=s.nearestEndpoint(t,e,n,r)),i}},{key:"computeCollinearIntersection",value:function(t,e,n,r){var i=z.intersects(t,e,n),o=z.intersects(t,e,r),s=z.intersects(n,r,t),a=z.intersects(n,r,e);return i&&o?(this._intPt[0]=n,this._intPt[1]=r,be.COLLINEAR_INTERSECTION):s&&a?(this._intPt[0]=t,this._intPt[1]=e,be.COLLINEAR_INTERSECTION):i&&s?(this._intPt[0]=n,this._intPt[1]=t,!n.equals(t)||o||a?be.COLLINEAR_INTERSECTION:be.POINT_INTERSECTION):i&&a?(this._intPt[0]=n,this._intPt[1]=e,!n.equals(e)||o||s?be.COLLINEAR_INTERSECTION:be.POINT_INTERSECTION):o&&s?(this._intPt[0]=r,this._intPt[1]=t,!r.equals(t)||i||a?be.COLLINEAR_INTERSECTION:be.POINT_INTERSECTION):o&&a?(this._intPt[0]=r,this._intPt[1]=e,!r.equals(e)||i||s?be.COLLINEAR_INTERSECTION:be.POINT_INTERSECTION):be.NO_INTERSECTION}},{key:"computeIntersect",value:function(t,e,n,r){if(this._isProper=!1,!z.intersects(t,e,n,r))return be.NO_INTERSECTION;var i=ut.index(t,e,n),o=ut.index(t,e,r);if(i>0&&o>0||i<0&&o<0)return be.NO_INTERSECTION;var s=ut.index(n,r,t),a=ut.index(n,r,e);return s>0&&a>0||s<0&&a<0?be.NO_INTERSECTION:0===i&&0===o&&0===s&&0===a?this.computeCollinearIntersection(t,e,n,r):(0===i||0===o||0===s||0===a?(this._isProper=!1,t.equals2D(n)||t.equals2D(r)?this._intPt[0]=t:e.equals2D(n)||e.equals2D(r)?this._intPt[0]=e:0===i?this._intPt[0]=new G(n):0===o?this._intPt[0]=new G(r):0===s?this._intPt[0]=new G(t):0===a&&(this._intPt[0]=new G(e))):(this._isProper=!0,this._intPt[0]=this.intersection(t,e,n,r)),be.POINT_INTERSECTION)}}],[{key:"nearestEndpoint",value:function(t,e,n,r){var i=t,o=bt.pointToSegment(t,n,r),s=bt.pointToSegment(e,n,r);return s<o&&(o=s,i=e),(s=bt.pointToSegment(n,t,e))<o&&(o=s,i=n),(s=bt.pointToSegment(r,t,e))<o&&(o=s,i=r),i}}]),s}(be),Ae=function(){function e(){t(this,e),e.constructor_.apply(this,arguments)}return n(e,[{key:"countSegment",value:function(t,e){if(t.x<this._p.x&&e.x<this._p.x)return null;if(this._p.x===e.x&&this._p.y===e.y)return this._isPointOnSegment=!0,null;if(t.y===this._p.y&&e.y===this._p.y){var n=t.x,r=e.x;return n>r&&(n=e.x,r=t.x),this._p.x>=n&&this._p.x<=r&&(this._isPointOnSegment=!0),null}if(t.y>this._p.y&&e.y<=this._p.y||e.y>this._p.y&&t.y<=this._p.y){var i=ut.index(t,e,this._p);if(i===ut.COLLINEAR)return this._isPointOnSegment=!0,null;e.y<t.y&&(i=-i),i===ut.LEFT&&this._crossingCount++}}},{key:"isPointInPolygon",value:function(){return this.getLocation()!==H.EXTERIOR}},{key:"getLocation",value:function(){return this._isPointOnSegment?H.BOUNDARY:this._crossingCount%2==1?H.INTERIOR:H.EXTERIOR}},{key:"isOnSegment",value:function(){return this._isPointOnSegment}}],[{key:"constructor_",value:function(){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1;var t=arguments[0];this._p=t}},{key:"locatePointInRing",value:function(){if(arguments[0]instanceof G&&nt(arguments[1],lt)){for(var t=arguments[1],n=new e(arguments[0]),r=new G,i=new G,o=1;o<t.size();o++)if(t.getCoordinate(o,r),t.getCoordinate(o-1,i),n.countSegment(r,i),n.isOnSegment())return n.getLocation();return n.getLocation()}if(arguments[0]instanceof G&&arguments[1]instanceof Array){for(var s=arguments[1],a=new e(arguments[0]),l=1;l<s.length;l++){var u=s[l],c=s[l-1];if(a.countSegment(u,c),a.isOnSegment())return a.getLocation()}return a.getLocation()}}}]),e}(),xe=function(){function e(){t(this,e)}return n(e,null,[{key:"isOnLine",value:function(){if(arguments[0]instanceof G&&nt(arguments[1],lt)){for(var t=arguments[0],e=arguments[1],n=new _e,r=new G,i=new G,o=e.size(),s=1;s<o;s++)if(e.getCoordinate(s-1,r),e.getCoordinate(s,i),n.computeIntersection(t,r,i),n.hasIntersection())return!0;return!1}if(arguments[0]instanceof G&&arguments[1]instanceof Array){for(var a=arguments[0],l=arguments[1],u=new _e,c=1;c<l.length;c++){var h=l[c-1],d=l[c];if(u.computeIntersection(a,h,d),u.hasIntersection())return!0}return!1}}},{key:"locateInRing",value:function(t,e){return Ae.locatePointInRing(t,e)}},{key:"isInRing",value:function(t,n){return e.locateInRing(t,n)!==H.EXTERIOR}}]),e}(),we=function(){function e(){t(this,e),e.constructor_.apply(this,arguments)}return n(e,[{key:"setAllLocations",value:function(t){for(var e=0;e<this.location.length;e++)this.location[e]=t}},{key:"isNull",value:function(){for(var t=0;t<this.location.length;t++)if(this.location[t]!==H.NONE)return!1;return!0}},{key:"setAllLocationsIfNull",value:function(t){for(var e=0;e<this.location.length;e++)this.location[e]===H.NONE&&(this.location[e]=t)}},{key:"isLine",value:function(){return 1===this.location.length}},{key:"merge",value:function(t){if(t.location.length>this.location.length){var e=new Array(3).fill(null);e[Z.ON]=this.location[Z.ON],e[Z.LEFT]=H.NONE,e[Z.RIGHT]=H.NONE,this.location=e}for(var n=0;n<this.location.length;n++)this.location[n]===H.NONE&&n<t.location.length&&(this.location[n]=t.location[n])}},{key:"getLocations",value:function(){return this.location}},{key:"flip",value:function(){if(this.location.length<=1)return null;var t=this.location[Z.LEFT];this.location[Z.LEFT]=this.location[Z.RIGHT],this.location[Z.RIGHT]=t}},{key:"toString",value:function(){var t=new rt;return this.location.length>1&&t.append(H.toLocationSymbol(this.location[Z.LEFT])),t.append(H.toLocationSymbol(this.location[Z.ON])),this.location.length>1&&t.append(H.toLocationSymbol(this.location[Z.RIGHT])),t.toString()}},{key:"setLocations",value:function(t,e,n){this.location[Z.ON]=t,this.location[Z.LEFT]=e,this.location[Z.RIGHT]=n}},{key:"get",value:function(t){return t<this.location.length?this.location[t]:H.NONE}},{key:"isArea",value:function(){return this.location.length>1}},{key:"isAnyNull",value:function(){for(var t=0;t<this.location.length;t++)if(this.location[t]===H.NONE)return!0;return!1}},{key:"setLocation",value:function(){if(1===arguments.length){var t=arguments[0];this.setLocation(Z.ON,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.location[e]=n}}},{key:"init",value:function(t){this.location=new Array(t).fill(null),this.setAllLocations(H.NONE)}},{key:"isEqualOnSide",value:function(t,e){return this.location[e]===t.location[e]}},{key:"allPositionsEqual",value:function(t){for(var e=0;e<this.location.length;e++)if(this.location[e]!==t)return!1;return!0}}],[{key:"constructor_",value:function(){if(this.location=null,1===arguments.length){if(arguments[0]instanceof Array){var t=arguments[0];this.init(t.length)}else if(Number.isInteger(arguments[0])){var n=arguments[0];this.init(1),this.location[Z.ON]=n}else if(arguments[0]instanceof e){var r=arguments[0];if(this.init(r.location.length),null!==r)for(var i=0;i<this.location.length;i++)this.location[i]=r.location[i]}}else if(3===arguments.length){var o=arguments[0],s=arguments[1],a=arguments[2];this.init(3),this.location[Z.ON]=o,this.location[Z.LEFT]=s,this.location[Z.RIGHT]=a}}}]),e}(),Ce=function(){function e(){t(this,e),e.constructor_.apply(this,arguments)}return n(e,[{key:"getGeometryCount",value:function(){var t=0;return this.elt[0].isNull()||t++,this.elt[1].isNull()||t++,t}},{key:"setAllLocations",value:function(t,e){this.elt[t].setAllLocations(e)}},{key:"isNull",value:function(t){return this.elt[t].isNull()}},{key:"setAllLocationsIfNull",value:function(){if(1===arguments.length){var t=arguments[0];this.setAllLocationsIfNull(0,t),this.setAllLocationsIfNull(1,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.elt[e].setAllLocationsIfNull(n)}}},{key:"isLine",value:function(t){return this.elt[t].isLine()}},{key:"merge",value:function(t){for(var e=0;e<2;e++)null===this.elt[e]&&null!==t.elt[e]?this.elt[e]=new we(t.elt[e]):this.elt[e].merge(t.elt[e])}},{key:"flip",value:function(){this.elt[0].flip(),this.elt[1].flip()}},{key:"getLocation",value:function(){if(1===arguments.length){var t=arguments[0];return this.elt[t].get(Z.ON)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return this.elt[e].get(n)}}},{key:"toString",value:function(){var t=new rt;return null!==this.elt[0]&&(t.append("A:"),t.append(this.elt[0].toString())),null!==this.elt[1]&&(t.append(" B:"),t.append(this.elt[1].toString())),t.toString()}},{key:"isArea",value:function(){if(0===arguments.length)return this.elt[0].isArea()||this.elt[1].isArea();if(1===arguments.length){var t=arguments[0];return this.elt[t].isArea()}}},{key:"isAnyNull",value:function(t){return this.elt[t].isAnyNull()}},{key:"setLocation",value:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];this.elt[t].setLocation(Z.ON,e)}else if(3===arguments.length){var n=arguments[0],r=arguments[1],i=arguments[2];this.elt[n].setLocation(r,i)}}},{key:"isEqualOnSide",value:function(t,e){return this.elt[0].isEqualOnSide(t.elt[0],e)&&this.elt[1].isEqualOnSide(t.elt[1],e)}},{key:"allPositionsEqual",value:function(t,e){return this.elt[t].allPositionsEqual(e)}},{key:"toLine",value:function(t){this.elt[t].isArea()&&(this.elt[t]=new we(this.elt[t].location[0]))}}],[{key:"constructor_",value:function(){if(this.elt=new Array(2).fill(null),1===arguments.length){if(Number.isInteger(arguments[0])){var t=arguments[0];this.elt[0]=new we(t),this.elt[1]=new we(t)}else if(arguments[0]instanceof e){var n=arguments[0];this.elt[0]=new we(n.elt[0]),this.elt[1]=new we(n.elt[1])}}else if(2===arguments.length){var r=arguments[0],i=arguments[1];this.elt[0]=new we(H.NONE),this.elt[1]=new we(H.NONE),this.elt[r].setLocation(i)}else if(3===arguments.length){var o=arguments[0],s=arguments[1],a=arguments[2];this.elt[0]=new we(o,s,a),this.elt[1]=new we(o,s,a)}else if(4===arguments.length){var l=arguments[0],u=arguments[1],c=arguments[2],h=arguments[3];this.elt[0]=new we(H.NONE,H.NONE,H.NONE),this.elt[1]=new we(H.NONE,H.NONE,H.NONE),this.elt[l].setLocations(u,c,h)}}},{key:"toLineLabel",value:function(t){for(var n=new e(H.NONE),r=0;r<2;r++)n.setLocation(r,t.getLocation(r));return n}}]),e}(),Se=function(){function e(){t(this,e),e.constructor_.apply(this,arguments)}return n(e,[{key:"computeRing",value:function(){if(null!==this._ring)return null;for(var t=new Array(this._pts.size()).fill(null),e=0;e<this._pts.size();e++)t[e]=this._pts.get(e);this._ring=this._geometryFactory.createLinearRing(t),this._isHole=ut.isCCW(this._ring.getCoordinates())}},{key:"isIsolated",value:function(){return 1===this._label.getGeometryCount()}},{key:"computePoints",value:function(t){this._startDe=t;var e=t,n=!0;do{if(null===e)throw new ht("Found null DirectedEdge");if(e.getEdgeRing()===this)throw new ht("Directed Edge visited twice during ring-building at "+e.getCoordinate());this._edges.add(e);var r=e.getLabel();D.isTrue(r.isArea()),this.mergeLabel(r),this.addPoints(e.getEdge(),e.isForward(),n),n=!1,this.setEdgeRing(e,this),e=this.getNext(e)}while(e!==this._startDe)}},{key:"getLinearRing",value:function(){return this._ring}},{key:"getCoordinate",value:function(t){return this._pts.get(t)}},{key:"computeMaxNodeDegree",value:function(){this._maxNodeDegree=0;var t=this._startDe;do{var e=t.getNode().getEdges().getOutgoingDegree(this);e>this._maxNodeDegree&&(this._maxNodeDegree=e),t=this.getNext(t)}while(t!==this._startDe);this._maxNodeDegree*=2}},{key:"addPoints",value:function(t,e,n){var r=t.getCoordinates();if(e){var i=1;n&&(i=0);for(var o=i;o<r.length;o++)this._pts.add(r[o])}else{var s=r.length-2;n&&(s=r.length-1);for(var a=s;a>=0;a--)this._pts.add(r[a])}}},{key:"isHole",value:function(){return this._isHole}},{key:"setInResult",value:function(){var t=this._startDe;do{t.getEdge().setInResult(!0),t=t.getNext()}while(t!==this._startDe)}},{key:"containsPoint",value:function(t){var e=this.getLinearRing();if(!e.getEnvelopeInternal().contains(t))return!1;if(!xe.isInRing(t,e.getCoordinates()))return!1;for(var n=this._holes.iterator();n.hasNext();)if(n.next().containsPoint(t))return!1;return!0}},{key:"addHole",value:function(t){this._holes.add(t)}},{key:"isShell",value:function(){return null===this._shell}},{key:"getLabel",value:function(){return this._label}},{key:"getEdges",value:function(){return this._edges}},{key:"getMaxNodeDegree",value:function(){return this._maxNodeDegree<0&&this.computeMaxNodeDegree(),this._maxNodeDegree}},{key:"getShell",value:function(){return this._shell}},{key:"mergeLabel",value:function(){if(1===arguments.length){var t=arguments[0];this.mergeLabel(t,0),this.mergeLabel(t,1)}else if(2===arguments.length){var e=arguments[1],n=arguments[0].getLocation(e,Z.RIGHT);if(n===H.NONE)return null;if(this._label.getLocation(e)===H.NONE)return this._label.setLocation(e,n),null}}},{key:"setShell",value:function(t){this._shell=t,null!==t&&t.addHole(this)}},{key:"toPolygon",value:function(t){for(var e=new Array(this._holes.size()).fill(null),n=0;n<this._holes.size();n++)e[n]=this._holes.get(n).getLinearRing();return t.createPolygon(this.getLinearRing(),e)}}],[{key:"constructor_",value:function(){if(this._startDe=null,this._maxNodeDegree=-1,this._edges=new ft,this._pts=new ft,this._label=new Ce(H.NONE),this._ring=null,this._isHole=null,this._shell=null,this._holes=new ft,this._geometryFactory=null,0===arguments.length);else if(2===arguments.length){var t=arguments[0],e=arguments[1];this._geometryFactory=e,this.computePoints(t),this.computeRing()}}}]),e}(),Ee=function(e){r(o,e);var i=c(o);function o(){var e;return t(this,o),e=i.call(this),o.constructor_.apply(u(e),arguments),e}return n(o,[{key:"setEdgeRing",value:function(t,e){t.setMinEdgeRing(e)}},{key:"getNext",value:function(t){return t.getNextMin()}}],[{key:"constructor_",value:function(){var t=arguments[0],e=arguments[1];Se.constructor_.call(this,t,e)}}]),o}(Se),Me=function(e){r(o,e);var i=c(o);function o(){var e;return t(this,o),e=i.call(this),o.constructor_.apply(u(e),arguments),e}return n(o,[{key:"buildMinimalRings",value:function(){var t=new ft,e=this._startDe;do{if(null===e.getMinEdgeRing()){var n=new Ee(e,this._geometryFactory);t.add(n)}e=e.getNext()}while(e!==this._startDe);return t}},{key:"setEdgeRing",value:function(t,e){t.setEdgeRing(e)}},{key:"linkDirectedEdgesForMinimalEdgeRings",value:function(){var t=this._startDe;do{t.getNode().getEdges().linkMinimalDirectedEdges(this),t=t.getNext()}while(t!==this._startDe)}},{key:"getNext",value:function(t){return t.getNext()}}],[{key:"constructor_",value:function(){var t=arguments[0],e=arguments[1];Se.constructor_.call(this,t,e)}}]),o}(Se),Pe=function(){function e(){t(this,e),e.constructor_.apply(this,arguments)}return n(e,[{key:"setVisited",value:function(t){this._isVisited=t}},{key:"setInResult",value:function(t){this._isInResult=t}},{key:"isCovered",value:function(){return this._isCovered}},{key:"isCoveredSet",value:function(){return this._isCoveredSet}},{key:"setLabel",value:function(t){this._label=t}},{key:"getLabel",value:function(){return this._label}},{key:"setCovered",value:function(t){this._isCovered=t,this._isCoveredSet=!0}},{key:"updateIM",value:function(t){D.isTrue(this._label.getGeometryCount()>=2,"found partial label"),this.computeIM(t)}},{key:"isInResult",value:function(){return this._isInResult}},{key:"isVisited",value:function(){return this._isVisited}}],[{key:"constructor_",value:function(){if(this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this._label=t}}}]),e}(),Te=function(e){r(s,e);var o=c(s);function s(){var e;return t(this,s),e=o.call(this),s.constructor_.apply(u(e),arguments),e}return n(s,[{key:"isIncidentEdgeInResult",value:function(){for(var t=this.getEdges().getEdges().iterator();t.hasNext();)if(t.next().getEdge().isInResult())return!0;return!1}},{key:"isIsolated",value:function(){return 1===this._label.getGeometryCount()}},{key:"getCoordinate",value:function(){return this._coord}},{key:"print",value:function(t){t.println("node "+this._coord+" lbl: "+this._label)}},{key:"computeIM",value:function(t){}},{key:"computeMergedLocation",value:function(t,e){var n=H.NONE;if(n=this._label.getLocation(e),!t.isNull(e)){var r=t.getLocation(e);n!==H.BOUNDARY&&(n=r)}return n}},{key:"setLabel",value:function(){if(2!==arguments.length||!Number.isInteger(arguments[1])||!Number.isInteger(arguments[0]))return h(i(s.prototype),"setLabel",this).apply(this,arguments);var t=arguments[0],e=arguments[1];null===this._label?this._label=new Ce(t,e):this._label.setLocation(t,e)}},{key:"getEdges",value:function(){return this._edges}},{key:"mergeLabel",value:function(){if(arguments[0]instanceof s){var t=arguments[0];this.mergeLabel(t._label)}else if(arguments[0]instanceof Ce)for(var e=arguments[0],n=0;n<2;n++){var r=this.computeMergedLocation(e,n);this._label.getLocation(n)===H.NONE&&this._label.setLocation(n,r)}}},{key:"add",value:function(t){this._edges.insert(t),t.setNode(this)}},{key:"setLabelBoundary",value:function(t){if(null===this._label)return null;var e=H.NONE;null!==this._label&&(e=this._label.getLocation(t));var n=null;switch(e){case H.BOUNDARY:n=H.INTERIOR;break;case H.INTERIOR:default:n=H.BOUNDARY}this._label.setLocation(t,n)}}],[{key:"constructor_",value:function(){this._coord=null,this._edges=null;var t=arguments[0],e=arguments[1];this._coord=t,this._edges=e,this._label=new Ce(0,H.NONE)}}]),s}(Pe),Oe=function(e){r(i,e);var n=c(i);function i(){return t(this,i),n.apply(this,arguments)}return i}($t);function Ie(t){return null==t?0:t.color}function Re(t){return null==t?null:t.parent}function Be(t,e){null!==t&&(t.color=e)}function Le(t){return null==t?null:t.left}function ke(t){return null==t?null:t.right}var De=function(e){r(o,e);var i=c(o);function o(){var e;return t(this,o),(e=i.call(this)).root_=null,e.size_=0,e}return n(o,[{key:"get",value:function(t){for(var e=this.root_;null!==e;){var n=t.compareTo(e.key);if(n<0)e=e.left;else{if(!(n>0))return e.value;e=e.right}}return null}},{key:"put",value:function(t,e){if(null===this.root_)return this.root_={key:t,value:e,left:null,right:null,parent:null,color:0,getValue:function(){return this.value},getKey:function(){return this.key}},this.size_=1,null;var n,r,i=this.root_;do{if(n=i,(r=t.compareTo(i.key))<0)i=i.left;else{if(!(r>0)){var o=i.value;return i.value=e,o}i=i.right}}while(null!==i);var s={key:t,left:null,right:null,value:e,parent:n,color:0,getValue:function(){return this.value},getKey:function(){return this.key}};return r<0?n.left=s:n.right=s,this.fixAfterInsertion(s),this.size_++,null}},{key:"fixAfterInsertion",value:function(t){var e;for(t.color=1;null!=t&&t!==this.root_&&1===t.parent.color;)Re(t)===Le(Re(Re(t)))?1===Ie(e=ke(Re(Re(t))))?(Be(Re(t),0),Be(e,0),Be(Re(Re(t)),1),t=Re(Re(t))):(t===ke(Re(t))&&(t=Re(t),this.rotateLeft(t)),Be(Re(t),0),Be(Re(Re(t)),1),this.rotateRight(Re(Re(t)))):1===Ie(e=Le(Re(Re(t))))?(Be(Re(t),0),Be(e,0),Be(Re(Re(t)),1),t=Re(Re(t))):(t===Le(Re(t))&&(t=Re(t),this.rotateRight(t)),Be(Re(t),0),Be(Re(Re(t)),1),this.rotateLeft(Re(Re(t))));this.root_.color=0}},{key:"values",value:function(){var t=new ft,e=this.getFirstEntry();if(null!==e)for(t.add(e.value);null!==(e=o.successor(e));)t.add(e.value);return t}},{key:"entrySet",value:function(){var t=new X,e=this.getFirstEntry();if(null!==e)for(t.add(e);null!==(e=o.successor(e));)t.add(e);return t}},{key:"rotateLeft",value:function(t){if(null!=t){var e=t.right;t.right=e.left,null!=e.left&&(e.left.parent=t),e.parent=t.parent,null==t.parent?this.root_=e:t.parent.left===t?t.parent.left=e:t.parent.right=e,e.left=t,t.parent=e}}},{key:"rotateRight",value:function(t){if(null!=t){var e=t.left;t.left=e.right,null!=e.right&&(e.right.parent=t),e.parent=t.parent,null==t.parent?this.root_=e:t.parent.right===t?t.parent.right=e:t.parent.left=e,e.right=t,t.parent=e}}},{key:"getFirstEntry",value:function(){var t=this.root_;if(null!=t)for(;null!=t.left;)t=t.left;return t}},{key:"size",value:function(){return this.size_}},{key:"containsKey",value:function(t){for(var e=this.root_;null!==e;){var n=t.compareTo(e.key);if(n<0)e=e.left;else{if(!(n>0))return!0;e=e.right}}return!1}}],[{key:"successor",value:function(t){var e;if(null===t)return null;if(null!==t.right){for(e=t.right;null!==e.left;)e=e.left;return e}e=t.parent;for(var n=t;null!==e&&n===e.right;)n=e,e=e.parent;return e}}]),o}(Oe),Fe=function(){function e(){t(this,e),e.constructor_.apply(this,arguments)}return n(e,[{key:"find",value:function(t){return this.nodeMap.get(t)}},{key:"addNode",value:function(){if(arguments[0]instanceof G){var t=arguments[0],e=this.nodeMap.get(t);return null===e&&(e=this.nodeFact.createNode(t),this.nodeMap.put(t,e)),e}if(arguments[0]instanceof Te){var n=arguments[0],r=this.nodeMap.get(n.getCoordinate());return null===r?(this.nodeMap.put(n.getCoordinate(),n),n):(r.mergeLabel(n),r)}}},{key:"print",value:function(t){for(var e=this.iterator();e.hasNext();)e.next().print(t)}},{key:"iterator",value:function(){return this.nodeMap.values().iterator()}},{key:"values",value:function(){return this.nodeMap.values()}},{key:"getBoundaryNodes",value:function(t){for(var e=new ft,n=this.iterator();n.hasNext();){var r=n.next();r.getLabel().getLocation(t)===H.BOUNDARY&&e.add(r)}return e}},{key:"add",value:function(t){var e=t.getCoordinate();this.addNode(e).add(t)}}],[{key:"constructor_",value:function(){this.nodeMap=new De,this.nodeFact=null;var t=arguments[0];this.nodeFact=t}}]),e}(),Ne=function(){function e(){t(this,e)}return n(e,null,[{key:"isNorthern",value:function(t){return t===e.NE||t===e.NW}},{key:"isOpposite",value:function(t,e){return t!==e&&2==(t-e+4)%4}},{key:"commonHalfPlane",value:function(t,e){if(t===e)return t;if(2==(t-e+4)%4)return-1;var n=t<e?t:e;return 0===n&&3===(t>e?t:e)?3:n}},{key:"isInHalfPlane",value:function(t,n){return n===e.SE?t===e.SE||t===e.SW:t===n||t===n+1}},{key:"quadrant",value:function(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],n=arguments[1];if(0===t&&0===n)throw new v("Cannot compute the quadrant for point ( "+t+", "+n+" )");return t>=0?n>=0?e.NE:e.SE:n>=0?e.NW:e.SW}if(arguments[0]instanceof G&&arguments[1]instanceof G){var r=arguments[0],i=arguments[1];if(i.x===r.x&&i.y===r.y)throw new v("Cannot compute the quadrant for two identical points "+r);return i.x>=r.x?i.y>=r.y?e.NE:e.SE:i.y>=r.y?e.NW:e.SW}}}]),e}();Ne.NE=0,Ne.NW=1,Ne.SW=2,Ne.SE=3;var je=function(){function e(){t(this,e),e.constructor_.apply(this,arguments)}return n(e,[{key:"compareDirection",value:function(t){return this._dx===t._dx&&this._dy===t._dy?0:this._quadrant>t._quadrant?1:this._quadrant<t._quadrant?-1:ut.index(t._p0,t._p1,this._p1)}},{key:"getDy",value:function(){return this._dy}},{key:"getCoordinate",value:function(){return this._p0}},{key:"setNode",value:function(t){this._node=t}},{key:"print",value:function(t){var e=Math.atan2(this._dy,this._dx),n=this.getClass().getName(),r=n.lastIndexOf("."),i=n.substring(r+1);t.print("  "+i+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+e+"   "+this._label)}},{key:"compareTo",value:function(t){var e=t;return this.compareDirection(e)}},{key:"getDirectedCoordinate",value:function(){return this._p1}},{key:"getDx",value:function(){return this._dx}},{key:"getLabel",value:function(){return this._label}},{key:"getEdge",value:function(){return this._edge}},{key:"getQuadrant",value:function(){return this._quadrant}},{key:"getNode",value:function(){return this._node}},{key:"toString",value:function(){var t=Math.atan2(this._dy,this._dx),e=this.getClass().getName(),n=e.lastIndexOf(".");return"  "+e.substring(n+1)+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+t+"   "+this._label}},{key:"computeLabel",value:function(t){}},{key:"init",value:function(t,e){this._p0=t,this._p1=e,this._dx=e.x-t.x,this._dy=e.y-t.y,this._quadrant=Ne.quadrant(this._dx,this._dy),D.isTrue(!(0===this._dx&&0===this._dy),"EdgeEnd with identical endpoints found")}},{key:"interfaces_",get:function(){return[_]}}],[{key:"constructor_",value:function(){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,1===arguments.length){var t=arguments[0];this._edge=t}else if(3===arguments.length){var n=arguments[0],r=arguments[1],i=arguments[2];e.constructor_.call(this,n,r,i,null)}else if(4===arguments.length){var o=arguments[0],s=arguments[1],a=arguments[2],l=arguments[3];e.constructor_.call(this,o),this.init(s,a),this._label=l}}}]),e}(),Ge=function(e){r(s,e);var o=c(s);function s(){var e;return t(this,s),e=o.call(this),s.constructor_.apply(u(e),arguments),e}return n(s,[{key:"getNextMin",value:function(){return this._nextMin}},{key:"getDepth",value:function(t){return this._depth[t]}},{key:"setVisited",value:function(t){this._isVisited=t}},{key:"computeDirectedLabel",value:function(){this._label=new Ce(this._edge.getLabel()),this._isForward||this._label.flip()}},{key:"getNext",value:function(){return this._next}},{key:"setDepth",value:function(t,e){if(-999!==this._depth[t]&&this._depth[t]!==e)throw new ht("assigned depths do not match",this.getCoordinate());this._depth[t]=e}},{key:"isInteriorAreaEdge",value:function(){for(var t=!0,e=0;e<2;e++)this._label.isArea(e)&&this._label.getLocation(e,Z.LEFT)===H.INTERIOR&&this._label.getLocation(e,Z.RIGHT)===H.INTERIOR||(t=!1);return t}},{key:"setNextMin",value:function(t){this._nextMin=t}},{key:"print",value:function(t){h(i(s.prototype),"print",this).call(this,t),t.print(" "+this._depth[Z.LEFT]+"/"+this._depth[Z.RIGHT]),t.print(" ("+this.getDepthDelta()+")"),this._isInResult&&t.print(" inResult")}},{key:"setMinEdgeRing",value:function(t){this._minEdgeRing=t}},{key:"isLineEdge",value:function(){var t=this._label.isLine(0)||this._label.isLine(1),e=!this._label.isArea(0)||this._label.allPositionsEqual(0,H.EXTERIOR),n=!this._label.isArea(1)||this._label.allPositionsEqual(1,H.EXTERIOR);return t&&e&&n}},{key:"setEdgeRing",value:function(t){this._edgeRing=t}},{key:"getMinEdgeRing",value:function(){return this._minEdgeRing}},{key:"getDepthDelta",value:function(){var t=this._edge.getDepthDelta();return this._isForward||(t=-t),t}},{key:"setInResult",value:function(t){this._isInResult=t}},{key:"getSym",value:function(){return this._sym}},{key:"isForward",value:function(){return this._isForward}},{key:"getEdge",value:function(){return this._edge}},{key:"printEdge",value:function(t){this.print(t),t.print(" "),this._isForward?this._edge.print(t):this._edge.printReverse(t)}},{key:"setSym",value:function(t){this._sym=t}},{key:"setVisitedEdge",value:function(t){this.setVisited(t),this._sym.setVisited(t)}},{key:"setEdgeDepths",value:function(t,e){var n=this.getEdge().getDepthDelta();this._isForward||(n=-n);var r=1;t===Z.LEFT&&(r=-1);var i=Z.opposite(t),o=e+n*r;this.setDepth(t,e),this.setDepth(i,o)}},{key:"getEdgeRing",value:function(){return this._edgeRing}},{key:"isInResult",value:function(){return this._isInResult}},{key:"setNext",value:function(t){this._next=t}},{key:"isVisited",value:function(){return this._isVisited}}],[{key:"constructor_",value:function(){this._isForward=null,this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999];var t=arguments[0],e=arguments[1];if(je.constructor_.call(this,t),this._isForward=e,e)this.init(t.getCoordinate(0),t.getCoordinate(1));else{var n=t.getNumPoints()-1;this.init(t.getCoordinate(n),t.getCoordinate(n-1))}this.computeDirectedLabel()}},{key:"depthFactor",value:function(t,e){return t===H.EXTERIOR&&e===H.INTERIOR?1:t===H.INTERIOR&&e===H.EXTERIOR?-1:0}}]),s}(je),Ue=function(){function e(){t(this,e)}return n(e,[{key:"createNode",value:function(t){return new Te(t,null)}}]),e}(),ze=function(){function e(){t(this,e),e.constructor_.apply(this,arguments)}return n(e,[{key:"printEdges",value:function(t){t.println("Edges:");for(var e=0;e<this._edges.size();e++){t.println("edge "+e+":");var n=this._edges.get(e);n.print(t),n.eiList.print(t)}}},{key:"find",value:function(t){return this._nodes.find(t)}},{key:"addNode",value:function(){if(arguments[0]instanceof Te){var t=arguments[0];return this._nodes.addNode(t)}if(arguments[0]instanceof G){var e=arguments[0];return this._nodes.addNode(e)}}},{key:"getNodeIterator",value:function(){return this._nodes.iterator()}},{key:"linkResultDirectedEdges",value:function(){for(var t=this._nodes.iterator();t.hasNext();)t.next().getEdges().linkResultDirectedEdges()}},{key:"debugPrintln",value:function(t){mt.out.println(t)}},{key:"isBoundaryNode",value:function(t,e){var n=this._nodes.find(e);if(null===n)return!1;var r=n.getLabel();return null!==r&&r.getLocation(t)===H.BOUNDARY}},{key:"linkAllDirectedEdges",value:function(){for(var t=this._nodes.iterator();t.hasNext();)t.next().getEdges().linkAllDirectedEdges()}},{key:"matchInSameDirection",value:function(t,e,n,r){return!!t.equals(n)&&ut.index(t,e,r)===ut.COLLINEAR&&Ne.quadrant(t,e)===Ne.quadrant(n,r)}},{key:"getEdgeEnds",value:function(){return this._edgeEndList}},{key:"debugPrint",value:function(t){mt.out.print(t)}},{key:"getEdgeIterator",value:function(){return this._edges.iterator()}},{key:"findEdgeInSameDirection",value:function(t,e){for(var n=0;n<this._edges.size();n++){var r=this._edges.get(n),i=r.getCoordinates();if(this.matchInSameDirection(t,e,i[0],i[1]))return r;if(this.matchInSameDirection(t,e,i[i.length-1],i[i.length-2]))return r}return null}},{key:"insertEdge",value:function(t){this._edges.add(t)}},{key:"findEdgeEnd",value:function(t){for(var e=this.getEdgeEnds().iterator();e.hasNext();){var n=e.next();if(n.getEdge()===t)return n}return null}},{key:"addEdges",value:function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this._edges.add(n);var r=new Ge(n,!0),i=new Ge(n,!1);r.setSym(i),i.setSym(r),this.add(r),this.add(i)}}},{key:"add",value:function(t){this._nodes.add(t),this._edgeEndList.add(t)}},{key:"getNodes",value:function(){return this._nodes.values()}},{key:"findEdge",value:function(t,e){for(var n=0;n<this._edges.size();n++){var r=this._edges.get(n),i=r.getCoordinates();if(t.equals(i[0])&&e.equals(i[1]))return r}return null}}],[{key:"constructor_",value:function(){if(this._edges=new ft,this._nodes=null,this._edgeEndList=new ft,0===arguments.length)this._nodes=new Fe(new Ue);else if(1===arguments.length){var t=arguments[0];this._nodes=new Fe(t)}}},{key:"linkResultDirectedEdges",value:function(t){for(var e=t.iterator();e.hasNext();)e.next().getEdges().linkResultDirectedEdges()}}]),e}(),Ve=function(){function e(){t(this,e),e.constructor_.apply(this,arguments)}return n(e,[{key:"sortShellsAndHoles",value:function(t,e,n){for(var r=t.iterator();r.hasNext();){var i=r.next();i.isHole()?n.add(i):e.add(i)}}},{key:"computePolygons",value:function(t){for(var e=new ft,n=t.iterator();n.hasNext();){var r=n.next().toPolygon(this._geometryFactory);e.add(r)}return e}},{key:"placeFreeHoles",value:function(t,n){for(var r=n.iterator();r.hasNext();){var i=r.next();if(null===i.getShell()){var o=e.findEdgeRingContaining(i,t);if(null===o)throw new ht("unable to assign hole to a shell",i.getCoordinate(0));i.setShell(o)}}}},{key:"buildMinimalEdgeRings",value:function(t,e,n){for(var r=new ft,i=t.iterator();i.hasNext();){var o=i.next();if(o.getMaxNodeDegree()>2){o.linkDirectedEdgesForMinimalEdgeRings();var s=o.buildMinimalRings(),a=this.findShell(s);null!==a?(this.placePolygonHoles(a,s),e.add(a)):n.addAll(s)}else r.add(o)}return r}},{key:"buildMaximalEdgeRings",value:function(t){for(var e=new ft,n=t.iterator();n.hasNext();){var r=n.next();if(r.isInResult()&&r.getLabel().isArea()&&null===r.getEdgeRing()){var i=new Me(r,this._geometryFactory);e.add(i),i.setInResult()}}return e}},{key:"placePolygonHoles",value:function(t,e){for(var n=e.iterator();n.hasNext();){var r=n.next();r.isHole()&&r.setShell(t)}}},{key:"getPolygons",value:function(){return this.computePolygons(this._shellList)}},{key:"findShell",value:function(t){for(var e=0,n=null,r=t.iterator();r.hasNext();){var i=r.next();i.isHole()||(n=i,e++)}return D.isTrue(e<=1,"found two shells in MinimalEdgeRing list"),n}},{key:"add",value:function(){if(1===arguments.length){var t=arguments[0];this.add(t.getEdgeEnds(),t.getNodes())}else if(2===arguments.length){var e=arguments[0],n=arguments[1];ze.linkResultDirectedEdges(n);var r=this.buildMaximalEdgeRings(e),i=new ft,o=this.buildMinimalEdgeRings(r,this._shellList,i);this.sortShellsAndHoles(o,this._shellList,i),this.placeFreeHoles(this._shellList,i)}}}],[{key:"constructor_",value:function(){this._geometryFactory=null,this._shellList=new ft;var t=arguments[0];this._geometryFactory=t}},{key:"findEdgeRingContaining",value:function(t,e){for(var n=t.getLinearRing(),r=n.getEnvelopeInternal(),i=n.getCoordinateN(0),o=null,s=null,a=e.iterator();a.hasNext();){var l=a.next(),u=l.getLinearRing(),c=u.getEnvelopeInternal();if(!c.equals(r)&&c.contains(r)){i=Wt.ptNotInList(n.getCoordinates(),u.getCoordinates());var h=!1;xe.isInRing(i,u.getCoordinates())&&(h=!0),h&&(null===o||s.contains(c))&&(s=(o=l).getLinearRing().getEnvelopeInternal())}}return o}}]),e}(),He=function(){function e(){t(this,e)}return n(e,[{key:"getBounds",value:function(){}}]),e}(),qe=function(){function e(){t(this,e),e.constructor_.apply(this,arguments)}return n(e,[{key:"getItem",value:function(){return this._item}},{key:"getBounds",value:function(){return this._bounds}},{key:"interfaces_",get:function(){return[He,x]}}],[{key:"constructor_",value:function(){this._bounds=null,this._item=null;var t=arguments[0],e=arguments[1];this._bounds=t,this._item=e}}]),e}(),We=function(){function e(){t(this,e),e.constructor_.apply(this,arguments)}return n(e,[{key:"poll",value:function(){if(this.isEmpty())return null;var t=this._items.get(1);return this._items.set(1,this._items.get(this._size)),this._size-=1,this.reorder(1),t}},{key:"size",value:function(){return this._size}},{key:"reorder",value:function(t){for(var e=null,n=this._items.get(t);2*t<=this._size&&((e=2*t)!==this._size&&this._items.get(e+1).compareTo(this._items.get(e))<0&&e++,this._items.get(e).compareTo(n)<0);t=e)this._items.set(t,this._items.get(e));this._items.set(t,n)}},{key:"clear",value:function(){this._size=0,this._items.clear()}},{key:"peek",value:function(){return this.isEmpty()?null:this._items.get(1)}},{key:"isEmpty",value:function(){return 0===this._size}},{key:"add",value:function(t){this._items.add(null),this._size+=1;var e=this._size;for(this._items.set(0,t);t.compareTo(this._items.get(Math.trunc(e/2)))<0;e/=2)this._items.set(e,this._items.get(Math.trunc(e/2)));this._items.set(e,t)}}],[{key:"constructor_",value:function(){this._size=null,this._items=null,this._size=0,this._items=new ft,this._items.add(null)}}]),e}(),Je=function(){function e(){t(this,e)}return n(e,[{key:"insert",value:function(t,e){}},{key:"remove",value:function(t,e){}},{key:"query",value:function(){}}]),e}(),Ye=function(){function e(){t(this,e),e.constructor_.apply(this,arguments)}return n(e,[{key:"getLevel",value:function(){return this._level}},{key:"size",value:function(){return this._childBoundables.size()}},{key:"getChildBoundables",value:function(){return this._childBoundables}},{key:"addChildBoundable",value:function(t){D.isTrue(null===this._bounds),this._childBoundables.add(t)}},{key:"isEmpty",value:function(){return this._childBoundables.isEmpty()}},{key:"getBounds",value:function(){return null===this._bounds&&(this._bounds=this.computeBounds()),this._bounds}},{key:"interfaces_",get:function(){return[He,x]}}],[{key:"constructor_",value:function(){if(this._childBoundables=new ft,this._bounds=null,this._level=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this._level=t}}}]),e}(),Xe={reverseOrder:function(){return{compare:function(t,e){return e.compareTo(t)}}},min:function(t){return Xe.sort(t),t.get(0)},sort:function(t,e){var n=t.toArray();e?Rt.sort(n,e):Rt.sort(n);for(var r=t.iterator(),i=0,o=n.length;i<o;i++)r.next(),r.set(n[i])},singletonList:function(t){var e=new ft;return e.add(t),e}},Ke=function(){function e(){t(this,e)}return n(e,null,[{key:"maxDistance",value:function(t,n,r,i,o,s,a,l){var u=e.distance(t,n,o,s);return u=Math.max(u,e.distance(t,n,a,l)),u=Math.max(u,e.distance(r,i,o,s)),Math.max(u,e.distance(r,i,a,l))}},{key:"distance",value:function(t,e,n,r){var i=n-t,o=r-e;return Math.sqrt(i*i+o*o)}},{key:"maximumDistance",value:function(t,n){var r=Math.min(t.getMinX(),n.getMinX()),i=Math.min(t.getMinY(),n.getMinY()),o=Math.max(t.getMaxX(),n.getMaxX()),s=Math.max(t.getMaxY(),n.getMaxY());return e.distance(r,i,o,s)}},{key:"minMaxDistance",value:function(t,n){var r=t.getMinX(),i=t.getMinY(),o=t.getMaxX(),s=t.getMaxY(),a=n.getMinX(),l=n.getMinY(),u=n.getMaxX(),c=n.getMaxY(),h=e.maxDistance(r,i,r,s,a,l,a,c);return h=Math.min(h,e.maxDistance(r,i,r,s,a,l,u,l)),h=Math.min(h,e.maxDistance(r,i,r,s,u,c,a,c)),h=Math.min(h,e.maxDistance(r,i,r,s,u,c,u,l)),h=Math.min(h,e.maxDistance(r,i,o,i,a,l,a,c)),h=Math.min(h,e.maxDistance(r,i,o,i,a,l,u,l)),h=Math.min(h,e.maxDistance(r,i,o,i,u,c,a,c)),h=Math.min(h,e.maxDistance(r,i,o,i,u,c,u,l)),h=Math.min(h,e.maxDistance(o,s,r,s,a,l,a,c)),h=Math.min(h,e.maxDistance(o,s,r,s,a,l,u,l)),h=Math.min(h,e.maxDistance(o,s,r,s,u,c,a,c)),h=Math.min(h,e.maxDistance(o,s,r,s,u,c,u,l)),h=Math.min(h,e.maxDistance(o,s,o,i,a,l,a,c)),h=Math.min(h,e.maxDistance(o,s,o,i,a,l,u,l)),h=Math.min(h,e.maxDistance(o,s,o,i,u,c,a,c)),Math.min(h,e.maxDistance(o,s,o,i,u,c,u,l))}}]),e}(),Ze=function(){function e(){t(this,e),e.constructor_.apply(this,arguments)}return n(e,[{key:"maximumDistance",value:function(){return Ke.maximumDistance(this._boundable1.getBounds(),this._boundable2.getBounds())}},{key:"expandToQueue",value:function(t,n){var r=e.isComposite(this._boundable1),i=e.isComposite(this._boundable2);if(r&&i)return e.area(this._boundable1)>e.area(this._boundable2)?(this.expand(this._boundable1,this._boundable2,!1,t,n),null):(this.expand(this._boundable2,this._boundable1,!0,t,n),null);if(r)return this.expand(this._boundable1,this._boundable2,!1,t,n),null;if(i)return this.expand(this._boundable2,this._boundable1,!0,t,n),null;throw new v("neither boundable is composite")}},{key:"isLeaves",value:function(){return!(e.isComposite(this._boundable1)||e.isComposite(this._boundable2))}},{key:"compareTo",value:function(t){var e=t;return this._distance<e._distance?-1:this._distance>e._distance?1:0}},{key:"expand",value:function(t,n,r,i,o){for(var s=t.getChildBoundables().iterator();s.hasNext();){var a=s.next(),l=null;(l=r?new e(n,a,this._itemDistance):new e(a,n,this._itemDistance)).getDistance()<o&&i.add(l)}}},{key:"getBoundable",value:function(t){return 0===t?this._boundable1:this._boundable2}},{key:"getDistance",value:function(){return this._distance}},{key:"distance",value:function(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())}},{key:"interfaces_",get:function(){return[_]}}],[{key:"constructor_",value:function(){this._boundable1=null,this._boundable2=null,this._distance=null,this._itemDistance=null;var t=arguments[0],e=arguments[1],n=arguments[2];this._boundable1=t,this._boundable2=e,this._itemDistance=n,this._distance=this.distance()}},{key:"area",value:function(t){return t.getBounds().getArea()}},{key:"isComposite",value:function(t){return t instanceof Ye}}]),e}(),Qe=function(){function e(){t(this,e)}return n(e,[{key:"visitItem",value:function(t){}}]),e}(),$e=function(){function e(){t(this,e),e.constructor_.apply(this,arguments)}return n(e,[{key:"queryInternal",value:function(){if(nt(arguments[2],Qe)&&arguments[0]instanceof Object&&arguments[1]instanceof Ye)for(var t=arguments[0],e=arguments[2],n=arguments[1].getChildBoundables(),r=0;r<n.size();r++){var i=n.get(r);this.getIntersectsOp().intersects(i.getBounds(),t)&&(i instanceof Ye?this.queryInternal(t,i,e):i instanceof qe?e.visitItem(i.getItem()):D.shouldNeverReachHere())}else if(nt(arguments[2],tt)&&arguments[0]instanceof Object&&arguments[1]instanceof Ye)for(var o=arguments[0],s=arguments[2],a=arguments[1].getChildBoundables(),l=0;l<a.size();l++){var u=a.get(l);this.getIntersectsOp().intersects(u.getBounds(),o)&&(u instanceof Ye?this.queryInternal(o,u,s):u instanceof qe?s.add(u.getItem()):D.shouldNeverReachHere())}}},{key:"getNodeCapacity",value:function(){return this._nodeCapacity}},{key:"lastNode",value:function(t){return t.get(t.size()-1)}},{key:"size",value:function(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.size(this._root));if(1===arguments.length){for(var t=0,e=arguments[0].getChildBoundables().iterator();e.hasNext();){var n=e.next();n instanceof Ye?t+=this.size(n):n instanceof qe&&(t+=1)}return t}}},{key:"removeItem",value:function(t,e){for(var n=null,r=t.getChildBoundables().iterator();r.hasNext();){var i=r.next();i instanceof qe&&i.getItem()===e&&(n=i)}return null!==n&&(t.getChildBoundables().remove(n),!0)}},{key:"itemsTree",value:function(){if(0===arguments.length){this.build();var t=this.itemsTree(this._root);return null===t?new ft:t}if(1===arguments.length){for(var e=arguments[0],n=new ft,r=e.getChildBoundables().iterator();r.hasNext();){var i=r.next();if(i instanceof Ye){var o=this.itemsTree(i);null!==o&&n.add(o)}else i instanceof qe?n.add(i.getItem()):D.shouldNeverReachHere()}return n.size()<=0?null:n}}},{key:"insert",value:function(t,e){D.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built."),this._itemBoundables.add(new qe(t,e))}},{key:"boundablesAtLevel",value:function(){if(1===arguments.length){var t=arguments[0],e=new ft;return this.boundablesAtLevel(t,this._root,e),e}if(3===arguments.length){var n=arguments[0],r=arguments[1],i=arguments[2];if(D.isTrue(n>-2),r.getLevel()===n)return i.add(r),null;for(var o=r.getChildBoundables().iterator();o.hasNext();){var s=o.next();s instanceof Ye?this.boundablesAtLevel(n,s,i):(D.isTrue(s instanceof qe),-1===n&&i.add(s))}return null}}},{key:"query",value:function(){if(1===arguments.length){var t=arguments[0];this.build();var e=new ft;return this.isEmpty()||this.getIntersectsOp().intersects(this._root.getBounds(),t)&&this.queryInternal(t,this._root,e),e}if(2===arguments.length){var n=arguments[0],r=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),n)&&this.queryInternal(n,this._root,r)}}},{key:"build",value:function(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1),this._itemBoundables=null,this._built=!0}},{key:"getRoot",value:function(){return this.build(),this._root}},{key:"remove",value:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return this.build(),!!this.getIntersectsOp().intersects(this._root.getBounds(),t)&&this.remove(t,this._root,e)}if(3===arguments.length){var n=arguments[0],r=arguments[1],i=arguments[2],o=this.removeItem(r,i);if(o)return!0;for(var s=null,a=r.getChildBoundables().iterator();a.hasNext();){var l=a.next();if(this.getIntersectsOp().intersects(l.getBounds(),n)&&l instanceof Ye&&(o=this.remove(n,l,i))){s=l;break}}return null!==s&&s.getChildBoundables().isEmpty()&&r.getChildBoundables().remove(s),o}}},{key:"createHigherLevels",value:function(t,e){D.isTrue(!t.isEmpty());var n=this.createParentBoundables(t,e+1);return 1===n.size()?n.get(0):this.createHigherLevels(n,e+1)}},{key:"depth",value:function(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(1===arguments.length){for(var t=0,e=arguments[0].getChildBoundables().iterator();e.hasNext();){var n=e.next();if(n instanceof Ye){var r=this.depth(n);r>t&&(t=r)}}return t+1}}},{key:"createParentBoundables",value:function(t,e){D.isTrue(!t.isEmpty());var n=new ft;n.add(this.createNode(e));var r=new ft(t);Xe.sort(r,this.getComparator());for(var i=r.iterator();i.hasNext();){var o=i.next();this.lastNode(n).getChildBoundables().size()===this.getNodeCapacity()&&n.add(this.createNode(e)),this.lastNode(n).addChildBoundable(o)}return n}},{key:"isEmpty",value:function(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()}},{key:"interfaces_",get:function(){return[x]}}],[{key:"constructor_",value:function(){if(this._root=null,this._built=!1,this._itemBoundables=new ft,this._nodeCapacity=null,0===arguments.length)e.constructor_.call(this,e.DEFAULT_NODE_CAPACITY);else if(1===arguments.length){var t=arguments[0];D.isTrue(t>1,"Node capacity must be greater than 1"),this._nodeCapacity=t}}},{key:"compareDoubles",value:function(t,e){return t>e?1:t<e?-1:0}}]),e}();$e.IntersectsOp=function(){},$e.DEFAULT_NODE_CAPACITY=10;var tn=function(){function e(){t(this,e)}return n(e,[{key:"distance",value:function(t,e){}}]),e}(),en=function(e){r(s,e);var o=c(s);function s(){var e;return t(this,s),e=o.call(this),s.constructor_.apply(u(e),arguments),e}return n(s,[{key:"createParentBoundablesFromVerticalSlices",value:function(t,e){D.isTrue(t.length>0);for(var n=new ft,r=0;r<t.length;r++)n.addAll(this.createParentBoundablesFromVerticalSlice(t[r],e));return n}},{key:"nearestNeighbourK",value:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return this.nearestNeighbourK(t,R.POSITIVE_INFINITY,e)}if(3===arguments.length){var n=arguments[0],r=arguments[2],i=arguments[1],o=new We;o.add(n);for(var a=new We;!o.isEmpty()&&i>=0;){var l=o.poll(),u=l.getDistance();if(u>=i)break;l.isLeaves()?a.size()<r?a.add(l):(a.peek().getDistance()>u&&(a.poll(),a.add(l)),i=a.peek().getDistance()):l.expandToQueue(o,i)}return s.getItems(a)}}},{key:"createNode",value:function(t){return new nn(t)}},{key:"size",value:function(){return 0===arguments.length?h(i(s.prototype),"size",this).call(this):h(i(s.prototype),"size",this).apply(this,arguments)}},{key:"insert",value:function(){if(!(2===arguments.length&&arguments[1]instanceof Object&&arguments[0]instanceof z))return h(i(s.prototype),"insert",this).apply(this,arguments);var t=arguments[0],e=arguments[1];if(t.isNull())return null;h(i(s.prototype),"insert",this).call(this,t,e)}},{key:"getIntersectsOp",value:function(){return s.intersectsOp}},{key:"verticalSlices",value:function(t,e){for(var n=Math.trunc(Math.ceil(t.size()/e)),r=new Array(e).fill(null),i=t.iterator(),o=0;o<e;o++){r[o]=new ft;for(var s=0;i.hasNext()&&s<n;){var a=i.next();r[o].add(a),s++}}return r}},{key:"query",value:function(){if(1===arguments.length){var t=arguments[0];return h(i(s.prototype),"query",this).call(this,t)}if(2===arguments.length){var e=arguments[0],n=arguments[1];h(i(s.prototype),"query",this).call(this,e,n)}}},{key:"getComparator",value:function(){return s.yComparator}},{key:"createParentBoundablesFromVerticalSlice",value:function(t,e){return h(i(s.prototype),"createParentBoundables",this).call(this,t,e)}},{key:"remove",value:function(){if(2===arguments.length&&arguments[1]instanceof Object&&arguments[0]instanceof z){var t=arguments[0],e=arguments[1];return h(i(s.prototype),"remove",this).call(this,t,e)}return h(i(s.prototype),"remove",this).apply(this,arguments)}},{key:"depth",value:function(){return 0===arguments.length?h(i(s.prototype),"depth",this).call(this):h(i(s.prototype),"depth",this).apply(this,arguments)}},{key:"createParentBoundables",value:function(t,e){D.isTrue(!t.isEmpty());var n=Math.trunc(Math.ceil(t.size()/this.getNodeCapacity())),r=new ft(t);Xe.sort(r,s.xComparator);var i=this.verticalSlices(r,Math.trunc(Math.ceil(Math.sqrt(n))));return this.createParentBoundablesFromVerticalSlices(i,e)}},{key:"nearestNeighbour",value:function(){if(1===arguments.length){if(nt(arguments[0],tn)){var t=arguments[0];if(this.isEmpty())return null;var e=new Ze(this.getRoot(),this.getRoot(),t);return this.nearestNeighbour(e)}if(arguments[0]instanceof Ze){var n=arguments[0],r=R.POSITIVE_INFINITY,i=null,o=new We;for(o.add(n);!o.isEmpty()&&r>0;){var s=o.poll(),a=s.getDistance();if(a>=r)break;s.isLeaves()?(r=a,i=s):s.expandToQueue(o,r)}return null===i?null:[i.getBoundable(0).getItem(),i.getBoundable(1).getItem()]}}else{if(2===arguments.length){var l=arguments[0],u=arguments[1];if(this.isEmpty()||l.isEmpty())return null;var c=new Ze(this.getRoot(),l.getRoot(),u);return this.nearestNeighbour(c)}if(3===arguments.length){var h=arguments[2],d=new qe(arguments[0],arguments[1]),f=new Ze(this.getRoot(),d,h);return this.nearestNeighbour(f)[0]}if(4===arguments.length){var p=arguments[2],g=arguments[3],y=new qe(arguments[0],arguments[1]),m=new Ze(this.getRoot(),y,p);return this.nearestNeighbourK(m,g)}}}},{key:"isWithinDistance",value:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],n=R.POSITIVE_INFINITY,r=new We;for(r.add(t);!r.isEmpty();){var i=r.poll(),o=i.getDistance();if(o>e)return!1;if(i.maximumDistance()<=e)return!0;if(i.isLeaves()){if((n=o)<=e)return!0}else i.expandToQueue(r,n)}return!1}if(3===arguments.length){var s=arguments[0],a=arguments[1],l=arguments[2],u=new Ze(this.getRoot(),s.getRoot(),a);return this.isWithinDistance(u,l)}}},{key:"interfaces_",get:function(){return[Je,x]}}],[{key:"constructor_",value:function(){if(0===arguments.length)s.constructor_.call(this,s.DEFAULT_NODE_CAPACITY);else if(1===arguments.length){var t=arguments[0];$e.constructor_.call(this,t)}}},{key:"centreX",value:function(t){return s.avg(t.getMinX(),t.getMaxX())}},{key:"avg",value:function(t,e){return(t+e)/2}},{key:"getItems",value:function(t){for(var e=new Array(t.size()).fill(null),n=0;!t.isEmpty();){var r=t.poll();e[n]=r.getBoundable(0).getItem(),n++}return e}},{key:"centreY",value:function(t){return s.avg(t.getMinY(),t.getMaxY())}}]),s}($e),nn=function(e){r(o,e);var i=c(o);function o(){var e;return t(this,o),e=i.call(this),o.constructor_.apply(u(e),arguments),e}return n(o,[{key:"computeBounds",value:function(){for(var t=null,e=this.getChildBoundables().iterator();e.hasNext();){var n=e.next();null===t?t=new z(n.getBounds()):t.expandToInclude(n.getBounds())}return t}}],[{key:"constructor_",value:function(){var t=arguments[0];Ye.constructor_.call(this,t)}}]),o}(Ye);en.STRtreeNode=nn,en.xComparator=new(function(){function e(){t(this,e)}return n(e,[{key:"interfaces_",get:function(){return[B]}},{key:"compare",value:function(t,e){return $e.compareDoubles(en.centreX(t.getBounds()),en.centreX(e.getBounds()))}}]),e}()),en.yComparator=new(function(){function e(){t(this,e)}return n(e,[{key:"interfaces_",get:function(){return[B]}},{key:"compare",value:function(t,e){return $e.compareDoubles(en.centreY(t.getBounds()),en.centreY(e.getBounds()))}}]),e}()),en.intersectsOp=new(function(){function e(){t(this,e)}return n(e,[{key:"interfaces_",get:function(){return[IntersectsOp]}},{key:"intersects",value:function(t,e){return t.intersects(e)}}]),e}()),en.DEFAULT_NODE_CAPACITY=10;var rn=function(){function e(){t(this,e)}return n(e,null,[{key:"relativeSign",value:function(t,e){return t<e?-1:t>e?1:0}},{key:"compare",value:function(t,n,r){if(n.equals2D(r))return 0;var i=e.relativeSign(n.x,r.x),o=e.relativeSign(n.y,r.y);switch(t){case 0:return e.compareValue(i,o);case 1:return e.compareValue(o,i);case 2:return e.compareValue(o,-i);case 3:return e.compareValue(-i,o);case 4:return e.compareValue(-i,-o);case 5:return e.compareValue(-o,-i);case 6:return e.compareValue(-o,i);case 7:return e.compareValue(i,-o)}return D.shouldNeverReachHere("invalid octant value"),0}},{key:"compareValue",value:function(t,e){return t<0?-1:t>0?1:e<0?-1:e>0?1:0}}]),e}(),on=function(){function e(){t(this,e),e.constructor_.apply(this,arguments)}return n(e,[{key:"getCoordinate",value:function(){return this.coord}},{key:"print",value:function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex)}},{key:"compareTo",value:function(t){var e=t;return this.segmentIndex<e.segmentIndex?-1:this.segmentIndex>e.segmentIndex?1:this.coord.equals2D(e.coord)?0:this._isInterior?e._isInterior?rn.compare(this._segmentOctant,this.coord,e.coord):1:-1}},{key:"isEndPoint",value:function(t){return 0===this.segmentIndex&&!this._isInterior||this.segmentIndex===t}},{key:"toString",value:function(){return this.segmentIndex+":"+this.coord.toString()}},{key:"isInterior",value:function(){return this._isInterior}},{key:"interfaces_",get:function(){return[_]}}],[{key:"constructor_",value:function(){this._segString=null,this.coord=null,this.segmentIndex=null,this._segmentOctant=null,this._isInterior=null;var t=arguments[0],e=arguments[1],n=arguments[2],r=arguments[3];this._segString=t,this.coord=new G(e),this.segmentIndex=n,this._segmentOctant=r,this._isInterior=!e.equals2D(t.getCoordinate(n))}}]),e}(),sn=function(){function e(){t(this,e)}return n(e,[{key:"hasNext",value:function(){}},{key:"next",value:function(){}},{key:"remove",value:function(){}}]),e}(),an=function(){function e(){t(this,e),e.constructor_.apply(this,arguments)}return n(e,[{key:"getSplitCoordinates",value:function(){var t=new qt;this.addEndpoints();for(var e=this.iterator(),n=e.next();e.hasNext();){var r=e.next();this.addEdgeCoordinates(n,r,t),n=r}return t.toCoordinateArray()}},{key:"addCollapsedNodes",value:function(){var t=new ft;this.findCollapsesFromInsertedNodes(t),this.findCollapsesFromExistingVertices(t);for(var e=t.iterator();e.hasNext();){var n=e.next().intValue();this.add(this._edge.getCoordinate(n),n)}}},{key:"createSplitEdgePts",value:function(t,e){var n=e.segmentIndex-t.segmentIndex+2;if(2===n)return[new G(t.coord),new G(e.coord)];var r=this._edge.getCoordinate(e.segmentIndex),i=e.isInterior()||!e.coord.equals2D(r);i||n--;var o=new Array(n).fill(null),s=0;o[s++]=new G(t.coord);for(var a=t.segmentIndex+1;a<=e.segmentIndex;a++)o[s++]=this._edge.getCoordinate(a);return i&&(o[s]=new G(e.coord)),o}},{key:"print",value:function(t){t.println("Intersections:");for(var e=this.iterator();e.hasNext();)e.next().print(t)}},{key:"findCollapsesFromExistingVertices",value:function(t){for(var e=0;e<this._edge.size()-2;e++){var n=this._edge.getCoordinate(e);this._edge.getCoordinate(e+1);var r=this._edge.getCoordinate(e+2);n.equals2D(r)&&t.add(it.valueOf(e+1))}}},{key:"addEdgeCoordinates",value:function(t,e,n){var r=this.createSplitEdgePts(t,e);n.add(r,!1)}},{key:"iterator",value:function(){return this._nodeMap.values().iterator()}},{key:"addSplitEdges",value:function(t){this.addEndpoints(),this.addCollapsedNodes();for(var e=this.iterator(),n=e.next();e.hasNext();){var r=e.next(),i=this.createSplitEdge(n,r);t.add(i),n=r}}},{key:"findCollapseIndex",value:function(t,e,n){if(!t.coord.equals2D(e.coord))return!1;var r=e.segmentIndex-t.segmentIndex;return e.isInterior()||r--,1===r&&(n[0]=t.segmentIndex+1,!0)}},{key:"findCollapsesFromInsertedNodes",value:function(t){for(var e=new Array(1).fill(null),n=this.iterator(),r=n.next();n.hasNext();){var i=n.next();this.findCollapseIndex(r,i,e)&&t.add(it.valueOf(e[0])),r=i}}},{key:"getEdge",value:function(){return this._edge}},{key:"addEndpoints",value:function(){var t=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0),this.add(this._edge.getCoordinate(t),t)}},{key:"createSplitEdge",value:function(t,e){var n=this.createSplitEdgePts(t,e);return new hn(n,this._edge.getData())}},{key:"add",value:function(t,e){var n=new on(this._edge,t,e,this._edge.getSegmentOctant(e)),r=this._nodeMap.get(n);return null!==r?(D.isTrue(r.coord.equals2D(t),"Found equal nodes with different coordinates"),r):(this._nodeMap.put(n,n),n)}},{key:"checkSplitEdgesCorrectness",value:function(t){var e=this._edge.getCoordinates(),n=t.get(0).getCoordinate(0);if(!n.equals2D(e[0]))throw new L("bad split edge start point at "+n);var r=t.get(t.size()-1).getCoordinates(),i=r[r.length-1];if(!i.equals2D(e[e.length-1]))throw new L("bad split edge end point at "+i)}}],[{key:"constructor_",value:function(){this._nodeMap=new De,this._edge=null;var t=arguments[0];this._edge=t}}]),e}(),ln=function(){function e(){t(this,e)}return n(e,null,[{key:"octant",value:function(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],n=arguments[1];if(0===t&&0===n)throw new v("Cannot compute the octant for point ( "+t+", "+n+" )");var r=Math.abs(t),i=Math.abs(n);return t>=0?n>=0?r>=i?0:1:r>=i?7:6:n>=0?r>=i?3:2:r>=i?4:5}if(arguments[0]instanceof G&&arguments[1]instanceof G){var o=arguments[0],s=arguments[1],a=s.x-o.x,l=s.y-o.y;if(0===a&&0===l)throw new v("Cannot compute the octant for two identical points "+o);return e.octant(a,l)}}}]),e}(),un=function(){function e(){t(this,e)}return n(e,[{key:"getCoordinates",value:function(){}},{key:"size",value:function(){}},{key:"getCoordinate",value:function(t){}},{key:"isClosed",value:function(){}},{key:"setData",value:function(t){}},{key:"getData",value:function(){}}]),e}(),cn=function(){function e(){t(this,e)}return n(e,[{key:"addIntersection",value:function(t,e){}},{key:"interfaces_",get:function(){return[un]}}]),e}(),hn=function(){function e(){t(this,e),e.constructor_.apply(this,arguments)}return n(e,[{key:"getCoordinates",value:function(){return this._pts}},{key:"size",value:function(){return this._pts.length}},{key:"getCoordinate",value:function(t){return this._pts[t]}},{key:"isClosed",value:function(){return this._pts[0].equals(this._pts[this._pts.length-1])}},{key:"getSegmentOctant",value:function(t){return t===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(t),this.getCoordinate(t+1))}},{key:"setData",value:function(t){this._data=t}},{key:"safeOctant",value:function(t,e){return t.equals2D(e)?0:ln.octant(t,e)}},{key:"getData",value:function(){return this._data}},{key:"addIntersection",value:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];this.addIntersectionNode(t,e)}else if(4===arguments.length){var n=arguments[1],r=arguments[3],i=new G(arguments[0].getIntersection(r));this.addIntersection(i,n)}}},{key:"toString",value:function(){return ve.toLineString(new Kt(this._pts))}},{key:"getNodeList",value:function(){return this._nodeList}},{key:"addIntersectionNode",value:function(t,e){var n=e,r=n+1;if(r<this._pts.length){var i=this._pts[r];t.equals2D(i)&&(n=r)}return this._nodeList.add(t,n)}},{key:"addIntersections",value:function(t,e,n){for(var r=0;r<t.getIntersectionNum();r++)this.addIntersection(t,e,n,r)}},{key:"interfaces_",get:function(){return[cn]}}],[{key:"constructor_",value:function(){this._nodeList=new an(this),this._pts=null,this._data=null;var t=arguments[0],e=arguments[1];this._pts=t,this._data=e}},{key:"getNodedSubstrings",value:function(){if(1===arguments.length){var t=arguments[0],n=new ft;return e.getNodedSubstrings(t,n),n}if(2===arguments.length)for(var r=arguments[1],i=arguments[0].iterator();i.hasNext();)i.next().getNodeList().addSplitEdges(r)}}]),e}(),dn=function(){function e(){t(this,e),e.constructor_.apply(this,arguments)}return n(e,[{key:"minX",value:function(){return Math.min(this.p0.x,this.p1.x)}},{key:"orientationIndex",value:function(){if(arguments[0]instanceof e){var t=arguments[0],n=ut.index(this.p0,this.p1,t.p0),r=ut.index(this.p0,this.p1,t.p1);return n>=0&&r>=0||n<=0&&r<=0?Math.max(n,r):0}if(arguments[0]instanceof G){var i=arguments[0];return ut.index(this.p0,this.p1,i)}}},{key:"toGeometry",value:function(t){return t.createLineString([this.p0,this.p1])}},{key:"isVertical",value:function(){return this.p0.x===this.p1.x}},{key:"equals",value:function(t){if(!(t instanceof e))return!1;var n=t;return this.p0.equals(n.p0)&&this.p1.equals(n.p1)}},{key:"intersection",value:function(t){var e=new _e;return e.computeIntersection(this.p0,this.p1,t.p0,t.p1),e.hasIntersection()?e.getIntersection(0):null}},{key:"project",value:function(){if(arguments[0]instanceof G){var t=arguments[0];if(t.equals(this.p0)||t.equals(this.p1))return new G(t);var n=this.projectionFactor(t),r=new G;return r.x=this.p0.x+n*(this.p1.x-this.p0.x),r.y=this.p0.y+n*(this.p1.y-this.p0.y),r}if(arguments[0]instanceof e){var i=arguments[0],o=this.projectionFactor(i.p0),s=this.projectionFactor(i.p1);if(o>=1&&s>=1)return null;if(o<=0&&s<=0)return null;var a=this.project(i.p0);o<0&&(a=this.p0),o>1&&(a=this.p1);var l=this.project(i.p1);return s<0&&(l=this.p0),s>1&&(l=this.p1),new e(a,l)}}},{key:"normalize",value:function(){this.p1.compareTo(this.p0)<0&&this.reverse()}},{key:"angle",value:function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)}},{key:"getCoordinate",value:function(t){return 0===t?this.p0:this.p1}},{key:"distancePerpendicular",value:function(t){return bt.pointToLinePerpendicular(t,this.p0,this.p1)}},{key:"minY",value:function(){return Math.min(this.p0.y,this.p1.y)}},{key:"midPoint",value:function(){return e.midPoint(this.p0,this.p1)}},{key:"projectionFactor",value:function(t){if(t.equals(this.p0))return 0;if(t.equals(this.p1))return 1;var e=this.p1.x-this.p0.x,n=this.p1.y-this.p0.y,r=e*e+n*n;return r<=0?R.NaN:((t.x-this.p0.x)*e+(t.y-this.p0.y)*n)/r}},{key:"closestPoints",value:function(t){var e=this.intersection(t);if(null!==e)return[e,e];var n=new Array(2).fill(null),r=R.MAX_VALUE,i=null,o=this.closestPoint(t.p0);r=o.distance(t.p0),n[0]=o,n[1]=t.p0;var s=this.closestPoint(t.p1);(i=s.distance(t.p1))<r&&(r=i,n[0]=s,n[1]=t.p1);var a=t.closestPoint(this.p0);(i=a.distance(this.p0))<r&&(r=i,n[0]=this.p0,n[1]=a);var l=t.closestPoint(this.p1);return(i=l.distance(this.p1))<r&&(r=i,n[0]=this.p1,n[1]=l),n}},{key:"closestPoint",value:function(t){var e=this.projectionFactor(t);return e>0&&e<1?this.project(t):this.p0.distance(t)<this.p1.distance(t)?this.p0:this.p1}},{key:"maxX",value:function(){return Math.max(this.p0.x,this.p1.x)}},{key:"getLength",value:function(){return this.p0.distance(this.p1)}},{key:"compareTo",value:function(t){var e=t,n=this.p0.compareTo(e.p0);return 0!==n?n:this.p1.compareTo(e.p1)}},{key:"reverse",value:function(){var t=this.p0;this.p0=this.p1,this.p1=t}},{key:"equalsTopo",value:function(t){return this.p0.equals(t.p0)&&this.p1.equals(t.p1)||this.p0.equals(t.p1)&&this.p1.equals(t.p0)}},{key:"lineIntersection",value:function(t){return yt.intersection(this.p0,this.p1,t.p0,t.p1)}},{key:"maxY",value:function(){return Math.max(this.p0.y,this.p1.y)}},{key:"pointAlongOffset",value:function(t,e){var n=this.p0.x+t*(this.p1.x-this.p0.x),r=this.p0.y+t*(this.p1.y-this.p0.y),i=this.p1.x-this.p0.x,o=this.p1.y-this.p0.y,s=Math.sqrt(i*i+o*o),a=0,l=0;if(0!==e){if(s<=0)throw new IllegalStateException("Cannot compute offset from zero-length line segment");a=e*i/s,l=e*o/s}return new G(n-l,r+a)}},{key:"setCoordinates",value:function(){if(1===arguments.length){var t=arguments[0];this.setCoordinates(t.p0,t.p1)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.p0.x=e.x,this.p0.y=e.y,this.p1.x=n.x,this.p1.y=n.y}}},{key:"segmentFraction",value:function(t){var e=this.projectionFactor(t);return e<0?e=0:(e>1||R.isNaN(e))&&(e=1),e}},{key:"toString",value:function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"}},{key:"isHorizontal",value:function(){return this.p0.y===this.p1.y}},{key:"reflect",value:function(t){var e=this.p1.getY()-this.p0.getY(),n=this.p0.getX()-this.p1.getX(),r=this.p0.getY()*(this.p1.getX()-this.p0.getX())-this.p0.getX()*(this.p1.getY()-this.p0.getY()),i=e*e+n*n,o=e*e-n*n,s=t.getX(),a=t.getY();return new G((-o*s-2*e*n*a-2*e*r)/i,(o*a-2*e*n*s-2*n*r)/i)}},{key:"distance",value:function(){if(arguments[0]instanceof e){var t=arguments[0];return bt.segmentToSegment(this.p0,this.p1,t.p0,t.p1)}if(arguments[0]instanceof G){var n=arguments[0];return bt.pointToSegment(n,this.p0,this.p1)}}},{key:"pointAlong",value:function(t){var e=new G;return e.x=this.p0.x+t*(this.p1.x-this.p0.x),e.y=this.p0.y+t*(this.p1.y-this.p0.y),e}},{key:"hashCode",value:function(){var t=R.doubleToLongBits(this.p0.x);t^=31*R.doubleToLongBits(this.p0.y);var e=Math.trunc(t)^Math.trunc(t>>32),n=R.doubleToLongBits(this.p1.x);return n^=31*R.doubleToLongBits(this.p1.y),e^Math.trunc(n)^Math.trunc(n>>32)}},{key:"interfaces_",get:function(){return[_,x]}}],[{key:"constructor_",value:function(){if(this.p0=null,this.p1=null,0===arguments.length)e.constructor_.call(this,new G,new G);else if(1===arguments.length){var t=arguments[0];e.constructor_.call(this,t.p0,t.p1)}else if(2===arguments.length){var n=arguments[0],r=arguments[1];this.p0=n,this.p1=r}else if(4===arguments.length){var i=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3];e.constructor_.call(this,new G(i,o),new G(s,a))}}},{key:"midPoint",value:function(t,e){return new G((t.x+e.x)/2,(t.y+e.y)/2)}}]),e}(),fn=function(){function e(){t(this,e),e.constructor_.apply(this,arguments)}return n(e,[{key:"overlap",value:function(){if(2===arguments.length);else if(4===arguments.length){var t=arguments[1],e=arguments[2],n=arguments[3];arguments[0].getLineSegment(t,this._overlapSeg1),e.getLineSegment(n,this._overlapSeg2),this.overlap(this._overlapSeg1,this._overlapSeg2)}}}],[{key:"constructor_",value:function(){this._overlapSeg1=new dn,this._overlapSeg2=new dn}}]),e}(),pn=function(){function e(){t(this,e),e.constructor_.apply(this,arguments)}return n(e,[{key:"getLineSegment",value:function(t,e){e.p0=this._pts[t],e.p1=this._pts[t+1]}},{key:"computeSelect",value:function(t,e,n,r){var i=this._pts[e],o=this._pts[n];if(n-e==1)return r.select(this,e),null;if(!t.intersects(i,o))return null;var s=Math.trunc((e+n)/2);e<s&&this.computeSelect(t,e,s,r),s<n&&this.computeSelect(t,s,n,r)}},{key:"getCoordinates",value:function(){for(var t=new Array(this._end-this._start+1).fill(null),e=0,n=this._start;n<=this._end;n++)t[e++]=this._pts[n];return t}},{key:"computeOverlaps",value:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];this.computeOverlaps(this._start,this._end,t,t._start,t._end,e)}else if(6===arguments.length){var n=arguments[0],r=arguments[1],i=arguments[2],o=arguments[3],s=arguments[4],a=arguments[5];if(r-n==1&&s-o==1)return a.overlap(this,n,i,o),null;if(!this.overlaps(n,r,i,o,s))return null;var l=Math.trunc((n+r)/2),u=Math.trunc((o+s)/2);n<l&&(o<u&&this.computeOverlaps(n,l,i,o,u,a),u<s&&this.computeOverlaps(n,l,i,u,s,a)),l<r&&(o<u&&this.computeOverlaps(l,r,i,o,u,a),u<s&&this.computeOverlaps(l,r,i,u,s,a))}}},{key:"setId",value:function(t){this._id=t}},{key:"select",value:function(t,e){this.computeSelect(t,this._start,this._end,e)}},{key:"getEnvelope",value:function(){if(null===this._env){var t=this._pts[this._start],e=this._pts[this._end];this._env=new z(t,e)}return this._env}},{key:"overlaps",value:function(t,e,n,r,i){return z.intersects(this._pts[t],this._pts[e],n._pts[r],n._pts[i])}},{key:"getEndIndex",value:function(){return this._end}},{key:"getStartIndex",value:function(){return this._start}},{key:"getContext",value:function(){return this._context}},{key:"getId",value:function(){return this._id}}],[{key:"constructor_",value:function(){this._pts=null,this._start=null,this._end=null,this._env=null,this._context=null,this._id=null;var t=arguments[0],e=arguments[1],n=arguments[2],r=arguments[3];this._pts=t,this._start=e,this._end=n,this._context=r}}]),e}(),gn=function(){function e(){t(this,e)}return n(e,null,[{key:"findChainEnd",value:function(t,e){for(var n=e;n<t.length-1&&t[n].equals2D(t[n+1]);)n++;if(n>=t.length-1)return t.length-1;for(var r=Ne.quadrant(t[n],t[n+1]),i=e+1;i<t.length&&(t[i-1].equals2D(t[i])||Ne.quadrant(t[i-1],t[i])===r);)i++;return i-1}},{key:"getChains",value:function(){if(1===arguments.length){var t=arguments[0];return e.getChains(t,null)}if(2===arguments.length){var n=arguments[0],r=arguments[1],i=new ft,o=0;do{var s=e.findChainEnd(n,o),a=new pn(n,o,s,r);i.add(a),o=s}while(o<n.length-1);return i}}}]),e}(),yn=function(){function e(){t(this,e)}return n(e,[{key:"computeNodes",value:function(t){}},{key:"getNodedSubstrings",value:function(){}}]),e}(),mn=function(){function e(){t(this,e),e.constructor_.apply(this,arguments)}return n(e,[{key:"setSegmentIntersector",value:function(t){this._segInt=t}},{key:"interfaces_",get:function(){return[yn]}}],[{key:"constructor_",value:function(){if(this._segInt=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this.setSegmentIntersector(t)}}}]),e}(),vn=function(e){r(o,e);var i=c(o);function o(){var e;return t(this,o),e=i.call(this),o.constructor_.apply(u(e),arguments),e}return n(o,[{key:"getMonotoneChains",value:function(){return this._monoChains}},{key:"getNodedSubstrings",value:function(){return hn.getNodedSubstrings(this._nodedSegStrings)}},{key:"getIndex",value:function(){return this._index}},{key:"add",value:function(t){for(var e=gn.getChains(t.getCoordinates(),t).iterator();e.hasNext();){var n=e.next();n.setId(this._idCounter++),this._index.insert(n.getEnvelope(),n),this._monoChains.add(n)}}},{key:"computeNodes",value:function(t){this._nodedSegStrings=t;for(var e=t.iterator();e.hasNext();)this.add(e.next());this.intersectChains()}},{key:"intersectChains",value:function(){for(var t=new bn(this._segInt),e=this._monoChains.iterator();e.hasNext();)for(var n=e.next(),r=this._index.query(n.getEnvelope()).iterator();r.hasNext();){var i=r.next();if(i.getId()>n.getId()&&(n.computeOverlaps(i,t),this._nOverlaps++),this._segInt.isDone())return null}}}],[{key:"constructor_",value:function(){if(this._monoChains=new ft,this._index=new en,this._idCounter=0,this._nodedSegStrings=null,this._nOverlaps=0,0===arguments.length);else if(1===arguments.length){var t=arguments[0];mn.constructor_.call(this,t)}}}]),o}(mn),bn=function(e){r(s,e);var o=c(s);function s(){var e;return t(this,s),e=o.call(this),s.constructor_.apply(u(e),arguments),e}return n(s,[{key:"overlap",value:function(){if(4!==arguments.length)return h(i(s.prototype),"overlap",this).apply(this,arguments);var t=arguments[1],e=arguments[2],n=arguments[3],r=arguments[0].getContext(),o=e.getContext();this._si.processIntersections(r,t,o,n)}}],[{key:"constructor_",value:function(){this._si=null;var t=arguments[0];this._si=t}}]),s}(fn);vn.SegmentOverlapAction=bn;var _n=function(){function e(){t(this,e),e.constructor_.apply(this,arguments)}return n(e,[{key:"isDeletable",value:function(t,e,n,r){var i=this._inputLine[t],o=this._inputLine[e],s=this._inputLine[n];return!!this.isConcave(i,o,s)&&!!this.isShallow(i,o,s,r)&&this.isShallowSampled(i,o,t,n,r)}},{key:"deleteShallowConcavities",value:function(){for(var t=1,n=this.findNextNonDeletedIndex(t),r=this.findNextNonDeletedIndex(n),i=!1;r<this._inputLine.length;){var o=!1;this.isDeletable(t,n,r,this._distanceTol)&&(this._isDeleted[n]=e.DELETE,o=!0,i=!0),t=o?r:n,n=this.findNextNonDeletedIndex(t),r=this.findNextNonDeletedIndex(n)}return i}},{key:"isShallowConcavity",value:function(t,e,n,r){return ut.index(t,e,n)===this._angleOrientation&&bt.pointToSegment(e,t,n)<r}},{key:"isShallowSampled",value:function(t,n,r,i,o){var s=Math.trunc((i-r)/e.NUM_PTS_TO_CHECK);s<=0&&(s=1);for(var a=r;a<i;a+=s)if(!this.isShallow(t,n,this._inputLine[a],o))return!1;return!0}},{key:"isConcave",value:function(t,e,n){return ut.index(t,e,n)===this._angleOrientation}},{key:"simplify",value:function(t){this._distanceTol=Math.abs(t),t<0&&(this._angleOrientation=ut.CLOCKWISE),this._isDeleted=new Array(this._inputLine.length).fill(null);var e=!1;do{e=this.deleteShallowConcavities()}while(e);return this.collapseLine()}},{key:"findNextNonDeletedIndex",value:function(t){for(var n=t+1;n<this._inputLine.length&&this._isDeleted[n]===e.DELETE;)n++;return n}},{key:"isShallow",value:function(t,e,n,r){return bt.pointToSegment(e,t,n)<r}},{key:"collapseLine",value:function(){for(var t=new qt,n=0;n<this._inputLine.length;n++)this._isDeleted[n]!==e.DELETE&&t.add(this._inputLine[n]);return t.toCoordinateArray()}}],[{key:"constructor_",value:function(){this._inputLine=null,this._distanceTol=null,this._isDeleted=null,this._angleOrientation=ut.COUNTERCLOCKWISE;var t=arguments[0];this._inputLine=t}},{key:"simplify",value:function(t,n){return new e(t).simplify(n)}}]),e}();_n.INIT=0,_n.DELETE=1,_n.KEEP=1,_n.NUM_PTS_TO_CHECK=10;var An=function(){function e(){t(this,e),e.constructor_.apply(this,arguments)}return n(e,[{key:"getCoordinates",value:function(){return this._ptList.toArray(e.COORDINATE_ARRAY_TYPE)}},{key:"setPrecisionModel",value:function(t){this._precisionModel=t}},{key:"addPt",value:function(t){var e=new G(t);if(this._precisionModel.makePrecise(e),this.isRedundant(e))return null;this._ptList.add(e)}},{key:"reverse",value:function(){}},{key:"addPts",value:function(t,e){if(e)for(var n=0;n<t.length;n++)this.addPt(t[n]);else for(var r=t.length-1;r>=0;r--)this.addPt(t[r])}},{key:"isRedundant",value:function(t){if(this._ptList.size()<1)return!1;var e=this._ptList.get(this._ptList.size()-1);return t.distance(e)<this._minimimVertexDistance}},{key:"toString",value:function(){return(new ie).createLineString(this.getCoordinates()).toString()}},{key:"closeRing",value:function(){if(this._ptList.size()<1)return null;var t=new G(this._ptList.get(0)),e=this._ptList.get(this._ptList.size()-1);if(t.equals(e))return null;this._ptList.add(t)}},{key:"setMinimumVertexDistance",value:function(t){this._minimimVertexDistance=t}}],[{key:"constructor_",value:function(){this._ptList=null,this._precisionModel=null,this._minimimVertexDistance=0,this._ptList=new ft}}]),e}();An.COORDINATE_ARRAY_TYPE=new Array(0).fill(null);var xn=function(){function e(){t(this,e)}return n(e,null,[{key:"toDegrees",value:function(t){return 180*t/Math.PI}},{key:"normalize",value:function(t){for(;t>Math.PI;)t-=e.PI_TIMES_2;for(;t<=-Math.PI;)t+=e.PI_TIMES_2;return t}},{key:"angle",value:function(){if(1===arguments.length){var t=arguments[0];return Math.atan2(t.y,t.x)}if(2===arguments.length){var e=arguments[0],n=arguments[1],r=n.x-e.x,i=n.y-e.y;return Math.atan2(i,r)}}},{key:"isAcute",value:function(t,e,n){var r=t.x-e.x,i=t.y-e.y;return r*(n.x-e.x)+i*(n.y-e.y)>0}},{key:"isObtuse",value:function(t,e,n){var r=t.x-e.x,i=t.y-e.y;return r*(n.x-e.x)+i*(n.y-e.y)<0}},{key:"interiorAngle",value:function(t,n,r){var i=e.angle(n,t),o=e.angle(n,r);return Math.abs(o-i)}},{key:"normalizePositive",value:function(t){if(t<0){for(;t<0;)t+=e.PI_TIMES_2;t>=e.PI_TIMES_2&&(t=0)}else{for(;t>=e.PI_TIMES_2;)t-=e.PI_TIMES_2;t<0&&(t=0)}return t}},{key:"angleBetween",value:function(t,n,r){var i=e.angle(n,t),o=e.angle(n,r);return e.diff(i,o)}},{key:"diff",value:function(t,e){var n=null;return(n=t<e?e-t:t-e)>Math.PI&&(n=2*Math.PI-n),n}},{key:"toRadians",value:function(t){return t*Math.PI/180}},{key:"getTurn",value:function(t,n){var r=Math.sin(n-t);return r>0?e.COUNTERCLOCKWISE:r<0?e.CLOCKWISE:e.NONE}},{key:"angleBetweenOriented",value:function(t,n,r){var i=e.angle(n,t),o=e.angle(n,r)-i;return o<=-Math.PI?o+e.PI_TIMES_2:o>Math.PI?o-e.PI_TIMES_2:o}}]),e}();xn.PI_TIMES_2=2*Math.PI,xn.PI_OVER_2=Math.PI/2,xn.PI_OVER_4=Math.PI/4,xn.COUNTERCLOCKWISE=ut.COUNTERCLOCKWISE,xn.CLOCKWISE=ut.CLOCKWISE,xn.NONE=ut.COLLINEAR;var wn=function(){function e(){t(this,e),e.constructor_.apply(this,arguments)}return n(e,[{key:"addNextSegment",value:function(t,e){if(this._s0=this._s1,this._s1=this._s2,this._s2=t,this._seg0.setCoordinates(this._s0,this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;var n=ut.index(this._s0,this._s1,this._s2),r=n===ut.CLOCKWISE&&this._side===Z.LEFT||n===ut.COUNTERCLOCKWISE&&this._side===Z.RIGHT;0===n?this.addCollinear(e):r?this.addOutsideTurn(n,e):this.addInsideTurn(n,e)}},{key:"addLineEndCap",value:function(t,e){var n=new dn(t,e),r=new dn;this.computeOffsetSegment(n,Z.LEFT,this._distance,r);var i=new dn;this.computeOffsetSegment(n,Z.RIGHT,this._distance,i);var o=e.x-t.x,s=e.y-t.y,a=Math.atan2(s,o);switch(this._bufParams.getEndCapStyle()){case y.CAP_ROUND:this._segList.addPt(r.p1),this.addDirectedFillet(e,a+Math.PI/2,a-Math.PI/2,ut.CLOCKWISE,this._distance),this._segList.addPt(i.p1);break;case y.CAP_FLAT:this._segList.addPt(r.p1),this._segList.addPt(i.p1);break;case y.CAP_SQUARE:var l=new G;l.x=Math.abs(this._distance)*Math.cos(a),l.y=Math.abs(this._distance)*Math.sin(a);var u=new G(r.p1.x+l.x,r.p1.y+l.y),c=new G(i.p1.x+l.x,i.p1.y+l.y);this._segList.addPt(u),this._segList.addPt(c)}}},{key:"getCoordinates",value:function(){return this._segList.getCoordinates()}},{key:"addMitreJoin",value:function(t,e,n,r){var i=yt.intersection(e.p0,e.p1,n.p0,n.p1);if(null!==i&&(r<=0?1:i.distance(t)/Math.abs(r))<=this._bufParams.getMitreLimit())return this._segList.addPt(i),null;this.addLimitedMitreJoin(e,n,r,this._bufParams.getMitreLimit())}},{key:"addOutsideTurn",value:function(t,n){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*e.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;this._bufParams.getJoinStyle()===y.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===y.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(n&&this._segList.addPt(this._offset0.p1),this.addCornerFillet(this._s1,this._offset0.p1,this._offset1.p0,t,this._distance),this._segList.addPt(this._offset1.p0))}},{key:"createSquare",value:function(t){this._segList.addPt(new G(t.x+this._distance,t.y+this._distance)),this._segList.addPt(new G(t.x+this._distance,t.y-this._distance)),this._segList.addPt(new G(t.x-this._distance,t.y-this._distance)),this._segList.addPt(new G(t.x-this._distance,t.y+this._distance)),this._segList.closeRing()}},{key:"addSegments",value:function(t,e){this._segList.addPts(t,e)}},{key:"addFirstSegment",value:function(){this._segList.addPt(this._offset1.p0)}},{key:"addCornerFillet",value:function(t,e,n,r,i){var o=e.x-t.x,s=e.y-t.y,a=Math.atan2(s,o),l=n.x-t.x,u=n.y-t.y,c=Math.atan2(u,l);r===ut.CLOCKWISE?a<=c&&(a+=2*Math.PI):a>=c&&(a-=2*Math.PI),this._segList.addPt(e),this.addDirectedFillet(t,a,c,r,i),this._segList.addPt(n)}},{key:"addLastSegment",value:function(){this._segList.addPt(this._offset1.p1)}},{key:"initSideSegments",value:function(t,e,n){this._s1=t,this._s2=e,this._side=n,this._seg1.setCoordinates(t,e),this.computeOffsetSegment(this._seg1,n,this._distance,this._offset1)}},{key:"addLimitedMitreJoin",value:function(t,e,n,r){var i=this._seg0.p1,o=xn.angle(i,this._seg0.p0),s=xn.angleBetweenOriented(this._seg0.p0,i,this._seg1.p1)/2,a=xn.normalize(o+s),l=xn.normalize(a+Math.PI),u=r*n,c=n-u*Math.abs(Math.sin(s)),h=i.x+u*Math.cos(l),d=i.y+u*Math.sin(l),f=new G(h,d),p=new dn(i,f),g=p.pointAlongOffset(1,c),y=p.pointAlongOffset(1,-c);this._side===Z.LEFT?(this._segList.addPt(g),this._segList.addPt(y)):(this._segList.addPt(y),this._segList.addPt(g))}},{key:"addDirectedFillet",value:function(t,e,n,r,i){var o=r===ut.CLOCKWISE?-1:1,s=Math.abs(e-n),a=Math.trunc(s/this._filletAngleQuantum+.5);if(a<1)return null;for(var l=s/a,u=new G,c=0;c<a;c++){var h=e+o*c*l;u.x=t.x+i*Math.cos(h),u.y=t.y+i*Math.sin(h),this._segList.addPt(u)}}},{key:"computeOffsetSegment",value:function(t,e,n,r){var i=e===Z.LEFT?1:-1,o=t.p1.x-t.p0.x,s=t.p1.y-t.p0.y,a=Math.sqrt(o*o+s*s),l=i*n*o/a,u=i*n*s/a;r.p0.x=t.p0.x-u,r.p0.y=t.p0.y+l,r.p1.x=t.p1.x-u,r.p1.y=t.p1.y+l}},{key:"addInsideTurn",value:function(t,n){if(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())this._segList.addPt(this._li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*e.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this._segList.addPt(this._offset0.p1);else{if(this._segList.addPt(this._offset0.p1),this._closingSegLengthFactor>0){var r=new G((this._closingSegLengthFactor*this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(r);var i=new G((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(i)}else this._segList.addPt(this._s1);this._segList.addPt(this._offset1.p0)}}},{key:"createCircle",value:function(t){var e=new G(t.x+this._distance,t.y);this._segList.addPt(e),this.addDirectedFillet(t,0,2*Math.PI,-1,this._distance),this._segList.closeRing()}},{key:"addBevelJoin",value:function(t,e){this._segList.addPt(t.p1),this._segList.addPt(e.p0)}},{key:"init",value:function(t){this._distance=t,this._maxCurveSegmentError=t*(1-Math.cos(this._filletAngleQuantum/2)),this._segList=new An,this._segList.setPrecisionModel(this._precisionModel),this._segList.setMinimumVertexDistance(t*e.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)}},{key:"addCollinear",value:function(t){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2),this._li.getIntersectionNum()>=2&&(this._bufParams.getJoinStyle()===y.JOIN_BEVEL||this._bufParams.getJoinStyle()===y.JOIN_MITRE?(t&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addCornerFillet(this._s1,this._offset0.p1,this._offset1.p0,ut.CLOCKWISE,this._distance))}},{key:"closeRing",value:function(){this._segList.closeRing()}},{key:"hasNarrowConcaveAngle",value:function(){return this._hasNarrowConcaveAngle}}],[{key:"constructor_",value:function(){this._maxCurveSegmentError=0,this._filletAngleQuantum=null,this._closingSegLengthFactor=1,this._segList=null,this._distance=0,this._precisionModel=null,this._bufParams=null,this._li=null,this._s0=null,this._s1=null,this._s2=null,this._seg0=new dn,this._seg1=new dn,this._offset0=new dn,this._offset1=new dn,this._side=0,this._hasNarrowConcaveAngle=!1;var t=arguments[0],n=arguments[1],r=arguments[2];this._precisionModel=t,this._bufParams=n,this._li=new _e,this._filletAngleQuantum=Math.PI/2/n.getQuadrantSegments(),n.getQuadrantSegments()>=8&&n.getJoinStyle()===y.JOIN_ROUND&&(this._closingSegLengthFactor=e.MAX_CLOSING_SEG_LEN_FACTOR),this.init(r)}}]),e}();wn.OFFSET_SEGMENT_SEPARATION_FACTOR=.001,wn.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR=.001,wn.CURVE_VERTEX_SNAP_DISTANCE_FACTOR=1e-6,wn.MAX_CLOSING_SEG_LEN_FACTOR=80;var Cn=function(){function e(){t(this,e),e.constructor_.apply(this,arguments)}return n(e,[{key:"getOffsetCurve",value:function(t,e){if(this._distance=e,0===e)return null;var n=e<0,r=Math.abs(e),i=this.getSegGen(r);t.length<=1?this.computePointCurve(t[0],i):this.computeOffsetCurve(t,n,i);var o=i.getCoordinates();return n&&Wt.reverse(o),o}},{key:"computeSingleSidedBufferCurve",value:function(t,e,n){var r=this.simplifyTolerance(this._distance);if(e){n.addSegments(t,!0);var i=_n.simplify(t,-r),o=i.length-1;n.initSideSegments(i[o],i[o-1],Z.LEFT),n.addFirstSegment();for(var s=o-2;s>=0;s--)n.addNextSegment(i[s],!0)}else{n.addSegments(t,!1);var a=_n.simplify(t,r),l=a.length-1;n.initSideSegments(a[0],a[1],Z.LEFT),n.addFirstSegment();for(var u=2;u<=l;u++)n.addNextSegment(a[u],!0)}n.addLastSegment(),n.closeRing()}},{key:"computeRingBufferCurve",value:function(t,e,n){var r=this.simplifyTolerance(this._distance);e===Z.RIGHT&&(r=-r);var i=_n.simplify(t,r),o=i.length-1;n.initSideSegments(i[o-1],i[0],e);for(var s=1;s<=o;s++){var a=1!==s;n.addNextSegment(i[s],a)}n.closeRing()}},{key:"computeLineBufferCurve",value:function(t,e){var n=this.simplifyTolerance(this._distance),r=_n.simplify(t,n),i=r.length-1;e.initSideSegments(r[0],r[1],Z.LEFT);for(var o=2;o<=i;o++)e.addNextSegment(r[o],!0);e.addLastSegment(),e.addLineEndCap(r[i-1],r[i]);var s=_n.simplify(t,-n),a=s.length-1;e.initSideSegments(s[a],s[a-1],Z.LEFT);for(var l=a-2;l>=0;l--)e.addNextSegment(s[l],!0);e.addLastSegment(),e.addLineEndCap(s[1],s[0]),e.closeRing()}},{key:"computePointCurve",value:function(t,e){switch(this._bufParams.getEndCapStyle()){case y.CAP_ROUND:e.createCircle(t);break;case y.CAP_SQUARE:e.createSquare(t)}}},{key:"getLineCurve",value:function(t,e){if(this._distance=e,this.isLineOffsetEmpty(e))return null;var n=Math.abs(e),r=this.getSegGen(n);if(t.length<=1)this.computePointCurve(t[0],r);else if(this._bufParams.isSingleSided()){var i=e<0;this.computeSingleSidedBufferCurve(t,i,r)}else this.computeLineBufferCurve(t,r);return r.getCoordinates()}},{key:"getBufferParameters",value:function(){return this._bufParams}},{key:"simplifyTolerance",value:function(t){return t*this._bufParams.getSimplifyFactor()}},{key:"getRingCurve",value:function(t,n,r){if(this._distance=r,t.length<=2)return this.getLineCurve(t,r);if(0===r)return e.copyCoordinates(t);var i=this.getSegGen(r);return this.computeRingBufferCurve(t,n,i),i.getCoordinates()}},{key:"computeOffsetCurve",value:function(t,e,n){var r=this.simplifyTolerance(this._distance);if(e){var i=_n.simplify(t,-r),o=i.length-1;n.initSideSegments(i[o],i[o-1],Z.LEFT),n.addFirstSegment();for(var s=o-2;s>=0;s--)n.addNextSegment(i[s],!0)}else{var a=_n.simplify(t,r),l=a.length-1;n.initSideSegments(a[0],a[1],Z.LEFT),n.addFirstSegment();for(var u=2;u<=l;u++)n.addNextSegment(a[u],!0)}n.addLastSegment()}},{key:"isLineOffsetEmpty",value:function(t){return 0===t||t<0&&!this._bufParams.isSingleSided()}},{key:"getSegGen",value:function(t){return new wn(this._precisionModel,this._bufParams,t)}}],[{key:"constructor_",value:function(){this._distance=0,this._precisionModel=null,this._bufParams=null;var t=arguments[0],e=arguments[1];this._precisionModel=t,this._bufParams=e}},{key:"copyCoordinates",value:function(t){for(var e=new Array(t.length).fill(null),n=0;n<e.length;n++)e[n]=new G(t[n]);return e}}]),e}(),Sn=function(){function e(){t(this,e),e.constructor_.apply(this,arguments)}return n(e,[{key:"findStabbedSegments",value:function(){if(1===arguments.length){for(var t=arguments[0],e=new ft,n=this._subgraphs.iterator();n.hasNext();){var r=n.next(),i=r.getEnvelope();t.y<i.getMinY()||t.y>i.getMaxY()||this.findStabbedSegments(t,r.getDirectedEdges(),e)}return e}if(3===arguments.length)if(nt(arguments[2],tt)&&arguments[0]instanceof G&&arguments[1]instanceof Ge){for(var o=arguments[0],s=arguments[1],a=arguments[2],l=s.getEdge().getCoordinates(),u=0;u<l.length-1;u++)if(this._seg.p0=l[u],this._seg.p1=l[u+1],this._seg.p0.y>this._seg.p1.y&&this._seg.reverse(),!(Math.max(this._seg.p0.x,this._seg.p1.x)<o.x||this._seg.isHorizontal()||o.y<this._seg.p0.y||o.y>this._seg.p1.y||ut.index(this._seg.p0,this._seg.p1,o)===ut.RIGHT)){var c=s.getDepth(Z.LEFT);this._seg.p0.equals(l[u])||(c=s.getDepth(Z.RIGHT));var h=new En(this._seg,c);a.add(h)}}else if(nt(arguments[2],tt)&&arguments[0]instanceof G&&nt(arguments[1],tt))for(var d=arguments[0],f=arguments[2],p=arguments[1].iterator();p.hasNext();){var g=p.next();g.isForward()&&this.findStabbedSegments(d,g,f)}}},{key:"getDepth",value:function(t){var e=this.findStabbedSegments(t);return 0===e.size()?0:Xe.min(e)._leftDepth}}],[{key:"constructor_",value:function(){this._subgraphs=null,this._seg=new dn;var t=arguments[0];this._subgraphs=t}}]),e}(),En=function(){function e(){t(this,e),e.constructor_.apply(this,arguments)}return n(e,[{key:"compareTo",value:function(t){var e=t;if(this._upwardSeg.minX()>=e._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=e._upwardSeg.minX())return-1;var n=this._upwardSeg.orientationIndex(e._upwardSeg);return 0!==n||0!=(n=-1*e._upwardSeg.orientationIndex(this._upwardSeg))?n:this._upwardSeg.compareTo(e._upwardSeg)}},{key:"compareX",value:function(t,e){var n=t.p0.compareTo(e.p0);return 0!==n?n:t.p1.compareTo(e.p1)}},{key:"toString",value:function(){return this._upwardSeg.toString()}},{key:"interfaces_",get:function(){return[_]}}],[{key:"constructor_",value:function(){this._upwardSeg=null,this._leftDepth=null;var t=arguments[0],e=arguments[1];this._upwardSeg=new dn(t),this._leftDepth=e}}]),e}();Sn.DepthSegment=En;var Mn=function(e){r(o,e);var i=c(o);function o(){var e;return t(this,o),e=i.call(this),o.constructor_.apply(u(e),arguments),e}return n(o,null,[{key:"constructor_",value:function(){m.constructor_.call(this,"Projective point not representable on the Cartesian plane.")}}]),o}(m),Pn=function(){function e(){t(this,e),e.constructor_.apply(this,arguments)}return n(e,[{key:"getY",value:function(){var t=this.y/this.w;if(R.isNaN(t)||R.isInfinite(t))throw new Mn;return t}},{key:"getX",value:function(){var t=this.x/this.w;if(R.isNaN(t)||R.isInfinite(t))throw new Mn;return t}},{key:"getCoordinate",value:function(){var t=new G;return t.x=this.getX(),t.y=this.getY(),t}}],[{key:"constructor_",value:function(){if(this.x=null,this.y=null,this.w=null,0===arguments.length)this.x=0,this.y=0,this.w=1;else if(1===arguments.length){var t=arguments[0];this.x=t.x,this.y=t.y,this.w=1}else if(2===arguments.length){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var n=arguments[0],r=arguments[1];this.x=n,this.y=r,this.w=1}else if(arguments[0]instanceof e&&arguments[1]instanceof e){var i=arguments[0],o=arguments[1];this.x=i.y*o.w-o.y*i.w,this.y=o.x*i.w-i.x*o.w,this.w=i.x*o.y-o.x*i.y}else if(arguments[0]instanceof G&&arguments[1]instanceof G){var s=arguments[0],a=arguments[1];this.x=s.y-a.y,this.y=a.x-s.x,this.w=s.x*a.y-a.x*s.y}}else if(3===arguments.length){var l=arguments[0],u=arguments[1],c=arguments[2];this.x=l,this.y=u,this.w=c}else if(4===arguments.length){var h=arguments[0],d=arguments[1],f=arguments[2],p=arguments[3],g=h.y-d.y,y=d.x-h.x,m=h.x*d.y-d.x*h.y,v=f.y-p.y,b=p.x-f.x,_=f.x*p.y-p.x*f.y;this.x=y*_-b*m,this.y=v*m-g*_,this.w=g*b-v*y}}}]),e}(),Tn=function(){function e(){t(this,e),e.constructor_.apply(this,arguments)}return n(e,[{key:"area",value:function(){return e.area(this.p0,this.p1,this.p2)}},{key:"signedArea",value:function(){return e.signedArea(this.p0,this.p1,this.p2)}},{key:"interpolateZ",value:function(t){if(null===t)throw new v("Supplied point is null.");return e.interpolateZ(t,this.p0,this.p1,this.p2)}},{key:"longestSideLength",value:function(){return e.longestSideLength(this.p0,this.p1,this.p2)}},{key:"isAcute",value:function(){return e.isAcute(this.p0,this.p1,this.p2)}},{key:"circumcentre",value:function(){return e.circumcentre(this.p0,this.p1,this.p2)}},{key:"area3D",value:function(){return e.area3D(this.p0,this.p1,this.p2)}},{key:"centroid",value:function(){return e.centroid(this.p0,this.p1,this.p2)}},{key:"inCentre",value:function(){return e.inCentre(this.p0,this.p1,this.p2)}}],[{key:"constructor_",value:function(){this.p0=null,this.p1=null,this.p2=null;var t=arguments[0],e=arguments[1],n=arguments[2];this.p0=t,this.p1=e,this.p2=n}},{key:"area",value:function(t,e,n){return Math.abs(((n.x-t.x)*(e.y-t.y)-(e.x-t.x)*(n.y-t.y))/2)}},{key:"signedArea",value:function(t,e,n){return((n.x-t.x)*(e.y-t.y)-(e.x-t.x)*(n.y-t.y))/2}},{key:"det",value:function(t,e,n,r){return t*r-e*n}},{key:"interpolateZ",value:function(t,e,n,r){var i=e.x,o=e.y,s=n.x-i,a=r.x-i,l=n.y-o,u=r.y-o,c=s*u-a*l,h=t.x-i,d=t.y-o,f=(u*h-a*d)/c,p=(-l*h+s*d)/c;return e.getZ()+f*(n.getZ()-e.getZ())+p*(r.getZ()-e.getZ())}},{key:"longestSideLength",value:function(t,e,n){var r=t.distance(e),i=e.distance(n),o=n.distance(t),s=r;return i>s&&(s=i),o>s&&(s=o),s}},{key:"circumcentreDD",value:function(t,e,n){var r=st.valueOf(t.x).subtract(n.x),i=st.valueOf(t.y).subtract(n.y),o=st.valueOf(e.x).subtract(n.x),s=st.valueOf(e.y).subtract(n.y),a=st.determinant(r,i,o,s).multiply(2),l=r.sqr().add(i.sqr()),u=o.sqr().add(s.sqr()),c=st.determinant(i,l,s,u),h=st.determinant(r,l,o,u),d=st.valueOf(n.x).subtract(c.divide(a)).doubleValue(),f=st.valueOf(n.y).add(h.divide(a)).doubleValue();return new G(d,f)}},{key:"isAcute",value:function(t,e,n){return!!xn.isAcute(t,e,n)&&!!xn.isAcute(e,n,t)&&!!xn.isAcute(n,t,e)}},{key:"circumcentre",value:function(t,n,r){var i=r.x,o=r.y,s=t.x-i,a=t.y-o,l=n.x-i,u=n.y-o,c=2*e.det(s,a,l,u),h=e.det(a,s*s+a*a,u,l*l+u*u),d=e.det(s,s*s+a*a,l,l*l+u*u);return new G(i-h/c,o+d/c)}},{key:"perpendicularBisector",value:function(t,e){var n=e.x-t.x,r=e.y-t.y,i=new Pn(t.x+n/2,t.y+r/2,1),o=new Pn(t.x-r+n/2,t.y+n+r/2,1);return new Pn(i,o)}},{key:"angleBisector",value:function(t,e,n){var r=e.distance(t),i=r/(r+e.distance(n)),o=n.x-t.x,s=n.y-t.y;return new G(t.x+i*o,t.y+i*s)}},{key:"area3D",value:function(t,e,n){var r=e.x-t.x,i=e.y-t.y,o=e.getZ()-t.getZ(),s=n.x-t.x,a=n.y-t.y,l=n.getZ()-t.getZ(),u=i*l-o*a,c=o*s-r*l,h=r*a-i*s,d=u*u+c*c+h*h;return Math.sqrt(d)/2}},{key:"centroid",value:function(t,e,n){var r=(t.x+e.x+n.x)/3,i=(t.y+e.y+n.y)/3;return new G(r,i)}},{key:"inCentre",value:function(t,e,n){var r=e.distance(n),i=t.distance(n),o=t.distance(e),s=r+i+o,a=(r*t.x+i*e.x+o*n.x)/s,l=(r*t.y+i*e.y+o*n.y)/s;return new G(a,l)}}]),e}(),On=function(){function e(){t(this,e),e.constructor_.apply(this,arguments)}return n(e,[{key:"addRingSide",value:function(t,e,n,r,i){if(0===e&&t.length<Gt.MINIMUM_VALID_SIZE)return null;var o=r,s=i;t.length>=Gt.MINIMUM_VALID_SIZE&&ut.isCCW(t)&&(o=i,s=r,n=Z.opposite(n));var a=this._curveBuilder.getRingCurve(t,n,e);this.addCurve(a,o,s)}},{key:"addRingBothSides",value:function(t,e){this.addRingSide(t,e,Z.LEFT,H.EXTERIOR,H.INTERIOR),this.addRingSide(t,e,Z.RIGHT,H.INTERIOR,H.EXTERIOR)}},{key:"addPoint",value:function(t){if(this._distance<=0)return null;var e=t.getCoordinates(),n=this._curveBuilder.getLineCurve(e,this._distance);this.addCurve(n,H.EXTERIOR,H.INTERIOR)}},{key:"addPolygon",value:function(t){var e=this._distance,n=Z.LEFT;this._distance<0&&(e=-this._distance,n=Z.RIGHT);var r=t.getExteriorRing(),i=Wt.removeRepeatedPoints(r.getCoordinates());if(this._distance<0&&this.isErodedCompletely(r,this._distance))return null;if(this._distance<=0&&i.length<3)return null;this.addRingSide(i,e,n,H.EXTERIOR,H.INTERIOR);for(var o=0;o<t.getNumInteriorRing();o++){var s=t.getInteriorRingN(o),a=Wt.removeRepeatedPoints(s.getCoordinates());this._distance>0&&this.isErodedCompletely(s,-this._distance)||this.addRingSide(a,e,Z.opposite(n),H.INTERIOR,H.EXTERIOR)}}},{key:"isTriangleErodedCompletely",value:function(t,e){var n=new Tn(t[0],t[1],t[2]),r=n.inCentre();return bt.pointToSegment(r,n.p0,n.p1)<Math.abs(e)}},{key:"addLineString",value:function(t){if(this._curveBuilder.isLineOffsetEmpty(this._distance))return null;var e=Wt.removeRepeatedPoints(t.getCoordinates());if(Wt.isRing(e)&&!this._curveBuilder.getBufferParameters().isSingleSided())this.addRingBothSides(e,this._distance);else{var n=this._curveBuilder.getLineCurve(e,this._distance);this.addCurve(n,H.EXTERIOR,H.INTERIOR)}}},{key:"addCurve",value:function(t,e,n){if(null===t||t.length<2)return null;var r=new hn(t,new Ce(0,H.BOUNDARY,e,n));this._curveList.add(r)}},{key:"getCurves",value:function(){return this.add(this._inputGeom),this._curveList}},{key:"add",value:function(t){if(t.isEmpty())return null;if(t instanceof Lt)this.addPolygon(t);else if(t instanceof Pt)this.addLineString(t);else if(t instanceof Ot)this.addPoint(t);else if(t instanceof jt)this.addCollection(t);else if(t instanceof re)this.addCollection(t);else if(t instanceof Qt)this.addCollection(t);else{if(!(t instanceof Nt))throw new J(t.getGeometryType());this.addCollection(t)}}},{key:"isErodedCompletely",value:function(t,e){var n=t.getCoordinates();if(n.length<4)return e<0;if(4===n.length)return this.isTriangleErodedCompletely(n,e);var r=t.getEnvelopeInternal(),i=Math.min(r.getHeight(),r.getWidth());return e<0&&2*Math.abs(e)>i}},{key:"addCollection",value:function(t){for(var e=0;e<t.getNumGeometries();e++){var n=t.getGeometryN(e);this.add(n)}}}],[{key:"constructor_",value:function(){this._inputGeom=null,this._distance=null,this._curveBuilder=null,this._curveList=new ft;var t=arguments[0],e=arguments[1],n=arguments[2];this._inputGeom=t,this._distance=e,this._curveBuilder=n}}]),e}(),In=function(){function e(){t(this,e)}return n(e,[{key:"locate",value:function(t){}}]),e}(),Rn=function(){function e(){t(this,e),e.constructor_.apply(this,arguments)}return n(e,[{key:"next",value:function(){if(this._atStart)return this._atStart=!1,e.isAtomic(this._parent)&&this._index++,this._parent;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new W;var t=this._parent.getGeometryN(this._index++);return t instanceof Nt?(this._subcollectionIterator=new e(t),this._subcollectionIterator.next()):t}},{key:"remove",value:function(){throw new J(this.getClass().getName())}},{key:"hasNext",value:function(){if(this._atStart)return!0;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)}},{key:"interfaces_",get:function(){return[sn]}}],[{key:"constructor_",value:function(){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;var t=arguments[0];this._parent=t,this._atStart=!0,this._index=0,this._max=t.getNumGeometries()}},{key:"isAtomic",value:function(t){return!(t instanceof Nt)}}]),e}(),Bn=function(){function e(){t(this,e),e.constructor_.apply(this,arguments)}return n(e,[{key:"locate",value:function(t){return e.locate(t,this._geom)}},{key:"interfaces_",get:function(){return[In]}}],[{key:"constructor_",value:function(){this._geom=null;var t=arguments[0];this._geom=t}},{key:"locatePointInPolygon",value:function(t,n){if(n.isEmpty())return H.EXTERIOR;var r=n.getExteriorRing(),i=e.locatePointInRing(t,r);if(i!==H.INTERIOR)return i;for(var o=0;o<n.getNumInteriorRing();o++){var s=n.getInteriorRingN(o),a=e.locatePointInRing(t,s);if(a===H.BOUNDARY)return H.BOUNDARY;if(a===H.INTERIOR)return H.EXTERIOR}return H.INTERIOR}},{key:"locatePointInRing",value:function(t,e){return e.getEnvelopeInternal().intersects(t)?xe.locateInRing(t,e.getCoordinates()):H.EXTERIOR}},{key:"containsPointInPolygon",value:function(t,n){return H.EXTERIOR!==e.locatePointInPolygon(t,n)}},{key:"locateInGeometry",value:function(t,n){if(n instanceof Lt)return e.locatePointInPolygon(t,n);if(n instanceof Nt)for(var r=new Rn(n);r.hasNext();){var i=r.next();if(i!==n){var o=e.locateInGeometry(t,i);if(o!==H.EXTERIOR)return o}}return H.EXTERIOR}},{key:"isContained",value:function(t,n){return H.EXTERIOR!==e.locate(t,n)}},{key:"locate",value:function(t,n){return n.isEmpty()?H.EXTERIOR:n.getEnvelopeInternal().intersects(t)?e.locateInGeometry(t,n):H.EXTERIOR}}]),e}(),Ln=function(){function e(){t(this,e),e.constructor_.apply(this,arguments)}return n(e,[{key:"getNextCW",value:function(t){this.getEdges();var e=this._edgeList.indexOf(t),n=e-1;return 0===e&&(n=this._edgeList.size()-1),this._edgeList.get(n)}},{key:"propagateSideLabels",value:function(t){for(var e=H.NONE,n=this.iterator();n.hasNext();){var r=n.next().getLabel();r.isArea(t)&&r.getLocation(t,Z.LEFT)!==H.NONE&&(e=r.getLocation(t,Z.LEFT))}if(e===H.NONE)return null;for(var i=e,o=this.iterator();o.hasNext();){var s=o.next(),a=s.getLabel();if(a.getLocation(t,Z.ON)===H.NONE&&a.setLocation(t,Z.ON,i),a.isArea(t)){var l=a.getLocation(t,Z.LEFT),u=a.getLocation(t,Z.RIGHT);if(u!==H.NONE){if(u!==i)throw new ht("side location conflict",s.getCoordinate());l===H.NONE&&D.shouldNeverReachHere("found single null side (at "+s.getCoordinate()+")"),i=l}else D.isTrue(a.getLocation(t,Z.LEFT)===H.NONE,"found single null side"),a.setLocation(t,Z.RIGHT,i),a.setLocation(t,Z.LEFT,i)}}}},{key:"getCoordinate",value:function(){var t=this.iterator();return t.hasNext()?t.next().getCoordinate():null}},{key:"print",value:function(t){mt.out.println("EdgeEndStar:   "+this.getCoordinate());for(var e=this.iterator();e.hasNext();)e.next().print(t)}},{key:"isAreaLabelsConsistent",value:function(t){return this.computeEdgeEndLabels(t.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)}},{key:"checkAreaLabelsConsistent",value:function(t){var e=this.getEdges();if(e.size()<=0)return!0;var n=e.size()-1,r=e.get(n).getLabel().getLocation(t,Z.LEFT);D.isTrue(r!==H.NONE,"Found unlabelled area edge");for(var i=r,o=this.iterator();o.hasNext();){var s=o.next().getLabel();D.isTrue(s.isArea(t),"Found non-area edge");var a=s.getLocation(t,Z.LEFT),l=s.getLocation(t,Z.RIGHT);if(a===l)return!1;if(l!==i)return!1;i=a}return!0}},{key:"findIndex",value:function(t){this.iterator();for(var e=0;e<this._edgeList.size();e++)if(this._edgeList.get(e)===t)return e;return-1}},{key:"iterator",value:function(){return this.getEdges().iterator()}},{key:"getEdges",value:function(){return null===this._edgeList&&(this._edgeList=new ft(this._edgeMap.values())),this._edgeList}},{key:"getLocation",value:function(t,e,n){return this._ptInAreaLocation[t]===H.NONE&&(this._ptInAreaLocation[t]=Bn.locate(e,n[t].getGeometry())),this._ptInAreaLocation[t]}},{key:"toString",value:function(){var t=new rt;t.append("EdgeEndStar:   "+this.getCoordinate()),t.append("\n");for(var e=this.iterator();e.hasNext();){var n=e.next();t.append(n),t.append("\n")}return t.toString()}},{key:"computeEdgeEndLabels",value:function(t){for(var e=this.iterator();e.hasNext();)e.next().computeLabel(t)}},{key:"computeLabelling",value:function(t){this.computeEdgeEndLabels(t[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var e=[!1,!1],n=this.iterator();n.hasNext();)for(var r=n.next().getLabel(),i=0;i<2;i++)r.isLine(i)&&r.getLocation(i)===H.BOUNDARY&&(e[i]=!0);for(var o=this.iterator();o.hasNext();)for(var s=o.next(),a=s.getLabel(),l=0;l<2;l++)if(a.isAnyNull(l)){var u=H.NONE;if(e[l])u=H.EXTERIOR;else{var c=s.getCoordinate();u=this.getLocation(l,c,t)}a.setAllLocationsIfNull(l,u)}}},{key:"getDegree",value:function(){return this._edgeMap.size()}},{key:"insertEdgeEnd",value:function(t,e){this._edgeMap.put(t,e),this._edgeList=null}}],[{key:"constructor_",value:function(){this._edgeMap=new De,this._edgeList=null,this._ptInAreaLocation=[H.NONE,H.NONE]}}]),e}(),kn=function(e){r(s,e);var o=c(s);function s(){var e;return t(this,s),e=o.call(this),s.constructor_.apply(u(e),arguments),e}return n(s,[{key:"linkResultDirectedEdges",value:function(){this.getResultAreaEdges();for(var t=null,e=null,n=this._SCANNING_FOR_INCOMING,r=0;r<this._resultAreaEdgeList.size();r++){var i=this._resultAreaEdgeList.get(r),o=i.getSym();if(i.getLabel().isArea())switch(null===t&&i.isInResult()&&(t=i),n){case this._SCANNING_FOR_INCOMING:if(!o.isInResult())continue;e=o,n=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(!i.isInResult())continue;e.setNext(i),n=this._SCANNING_FOR_INCOMING}}if(n===this._LINKING_TO_OUTGOING){if(null===t)throw new ht("no outgoing dirEdge found",this.getCoordinate());D.isTrue(t.isInResult(),"unable to link last incoming dirEdge"),e.setNext(t)}}},{key:"insert",value:function(t){var e=t;this.insertEdgeEnd(e,e)}},{key:"getRightmostEdge",value:function(){var t=this.getEdges(),e=t.size();if(e<1)return null;var n=t.get(0);if(1===e)return n;var r=t.get(e-1),i=n.getQuadrant(),o=r.getQuadrant();return Ne.isNorthern(i)&&Ne.isNorthern(o)?n:Ne.isNorthern(i)||Ne.isNorthern(o)?0!==n.getDy()?n:0!==r.getDy()?r:(D.shouldNeverReachHere("found two horizontal edges incident on node"),null):r}},{key:"print",value:function(t){mt.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var e=this.iterator();e.hasNext();){var n=e.next();t.print("out "),n.print(t),t.println(),t.print("in "),n.getSym().print(t),t.println()}}},{key:"getResultAreaEdges",value:function(){if(null!==this._resultAreaEdgeList)return this._resultAreaEdgeList;this._resultAreaEdgeList=new ft;for(var t=this.iterator();t.hasNext();){var e=t.next();(e.isInResult()||e.getSym().isInResult())&&this._resultAreaEdgeList.add(e)}return this._resultAreaEdgeList}},{key:"updateLabelling",value:function(t){for(var e=this.iterator();e.hasNext();){var n=e.next().getLabel();n.setAllLocationsIfNull(0,t.getLocation(0)),n.setAllLocationsIfNull(1,t.getLocation(1))}}},{key:"linkAllDirectedEdges",value:function(){this.getEdges();for(var t=null,e=null,n=this._edgeList.size()-1;n>=0;n--){var r=this._edgeList.get(n),i=r.getSym();null===e&&(e=i),null!==t&&i.setNext(t),t=r}e.setNext(t)}},{key:"computeDepths",value:function(){if(1===arguments.length){var t=arguments[0],e=this.findIndex(t),n=t.getDepth(Z.LEFT),r=t.getDepth(Z.RIGHT),i=this.computeDepths(e+1,this._edgeList.size(),n);if(this.computeDepths(0,e,i)!==r)throw new ht("depth mismatch at "+t.getCoordinate())}else if(3===arguments.length){for(var o=arguments[1],s=arguments[2],a=arguments[0];a<o;a++){var l=this._edgeList.get(a);l.setEdgeDepths(Z.RIGHT,s),s=l.getDepth(Z.LEFT)}return s}}},{key:"mergeSymLabels",value:function(){for(var t=this.iterator();t.hasNext();){var e=t.next();e.getLabel().merge(e.getSym().getLabel())}}},{key:"linkMinimalDirectedEdges",value:function(t){for(var e=null,n=null,r=this._SCANNING_FOR_INCOMING,i=this._resultAreaEdgeList.size()-1;i>=0;i--){var o=this._resultAreaEdgeList.get(i),s=o.getSym();switch(null===e&&o.getEdgeRing()===t&&(e=o),r){case this._SCANNING_FOR_INCOMING:if(s.getEdgeRing()!==t)continue;n=s,r=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(o.getEdgeRing()!==t)continue;n.setNextMin(o),r=this._SCANNING_FOR_INCOMING}}r===this._LINKING_TO_OUTGOING&&(D.isTrue(null!==e,"found null for first outgoing dirEdge"),D.isTrue(e.getEdgeRing()===t,"unable to link last incoming dirEdge"),n.setNextMin(e))}},{key:"getOutgoingDegree",value:function(){if(0===arguments.length){for(var t=0,e=this.iterator();e.hasNext();)e.next().isInResult()&&t++;return t}if(1===arguments.length){for(var n=arguments[0],r=0,i=this.iterator();i.hasNext();)i.next().getEdgeRing()===n&&r++;return r}}},{key:"getLabel",value:function(){return this._label}},{key:"findCoveredLineEdges",value:function(){for(var t=H.NONE,e=this.iterator();e.hasNext();){var n=e.next(),r=n.getSym();if(!n.isLineEdge()){if(n.isInResult()){t=H.INTERIOR;break}if(r.isInResult()){t=H.EXTERIOR;break}}}if(t===H.NONE)return null;for(var i=t,o=this.iterator();o.hasNext();){var s=o.next(),a=s.getSym();s.isLineEdge()?s.getEdge().setCovered(i===H.INTERIOR):(s.isInResult()&&(i=H.EXTERIOR),a.isInResult()&&(i=H.INTERIOR))}}},{key:"computeLabelling",value:function(t){h(i(s.prototype),"computeLabelling",this).call(this,t),this._label=new Ce(H.NONE);for(var e=this.iterator();e.hasNext();)for(var n=e.next().getEdge().getLabel(),r=0;r<2;r++){var o=n.getLocation(r);o!==H.INTERIOR&&o!==H.BOUNDARY||this._label.setLocation(r,H.INTERIOR)}}}],[{key:"constructor_",value:function(){this._resultAreaEdgeList=null,this._label=null,this._SCANNING_FOR_INCOMING=1,this._LINKING_TO_OUTGOING=2}}]),s}(Ln),Dn=function(e){r(o,e);var i=c(o);function o(){return t(this,o),i.call(this)}return n(o,[{key:"createNode",value:function(t){return new Te(t,new kn)}}]),o}(Ue),Fn=function(){function e(){t(this,e),e.constructor_.apply(this,arguments)}return n(e,[{key:"compareTo",value:function(t){var n=t;return e.compareOriented(this._pts,this._orientation,n._pts,n._orientation)}},{key:"interfaces_",get:function(){return[_]}}],[{key:"constructor_",value:function(){this._pts=null,this._orientation=null;var t=arguments[0];this._pts=t,this._orientation=e.orientation(t)}},{key:"orientation",value:function(t){return 1===Wt.increasingDirection(t)}},{key:"compareOriented",value:function(t,e,n,r){for(var i=e?1:-1,o=r?1:-1,s=e?t.length:-1,a=r?n.length:-1,l=e?0:t.length-1,u=r?0:n.length-1;;){var c=t[l].compareTo(n[u]);if(0!==c)return c;var h=(l+=i)===s,d=(u+=o)===a;if(h&&!d)return-1;if(!h&&d)return 1;if(h&&d)return 0}}}]),e}(),Nn=function(){function e(){t(this,e),e.constructor_.apply(this,arguments)}return n(e,[{key:"print",value:function(t){t.print("MULTILINESTRING ( ");for(var e=0;e<this._edges.size();e++){var n=this._edges.get(e);e>0&&t.print(","),t.print("(");for(var r=n.getCoordinates(),i=0;i<r.length;i++)i>0&&t.print(","),t.print(r[i].x+" "+r[i].y);t.println(")")}t.print(")  ")}},{key:"addAll",value:function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next())}},{key:"findEdgeIndex",value:function(t){for(var e=0;e<this._edges.size();e++)if(this._edges.get(e).equals(t))return e;return-1}},{key:"iterator",value:function(){return this._edges.iterator()}},{key:"getEdges",value:function(){return this._edges}},{key:"get",value:function(t){return this._edges.get(t)}},{key:"findEqualEdge",value:function(t){var e=new Fn(t.getCoordinates());return this._ocaMap.get(e)}},{key:"add",value:function(t){this._edges.add(t);var e=new Fn(t.getCoordinates());this._ocaMap.put(e,t)}}],[{key:"constructor_",value:function(){this._edges=new ft,this._ocaMap=new De}}]),e}(),jn=function(){function e(){t(this,e)}return n(e,[{key:"processIntersections",value:function(t,e,n,r){}},{key:"isDone",value:function(){}}]),e}(),Gn=function(){function e(){t(this,e),e.constructor_.apply(this,arguments)}return n(e,[{key:"isTrivialIntersection",value:function(t,n,r,i){if(t===r&&1===this._li.getIntersectionNum()){if(e.isAdjacentSegments(n,i))return!0;if(t.isClosed()){var o=t.size()-1;if(0===n&&i===o||0===i&&n===o)return!0}}return!1}},{key:"getProperIntersectionPoint",value:function(){return this._properIntersectionPoint}},{key:"hasProperInteriorIntersection",value:function(){return this._hasProperInterior}},{key:"getLineIntersector",value:function(){return this._li}},{key:"hasProperIntersection",value:function(){return this._hasProper}},{key:"processIntersections",value:function(t,e,n,r){if(t===n&&e===r)return null;this.numTests++;var i=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=n.getCoordinates()[r],a=n.getCoordinates()[r+1];this._li.computeIntersection(i,o,s,a),this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(t,e,n,r)||(this._hasIntersection=!0,t.addIntersections(this._li,e,0),n.addIntersections(this._li,r,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))}},{key:"hasIntersection",value:function(){return this._hasIntersection}},{key:"isDone",value:function(){return!1}},{key:"hasInteriorIntersection",value:function(){return this._hasInterior}},{key:"interfaces_",get:function(){return[jn]}}],[{key:"constructor_",value:function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._hasInterior=!1,this._properIntersectionPoint=null,this._li=null,this._isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0;var t=arguments[0];this._li=t}},{key:"isAdjacentSegments",value:function(t,e){return 1===Math.abs(t-e)}}]),e}(),Un=function(){function e(){t(this,e),e.constructor_.apply(this,arguments)}return n(e,[{key:"getSegmentIndex",value:function(){return this.segmentIndex}},{key:"getCoordinate",value:function(){return this.coord}},{key:"print",value:function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex),t.println(" dist = "+this.dist)}},{key:"compareTo",value:function(t){var e=t;return this.compare(e.segmentIndex,e.dist)}},{key:"isEndPoint",value:function(t){return 0===this.segmentIndex&&0===this.dist||this.segmentIndex===t}},{key:"toString",value:function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist}},{key:"getDistance",value:function(){return this.dist}},{key:"compare",value:function(t,e){return this.segmentIndex<t?-1:this.segmentIndex>t?1:this.dist<e?-1:this.dist>e?1:0}},{key:"interfaces_",get:function(){return[_]}}],[{key:"constructor_",value:function(){this.coord=null,this.segmentIndex=null,this.dist=null;var t=arguments[0],e=arguments[1],n=arguments[2];this.coord=new G(t),this.segmentIndex=e,this.dist=n}}]),e}(),zn=function(){function e(){t(this,e),e.constructor_.apply(this,arguments)}return n(e,[{key:"print",value:function(t){t.println("Intersections:");for(var e=this.iterator();e.hasNext();)e.next().print(t)}},{key:"iterator",value:function(){return this._nodeMap.values().iterator()}},{key:"addSplitEdges",value:function(t){this.addEndpoints();for(var e=this.iterator(),n=e.next();e.hasNext();){var r=e.next(),i=this.createSplitEdge(n,r);t.add(i),n=r}}},{key:"addEndpoints",value:function(){var t=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[t],t,0)}},{key:"createSplitEdge",value:function(t,e){var n=e.segmentIndex-t.segmentIndex+2,r=this.edge.pts[e.segmentIndex],i=e.dist>0||!e.coord.equals2D(r);i||n--;var o=new Array(n).fill(null),s=0;o[s++]=new G(t.coord);for(var a=t.segmentIndex+1;a<=e.segmentIndex;a++)o[s++]=this.edge.pts[a];return i&&(o[s]=e.coord),new Yn(o,new Ce(this.edge._label))}},{key:"add",value:function(t,e,n){var r=new Un(t,e,n),i=this._nodeMap.get(r);return null!==i?i:(this._nodeMap.put(r,r),r)}},{key:"isIntersection",value:function(t){for(var e=this.iterator();e.hasNext();)if(e.next().coord.equals(t))return!0;return!1}}],[{key:"constructor_",value:function(){this._nodeMap=new De,this.edge=null;var t=arguments[0];this.edge=t}}]),e}(),Vn=function(){function e(){t(this,e),e.constructor_.apply(this,arguments)}return n(e,[{key:"isIntersects",value:function(){return!this.isDisjoint()}},{key:"isCovers",value:function(){return(e.isTrue(this._matrix[H.INTERIOR][H.INTERIOR])||e.isTrue(this._matrix[H.INTERIOR][H.BOUNDARY])||e.isTrue(this._matrix[H.BOUNDARY][H.INTERIOR])||e.isTrue(this._matrix[H.BOUNDARY][H.BOUNDARY]))&&this._matrix[H.EXTERIOR][H.INTERIOR]===St.FALSE&&this._matrix[H.EXTERIOR][H.BOUNDARY]===St.FALSE}},{key:"isCoveredBy",value:function(){return(e.isTrue(this._matrix[H.INTERIOR][H.INTERIOR])||e.isTrue(this._matrix[H.INTERIOR][H.BOUNDARY])||e.isTrue(this._matrix[H.BOUNDARY][H.INTERIOR])||e.isTrue(this._matrix[H.BOUNDARY][H.BOUNDARY]))&&this._matrix[H.INTERIOR][H.EXTERIOR]===St.FALSE&&this._matrix[H.BOUNDARY][H.EXTERIOR]===St.FALSE}},{key:"set",value:function(){if(1===arguments.length)for(var t=arguments[0],e=0;e<t.length;e++){var n=Math.trunc(e/3),r=e%3;this._matrix[n][r]=St.toDimensionValue(t.charAt(e))}else if(3===arguments.length){var i=arguments[0],o=arguments[1],s=arguments[2];this._matrix[i][o]=s}}},{key:"isContains",value:function(){return e.isTrue(this._matrix[H.INTERIOR][H.INTERIOR])&&this._matrix[H.EXTERIOR][H.INTERIOR]===St.FALSE&&this._matrix[H.EXTERIOR][H.BOUNDARY]===St.FALSE}},{key:"setAtLeast",value:function(){if(1===arguments.length)for(var t=arguments[0],e=0;e<t.length;e++){var n=Math.trunc(e/3),r=e%3;this.setAtLeast(n,r,St.toDimensionValue(t.charAt(e)))}else if(3===arguments.length){var i=arguments[0],o=arguments[1],s=arguments[2];this._matrix[i][o]<s&&(this._matrix[i][o]=s)}}},{key:"setAtLeastIfValid",value:function(t,e,n){t>=0&&e>=0&&this.setAtLeast(t,e,n)}},{key:"isWithin",value:function(){return e.isTrue(this._matrix[H.INTERIOR][H.INTERIOR])&&this._matrix[H.INTERIOR][H.EXTERIOR]===St.FALSE&&this._matrix[H.BOUNDARY][H.EXTERIOR]===St.FALSE}},{key:"isTouches",value:function(t,n){return t>n?this.isTouches(n,t):(t===St.A&&n===St.A||t===St.L&&n===St.L||t===St.L&&n===St.A||t===St.P&&n===St.A||t===St.P&&n===St.L)&&this._matrix[H.INTERIOR][H.INTERIOR]===St.FALSE&&(e.isTrue(this._matrix[H.INTERIOR][H.BOUNDARY])||e.isTrue(this._matrix[H.BOUNDARY][H.INTERIOR])||e.isTrue(this._matrix[H.BOUNDARY][H.BOUNDARY]))}},{key:"isOverlaps",value:function(t,n){return t===St.P&&n===St.P||t===St.A&&n===St.A?e.isTrue(this._matrix[H.INTERIOR][H.INTERIOR])&&e.isTrue(this._matrix[H.INTERIOR][H.EXTERIOR])&&e.isTrue(this._matrix[H.EXTERIOR][H.INTERIOR]):t===St.L&&n===St.L&&1===this._matrix[H.INTERIOR][H.INTERIOR]&&e.isTrue(this._matrix[H.INTERIOR][H.EXTERIOR])&&e.isTrue(this._matrix[H.EXTERIOR][H.INTERIOR])}},{key:"isEquals",value:function(t,n){return t===n&&e.isTrue(this._matrix[H.INTERIOR][H.INTERIOR])&&this._matrix[H.INTERIOR][H.EXTERIOR]===St.FALSE&&this._matrix[H.BOUNDARY][H.EXTERIOR]===St.FALSE&&this._matrix[H.EXTERIOR][H.INTERIOR]===St.FALSE&&this._matrix[H.EXTERIOR][H.BOUNDARY]===St.FALSE}},{key:"toString",value:function(){for(var t=new Xt("123456789"),e=0;e<3;e++)for(var n=0;n<3;n++)t.setCharAt(3*e+n,St.toDimensionSymbol(this._matrix[e][n]));return t.toString()}},{key:"setAll",value:function(t){for(var e=0;e<3;e++)for(var n=0;n<3;n++)this._matrix[e][n]=t}},{key:"get",value:function(t,e){return this._matrix[t][e]}},{key:"transpose",value:function(){var t=this._matrix[1][0];return this._matrix[1][0]=this._matrix[0][1],this._matrix[0][1]=t,t=this._matrix[2][0],this._matrix[2][0]=this._matrix[0][2],this._matrix[0][2]=t,t=this._matrix[2][1],this._matrix[2][1]=this._matrix[1][2],this._matrix[1][2]=t,this}},{key:"matches",value:function(t){if(9!==t.length)throw new v("Should be length 9: "+t);for(var n=0;n<3;n++)for(var r=0;r<3;r++)if(!e.matches(this._matrix[n][r],t.charAt(3*n+r)))return!1;return!0}},{key:"add",value:function(t){for(var e=0;e<3;e++)for(var n=0;n<3;n++)this.setAtLeast(e,n,t.get(e,n))}},{key:"isDisjoint",value:function(){return this._matrix[H.INTERIOR][H.INTERIOR]===St.FALSE&&this._matrix[H.INTERIOR][H.BOUNDARY]===St.FALSE&&this._matrix[H.BOUNDARY][H.INTERIOR]===St.FALSE&&this._matrix[H.BOUNDARY][H.BOUNDARY]===St.FALSE}},{key:"isCrosses",value:function(t,n){return t===St.P&&n===St.L||t===St.P&&n===St.A||t===St.L&&n===St.A?e.isTrue(this._matrix[H.INTERIOR][H.INTERIOR])&&e.isTrue(this._matrix[H.INTERIOR][H.EXTERIOR]):t===St.L&&n===St.P||t===St.A&&n===St.P||t===St.A&&n===St.L?e.isTrue(this._matrix[H.INTERIOR][H.INTERIOR])&&e.isTrue(this._matrix[H.EXTERIOR][H.INTERIOR]):t===St.L&&n===St.L&&0===this._matrix[H.INTERIOR][H.INTERIOR]}},{key:"interfaces_",get:function(){return[A]}}],[{key:"constructor_",value:function(){if(this._matrix=null,0===arguments.length)this._matrix=Array(3).fill().map((function(){return Array(3)})),this.setAll(St.FALSE);else if(1===arguments.length)if("string"==typeof arguments[0]){var t=arguments[0];e.constructor_.call(this),this.set(t)}else if(arguments[0]instanceof e){var n=arguments[0];e.constructor_.call(this),this._matrix[H.INTERIOR][H.INTERIOR]=n._matrix[H.INTERIOR][H.INTERIOR],this._matrix[H.INTERIOR][H.BOUNDARY]=n._matrix[H.INTERIOR][H.BOUNDARY],this._matrix[H.INTERIOR][H.EXTERIOR]=n._matrix[H.INTERIOR][H.EXTERIOR],this._matrix[H.BOUNDARY][H.INTERIOR]=n._matrix[H.BOUNDARY][H.INTERIOR],this._matrix[H.BOUNDARY][H.BOUNDARY]=n._matrix[H.BOUNDARY][H.BOUNDARY],this._matrix[H.BOUNDARY][H.EXTERIOR]=n._matrix[H.BOUNDARY][H.EXTERIOR],this._matrix[H.EXTERIOR][H.INTERIOR]=n._matrix[H.EXTERIOR][H.INTERIOR],this._matrix[H.EXTERIOR][H.BOUNDARY]=n._matrix[H.EXTERIOR][H.BOUNDARY],this._matrix[H.EXTERIOR][H.EXTERIOR]=n._matrix[H.EXTERIOR][H.EXTERIOR]}}},{key:"matches",value:function(){if(Number.isInteger(arguments[0])&&"string"==typeof arguments[1]){var t=arguments[0],n=arguments[1];return n===St.SYM_DONTCARE||n===St.SYM_TRUE&&(t>=0||t===St.TRUE)||n===St.SYM_FALSE&&t===St.FALSE||n===St.SYM_P&&t===St.P||n===St.SYM_L&&t===St.L||n===St.SYM_A&&t===St.A}if("string"==typeof arguments[0]&&"string"==typeof arguments[1]){var r=arguments[1];return new e(arguments[0]).matches(r)}}},{key:"isTrue",value:function(t){return t>=0||t===St.TRUE}}]),e}(),Hn=function(){function e(){t(this,e),e.constructor_.apply(this,arguments)}return n(e,[{key:"size",value:function(){return this._size}},{key:"addAll",value:function(t){return null===t||0===t.length?null:(this.ensureCapacity(this._size+t.length),mt.arraycopy(t,0,this._data,this._size,t.length),void(this._size+=t.length))}},{key:"ensureCapacity",value:function(t){if(t<=this._data.length)return null;var e=Math.max(t,2*this._data.length);this._data=Rt.copyOf(this._data,e)}},{key:"toArray",value:function(){var t=new Array(this._size).fill(null);return mt.arraycopy(this._data,0,t,0,this._size),t}},{key:"add",value:function(t){this.ensureCapacity(this._size+1),this._data[this._size]=t,++this._size}}],[{key:"constructor_",value:function(){if(this._data=null,this._size=0,0===arguments.length)e.constructor_.call(this,10);else if(1===arguments.length){var t=arguments[0];this._data=new Array(t).fill(null)}}}]),e}(),qn=function(){function e(){t(this,e)}return n(e,[{key:"getChainStartIndices",value:function(t){var e=0,n=new Hn(Math.trunc(t.length/2));n.add(e);do{var r=this.findChainEnd(t,e);n.add(r),e=r}while(e<t.length-1);return n.toArray()}},{key:"findChainEnd",value:function(t,e){for(var n=Ne.quadrant(t[e],t[e+1]),r=e+1;r<t.length&&Ne.quadrant(t[r-1],t[r])===n;)r++;return r-1}},{key:"OLDgetChainStartIndices",value:function(t){var n=0,r=new ft;r.add(n);do{var i=this.findChainEnd(t,n);r.add(i),n=i}while(n<t.length-1);return e.toIntArray(r)}}],[{key:"toIntArray",value:function(t){for(var e=new Array(t.size()).fill(null),n=0;n<e.length;n++)e[n]=t.get(n).intValue();return e}}]),e}(),Wn=function(){function e(){t(this,e),e.constructor_.apply(this,arguments)}return n(e,[{key:"getCoordinates",value:function(){return this.pts}},{key:"getMaxX",value:function(t){var e=this.pts[this.startIndex[t]].x,n=this.pts[this.startIndex[t+1]].x;return e>n?e:n}},{key:"getMinX",value:function(t){var e=this.pts[this.startIndex[t]].x,n=this.pts[this.startIndex[t+1]].x;return e<n?e:n}},{key:"computeIntersectsForChain",value:function(){if(4===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2],r=arguments[3];this.computeIntersectsForChain(this.startIndex[t],this.startIndex[t+1],e,e.startIndex[n],e.startIndex[n+1],r)}else if(6===arguments.length){var i=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3],l=arguments[4],u=arguments[5];if(o-i==1&&l-a==1)return u.addIntersections(this.e,i,s.e,a),null;if(!this.overlaps(i,o,s,a,l))return null;var c=Math.trunc((i+o)/2),h=Math.trunc((a+l)/2);i<c&&(a<h&&this.computeIntersectsForChain(i,c,s,a,h,u),h<l&&this.computeIntersectsForChain(i,c,s,h,l,u)),c<o&&(a<h&&this.computeIntersectsForChain(c,o,s,a,h,u),h<l&&this.computeIntersectsForChain(c,o,s,h,l,u))}}},{key:"overlaps",value:function(t,e,n,r,i){return z.intersects(this.pts[t],this.pts[e],n.pts[r],n.pts[i])}},{key:"getStartIndexes",value:function(){return this.startIndex}},{key:"computeIntersects",value:function(t,e){for(var n=0;n<this.startIndex.length-1;n++)for(var r=0;r<t.startIndex.length-1;r++)this.computeIntersectsForChain(n,t,r,e)}}],[{key:"constructor_",value:function(){this.e=null,this.pts=null,this.startIndex=null;var t=arguments[0];this.e=t,this.pts=t.getCoordinates();var e=new qn;this.startIndex=e.getChainStartIndices(this.pts)}}]),e}(),Jn=function(){function e(){t(this,e),e.constructor_.apply(this,arguments)}return n(e,[{key:"getDepth",value:function(t,e){return this._depth[t][e]}},{key:"setDepth",value:function(t,e,n){this._depth[t][e]=n}},{key:"isNull",value:function(){if(0===arguments.length){for(var t=0;t<2;t++)for(var n=0;n<3;n++)if(this._depth[t][n]!==e.NULL_VALUE)return!1;return!0}if(1===arguments.length){var r=arguments[0];return this._depth[r][1]===e.NULL_VALUE}if(2===arguments.length){var i=arguments[0],o=arguments[1];return this._depth[i][o]===e.NULL_VALUE}}},{key:"normalize",value:function(){for(var t=0;t<2;t++)if(!this.isNull(t)){var e=this._depth[t][1];this._depth[t][2]<e&&(e=this._depth[t][2]),e<0&&(e=0);for(var n=1;n<3;n++){var r=0;this._depth[t][n]>e&&(r=1),this._depth[t][n]=r}}}},{key:"getDelta",value:function(t){return this._depth[t][Z.RIGHT]-this._depth[t][Z.LEFT]}},{key:"getLocation",value:function(t,e){return this._depth[t][e]<=0?H.EXTERIOR:H.INTERIOR}},{key:"toString",value:function(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]}},{key:"add",value:function(){if(1===arguments.length)for(var t=arguments[0],n=0;n<2;n++)for(var r=1;r<3;r++){var i=t.getLocation(n,r);i!==H.EXTERIOR&&i!==H.INTERIOR||(this.isNull(n,r)?this._depth[n][r]=e.depthAtLocation(i):this._depth[n][r]+=e.depthAtLocation(i))}else if(3===arguments.length){var o=arguments[0],s=arguments[1];arguments[2]===H.INTERIOR&&this._depth[o][s]++}}}],[{key:"constructor_",value:function(){this._depth=Array(2).fill().map((function(){return Array(3)}));for(var t=0;t<2;t++)for(var n=0;n<3;n++)this._depth[t][n]=e.NULL_VALUE}},{key:"depthAtLocation",value:function(t){return t===H.EXTERIOR?0:t===H.INTERIOR?1:e.NULL_VALUE}}]),e}();Jn.NULL_VALUE=-1;var Yn=function(e){r(s,e);var o=c(s);function s(){var e;return t(this,s),e=o.call(this),s.constructor_.apply(u(e),arguments),e}return n(s,[{key:"getDepth",value:function(){return this._depth}},{key:"getCollapsedEdge",value:function(){var t=new Array(2).fill(null);return t[0]=this.pts[0],t[1]=this.pts[1],new s(t,Ce.toLineLabel(this._label))}},{key:"isIsolated",value:function(){return this._isIsolated}},{key:"getCoordinates",value:function(){return this.pts}},{key:"setIsolated",value:function(t){this._isIsolated=t}},{key:"setName",value:function(t){this._name=t}},{key:"equals",value:function(t){if(!(t instanceof s))return!1;var e=t;if(this.pts.length!==e.pts.length)return!1;for(var n=!0,r=!0,i=this.pts.length,o=0;o<this.pts.length;o++)if(this.pts[o].equals2D(e.pts[o])||(n=!1),this.pts[o].equals2D(e.pts[--i])||(r=!1),!n&&!r)return!1;return!0}},{key:"getCoordinate",value:function(){if(0===arguments.length)return this.pts.length>0?this.pts[0]:null;if(1===arguments.length){var t=arguments[0];return this.pts[t]}}},{key:"print",value:function(t){t.print("edge "+this._name+": "),t.print("LINESTRING (");for(var e=0;e<this.pts.length;e++)e>0&&t.print(","),t.print(this.pts[e].x+" "+this.pts[e].y);t.print(")  "+this._label+" "+this._depthDelta)}},{key:"computeIM",value:function(t){s.updateIM(this._label,t)}},{key:"isCollapsed",value:function(){return!!this._label.isArea()&&3===this.pts.length&&!!this.pts[0].equals(this.pts[2])}},{key:"isClosed",value:function(){return this.pts[0].equals(this.pts[this.pts.length-1])}},{key:"getMaximumSegmentIndex",value:function(){return this.pts.length-1}},{key:"getDepthDelta",value:function(){return this._depthDelta}},{key:"getNumPoints",value:function(){return this.pts.length}},{key:"printReverse",value:function(t){t.print("edge "+this._name+": ");for(var e=this.pts.length-1;e>=0;e--)t.print(this.pts[e]+" ");t.println("")}},{key:"getMonotoneChainEdge",value:function(){return null===this._mce&&(this._mce=new Wn(this)),this._mce}},{key:"getEnvelope",value:function(){if(null===this._env){this._env=new z;for(var t=0;t<this.pts.length;t++)this._env.expandToInclude(this.pts[t])}return this._env}},{key:"addIntersection",value:function(t,e,n,r){var i=new G(t.getIntersection(r)),o=e,s=t.getEdgeDistance(n,r),a=o+1;if(a<this.pts.length){var l=this.pts[a];i.equals2D(l)&&(o=a,s=0)}this.eiList.add(i,o,s)}},{key:"toString",value:function(){var t=new Xt;t.append("edge "+this._name+": "),t.append("LINESTRING (");for(var e=0;e<this.pts.length;e++)e>0&&t.append(","),t.append(this.pts[e].x+" "+this.pts[e].y);return t.append(")  "+this._label+" "+this._depthDelta),t.toString()}},{key:"isPointwiseEqual",value:function(t){if(this.pts.length!==t.pts.length)return!1;for(var e=0;e<this.pts.length;e++)if(!this.pts[e].equals2D(t.pts[e]))return!1;return!0}},{key:"setDepthDelta",value:function(t){this._depthDelta=t}},{key:"getEdgeIntersectionList",value:function(){return this.eiList}},{key:"addIntersections",value:function(t,e,n){for(var r=0;r<t.getIntersectionNum();r++)this.addIntersection(t,e,n,r)}}],[{key:"constructor_",value:function(){if(this.pts=null,this._env=null,this.eiList=new zn(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new Jn,this._depthDelta=0,1===arguments.length){var t=arguments[0];s.constructor_.call(this,t,null)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.pts=e,this._label=n}}},{key:"updateIM",value:function(){if(!(2===arguments.length&&arguments[1]instanceof Vn&&arguments[0]instanceof Ce))return h(i(s),"updateIM",this).apply(this,arguments);var t=arguments[0],e=arguments[1];e.setAtLeastIfValid(t.getLocation(0,Z.ON),t.getLocation(1,Z.ON),1),t.isArea()&&(e.setAtLeastIfValid(t.getLocation(0,Z.LEFT),t.getLocation(1,Z.LEFT),2),e.setAtLeastIfValid(t.getLocation(0,Z.RIGHT),t.getLocation(1,Z.RIGHT),2))}}]),s}(Pe),Xn=function(){function e(){t(this,e),e.constructor_.apply(this,arguments)}return n(e,[{key:"setWorkingPrecisionModel",value:function(t){this._workingPrecisionModel=t}},{key:"insertUniqueEdge",value:function(t){var n=this._edgeList.findEqualEdge(t);if(null!==n){var r=n.getLabel(),i=t.getLabel();n.isPointwiseEqual(t)||(i=new Ce(t.getLabel())).flip(),r.merge(i);var o=e.depthDelta(i),s=n.getDepthDelta()+o;n.setDepthDelta(s)}else this._edgeList.add(t),t.setDepthDelta(e.depthDelta(t.getLabel()))}},{key:"buildSubgraphs",value:function(t,e){for(var n=new ft,r=t.iterator();r.hasNext();){var i=r.next(),o=i.getRightmostCoordinate(),s=new Sn(n).getDepth(o);i.computeDepth(s),i.findResultEdges(),n.add(i),e.add(i.getDirectedEdges(),i.getNodes())}}},{key:"createSubgraphs",value:function(t){for(var e=new ft,n=t.getNodes().iterator();n.hasNext();){var r=n.next();if(!r.isVisited()){var i=new gt;i.create(r),e.add(i)}}return Xe.sort(e,Xe.reverseOrder()),e}},{key:"createEmptyResultGeometry",value:function(){return this._geomFact.createPolygon()}},{key:"getNoder",value:function(t){if(null!==this._workingNoder)return this._workingNoder;var e=new vn,n=new _e;return n.setPrecisionModel(t),e.setSegmentIntersector(new Gn(n)),e}},{key:"buffer",value:function(t,e){var n=this._workingPrecisionModel;null===n&&(n=t.getPrecisionModel()),this._geomFact=t.getFactory();var r=new Cn(n,this._bufParams),i=new On(t,e,r).getCurves();if(i.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(i,n),this._graph=new ze(new Dn),this._graph.addEdges(this._edgeList.getEdges());var o=this.createSubgraphs(this._graph),s=new Ve(this._geomFact);this.buildSubgraphs(o,s);var a=s.getPolygons();return a.size()<=0?this.createEmptyResultGeometry():this._geomFact.buildGeometry(a)}},{key:"computeNodedEdges",value:function(t,e){var n=this.getNoder(e);n.computeNodes(t);for(var r=n.getNodedSubstrings().iterator();r.hasNext();){var i=r.next(),o=i.getCoordinates();if(2!==o.length||!o[0].equals2D(o[1])){var s=i.getData(),a=new Yn(i.getCoordinates(),new Ce(s));this.insertUniqueEdge(a)}}}},{key:"setNoder",value:function(t){this._workingNoder=t}}],[{key:"constructor_",value:function(){this._bufParams=null,this._workingPrecisionModel=null,this._workingNoder=null,this._geomFact=null,this._graph=null,this._edgeList=new Nn;var t=arguments[0];this._bufParams=t}},{key:"depthDelta",value:function(t){var e=t.getLocation(0,Z.LEFT),n=t.getLocation(0,Z.RIGHT);return e===H.INTERIOR&&n===H.EXTERIOR?1:e===H.EXTERIOR&&n===H.INTERIOR?-1:0}},{key:"convertSegStrings",value:function(t){for(var e=new ie,n=new ft;t.hasNext();){var r=t.next(),i=e.createLineString(r.getCoordinates());n.add(i)}return e.buildGeometry(n)}}]),e}(),Kn=function(){function e(){t(this,e),e.constructor_.apply(this,arguments)}return n(e,[{key:"rescale",value:function(){if(nt(arguments[0],q))for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.rescale(e.getCoordinates())}else if(arguments[0]instanceof Array){for(var n=arguments[0],r=0;r<n.length;r++)n[r].x=n[r].x/this._scaleFactor+this._offsetX,n[r].y=n[r].y/this._scaleFactor+this._offsetY;2===n.length&&n[0].equals2D(n[1])&&mt.out.println(n)}}},{key:"scale",value:function(){if(nt(arguments[0],q)){for(var t=arguments[0],e=new ft(t.size()),n=t.iterator();n.hasNext();){var r=n.next();e.add(new hn(this.scale(r.getCoordinates()),r.getData()))}return e}if(arguments[0]instanceof Array){for(var i=arguments[0],o=new Array(i.length).fill(null),s=0;s<i.length;s++)o[s]=new G(Math.round((i[s].x-this._offsetX)*this._scaleFactor),Math.round((i[s].y-this._offsetY)*this._scaleFactor),i[s].getZ());return Wt.removeRepeatedPoints(o)}}},{key:"isIntegerPrecision",value:function(){return 1===this._scaleFactor}},{key:"getNodedSubstrings",value:function(){var t=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(t),t}},{key:"computeNodes",value:function(t){var e=t;this._isScaled&&(e=this.scale(t)),this._noder.computeNodes(e)}},{key:"interfaces_",get:function(){return[yn]}}],[{key:"constructor_",value:function(){if(this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,2===arguments.length){var t=arguments[0],n=arguments[1];e.constructor_.call(this,t,n,0,0)}else if(4===arguments.length){var r=arguments[0],i=arguments[1];this._noder=r,this._scaleFactor=i,this._isScaled=!this.isIntegerPrecision()}}}]),e}(),Zn=function(){function e(){t(this,e),e.constructor_.apply(this,arguments)}return n(e,[{key:"checkEndPtVertexIntersections",value:function(){if(0===arguments.length)for(var t=this._segStrings.iterator();t.hasNext();){var e=t.next().getCoordinates();this.checkEndPtVertexIntersections(e[0],this._segStrings),this.checkEndPtVertexIntersections(e[e.length-1],this._segStrings)}else if(2===arguments.length)for(var n=arguments[0],r=arguments[1].iterator();r.hasNext();)for(var i=r.next().getCoordinates(),o=1;o<i.length-1;o++)if(i[o].equals(n))throw new L("found endpt/interior pt intersection at index "+o+" :pt "+n)}},{key:"checkInteriorIntersections",value:function(){if(0===arguments.length)for(var t=this._segStrings.iterator();t.hasNext();)for(var e=t.next(),n=this._segStrings.iterator();n.hasNext();){var r=n.next();this.checkInteriorIntersections(e,r)}else if(2===arguments.length)for(var i=arguments[0],o=arguments[1],s=i.getCoordinates(),a=o.getCoordinates(),l=0;l<s.length-1;l++)for(var u=0;u<a.length-1;u++)this.checkInteriorIntersections(i,l,o,u);else if(4===arguments.length){var c=arguments[0],h=arguments[1],d=arguments[2],f=arguments[3];if(c===d&&h===f)return null;var p=c.getCoordinates()[h],g=c.getCoordinates()[h+1],y=d.getCoordinates()[f],m=d.getCoordinates()[f+1];if(this._li.computeIntersection(p,g,y,m),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,p,g)||this.hasInteriorIntersection(this._li,y,m)))throw new L("found non-noded intersection at "+p+"-"+g+" and "+y+"-"+m)}}},{key:"checkValid",value:function(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()}},{key:"checkCollapses",value:function(){if(0===arguments.length)for(var t=this._segStrings.iterator();t.hasNext();){var e=t.next();this.checkCollapses(e)}else if(1===arguments.length)for(var n=arguments[0].getCoordinates(),r=0;r<n.length-2;r++)this.checkCollapse(n[r],n[r+1],n[r+2])}},{key:"hasInteriorIntersection",value:function(t,e,n){for(var r=0;r<t.getIntersectionNum();r++){var i=t.getIntersection(r);if(!i.equals(e)&&!i.equals(n))return!0}return!1}},{key:"checkCollapse",value:function(t,n,r){if(t.equals(r))throw new L("found non-noded collapse at "+e.fact.createLineString([t,n,r]))}}],[{key:"constructor_",value:function(){this._li=new _e,this._segStrings=null;var t=arguments[0];this._segStrings=t}}]),e}();Zn.fact=new ie;var Qn=function(){function e(){t(this,e),e.constructor_.apply(this,arguments)}return n(e,[{key:"intersectsScaled",value:function(t,e){var n=Math.min(t.x,e.x),r=Math.max(t.x,e.x),i=Math.min(t.y,e.y),o=Math.max(t.y,e.y),s=this._maxx<n||this._minx>r||this._maxy<i||this._miny>o;if(s)return!1;var a=this.intersectsToleranceSquare(t,e);return D.isTrue(!(s&&a),"Found bad envelope test"),a}},{key:"initCorners",value:function(t){var e=.5;this._minx=t.x-e,this._maxx=t.x+e,this._miny=t.y-e,this._maxy=t.y+e,this._corner[0]=new G(this._maxx,this._maxy),this._corner[1]=new G(this._minx,this._maxy),this._corner[2]=new G(this._minx,this._miny),this._corner[3]=new G(this._maxx,this._miny)}},{key:"intersects",value:function(t,e){return 1===this._scaleFactor?this.intersectsScaled(t,e):(this.copyScaled(t,this._p0Scaled),this.copyScaled(e,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))}},{key:"scale",value:function(t){return Math.round(t*this._scaleFactor)}},{key:"getCoordinate",value:function(){return this._originalPt}},{key:"copyScaled",value:function(t,e){e.x=this.scale(t.x),e.y=this.scale(t.y)}},{key:"getSafeEnvelope",value:function(){if(null===this._safeEnv){var t=e.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new z(this._originalPt.x-t,this._originalPt.x+t,this._originalPt.y-t,this._originalPt.y+t)}return this._safeEnv}},{key:"intersectsPixelClosure",value:function(t,e){return this._li.computeIntersection(t,e,this._corner[0],this._corner[1]),!!(this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[1],this._corner[2]),this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[2],this._corner[3]),this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[3],this._corner[0]),this._li.hasIntersection()))))}},{key:"intersectsToleranceSquare",value:function(t,e){var n=!1,r=!1;return this._li.computeIntersection(t,e,this._corner[0],this._corner[1]),!!(this._li.isProper()||(this._li.computeIntersection(t,e,this._corner[1],this._corner[2]),this._li.isProper()||(this._li.hasIntersection()&&(n=!0),this._li.computeIntersection(t,e,this._corner[2],this._corner[3]),this._li.isProper()||(this._li.hasIntersection()&&(r=!0),this._li.computeIntersection(t,e,this._corner[3],this._corner[0]),this._li.isProper()||n&&r||t.equals(this._pt)||e.equals(this._pt)))))}},{key:"addSnappedNode",value:function(t,e){var n=t.getCoordinate(e),r=t.getCoordinate(e+1);return!!this.intersects(n,r)&&(t.addIntersection(this.getCoordinate(),e),!0)}}],[{key:"constructor_",value:function(){this._li=null,this._pt=null,this._originalPt=null,this._ptScaled=null,this._p0Scaled=null,this._p1Scaled=null,this._scaleFactor=null,this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,this._corner=new Array(4).fill(null),this._safeEnv=null;var t=arguments[0],e=arguments[1],n=arguments[2];if(this._originalPt=t,this._pt=t,this._scaleFactor=e,this._li=n,e<=0)throw new v("Scale factor must be non-zero");1!==e&&(this._pt=new G(this.scale(t.x),this.scale(t.y)),this._p0Scaled=new G,this._p1Scaled=new G),this.initCorners(this._pt)}}]),e}();Qn.SAFE_ENV_EXPANSION_FACTOR=.75;var $n=function(){function e(){t(this,e),e.constructor_.apply(this,arguments)}return n(e,[{key:"select",value:function(){if(1===arguments.length);else if(2===arguments.length){var t=arguments[1];arguments[0].getLineSegment(t,this.selectedSegment),this.select(this.selectedSegment)}}}],[{key:"constructor_",value:function(){this.selectedSegment=new dn}}]),e}(),tr=function(){function e(){t(this,e),e.constructor_.apply(this,arguments)}return n(e,[{key:"snap",value:function(){if(1===arguments.length){var e=arguments[0];return this.snap(e,null,-1)}if(3===arguments.length){var r=arguments[0],i=arguments[1],o=arguments[2],s=r.getSafeEnvelope(),a=new er(r,i,o);return this._index.query(s,new(function(){function e(){t(this,e)}return n(e,[{key:"interfaces_",get:function(){return[Qe]}},{key:"visitItem",value:function(t){t.select(s,a)}}]),e}())),a.isNodeAdded()}}}],[{key:"constructor_",value:function(){this._index=null;var t=arguments[0];this._index=t}}]),e}(),er=function(e){r(s,e);var o=c(s);function s(){var e;return t(this,s),e=o.call(this),s.constructor_.apply(u(e),arguments),e}return n(s,[{key:"isNodeAdded",value:function(){return this._isNodeAdded}},{key:"select",value:function(){if(!(2===arguments.length&&Number.isInteger(arguments[1])&&arguments[0]instanceof pn))return h(i(s.prototype),"select",this).apply(this,arguments);var t=arguments[1],e=arguments[0].getContext();if(this._parentEdge===e&&(t===this._hotPixelVertexIndex||t+1===this._hotPixelVertexIndex))return null;this._isNodeAdded|=this._hotPixel.addSnappedNode(e,t)}}],[{key:"constructor_",value:function(){this._hotPixel=null,this._parentEdge=null,this._hotPixelVertexIndex=null,this._isNodeAdded=!1;var t=arguments[0],e=arguments[1],n=arguments[2];this._hotPixel=t,this._parentEdge=e,this._hotPixelVertexIndex=n}}]),s}($n);tr.HotPixelSnapAction=er;var nr=function(){function e(){t(this,e),e.constructor_.apply(this,arguments)}return n(e,[{key:"processIntersections",value:function(t,e,n,r){if(t===n&&e===r)return null;var i=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=n.getCoordinates()[r],a=n.getCoordinates()[r+1];if(this._li.computeIntersection(i,o,s,a),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(var l=0;l<this._li.getIntersectionNum();l++)this._interiorIntersections.add(this._li.getIntersection(l));t.addIntersections(this._li,e,0),n.addIntersections(this._li,r,1)}}},{key:"isDone",value:function(){return!1}},{key:"getInteriorIntersections",value:function(){return this._interiorIntersections}},{key:"interfaces_",get:function(){return[jn]}}],[{key:"constructor_",value:function(){this._li=null,this._interiorIntersections=null;var t=arguments[0];this._li=t,this._interiorIntersections=new ft}}]),e}(),rr=function(){function e(){t(this,e),e.constructor_.apply(this,arguments)}return n(e,[{key:"checkCorrectness",value:function(t){var e=hn.getNodedSubstrings(t),n=new Zn(e);try{n.checkValid()}catch(t){if(!(t instanceof m))throw t;t.printStackTrace()}}},{key:"getNodedSubstrings",value:function(){return hn.getNodedSubstrings(this._nodedSegStrings)}},{key:"snapRound",value:function(t,e){var n=this.findInteriorIntersections(t,e);this.computeIntersectionSnaps(n),this.computeVertexSnaps(t)}},{key:"findInteriorIntersections",value:function(t,e){var n=new nr(e);return this._noder.setSegmentIntersector(n),this._noder.computeNodes(t),n.getInteriorIntersections()}},{key:"computeVertexSnaps",value:function(){if(nt(arguments[0],q))for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.computeVertexSnaps(e)}else if(arguments[0]instanceof hn)for(var n=arguments[0],r=n.getCoordinates(),i=0;i<r.length;i++){var o=new Qn(r[i],this._scaleFactor,this._li);this._pointSnapper.snap(o,n,i)&&n.addIntersection(r[i],i)}}},{key:"computeNodes",value:function(t){this._nodedSegStrings=t,this._noder=new vn,this._pointSnapper=new tr(this._noder.getIndex()),this.snapRound(t,this._li)}},{key:"computeIntersectionSnaps",value:function(t){for(var e=t.iterator();e.hasNext();){var n=e.next(),r=new Qn(n,this._scaleFactor,this._li);this._pointSnapper.snap(r)}}},{key:"interfaces_",get:function(){return[yn]}}],[{key:"constructor_",value:function(){this._pm=null,this._li=null,this._scaleFactor=null,this._noder=null,this._pointSnapper=null,this._nodedSegStrings=null;var t=arguments[0];this._pm=t,this._li=new _e,this._li.setPrecisionModel(t),this._scaleFactor=t.getScale()}}]),e}(),ir=function(){function e(){t(this,e),e.constructor_.apply(this,arguments)}return n(e,[{key:"bufferFixedPrecision",value:function(t){var e=new Kn(new rr(new ee(1)),t.getScale()),n=new Xn(this._bufParams);n.setWorkingPrecisionModel(t),n.setNoder(e),this._resultGeometry=n.buffer(this._argGeom,this._distance)}},{key:"bufferReducedPrecision",value:function(){if(0===arguments.length){for(var t=e.MAX_PRECISION_DIGITS;t>=0;t--){try{this.bufferReducedPrecision(t)}catch(t){if(!(t instanceof ht))throw t;this._saveException=t}if(null!==this._resultGeometry)return null}throw this._saveException}if(1===arguments.length){var n=arguments[0],r=e.precisionScaleFactor(this._argGeom,this._distance,n),i=new ee(r);this.bufferFixedPrecision(i)}}},{key:"computeGeometry",value:function(){if(this.bufferOriginalPrecision(),null!==this._resultGeometry)return null;var t=this._argGeom.getFactory().getPrecisionModel();t.getType()===ee.FIXED?this.bufferFixedPrecision(t):this.bufferReducedPrecision()}},{key:"setQuadrantSegments",value:function(t){this._bufParams.setQuadrantSegments(t)}},{key:"bufferOriginalPrecision",value:function(){try{var t=new Xn(this._bufParams);this._resultGeometry=t.buffer(this._argGeom,this._distance)}catch(t){if(!(t instanceof L))throw t;this._saveException=t}}},{key:"getResultGeometry",value:function(t){return this._distance=t,this.computeGeometry(),this._resultGeometry}},{key:"setEndCapStyle",value:function(t){this._bufParams.setEndCapStyle(t)}}],[{key:"constructor_",value:function(){if(this._argGeom=null,this._distance=null,this._bufParams=new y,this._resultGeometry=null,this._saveException=null,1===arguments.length){var t=arguments[0];this._argGeom=t}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this._argGeom=e,this._bufParams=n}}},{key:"bufferOp",value:function(){if(2===arguments.length){var t=arguments[1];return new e(arguments[0]).getResultGeometry(t)}if(3===arguments.length){if(Number.isInteger(arguments[2])&&arguments[0]instanceof V&&"number"==typeof arguments[1]){var n=arguments[1],r=arguments[2],i=new e(arguments[0]);return i.setQuadrantSegments(r),i.getResultGeometry(n)}if(arguments[2]instanceof y&&arguments[0]instanceof V&&"number"==typeof arguments[1]){var o=arguments[1];return new e(arguments[0],arguments[2]).getResultGeometry(o)}}else if(4===arguments.length){var s=arguments[1],a=arguments[2],l=arguments[3],u=new e(arguments[0]);return u.setQuadrantSegments(a),u.setEndCapStyle(l),u.getResultGeometry(s)}}},{key:"precisionScaleFactor",value:function(t,e,n){var r=t.getEnvelopeInternal(),i=vt.max(Math.abs(r.getMaxX()),Math.abs(r.getMaxY()),Math.abs(r.getMinX()),Math.abs(r.getMinY()))+2*(e>0?e:0),o=n-Math.trunc(Math.log(i)/Math.log(10)+1);return Math.pow(10,o)}}]),e}();ir.CAP_ROUND=y.CAP_ROUND,ir.CAP_BUTT=y.CAP_FLAT,ir.CAP_FLAT=y.CAP_FLAT,ir.CAP_SQUARE=y.CAP_SQUARE,ir.MAX_PRECISION_DIGITS=12;var or=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],sr=function(){function e(n){t(this,e),this.geometryFactory=n||new ie}return n(e,[{key:"read",value:function(t){var e,n=(e="string"==typeof t?JSON.parse(t):t).type;if(!ar[n])throw new Error("Unknown GeoJSON type: "+e.type);return-1!==or.indexOf(n)?ar[n].call(this,e.coordinates):"GeometryCollection"===n?ar[n].call(this,e.geometries):ar[n].call(this,e)}},{key:"write",value:function(t){var e=t.getGeometryType();if(!lr[e])throw new Error("Geometry is not supported");return lr[e].call(this,t)}}]),e}(),ar={Feature:function(t){var e={};for(var n in t)e[n]=t[n];if(t.geometry){var r=t.geometry.type;if(!ar[r])throw new Error("Unknown GeoJSON type: "+t.type);e.geometry=this.read(t.geometry)}return t.bbox&&(e.bbox=ar.bbox.call(this,t.bbox)),e},FeatureCollection:function(t){var e={};if(t.features){e.features=[];for(var n=0;n<t.features.length;++n)e.features.push(this.read(t.features[n]))}return t.bbox&&(e.bbox=this.parse.bbox.call(this,t.bbox)),e},coordinates:function(t){for(var e=[],n=0;n<t.length;++n){var r=t[n];e.push(a(G,d(r)))}return e},bbox:function(t){return this.geometryFactory.createLinearRing([new G(t[0],t[1]),new G(t[2],t[1]),new G(t[2],t[3]),new G(t[0],t[3]),new G(t[0],t[1])])},Point:function(t){var e=a(G,d(t));return this.geometryFactory.createPoint(e)},MultiPoint:function(t){for(var e=[],n=0;n<t.length;++n)e.push(ar.Point.call(this,t[n]));return this.geometryFactory.createMultiPoint(e)},LineString:function(t){var e=ar.coordinates.call(this,t);return this.geometryFactory.createLineString(e)},MultiLineString:function(t){for(var e=[],n=0;n<t.length;++n)e.push(ar.LineString.call(this,t[n]));return this.geometryFactory.createMultiLineString(e)},Polygon:function(t){for(var e=ar.coordinates.call(this,t[0]),n=this.geometryFactory.createLinearRing(e),r=[],i=1;i<t.length;++i){var o=t[i],s=ar.coordinates.call(this,o),a=this.geometryFactory.createLinearRing(s);r.push(a)}return this.geometryFactory.createPolygon(n,r)},MultiPolygon:function(t){for(var e=[],n=0;n<t.length;++n){var r=t[n];e.push(ar.Polygon.call(this,r))}return this.geometryFactory.createMultiPolygon(e)},GeometryCollection:function(t){for(var e=[],n=0;n<t.length;++n){var r=t[n];e.push(this.read(r))}return this.geometryFactory.createGeometryCollection(e)}},lr={coordinate:function(t){var e=[t.x,t.y];return t.z&&e.push(t.z),t.m&&e.push(t.m),e},Point:function(t){return{type:"Point",coordinates:lr.coordinate.call(this,t.getCoordinate())}},MultiPoint:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var r=t._geometries[n],i=lr.Point.call(this,r);e.push(i.coordinates)}return{type:"MultiPoint",coordinates:e}},LineString:function(t){for(var e=[],n=t.getCoordinates(),r=0;r<n.length;++r){var i=n[r];e.push(lr.coordinate.call(this,i))}return{type:"LineString",coordinates:e}},MultiLineString:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var r=t._geometries[n],i=lr.LineString.call(this,r);e.push(i.coordinates)}return{type:"MultiLineString",coordinates:e}},Polygon:function(t){var e=[],n=lr.LineString.call(this,t._shell);e.push(n.coordinates);for(var r=0;r<t._holes.length;++r){var i=t._holes[r],o=lr.LineString.call(this,i);e.push(o.coordinates)}return{type:"Polygon",coordinates:e}},MultiPolygon:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var r=t._geometries[n],i=lr.Polygon.call(this,r);e.push(i.coordinates)}return{type:"MultiPolygon",coordinates:e}},GeometryCollection:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var r=t._geometries[n],i=r.getGeometryType();e.push(lr[i].call(this,r))}return{type:"GeometryCollection",geometries:e}}};return{BufferOp:ir,GeoJSONReader:function(){function e(n){t(this,e),this.parser=new sr(n||new ie)}return n(e,[{key:"read",value:function(t){return this.parser.read(t)}}]),e}(),GeoJSONWriter:function(){function e(){t(this,e),this.parser=new sr(this.geometryFactory)}return n(e,[{key:"write",value:function(t){return this.parser.write(t)}}]),e}()}}()},17965:(t,e,n)=>{"use strict";var r=n(16426),i={"text/plain":"Text","text/html":"Url",default:"Text"};t.exports=function(t,e){var n,o,s,a,l,u,c=!1;e||(e={}),n=e.debug||!1;try{if(s=r(),a=document.createRange(),l=document.getSelection(),(u=document.createElement("span")).textContent=t,u.ariaHidden="true",u.style.all="unset",u.style.position="fixed",u.style.top=0,u.style.clip="rect(0, 0, 0, 0)",u.style.whiteSpace="pre",u.style.webkitUserSelect="text",u.style.MozUserSelect="text",u.style.msUserSelect="text",u.style.userSelect="text",u.addEventListener("copy",(function(r){if(r.stopPropagation(),e.format)if(r.preventDefault(),void 0===r.clipboardData){n&&console.warn("unable to use e.clipboardData"),n&&console.warn("trying IE specific stuff"),window.clipboardData.clearData();var o=i[e.format]||i.default;window.clipboardData.setData(o,t)}else r.clipboardData.clearData(),r.clipboardData.setData(e.format,t);e.onCopy&&(r.preventDefault(),e.onCopy(r.clipboardData))})),document.body.appendChild(u),a.selectNodeContents(u),l.addRange(a),!document.execCommand("copy"))throw new Error("copy command was unsuccessful");c=!0}catch(r){n&&console.error("unable to copy using execCommand: ",r),n&&console.warn("trying IE specific stuff");try{window.clipboardData.setData(e.format||"text",t),e.onCopy&&e.onCopy(window.clipboardData),c=!0}catch(r){n&&console.error("unable to copy using clipboardData: ",r),n&&console.error("falling back to prompt"),o=function(t){var e=(/mac os x/i.test(navigator.userAgent)?"⌘":"Ctrl")+"+C";return t.replace(/#{\s*key\s*}/g,e)}("message"in e?e.message:"Copy to clipboard: #{key}, Enter"),window.prompt(o,t)}}finally{l&&("function"==typeof l.removeRange?l.removeRange(a):l.removeAllRanges()),u&&document.body.removeChild(u),s()}return c}},15926:(t,e,n)=>{"use strict";n.d(e,{Tj:()=>s,$I:()=>a,hZ:()=>g});var r="$";function i(){}function o(t,e){var n=new i;if(t instanceof i)t.each((function(t,e){n.set(e,t)}));else if(Array.isArray(t)){var r,o=-1,s=t.length;if(null==e)for(;++o<s;)n.set(o,t[o]);else for(;++o<s;)n.set(e(r=t[o],o,t),r)}else if(t)for(var a in t)n.set(a,t[a]);return n}i.prototype=o.prototype={constructor:i,has:function(t){return r+t in this},get:function(t){return this[r+t]},set:function(t,e){return this[r+t]=e,this},remove:function(t){var e=r+t;return e in this&&delete this[e]},clear:function(){for(var t in this)t[0]===r&&delete this[t]},keys:function(){var t=[];for(var e in this)e[0]===r&&t.push(e.slice(1));return t},values:function(){var t=[];for(var e in this)e[0]===r&&t.push(this[e]);return t},entries:function(){var t=[];for(var e in this)e[0]===r&&t.push({key:e.slice(1),value:this[e]});return t},size:function(){var t=0;for(var e in this)e[0]===r&&++t;return t},empty:function(){for(var t in this)if(t[0]===r)return!1;return!0},each:function(t){for(var e in this)e[0]===r&&t(this[e],e.slice(1),this)}};const s=o;function a(){var t,e,n,r=[],i=[];function o(n,i,a,l){if(i>=r.length)return null!=t&&n.sort(t),null!=e?e(n):n;for(var u,c,h,d=-1,f=n.length,p=r[i++],g=s(),y=a();++d<f;)(h=g.get(u=p(c=n[d])+""))?h.push(c):g.set(u,[c]);return g.each((function(t,e){l(y,e,o(t,i,a,l))})),y}function a(t,n){if(++n>r.length)return t;var o,s=i[n-1];return null!=e&&n>=r.length?o=t.entries():(o=[],t.each((function(t,e){o.push({key:e,values:a(t,n)})}))),null!=s?o.sort((function(t,e){return s(t.key,e.key)})):o}return n={object:function(t){return o(t,0,l,u)},map:function(t){return o(t,0,c,h)},entries:function(t){return a(o(t,0,c,h),0)},key:function(t){return r.push(t),n},sortKeys:function(t){return i[r.length-1]=t,n},sortValues:function(e){return t=e,n},rollup:function(t){return e=t,n}}}function l(){return{}}function u(t,e,n){t[e]=n}function c(){return s()}function h(t,e,n){t.set(e,n)}function d(){}var f=s.prototype;function p(t,e){var n=new d;if(t instanceof d)t.each((function(t){n.add(t)}));else if(t){var r=-1,i=t.length;if(null==e)for(;++r<i;)n.add(t[r]);else for(;++r<i;)n.add(e(t[r],r,t))}return n}d.prototype=p.prototype={constructor:d,has:f.has,add:function(t){return this[r+(t+="")]=t,this},remove:f.remove,clear:f.clear,values:f.keys,size:f.size,empty:f.empty,each:f.each};const g=p},39515:(t,e,n)=>{"use strict";function r(){return new i}function i(){this.reset()}n.r(e),n.d(e,{geoAlbers:()=>xr,geoAlbersUsa:()=>wr,geoArea:()=>X,geoAzimuthalEqualArea:()=>Mr,geoAzimuthalEqualAreaRaw:()=>Er,geoAzimuthalEquidistant:()=>Tr,geoAzimuthalEquidistantRaw:()=>Pr,geoBounds:()=>Ut,geoCentroid:()=>ee,geoCircle:()=>de,geoClipExtent:()=>Se,geoConicConformal:()=>kr,geoConicConformalRaw:()=>Lr,geoConicEqualArea:()=>Ar,geoConicEqualAreaRaw:()=>_r,geoConicEquidistant:()=>jr,geoConicEquidistantRaw:()=>Nr,geoContains:()=>Ye,geoDistance:()=>je,geoEquirectangular:()=>Fr,geoEquirectangularRaw:()=>Dr,geoGnomonic:()=>Ur,geoGnomonicRaw:()=>Gr,geoGraticule:()=>Ze,geoGraticule10:()=>Qe,geoIdentity:()=>Vr,geoInterpolate:()=>$e,geoLength:()=>De,geoMercator:()=>Ir,geoMercatorRaw:()=>Or,geoNaturalEarth1:()=>qr,geoNaturalEarth1Raw:()=>Hr,geoOrthographic:()=>Jr,geoOrthographicRaw:()=>Wr,geoPath:()=>rr,geoProjection:()=>mr,geoProjectionMutator:()=>vr,geoRotation:()=>ue,geoStereographic:()=>Xr,geoStereographicRaw:()=>Yr,geoStream:()=>D,geoTransform:()=>lr,geoTransverseMercator:()=>Zr,geoTransverseMercatorRaw:()=>Kr}),i.prototype={constructor:i,reset:function(){this.s=this.t=0},add:function(t){s(o,t,this.t),s(this,o.s,this.s),this.s?this.t+=o.t:this.s=o.t},valueOf:function(){return this.s}};var o=new i;function s(t,e,n){var r=t.s=e+n,i=r-e,o=r-i;t.t=e-o+(n-i)}var a=1e-6,l=1e-12,u=Math.PI,c=u/2,h=u/4,d=2*u,f=180/u,p=u/180,g=Math.abs,y=Math.atan,m=Math.atan2,v=Math.cos,b=Math.ceil,_=Math.exp,A=(Math.floor,Math.log),x=Math.pow,w=Math.sin,C=Math.sign||function(t){return t>0?1:t<0?-1:0},S=Math.sqrt,E=Math.tan;function M(t){return t>1?0:t<-1?u:Math.acos(t)}function P(t){return t>1?c:t<-1?-c:Math.asin(t)}function T(t){return(t=w(t/2))*t}function O(){}function I(t,e){t&&B.hasOwnProperty(t.type)&&B[t.type](t,e)}var R={Feature:function(t,e){I(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,r=-1,i=n.length;++r<i;)I(n[r].geometry,e)}},B={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)t=n[r],e.point(t[0],t[1],t[2])},LineString:function(t,e){L(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)L(n[r],e,0)},Polygon:function(t,e){k(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)k(n[r],e)},GeometryCollection:function(t,e){for(var n=t.geometries,r=-1,i=n.length;++r<i;)I(n[r],e)}};function L(t,e,n){var r,i=-1,o=t.length-n;for(e.lineStart();++i<o;)r=t[i],e.point(r[0],r[1],r[2]);e.lineEnd()}function k(t,e){var n=-1,r=t.length;for(e.polygonStart();++n<r;)L(t[n],e,1);e.polygonEnd()}function D(t,e){t&&R.hasOwnProperty(t.type)?R[t.type](t,e):I(t,e)}var F,N,j,G,U,z=r(),V=r(),H={point:O,lineStart:O,lineEnd:O,polygonStart:function(){z.reset(),H.lineStart=q,H.lineEnd=W},polygonEnd:function(){var t=+z;V.add(t<0?d+t:t),this.lineStart=this.lineEnd=this.point=O},sphere:function(){V.add(d)}};function q(){H.point=J}function W(){Y(F,N)}function J(t,e){H.point=Y,F=t,N=e,j=t*=p,G=v(e=(e*=p)/2+h),U=w(e)}function Y(t,e){var n=(t*=p)-j,r=n>=0?1:-1,i=r*n,o=v(e=(e*=p)/2+h),s=w(e),a=U*s,l=G*o+a*v(i),u=a*r*w(i);z.add(m(u,l)),j=t,G=o,U=s}function X(t){return V.reset(),D(t,H),2*V}function K(t){return[m(t[1],t[0]),P(t[2])]}function Z(t){var e=t[0],n=t[1],r=v(n);return[r*v(e),r*w(e),w(n)]}function Q(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function $(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function tt(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function et(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function nt(t){var e=S(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}var rt,it,ot,st,at,lt,ut,ct,ht,dt,ft,pt,gt,yt,mt,vt,bt,_t,At,xt,wt,Ct,St,Et,Mt,Pt,Tt=r(),Ot={point:It,lineStart:Bt,lineEnd:Lt,polygonStart:function(){Ot.point=kt,Ot.lineStart=Dt,Ot.lineEnd=Ft,Tt.reset(),H.polygonStart()},polygonEnd:function(){H.polygonEnd(),Ot.point=It,Ot.lineStart=Bt,Ot.lineEnd=Lt,z<0?(rt=-(ot=180),it=-(st=90)):Tt>a?st=90:Tt<-a&&(it=-90),dt[0]=rt,dt[1]=ot}};function It(t,e){ht.push(dt=[rt=t,ot=t]),e<it&&(it=e),e>st&&(st=e)}function Rt(t,e){var n=Z([t*p,e*p]);if(ct){var r=$(ct,n),i=$([r[1],-r[0],0],r);nt(i),i=K(i);var o,s=t-at,a=s>0?1:-1,l=i[0]*f*a,u=g(s)>180;u^(a*at<l&&l<a*t)?(o=i[1]*f)>st&&(st=o):u^(a*at<(l=(l+360)%360-180)&&l<a*t)?(o=-i[1]*f)<it&&(it=o):(e<it&&(it=e),e>st&&(st=e)),u?t<at?Nt(rt,t)>Nt(rt,ot)&&(ot=t):Nt(t,ot)>Nt(rt,ot)&&(rt=t):ot>=rt?(t<rt&&(rt=t),t>ot&&(ot=t)):t>at?Nt(rt,t)>Nt(rt,ot)&&(ot=t):Nt(t,ot)>Nt(rt,ot)&&(rt=t)}else ht.push(dt=[rt=t,ot=t]);e<it&&(it=e),e>st&&(st=e),ct=n,at=t}function Bt(){Ot.point=Rt}function Lt(){dt[0]=rt,dt[1]=ot,Ot.point=It,ct=null}function kt(t,e){if(ct){var n=t-at;Tt.add(g(n)>180?n+(n>0?360:-360):n)}else lt=t,ut=e;H.point(t,e),Rt(t,e)}function Dt(){H.lineStart()}function Ft(){kt(lt,ut),H.lineEnd(),g(Tt)>a&&(rt=-(ot=180)),dt[0]=rt,dt[1]=ot,ct=null}function Nt(t,e){return(e-=t)<0?e+360:e}function jt(t,e){return t[0]-e[0]}function Gt(t,e){return t[0]<=t[1]?t[0]<=e&&e<=t[1]:e<t[0]||t[1]<e}function Ut(t){var e,n,r,i,o,s,a;if(st=ot=-(rt=it=1/0),ht=[],D(t,Ot),n=ht.length){for(ht.sort(jt),e=1,o=[r=ht[0]];e<n;++e)Gt(r,(i=ht[e])[0])||Gt(r,i[1])?(Nt(r[0],i[1])>Nt(r[0],r[1])&&(r[1]=i[1]),Nt(i[0],r[1])>Nt(r[0],r[1])&&(r[0]=i[0])):o.push(r=i);for(s=-1/0,e=0,r=o[n=o.length-1];e<=n;r=i,++e)i=o[e],(a=Nt(r[1],i[0]))>s&&(s=a,rt=i[0],ot=r[1])}return ht=dt=null,rt===1/0||it===1/0?[[NaN,NaN],[NaN,NaN]]:[[rt,it],[ot,st]]}var zt,Vt,Ht={sphere:O,point:qt,lineStart:Jt,lineEnd:Kt,polygonStart:function(){Ht.lineStart=Zt,Ht.lineEnd=Qt},polygonEnd:function(){Ht.lineStart=Jt,Ht.lineEnd=Kt}};function qt(t,e){t*=p;var n=v(e*=p);Wt(n*v(t),n*w(t),w(e))}function Wt(t,e,n){++ft,gt+=(t-gt)/ft,yt+=(e-yt)/ft,mt+=(n-mt)/ft}function Jt(){Ht.point=Yt}function Yt(t,e){t*=p;var n=v(e*=p);Et=n*v(t),Mt=n*w(t),Pt=w(e),Ht.point=Xt,Wt(Et,Mt,Pt)}function Xt(t,e){t*=p;var n=v(e*=p),r=n*v(t),i=n*w(t),o=w(e),s=m(S((s=Mt*o-Pt*i)*s+(s=Pt*r-Et*o)*s+(s=Et*i-Mt*r)*s),Et*r+Mt*i+Pt*o);pt+=s,vt+=s*(Et+(Et=r)),bt+=s*(Mt+(Mt=i)),_t+=s*(Pt+(Pt=o)),Wt(Et,Mt,Pt)}function Kt(){Ht.point=qt}function Zt(){Ht.point=$t}function Qt(){te(Ct,St),Ht.point=qt}function $t(t,e){Ct=t,St=e,t*=p,e*=p,Ht.point=te;var n=v(e);Et=n*v(t),Mt=n*w(t),Pt=w(e),Wt(Et,Mt,Pt)}function te(t,e){t*=p;var n=v(e*=p),r=n*v(t),i=n*w(t),o=w(e),s=Mt*o-Pt*i,a=Pt*r-Et*o,l=Et*i-Mt*r,u=S(s*s+a*a+l*l),c=P(u),h=u&&-c/u;At+=h*s,xt+=h*a,wt+=h*l,pt+=c,vt+=c*(Et+(Et=r)),bt+=c*(Mt+(Mt=i)),_t+=c*(Pt+(Pt=o)),Wt(Et,Mt,Pt)}function ee(t){ft=pt=gt=yt=mt=vt=bt=_t=At=xt=wt=0,D(t,Ht);var e=At,n=xt,r=wt,i=e*e+n*n+r*r;return i<l&&(e=vt,n=bt,r=_t,pt<a&&(e=gt,n=yt,r=mt),(i=e*e+n*n+r*r)<l)?[NaN,NaN]:[m(n,e)*f,P(r/S(i))*f]}function ne(t){return function(){return t}}function re(t,e){function n(n,r){return n=t(n,r),e(n[0],n[1])}return t.invert&&e.invert&&(n.invert=function(n,r){return(n=e.invert(n,r))&&t.invert(n[0],n[1])}),n}function ie(t,e){return[t>u?t-d:t<-u?t+d:t,e]}function oe(t,e,n){return(t%=d)?e||n?re(ae(t),le(e,n)):ae(t):e||n?le(e,n):ie}function se(t){return function(e,n){return[(e+=t)>u?e-d:e<-u?e+d:e,n]}}function ae(t){var e=se(t);return e.invert=se(-t),e}function le(t,e){var n=v(t),r=w(t),i=v(e),o=w(e);function s(t,e){var s=v(e),a=v(t)*s,l=w(t)*s,u=w(e),c=u*n+a*r;return[m(l*i-c*o,a*n-u*r),P(c*i+l*o)]}return s.invert=function(t,e){var s=v(e),a=v(t)*s,l=w(t)*s,u=w(e),c=u*i-l*o;return[m(l*i+u*o,a*n+c*r),P(c*n-a*r)]},s}function ue(t){function e(e){return(e=t(e[0]*p,e[1]*p))[0]*=f,e[1]*=f,e}return t=oe(t[0]*p,t[1]*p,t.length>2?t[2]*p:0),e.invert=function(e){return(e=t.invert(e[0]*p,e[1]*p))[0]*=f,e[1]*=f,e},e}function ce(t,e,n,r,i,o){if(n){var s=v(e),a=w(e),l=r*n;null==i?(i=e+r*d,o=e-l/2):(i=he(s,i),o=he(s,o),(r>0?i<o:i>o)&&(i+=r*d));for(var u,c=i;r>0?c>o:c<o;c-=l)u=K([s,-a*v(c),-a*w(c)]),t.point(u[0],u[1])}}function he(t,e){(e=Z(e))[0]-=t,nt(e);var n=M(-e[1]);return((-e[2]<0?-n:n)+d-a)%d}function de(){var t,e,n=ne([0,0]),r=ne(90),i=ne(6),o={point:function(n,r){t.push(n=e(n,r)),n[0]*=f,n[1]*=f}};function s(){var s=n.apply(this,arguments),a=r.apply(this,arguments)*p,l=i.apply(this,arguments)*p;return t=[],e=oe(-s[0]*p,-s[1]*p,0).invert,ce(o,a,l,1),s={type:"Polygon",coordinates:[t]},t=e=null,s}return s.center=function(t){return arguments.length?(n="function"==typeof t?t:ne([+t[0],+t[1]]),s):n},s.radius=function(t){return arguments.length?(r="function"==typeof t?t:ne(+t),s):r},s.precision=function(t){return arguments.length?(i="function"==typeof t?t:ne(+t),s):i},s}function fe(){var t,e=[];return{point:function(e,n){t.push([e,n])},lineStart:function(){e.push(t=[])},lineEnd:O,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function pe(t,e){return g(t[0]-e[0])<a&&g(t[1]-e[1])<a}function ge(t,e,n,r){this.x=t,this.z=e,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function ye(t,e,n,r,i){var o,s,a=[],l=[];if(t.forEach((function(t){if(!((e=t.length-1)<=0)){var e,n,r=t[0],s=t[e];if(pe(r,s)){for(i.lineStart(),o=0;o<e;++o)i.point((r=t[o])[0],r[1]);i.lineEnd()}else a.push(n=new ge(r,t,null,!0)),l.push(n.o=new ge(r,null,n,!1)),a.push(n=new ge(s,t,null,!1)),l.push(n.o=new ge(s,null,n,!0))}})),a.length){for(l.sort(e),me(a),me(l),o=0,s=l.length;o<s;++o)l[o].e=n=!n;for(var u,c,h=a[0];;){for(var d=h,f=!0;d.v;)if((d=d.n)===h)return;u=d.z,i.lineStart();do{if(d.v=d.o.v=!0,d.e){if(f)for(o=0,s=u.length;o<s;++o)i.point((c=u[o])[0],c[1]);else r(d.x,d.n.x,1,i);d=d.n}else{if(f)for(u=d.p.z,o=u.length-1;o>=0;--o)i.point((c=u[o])[0],c[1]);else r(d.x,d.p.x,-1,i);d=d.p}u=(d=d.o).z,f=!f}while(!d.v);i.lineEnd()}}}function me(t){if(e=t.length){for(var e,n,r=0,i=t[0];++r<e;)i.n=n=t[r],n.p=i,i=n;i.n=n=t[0],n.p=i}}function ve(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}ie.invert=ie,1===(zt=ve).length&&(Vt=zt,zt=function(t,e){return ve(Vt(t),e)});var be=Array.prototype;function _e(t){for(var e,n,r,i=t.length,o=-1,s=0;++o<i;)s+=t[o].length;for(n=new Array(s);--i>=0;)for(e=(r=t[i]).length;--e>=0;)n[--s]=r[e];return n}function Ae(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((e-t)/n)),o=new Array(i);++r<i;)o[r]=t+r*n;return o}be.slice,be.map,Math.sqrt(50),Math.sqrt(10),Math.sqrt(2);var xe=1e9,we=-xe;function Ce(t,e,n,r){function i(i,o){return t<=i&&i<=n&&e<=o&&o<=r}function o(i,o,a,l){var c=0,h=0;if(null==i||(c=s(i,a))!==(h=s(o,a))||u(i,o)<0^a>0)do{l.point(0===c||3===c?t:n,c>1?r:e)}while((c=(c+a+4)%4)!==h);else l.point(o[0],o[1])}function s(r,i){return g(r[0]-t)<a?i>0?0:3:g(r[0]-n)<a?i>0?2:1:g(r[1]-e)<a?i>0?1:0:i>0?3:2}function l(t,e){return u(t.x,e.x)}function u(t,e){var n=s(t,1),r=s(e,1);return n!==r?n-r:0===n?e[1]-t[1]:1===n?t[0]-e[0]:2===n?t[1]-e[1]:e[0]-t[0]}return function(s){var a,u,c,h,d,f,p,g,y,m,v,b=s,_=fe(),A={point:x,lineStart:function(){A.point=w,u&&u.push(c=[]),m=!0,y=!1,p=g=NaN},lineEnd:function(){a&&(w(h,d),f&&y&&_.rejoin(),a.push(_.result())),A.point=x,y&&b.lineEnd()},polygonStart:function(){b=_,a=[],u=[],v=!0},polygonEnd:function(){var e=function(){for(var e=0,n=0,i=u.length;n<i;++n)for(var o,s,a=u[n],l=1,c=a.length,h=a[0],d=h[0],f=h[1];l<c;++l)o=d,s=f,d=(h=a[l])[0],f=h[1],s<=r?f>r&&(d-o)*(r-s)>(f-s)*(t-o)&&++e:f<=r&&(d-o)*(r-s)<(f-s)*(t-o)&&--e;return e}(),n=v&&e,i=(a=_e(a)).length;(n||i)&&(s.polygonStart(),n&&(s.lineStart(),o(null,null,1,s),s.lineEnd()),i&&ye(a,l,e,o,s),s.polygonEnd()),b=s,a=u=c=null}};function x(t,e){i(t,e)&&b.point(t,e)}function w(o,s){var a=i(o,s);if(u&&c.push([o,s]),m)h=o,d=s,f=a,m=!1,a&&(b.lineStart(),b.point(o,s));else if(a&&y)b.point(o,s);else{var l=[p=Math.max(we,Math.min(xe,p)),g=Math.max(we,Math.min(xe,g))],_=[o=Math.max(we,Math.min(xe,o)),s=Math.max(we,Math.min(xe,s))];!function(t,e,n,r,i,o){var s,a=t[0],l=t[1],u=0,c=1,h=e[0]-a,d=e[1]-l;if(s=n-a,h||!(s>0)){if(s/=h,h<0){if(s<u)return;s<c&&(c=s)}else if(h>0){if(s>c)return;s>u&&(u=s)}if(s=i-a,h||!(s<0)){if(s/=h,h<0){if(s>c)return;s>u&&(u=s)}else if(h>0){if(s<u)return;s<c&&(c=s)}if(s=r-l,d||!(s>0)){if(s/=d,d<0){if(s<u)return;s<c&&(c=s)}else if(d>0){if(s>c)return;s>u&&(u=s)}if(s=o-l,d||!(s<0)){if(s/=d,d<0){if(s>c)return;s>u&&(u=s)}else if(d>0){if(s<u)return;s<c&&(c=s)}return u>0&&(t[0]=a+u*h,t[1]=l+u*d),c<1&&(e[0]=a+c*h,e[1]=l+c*d),!0}}}}}(l,_,t,e,n,r)?a&&(b.lineStart(),b.point(o,s),v=!1):(y||(b.lineStart(),b.point(l[0],l[1])),b.point(_[0],_[1]),a||b.lineEnd(),v=!1)}p=o,g=s,y=a}return A}}function Se(){var t,e,n,r=0,i=0,o=960,s=500;return n={stream:function(n){return t&&e===n?t:t=Ce(r,i,o,s)(e=n)},extent:function(a){return arguments.length?(r=+a[0][0],i=+a[0][1],o=+a[1][0],s=+a[1][1],t=e=null,n):[[r,i],[o,s]]}}}var Ee=r();function Me(t,e){var n=e[0],r=e[1],i=[w(n),-v(n),0],o=0,s=0;Ee.reset();for(var l=0,c=t.length;l<c;++l)if(p=(f=t[l]).length)for(var f,p,g=f[p-1],y=g[0],b=g[1]/2+h,_=w(b),A=v(b),x=0;x<p;++x,y=S,_=M,A=T,g=C){var C=f[x],S=C[0],E=C[1]/2+h,M=w(E),T=v(E),O=S-y,I=O>=0?1:-1,R=I*O,B=R>u,L=_*M;if(Ee.add(m(L*I*w(R),A*T+L*v(R))),o+=B?O+I*d:O,B^y>=n^S>=n){var k=$(Z(g),Z(C));nt(k);var D=$(i,k);nt(D);var F=(B^O>=0?-1:1)*P(D[2]);(r>F||r===F&&(k[0]||k[1]))&&(s+=B^O>=0?1:-1)}}return(o<-a||o<a&&Ee<-a)^1&s}var Pe,Te,Oe,Ie=r(),Re={sphere:O,point:O,lineStart:function(){Re.point=Le,Re.lineEnd=Be},lineEnd:O,polygonStart:O,polygonEnd:O};function Be(){Re.point=Re.lineEnd=O}function Le(t,e){Pe=t*=p,Te=w(e*=p),Oe=v(e),Re.point=ke}function ke(t,e){t*=p;var n=w(e*=p),r=v(e),i=g(t-Pe),o=v(i),s=r*w(i),a=Oe*n-Te*r*o,l=Te*n+Oe*r*o;Ie.add(m(S(s*s+a*a),l)),Pe=t,Te=n,Oe=r}function De(t){return Ie.reset(),D(t,Re),+Ie}var Fe=[null,null],Ne={type:"LineString",coordinates:Fe};function je(t,e){return Fe[0]=t,Fe[1]=e,De(Ne)}var Ge={Feature:function(t,e){return ze(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,r=-1,i=n.length;++r<i;)if(ze(n[r].geometry,e))return!0;return!1}},Ue={Sphere:function(){return!0},Point:function(t,e){return Ve(t.coordinates,e)},MultiPoint:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)if(Ve(n[r],e))return!0;return!1},LineString:function(t,e){return He(t.coordinates,e)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)if(He(n[r],e))return!0;return!1},Polygon:function(t,e){return qe(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)if(qe(n[r],e))return!0;return!1},GeometryCollection:function(t,e){for(var n=t.geometries,r=-1,i=n.length;++r<i;)if(ze(n[r],e))return!0;return!1}};function ze(t,e){return!(!t||!Ue.hasOwnProperty(t.type))&&Ue[t.type](t,e)}function Ve(t,e){return 0===je(t,e)}function He(t,e){var n=je(t[0],t[1]);return je(t[0],e)+je(e,t[1])<=n+a}function qe(t,e){return!!Me(t.map(We),Je(e))}function We(t){return(t=t.map(Je)).pop(),t}function Je(t){return[t[0]*p,t[1]*p]}function Ye(t,e){return(t&&Ge.hasOwnProperty(t.type)?Ge[t.type]:ze)(t,e)}function Xe(t,e,n){var r=Ae(t,e-a,n).concat(e);return function(t){return r.map((function(e){return[t,e]}))}}function Ke(t,e,n){var r=Ae(t,e-a,n).concat(e);return function(t){return r.map((function(e){return[e,t]}))}}function Ze(){var t,e,n,r,i,o,s,l,u,c,h,d,f=10,p=f,y=90,m=360,v=2.5;function _(){return{type:"MultiLineString",coordinates:A()}}function A(){return Ae(b(r/y)*y,n,y).map(h).concat(Ae(b(l/m)*m,s,m).map(d)).concat(Ae(b(e/f)*f,t,f).filter((function(t){return g(t%y)>a})).map(u)).concat(Ae(b(o/p)*p,i,p).filter((function(t){return g(t%m)>a})).map(c))}return _.lines=function(){return A().map((function(t){return{type:"LineString",coordinates:t}}))},_.outline=function(){return{type:"Polygon",coordinates:[h(r).concat(d(s).slice(1),h(n).reverse().slice(1),d(l).reverse().slice(1))]}},_.extent=function(t){return arguments.length?_.extentMajor(t).extentMinor(t):_.extentMinor()},_.extentMajor=function(t){return arguments.length?(r=+t[0][0],n=+t[1][0],l=+t[0][1],s=+t[1][1],r>n&&(t=r,r=n,n=t),l>s&&(t=l,l=s,s=t),_.precision(v)):[[r,l],[n,s]]},_.extentMinor=function(n){return arguments.length?(e=+n[0][0],t=+n[1][0],o=+n[0][1],i=+n[1][1],e>t&&(n=e,e=t,t=n),o>i&&(n=o,o=i,i=n),_.precision(v)):[[e,o],[t,i]]},_.step=function(t){return arguments.length?_.stepMajor(t).stepMinor(t):_.stepMinor()},_.stepMajor=function(t){return arguments.length?(y=+t[0],m=+t[1],_):[y,m]},_.stepMinor=function(t){return arguments.length?(f=+t[0],p=+t[1],_):[f,p]},_.precision=function(a){return arguments.length?(v=+a,u=Xe(o,i,90),c=Ke(e,t,v),h=Xe(l,s,90),d=Ke(r,n,v),_):v},_.extentMajor([[-180,-90+a],[180,90-a]]).extentMinor([[-180,-80-a],[180,80+a]])}function Qe(){return Ze()()}function $e(t,e){var n=t[0]*p,r=t[1]*p,i=e[0]*p,o=e[1]*p,s=v(r),a=w(r),l=v(o),u=w(o),c=s*v(n),h=s*w(n),d=l*v(i),g=l*w(i),y=2*P(S(T(o-r)+s*l*T(i-n))),b=w(y),_=y?function(t){var e=w(t*=y)/b,n=w(y-t)/b,r=n*c+e*d,i=n*h+e*g,o=n*a+e*u;return[m(i,r)*f,m(o,S(r*r+i*i))*f]}:function(){return[n*f,r*f]};return _.distance=y,_}function tn(t){return t}var en,nn,rn,on,sn=r(),an=r(),ln={point:O,lineStart:O,lineEnd:O,polygonStart:function(){ln.lineStart=un,ln.lineEnd=dn},polygonEnd:function(){ln.lineStart=ln.lineEnd=ln.point=O,sn.add(g(an)),an.reset()},result:function(){var t=sn/2;return sn.reset(),t}};function un(){ln.point=cn}function cn(t,e){ln.point=hn,en=rn=t,nn=on=e}function hn(t,e){an.add(on*t-rn*e),rn=t,on=e}function dn(){hn(en,nn)}const fn=ln;var pn=1/0,gn=pn,yn=-pn,mn=yn,vn={point:function(t,e){t<pn&&(pn=t),t>yn&&(yn=t),e<gn&&(gn=e),e>mn&&(mn=e)},lineStart:O,lineEnd:O,polygonStart:O,polygonEnd:O,result:function(){var t=[[pn,gn],[yn,mn]];return yn=mn=-(gn=pn=1/0),t}};const bn=vn;var _n,An,xn,wn,Cn=0,Sn=0,En=0,Mn=0,Pn=0,Tn=0,On=0,In=0,Rn=0,Bn={point:Ln,lineStart:kn,lineEnd:Nn,polygonStart:function(){Bn.lineStart=jn,Bn.lineEnd=Gn},polygonEnd:function(){Bn.point=Ln,Bn.lineStart=kn,Bn.lineEnd=Nn},result:function(){var t=Rn?[On/Rn,In/Rn]:Tn?[Mn/Tn,Pn/Tn]:En?[Cn/En,Sn/En]:[NaN,NaN];return Cn=Sn=En=Mn=Pn=Tn=On=In=Rn=0,t}};function Ln(t,e){Cn+=t,Sn+=e,++En}function kn(){Bn.point=Dn}function Dn(t,e){Bn.point=Fn,Ln(xn=t,wn=e)}function Fn(t,e){var n=t-xn,r=e-wn,i=S(n*n+r*r);Mn+=i*(xn+t)/2,Pn+=i*(wn+e)/2,Tn+=i,Ln(xn=t,wn=e)}function Nn(){Bn.point=Ln}function jn(){Bn.point=Un}function Gn(){zn(_n,An)}function Un(t,e){Bn.point=zn,Ln(_n=xn=t,An=wn=e)}function zn(t,e){var n=t-xn,r=e-wn,i=S(n*n+r*r);Mn+=i*(xn+t)/2,Pn+=i*(wn+e)/2,Tn+=i,On+=(i=wn*t-xn*e)*(xn+t),In+=i*(wn+e),Rn+=3*i,Ln(xn=t,wn=e)}const Vn=Bn;function Hn(t){this._context=t}Hn.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._context.moveTo(t,e),this._point=1;break;case 1:this._context.lineTo(t,e);break;default:this._context.moveTo(t+this._radius,e),this._context.arc(t,e,this._radius,0,d)}},result:O};var qn,Wn,Jn,Yn,Xn,Kn=r(),Zn={point:O,lineStart:function(){Zn.point=Qn},lineEnd:function(){qn&&$n(Wn,Jn),Zn.point=O},polygonStart:function(){qn=!0},polygonEnd:function(){qn=null},result:function(){var t=+Kn;return Kn.reset(),t}};function Qn(t,e){Zn.point=$n,Wn=Yn=t,Jn=Xn=e}function $n(t,e){Yn-=t,Xn-=e,Kn.add(S(Yn*Yn+Xn*Xn)),Yn=t,Xn=e}const tr=Zn;function er(){this._string=[]}function nr(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}function rr(t,e){var n,r,i=4.5;function o(t){return t&&("function"==typeof i&&r.pointRadius(+i.apply(this,arguments)),D(t,n(r))),r.result()}return o.area=function(t){return D(t,n(fn)),fn.result()},o.measure=function(t){return D(t,n(tr)),tr.result()},o.bounds=function(t){return D(t,n(bn)),bn.result()},o.centroid=function(t){return D(t,n(Vn)),Vn.result()},o.projection=function(e){return arguments.length?(n=null==e?(t=null,tn):(t=e).stream,o):t},o.context=function(t){return arguments.length?(r=null==t?(e=null,new er):new Hn(e=t),"function"!=typeof i&&r.pointRadius(i),o):e},o.pointRadius=function(t){return arguments.length?(i="function"==typeof t?t:(r.pointRadius(+t),+t),o):i},o.projection(t).context(e)}function ir(t,e,n,r){return function(i,o){var s,a,l,u=e(o),c=i.invert(r[0],r[1]),h=fe(),d=e(h),f=!1,p={point:g,lineStart:m,lineEnd:v,polygonStart:function(){p.point=b,p.lineStart=_,p.lineEnd=A,a=[],s=[]},polygonEnd:function(){p.point=g,p.lineStart=m,p.lineEnd=v,a=_e(a);var t=Me(s,c);a.length?(f||(o.polygonStart(),f=!0),ye(a,sr,t,n,o)):t&&(f||(o.polygonStart(),f=!0),o.lineStart(),n(null,null,1,o),o.lineEnd()),f&&(o.polygonEnd(),f=!1),a=s=null},sphere:function(){o.polygonStart(),o.lineStart(),n(null,null,1,o),o.lineEnd(),o.polygonEnd()}};function g(e,n){var r=i(e,n);t(e=r[0],n=r[1])&&o.point(e,n)}function y(t,e){var n=i(t,e);u.point(n[0],n[1])}function m(){p.point=y,u.lineStart()}function v(){p.point=g,u.lineEnd()}function b(t,e){l.push([t,e]);var n=i(t,e);d.point(n[0],n[1])}function _(){d.lineStart(),l=[]}function A(){b(l[0][0],l[0][1]),d.lineEnd();var t,e,n,r,i=d.clean(),u=h.result(),c=u.length;if(l.pop(),s.push(l),l=null,c)if(1&i){if((e=(n=u[0]).length-1)>0){for(f||(o.polygonStart(),f=!0),o.lineStart(),t=0;t<e;++t)o.point((r=n[t])[0],r[1]);o.lineEnd()}}else c>1&&2&i&&u.push(u.pop().concat(u.shift())),a.push(u.filter(or))}return p}}function or(t){return t.length>1}function sr(t,e){return((t=t.x)[0]<0?t[1]-c-a:c-t[1])-((e=e.x)[0]<0?e[1]-c-a:c-e[1])}er.prototype={_radius:4.5,_circle:nr(4.5),pointRadius:function(t){return(t=+t)!==this._radius&&(this._radius=t,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._string.push("M",t,",",e),this._point=1;break;case 1:this._string.push("L",t,",",e);break;default:null==this._circle&&(this._circle=nr(this._radius)),this._string.push("M",t,",",e,this._circle)}},result:function(){if(this._string.length){var t=this._string.join("");return this._string=[],t}return null}};const ar=ir((function(){return!0}),(function(t){var e,n=NaN,r=NaN,i=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(o,s){var l=o>0?u:-u,h=g(o-n);g(h-u)<a?(t.point(n,r=(r+s)/2>0?c:-c),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(l,r),t.point(o,r),e=0):i!==l&&h>=u&&(g(n-i)<a&&(n-=i*a),g(o-l)<a&&(o-=l*a),r=function(t,e,n,r){var i,o,s=w(t-n);return g(s)>a?y((w(e)*(o=v(r))*w(n)-w(r)*(i=v(e))*w(t))/(i*o*s)):(e+r)/2}(n,r,o,s),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(l,r),e=0),t.point(n=o,r=s),i=l},lineEnd:function(){t.lineEnd(),n=r=NaN},clean:function(){return 2-e}}}),(function(t,e,n,r){var i;if(null==t)i=n*c,r.point(-u,i),r.point(0,i),r.point(u,i),r.point(u,0),r.point(u,-i),r.point(0,-i),r.point(-u,-i),r.point(-u,0),r.point(-u,i);else if(g(t[0]-e[0])>a){var o=t[0]<e[0]?u:-u;i=n*o/2,r.point(-o,i),r.point(0,i),r.point(o,i)}else r.point(e[0],e[1])}),[-u,-c]);function lr(t){return{stream:ur(t)}}function ur(t){return function(e){var n=new cr;for(var r in t)n[r]=t[r];return n.stream=e,n}}function cr(){}function hr(t,e,n){var r=e[1][0]-e[0][0],i=e[1][1]-e[0][1],o=t.clipExtent&&t.clipExtent();t.scale(150).translate([0,0]),null!=o&&t.clipExtent(null),D(n,t.stream(bn));var s=bn.result(),a=Math.min(r/(s[1][0]-s[0][0]),i/(s[1][1]-s[0][1])),l=+e[0][0]+(r-a*(s[1][0]+s[0][0]))/2,u=+e[0][1]+(i-a*(s[1][1]+s[0][1]))/2;return null!=o&&t.clipExtent(o),t.scale(150*a).translate([l,u])}function dr(t,e,n){return hr(t,[[0,0],e],n)}cr.prototype={constructor:cr,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var fr=16,pr=v(30*p);function gr(t,e){return+e?function(t,e){function n(r,i,o,s,l,u,c,h,d,f,p,y,v,b){var _=c-r,A=h-i,x=_*_+A*A;if(x>4*e&&v--){var w=s+f,C=l+p,E=u+y,M=S(w*w+C*C+E*E),T=P(E/=M),O=g(g(E)-1)<a||g(o-d)<a?(o+d)/2:m(C,w),I=t(O,T),R=I[0],B=I[1],L=R-r,k=B-i,D=A*L-_*k;(D*D/x>e||g((_*L+A*k)/x-.5)>.3||s*f+l*p+u*y<pr)&&(n(r,i,o,s,l,u,R,B,O,w/=M,C/=M,E,v,b),b.point(R,B),n(R,B,O,w,C,E,c,h,d,f,p,y,v,b))}}return function(e){var r,i,o,s,a,l,u,c,h,d,f,p,g={point:y,lineStart:m,lineEnd:b,polygonStart:function(){e.polygonStart(),g.lineStart=_},polygonEnd:function(){e.polygonEnd(),g.lineStart=m}};function y(n,r){n=t(n,r),e.point(n[0],n[1])}function m(){c=NaN,g.point=v,e.lineStart()}function v(r,i){var o=Z([r,i]),s=t(r,i);n(c,h,u,d,f,p,c=s[0],h=s[1],u=r,d=o[0],f=o[1],p=o[2],fr,e),e.point(c,h)}function b(){g.point=y,e.lineEnd()}function _(){m(),g.point=A,g.lineEnd=x}function A(t,e){v(r=t,e),i=c,o=h,s=d,a=f,l=p,g.point=v}function x(){n(c,h,u,d,f,p,i,o,r,s,a,l,fr,e),g.lineEnd=b,b()}return g}}(t,e):function(t){return ur({point:function(e,n){e=t(e,n),this.stream.point(e[0],e[1])}})}(t)}var yr=ur({point:function(t,e){this.stream.point(t*p,e*p)}});function mr(t){return vr((function(){return t}))()}function vr(t){var e,n,r,i,o,s,l,c,h,d,y=150,m=480,b=250,_=0,A=0,x=0,w=0,C=0,E=null,M=ar,P=null,T=tn,O=.5,I=gr(L,O);function R(t){return[(t=o(t[0]*p,t[1]*p))[0]*y+n,r-t[1]*y]}function B(t){return(t=o.invert((t[0]-n)/y,(r-t[1])/y))&&[t[0]*f,t[1]*f]}function L(t,i){return[(t=e(t,i))[0]*y+n,r-t[1]*y]}function k(){o=re(i=oe(x,w,C),e);var t=e(_,A);return n=m-t[0]*y,r=b+t[1]*y,D()}function D(){return h=d=null,R}return R.stream=function(t){return h&&d===t?h:h=yr(M(i,I(T(d=t))))},R.clipAngle=function(t){return arguments.length?(M=+t?function(t,e){var n=v(t),r=n>0,i=g(n)>a;function o(t,e){return v(t)*v(e)>n}function s(t,e,r){var i=[1,0,0],o=$(Z(t),Z(e)),s=Q(o,o),l=o[0],c=s-l*l;if(!c)return!r&&t;var h=n*s/c,d=-n*l/c,f=$(i,o),p=et(i,h);tt(p,et(o,d));var y=f,m=Q(p,y),v=Q(y,y),b=m*m-v*(Q(p,p)-1);if(!(b<0)){var _=S(b),A=et(y,(-m-_)/v);if(tt(A,p),A=K(A),!r)return A;var x,w=t[0],C=e[0],E=t[1],M=e[1];C<w&&(x=w,w=C,C=x);var P=C-w,T=g(P-u)<a;if(!T&&M<E&&(x=E,E=M,M=x),T||P<a?T?E+M>0^A[1]<(g(A[0]-w)<a?E:M):E<=A[1]&&A[1]<=M:P>u^(w<=A[0]&&A[0]<=C)){var O=et(y,(-m+_)/v);return tt(O,p),[A,K(O)]}}}function l(e,n){var i=r?t:u-t,o=0;return e<-i?o|=1:e>i&&(o|=2),n<-i?o|=4:n>i&&(o|=8),o}return ir(o,(function(t){var e,n,c,h,d;return{lineStart:function(){h=c=!1,d=1},point:function(f,p){var g,y=[f,p],m=o(f,p),v=r?m?0:l(f,p):m?l(f+(f<0?u:-u),p):0;if(!e&&(h=c=m)&&t.lineStart(),m!==c&&(!(g=s(e,y))||pe(e,g)||pe(y,g))&&(y[0]+=a,y[1]+=a,m=o(y[0],y[1])),m!==c)d=0,m?(t.lineStart(),g=s(y,e),t.point(g[0],g[1])):(g=s(e,y),t.point(g[0],g[1]),t.lineEnd()),e=g;else if(i&&e&&r^m){var b;v&n||!(b=s(y,e,!0))||(d=0,r?(t.lineStart(),t.point(b[0][0],b[0][1]),t.point(b[1][0],b[1][1]),t.lineEnd()):(t.point(b[1][0],b[1][1]),t.lineEnd(),t.lineStart(),t.point(b[0][0],b[0][1])))}!m||e&&pe(e,y)||t.point(y[0],y[1]),e=y,c=m,n=v},lineEnd:function(){c&&t.lineEnd(),e=null},clean:function(){return d|(h&&c)<<1}}}),(function(n,r,i,o){ce(o,t,e,i,n,r)}),r?[0,-t]:[-u,t-u])}(E=t*p,6*p):(E=null,ar),D()):E*f},R.clipExtent=function(t){return arguments.length?(T=null==t?(P=s=l=c=null,tn):Ce(P=+t[0][0],s=+t[0][1],l=+t[1][0],c=+t[1][1]),D()):null==P?null:[[P,s],[l,c]]},R.scale=function(t){return arguments.length?(y=+t,k()):y},R.translate=function(t){return arguments.length?(m=+t[0],b=+t[1],k()):[m,b]},R.center=function(t){return arguments.length?(_=t[0]%360*p,A=t[1]%360*p,k()):[_*f,A*f]},R.rotate=function(t){return arguments.length?(x=t[0]%360*p,w=t[1]%360*p,C=t.length>2?t[2]%360*p:0,k()):[x*f,w*f,C*f]},R.precision=function(t){return arguments.length?(I=gr(L,O=t*t),D()):S(O)},R.fitExtent=function(t,e){return hr(R,t,e)},R.fitSize=function(t,e){return dr(R,t,e)},function(){return e=t.apply(this,arguments),R.invert=e.invert&&B,k()}}function br(t){var e=0,n=u/3,r=vr(t),i=r(e,n);return i.parallels=function(t){return arguments.length?r(e=t[0]*p,n=t[1]*p):[e*f,n*f]},i}function _r(t,e){var n=w(t),r=(n+w(e))/2;if(g(r)<a)return function(t){var e=v(t);function n(t,n){return[t*e,w(n)/e]}return n.invert=function(t,n){return[t/e,P(n*e)]},n}(t);var i=1+n*(2*r-n),o=S(i)/r;function s(t,e){var n=S(i-2*r*w(e))/r;return[n*w(t*=r),o-n*v(t)]}return s.invert=function(t,e){var n=o-e;return[m(t,g(n))/r*C(n),P((i-(t*t+n*n)*r*r)/(2*r))]},s}function Ar(){return br(_r).scale(155.424).center([0,33.6442])}function xr(){return Ar().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function wr(){var t,e,n,r,i,o,s=xr(),l=Ar().rotate([154,0]).center([-2,58.5]).parallels([55,65]),u=Ar().rotate([157,0]).center([-3,19.9]).parallels([8,18]),c={point:function(t,e){o=[t,e]}};function h(t){var e=t[0],s=t[1];return o=null,n.point(e,s),o||(r.point(e,s),o)||(i.point(e,s),o)}function d(){return t=e=null,h}return h.invert=function(t){var e=s.scale(),n=s.translate(),r=(t[0]-n[0])/e,i=(t[1]-n[1])/e;return(i>=.12&&i<.234&&r>=-.425&&r<-.214?l:i>=.166&&i<.234&&r>=-.214&&r<-.115?u:s).invert(t)},h.stream=function(n){return t&&e===n?t:(r=[s.stream(e=n),l.stream(n),u.stream(n)],i=r.length,t={point:function(t,e){for(var n=-1;++n<i;)r[n].point(t,e)},sphere:function(){for(var t=-1;++t<i;)r[t].sphere()},lineStart:function(){for(var t=-1;++t<i;)r[t].lineStart()},lineEnd:function(){for(var t=-1;++t<i;)r[t].lineEnd()},polygonStart:function(){for(var t=-1;++t<i;)r[t].polygonStart()},polygonEnd:function(){for(var t=-1;++t<i;)r[t].polygonEnd()}});var r,i},h.precision=function(t){return arguments.length?(s.precision(t),l.precision(t),u.precision(t),d()):s.precision()},h.scale=function(t){return arguments.length?(s.scale(t),l.scale(.35*t),u.scale(t),h.translate(s.translate())):s.scale()},h.translate=function(t){if(!arguments.length)return s.translate();var e=s.scale(),o=+t[0],h=+t[1];return n=s.translate(t).clipExtent([[o-.455*e,h-.238*e],[o+.455*e,h+.238*e]]).stream(c),r=l.translate([o-.307*e,h+.201*e]).clipExtent([[o-.425*e+a,h+.12*e+a],[o-.214*e-a,h+.234*e-a]]).stream(c),i=u.translate([o-.205*e,h+.212*e]).clipExtent([[o-.214*e+a,h+.166*e+a],[o-.115*e-a,h+.234*e-a]]).stream(c),d()},h.fitExtent=function(t,e){return hr(h,t,e)},h.fitSize=function(t,e){return dr(h,t,e)},h.scale(1070)}function Cr(t){return function(e,n){var r=v(e),i=v(n),o=t(r*i);return[o*i*w(e),o*w(n)]}}function Sr(t){return function(e,n){var r=S(e*e+n*n),i=t(r),o=w(i),s=v(i);return[m(e*o,r*s),P(r&&n*o/r)]}}var Er=Cr((function(t){return S(2/(1+t))}));function Mr(){return mr(Er).scale(124.75).clipAngle(179.999)}Er.invert=Sr((function(t){return 2*P(t/2)}));var Pr=Cr((function(t){return(t=M(t))&&t/w(t)}));function Tr(){return mr(Pr).scale(79.4188).clipAngle(179.999)}function Or(t,e){return[t,A(E((c+e)/2))]}function Ir(){return Rr(Or).scale(961/d)}function Rr(t){var e,n,r,i=mr(t),o=i.center,s=i.scale,a=i.translate,l=i.clipExtent,c=null;function h(){var o=u*s(),a=i(ue(i.rotate()).invert([0,0]));return l(null==c?[[a[0]-o,a[1]-o],[a[0]+o,a[1]+o]]:t===Or?[[Math.max(a[0]-o,c),e],[Math.min(a[0]+o,n),r]]:[[c,Math.max(a[1]-o,e)],[n,Math.min(a[1]+o,r)]])}return i.scale=function(t){return arguments.length?(s(t),h()):s()},i.translate=function(t){return arguments.length?(a(t),h()):a()},i.center=function(t){return arguments.length?(o(t),h()):o()},i.clipExtent=function(t){return arguments.length?(null==t?c=e=n=r=null:(c=+t[0][0],e=+t[0][1],n=+t[1][0],r=+t[1][1]),h()):null==c?null:[[c,e],[n,r]]},h()}function Br(t){return E((c+t)/2)}function Lr(t,e){var n=v(t),r=t===e?w(t):A(n/v(e))/A(Br(e)/Br(t)),i=n*x(Br(t),r)/r;if(!r)return Or;function o(t,e){i>0?e<-c+a&&(e=-c+a):e>c-a&&(e=c-a);var n=i/x(Br(e),r);return[n*w(r*t),i-n*v(r*t)]}return o.invert=function(t,e){var n=i-e,o=C(r)*S(t*t+n*n);return[m(t,g(n))/r*C(n),2*y(x(i/o,1/r))-c]},o}function kr(){return br(Lr).scale(109.5).parallels([30,30])}function Dr(t,e){return[t,e]}function Fr(){return mr(Dr).scale(152.63)}function Nr(t,e){var n=v(t),r=t===e?w(t):(n-v(e))/(e-t),i=n/r+t;if(g(r)<a)return Dr;function o(t,e){var n=i-e,o=r*t;return[n*w(o),i-n*v(o)]}return o.invert=function(t,e){var n=i-e;return[m(t,g(n))/r*C(n),i-C(r)*S(t*t+n*n)]},o}function jr(){return br(Nr).scale(131.154).center([0,13.9389])}function Gr(t,e){var n=v(e),r=v(t)*n;return[n*w(t)/r,w(e)/r]}function Ur(){return mr(Gr).scale(144.049).clipAngle(60)}function zr(t,e,n,r){return 1===t&&1===e&&0===n&&0===r?tn:ur({point:function(i,o){this.stream.point(i*t+n,o*e+r)}})}function Vr(){var t,e,n,r,i,o,s=1,a=0,l=0,u=1,c=1,h=tn,d=null,f=tn;function p(){return r=i=null,o}return o={stream:function(t){return r&&i===t?r:r=h(f(i=t))},clipExtent:function(r){return arguments.length?(f=null==r?(d=t=e=n=null,tn):Ce(d=+r[0][0],t=+r[0][1],e=+r[1][0],n=+r[1][1]),p()):null==d?null:[[d,t],[e,n]]},scale:function(t){return arguments.length?(h=zr((s=+t)*u,s*c,a,l),p()):s},translate:function(t){return arguments.length?(h=zr(s*u,s*c,a=+t[0],l=+t[1]),p()):[a,l]},reflectX:function(t){return arguments.length?(h=zr(s*(u=t?-1:1),s*c,a,l),p()):u<0},reflectY:function(t){return arguments.length?(h=zr(s*u,s*(c=t?-1:1),a,l),p()):c<0},fitExtent:function(t,e){return hr(o,t,e)},fitSize:function(t,e){return dr(o,t,e)}}}function Hr(t,e){var n=e*e,r=n*n;return[t*(.8707-.131979*n+r*(r*(.003971*n-.001529*r)-.013791)),e*(1.007226+n*(.015085+r*(.028874*n-.044475-.005916*r)))]}function qr(){return mr(Hr).scale(175.295)}function Wr(t,e){return[v(e)*w(t),w(e)]}function Jr(){return mr(Wr).scale(249.5).clipAngle(90+a)}function Yr(t,e){var n=v(e),r=1+v(t)*n;return[n*w(t)/r,w(e)/r]}function Xr(){return mr(Yr).scale(250).clipAngle(142)}function Kr(t,e){return[A(E((c+e)/2)),-t]}function Zr(){var t=Rr(Kr),e=t.center,n=t.rotate;return t.center=function(t){return arguments.length?e([-t[1],t[0]]):[(t=e())[1],-t[0]]},t.rotate=function(t){return arguments.length?n([t[0],t[1],t.length>2?t[2]+90:90]):[(t=n())[0],t[1],t[2]-90]},n([0,0,90]).scale(159.155)}Pr.invert=Sr((function(t){return t})),Or.invert=function(t,e){return[t,2*y(_(e))-c]},Dr.invert=Dr,Gr.invert=Sr(y),Hr.invert=function(t,e){var n,r=e,i=25;do{var o=r*r,s=o*o;r-=n=(r*(1.007226+o*(.015085+s*(.028874*o-.044475-.005916*s)))-e)/(1.007226+o*(.045255+s*(.259866*o-.311325-.005916*11*s)))}while(g(n)>a&&--i>0);return[t/(.8707+(o=r*r)*(o*(o*o*o*(.003971-.001529*o)-.013791)-.131979)),r]},Wr.invert=Sr(P),Yr.invert=Sr((function(t){return 2*y(t)})),Kr.invert=function(t,e){return[-e,2*y(_(t))-c]}},46802:(t,e,n)=>{"use strict";n.d(e,{n:()=>a});var r=Math.PI/3,i=[0,r,2*r,3*r,4*r,5*r];function o(t){return t[0]}function s(t){return t[1]}function a(){var t,e,n,a=0,l=0,u=1,c=1,h=o,d=s;function f(t){var r,i={},o=[],s=t.length;for(r=0;r<s;++r)if(!isNaN(l=+h.call(null,a=t[r],r,t))&&!isNaN(u=+d.call(null,a,r,t))){var a,l,u,c=Math.round(u/=n),f=Math.round(l=l/e-(1&c)/2),p=u-c;if(3*Math.abs(p)>1){var g=l-f,y=f+(l<f?-1:1)/2,m=c+(u<c?-1:1),v=l-y,b=u-m;g*g+p*p>v*v+b*b&&(f=y+(1&c?1:-1)/2,c=m)}var _=f+"-"+c,A=i[_];A?A.push(a):(o.push(A=i[_]=[a]),A.x=(f+(1&c)/2)*e,A.y=c*n)}return o}function p(t){var e=0,n=0;return i.map((function(r){var i=Math.sin(r)*t,o=-Math.cos(r)*t,s=i-e,a=o-n;return e=i,n=o,[s,a]}))}return f.hexagon=function(e){return"m"+p(null==e?t:+e).join("l")+"z"},f.centers=function(){for(var r=[],i=Math.round(l/n),o=Math.round(a/e),s=i*n;s<c+t;s+=n,++i)for(var h=o*e+(1&i)*e/2;h<u+e/2;h+=e)r.push([h,s]);return r},f.mesh=function(){var e=p(t).slice(0,4).join("l");return f.centers().map((function(t){return"M"+t+"m"+e})).join("")},f.x=function(t){return arguments.length?(h=t,f):h},f.y=function(t){return arguments.length?(d=t,f):d},f.radius=function(i){return arguments.length?(e=2*(t=+i)*Math.sin(r),n=1.5*t,f):t},f.size=function(t){return arguments.length?(a=l=0,u=+t[0],c=+t[1],f):[u-a,c-l]},f.extent=function(t){return arguments.length?(a=+t[0][0],l=+t[0][1],u=+t[1][0],c=+t[1][1],f):[[a,l],[u,c]]},f.radius(1)}},69450:(t,e,n)=>{"use strict";n.d(e,{A:()=>u});var r=Math.PI,i=2*r,o=1e-6,s=i-o;function a(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function l(){return new a}a.prototype=l.prototype={constructor:a,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,r){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(t,e,n,r,i,o){this._+="C"+ +t+","+ +e+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+o)},arcTo:function(t,e,n,i,s){t=+t,e=+e,n=+n,i=+i,s=+s;var a=this._x1,l=this._y1,u=n-t,c=i-e,h=a-t,d=l-e,f=h*h+d*d;if(s<0)throw new Error("negative radius: "+s);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(f>o)if(Math.abs(d*u-c*h)>o&&s){var p=n-a,g=i-l,y=u*u+c*c,m=p*p+g*g,v=Math.sqrt(y),b=Math.sqrt(f),_=s*Math.tan((r-Math.acos((y+f-m)/(2*v*b)))/2),A=_/b,x=_/v;Math.abs(A-1)>o&&(this._+="L"+(t+A*h)+","+(e+A*d)),this._+="A"+s+","+s+",0,0,"+ +(d*p>h*g)+","+(this._x1=t+x*u)+","+(this._y1=e+x*c)}else this._+="L"+(this._x1=t)+","+(this._y1=e)},arc:function(t,e,n,a,l,u){t=+t,e=+e,u=!!u;var c=(n=+n)*Math.cos(a),h=n*Math.sin(a),d=t+c,f=e+h,p=1^u,g=u?a-l:l-a;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+d+","+f:(Math.abs(this._x1-d)>o||Math.abs(this._y1-f)>o)&&(this._+="L"+d+","+f),n&&(g<0&&(g=g%i+i),g>s?this._+="A"+n+","+n+",0,1,"+p+","+(t-c)+","+(e-h)+"A"+n+","+n+",0,1,"+p+","+(this._x1=d)+","+(this._y1=f):g>o&&(this._+="A"+n+","+n+",0,"+ +(g>=r)+","+p+","+(this._x1=t+n*Math.cos(l))+","+(this._y1=e+n*Math.sin(l))))},rect:function(t,e,n,r){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};const u=l},16681:(t,e,n)=>{"use strict";n.d(e,{A:()=>d});var r=n(69450),i=n(84653),o=n(98247);function s(t){return t.innerRadius}function a(t){return t.outerRadius}function l(t){return t.startAngle}function u(t){return t.endAngle}function c(t){return t&&t.padAngle}function h(t,e,n,r,i,s,a){var l=t-n,u=e-r,c=(a?s:-s)/(0,o.RZ)(l*l+u*u),h=c*u,d=-c*l,f=t+h,p=e+d,g=n+h,y=r+d,m=(f+g)/2,v=(p+y)/2,b=g-f,_=y-p,A=b*b+_*_,x=i-s,w=f*y-g*p,C=(_<0?-1:1)*(0,o.RZ)((0,o.T9)(0,x*x*A-w*w)),S=(w*_-b*C)/A,E=(-w*b-_*C)/A,M=(w*_+b*C)/A,P=(-w*b+_*C)/A,T=S-m,O=E-v,I=M-m,R=P-v;return T*T+O*O>I*I+R*R&&(S=M,E=P),{cx:S,cy:E,x01:-h,y01:-d,x11:S*(i/x-1),y11:E*(i/x-1)}}function d(){var t=s,e=a,n=(0,i.A)(0),d=null,f=l,p=u,g=c,y=null;function m(){var i,s,a=+t.apply(this,arguments),l=+e.apply(this,arguments),u=f.apply(this,arguments)-o.TW,c=p.apply(this,arguments)-o.TW,m=(0,o.tn)(c-u),v=c>u;if(y||(y=i=(0,r.A)()),l<a&&(s=l,l=a,a=s),l>o.Ni)if(m>o.FA-o.Ni)y.moveTo(l*(0,o.gn)(u),l*(0,o.F8)(u)),y.arc(0,0,l,u,c,!v),a>o.Ni&&(y.moveTo(a*(0,o.gn)(c),a*(0,o.F8)(c)),y.arc(0,0,a,c,u,v));else{var b,_,A=u,x=c,w=u,C=c,S=m,E=m,M=g.apply(this,arguments)/2,P=M>o.Ni&&(d?+d.apply(this,arguments):(0,o.RZ)(a*a+l*l)),T=(0,o.jk)((0,o.tn)(l-a)/2,+n.apply(this,arguments)),O=T,I=T;if(P>o.Ni){var R=(0,o.qR)(P/a*(0,o.F8)(M)),B=(0,o.qR)(P/l*(0,o.F8)(M));(S-=2*R)>o.Ni?(w+=R*=v?1:-1,C-=R):(S=0,w=C=(u+c)/2),(E-=2*B)>o.Ni?(A+=B*=v?1:-1,x-=B):(E=0,A=x=(u+c)/2)}var L=l*(0,o.gn)(A),k=l*(0,o.F8)(A),D=a*(0,o.gn)(C),F=a*(0,o.F8)(C);if(T>o.Ni){var N,j=l*(0,o.gn)(x),G=l*(0,o.F8)(x),U=a*(0,o.gn)(w),z=a*(0,o.F8)(w);if(m<o.pi&&(N=function(t,e,n,r,i,s,a,l){var u=n-t,c=r-e,h=a-i,d=l-s,f=d*u-h*c;if(!(f*f<o.Ni))return[t+(f=(h*(e-s)-d*(t-i))/f)*u,e+f*c]}(L,k,U,z,j,G,D,F))){var V=L-N[0],H=k-N[1],q=j-N[0],W=G-N[1],J=1/(0,o.F8)((0,o.HQ)((V*q+H*W)/((0,o.RZ)(V*V+H*H)*(0,o.RZ)(q*q+W*W)))/2),Y=(0,o.RZ)(N[0]*N[0]+N[1]*N[1]);O=(0,o.jk)(T,(a-Y)/(J-1)),I=(0,o.jk)(T,(l-Y)/(J+1))}}E>o.Ni?I>o.Ni?(b=h(U,z,L,k,l,I,v),_=h(j,G,D,F,l,I,v),y.moveTo(b.cx+b.x01,b.cy+b.y01),I<T?y.arc(b.cx,b.cy,I,(0,o.FP)(b.y01,b.x01),(0,o.FP)(_.y01,_.x01),!v):(y.arc(b.cx,b.cy,I,(0,o.FP)(b.y01,b.x01),(0,o.FP)(b.y11,b.x11),!v),y.arc(0,0,l,(0,o.FP)(b.cy+b.y11,b.cx+b.x11),(0,o.FP)(_.cy+_.y11,_.cx+_.x11),!v),y.arc(_.cx,_.cy,I,(0,o.FP)(_.y11,_.x11),(0,o.FP)(_.y01,_.x01),!v))):(y.moveTo(L,k),y.arc(0,0,l,A,x,!v)):y.moveTo(L,k),a>o.Ni&&S>o.Ni?O>o.Ni?(b=h(D,F,j,G,a,-O,v),_=h(L,k,U,z,a,-O,v),y.lineTo(b.cx+b.x01,b.cy+b.y01),O<T?y.arc(b.cx,b.cy,O,(0,o.FP)(b.y01,b.x01),(0,o.FP)(_.y01,_.x01),!v):(y.arc(b.cx,b.cy,O,(0,o.FP)(b.y01,b.x01),(0,o.FP)(b.y11,b.x11),!v),y.arc(0,0,a,(0,o.FP)(b.cy+b.y11,b.cx+b.x11),(0,o.FP)(_.cy+_.y11,_.cx+_.x11),v),y.arc(_.cx,_.cy,O,(0,o.FP)(_.y11,_.x11),(0,o.FP)(_.y01,_.x01),!v))):y.arc(0,0,a,C,w,v):y.lineTo(D,F)}else y.moveTo(0,0);if(y.closePath(),i)return y=null,i+""||null}return m.centroid=function(){var n=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,r=(+f.apply(this,arguments)+ +p.apply(this,arguments))/2-o.pi/2;return[(0,o.gn)(r)*n,(0,o.F8)(r)*n]},m.innerRadius=function(e){return arguments.length?(t="function"==typeof e?e:(0,i.A)(+e),m):t},m.outerRadius=function(t){return arguments.length?(e="function"==typeof t?t:(0,i.A)(+t),m):e},m.cornerRadius=function(t){return arguments.length?(n="function"==typeof t?t:(0,i.A)(+t),m):n},m.padRadius=function(t){return arguments.length?(d=null==t?null:"function"==typeof t?t:(0,i.A)(+t),m):d},m.startAngle=function(t){return arguments.length?(f="function"==typeof t?t:(0,i.A)(+t),m):f},m.endAngle=function(t){return arguments.length?(p="function"==typeof t?t:(0,i.A)(+t),m):p},m.padAngle=function(t){return arguments.length?(g="function"==typeof t?t:(0,i.A)(+t),m):g},m.context=function(t){return arguments.length?(y=null==t?null:t,m):y},m}},33260:(t,e,n)=>{"use strict";n.d(e,{A:()=>l});var r=n(69450),i=n(84653),o=n(71228),s=n(58679),a=n(59835);function l(){var t=a.x,e=null,n=(0,i.A)(0),l=a.y,u=(0,i.A)(!0),c=null,h=o.A,d=null;function f(i){var o,s,a,f,p,g=i.length,y=!1,m=new Array(g),v=new Array(g);for(null==c&&(d=h(p=(0,r.A)())),o=0;o<=g;++o){if(!(o<g&&u(f=i[o],o,i))===y)if(y=!y)s=o,d.areaStart(),d.lineStart();else{for(d.lineEnd(),d.lineStart(),a=o-1;a>=s;--a)d.point(m[a],v[a]);d.lineEnd(),d.areaEnd()}y&&(m[o]=+t(f,o,i),v[o]=+n(f,o,i),d.point(e?+e(f,o,i):m[o],l?+l(f,o,i):v[o]))}if(p)return d=null,p+""||null}function p(){return(0,s.A)().defined(u).curve(h).context(c)}return f.x=function(n){return arguments.length?(t="function"==typeof n?n:(0,i.A)(+n),e=null,f):t},f.x0=function(e){return arguments.length?(t="function"==typeof e?e:(0,i.A)(+e),f):t},f.x1=function(t){return arguments.length?(e=null==t?null:"function"==typeof t?t:(0,i.A)(+t),f):e},f.y=function(t){return arguments.length?(n="function"==typeof t?t:(0,i.A)(+t),l=null,f):n},f.y0=function(t){return arguments.length?(n="function"==typeof t?t:(0,i.A)(+t),f):n},f.y1=function(t){return arguments.length?(l=null==t?null:"function"==typeof t?t:(0,i.A)(+t),f):l},f.lineX0=f.lineY0=function(){return p().x(t).y(n)},f.lineY1=function(){return p().x(t).y(l)},f.lineX1=function(){return p().x(e).y(n)},f.defined=function(t){return arguments.length?(u="function"==typeof t?t:(0,i.A)(!!t),f):u},f.curve=function(t){return arguments.length?(h=t,null!=c&&(d=h(c)),f):h},f.context=function(t){return arguments.length?(null==t?c=d=null:d=h(c=t),f):c},f}},12736:(t,e,n)=>{"use strict";n.d(e,{d:()=>r});var r=Array.prototype.slice},84653:(t,e,n)=>{"use strict";function r(t){return function(){return t}}n.d(e,{A:()=>r})},71228:(t,e,n)=>{"use strict";function r(t){this._context=t}function i(t){return new r(t)}n.d(e,{A:()=>i}),r.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}}},56048:(t,e,n)=>{"use strict";n.r(e),n.d(e,{arc:()=>r.A,area:()=>i.A,areaRadial:()=>f,curveBasis:()=>U,curveBasisClosed:()=>V,curveBasisOpen:()=>q,curveBundle:()=>J,curveCardinal:()=>K,curveCardinalClosed:()=>Q,curveCardinalOpen:()=>tt,curveCatmullRom:()=>rt,curveCatmullRomClosed:()=>ot,curveCatmullRomOpen:()=>at,curveLinear:()=>a.A,curveLinearClosed:()=>ut,curveMonotoneX:()=>mt,curveMonotoneY:()=>vt,curveNatural:()=>At,curveStep:()=>wt,curveStepAfter:()=>St,curveStepBefore:()=>Ct,line:()=>o.A,lineRadial:()=>d,linkHorizontal:()=>g.pq,linkRadial:()=>g.e7,linkVertical:()=>g.vu,pie:()=>s.A,pointRadial:()=>p.A,radialArea:()=>f,radialLine:()=>d,stack:()=>Ot,stackOffsetDiverging:()=>Rt,stackOffsetExpand:()=>It,stackOffsetNone:()=>Mt,stackOffsetSilhouette:()=>Bt,stackOffsetWiggle:()=>Lt,stackOrderAppearance:()=>kt,stackOrderAscending:()=>Ft,stackOrderDescending:()=>jt,stackOrderInsideOut:()=>Gt,stackOrderNone:()=>Pt,stackOrderReverse:()=>Ut,symbol:()=>F,symbolCircle:()=>v,symbolCross:()=>b,symbolDiamond:()=>x,symbolSquare:()=>M,symbolStar:()=>E,symbolTriangle:()=>T,symbolWye:()=>L,symbols:()=>D});var r=n(16681),i=n(33260),o=n(58679),s=n(87504),a=n(71228),l=c(a.A);function u(t){this._curve=t}function c(t){function e(e){return new u(t(e))}return e._curve=t,e}function h(t){var e=t.curve;return t.angle=t.x,delete t.x,t.radius=t.y,delete t.y,t.curve=function(t){return arguments.length?e(c(t)):e()._curve},t}function d(){return h((0,o.A)().curve(l))}function f(){var t=(0,i.A)().curve(l),e=t.curve,n=t.lineX0,r=t.lineX1,o=t.lineY0,s=t.lineY1;return t.angle=t.x,delete t.x,t.startAngle=t.x0,delete t.x0,t.endAngle=t.x1,delete t.x1,t.radius=t.y,delete t.y,t.innerRadius=t.y0,delete t.y0,t.outerRadius=t.y1,delete t.y1,t.lineStartAngle=function(){return h(n())},delete t.lineX0,t.lineEndAngle=function(){return h(r())},delete t.lineX1,t.lineInnerRadius=function(){return h(o())},delete t.lineY0,t.lineOuterRadius=function(){return h(s())},delete t.lineY1,t.curve=function(t){return arguments.length?e(c(t)):e()._curve},t}u.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(t,e){this._curve.point(e*Math.sin(t),e*-Math.cos(t))}};var p=n(82772),g=n(32134),y=n(69450),m=n(98247);const v={draw:function(t,e){var n=Math.sqrt(e/m.pi);t.moveTo(n,0),t.arc(0,0,n,0,m.FA)}},b={draw:function(t,e){var n=Math.sqrt(e/5)/2;t.moveTo(-3*n,-n),t.lineTo(-n,-n),t.lineTo(-n,-3*n),t.lineTo(n,-3*n),t.lineTo(n,-n),t.lineTo(3*n,-n),t.lineTo(3*n,n),t.lineTo(n,n),t.lineTo(n,3*n),t.lineTo(-n,3*n),t.lineTo(-n,n),t.lineTo(-3*n,n),t.closePath()}};var _=Math.sqrt(1/3),A=2*_;const x={draw:function(t,e){var n=Math.sqrt(e/A),r=n*_;t.moveTo(0,-n),t.lineTo(r,0),t.lineTo(0,n),t.lineTo(-r,0),t.closePath()}};var w=Math.sin(m.pi/10)/Math.sin(7*m.pi/10),C=Math.sin(m.FA/10)*w,S=-Math.cos(m.FA/10)*w;const E={draw:function(t,e){var n=Math.sqrt(.8908130915292852*e),r=C*n,i=S*n;t.moveTo(0,-n),t.lineTo(r,i);for(var o=1;o<5;++o){var s=m.FA*o/5,a=Math.cos(s),l=Math.sin(s);t.lineTo(l*n,-a*n),t.lineTo(a*r-l*i,l*r+a*i)}t.closePath()}},M={draw:function(t,e){var n=Math.sqrt(e),r=-n/2;t.rect(r,r,n,n)}};var P=Math.sqrt(3);const T={draw:function(t,e){var n=-Math.sqrt(e/(3*P));t.moveTo(0,2*n),t.lineTo(-P*n,-n),t.lineTo(P*n,-n),t.closePath()}};var O=-.5,I=Math.sqrt(3)/2,R=1/Math.sqrt(12),B=3*(R/2+1);const L={draw:function(t,e){var n=Math.sqrt(e/B),r=n/2,i=n*R,o=r,s=n*R+n,a=-o,l=s;t.moveTo(r,i),t.lineTo(o,s),t.lineTo(a,l),t.lineTo(O*r-I*i,I*r+O*i),t.lineTo(O*o-I*s,I*o+O*s),t.lineTo(O*a-I*l,I*a+O*l),t.lineTo(O*r+I*i,O*i-I*r),t.lineTo(O*o+I*s,O*s-I*o),t.lineTo(O*a+I*l,O*l-I*a),t.closePath()}};var k=n(84653),D=[v,b,x,M,E,T,L];function F(){var t=(0,k.A)(v),e=(0,k.A)(64),n=null;function r(){var r;if(n||(n=r=(0,y.A)()),t.apply(this,arguments).draw(n,+e.apply(this,arguments)),r)return n=null,r+""||null}return r.type=function(e){return arguments.length?(t="function"==typeof e?e:(0,k.A)(e),r):t},r.size=function(t){return arguments.length?(e="function"==typeof t?t:(0,k.A)(+t),r):e},r.context=function(t){return arguments.length?(n=null==t?null:t,r):n},r}function N(){}function j(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function G(t){this._context=t}function U(t){return new G(t)}function z(t){this._context=t}function V(t){return new z(t)}function H(t){this._context=t}function q(t){return new H(t)}function W(t,e){this._basis=new G(t),this._beta=e}G.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:j(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:j(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},z.prototype={areaStart:N,areaEnd:N,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:j(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},H.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+t)/6,r=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:j(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},W.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var t=this._x,e=this._y,n=t.length-1;if(n>0)for(var r,i=t[0],o=e[0],s=t[n]-i,a=e[n]-o,l=-1;++l<=n;)r=l/n,this._basis.point(this._beta*t[l]+(1-this._beta)*(i+r*s),this._beta*e[l]+(1-this._beta)*(o+r*a));this._x=this._y=null,this._basis.lineEnd()},point:function(t,e){this._x.push(+t),this._y.push(+e)}};const J=function t(e){function n(t){return 1===e?new G(t):new W(t,e)}return n.beta=function(e){return t(+e)},n}(.85);function Y(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function X(t,e){this._context=t,this._k=(1-e)/6}X.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:Y(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:Y(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const K=function t(e){function n(t){return new X(t,e)}return n.tension=function(e){return t(+e)},n}(0);function Z(t,e){this._context=t,this._k=(1-e)/6}Z.prototype={areaStart:N,areaEnd:N,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:Y(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const Q=function t(e){function n(t){return new Z(t,e)}return n.tension=function(e){return t(+e)},n}(0);function $(t,e){this._context=t,this._k=(1-e)/6}$.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Y(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const tt=function t(e){function n(t){return new $(t,e)}return n.tension=function(e){return t(+e)},n}(0);function et(t,e,n){var r=t._x1,i=t._y1,o=t._x2,s=t._y2;if(t._l01_a>m.Ni){var a=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,l=3*t._l01_a*(t._l01_a+t._l12_a);r=(r*a-t._x0*t._l12_2a+t._x2*t._l01_2a)/l,i=(i*a-t._y0*t._l12_2a+t._y2*t._l01_2a)/l}if(t._l23_a>m.Ni){var u=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,c=3*t._l23_a*(t._l23_a+t._l12_a);o=(o*u+t._x1*t._l23_2a-e*t._l12_2a)/c,s=(s*u+t._y1*t._l23_2a-n*t._l12_2a)/c}t._context.bezierCurveTo(r,i,o,s,t._x2,t._y2)}function nt(t,e){this._context=t,this._alpha=e}nt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:et(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const rt=function t(e){function n(t){return e?new nt(t,e):new X(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function it(t,e){this._context=t,this._alpha=e}it.prototype={areaStart:N,areaEnd:N,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:et(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const ot=function t(e){function n(t){return e?new it(t,e):new Z(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function st(t,e){this._context=t,this._alpha=e}st.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:et(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const at=function t(e){function n(t){return e?new st(t,e):new $(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function lt(t){this._context=t}function ut(t){return new lt(t)}function ct(t){return t<0?-1:1}function ht(t,e,n){var r=t._x1-t._x0,i=e-t._x1,o=(t._y1-t._y0)/(r||i<0&&-0),s=(n-t._y1)/(i||r<0&&-0),a=(o*i+s*r)/(r+i);return(ct(o)+ct(s))*Math.min(Math.abs(o),Math.abs(s),.5*Math.abs(a))||0}function dt(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function ft(t,e,n){var r=t._x0,i=t._y0,o=t._x1,s=t._y1,a=(o-r)/3;t._context.bezierCurveTo(r+a,i+a*e,o-a,s-a*n,o,s)}function pt(t){this._context=t}function gt(t){this._context=new yt(t)}function yt(t){this._context=t}function mt(t){return new pt(t)}function vt(t){return new gt(t)}function bt(t){this._context=t}function _t(t){var e,n,r=t.length-1,i=new Array(r),o=new Array(r),s=new Array(r);for(i[0]=0,o[0]=2,s[0]=t[0]+2*t[1],e=1;e<r-1;++e)i[e]=1,o[e]=4,s[e]=4*t[e]+2*t[e+1];for(i[r-1]=2,o[r-1]=7,s[r-1]=8*t[r-1]+t[r],e=1;e<r;++e)n=i[e]/o[e-1],o[e]-=n,s[e]-=n*s[e-1];for(i[r-1]=s[r-1]/o[r-1],e=r-2;e>=0;--e)i[e]=(s[e]-i[e+1])/o[e];for(o[r-1]=(t[r]+i[r-1])/2,e=0;e<r-1;++e)o[e]=2*t[e+1]-i[e+1];return[i,o]}function At(t){return new bt(t)}function xt(t,e){this._context=t,this._t=e}function wt(t){return new xt(t,.5)}function Ct(t){return new xt(t,0)}function St(t){return new xt(t,1)}lt.prototype={areaStart:N,areaEnd:N,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}},pt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:ft(this,this._t0,dt(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(e=+e,(t=+t)!==this._x1||e!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,ft(this,dt(this,n=ht(this,t,e)),n);break;default:ft(this,this._t0,n=ht(this,t,e))}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}},(gt.prototype=Object.create(pt.prototype)).point=function(t,e){pt.prototype.point.call(this,e,t)},yt.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,n,r,i,o){this._context.bezierCurveTo(e,t,r,n,o,i)}},bt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,n=t.length;if(n)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),2===n)this._context.lineTo(t[1],e[1]);else for(var r=_t(t),i=_t(e),o=0,s=1;s<n;++o,++s)this._context.bezierCurveTo(r[0][o],i[0][o],r[1][o],i[1][o],t[s],e[s]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}},xt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var n=this._x*(1-this._t)+t*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,e)}}this._x=t,this._y=e}};var Et=n(12736);function Mt(t,e){if((i=t.length)>1)for(var n,r,i,o=1,s=t[e[0]],a=s.length;o<i;++o)for(r=s,s=t[e[o]],n=0;n<a;++n)s[n][1]+=s[n][0]=isNaN(r[n][1])?r[n][0]:r[n][1]}function Pt(t){for(var e=t.length,n=new Array(e);--e>=0;)n[e]=e;return n}function Tt(t,e){return t[e]}function Ot(){var t=(0,k.A)([]),e=Pt,n=Mt,r=Tt;function i(i){var o,s,a=t.apply(this,arguments),l=i.length,u=a.length,c=new Array(u);for(o=0;o<u;++o){for(var h,d=a[o],f=c[o]=new Array(l),p=0;p<l;++p)f[p]=h=[0,+r(i[p],d,p,i)],h.data=i[p];f.key=d}for(o=0,s=e(c);o<u;++o)c[s[o]].index=o;return n(c,s),c}return i.keys=function(e){return arguments.length?(t="function"==typeof e?e:(0,k.A)(Et.d.call(e)),i):t},i.value=function(t){return arguments.length?(r="function"==typeof t?t:(0,k.A)(+t),i):r},i.order=function(t){return arguments.length?(e=null==t?Pt:"function"==typeof t?t:(0,k.A)(Et.d.call(t)),i):e},i.offset=function(t){return arguments.length?(n=null==t?Mt:t,i):n},i}function It(t,e){if((r=t.length)>0){for(var n,r,i,o=0,s=t[0].length;o<s;++o){for(i=n=0;n<r;++n)i+=t[n][o][1]||0;if(i)for(n=0;n<r;++n)t[n][o][1]/=i}Mt(t,e)}}function Rt(t,e){if((a=t.length)>0)for(var n,r,i,o,s,a,l=0,u=t[e[0]].length;l<u;++l)for(o=s=0,n=0;n<a;++n)(i=(r=t[e[n]][l])[1]-r[0])>0?(r[0]=o,r[1]=o+=i):i<0?(r[1]=s,r[0]=s+=i):(r[0]=0,r[1]=i)}function Bt(t,e){if((n=t.length)>0){for(var n,r=0,i=t[e[0]],o=i.length;r<o;++r){for(var s=0,a=0;s<n;++s)a+=t[s][r][1]||0;i[r][1]+=i[r][0]=-a/2}Mt(t,e)}}function Lt(t,e){if((i=t.length)>0&&(r=(n=t[e[0]]).length)>0){for(var n,r,i,o=0,s=1;s<r;++s){for(var a=0,l=0,u=0;a<i;++a){for(var c=t[e[a]],h=c[s][1]||0,d=(h-(c[s-1][1]||0))/2,f=0;f<a;++f){var p=t[e[f]];d+=(p[s][1]||0)-(p[s-1][1]||0)}l+=h,u+=d*h}n[s-1][1]+=n[s-1][0]=o,l&&(o-=u/l)}n[s-1][1]+=n[s-1][0]=o,Mt(t,e)}}function kt(t){var e=t.map(Dt);return Pt(t).sort((function(t,n){return e[t]-e[n]}))}function Dt(t){for(var e,n=-1,r=0,i=t.length,o=-1/0;++n<i;)(e=+t[n][1])>o&&(o=e,r=n);return r}function Ft(t){var e=t.map(Nt);return Pt(t).sort((function(t,n){return e[t]-e[n]}))}function Nt(t){for(var e,n=0,r=-1,i=t.length;++r<i;)(e=+t[r][1])&&(n+=e);return n}function jt(t){return Ft(t).reverse()}function Gt(t){var e,n,r=t.length,i=t.map(Nt),o=kt(t),s=0,a=0,l=[],u=[];for(e=0;e<r;++e)n=o[e],s<a?(s+=i[n],l.push(n)):(a+=i[n],u.push(n));return u.reverse().concat(l)}function Ut(t){return Pt(t).reverse()}},58679:(t,e,n)=>{"use strict";n.d(e,{A:()=>a});var r=n(69450),i=n(84653),o=n(71228),s=n(59835);function a(){var t=s.x,e=s.y,n=(0,i.A)(!0),a=null,l=o.A,u=null;function c(i){var o,s,c,h=i.length,d=!1;for(null==a&&(u=l(c=(0,r.A)())),o=0;o<=h;++o)!(o<h&&n(s=i[o],o,i))===d&&((d=!d)?u.lineStart():u.lineEnd()),d&&u.point(+t(s,o,i),+e(s,o,i));if(c)return u=null,c+""||null}return c.x=function(e){return arguments.length?(t="function"==typeof e?e:(0,i.A)(+e),c):t},c.y=function(t){return arguments.length?(e="function"==typeof t?t:(0,i.A)(+t),c):e},c.defined=function(t){return arguments.length?(n="function"==typeof t?t:(0,i.A)(!!t),c):n},c.curve=function(t){return arguments.length?(l=t,null!=a&&(u=l(a)),c):l},c.context=function(t){return arguments.length?(null==t?a=u=null:u=l(a=t),c):a},c}},32134:(t,e,n)=>{"use strict";n.d(e,{e7:()=>y,pq:()=>p,vu:()=>g});var r=n(69450),i=n(12736),o=n(84653),s=n(59835),a=n(82772);function l(t){return t.source}function u(t){return t.target}function c(t){var e=l,n=u,a=s.x,c=s.y,h=null;function d(){var o,s=i.d.call(arguments),l=e.apply(this,s),u=n.apply(this,s);if(h||(h=o=(0,r.A)()),t(h,+a.apply(this,(s[0]=l,s)),+c.apply(this,s),+a.apply(this,(s[0]=u,s)),+c.apply(this,s)),o)return h=null,o+""||null}return d.source=function(t){return arguments.length?(e=t,d):e},d.target=function(t){return arguments.length?(n=t,d):n},d.x=function(t){return arguments.length?(a="function"==typeof t?t:(0,o.A)(+t),d):a},d.y=function(t){return arguments.length?(c="function"==typeof t?t:(0,o.A)(+t),d):c},d.context=function(t){return arguments.length?(h=null==t?null:t,d):h},d}function h(t,e,n,r,i){t.moveTo(e,n),t.bezierCurveTo(e=(e+r)/2,n,e,i,r,i)}function d(t,e,n,r,i){t.moveTo(e,n),t.bezierCurveTo(e,n=(n+i)/2,r,n,r,i)}function f(t,e,n,r,i){var o=(0,a.A)(e,n),s=(0,a.A)(e,n=(n+i)/2),l=(0,a.A)(r,n),u=(0,a.A)(r,i);t.moveTo(o[0],o[1]),t.bezierCurveTo(s[0],s[1],l[0],l[1],u[0],u[1])}function p(){return c(h)}function g(){return c(d)}function y(){var t=c(f);return t.angle=t.x,delete t.x,t.radius=t.y,delete t.y,t}},98247:(t,e,n)=>{"use strict";n.d(e,{F8:()=>l,FA:()=>f,FP:()=>i,HQ:()=>p,Ni:()=>c,RZ:()=>u,T9:()=>s,TW:()=>d,gn:()=>o,jk:()=>a,pi:()=>h,qR:()=>g,tn:()=>r});var r=Math.abs,i=Math.atan2,o=Math.cos,s=Math.max,a=Math.min,l=Math.sin,u=Math.sqrt,c=1e-12,h=Math.PI,d=h/2,f=2*h;function p(t){return t>1?0:t<-1?h:Math.acos(t)}function g(t){return t>=1?d:t<=-1?-d:Math.asin(t)}},87504:(t,e,n)=>{"use strict";n.d(e,{A:()=>a});var r=n(84653);function i(t,e){return e<t?-1:e>t?1:e>=t?0:NaN}function o(t){return t}var s=n(98247);function a(){var t=o,e=i,n=null,a=(0,r.A)(0),l=(0,r.A)(s.FA),u=(0,r.A)(0);function c(r){var i,o,c,h,d,f=r.length,p=0,g=new Array(f),y=new Array(f),m=+a.apply(this,arguments),v=Math.min(s.FA,Math.max(-s.FA,l.apply(this,arguments)-m)),b=Math.min(Math.abs(v)/f,u.apply(this,arguments)),_=b*(v<0?-1:1);for(i=0;i<f;++i)(d=y[g[i]=i]=+t(r[i],i,r))>0&&(p+=d);for(null!=e?g.sort((function(t,n){return e(y[t],y[n])})):null!=n&&g.sort((function(t,e){return n(r[t],r[e])})),i=0,c=p?(v-f*_)/p:0;i<f;++i,m=h)o=g[i],h=m+((d=y[o])>0?d*c:0)+_,y[o]={data:r[o],index:i,value:d,startAngle:m,endAngle:h,padAngle:b};return y}return c.value=function(e){return arguments.length?(t="function"==typeof e?e:(0,r.A)(+e),c):t},c.sortValues=function(t){return arguments.length?(e=t,n=null,c):e},c.sort=function(t){return arguments.length?(n=t,e=null,c):n},c.startAngle=function(t){return arguments.length?(a="function"==typeof t?t:(0,r.A)(+t),c):a},c.endAngle=function(t){return arguments.length?(l="function"==typeof t?t:(0,r.A)(+t),c):l},c.padAngle=function(t){return arguments.length?(u="function"==typeof t?t:(0,r.A)(+t),c):u},c}},59835:(t,e,n)=>{"use strict";function r(t){return t[0]}function i(t){return t[1]}n.d(e,{x:()=>r,y:()=>i})},82772:(t,e,n)=>{"use strict";function r(t,e){return[(e=+e)*Math.cos(t-=Math.PI/2),e*Math.sin(t)]}n.d(e,{A:()=>r})},66570:t=>{"use strict";function e(t,e,r){r=r||2;var o,s,a,l,h,d,p,g=e&&e.length,y=g?e[0]*r:t.length,m=n(t,0,y,r,!0),v=[];if(!m||m.next===m.prev)return v;if(g&&(m=function(t,e,r,i){var o,s,a,l=[];for(o=0,s=e.length;o<s;o++)(a=n(t,e[o]*i,o<s-1?e[o+1]*i:t.length,i,!1))===a.next&&(a.steiner=!0),l.push(f(a));for(l.sort(u),o=0;o<l.length;o++)r=c(l[o],r);return r}(t,e,m,r)),t.length>80*r){o=a=t[0],s=l=t[1];for(var b=r;b<y;b+=r)(h=t[b])<o&&(o=h),(d=t[b+1])<s&&(s=d),h>a&&(a=h),d>l&&(l=d);p=0!==(p=Math.max(a-o,l-s))?32767/p:0}return i(m,v,r,o,s,p,0),v}function n(t,e,n,r,i){var o,s;if(i===E(t,e,n,r)>0)for(o=e;o<n;o+=r)s=w(o,t[o],t[o+1],s);else for(o=n-r;o>=e;o-=r)s=w(o,t[o],t[o+1],s);return s&&m(s,s.next)&&(C(s),s=s.next),s}function r(t,e){if(!t)return t;e||(e=t);var n,r=t;do{if(n=!1,r.steiner||!m(r,r.next)&&0!==y(r.prev,r,r.next))r=r.next;else{if(C(r),(r=e=r.prev)===r.next)break;n=!0}}while(n||r!==e);return e}function i(t,e,n,u,c,h,f){if(t){!f&&h&&function(t,e,n,r){var i=t;do{0===i.z&&(i.z=d(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,function(t){var e,n,r,i,o,s,a,l,u=1;do{for(n=t,t=null,o=null,s=0;n;){for(s++,r=n,a=0,e=0;e<u&&(a++,r=r.nextZ);e++);for(l=u;a>0||l>0&&r;)0!==a&&(0===l||!r||n.z<=r.z)?(i=n,n=n.nextZ,a--):(i=r,r=r.nextZ,l--),o?o.nextZ=i:t=i,i.prevZ=o,o=i;n=r}o.nextZ=null,u*=2}while(s>1)}(i)}(t,u,c,h);for(var p,g,y=t;t.prev!==t.next;)if(p=t.prev,g=t.next,h?s(t,u,c,h):o(t))e.push(p.i/n|0),e.push(t.i/n|0),e.push(g.i/n|0),C(t),t=g.next,y=g.next;else if((t=g)===y){f?1===f?i(t=a(r(t),e,n),e,n,u,c,h,2):2===f&&l(t,e,n,u,c,h):i(r(t),e,n,u,c,h,1);break}}}function o(t){var e=t.prev,n=t,r=t.next;if(y(e,n,r)>=0)return!1;for(var i=e.x,o=n.x,s=r.x,a=e.y,l=n.y,u=r.y,c=i<o?i<s?i:s:o<s?o:s,h=a<l?a<u?a:u:l<u?l:u,d=i>o?i>s?i:s:o>s?o:s,f=a>l?a>u?a:u:l>u?l:u,g=r.next;g!==e;){if(g.x>=c&&g.x<=d&&g.y>=h&&g.y<=f&&p(i,a,o,l,s,u,g.x,g.y)&&y(g.prev,g,g.next)>=0)return!1;g=g.next}return!0}function s(t,e,n,r){var i=t.prev,o=t,s=t.next;if(y(i,o,s)>=0)return!1;for(var a=i.x,l=o.x,u=s.x,c=i.y,h=o.y,f=s.y,g=a<l?a<u?a:u:l<u?l:u,m=c<h?c<f?c:f:h<f?h:f,v=a>l?a>u?a:u:l>u?l:u,b=c>h?c>f?c:f:h>f?h:f,_=d(g,m,e,n,r),A=d(v,b,e,n,r),x=t.prevZ,w=t.nextZ;x&&x.z>=_&&w&&w.z<=A;){if(x.x>=g&&x.x<=v&&x.y>=m&&x.y<=b&&x!==i&&x!==s&&p(a,c,l,h,u,f,x.x,x.y)&&y(x.prev,x,x.next)>=0)return!1;if(x=x.prevZ,w.x>=g&&w.x<=v&&w.y>=m&&w.y<=b&&w!==i&&w!==s&&p(a,c,l,h,u,f,w.x,w.y)&&y(w.prev,w,w.next)>=0)return!1;w=w.nextZ}for(;x&&x.z>=_;){if(x.x>=g&&x.x<=v&&x.y>=m&&x.y<=b&&x!==i&&x!==s&&p(a,c,l,h,u,f,x.x,x.y)&&y(x.prev,x,x.next)>=0)return!1;x=x.prevZ}for(;w&&w.z<=A;){if(w.x>=g&&w.x<=v&&w.y>=m&&w.y<=b&&w!==i&&w!==s&&p(a,c,l,h,u,f,w.x,w.y)&&y(w.prev,w,w.next)>=0)return!1;w=w.nextZ}return!0}function a(t,e,n){var i=t;do{var o=i.prev,s=i.next.next;!m(o,s)&&v(o,i,i.next,s)&&A(o,s)&&A(s,o)&&(e.push(o.i/n|0),e.push(i.i/n|0),e.push(s.i/n|0),C(i),C(i.next),i=t=s),i=i.next}while(i!==t);return r(i)}function l(t,e,n,o,s,a){var l=t;do{for(var u=l.next.next;u!==l.prev;){if(l.i!==u.i&&g(l,u)){var c=x(l,u);return l=r(l,l.next),c=r(c,c.next),i(l,e,n,o,s,a,0),void i(c,e,n,o,s,a,0)}u=u.next}l=l.next}while(l!==t)}function u(t,e){return t.x-e.x}function c(t,e){var n=function(t,e){var n,r=e,i=t.x,o=t.y,s=-1/0;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){var a=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(a<=i&&a>s&&(s=a,n=r.x<r.next.x?r:r.next,a===i))return n}r=r.next}while(r!==e);if(!n)return null;var l,u=n,c=n.x,d=n.y,f=1/0;r=n;do{i>=r.x&&r.x>=c&&i!==r.x&&p(o<d?i:s,o,c,d,o<d?s:i,o,r.x,r.y)&&(l=Math.abs(o-r.y)/(i-r.x),A(r,t)&&(l<f||l===f&&(r.x>n.x||r.x===n.x&&h(n,r)))&&(n=r,f=l)),r=r.next}while(r!==u);return n}(t,e);if(!n)return e;var i=x(n,t);return r(i,i.next),r(n,n.next)}function h(t,e){return y(t.prev,t,e.prev)<0&&y(e.next,t,t.next)<0}function d(t,e,n,r,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*i|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-r)*i|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function f(t){var e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function p(t,e,n,r,i,o,s,a){return(i-s)*(e-a)>=(t-s)*(o-a)&&(t-s)*(r-a)>=(n-s)*(e-a)&&(n-s)*(o-a)>=(i-s)*(r-a)}function g(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&v(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(A(t,e)&&A(e,t)&&function(t,e){var n=t,r=!1,i=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)&&(y(t.prev,t,e.prev)||y(t,e.prev,e))||m(t,e)&&y(t.prev,t,t.next)>0&&y(e.prev,e,e.next)>0)}function y(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function m(t,e){return t.x===e.x&&t.y===e.y}function v(t,e,n,r){var i=_(y(t,e,n)),o=_(y(t,e,r)),s=_(y(n,r,t)),a=_(y(n,r,e));return i!==o&&s!==a||!(0!==i||!b(t,n,e))||!(0!==o||!b(t,r,e))||!(0!==s||!b(n,t,r))||!(0!==a||!b(n,e,r))}function b(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function _(t){return t>0?1:t<0?-1:0}function A(t,e){return y(t.prev,t,t.next)<0?y(t,e,t.next)>=0&&y(t,t.prev,e)>=0:y(t,e,t.prev)<0||y(t,t.next,e)<0}function x(t,e){var n=new S(t.i,t.x,t.y),r=new S(e.i,e.x,e.y),i=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function w(t,e,n,r){var i=new S(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function C(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function S(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function E(t,e,n,r){for(var i=0,o=e,s=n-r;o<n;o+=r)i+=(t[s]-t[o])*(t[o+1]+t[s+1]),s=o;return i}t.exports=e,t.exports.default=e,e.deviation=function(t,e,n,r){var i=e&&e.length,o=i?e[0]*n:t.length,s=Math.abs(E(t,0,o,n));if(i)for(var a=0,l=e.length;a<l;a++){var u=e[a]*n,c=a<l-1?e[a+1]*n:t.length;s-=Math.abs(E(t,u,c,n))}var h=0;for(a=0;a<r.length;a+=3){var d=r[a]*n,f=r[a+1]*n,p=r[a+2]*n;h+=Math.abs((t[d]-t[p])*(t[f+1]-t[d+1])-(t[d]-t[f])*(t[p+1]-t[d+1]))}return 0===s&&0===h?0:Math.abs((h-s)/s)},e.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},r=0,i=0;i<t.length;i++){for(var o=0;o<t[i].length;o++)for(var s=0;s<e;s++)n.vertices.push(t[i][o][s]);i>0&&(r+=t[i-1].length,n.holes.push(r))}return n}},86454:(t,e,n)=>{"use strict";const r=n(43918),i=n(32923),o=n(8904);t.exports={XMLParser:i,XMLValidator:r,XMLBuilder:o}},35334:(t,e)=>{"use strict";const n=":A-Za-z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",r="["+n+"]["+n+"\\-.\\d\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*",i=new RegExp("^"+r+"$");e.isExist=function(t){return void 0!==t},e.isEmptyObject=function(t){return 0===Object.keys(t).length},e.merge=function(t,e,n){if(e){const r=Object.keys(e),i=r.length;for(let o=0;o<i;o++)t[r[o]]="strict"===n?[e[r[o]]]:e[r[o]]}},e.getValue=function(t){return e.isExist(t)?t:""},e.isName=function(t){return!(null==i.exec(t))},e.getAllMatches=function(t,e){const n=[];let r=e.exec(t);for(;r;){const i=[];i.startIndex=e.lastIndex-r[0].length;const o=r.length;for(let t=0;t<o;t++)i.push(r[t]);n.push(i),r=e.exec(t)}return n},e.nameRegexp=r},43918:(t,e,n)=>{"use strict";const r=n(35334),i={allowBooleanAttributes:!1,unpairedTags:[]};function o(t){return" "===t||"\t"===t||"\n"===t||"\r"===t}function s(t,e){const n=e;for(;e<t.length;e++)if("?"!=t[e]&&" "!=t[e]);else{const r=t.substr(n,e-n);if(e>5&&"xml"===r)return p("InvalidXml","XML declaration allowed only at the start of the document.",y(t,e));if("?"==t[e]&&">"==t[e+1]){e++;break}}return e}function a(t,e){if(t.length>e+5&&"-"===t[e+1]&&"-"===t[e+2]){for(e+=3;e<t.length;e++)if("-"===t[e]&&"-"===t[e+1]&&">"===t[e+2]){e+=2;break}}else if(t.length>e+8&&"D"===t[e+1]&&"O"===t[e+2]&&"C"===t[e+3]&&"T"===t[e+4]&&"Y"===t[e+5]&&"P"===t[e+6]&&"E"===t[e+7]){let n=1;for(e+=8;e<t.length;e++)if("<"===t[e])n++;else if(">"===t[e]&&(n--,0===n))break}else if(t.length>e+9&&"["===t[e+1]&&"C"===t[e+2]&&"D"===t[e+3]&&"A"===t[e+4]&&"T"===t[e+5]&&"A"===t[e+6]&&"["===t[e+7])for(e+=8;e<t.length;e++)if("]"===t[e]&&"]"===t[e+1]&&">"===t[e+2]){e+=2;break}return e}e.validate=function(t,e){e=Object.assign({},i,e);const n=[];let l=!1,u=!1;"\ufeff"===t[0]&&(t=t.substr(1));for(let i=0;i<t.length;i++)if("<"===t[i]&&"?"===t[i+1]){if(i+=2,i=s(t,i),i.err)return i}else{if("<"!==t[i]){if(o(t[i]))continue;return p("InvalidChar","char '"+t[i]+"' is not expected.",y(t,i))}{let g=i;if(i++,"!"===t[i]){i=a(t,i);continue}{let m=!1;"/"===t[i]&&(m=!0,i++);let v="";for(;i<t.length&&">"!==t[i]&&" "!==t[i]&&"\t"!==t[i]&&"\n"!==t[i]&&"\r"!==t[i];i++)v+=t[i];if(v=v.trim(),"/"===v[v.length-1]&&(v=v.substring(0,v.length-1),i--),h=v,!r.isName(h)){let e;return e=0===v.trim().length?"Invalid space after '<'.":"Tag '"+v+"' is an invalid name.",p("InvalidTag",e,y(t,i))}const b=c(t,i);if(!1===b)return p("InvalidAttr","Attributes for '"+v+"' have open quote.",y(t,i));let _=b.value;if(i=b.index,"/"===_[_.length-1]){const n=i-_.length;_=_.substring(0,_.length-1);const r=d(_,e);if(!0!==r)return p(r.err.code,r.err.msg,y(t,n+r.err.line));l=!0}else if(m){if(!b.tagClosed)return p("InvalidTag","Closing tag '"+v+"' doesn't have proper closing.",y(t,i));if(_.trim().length>0)return p("InvalidTag","Closing tag '"+v+"' can't have attributes or invalid starting.",y(t,g));if(0===n.length)return p("InvalidTag","Closing tag '"+v+"' has not been opened.",y(t,g));{const e=n.pop();if(v!==e.tagName){let n=y(t,e.tagStartPos);return p("InvalidTag","Expected closing tag '"+e.tagName+"' (opened in line "+n.line+", col "+n.col+") instead of closing tag '"+v+"'.",y(t,g))}0==n.length&&(u=!0)}}else{const r=d(_,e);if(!0!==r)return p(r.err.code,r.err.msg,y(t,i-_.length+r.err.line));if(!0===u)return p("InvalidXml","Multiple possible root nodes found.",y(t,i));-1!==e.unpairedTags.indexOf(v)||n.push({tagName:v,tagStartPos:g}),l=!0}for(i++;i<t.length;i++)if("<"===t[i]){if("!"===t[i+1]){i++,i=a(t,i);continue}if("?"!==t[i+1])break;if(i=s(t,++i),i.err)return i}else if("&"===t[i]){const e=f(t,i);if(-1==e)return p("InvalidChar","char '&' is not expected.",y(t,i));i=e}else if(!0===u&&!o(t[i]))return p("InvalidXml","Extra text at the end",y(t,i));"<"===t[i]&&i--}}}var h;return l?1==n.length?p("InvalidTag","Unclosed tag '"+n[0].tagName+"'.",y(t,n[0].tagStartPos)):!(n.length>0)||p("InvalidXml","Invalid '"+JSON.stringify(n.map((t=>t.tagName)),null,4).replace(/\r?\n/g,"")+"' found.",{line:1,col:1}):p("InvalidXml","Start tag expected.",1)};const l='"',u="'";function c(t,e){let n="",r="",i=!1;for(;e<t.length;e++){if(t[e]===l||t[e]===u)""===r?r=t[e]:r!==t[e]||(r="");else if(">"===t[e]&&""===r){i=!0;break}n+=t[e]}return""===r&&{value:n,index:e,tagClosed:i}}const h=new RegExp("(\\s*)([^\\s=]+)(\\s*=)?(\\s*(['\"])(([\\s\\S])*?)\\5)?","g");function d(t,e){const n=r.getAllMatches(t,h),i={};for(let t=0;t<n.length;t++){if(0===n[t][1].length)return p("InvalidAttr","Attribute '"+n[t][2]+"' has no space in starting.",m(n[t]));if(void 0!==n[t][3]&&void 0===n[t][4])return p("InvalidAttr","Attribute '"+n[t][2]+"' is without value.",m(n[t]));if(void 0===n[t][3]&&!e.allowBooleanAttributes)return p("InvalidAttr","boolean attribute '"+n[t][2]+"' is not allowed.",m(n[t]));const r=n[t][2];if(!g(r))return p("InvalidAttr","Attribute '"+r+"' is an invalid name.",m(n[t]));if(i.hasOwnProperty(r))return p("InvalidAttr","Attribute '"+r+"' is repeated.",m(n[t]));i[r]=1}return!0}function f(t,e){if(";"===t[++e])return-1;if("#"===t[e])return function(t,e){let n=/\d/;for("x"===t[e]&&(e++,n=/[\da-fA-F]/);e<t.length;e++){if(";"===t[e])return e;if(!t[e].match(n))break}return-1}(t,++e);let n=0;for(;e<t.length;e++,n++)if(!(t[e].match(/\w/)&&n<20)){if(";"===t[e])break;return-1}return e}function p(t,e,n){return{err:{code:t,msg:e,line:n.line||n,col:n.col}}}function g(t){return r.isName(t)}function y(t,e){const n=t.substring(0,e).split(/\r?\n/);return{line:n.length,col:n[n.length-1].length+1}}function m(t){return t.startIndex+t[1].length}},8904:(t,e,n)=>{"use strict";const r=n(12788),i={attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,cdataPropName:!1,format:!1,indentBy:"  ",suppressEmptyNode:!1,suppressUnpairedNode:!0,suppressBooleanAttributes:!0,tagValueProcessor:function(t,e){return e},attributeValueProcessor:function(t,e){return e},preserveOrder:!1,commentPropName:!1,unpairedTags:[],entities:[{regex:new RegExp("&","g"),val:"&amp;"},{regex:new RegExp(">","g"),val:"&gt;"},{regex:new RegExp("<","g"),val:"&lt;"},{regex:new RegExp("'","g"),val:"&apos;"},{regex:new RegExp('"',"g"),val:"&quot;"}],processEntities:!0,stopNodes:[],oneListGroup:!1};function o(t){this.options=Object.assign({},i,t),this.options.ignoreAttributes||this.options.attributesGroupName?this.isAttribute=function(){return!1}:(this.attrPrefixLen=this.options.attributeNamePrefix.length,this.isAttribute=l),this.processTextOrObjNode=s,this.options.format?(this.indentate=a,this.tagEndChar=">\n",this.newLine="\n"):(this.indentate=function(){return""},this.tagEndChar=">",this.newLine="")}function s(t,e,n){const r=this.j2x(t,n+1);return void 0!==t[this.options.textNodeName]&&1===Object.keys(t).length?this.buildTextValNode(t[this.options.textNodeName],e,r.attrStr,n):this.buildObjectNode(r.val,e,r.attrStr,n)}function a(t){return this.options.indentBy.repeat(t)}function l(t){return!(!t.startsWith(this.options.attributeNamePrefix)||t===this.options.textNodeName)&&t.substr(this.attrPrefixLen)}o.prototype.build=function(t){return this.options.preserveOrder?r(t,this.options):(Array.isArray(t)&&this.options.arrayNodeName&&this.options.arrayNodeName.length>1&&(t={[this.options.arrayNodeName]:t}),this.j2x(t,0).val)},o.prototype.j2x=function(t,e){let n="",r="";for(let i in t)if(Object.prototype.hasOwnProperty.call(t,i))if(void 0===t[i])this.isAttribute(i)&&(r+="");else if(null===t[i])this.isAttribute(i)?r+="":"?"===i[0]?r+=this.indentate(e)+"<"+i+"?"+this.tagEndChar:r+=this.indentate(e)+"<"+i+"/"+this.tagEndChar;else if(t[i]instanceof Date)r+=this.buildTextValNode(t[i],i,"",e);else if("object"!=typeof t[i]){const o=this.isAttribute(i);if(o)n+=this.buildAttrPairStr(o,""+t[i]);else if(i===this.options.textNodeName){let e=this.options.tagValueProcessor(i,""+t[i]);r+=this.replaceEntitiesValue(e)}else r+=this.buildTextValNode(t[i],i,"",e)}else if(Array.isArray(t[i])){const n=t[i].length;let o="",s="";for(let a=0;a<n;a++){const n=t[i][a];if(void 0===n);else if(null===n)"?"===i[0]?r+=this.indentate(e)+"<"+i+"?"+this.tagEndChar:r+=this.indentate(e)+"<"+i+"/"+this.tagEndChar;else if("object"==typeof n)if(this.options.oneListGroup){const t=this.j2x(n,e+1);o+=t.val,this.options.attributesGroupName&&n.hasOwnProperty(this.options.attributesGroupName)&&(s+=t.attrStr)}else o+=this.processTextOrObjNode(n,i,e);else if(this.options.oneListGroup){let t=this.options.tagValueProcessor(i,n);t=this.replaceEntitiesValue(t),o+=t}else o+=this.buildTextValNode(n,i,"",e)}this.options.oneListGroup&&(o=this.buildObjectNode(o,i,s,e)),r+=o}else if(this.options.attributesGroupName&&i===this.options.attributesGroupName){const e=Object.keys(t[i]),r=e.length;for(let o=0;o<r;o++)n+=this.buildAttrPairStr(e[o],""+t[i][e[o]])}else r+=this.processTextOrObjNode(t[i],i,e);return{attrStr:n,val:r}},o.prototype.buildAttrPairStr=function(t,e){return e=this.options.attributeValueProcessor(t,""+e),e=this.replaceEntitiesValue(e),this.options.suppressBooleanAttributes&&"true"===e?" "+t:" "+t+'="'+e+'"'},o.prototype.buildObjectNode=function(t,e,n,r){if(""===t)return"?"===e[0]?this.indentate(r)+"<"+e+n+"?"+this.tagEndChar:this.indentate(r)+"<"+e+n+this.closeTag(e)+this.tagEndChar;{let i="</"+e+this.tagEndChar,o="";return"?"===e[0]&&(o="?",i=""),!n&&""!==n||-1!==t.indexOf("<")?!1!==this.options.commentPropName&&e===this.options.commentPropName&&0===o.length?this.indentate(r)+`\x3c!--${t}--\x3e`+this.newLine:this.indentate(r)+"<"+e+n+o+this.tagEndChar+t+this.indentate(r)+i:this.indentate(r)+"<"+e+n+o+">"+t+i}},o.prototype.closeTag=function(t){let e="";return-1!==this.options.unpairedTags.indexOf(t)?this.options.suppressUnpairedNode||(e="/"):e=this.options.suppressEmptyNode?"/":`></${t}`,e},o.prototype.buildTextValNode=function(t,e,n,r){if(!1!==this.options.cdataPropName&&e===this.options.cdataPropName)return this.indentate(r)+`<![CDATA[${t}]]>`+this.newLine;if(!1!==this.options.commentPropName&&e===this.options.commentPropName)return this.indentate(r)+`\x3c!--${t}--\x3e`+this.newLine;if("?"===e[0])return this.indentate(r)+"<"+e+n+"?"+this.tagEndChar;{let i=this.options.tagValueProcessor(e,t);return i=this.replaceEntitiesValue(i),""===i?this.indentate(r)+"<"+e+n+this.closeTag(e)+this.tagEndChar:this.indentate(r)+"<"+e+n+">"+i+"</"+e+this.tagEndChar}},o.prototype.replaceEntitiesValue=function(t){if(t&&t.length>0&&this.options.processEntities)for(let e=0;e<this.options.entities.length;e++){const n=this.options.entities[e];t=t.replace(n.regex,n.val)}return t},t.exports=o},12788:t=>{function e(t,s,a,l){let u="",c=!1;for(let h=0;h<t.length;h++){const d=t[h],f=n(d);if(void 0===f)continue;let p="";if(p=0===a.length?f:`${a}.${f}`,f===s.textNodeName){let t=d[f];i(p,s)||(t=s.tagValueProcessor(f,t),t=o(t,s)),c&&(u+=l),u+=t,c=!1;continue}if(f===s.cdataPropName){c&&(u+=l),u+=`<![CDATA[${d[f][0][s.textNodeName]}]]>`,c=!1;continue}if(f===s.commentPropName){u+=l+`\x3c!--${d[f][0][s.textNodeName]}--\x3e`,c=!0;continue}if("?"===f[0]){const t=r(d[":@"],s),e="?xml"===f?"":l;let n=d[f][0][s.textNodeName];n=0!==n.length?" "+n:"",u+=e+`<${f}${n}${t}?>`,c=!0;continue}let g=l;""!==g&&(g+=s.indentBy);const y=l+`<${f}${r(d[":@"],s)}`,m=e(d[f],s,p,g);-1!==s.unpairedTags.indexOf(f)?s.suppressUnpairedNode?u+=y+">":u+=y+"/>":m&&0!==m.length||!s.suppressEmptyNode?m&&m.endsWith(">")?u+=y+`>${m}${l}</${f}>`:(u+=y+">",m&&""!==l&&(m.includes("/>")||m.includes("</"))?u+=l+s.indentBy+m+l:u+=m,u+=`</${f}>`):u+=y+"/>",c=!0}return u}function n(t){const e=Object.keys(t);for(let n=0;n<e.length;n++){const r=e[n];if(t.hasOwnProperty(r)&&":@"!==r)return r}}function r(t,e){let n="";if(t&&!e.ignoreAttributes)for(let r in t){if(!t.hasOwnProperty(r))continue;let i=e.attributeValueProcessor(r,t[r]);i=o(i,e),!0===i&&e.suppressBooleanAttributes?n+=` ${r.substr(e.attributeNamePrefix.length)}`:n+=` ${r.substr(e.attributeNamePrefix.length)}="${i}"`}return n}function i(t,e){let n=(t=t.substr(0,t.length-e.textNodeName.length-1)).substr(t.lastIndexOf(".")+1);for(let r in e.stopNodes)if(e.stopNodes[r]===t||e.stopNodes[r]==="*."+n)return!0;return!1}function o(t,e){if(t&&t.length>0&&e.processEntities)for(let n=0;n<e.entities.length;n++){const r=e.entities[n];t=t.replace(r.regex,r.val)}return t}t.exports=function(t,n){let r="";return n.format&&n.indentBy.length>0&&(r="\n"),e(t,n,"",r)}},9400:(t,e,n)=>{const r=n(35334);function i(t,e){let n="";for(;e<t.length&&"'"!==t[e]&&'"'!==t[e];e++)n+=t[e];if(n=n.trim(),-1!==n.indexOf(" "))throw new Error("External entites are not supported");const r=t[e++];let i="";for(;e<t.length&&t[e]!==r;e++)i+=t[e];return[n,i,e]}function o(t,e){return"!"===t[e+1]&&"-"===t[e+2]&&"-"===t[e+3]}function s(t,e){return"!"===t[e+1]&&"E"===t[e+2]&&"N"===t[e+3]&&"T"===t[e+4]&&"I"===t[e+5]&&"T"===t[e+6]&&"Y"===t[e+7]}function a(t,e){return"!"===t[e+1]&&"E"===t[e+2]&&"L"===t[e+3]&&"E"===t[e+4]&&"M"===t[e+5]&&"E"===t[e+6]&&"N"===t[e+7]&&"T"===t[e+8]}function l(t,e){return"!"===t[e+1]&&"A"===t[e+2]&&"T"===t[e+3]&&"T"===t[e+4]&&"L"===t[e+5]&&"I"===t[e+6]&&"S"===t[e+7]&&"T"===t[e+8]}function u(t,e){return"!"===t[e+1]&&"N"===t[e+2]&&"O"===t[e+3]&&"T"===t[e+4]&&"A"===t[e+5]&&"T"===t[e+6]&&"I"===t[e+7]&&"O"===t[e+8]&&"N"===t[e+9]}function c(t){if(r.isName(t))return t;throw new Error(`Invalid entity name ${t}`)}t.exports=function(t,e){const n={};if("O"!==t[e+3]||"C"!==t[e+4]||"T"!==t[e+5]||"Y"!==t[e+6]||"P"!==t[e+7]||"E"!==t[e+8])throw new Error("Invalid Tag instead of DOCTYPE");{e+=9;let r=1,h=!1,d=!1,f="";for(;e<t.length;e++)if("<"!==t[e]||d)if(">"===t[e]){if(d?"-"===t[e-1]&&"-"===t[e-2]&&(d=!1,r--):r--,0===r)break}else"["===t[e]?h=!0:f+=t[e];else{if(h&&s(t,e))e+=7,[entityName,val,e]=i(t,e+1),-1===val.indexOf("&")&&(n[c(entityName)]={regx:RegExp(`&${entityName};`,"g"),val});else if(h&&a(t,e))e+=8;else if(h&&l(t,e))e+=8;else if(h&&u(t,e))e+=9;else{if(!o)throw new Error("Invalid DOCTYPE");d=!0}r++,f=""}if(0!==r)throw new Error("Unclosed DOCTYPE")}return{entities:n,i:e}}},50460:(t,e)=>{const n={preserveOrder:!1,attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,removeNSPrefix:!1,allowBooleanAttributes:!1,parseTagValue:!0,parseAttributeValue:!1,trimValues:!0,cdataPropName:!1,numberParseOptions:{hex:!0,leadingZeros:!0,eNotation:!0},tagValueProcessor:function(t,e){return e},attributeValueProcessor:function(t,e){return e},stopNodes:[],alwaysCreateTextNode:!1,isArray:()=>!1,commentPropName:!1,unpairedTags:[],processEntities:!0,htmlEntities:!1,ignoreDeclaration:!1,ignorePiTags:!1,transformTagName:!1,transformAttributeName:!1,updateTag:function(t,e,n){return t}};e.buildOptions=function(t){return Object.assign({},n,t)},e.defaultOptions=n},17680:(t,e,n)=>{"use strict";const r=n(35334),i=n(23832),o=n(9400),s=n(17983);function a(t){const e=Object.keys(t);for(let n=0;n<e.length;n++){const r=e[n];this.lastEntities[r]={regex:new RegExp("&"+r+";","g"),val:t[r]}}}function l(t,e,n,r,i,o,s){if(void 0!==t&&(this.options.trimValues&&!r&&(t=t.trim()),t.length>0)){s||(t=this.replaceEntitiesValue(t));const r=this.options.tagValueProcessor(e,t,n,i,o);return null==r?t:typeof r!=typeof t||r!==t?r:this.options.trimValues||t.trim()===t?_(t,this.options.parseTagValue,this.options.numberParseOptions):t}}function u(t){if(this.options.removeNSPrefix){const e=t.split(":"),n="/"===t.charAt(0)?"/":"";if("xmlns"===e[0])return"";2===e.length&&(t=n+e[1])}return t}const c=new RegExp("([^\\s=]+)\\s*(=\\s*(['\"])([\\s\\S]*?)\\3)?","gm");function h(t,e,n){if(!this.options.ignoreAttributes&&"string"==typeof t){const n=r.getAllMatches(t,c),i=n.length,o={};for(let t=0;t<i;t++){const r=this.resolveNameSpace(n[t][1]);let i=n[t][4],s=this.options.attributeNamePrefix+r;if(r.length)if(this.options.transformAttributeName&&(s=this.options.transformAttributeName(s)),"__proto__"===s&&(s="#__proto__"),void 0!==i){this.options.trimValues&&(i=i.trim()),i=this.replaceEntitiesValue(i);const t=this.options.attributeValueProcessor(r,i,e);o[s]=null==t?i:typeof t!=typeof i||t!==i?t:_(i,this.options.parseAttributeValue,this.options.numberParseOptions)}else this.options.allowBooleanAttributes&&(o[s]=!0)}if(!Object.keys(o).length)return;if(this.options.attributesGroupName){const t={};return t[this.options.attributesGroupName]=o,t}return o}}const d=function(t){t=t.replace(/\r\n?/g,"\n");const e=new i("!xml");let n=e,r="",s="";for(let a=0;a<t.length;a++)if("<"===t[a])if("/"===t[a+1]){const e=m(t,">",a,"Closing Tag is not closed.");let i=t.substring(a+2,e).trim();if(this.options.removeNSPrefix){const t=i.indexOf(":");-1!==t&&(i=i.substr(t+1))}this.options.transformTagName&&(i=this.options.transformTagName(i)),n&&(r=this.saveTextToParentTag(r,n,s));const o=s.substring(s.lastIndexOf(".")+1);if(i&&-1!==this.options.unpairedTags.indexOf(i))throw new Error(`Unpaired tag can not be used as closing tag: </${i}>`);let l=0;o&&-1!==this.options.unpairedTags.indexOf(o)?(l=s.lastIndexOf(".",s.lastIndexOf(".")-1),this.tagsNodeStack.pop()):l=s.lastIndexOf("."),s=s.substring(0,l),n=this.tagsNodeStack.pop(),r="",a=e}else if("?"===t[a+1]){let e=v(t,a,!1,"?>");if(!e)throw new Error("Pi Tag is not closed.");if(r=this.saveTextToParentTag(r,n,s),this.options.ignoreDeclaration&&"?xml"===e.tagName||this.options.ignorePiTags);else{const t=new i(e.tagName);t.add(this.options.textNodeName,""),e.tagName!==e.tagExp&&e.attrExpPresent&&(t[":@"]=this.buildAttributesMap(e.tagExp,s,e.tagName)),this.addChild(n,t,s)}a=e.closeIndex+1}else if("!--"===t.substr(a+1,3)){const e=m(t,"--\x3e",a+4,"Comment is not closed.");if(this.options.commentPropName){const i=t.substring(a+4,e-2);r=this.saveTextToParentTag(r,n,s),n.add(this.options.commentPropName,[{[this.options.textNodeName]:i}])}a=e}else if("!D"===t.substr(a+1,2)){const e=o(t,a);this.docTypeEntities=e.entities,a=e.i}else if("!["===t.substr(a+1,2)){const e=m(t,"]]>",a,"CDATA is not closed.")-2,i=t.substring(a+9,e);r=this.saveTextToParentTag(r,n,s);let o=this.parseTextData(i,n.tagname,s,!0,!1,!0,!0);null==o&&(o=""),this.options.cdataPropName?n.add(this.options.cdataPropName,[{[this.options.textNodeName]:i}]):n.add(this.options.textNodeName,o),a=e+2}else{let o=v(t,a,this.options.removeNSPrefix),l=o.tagName;const u=o.rawTagName;let c=o.tagExp,h=o.attrExpPresent,d=o.closeIndex;this.options.transformTagName&&(l=this.options.transformTagName(l)),n&&r&&"!xml"!==n.tagname&&(r=this.saveTextToParentTag(r,n,s,!1));const f=n;if(f&&-1!==this.options.unpairedTags.indexOf(f.tagname)&&(n=this.tagsNodeStack.pop(),s=s.substring(0,s.lastIndexOf("."))),l!==e.tagname&&(s+=s?"."+l:l),this.isItStopNode(this.options.stopNodes,s,l)){let e="";if(c.length>0&&c.lastIndexOf("/")===c.length-1)"/"===l[l.length-1]?(l=l.substr(0,l.length-1),s=s.substr(0,s.length-1),c=l):c=c.substr(0,c.length-1),a=o.closeIndex;else if(-1!==this.options.unpairedTags.indexOf(l))a=o.closeIndex;else{const n=this.readStopNodeData(t,u,d+1);if(!n)throw new Error(`Unexpected end of ${u}`);a=n.i,e=n.tagContent}const r=new i(l);l!==c&&h&&(r[":@"]=this.buildAttributesMap(c,s,l)),e&&(e=this.parseTextData(e,l,s,!0,h,!0,!0)),s=s.substr(0,s.lastIndexOf(".")),r.add(this.options.textNodeName,e),this.addChild(n,r,s)}else{if(c.length>0&&c.lastIndexOf("/")===c.length-1){"/"===l[l.length-1]?(l=l.substr(0,l.length-1),s=s.substr(0,s.length-1),c=l):c=c.substr(0,c.length-1),this.options.transformTagName&&(l=this.options.transformTagName(l));const t=new i(l);l!==c&&h&&(t[":@"]=this.buildAttributesMap(c,s,l)),this.addChild(n,t,s),s=s.substr(0,s.lastIndexOf("."))}else{const t=new i(l);this.tagsNodeStack.push(n),l!==c&&h&&(t[":@"]=this.buildAttributesMap(c,s,l)),this.addChild(n,t,s),n=t}r="",a=d}}else r+=t[a];return e.child};function f(t,e,n){const r=this.options.updateTag(e.tagname,n,e[":@"]);!1===r||("string"==typeof r?(e.tagname=r,t.addChild(e)):t.addChild(e))}const p=function(t){if(this.options.processEntities){for(let e in this.docTypeEntities){const n=this.docTypeEntities[e];t=t.replace(n.regx,n.val)}for(let e in this.lastEntities){const n=this.lastEntities[e];t=t.replace(n.regex,n.val)}if(this.options.htmlEntities)for(let e in this.htmlEntities){const n=this.htmlEntities[e];t=t.replace(n.regex,n.val)}t=t.replace(this.ampEntity.regex,this.ampEntity.val)}return t};function g(t,e,n,r){return t&&(void 0===r&&(r=0===Object.keys(e.child).length),void 0!==(t=this.parseTextData(t,e.tagname,n,!1,!!e[":@"]&&0!==Object.keys(e[":@"]).length,r))&&""!==t&&e.add(this.options.textNodeName,t),t=""),t}function y(t,e,n){const r="*."+n;for(const n in t){const i=t[n];if(r===i||e===i)return!0}return!1}function m(t,e,n,r){const i=t.indexOf(e,n);if(-1===i)throw new Error(r);return i+e.length-1}function v(t,e,n,r=">"){const i=function(t,e,n=">"){let r,i="";for(let o=e;o<t.length;o++){let e=t[o];if(r)e===r&&(r="");else if('"'===e||"'"===e)r=e;else if(e===n[0]){if(!n[1])return{data:i,index:o};if(t[o+1]===n[1])return{data:i,index:o}}else"\t"===e&&(e=" ");i+=e}}(t,e+1,r);if(!i)return;let o=i.data;const s=i.index,a=o.search(/\s/);let l=o,u=!0;-1!==a&&(l=o.substring(0,a),o=o.substring(a+1).trimStart());const c=l;if(n){const t=l.indexOf(":");-1!==t&&(l=l.substr(t+1),u=l!==i.data.substr(t+1))}return{tagName:l,tagExp:o,closeIndex:s,attrExpPresent:u,rawTagName:c}}function b(t,e,n){const r=n;let i=1;for(;n<t.length;n++)if("<"===t[n])if("/"===t[n+1]){const o=m(t,">",n,`${e} is not closed`);if(t.substring(n+2,o).trim()===e&&(i--,0===i))return{tagContent:t.substring(r,n),i:o};n=o}else if("?"===t[n+1])n=m(t,"?>",n+1,"StopNode is not closed.");else if("!--"===t.substr(n+1,3))n=m(t,"--\x3e",n+3,"StopNode is not closed.");else if("!["===t.substr(n+1,2))n=m(t,"]]>",n,"StopNode is not closed.")-2;else{const r=v(t,n,">");r&&((r&&r.tagName)===e&&"/"!==r.tagExp[r.tagExp.length-1]&&i++,n=r.closeIndex)}}function _(t,e,n){if(e&&"string"==typeof t){const e=t.trim();return"true"===e||"false"!==e&&s(t,n)}return r.isExist(t)?t:""}t.exports=class{constructor(t){this.options=t,this.currentNode=null,this.tagsNodeStack=[],this.docTypeEntities={},this.lastEntities={apos:{regex:/&(apos|#39|#x27);/g,val:"'"},gt:{regex:/&(gt|#62|#x3E);/g,val:">"},lt:{regex:/&(lt|#60|#x3C);/g,val:"<"},quot:{regex:/&(quot|#34|#x22);/g,val:'"'}},this.ampEntity={regex:/&(amp|#38|#x26);/g,val:"&"},this.htmlEntities={space:{regex:/&(nbsp|#160);/g,val:" "},cent:{regex:/&(cent|#162);/g,val:"¢"},pound:{regex:/&(pound|#163);/g,val:"£"},yen:{regex:/&(yen|#165);/g,val:"¥"},euro:{regex:/&(euro|#8364);/g,val:"€"},copyright:{regex:/&(copy|#169);/g,val:"©"},reg:{regex:/&(reg|#174);/g,val:"®"},inr:{regex:/&(inr|#8377);/g,val:"₹"},num_dec:{regex:/&#([0-9]{1,7});/g,val:(t,e)=>String.fromCharCode(Number.parseInt(e,10))},num_hex:{regex:/&#x([0-9a-fA-F]{1,6});/g,val:(t,e)=>String.fromCharCode(Number.parseInt(e,16))}},this.addExternalEntities=a,this.parseXml=d,this.parseTextData=l,this.resolveNameSpace=u,this.buildAttributesMap=h,this.isItStopNode=y,this.replaceEntitiesValue=p,this.readStopNodeData=b,this.saveTextToParentTag=g,this.addChild=f}}},32923:(t,e,n)=>{const{buildOptions:r}=n(50460),i=n(17680),{prettify:o}=n(75629),s=n(43918);t.exports=class{constructor(t){this.externalEntities={},this.options=r(t)}parse(t,e){if("string"==typeof t);else{if(!t.toString)throw new Error("XML data is accepted in String or Bytes[] form.");t=t.toString()}if(e){!0===e&&(e={});const n=s.validate(t,e);if(!0!==n)throw Error(`${n.err.msg}:${n.err.line}:${n.err.col}`)}const n=new i(this.options);n.addExternalEntities(this.externalEntities);const r=n.parseXml(t);return this.options.preserveOrder||void 0===r?r:o(r,this.options)}addEntity(t,e){if(-1!==e.indexOf("&"))throw new Error("Entity value can't have '&'");if(-1!==t.indexOf("&")||-1!==t.indexOf(";"))throw new Error("An entity must be set without '&' and ';'. Eg. use '#xD' for '&#xD;'");if("&"===e)throw new Error("An entity with value '&' is not permitted");this.externalEntities[t]=e}}},75629:(t,e)=>{"use strict";function n(t,e,s){let a;const l={};for(let u=0;u<t.length;u++){const c=t[u],h=r(c);let d="";if(d=void 0===s?h:s+"."+h,h===e.textNodeName)void 0===a?a=c[h]:a+=""+c[h];else{if(void 0===h)continue;if(c[h]){let t=n(c[h],e,d);const r=o(t,e);c[":@"]?i(t,c[":@"],d,e):1!==Object.keys(t).length||void 0===t[e.textNodeName]||e.alwaysCreateTextNode?0===Object.keys(t).length&&(e.alwaysCreateTextNode?t[e.textNodeName]="":t=""):t=t[e.textNodeName],void 0!==l[h]&&l.hasOwnProperty(h)?(Array.isArray(l[h])||(l[h]=[l[h]]),l[h].push(t)):e.isArray(h,d,r)?l[h]=[t]:l[h]=t}}}return"string"==typeof a?a.length>0&&(l[e.textNodeName]=a):void 0!==a&&(l[e.textNodeName]=a),l}function r(t){const e=Object.keys(t);for(let t=0;t<e.length;t++){const n=e[t];if(":@"!==n)return n}}function i(t,e,n,r){if(e){const i=Object.keys(e),o=i.length;for(let s=0;s<o;s++){const o=i[s];r.isArray(o,n+"."+o,!0,!0)?t[o]=[e[o]]:t[o]=e[o]}}}function o(t,e){const{textNodeName:n}=e,r=Object.keys(t).length;return 0===r||!(1!==r||!t[n]&&"boolean"!=typeof t[n]&&0!==t[n])}e.prettify=function(t,e){return n(t,e)}},23832:t=>{"use strict";t.exports=class{constructor(t){this.tagname=t,this.child=[],this[":@"]={}}add(t,e){"__proto__"===t&&(t="#__proto__"),this.child.push({[t]:e})}addChild(t){"__proto__"===t.tagname&&(t.tagname="#__proto__"),t[":@"]&&Object.keys(t[":@"]).length>0?this.child.push({[t.tagname]:t.child,":@":t[":@"]}):this.child.push({[t.tagname]:t.child})}}},91409:(t,e,n)=>{"use strict";n.d(e,{B8:()=>s,I0:()=>d,Tl:()=>u,a4:()=>a,e$:()=>c,hs:()=>h,lw:()=>l,mg:()=>o,vt:()=>i});var r=n(17823);function i(){var t=new r.tb(9);return r.tb!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function o(t,e){if(t===e){var n=e[1],r=e[2],i=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=r,t[7]=i}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function s(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],s=e[4],a=e[5],l=e[6],u=e[7],c=e[8],h=c*s-a*u,d=-c*o+a*l,f=u*o-s*l,p=n*h+r*d+i*f;return p?(p=1/p,t[0]=h*p,t[1]=(-c*r+i*u)*p,t[2]=(a*r-i*s)*p,t[3]=d*p,t[4]=(c*n-i*l)*p,t[5]=(-a*n+i*o)*p,t[6]=f*p,t[7]=(-u*n+r*l)*p,t[8]=(s*n-r*o)*p,t):null}function a(t){var e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],s=t[5],a=t[6],l=t[7],u=t[8];return e*(u*o-s*l)+n*(-u*i+s*a)+r*(l*i-o*a)}function l(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=n[0],f=n[1],p=n[2],g=n[3],y=n[4],m=n[5],v=n[6],b=n[7],_=n[8];return t[0]=d*r+f*s+p*u,t[1]=d*i+f*a+p*c,t[2]=d*o+f*l+p*h,t[3]=g*r+y*s+m*u,t[4]=g*i+y*a+m*c,t[5]=g*o+y*l+m*h,t[6]=v*r+b*s+_*u,t[7]=v*i+b*a+_*c,t[8]=v*o+b*l+_*h,t}function u(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=n[0],f=n[1];return t[0]=r,t[1]=i,t[2]=o,t[3]=s,t[4]=a,t[5]=l,t[6]=d*r+f*s+u,t[7]=d*i+f*a+c,t[8]=d*o+f*l+h,t}function c(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=Math.sin(n),f=Math.cos(n);return t[0]=f*r+d*s,t[1]=f*i+d*a,t[2]=f*o+d*l,t[3]=f*s-d*r,t[4]=f*a-d*i,t[5]=f*l-d*o,t[6]=u,t[7]=c,t[8]=h,t}function h(t,e,n){var r=n[0],i=n[1];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=i*e[3],t[4]=i*e[4],t[5]=i*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function d(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],s=n+n,a=r+r,l=i+i,u=n*s,c=r*s,h=r*a,d=i*s,f=i*a,p=i*l,g=o*s,y=o*a,m=o*l;return t[0]=1-h-p,t[3]=c-m,t[6]=d+y,t[1]=c+m,t[4]=1-u-p,t[7]=f-g,t[2]=d-y,t[5]=f+g,t[8]=1-u-h,t}},47168:(t,e,n)=>{var r;!function(i,o,s,a){"use strict";var l,u=["","webkit","Moz","MS","ms","o"],c=o.createElement("div"),h="function",d=Math.round,f=Math.abs,p=Date.now;function g(t,e,n){return setTimeout(x(t,n),e)}function y(t,e,n){return!!Array.isArray(t)&&(m(t,n[e],n),!0)}function m(t,e,n){var r;if(t)if(t.forEach)t.forEach(e,n);else if(t.length!==a)for(r=0;r<t.length;)e.call(n,t[r],r,t),r++;else for(r in t)t.hasOwnProperty(r)&&e.call(n,t[r],r,t)}function v(t,e,n){var r="DEPRECATED METHOD: "+e+"\n"+n+" AT \n";return function(){var e=new Error("get-stack-trace"),n=e&&e.stack?e.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",o=i.console&&(i.console.warn||i.console.log);return o&&o.call(i.console,r,n),t.apply(this,arguments)}}l="function"!=typeof Object.assign?function(t){if(t===a||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),n=1;n<arguments.length;n++){var r=arguments[n];if(r!==a&&null!==r)for(var i in r)r.hasOwnProperty(i)&&(e[i]=r[i])}return e}:Object.assign;var b=v((function(t,e,n){for(var r=Object.keys(e),i=0;i<r.length;)(!n||n&&t[r[i]]===a)&&(t[r[i]]=e[r[i]]),i++;return t}),"extend","Use `assign`."),_=v((function(t,e){return b(t,e,!0)}),"merge","Use `assign`.");function A(t,e,n){var r,i=e.prototype;(r=t.prototype=Object.create(i)).constructor=t,r._super=i,n&&l(r,n)}function x(t,e){return function(){return t.apply(e,arguments)}}function w(t,e){return typeof t==h?t.apply(e&&e[0]||a,e):t}function C(t,e){return t===a?e:t}function S(t,e,n){m(T(e),(function(e){t.addEventListener(e,n,!1)}))}function E(t,e,n){m(T(e),(function(e){t.removeEventListener(e,n,!1)}))}function M(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1}function P(t,e){return t.indexOf(e)>-1}function T(t){return t.trim().split(/\s+/g)}function O(t,e,n){if(t.indexOf&&!n)return t.indexOf(e);for(var r=0;r<t.length;){if(n&&t[r][n]==e||!n&&t[r]===e)return r;r++}return-1}function I(t){return Array.prototype.slice.call(t,0)}function R(t,e,n){for(var r=[],i=[],o=0;o<t.length;){var s=e?t[o][e]:t[o];O(i,s)<0&&r.push(t[o]),i[o]=s,o++}return n&&(r=e?r.sort((function(t,n){return t[e]>n[e]})):r.sort()),r}function B(t,e){for(var n,r,i=e[0].toUpperCase()+e.slice(1),o=0;o<u.length;){if((r=(n=u[o])?n+i:e)in t)return r;o++}return a}var L=1;function k(t){var e=t.ownerDocument||t;return e.defaultView||e.parentWindow||i}var D="ontouchstart"in i,F=B(i,"PointerEvent")!==a,N=D&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),j="touch",G="mouse",U=25,z=1,V=4,H=8,q=1,W=2,J=4,Y=8,X=16,K=W|J,Z=Y|X,Q=K|Z,$=["x","y"],tt=["clientX","clientY"];function et(t,e){var n=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){w(t.options.enable,[t])&&n.handler(e)},this.init()}function nt(t,e,n){var r=n.pointers.length,i=n.changedPointers.length,o=e&z&&r-i==0,s=e&(V|H)&&r-i==0;n.isFirst=!!o,n.isFinal=!!s,o&&(t.session={}),n.eventType=e,function(t,e){var n=t.session,r=e.pointers,i=r.length;n.firstInput||(n.firstInput=rt(e)),i>1&&!n.firstMultiple?n.firstMultiple=rt(e):1===i&&(n.firstMultiple=!1);var o=n.firstInput,s=n.firstMultiple,l=s?s.center:o.center,u=e.center=it(r);e.timeStamp=p(),e.deltaTime=e.timeStamp-o.timeStamp,e.angle=lt(l,u),e.distance=at(l,u),function(t,e){var n=e.center,r=t.offsetDelta||{},i=t.prevDelta||{},o=t.prevInput||{};e.eventType!==z&&o.eventType!==V||(i=t.prevDelta={x:o.deltaX||0,y:o.deltaY||0},r=t.offsetDelta={x:n.x,y:n.y}),e.deltaX=i.x+(n.x-r.x),e.deltaY=i.y+(n.y-r.y)}(n,e),e.offsetDirection=st(e.deltaX,e.deltaY);var c,h,d=ot(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=d.x,e.overallVelocityY=d.y,e.overallVelocity=f(d.x)>f(d.y)?d.x:d.y,e.scale=s?(c=s.pointers,at((h=r)[0],h[1],tt)/at(c[0],c[1],tt)):1,e.rotation=s?function(t,e){return lt(e[1],e[0],tt)+lt(t[1],t[0],tt)}(s.pointers,r):0,e.maxPointers=n.prevInput?e.pointers.length>n.prevInput.maxPointers?e.pointers.length:n.prevInput.maxPointers:e.pointers.length,function(t,e){var n,r,i,o,s=t.lastInterval||e,l=e.timeStamp-s.timeStamp;if(e.eventType!=H&&(l>U||s.velocity===a)){var u=e.deltaX-s.deltaX,c=e.deltaY-s.deltaY,h=ot(l,u,c);r=h.x,i=h.y,n=f(h.x)>f(h.y)?h.x:h.y,o=st(u,c),t.lastInterval=e}else n=s.velocity,r=s.velocityX,i=s.velocityY,o=s.direction;e.velocity=n,e.velocityX=r,e.velocityY=i,e.direction=o}(n,e);var g=t.element;M(e.srcEvent.target,g)&&(g=e.srcEvent.target),e.target=g}(t,n),t.emit("hammer.input",n),t.recognize(n),t.session.prevInput=n}function rt(t){for(var e=[],n=0;n<t.pointers.length;)e[n]={clientX:d(t.pointers[n].clientX),clientY:d(t.pointers[n].clientY)},n++;return{timeStamp:p(),pointers:e,center:it(e),deltaX:t.deltaX,deltaY:t.deltaY}}function it(t){var e=t.length;if(1===e)return{x:d(t[0].clientX),y:d(t[0].clientY)};for(var n=0,r=0,i=0;i<e;)n+=t[i].clientX,r+=t[i].clientY,i++;return{x:d(n/e),y:d(r/e)}}function ot(t,e,n){return{x:e/t||0,y:n/t||0}}function st(t,e){return t===e?q:f(t)>=f(e)?t<0?W:J:e<0?Y:X}function at(t,e,n){n||(n=$);var r=e[n[0]]-t[n[0]],i=e[n[1]]-t[n[1]];return Math.sqrt(r*r+i*i)}function lt(t,e,n){n||(n=$);var r=e[n[0]]-t[n[0]],i=e[n[1]]-t[n[1]];return 180*Math.atan2(i,r)/Math.PI}et.prototype={handler:function(){},init:function(){this.evEl&&S(this.element,this.evEl,this.domHandler),this.evTarget&&S(this.target,this.evTarget,this.domHandler),this.evWin&&S(k(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&E(this.element,this.evEl,this.domHandler),this.evTarget&&E(this.target,this.evTarget,this.domHandler),this.evWin&&E(k(this.element),this.evWin,this.domHandler)}};var ut={mousedown:z,mousemove:2,mouseup:V},ct="mousedown",ht="mousemove mouseup";function dt(){this.evEl=ct,this.evWin=ht,this.pressed=!1,et.apply(this,arguments)}A(dt,et,{handler:function(t){var e=ut[t.type];e&z&&0===t.button&&(this.pressed=!0),2&e&&1!==t.which&&(e=V),this.pressed&&(e&V&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:G,srcEvent:t}))}});var ft={pointerdown:z,pointermove:2,pointerup:V,pointercancel:H,pointerout:H},pt={2:j,3:"pen",4:G,5:"kinect"},gt="pointerdown",yt="pointermove pointerup pointercancel";function mt(){this.evEl=gt,this.evWin=yt,et.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}i.MSPointerEvent&&!i.PointerEvent&&(gt="MSPointerDown",yt="MSPointerMove MSPointerUp MSPointerCancel"),A(mt,et,{handler:function(t){var e=this.store,n=!1,r=t.type.toLowerCase().replace("ms",""),i=ft[r],o=pt[t.pointerType]||t.pointerType,s=o==j,a=O(e,t.pointerId,"pointerId");i&z&&(0===t.button||s)?a<0&&(e.push(t),a=e.length-1):i&(V|H)&&(n=!0),a<0||(e[a]=t,this.callback(this.manager,i,{pointers:e,changedPointers:[t],pointerType:o,srcEvent:t}),n&&e.splice(a,1))}});var vt={touchstart:z,touchmove:2,touchend:V,touchcancel:H};function bt(){this.evTarget="touchstart",this.evWin="touchstart touchmove touchend touchcancel",this.started=!1,et.apply(this,arguments)}function _t(t,e){var n=I(t.touches),r=I(t.changedTouches);return e&(V|H)&&(n=R(n.concat(r),"identifier",!0)),[n,r]}A(bt,et,{handler:function(t){var e=vt[t.type];if(e===z&&(this.started=!0),this.started){var n=_t.call(this,t,e);e&(V|H)&&n[0].length-n[1].length==0&&(this.started=!1),this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:j,srcEvent:t})}}});var At={touchstart:z,touchmove:2,touchend:V,touchcancel:H},xt="touchstart touchmove touchend touchcancel";function wt(){this.evTarget=xt,this.targetIds={},et.apply(this,arguments)}function Ct(t,e){var n=I(t.touches),r=this.targetIds;if(e&(2|z)&&1===n.length)return r[n[0].identifier]=!0,[n,n];var i,o,s=I(t.changedTouches),a=[],l=this.target;if(o=n.filter((function(t){return M(t.target,l)})),e===z)for(i=0;i<o.length;)r[o[i].identifier]=!0,i++;for(i=0;i<s.length;)r[s[i].identifier]&&a.push(s[i]),e&(V|H)&&delete r[s[i].identifier],i++;return a.length?[R(o.concat(a),"identifier",!0),a]:void 0}A(wt,et,{handler:function(t){var e=At[t.type],n=Ct.call(this,t,e);n&&this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:j,srcEvent:t})}});var St=2500;function Et(){et.apply(this,arguments);var t=x(this.handler,this);this.touch=new wt(this.manager,t),this.mouse=new dt(this.manager,t),this.primaryTouch=null,this.lastTouches=[]}function Mt(t,e){t&z?(this.primaryTouch=e.changedPointers[0].identifier,Pt.call(this,e)):t&(V|H)&&Pt.call(this,e)}function Pt(t){var e=t.changedPointers[0];if(e.identifier===this.primaryTouch){var n={x:e.clientX,y:e.clientY};this.lastTouches.push(n);var r=this.lastTouches;setTimeout((function(){var t=r.indexOf(n);t>-1&&r.splice(t,1)}),St)}}function Tt(t){for(var e=t.srcEvent.clientX,n=t.srcEvent.clientY,r=0;r<this.lastTouches.length;r++){var i=this.lastTouches[r],o=Math.abs(e-i.x),s=Math.abs(n-i.y);if(o<=25&&s<=25)return!0}return!1}A(Et,et,{handler:function(t,e,n){var r=n.pointerType==j,i=n.pointerType==G;if(!(i&&n.sourceCapabilities&&n.sourceCapabilities.firesTouchEvents)){if(r)Mt.call(this,e,n);else if(i&&Tt.call(this,n))return;this.callback(t,e,n)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var Ot=B(c.style,"touchAction"),It=Ot!==a,Rt="compute",Bt="auto",Lt="manipulation",kt="none",Dt="pan-x",Ft="pan-y",Nt=function(){if(!It)return!1;var t={},e=i.CSS&&i.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach((function(n){t[n]=!e||i.CSS.supports("touch-action",n)})),t}();function jt(t,e){this.manager=t,this.set(e)}jt.prototype={set:function(t){t==Rt&&(t=this.compute()),It&&this.manager.element.style&&Nt[t]&&(this.manager.element.style[Ot]=t),this.actions=t.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var t=[];return m(this.manager.recognizers,(function(e){w(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))})),function(t){if(P(t,kt))return kt;var e=P(t,Dt),n=P(t,Ft);return e&&n?kt:e||n?e?Dt:Ft:P(t,Lt)?Lt:Bt}(t.join(" "))},preventDefaults:function(t){var e=t.srcEvent,n=t.offsetDirection;if(this.manager.session.prevented)e.preventDefault();else{var r=this.actions,i=P(r,kt)&&!Nt[kt],o=P(r,Ft)&&!Nt[Ft],s=P(r,Dt)&&!Nt[Dt];if(i){var a=1===t.pointers.length,l=t.distance<2,u=t.deltaTime<250;if(a&&l&&u)return}if(!s||!o)return i||o&&n&K||s&&n&Z?this.preventSrc(e):void 0}},preventSrc:function(t){this.manager.session.prevented=!0,t.preventDefault()}};var Gt=1,Ut=32;function zt(t){this.options=l({},this.defaults,t||{}),this.id=L++,this.manager=null,this.options.enable=C(this.options.enable,!0),this.state=Gt,this.simultaneous={},this.requireFail=[]}function Vt(t){return 16&t?"cancel":8&t?"end":4&t?"move":2&t?"start":""}function Ht(t){return t==X?"down":t==Y?"up":t==W?"left":t==J?"right":""}function qt(t,e){var n=e.manager;return n?n.get(t):t}function Wt(){zt.apply(this,arguments)}function Jt(){Wt.apply(this,arguments),this.pX=null,this.pY=null}function Yt(){Wt.apply(this,arguments)}function Xt(){zt.apply(this,arguments),this._timer=null,this._input=null}function Kt(){Wt.apply(this,arguments)}function Zt(){Wt.apply(this,arguments)}function Qt(){zt.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function $t(t,e){return(e=e||{}).recognizers=C(e.recognizers,$t.defaults.preset),new te(t,e)}function te(t,e){this.options=l({},$t.defaults,e||{}),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=t,this.input=new(this.options.inputClass||(F?mt:N?wt:D?Et:dt))(this,nt),this.touchAction=new jt(this,this.options.touchAction),ee(this,!0),m(this.options.recognizers,(function(t){var e=this.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])}),this)}function ee(t,e){var n,r=t.element;r.style&&(m(t.options.cssProps,(function(i,o){n=B(r.style,o),e?(t.oldCssProps[n]=r.style[n],r.style[n]=i):r.style[n]=t.oldCssProps[n]||""})),e||(t.oldCssProps={}))}zt.prototype={defaults:{},set:function(t){return l(this.options,t),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(t){if(y(t,"recognizeWith",this))return this;var e=this.simultaneous;return e[(t=qt(t,this)).id]||(e[t.id]=t,t.recognizeWith(this)),this},dropRecognizeWith:function(t){return y(t,"dropRecognizeWith",this)||(t=qt(t,this),delete this.simultaneous[t.id]),this},requireFailure:function(t){if(y(t,"requireFailure",this))return this;var e=this.requireFail;return-1===O(e,t=qt(t,this))&&(e.push(t),t.requireFailure(this)),this},dropRequireFailure:function(t){if(y(t,"dropRequireFailure",this))return this;t=qt(t,this);var e=O(this.requireFail,t);return e>-1&&this.requireFail.splice(e,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(t){return!!this.simultaneous[t.id]},emit:function(t){var e=this,n=this.state;function r(n){e.manager.emit(n,t)}n<8&&r(e.options.event+Vt(n)),r(e.options.event),t.additionalEvent&&r(t.additionalEvent),n>=8&&r(e.options.event+Vt(n))},tryEmit:function(t){if(this.canEmit())return this.emit(t);this.state=Ut},canEmit:function(){for(var t=0;t<this.requireFail.length;){if(!(this.requireFail[t].state&(Ut|Gt)))return!1;t++}return!0},recognize:function(t){var e=l({},t);if(!w(this.options.enable,[this,e]))return this.reset(),void(this.state=Ut);56&this.state&&(this.state=Gt),this.state=this.process(e),30&this.state&&this.tryEmit(e)},process:function(t){},getTouchAction:function(){},reset:function(){}},A(Wt,zt,{defaults:{pointers:1},attrTest:function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},process:function(t){var e=this.state,n=t.eventType,r=6&e,i=this.attrTest(t);return r&&(n&H||!i)?16|e:r||i?n&V?8|e:2&e?4|e:2:Ut}}),A(Jt,Wt,{defaults:{event:"pan",threshold:10,pointers:1,direction:Q},getTouchAction:function(){var t=this.options.direction,e=[];return t&K&&e.push(Ft),t&Z&&e.push(Dt),e},directionTest:function(t){var e=this.options,n=!0,r=t.distance,i=t.direction,o=t.deltaX,s=t.deltaY;return i&e.direction||(e.direction&K?(i=0===o?q:o<0?W:J,n=o!=this.pX,r=Math.abs(t.deltaX)):(i=0===s?q:s<0?Y:X,n=s!=this.pY,r=Math.abs(t.deltaY))),t.direction=i,n&&r>e.threshold&&i&e.direction},attrTest:function(t){return Wt.prototype.attrTest.call(this,t)&&(2&this.state||!(2&this.state)&&this.directionTest(t))},emit:function(t){this.pX=t.deltaX,this.pY=t.deltaY;var e=Ht(t.direction);e&&(t.additionalEvent=this.options.event+e),this._super.emit.call(this,t)}}),A(Yt,Wt,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[kt]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.scale-1)>this.options.threshold||2&this.state)},emit:function(t){if(1!==t.scale){var e=t.scale<1?"in":"out";t.additionalEvent=this.options.event+e}this._super.emit.call(this,t)}}),A(Xt,zt,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Bt]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,r=t.distance<e.threshold,i=t.deltaTime>e.time;if(this._input=t,!r||!n||t.eventType&(V|H)&&!i)this.reset();else if(t.eventType&z)this.reset(),this._timer=g((function(){this.state=8,this.tryEmit()}),e.time,this);else if(t.eventType&V)return 8;return Ut},reset:function(){clearTimeout(this._timer)},emit:function(t){8===this.state&&(t&&t.eventType&V?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=p(),this.manager.emit(this.options.event,this._input)))}}),A(Kt,Wt,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[kt]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.rotation)>this.options.threshold||2&this.state)}}),A(Zt,Wt,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:K|Z,pointers:1},getTouchAction:function(){return Jt.prototype.getTouchAction.call(this)},attrTest:function(t){var e,n=this.options.direction;return n&(K|Z)?e=t.overallVelocity:n&K?e=t.overallVelocityX:n&Z&&(e=t.overallVelocityY),this._super.attrTest.call(this,t)&&n&t.offsetDirection&&t.distance>this.options.threshold&&t.maxPointers==this.options.pointers&&f(e)>this.options.velocity&&t.eventType&V},emit:function(t){var e=Ht(t.offsetDirection);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)}}),A(Qt,zt,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Lt]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,r=t.distance<e.threshold,i=t.deltaTime<e.time;if(this.reset(),t.eventType&z&&0===this.count)return this.failTimeout();if(r&&i&&n){if(t.eventType!=V)return this.failTimeout();var o=!this.pTime||t.timeStamp-this.pTime<e.interval,s=!this.pCenter||at(this.pCenter,t.center)<e.posThreshold;if(this.pTime=t.timeStamp,this.pCenter=t.center,s&&o?this.count+=1:this.count=1,this._input=t,0==this.count%e.taps)return this.hasRequireFailures()?(this._timer=g((function(){this.state=8,this.tryEmit()}),e.interval,this),2):8}return Ut},failTimeout:function(){return this._timer=g((function(){this.state=Ut}),this.options.interval,this),Ut},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),$t.VERSION="2.0.7",$t.defaults={domEvents:!1,touchAction:Rt,enable:!0,inputTarget:null,inputClass:null,preset:[[Kt,{enable:!1}],[Yt,{enable:!1},["rotate"]],[Zt,{direction:K}],[Jt,{direction:K},["swipe"]],[Qt],[Qt,{event:"doubletap",taps:2},["tap"]],[Xt]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},te.prototype={set:function(t){return l(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},stop:function(t){this.session.stopped=t?2:1},recognize:function(t){var e=this.session;if(!e.stopped){var n;this.touchAction.preventDefaults(t);var r=this.recognizers,i=e.curRecognizer;(!i||i&&8&i.state)&&(i=e.curRecognizer=null);for(var o=0;o<r.length;)n=r[o],2===e.stopped||i&&n!=i&&!n.canRecognizeWith(i)?n.reset():n.recognize(t),!i&&14&n.state&&(i=e.curRecognizer=n),o++}},get:function(t){if(t instanceof zt)return t;for(var e=this.recognizers,n=0;n<e.length;n++)if(e[n].options.event==t)return e[n];return null},add:function(t){if(y(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t},remove:function(t){if(y(t,"remove",this))return this;if(t=this.get(t)){var e=this.recognizers,n=O(e,t);-1!==n&&(e.splice(n,1),this.touchAction.update())}return this},on:function(t,e){if(t!==a&&e!==a){var n=this.handlers;return m(T(t),(function(t){n[t]=n[t]||[],n[t].push(e)})),this}},off:function(t,e){if(t!==a){var n=this.handlers;return m(T(t),(function(t){e?n[t]&&n[t].splice(O(n[t],e),1):delete n[t]})),this}},emit:function(t,e){this.options.domEvents&&function(t,e){var n=o.createEvent("Event");n.initEvent(t,!0,!0),n.gesture=e,e.target.dispatchEvent(n)}(t,e);var n=this.handlers[t]&&this.handlers[t].slice();if(n&&n.length){e.type=t,e.preventDefault=function(){e.srcEvent.preventDefault()};for(var r=0;r<n.length;)n[r](e),r++}},destroy:function(){this.element&&ee(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},l($t,{INPUT_START:z,INPUT_MOVE:2,INPUT_END:V,INPUT_CANCEL:H,STATE_POSSIBLE:Gt,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:Ut,DIRECTION_NONE:q,DIRECTION_LEFT:W,DIRECTION_RIGHT:J,DIRECTION_UP:Y,DIRECTION_DOWN:X,DIRECTION_HORIZONTAL:K,DIRECTION_VERTICAL:Z,DIRECTION_ALL:Q,Manager:te,Input:et,TouchAction:jt,TouchInput:wt,MouseInput:dt,PointerEventInput:mt,TouchMouseInput:Et,SingleTouchInput:bt,Recognizer:zt,AttrRecognizer:Wt,Tap:Qt,Pan:Jt,Swipe:Zt,Pinch:Yt,Rotate:Kt,Press:Xt,on:S,off:E,each:m,merge:_,extend:b,assign:l,inherit:A,bindFn:x,prefixed:B}),(void 0!==i?i:"undefined"!=typeof self?self:{}).Hammer=$t,(r=function(){return $t}.call(e,n,e,t))===a||(t.exports=r)}(window,document)},251:(t,e)=>{e.read=function(t,e,n,r,i){var o,s,a=8*i-r-1,l=(1<<a)-1,u=l>>1,c=-7,h=n?i-1:0,d=n?-1:1,f=t[e+h];for(h+=d,o=f&(1<<-c)-1,f>>=-c,c+=a;c>0;o=256*o+t[e+h],h+=d,c-=8);for(s=o&(1<<-c)-1,o>>=-c,c+=r;c>0;s=256*s+t[e+h],h+=d,c-=8);if(0===o)o=1-u;else{if(o===l)return s?NaN:1/0*(f?-1:1);s+=Math.pow(2,r),o-=u}return(f?-1:1)*s*Math.pow(2,o-r)},e.write=function(t,e,n,r,i,o){var s,a,l,u=8*o-i-1,c=(1<<u)-1,h=c>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:o-1,p=r?1:-1,g=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=c):(s=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-s))<1&&(s--,l*=2),(e+=s+h>=1?d/l:d*Math.pow(2,1-h))*l>=2&&(s++,l/=2),s+h>=c?(a=0,s=c):s+h>=1?(a=(e*l-1)*Math.pow(2,i),s+=h):(a=e*Math.pow(2,h-1)*Math.pow(2,i),s=0));i>=8;t[n+f]=255&a,f+=p,a/=256,i-=8);for(s=s<<i|a,u+=i;u>0;t[n+f]=255&s,f+=p,s/=256,u-=8);t[n+f-p]|=128*g}},43853:(t,e,n)=>{"use strict";n.r(e),n.d(e,{KTX2Container:()=>f,read:()=>v,write:()=>A});const r=new Uint8Array([0]),i=[171,75,84,88,32,50,48,187,13,10,26,10];var o,s,a,l,u,c,h,d;!function(t){t[t.NONE=0]="NONE",t[t.BASISLZ=1]="BASISLZ",t[t.ZSTD=2]="ZSTD",t[t.ZLIB=3]="ZLIB"}(o||(o={})),function(t){t[t.BASICFORMAT=0]="BASICFORMAT"}(s||(s={})),function(t){t[t.UNSPECIFIED=0]="UNSPECIFIED",t[t.ETC1S=163]="ETC1S",t[t.UASTC=166]="UASTC"}(a||(a={})),function(t){t[t.UNSPECIFIED=0]="UNSPECIFIED",t[t.SRGB=1]="SRGB"}(l||(l={})),function(t){t[t.UNSPECIFIED=0]="UNSPECIFIED",t[t.LINEAR=1]="LINEAR",t[t.SRGB=2]="SRGB",t[t.ITU=3]="ITU",t[t.NTSC=4]="NTSC",t[t.SLOG=5]="SLOG",t[t.SLOG2=6]="SLOG2"}(u||(u={})),function(t){t[t.ALPHA_STRAIGHT=0]="ALPHA_STRAIGHT",t[t.ALPHA_PREMULTIPLIED=1]="ALPHA_PREMULTIPLIED"}(c||(c={})),function(t){t[t.RGB=0]="RGB",t[t.RRR=3]="RRR",t[t.GGG=4]="GGG",t[t.AAA=15]="AAA"}(h||(h={})),function(t){t[t.RGB=0]="RGB",t[t.RGBA=3]="RGBA",t[t.RRR=4]="RRR",t[t.RRRG=5]="RRRG"}(d||(d={}));class f{constructor(){this.vkFormat=0,this.typeSize=1,this.pixelWidth=0,this.pixelHeight=0,this.pixelDepth=0,this.layerCount=0,this.faceCount=1,this.supercompressionScheme=o.NONE,this.levels=[],this.dataFormatDescriptor=[{vendorId:0,descriptorType:s.BASICFORMAT,versionNumber:2,descriptorBlockSize:40,colorModel:a.UNSPECIFIED,colorPrimaries:l.SRGB,transferFunction:l.SRGB,flags:c.ALPHA_STRAIGHT,texelBlockDimension:{x:4,y:4,z:1,w:1},bytesPlane:[],samples:[]}],this.keyValue={},this.globalData=null}}class p{constructor(t,e,n,r){this._dataView=new DataView(t.buffer,t.byteOffset+e,n),this._littleEndian=r,this._offset=0}_nextUint8(){const t=this._dataView.getUint8(this._offset);return this._offset+=1,t}_nextUint16(){const t=this._dataView.getUint16(this._offset,this._littleEndian);return this._offset+=2,t}_nextUint32(){const t=this._dataView.getUint32(this._offset,this._littleEndian);return this._offset+=4,t}_nextUint64(){const t=this._dataView.getUint32(this._offset,this._littleEndian)+2**32*this._dataView.getUint32(this._offset+4,this._littleEndian);return this._offset+=8,t}_skip(t){return this._offset+=t,this}_scan(t,e=0){const n=this._offset;let r=0;for(;this._dataView.getUint8(this._offset)!==e&&r<t;)r++,this._offset++;return r<t&&this._offset++,new Uint8Array(this._dataView.buffer,this._dataView.byteOffset+n,r)}}function g(t){return"undefined"!=typeof TextEncoder?(new TextEncoder).encode(t):Buffer.from(t)}function y(t){return"undefined"!=typeof TextDecoder?(new TextDecoder).decode(t):Buffer.from(t).toString("utf8")}function m(t){let e=0;for(const n of t)e+=n.byteLength;const n=new Uint8Array(e);let r=0;for(const e of t)n.set(new Uint8Array(e),r),r+=e.byteLength;return n}function v(t){const e=new Uint8Array(t.buffer,t.byteOffset,i.length);if(e[0]!==i[0]||e[1]!==i[1]||e[2]!==i[2]||e[3]!==i[3]||e[4]!==i[4]||e[5]!==i[5]||e[6]!==i[6]||e[7]!==i[7]||e[8]!==i[8]||e[9]!==i[9]||e[10]!==i[10]||e[11]!==i[11])throw new Error("Missing KTX 2.0 identifier.");const n=new f,r=17*Uint32Array.BYTES_PER_ELEMENT,o=new p(t,i.length,r,!0);n.vkFormat=o._nextUint32(),n.typeSize=o._nextUint32(),n.pixelWidth=o._nextUint32(),n.pixelHeight=o._nextUint32(),n.pixelDepth=o._nextUint32(),n.layerCount=o._nextUint32(),n.faceCount=o._nextUint32();const s=o._nextUint32();n.supercompressionScheme=o._nextUint32();const a=o._nextUint32(),l=o._nextUint32(),u=o._nextUint32(),c=o._nextUint32(),h=o._nextUint64(),d=o._nextUint64(),g=new p(t,i.length+r,3*s*8,!0);for(let e=0;e<s;e++)n.levels.push({levelData:new Uint8Array(t.buffer,t.byteOffset+g._nextUint64(),g._nextUint64()),uncompressedByteLength:g._nextUint64()});const m=new p(t,a,l,!0),v={vendorId:m._skip(4)._nextUint16(),descriptorType:m._nextUint16(),versionNumber:m._nextUint16(),descriptorBlockSize:m._nextUint16(),colorModel:m._nextUint8(),colorPrimaries:m._nextUint8(),transferFunction:m._nextUint8(),flags:m._nextUint8(),texelBlockDimension:{x:m._nextUint8()+1,y:m._nextUint8()+1,z:m._nextUint8()+1,w:m._nextUint8()+1},bytesPlane:[m._nextUint8(),m._nextUint8(),m._nextUint8(),m._nextUint8(),m._nextUint8(),m._nextUint8(),m._nextUint8(),m._nextUint8()],samples:[]},b=(v.descriptorBlockSize/4-6)/4;for(let t=0;t<b;t++)v.samples[t]={bitOffset:m._nextUint16(),bitLength:m._nextUint8(),channelID:m._nextUint8(),samplePosition:[m._nextUint8(),m._nextUint8(),m._nextUint8(),m._nextUint8()],sampleLower:m._nextUint32(),sampleUpper:m._nextUint32()};n.dataFormatDescriptor.length=0,n.dataFormatDescriptor.push(v);const _=new p(t,u,c,!0);for(;_._offset<c;){const t=_._nextUint32(),e=_._scan(t),r=y(e),i=_._scan(t-e.byteLength);n.keyValue[r]=r.match(/^ktx/i)?y(i):i,t%4&&_._skip(4-t%4)}if(d<=0)return n;const A=new p(t,h,d,!0),x=A._nextUint16(),w=A._nextUint16(),C=A._nextUint32(),S=A._nextUint32(),E=A._nextUint32(),M=A._nextUint32(),P=[];for(let t=0;t<s;t++)P.push({imageFlags:A._nextUint32(),rgbSliceByteOffset:A._nextUint32(),rgbSliceByteLength:A._nextUint32(),alphaSliceByteOffset:A._nextUint32(),alphaSliceByteLength:A._nextUint32()});const T=h+A._offset,O=T+C,I=O+S,R=I+E,B=new Uint8Array(t.buffer,t.byteOffset+T,C),L=new Uint8Array(t.buffer,t.byteOffset+O,S),k=new Uint8Array(t.buffer,t.byteOffset+I,E),D=new Uint8Array(t.buffer,t.byteOffset+R,M);return n.globalData={endpointCount:x,selectorCount:w,imageDescs:P,endpointsData:B,selectorsData:L,tablesData:k,extendedData:D},n}function b(){return(b=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}const _={keepWriter:!1};function A(t,e={}){e=b({},_,e);let n=new ArrayBuffer(0);if(t.globalData){const e=new ArrayBuffer(20+5*t.globalData.imageDescs.length*4),r=new DataView(e);r.setUint16(0,t.globalData.endpointCount,!0),r.setUint16(2,t.globalData.selectorCount,!0),r.setUint32(4,t.globalData.endpointsData.byteLength,!0),r.setUint32(8,t.globalData.selectorsData.byteLength,!0),r.setUint32(12,t.globalData.tablesData.byteLength,!0),r.setUint32(16,t.globalData.extendedData.byteLength,!0);for(let e=0;e<t.globalData.imageDescs.length;e++){const n=t.globalData.imageDescs[e];r.setUint32(20+5*e*4+0,n.imageFlags,!0),r.setUint32(20+5*e*4+4,n.rgbSliceByteOffset,!0),r.setUint32(20+5*e*4+8,n.rgbSliceByteLength,!0),r.setUint32(20+5*e*4+12,n.alphaSliceByteOffset,!0),r.setUint32(20+5*e*4+16,n.alphaSliceByteLength,!0)}n=m([e,t.globalData.endpointsData,t.globalData.selectorsData,t.globalData.tablesData,t.globalData.extendedData])}const o=[];let a=t.keyValue;e.keepWriter||(a=b({},t.keyValue,{KTXwriter:"KTX-Parse v0.0.4"}));for(const t in a){const e=a[t],n=g(t),i="string"==typeof e?g(e):e,s=n.byteLength+1+i.byteLength+1,l=s%4?4-s%4:0;o.push(m([new Uint32Array([s]),n,r,i,r,new Uint8Array(l).fill(0)]))}const l=m(o),u=new ArrayBuffer(44),c=new DataView(u);if(1!==t.dataFormatDescriptor.length||t.dataFormatDescriptor[0].descriptorType!==s.BASICFORMAT)throw new Error("Only BASICFORMAT Data Format Descriptor output supported.");const h=t.dataFormatDescriptor[0];c.setUint32(0,44,!0),c.setUint16(4,h.vendorId,!0),c.setUint16(6,h.descriptorType,!0),c.setUint16(8,h.versionNumber,!0),c.setUint16(10,h.descriptorBlockSize,!0),c.setUint8(12,h.colorModel),c.setUint8(13,h.colorPrimaries),c.setUint8(14,h.transferFunction),c.setUint8(15,h.flags),c.setUint8(16,h.texelBlockDimension.x-1),c.setUint8(17,h.texelBlockDimension.y-1),c.setUint8(18,h.texelBlockDimension.z-1),c.setUint8(19,h.texelBlockDimension.w-1);for(let t=0;t<8;t++)c.setUint8(20+t,h.bytesPlane[t]);for(let t=0;t<h.samples.length;t++){const e=h.samples[t],n=28+16*t;c.setUint16(n+0,e.bitOffset,!0),c.setUint8(n+2,e.bitLength),c.setUint8(n+3,e.channelID),c.setUint8(n+4,e.samplePosition[0]),c.setUint8(n+5,e.samplePosition[1]),c.setUint8(n+6,e.samplePosition[2]),c.setUint8(n+7,e.samplePosition[3]),c.setUint32(n+8,e.sampleLower,!0),c.setUint32(n+12,e.sampleUpper,!0)}const d=i.length+68+3*t.levels.length*8,f=d+u.byteLength;let p=f+l.byteLength;p%8&&(p+=8-p%8);const y=[],v=new DataView(new ArrayBuffer(3*t.levels.length*8));let A=p+n.byteLength;for(let e=0;e<t.levels.length;e++){const n=t.levels[e];y.push(n.levelData),v.setBigUint64(24*e+0,BigInt(A),!0),v.setBigUint64(24*e+8,BigInt(n.levelData.byteLength),!0),v.setBigUint64(24*e+16,BigInt(n.uncompressedByteLength),!0),A+=n.levelData.byteLength}const x=new ArrayBuffer(68),w=new DataView(x);return w.setUint32(0,t.vkFormat,!0),w.setUint32(4,t.typeSize,!0),w.setUint32(8,t.pixelWidth,!0),w.setUint32(12,t.pixelHeight,!0),w.setUint32(16,t.pixelDepth,!0),w.setUint32(20,t.layerCount,!0),w.setUint32(24,t.faceCount,!0),w.setUint32(28,t.levels.length,!0),w.setUint32(32,t.supercompressionScheme,!0),w.setUint32(36,d,!0),w.setUint32(40,u.byteLength,!0),w.setUint32(44,f,!0),w.setUint32(48,l.byteLength,!0),w.setBigUint64(52,BigInt(p),!0),w.setBigUint64(60,BigInt(n.byteLength),!0),new Uint8Array(m([new Uint8Array(i).buffer,x,v.buffer,u,l,new ArrayBuffer(p-(f+l.byteLength)),n,...y]))}},91863:(t,e,n)=>{var r=9007199254740991,i="[object Arguments]",o="[object Function]",s="[object GeneratorFunction]",a="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,l="object"==typeof self&&self&&self.Object===Object&&self,u=a||l||Function("return this")();function c(t,e){for(var n=-1,r=e.length,i=t.length;++n<r;)t[i+n]=e[n];return t}var h=Object.prototype,d=h.hasOwnProperty,f=h.toString,p=u.Symbol,g=h.propertyIsEnumerable,y=p?p.isConcatSpreadable:void 0,m=Math.max;function v(t,e,n,r,i){var o=-1,s=t.length;for(n||(n=b),i||(i=[]);++o<s;){var a=t[o];e>0&&n(a)?e>1?v(a,e-1,n,r,i):c(i,a):r||(i[i.length]=a)}return i}function b(t){return A(t)||function(t){return function(t){return x(t)&&function(t){return null!=t&&function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=r}(t.length)&&!function(t){var e=function(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}(t)?f.call(t):"";return e==o||e==s}(t)}(t)}(t)&&d.call(t,"callee")&&(!g.call(t,"callee")||f.call(t)==i)}(t)||!!(y&&t&&t[y])}function _(t){if("string"==typeof t||function(t){return"symbol"==typeof t||x(t)&&"[object Symbol]"==f.call(t)}(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}var A=Array.isArray;function x(t){return!!t&&"object"==typeof t}var w,C,S=(w=function(t,e){return null==t?{}:function(t,e){return function(t,e,n){for(var r=-1,i=e.length,o={};++r<i;){var s=e[r],a=t[s];n(0,s)&&(o[s]=a)}return o}(t=Object(t),e,(function(e,n){return n in t}))}(t,function(t,e){for(var n=-1,r=t?t.length:0,i=Array(r);++n<r;)i[n]=e(t[n],n,t);return i}(v(e,1),_))},C=m(void 0===C?w.length-1:C,0),function(){for(var t=arguments,e=-1,n=m(t.length-C,0),r=Array(n);++e<n;)r[e]=t[C+e];e=-1;for(var i=Array(C+1);++e<C;)i[e]=t[e];return i[C]=r,function(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}(w,this,i)});t.exports=S},90879:(t,e,n)=>{var r="__lodash_hash_undefined__",i="[object Function]",o="[object GeneratorFunction]",s=/^\[object .+?Constructor\]$/,a="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,l="object"==typeof self&&self&&self.Object===Object&&self,u=a||l||Function("return this")();function c(t,e){return!(!t||!t.length)&&function(t,e){if(e!=e)return function(t,e){for(var n=t.length,r=-1;++r<n;)if(e(t[r],r,t))return r;return-1}(t,h);for(var n=-1,r=t.length;++n<r;)if(t[n]===e)return n;return-1}(t,e)>-1}function h(t){return t!=t}function d(t,e){return t.has(e)}function f(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=t})),n}var p,g=Array.prototype,y=Function.prototype,m=Object.prototype,v=u["__core-js_shared__"],b=(p=/[^.]+$/.exec(v&&v.keys&&v.keys.IE_PROTO||""))?"Symbol(src)_1."+p:"",_=y.toString,A=m.hasOwnProperty,x=m.toString,w=RegExp("^"+_.call(A).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),C=g.splice,S=k(u,"Map"),E=k(u,"Set"),M=k(Object,"create");function P(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function T(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function O(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function I(t){var e=-1,n=t?t.length:0;for(this.__data__=new O;++e<n;)this.add(t[e])}function R(t,e){for(var n,r,i=t.length;i--;)if((n=t[i][0])===(r=e)||n!=n&&r!=r)return i;return-1}P.prototype.clear=function(){this.__data__=M?M(null):{}},P.prototype.delete=function(t){return this.has(t)&&delete this.__data__[t]},P.prototype.get=function(t){var e=this.__data__;if(M){var n=e[t];return n===r?void 0:n}return A.call(e,t)?e[t]:void 0},P.prototype.has=function(t){var e=this.__data__;return M?void 0!==e[t]:A.call(e,t)},P.prototype.set=function(t,e){return this.__data__[t]=M&&void 0===e?r:e,this},T.prototype.clear=function(){this.__data__=[]},T.prototype.delete=function(t){var e=this.__data__,n=R(e,t);return!(n<0||(n==e.length-1?e.pop():C.call(e,n,1),0))},T.prototype.get=function(t){var e=this.__data__,n=R(e,t);return n<0?void 0:e[n][1]},T.prototype.has=function(t){return R(this.__data__,t)>-1},T.prototype.set=function(t,e){var n=this.__data__,r=R(n,t);return r<0?n.push([t,e]):n[r][1]=e,this},O.prototype.clear=function(){this.__data__={hash:new P,map:new(S||T),string:new P}},O.prototype.delete=function(t){return L(this,t).delete(t)},O.prototype.get=function(t){return L(this,t).get(t)},O.prototype.has=function(t){return L(this,t).has(t)},O.prototype.set=function(t,e){return L(this,t).set(t,e),this},I.prototype.add=I.prototype.push=function(t){return this.__data__.set(t,r),this},I.prototype.has=function(t){return this.__data__.has(t)};var B=E&&1/f(new E([,-0]))[1]==1/0?function(t){return new E(t)}:function(){};function L(t,e){var n,r,i=t.__data__;return("string"==(r=typeof(n=e))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?i["string"==typeof e?"string":"hash"]:i.map}function k(t,e){var n=function(t,e){return null==t?void 0:t[e]}(t,e);return function(t){if(!D(t)||b&&b in t)return!1;var e=function(t){var e=D(t)?x.call(t):"";return e==i||e==o}(t)||function(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}(t)?w:s;return e.test(function(t){if(null!=t){try{return _.call(t)}catch(t){}try{return t+""}catch(t){}}return""}(t))}(n)?n:void 0}function D(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}t.exports=function(t){return t&&t.length?function(t,e,n){var r=-1,i=c,o=t.length,s=!0,a=[],l=a;if(o>=200){var u=B(t);if(u)return f(u);s=!1,i=d,l=new I}else l=a;t:for(;++r<o;){var h=t[r],p=h;if(h=0!==h?h:0,s&&p==p){for(var g=l.length;g--;)if(l[g]===p)continue t;a.push(h)}else i(l,p,n)||(l!==a&&l.push(p),a.push(h))}return a}(t):[]}},60004:function(t,e){var n,r;void 0===(r="function"==typeof(n=function(){"use strict";function t(t,e,n){this.low=0|t,this.high=0|e,this.unsigned=!!n}function e(t){return!0===(t&&t.__isLong__)}t.prototype.__isLong__,Object.defineProperty(t.prototype,"__isLong__",{value:!0,enumerable:!1,configurable:!1}),t.isLong=e;var n={},r={};function i(t,e){var i,o,a;return e?(a=0<=(t>>>=0)&&t<256)&&(o=r[t])?o:(i=s(t,(0|t)<0?-1:0,!0),a&&(r[t]=i),i):(a=-128<=(t|=0)&&t<128)&&(o=n[t])?o:(i=s(t,t<0?-1:0,!1),a&&(n[t]=i),i)}function o(t,e){if(isNaN(t)||!isFinite(t))return e?g:p;if(e){if(t<0)return g;if(t>=h)return _}else{if(t<=-d)return A;if(t+1>=d)return b}return t<0?o(-t,e).neg():s(t%c|0,t/c|0,e)}function s(e,n,r){return new t(e,n,r)}t.fromInt=i,t.fromNumber=o,t.fromBits=s;var a=Math.pow;function l(t,e,n){if(0===t.length)throw Error("empty string");if("NaN"===t||"Infinity"===t||"+Infinity"===t||"-Infinity"===t)return p;if("number"==typeof e?(n=e,e=!1):e=!!e,(n=n||10)<2||36<n)throw RangeError("radix");var r;if((r=t.indexOf("-"))>0)throw Error("interior hyphen");if(0===r)return l(t.substring(1),e,n).neg();for(var i=o(a(n,8)),s=p,u=0;u<t.length;u+=8){var c=Math.min(8,t.length-u),h=parseInt(t.substring(u,u+c),n);if(c<8){var d=o(a(n,c));s=s.mul(d).add(o(h))}else s=(s=s.mul(i)).add(o(h))}return s.unsigned=e,s}function u(e){return e instanceof t?e:"number"==typeof e?o(e):"string"==typeof e?l(e):s(e.low,e.high,e.unsigned)}t.fromString=l,t.fromValue=u;var c=4294967296,h=c*c,d=h/2,f=i(1<<24),p=i(0);t.ZERO=p;var g=i(0,!0);t.UZERO=g;var y=i(1);t.ONE=y;var m=i(1,!0);t.UONE=m;var v=i(-1);t.NEG_ONE=v;var b=s(-1,2147483647,!1);t.MAX_VALUE=b;var _=s(-1,-1,!0);t.MAX_UNSIGNED_VALUE=_;var A=s(0,-2147483648,!1);t.MIN_VALUE=A;var x=t.prototype;return x.toInt=function(){return this.unsigned?this.low>>>0:this.low},x.toNumber=function(){return this.unsigned?(this.high>>>0)*c+(this.low>>>0):this.high*c+(this.low>>>0)},x.toString=function(t){if((t=t||10)<2||36<t)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(A)){var e=o(t),n=this.div(e),r=n.mul(e).sub(this);return n.toString(t)+r.toInt().toString(t)}return"-"+this.neg().toString(t)}for(var i=o(a(t,6),this.unsigned),s=this,l="";;){var u=s.div(i),c=(s.sub(u.mul(i)).toInt()>>>0).toString(t);if((s=u).isZero())return c+l;for(;c.length<6;)c="0"+c;l=""+c+l}},x.getHighBits=function(){return this.high},x.getHighBitsUnsigned=function(){return this.high>>>0},x.getLowBits=function(){return this.low},x.getLowBitsUnsigned=function(){return this.low>>>0},x.getNumBitsAbs=function(){if(this.isNegative())return this.eq(A)?64:this.neg().getNumBitsAbs();for(var t=0!=this.high?this.high:this.low,e=31;e>0&&!(t&1<<e);e--);return 0!=this.high?e+33:e+1},x.isZero=function(){return 0===this.high&&0===this.low},x.isNegative=function(){return!this.unsigned&&this.high<0},x.isPositive=function(){return this.unsigned||this.high>=0},x.isOdd=function(){return!(1&~this.low)},x.isEven=function(){return!(1&this.low)},x.equals=function(t){return e(t)||(t=u(t)),(this.unsigned===t.unsigned||this.high>>>31!=1||t.high>>>31!=1)&&this.high===t.high&&this.low===t.low},x.eq=x.equals,x.notEquals=function(t){return!this.eq(t)},x.neq=x.notEquals,x.lessThan=function(t){return this.comp(t)<0},x.lt=x.lessThan,x.lessThanOrEqual=function(t){return this.comp(t)<=0},x.lte=x.lessThanOrEqual,x.greaterThan=function(t){return this.comp(t)>0},x.gt=x.greaterThan,x.greaterThanOrEqual=function(t){return this.comp(t)>=0},x.gte=x.greaterThanOrEqual,x.compare=function(t){if(e(t)||(t=u(t)),this.eq(t))return 0;var n=this.isNegative(),r=t.isNegative();return n&&!r?-1:!n&&r?1:this.unsigned?t.high>>>0>this.high>>>0||t.high===this.high&&t.low>>>0>this.low>>>0?-1:1:this.sub(t).isNegative()?-1:1},x.comp=x.compare,x.negate=function(){return!this.unsigned&&this.eq(A)?A:this.not().add(y)},x.neg=x.negate,x.add=function(t){e(t)||(t=u(t));var n=this.high>>>16,r=65535&this.high,i=this.low>>>16,o=65535&this.low,a=t.high>>>16,l=65535&t.high,c=t.low>>>16,h=0,d=0,f=0,p=0;return f+=(p+=o+(65535&t.low))>>>16,d+=(f+=i+c)>>>16,h+=(d+=r+l)>>>16,h+=n+a,s((f&=65535)<<16|(p&=65535),(h&=65535)<<16|(d&=65535),this.unsigned)},x.subtract=function(t){return e(t)||(t=u(t)),this.add(t.neg())},x.sub=x.subtract,x.multiply=function(t){if(this.isZero())return p;if(e(t)||(t=u(t)),t.isZero())return p;if(this.eq(A))return t.isOdd()?A:p;if(t.eq(A))return this.isOdd()?A:p;if(this.isNegative())return t.isNegative()?this.neg().mul(t.neg()):this.neg().mul(t).neg();if(t.isNegative())return this.mul(t.neg()).neg();if(this.lt(f)&&t.lt(f))return o(this.toNumber()*t.toNumber(),this.unsigned);var n=this.high>>>16,r=65535&this.high,i=this.low>>>16,a=65535&this.low,l=t.high>>>16,c=65535&t.high,h=t.low>>>16,d=65535&t.low,g=0,y=0,m=0,v=0;return m+=(v+=a*d)>>>16,y+=(m+=i*d)>>>16,m&=65535,y+=(m+=a*h)>>>16,g+=(y+=r*d)>>>16,y&=65535,g+=(y+=i*h)>>>16,y&=65535,g+=(y+=a*c)>>>16,g+=n*d+r*h+i*c+a*l,s((m&=65535)<<16|(v&=65535),(g&=65535)<<16|(y&=65535),this.unsigned)},x.mul=x.multiply,x.divide=function(t){if(e(t)||(t=u(t)),t.isZero())throw Error("division by zero");if(this.isZero())return this.unsigned?g:p;var n,r,i;if(this.unsigned){if(t.unsigned||(t=t.toUnsigned()),t.gt(this))return g;if(t.gt(this.shru(1)))return m;i=g}else{if(this.eq(A))return t.eq(y)||t.eq(v)?A:t.eq(A)?y:(n=this.shr(1).div(t).shl(1)).eq(p)?t.isNegative()?y:v:(r=this.sub(t.mul(n)),i=n.add(r.div(t)));if(t.eq(A))return this.unsigned?g:p;if(this.isNegative())return t.isNegative()?this.neg().div(t.neg()):this.neg().div(t).neg();if(t.isNegative())return this.div(t.neg()).neg();i=p}for(r=this;r.gte(t);){n=Math.max(1,Math.floor(r.toNumber()/t.toNumber()));for(var s=Math.ceil(Math.log(n)/Math.LN2),l=s<=48?1:a(2,s-48),c=o(n),h=c.mul(t);h.isNegative()||h.gt(r);)h=(c=o(n-=l,this.unsigned)).mul(t);c.isZero()&&(c=y),i=i.add(c),r=r.sub(h)}return i},x.div=x.divide,x.modulo=function(t){return e(t)||(t=u(t)),this.sub(this.div(t).mul(t))},x.mod=x.modulo,x.not=function(){return s(~this.low,~this.high,this.unsigned)},x.and=function(t){return e(t)||(t=u(t)),s(this.low&t.low,this.high&t.high,this.unsigned)},x.or=function(t){return e(t)||(t=u(t)),s(this.low|t.low,this.high|t.high,this.unsigned)},x.xor=function(t){return e(t)||(t=u(t)),s(this.low^t.low,this.high^t.high,this.unsigned)},x.shiftLeft=function(t){return e(t)&&(t=t.toInt()),0==(t&=63)?this:t<32?s(this.low<<t,this.high<<t|this.low>>>32-t,this.unsigned):s(0,this.low<<t-32,this.unsigned)},x.shl=x.shiftLeft,x.shiftRight=function(t){return e(t)&&(t=t.toInt()),0==(t&=63)?this:t<32?s(this.low>>>t|this.high<<32-t,this.high>>t,this.unsigned):s(this.high>>t-32,this.high>=0?0:-1,this.unsigned)},x.shr=x.shiftRight,x.shiftRightUnsigned=function(t){if(e(t)&&(t=t.toInt()),0==(t&=63))return this;var n=this.high;return t<32?s(this.low>>>t|n<<32-t,n>>>t,this.unsigned):s(32===t?n:n>>>t-32,0,this.unsigned)},x.shru=x.shiftRightUnsigned,x.toSigned=function(){return this.unsigned?s(this.low,this.high,!1):this},x.toUnsigned=function(){return this.unsigned?this:s(this.low,this.high,!0)},x.toBytes=function(t){return t?this.toBytesLE():this.toBytesBE()},x.toBytesLE=function(){var t=this.high,e=this.low;return[255&e,e>>>8&255,e>>>16&255,e>>>24&255,255&t,t>>>8&255,t>>>16&255,t>>>24&255]},x.toBytesBE=function(){var t=this.high,e=this.low;return[t>>>24&255,t>>>16&255,t>>>8&255,255&t,e>>>24&255,e>>>16&255,e>>>8&255,255&e]},t})?n.apply(e,[]):n)||(t.exports=r)},39861:(t,e,n)=>{"use strict";n.r(e),n.d(e,{Euler:()=>m,Matrix3:()=>s.A,Matrix4:()=>a.A,Pose:()=>v,Quaternion:()=>l.A,SphericalCoordinates:()=>u.A,Vector2:()=>r.A,Vector3:()=>i.A,Vector4:()=>o.A,_Euler:()=>m,_MathUtils:()=>b.A,_Pose:()=>v,_SphericalCoordinates:()=>u.A,acos:()=>d.HQ,asin:()=>d.qR,assert:()=>_.A,atan:()=>d.rY,clamp:()=>d.qE,clone:()=>d.o8,config:()=>d.$W,configure:()=>d.jK,cos:()=>d.gn,degrees:()=>d.uj,equals:()=>d.aI,exactEquals:()=>d.t2,formatValue:()=>d.Fl,isArray:()=>d.cy,lerp:()=>d.Cc,radians:()=>d.F2,sin:()=>d.F8,tan:()=>d.Ml,toDegrees:()=>d.xW,toRadians:()=>d.eh,withEpsilon:()=>d.ZK});var r=n(90353),i=n(22466),o=n(82251),s=n(50108),a=n(98569),l=n(5521),u=n(27539),c=n(67136),h=n(46094),d=n(54692),f=n(66654);const p="Unknown Euler angle order",g=.99999;var y;!function(t){t[t.ZYX=0]="ZYX",t[t.YXZ=1]="YXZ",t[t.XZY=2]="XZY",t[t.ZXY=3]="ZXY",t[t.YZX=4]="YZX",t[t.XYZ=5]="XYZ"}(y||(y={}));class m extends h.A{static get ZYX(){return y.ZYX}static get YXZ(){return y.YXZ}static get XZY(){return y.XZY}static get ZXY(){return y.ZXY}static get YZX(){return y.YZX}static get XYZ(){return y.XYZ}static get RollPitchYaw(){return y.ZYX}static get DefaultOrder(){return y.ZYX}static get RotationOrders(){return y}static rotationOrder(t){return y[t]}get ELEMENTS(){return 4}constructor(t=0,e=0,n=0,r=m.DefaultOrder){super(-0,-0,-0,-0),arguments.length>0&&Array.isArray(arguments[0])?this.fromVector3(...arguments):this.set(t,e,n,r)}fromQuaternion(t){const[e,n,r,i]=t,o=n*n,s=-2*(o+r*r)+1,a=2*(e*n+i*r);let l=-2*(e*r-i*n);const u=2*(n*r+i*e),c=-2*(e*e+o)+1;l=l>1?1:l,l=l<-1?-1:l;const h=Math.atan2(u,c),d=Math.asin(l),f=Math.atan2(a,s);return this.set(h,d,f,m.RollPitchYaw)}fromObject(t){throw new Error("not implemented")}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=Number.isFinite(t[3])||this.order,this.check()}set(t=0,e=0,n=0,r){return this[0]=t,this[1]=e,this[2]=n,this[3]=Number.isFinite(r)?r:this[3],this.check()}validate(){return(t=this[3])>=0&&t<6&&Number.isFinite(this[0])&&Number.isFinite(this[1])&&Number.isFinite(this[2]);var t}toArray(t=[],e=0){return t[e]=this[0],t[e+1]=this[1],t[e+2]=this[2],t}toArray4(t=[],e=0){return t[e]=this[0],t[e+1]=this[1],t[e+2]=this[2],t[e+3]=this[3],t}toVector3(t=[-0,-0,-0]){return t[0]=this[0],t[1]=this[1],t[2]=this[2],t}get x(){return this[0]}set x(t){this[0]=(0,f.ws)(t)}get y(){return this[1]}set y(t){this[1]=(0,f.ws)(t)}get z(){return this[2]}set z(t){this[2]=(0,f.ws)(t)}get alpha(){return this[0]}set alpha(t){this[0]=(0,f.ws)(t)}get beta(){return this[1]}set beta(t){this[1]=(0,f.ws)(t)}get gamma(){return this[2]}set gamma(t){this[2]=(0,f.ws)(t)}get phi(){return this[0]}set phi(t){this[0]=(0,f.ws)(t)}get theta(){return this[1]}set theta(t){this[1]=(0,f.ws)(t)}get psi(){return this[2]}set psi(t){this[2]=(0,f.ws)(t)}get roll(){return this[0]}set roll(t){this[0]=(0,f.ws)(t)}get pitch(){return this[1]}set pitch(t){this[1]=(0,f.ws)(t)}get yaw(){return this[2]}set yaw(t){this[2]=(0,f.ws)(t)}get order(){return this[3]}set order(t){this[3]=function(t){if(t<0&&t>=6)throw new Error(p);return t}(t)}fromVector3(t,e){return this.set(t[0],t[1],t[2],Number.isFinite(e)?e:this[3])}fromArray(t,e=0){return this[0]=t[0+e],this[1]=t[1+e],this[2]=t[2+e],void 0!==t[3]&&(this[3]=t[3]),this.check()}fromRollPitchYaw(t,e,n){return this.set(t,e,n,y.ZYX)}fromRotationMatrix(t,e=m.DefaultOrder){return this._fromRotationMatrix(t,e),this.check()}getRotationMatrix(t){return this._getRotationMatrix(t)}getQuaternion(){const t=new l.A;switch(this[4]){case y.XYZ:return t.rotateX(this[0]).rotateY(this[1]).rotateZ(this[2]);case y.YXZ:return t.rotateY(this[0]).rotateX(this[1]).rotateZ(this[2]);case y.ZXY:return t.rotateZ(this[0]).rotateX(this[1]).rotateY(this[2]);case y.ZYX:return t.rotateZ(this[0]).rotateY(this[1]).rotateX(this[2]);case y.YZX:return t.rotateY(this[0]).rotateZ(this[1]).rotateX(this[2]);case y.XZY:return t.rotateX(this[0]).rotateZ(this[1]).rotateY(this[2]);default:throw new Error(p)}}_fromRotationMatrix(t,e=m.DefaultOrder){const n=t[0],r=t[4],i=t[8],o=t[1],s=t[5],a=t[9],l=t[2],u=t[6],c=t[10];switch(e=e||this[3]){case m.XYZ:this[1]=Math.asin((0,d.qE)(i,-1,1)),Math.abs(i)<g?(this[0]=Math.atan2(-a,c),this[2]=Math.atan2(-r,n)):(this[0]=Math.atan2(u,s),this[2]=0);break;case m.YXZ:this[0]=Math.asin(-(0,d.qE)(a,-1,1)),Math.abs(a)<g?(this[1]=Math.atan2(i,c),this[2]=Math.atan2(o,s)):(this[1]=Math.atan2(-l,n),this[2]=0);break;case m.ZXY:this[0]=Math.asin((0,d.qE)(u,-1,1)),Math.abs(u)<g?(this[1]=Math.atan2(-l,c),this[2]=Math.atan2(-r,s)):(this[1]=0,this[2]=Math.atan2(o,n));break;case m.ZYX:this[1]=Math.asin(-(0,d.qE)(l,-1,1)),Math.abs(l)<g?(this[0]=Math.atan2(u,c),this[2]=Math.atan2(o,n)):(this[0]=0,this[2]=Math.atan2(-r,s));break;case m.YZX:this[2]=Math.asin((0,d.qE)(o,-1,1)),Math.abs(o)<g?(this[0]=Math.atan2(-a,s),this[1]=Math.atan2(-l,n)):(this[0]=0,this[1]=Math.atan2(i,c));break;case m.XZY:this[2]=Math.asin(-(0,d.qE)(r,-1,1)),Math.abs(r)<g?(this[0]=Math.atan2(u,s),this[1]=Math.atan2(i,n)):(this[0]=Math.atan2(-a,c),this[1]=0);break;default:throw new Error(p)}return this[3]=e,this}_getRotationMatrix(t){const e=t||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],n=this.x,r=this.y,i=this.z,o=Math.cos(n),s=Math.cos(r),a=Math.cos(i),l=Math.sin(n),u=Math.sin(r),c=Math.sin(i);switch(this[3]){case m.XYZ:{const t=o*a,n=o*c,r=l*a,i=l*c;e[0]=s*a,e[4]=-s*c,e[8]=u,e[1]=n+r*u,e[5]=t-i*u,e[9]=-l*s,e[2]=i-t*u,e[6]=r+n*u,e[10]=o*s;break}case m.YXZ:{const t=s*a,n=s*c,r=u*a,i=u*c;e[0]=t+i*l,e[4]=r*l-n,e[8]=o*u,e[1]=o*c,e[5]=o*a,e[9]=-l,e[2]=n*l-r,e[6]=i+t*l,e[10]=o*s;break}case m.ZXY:{const t=s*a,n=s*c,r=u*a,i=u*c;e[0]=t-i*l,e[4]=-o*c,e[8]=r+n*l,e[1]=n+r*l,e[5]=o*a,e[9]=i-t*l,e[2]=-o*u,e[6]=l,e[10]=o*s;break}case m.ZYX:{const t=o*a,n=o*c,r=l*a,i=l*c;e[0]=s*a,e[4]=r*u-n,e[8]=t*u+i,e[1]=s*c,e[5]=i*u+t,e[9]=n*u-r,e[2]=-u,e[6]=l*s,e[10]=o*s;break}case m.YZX:{const t=o*s,n=o*u,r=l*s,i=l*u;e[0]=s*a,e[4]=i-t*c,e[8]=r*c+n,e[1]=c,e[5]=o*a,e[9]=-l*a,e[2]=-u*a,e[6]=n*c+r,e[10]=t-i*c;break}case m.XZY:{const t=o*s,n=o*u,r=l*s,i=l*u;e[0]=s*a,e[4]=-c,e[8]=u*a,e[1]=t*c+i,e[5]=o*a,e[9]=n*c-r,e[2]=r*c-n,e[6]=l*a,e[10]=i*c+t;break}default:throw new Error(p)}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}toQuaternion(){const t=Math.cos(.5*this.yaw),e=Math.sin(.5*this.yaw),n=Math.cos(.5*this.roll),r=Math.sin(.5*this.roll),i=Math.cos(.5*this.pitch),o=Math.sin(.5*this.pitch),s=t*n*i+e*r*o,a=t*r*i-e*n*o,u=t*n*o+e*r*i,c=e*n*i-t*r*o;return new l.A(a,u,c,s)}}class v{constructor({x:t=0,y:e=0,z:n=0,roll:r=0,pitch:o=0,yaw:s=0,position:a,orientation:l}={}){(0,c.A)(this,"position",void 0),(0,c.A)(this,"orientation",void 0),Array.isArray(a)&&3===a.length?this.position=new i.A(a):this.position=new i.A(t,e,n),Array.isArray(l)&&4===l.length?this.orientation=new m(l,l[3]):this.orientation=new m(r,o,s,m.RollPitchYaw)}get x(){return this.position.x}set x(t){this.position.x=t}get y(){return this.position.y}set y(t){this.position.y=t}get z(){return this.position.z}set z(t){this.position.z=t}get roll(){return this.orientation.roll}set roll(t){this.orientation.roll=t}get pitch(){return this.orientation.pitch}set pitch(t){this.orientation.pitch=t}get yaw(){return this.orientation.yaw}set yaw(t){this.orientation.yaw=t}getPosition(){return this.position}getOrientation(){return this.orientation}equals(t){return!!t&&this.position.equals(t.position)&&this.orientation.equals(t.orientation)}exactEquals(t){return!!t&&this.position.exactEquals(t.position)&&this.orientation.exactEquals(t.orientation)}getTransformationMatrix(){const t=Math.sin(this.roll),e=Math.sin(this.pitch),n=Math.sin(this.yaw),r=Math.cos(this.roll),i=Math.cos(this.pitch),o=Math.cos(this.yaw);return(new a.A).setRowMajor(o*i,-n*r+o*e*t,n*t+o*e*r,this.x,n*i,o*r+n*e*t,-o*t+n*e*r,this.y,-e,i*t,i*r,this.z,0,0,0,1)}getTransformationMatrixFromPose(t){return(new a.A).multiplyRight(this.getTransformationMatrix()).multiplyRight(t.getTransformationMatrix().invert())}getTransformationMatrixToPose(t){return(new a.A).multiplyRight(t.getTransformationMatrix()).multiplyRight(this.getTransformationMatrix().invert())}}var b=n(33067),_=n(58523)},15335:(t,e,n)=>{"use strict";t.exports=i;var r=n(251);function i(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}i.Varint=0,i.Fixed64=1,i.Bytes=2,i.Fixed32=5;var o=4294967296,s=1/o,a="undefined"==typeof TextDecoder?null:new TextDecoder("utf-8");function l(t){return t.type===i.Bytes?t.readVarint()+t.pos:t.pos+1}function u(t,e,n){return n?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function c(t,e,n){var r=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));n.realloc(r);for(var i=n.pos-1;i>=t;i--)n.buf[i+r]=n.buf[i]}function h(t,e){for(var n=0;n<t.length;n++)e.writeVarint(t[n])}function d(t,e){for(var n=0;n<t.length;n++)e.writeSVarint(t[n])}function f(t,e){for(var n=0;n<t.length;n++)e.writeFloat(t[n])}function p(t,e){for(var n=0;n<t.length;n++)e.writeDouble(t[n])}function g(t,e){for(var n=0;n<t.length;n++)e.writeBoolean(t[n])}function y(t,e){for(var n=0;n<t.length;n++)e.writeFixed32(t[n])}function m(t,e){for(var n=0;n<t.length;n++)e.writeSFixed32(t[n])}function v(t,e){for(var n=0;n<t.length;n++)e.writeFixed64(t[n])}function b(t,e){for(var n=0;n<t.length;n++)e.writeSFixed64(t[n])}function _(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function A(t,e,n){t[n]=e,t[n+1]=e>>>8,t[n+2]=e>>>16,t[n+3]=e>>>24}function x(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}i.prototype={destroy:function(){this.buf=null},readFields:function(t,e,n){for(n=n||this.length;this.pos<n;){var r=this.readVarint(),i=r>>3,o=this.pos;this.type=7&r,t(i,e,this),this.pos===o&&this.skip(r)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=_(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=x(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=_(this.buf,this.pos)+_(this.buf,this.pos+4)*o;return this.pos+=8,t},readSFixed64:function(){var t=_(this.buf,this.pos)+x(this.buf,this.pos+4)*o;return this.pos+=8,t},readFloat:function(){var t=r.read(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=r.read(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,n,r=this.buf;return e=127&(n=r[this.pos++]),n<128?e:(e|=(127&(n=r[this.pos++]))<<7,n<128?e:(e|=(127&(n=r[this.pos++]))<<14,n<128?e:(e|=(127&(n=r[this.pos++]))<<21,n<128?e:function(t,e,n){var r,i,o=n.buf;if(r=(112&(i=o[n.pos++]))>>4,i<128)return u(t,r,e);if(r|=(127&(i=o[n.pos++]))<<3,i<128)return u(t,r,e);if(r|=(127&(i=o[n.pos++]))<<10,i<128)return u(t,r,e);if(r|=(127&(i=o[n.pos++]))<<17,i<128)return u(t,r,e);if(r|=(127&(i=o[n.pos++]))<<24,i<128)return u(t,r,e);if(r|=(1&(i=o[n.pos++]))<<31,i<128)return u(t,r,e);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(n=r[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=12&&a?function(t,e,n){return a.decode(t.subarray(e,n))}(this.buf,e,t):function(t,e,n){for(var r="",i=e;i<n;){var o,s,a,l=t[i],u=null,c=l>239?4:l>223?3:l>191?2:1;if(i+c>n)break;1===c?l<128&&(u=l):2===c?128==(192&(o=t[i+1]))&&(u=(31&l)<<6|63&o)<=127&&(u=null):3===c?(o=t[i+1],s=t[i+2],128==(192&o)&&128==(192&s)&&((u=(15&l)<<12|(63&o)<<6|63&s)<=2047||u>=55296&&u<=57343)&&(u=null)):4===c&&(o=t[i+1],s=t[i+2],a=t[i+3],128==(192&o)&&128==(192&s)&&128==(192&a)&&((u=(15&l)<<18|(63&o)<<12|(63&s)<<6|63&a)<=65535||u>=1114112)&&(u=null)),null===u?(u=65533,c=1):u>65535&&(u-=65536,r+=String.fromCharCode(u>>>10&1023|55296),u=56320|1023&u),r+=String.fromCharCode(u),i+=c}return r}(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==i.Bytes)return t.push(this.readVarint(e));var n=l(this);for(t=t||[];this.pos<n;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==i.Bytes)return t.push(this.readSVarint());var e=l(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==i.Bytes)return t.push(this.readBoolean());var e=l(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==i.Bytes)return t.push(this.readFloat());var e=l(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==i.Bytes)return t.push(this.readDouble());var e=l(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==i.Bytes)return t.push(this.readFixed32());var e=l(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==i.Bytes)return t.push(this.readSFixed32());var e=l(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==i.Bytes)return t.push(this.readFixed64());var e=l(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==i.Bytes)return t.push(this.readSFixed64());var e=l(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===i.Varint)for(;this.buf[this.pos++]>127;);else if(e===i.Bytes)this.pos=this.readVarint()+this.pos;else if(e===i.Fixed32)this.pos+=4;else{if(e!==i.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var n=new Uint8Array(e);n.set(this.buf),this.buf=n,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),A(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),A(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),A(this.buf,-1&t,this.pos),A(this.buf,Math.floor(t*s),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),A(this.buf,-1&t,this.pos),A(this.buf,Math.floor(t*s),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(t,e){var n,r;if(t>=0?(n=t%4294967296|0,r=t/4294967296|0):(r=~(-t/4294967296),4294967295^(n=~(-t%4294967296))?n=n+1|0:(n=0,r=r+1|0)),t>=0x10000000000000000||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),function(t,e,n){n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos]=127&t}(n,0,e),function(t,e){var n=(7&t)<<4;e.buf[e.pos++]|=n|((t>>>=3)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t)))))}(r,e)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(t,e,n){for(var r,i,o=0;o<e.length;o++){if((r=e.charCodeAt(o))>55295&&r<57344){if(!i){r>56319||o+1===e.length?(t[n++]=239,t[n++]=191,t[n++]=189):i=r;continue}if(r<56320){t[n++]=239,t[n++]=191,t[n++]=189,i=r;continue}r=i-55296<<10|r-56320|65536,i=null}else i&&(t[n++]=239,t[n++]=191,t[n++]=189,i=null);r<128?t[n++]=r:(r<2048?t[n++]=r>>6|192:(r<65536?t[n++]=r>>12|224:(t[n++]=r>>18|240,t[n++]=r>>12&63|128),t[n++]=r>>6&63|128),t[n++]=63&r|128)}return n}(this.buf,t,this.pos);var n=this.pos-e;n>=128&&c(e,n,this),this.pos=e-1,this.writeVarint(n),this.pos+=n},writeFloat:function(t){this.realloc(4),r.write(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),r.write(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var n=0;n<e;n++)this.buf[this.pos++]=t[n]},writeRawMessage:function(t,e){this.pos++;var n=this.pos;t(e,this);var r=this.pos-n;r>=128&&c(n,r,this),this.pos=n-1,this.writeVarint(r),this.pos+=r},writeMessage:function(t,e,n){this.writeTag(t,i.Bytes),this.writeRawMessage(e,n)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,h,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,d,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,g,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,f,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,p,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,y,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,m,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,v,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,b,e)},writeBytesField:function(t,e){this.writeTag(t,i.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,i.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,i.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,i.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,i.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,i.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,i.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,i.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,i.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,i.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}}},62564:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>r});const r=function(t,e){for(var n=0,r=0,i=0,o=0,s=0,a=0,l=0,u=0,c=null,h=null,d=t[0],f=t[1],p=e.length;n<p;n++){r=0;var g=e[n].length-1,y=e[n];if((c=y[0])[0]!==y[g][0]&&c[1]!==y[g][1])throw new Error("First and last coordinates in a ring must be the same");for(s=c[0]-d,a=c[1]-f;r<g;r++)if(u=(h=y[r+1])[1]-f,a<0&&u<0||a>0&&u>0)a=u,s=(c=h)[0]-d;else{if(l=h[0]-t[0],u>0&&a<=0){if((o=s*u-l*a)>0)i+=1;else if(0===o)return 0}else if(a>0&&u<=0){if((o=s*u-l*a)<0)i+=1;else if(0===o)return 0}else if(0===u&&a<0){if(0==(o=s*u-l*a))return 0}else if(0===a&&u<0){if(0==(o=s*u-l*a))return 0}else if(0===a&&0===u){if(l<=0&&s>=0)return 0;if(s<=0&&l>=0)return 0}c=h,a=u,s=l}}return i%2!=0}},59004:function(t,e,n){var r=n(65606);t.exports=function(){"use strict";function t(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}var e=function(t,e){this.next=null,this.key=t,this.data=e,this.left=null,this.right=null};function n(t,e){return t>e?1:t<e?-1:0}function i(t,n,r){for(var i=new e(null,null),o=i,s=i;;){var a=r(t,n.key);if(a<0){if(null===n.left)break;if(r(t,n.left.key)<0){var l=n.left;if(n.left=l.right,l.right=n,null===(n=l).left)break}s.left=n,s=n,n=n.left}else{if(!(a>0))break;if(null===n.right)break;if(r(t,n.right.key)>0&&(l=n.right,n.right=l.left,l.left=n,null===(n=l).right))break;o.right=n,o=n,n=n.right}}return o.right=n.left,s.left=n.right,n.left=i.right,n.right=i.left,n}function o(t,n,r,o){var s=new e(t,n);if(null===r)return s.left=s.right=null,s;var a=o(t,(r=i(t,r,o)).key);return a<0?(s.left=r.left,s.right=r,r.left=null):a>=0&&(s.right=r.right,s.left=r,r.right=null),s}function s(t,e,n){var r=null,o=null;if(e){var s=n((e=i(t,e,n)).key,t);0===s?(r=e.left,o=e.right):s<0?(o=e.right,e.right=null,r=e):(r=e.left,e.left=null,o=e)}return{left:r,right:o}}function a(t,e,n,r,i){if(t){r(e+(n?"└── ":"├── ")+i(t)+"\n");var o=e+(n?"    ":"│   ");t.left&&a(t.left,o,!1,r,i),t.right&&a(t.right,o,!0,r,i)}}var l=function(){function r(t){void 0===t&&(t=n),this._root=null,this._size=0,this._comparator=t}return r.prototype.insert=function(t,e){return this._size++,this._root=o(t,e,this._root,this._comparator)},r.prototype.add=function(t,n){var r=new e(t,n);null===this._root&&(r.left=r.right=null,this._size++,this._root=r);var o=this._comparator,s=i(t,this._root,o),a=o(t,s.key);return 0===a?this._root=s:(a<0?(r.left=s.left,r.right=s,s.left=null):a>0&&(r.right=s.right,r.left=s,s.right=null),this._size++,this._root=r),this._root},r.prototype.remove=function(t){this._root=this._remove(t,this._root,this._comparator)},r.prototype._remove=function(t,e,n){var r;return null===e?null:0===n(t,(e=i(t,e,n)).key)?(null===e.left?r=e.right:(r=i(t,e.left,n)).right=e.right,this._size--,r):e},r.prototype.pop=function(){var t=this._root;if(t){for(;t.left;)t=t.left;return this._root=i(t.key,this._root,this._comparator),this._root=this._remove(t.key,this._root,this._comparator),{key:t.key,data:t.data}}return null},r.prototype.findStatic=function(t){for(var e=this._root,n=this._comparator;e;){var r=n(t,e.key);if(0===r)return e;e=r<0?e.left:e.right}return null},r.prototype.find=function(t){return this._root&&(this._root=i(t,this._root,this._comparator),0!==this._comparator(t,this._root.key))?null:this._root},r.prototype.contains=function(t){for(var e=this._root,n=this._comparator;e;){var r=n(t,e.key);if(0===r)return!0;e=r<0?e.left:e.right}return!1},r.prototype.forEach=function(t,e){for(var n=this._root,r=[],i=!1;!i;)null!==n?(r.push(n),n=n.left):0!==r.length?(n=r.pop(),t.call(e,n),n=n.right):i=!0;return this},r.prototype.range=function(t,e,n,r){for(var i=[],o=this._comparator,s=this._root;0!==i.length||s;)if(s)i.push(s),s=s.left;else{if(o((s=i.pop()).key,e)>0)break;if(o(s.key,t)>=0&&n.call(r,s))return this;s=s.right}return this},r.prototype.keys=function(){var t=[];return this.forEach((function(e){var n=e.key;return t.push(n)})),t},r.prototype.values=function(){var t=[];return this.forEach((function(e){var n=e.data;return t.push(n)})),t},r.prototype.min=function(){return this._root?this.minNode(this._root).key:null},r.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},r.prototype.minNode=function(t){if(void 0===t&&(t=this._root),t)for(;t.left;)t=t.left;return t},r.prototype.maxNode=function(t){if(void 0===t&&(t=this._root),t)for(;t.right;)t=t.right;return t},r.prototype.at=function(t){for(var e=this._root,n=!1,r=0,i=[];!n;)if(e)i.push(e),e=e.left;else if(i.length>0){if(e=i.pop(),r===t)return e;r++,e=e.right}else n=!0;return null},r.prototype.next=function(t){var e=this._root,n=null;if(t.right){for(n=t.right;n.left;)n=n.left;return n}for(var r=this._comparator;e;){var i=r(t.key,e.key);if(0===i)break;i<0?(n=e,e=e.left):e=e.right}return n},r.prototype.prev=function(t){var e=this._root,n=null;if(null!==t.left){for(n=t.left;n.right;)n=n.right;return n}for(var r=this._comparator;e;){var i=r(t.key,e.key);if(0===i)break;i<0?e=e.left:(n=e,e=e.right)}return n},r.prototype.clear=function(){return this._root=null,this._size=0,this},r.prototype.toList=function(){return function(t){for(var n=t,r=[],i=!1,o=new e(null,null),s=o;!i;)n?(r.push(n),n=n.left):r.length>0?n=(n=s=s.next=r.pop()).right:i=!0;return s.next=null,o.next}(this._root)},r.prototype.load=function(t,n,r){void 0===n&&(n=[]),void 0===r&&(r=!1);var i=t.length,o=this._comparator;if(r&&h(t,n,0,i-1,o),null===this._root)this._root=u(t,n,0,i),this._size=i;else{var s=function(t,n,r){for(var i=new e(null,null),o=i,s=t,a=n;null!==s&&null!==a;)r(s.key,a.key)<0?(o.next=s,s=s.next):(o.next=a,a=a.next),o=o.next;return null!==s?o.next=s:null!==a&&(o.next=a),i.next}(this.toList(),function(t,n){for(var r=new e(null,null),i=r,o=0;o<t.length;o++)i=i.next=new e(t[o],n[o]);return i.next=null,r.next}(t,n),o);i=this._size+i,this._root=c({head:s},0,i)}return this},r.prototype.isEmpty=function(){return null===this._root},Object.defineProperty(r.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),r.prototype.toString=function(t){void 0===t&&(t=function(t){return String(t.key)});var e=[];return a(this._root,"",!0,(function(t){return e.push(t)}),t),e.join("")},r.prototype.update=function(t,e,n){var r=this._comparator,a=s(t,this._root,r),l=a.left,u=a.right;r(t,e)<0?u=o(e,n,u,r):l=o(e,n,l,r),this._root=function(t,e,n){return null===e?t:(null===t||((e=i(t.key,e,n)).left=t),e)}(l,u,r)},r.prototype.split=function(t){return s(t,this._root,this._comparator)},r.prototype[Symbol.iterator]=function(){var e,n,r;return t(this,(function(t){switch(t.label){case 0:e=this._root,n=[],r=!1,t.label=1;case 1:return r?[3,6]:null===e?[3,2]:(n.push(e),e=e.left,[3,5]);case 2:return 0===n.length?[3,4]:[4,e=n.pop()];case 3:return t.sent(),e=e.right,[3,5];case 4:r=!0,t.label=5;case 5:return[3,1];case 6:return[2]}}))},r}();function u(t,n,r,i){var o=i-r;if(o>0){var s=r+Math.floor(o/2),a=t[s],l=n[s],c=new e(a,l);return c.left=u(t,n,r,s),c.right=u(t,n,s+1,i),c}return null}function c(t,e,n){var r=n-e;if(r>0){var i=e+Math.floor(r/2),o=c(t,e,i),s=t.head;return s.left=o,t.head=t.head.next,s.right=c(t,i+1,n),s}return null}function h(t,e,n,r,i){if(!(n>=r)){for(var o=t[n+r>>1],s=n-1,a=r+1;;){do{s++}while(i(t[s],o)<0);do{a--}while(i(t[a],o)>0);if(s>=a)break;var l=t[s];t[s]=t[a],t[a]=l,l=e[s],e[s]=e[a],e[a]=l}h(t,e,n,a,i),h(t,e,a+1,r,i)}}const d=(t,e)=>t.ll.x<=e.x&&e.x<=t.ur.x&&t.ll.y<=e.y&&e.y<=t.ur.y,f=(t,e)=>{if(e.ur.x<t.ll.x||t.ur.x<e.ll.x||e.ur.y<t.ll.y||t.ur.y<e.ll.y)return null;const n=t.ll.x<e.ll.x?e.ll.x:t.ll.x,r=t.ur.x<e.ur.x?t.ur.x:e.ur.x;return{ll:{x:n,y:t.ll.y<e.ll.y?e.ll.y:t.ll.y},ur:{x:r,y:t.ur.y<e.ur.y?t.ur.y:e.ur.y}}};let p=Number.EPSILON;void 0===p&&(p=Math.pow(2,-52));const g=p*p,y=(t,e)=>{if(-p<t&&t<p&&-p<e&&e<p)return 0;const n=t-e;return n*n<g*t*e?0:t<e?-1:1};class m{constructor(){this.tree=new l,this.round(0)}round(t){const e=this.tree.add(t),n=this.tree.prev(e);if(null!==n&&0===y(e.key,n.key))return this.tree.remove(t),n.key;const r=this.tree.next(e);return null!==r&&0===y(e.key,r.key)?(this.tree.remove(t),r.key):t}}const v=new class{constructor(){this.reset()}reset(){this.xRounder=new m,this.yRounder=new m}round(t,e){return{x:this.xRounder.round(t),y:this.yRounder.round(e)}}},b=11102230246251565e-32,_=134217729,A=(3+8*b)*b;function x(t,e,n,r,i){let o,s,a,l,u=e[0],c=r[0],h=0,d=0;c>u==c>-u?(o=u,u=e[++h]):(o=c,c=r[++d]);let f=0;if(h<t&&d<n)for(c>u==c>-u?(s=u+o,a=o-(s-u),u=e[++h]):(s=c+o,a=o-(s-c),c=r[++d]),o=s,0!==a&&(i[f++]=a);h<t&&d<n;)c>u==c>-u?(s=o+u,l=s-o,a=o-(s-l)+(u-l),u=e[++h]):(s=o+c,l=s-o,a=o-(s-l)+(c-l),c=r[++d]),o=s,0!==a&&(i[f++]=a);for(;h<t;)s=o+u,l=s-o,a=o-(s-l)+(u-l),u=e[++h],o=s,0!==a&&(i[f++]=a);for(;d<n;)s=o+c,l=s-o,a=o-(s-l)+(c-l),c=r[++d],o=s,0!==a&&(i[f++]=a);return 0===o&&0!==f||(i[f++]=o),f}function w(t){return new Float64Array(t)}const C=22204460492503146e-32,S=11093356479670487e-47,E=w(4),M=w(8),P=w(12),T=w(16),O=w(4);function I(t,e,n,r,i,o){const s=(e-o)*(n-i),a=(t-i)*(r-o),l=s-a,u=Math.abs(s+a);return Math.abs(l)>=33306690738754716e-32*u?l:-function(t,e,n,r,i,o,s){let a,l,u,c,h,d,f,p,g,y,m,v,b,w,I,R,B,L;const k=t-i,D=n-i,F=e-o,N=r-o;w=k*N,d=_*k,f=d-(d-k),p=k-f,d=_*N,g=d-(d-N),y=N-g,I=p*y-(w-f*g-p*g-f*y),R=F*D,d=_*F,f=d-(d-F),p=F-f,d=_*D,g=d-(d-D),y=D-g,B=p*y-(R-f*g-p*g-f*y),m=I-B,h=I-m,E[0]=I-(m+h)+(h-B),v=w+m,h=v-w,b=w-(v-h)+(m-h),m=b-R,h=b-m,E[1]=b-(m+h)+(h-R),L=v+m,h=L-v,E[2]=v-(L-h)+(m-h),E[3]=L;let j=function(t,e){let n=e[0];for(let r=1;r<t;r++)n+=e[r];return n}(4,E),G=C*s;if(j>=G||-j>=G)return j;if(h=t-k,a=t-(k+h)+(h-i),h=n-D,u=n-(D+h)+(h-i),h=e-F,l=e-(F+h)+(h-o),h=r-N,c=r-(N+h)+(h-o),0===a&&0===l&&0===u&&0===c)return j;if(G=S*s+A*Math.abs(j),j+=k*c+N*a-(F*u+D*l),j>=G||-j>=G)return j;w=a*N,d=_*a,f=d-(d-a),p=a-f,d=_*N,g=d-(d-N),y=N-g,I=p*y-(w-f*g-p*g-f*y),R=l*D,d=_*l,f=d-(d-l),p=l-f,d=_*D,g=d-(d-D),y=D-g,B=p*y-(R-f*g-p*g-f*y),m=I-B,h=I-m,O[0]=I-(m+h)+(h-B),v=w+m,h=v-w,b=w-(v-h)+(m-h),m=b-R,h=b-m,O[1]=b-(m+h)+(h-R),L=v+m,h=L-v,O[2]=v-(L-h)+(m-h),O[3]=L;const U=x(4,E,4,O,M);w=k*c,d=_*k,f=d-(d-k),p=k-f,d=_*c,g=d-(d-c),y=c-g,I=p*y-(w-f*g-p*g-f*y),R=F*u,d=_*F,f=d-(d-F),p=F-f,d=_*u,g=d-(d-u),y=u-g,B=p*y-(R-f*g-p*g-f*y),m=I-B,h=I-m,O[0]=I-(m+h)+(h-B),v=w+m,h=v-w,b=w-(v-h)+(m-h),m=b-R,h=b-m,O[1]=b-(m+h)+(h-R),L=v+m,h=L-v,O[2]=v-(L-h)+(m-h),O[3]=L;const z=x(U,M,4,O,P);w=a*c,d=_*a,f=d-(d-a),p=a-f,d=_*c,g=d-(d-c),y=c-g,I=p*y-(w-f*g-p*g-f*y),R=l*u,d=_*l,f=d-(d-l),p=l-f,d=_*u,g=d-(d-u),y=u-g,B=p*y-(R-f*g-p*g-f*y),m=I-B,h=I-m,O[0]=I-(m+h)+(h-B),v=w+m,h=v-w,b=w-(v-h)+(m-h),m=b-R,h=b-m,O[1]=b-(m+h)+(h-R),L=v+m,h=L-v,O[2]=v-(L-h)+(m-h),O[3]=L;const V=x(z,P,4,O,T);return T[V-1]}(t,e,n,r,i,o,u)}const R=(t,e)=>t.x*e.y-t.y*e.x,B=(t,e)=>t.x*e.x+t.y*e.y,L=(t,e,n)=>{const r=I(t.x,t.y,e.x,e.y,n.x,n.y);return r>0?-1:r<0?1:0},k=t=>Math.sqrt(B(t,t)),D=(t,e,n)=>{const r={x:e.x-t.x,y:e.y-t.y},i={x:n.x-t.x,y:n.y-t.y};return R(i,r)/k(i)/k(r)},F=(t,e,n)=>{const r={x:e.x-t.x,y:e.y-t.y},i={x:n.x-t.x,y:n.y-t.y};return B(i,r)/k(i)/k(r)},N=(t,e,n)=>0===e.y?null:{x:t.x+e.x/e.y*(n-t.y),y:n},j=(t,e,n)=>0===e.x?null:{x:n,y:t.y+e.y/e.x*(n-t.x)};class G{static compare(t,e){const n=G.comparePoints(t.point,e.point);return 0!==n?n:(t.point!==e.point&&t.link(e),t.isLeft!==e.isLeft?t.isLeft?1:-1:z.compare(t.segment,e.segment))}static comparePoints(t,e){return t.x<e.x?-1:t.x>e.x?1:t.y<e.y?-1:t.y>e.y?1:0}constructor(t,e){void 0===t.events?t.events=[this]:t.events.push(this),this.point=t,this.isLeft=e}link(t){if(t.point===this.point)throw new Error("Tried to link already linked events");const e=t.point.events;for(let t=0,n=e.length;t<n;t++){const n=e[t];this.point.events.push(n),n.point=this.point}this.checkForConsuming()}checkForConsuming(){const t=this.point.events.length;for(let e=0;e<t;e++){const n=this.point.events[e];if(void 0===n.segment.consumedBy)for(let r=e+1;r<t;r++){const t=this.point.events[r];void 0===t.consumedBy&&n.otherSE.point.events===t.otherSE.point.events&&n.segment.consume(t.segment)}}}getAvailableLinkedEvents(){const t=[];for(let e=0,n=this.point.events.length;e<n;e++){const n=this.point.events[e];n!==this&&!n.segment.ringOut&&n.segment.isInResult()&&t.push(n)}return t}getLeftmostComparator(t){const e=new Map,n=n=>{const r=n.otherSE;e.set(n,{sine:D(this.point,t.point,r.point),cosine:F(this.point,t.point,r.point)})};return(t,r)=>{e.has(t)||n(t),e.has(r)||n(r);const{sine:i,cosine:o}=e.get(t),{sine:s,cosine:a}=e.get(r);return i>=0&&s>=0?o<a?1:o>a?-1:0:i<0&&s<0?o<a?-1:o>a?1:0:s<i?-1:s>i?1:0}}}let U=0;class z{static compare(t,e){const n=t.leftSE.point.x,r=e.leftSE.point.x,i=t.rightSE.point.x,o=e.rightSE.point.x;if(o<n)return 1;if(i<r)return-1;const s=t.leftSE.point.y,a=e.leftSE.point.y,l=t.rightSE.point.y,u=e.rightSE.point.y;if(n<r){if(a<s&&a<l)return 1;if(a>s&&a>l)return-1;const n=t.comparePoint(e.leftSE.point);if(n<0)return 1;if(n>0)return-1;const r=e.comparePoint(t.rightSE.point);return 0!==r?r:-1}if(n>r){if(s<a&&s<u)return-1;if(s>a&&s>u)return 1;const n=e.comparePoint(t.leftSE.point);if(0!==n)return n;const r=t.comparePoint(e.rightSE.point);return r<0?1:r>0?-1:1}if(s<a)return-1;if(s>a)return 1;if(i<o){const n=e.comparePoint(t.rightSE.point);if(0!==n)return n}if(i>o){const n=t.comparePoint(e.rightSE.point);if(n<0)return 1;if(n>0)return-1}if(i!==o){const t=l-s,e=i-n,c=u-a,h=o-r;if(t>e&&c<h)return 1;if(t<e&&c>h)return-1}return i>o?1:i<o||l<u?-1:l>u?1:t.id<e.id?-1:t.id>e.id?1:0}constructor(t,e,n,r){this.id=++U,this.leftSE=t,t.segment=this,t.otherSE=e,this.rightSE=e,e.segment=this,e.otherSE=t,this.rings=n,this.windings=r}static fromRing(t,e,n){let r,i,o;const s=G.comparePoints(t,e);if(s<0)r=t,i=e,o=1;else{if(!(s>0))throw new Error(`Tried to create degenerate segment at [${t.x}, ${t.y}]`);r=e,i=t,o=-1}const a=new G(r,!0),l=new G(i,!1);return new z(a,l,[n],[o])}replaceRightSE(t){this.rightSE=t,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}bbox(){const t=this.leftSE.point.y,e=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:t<e?t:e},ur:{x:this.rightSE.point.x,y:t>e?t:e}}}vector(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}isAnEndpoint(t){return t.x===this.leftSE.point.x&&t.y===this.leftSE.point.y||t.x===this.rightSE.point.x&&t.y===this.rightSE.point.y}comparePoint(t){if(this.isAnEndpoint(t))return 0;const e=this.leftSE.point,n=this.rightSE.point,r=this.vector();if(e.x===n.x)return t.x===e.x?0:t.x<e.x?1:-1;const i=(t.y-e.y)/r.y,o=e.x+i*r.x;if(t.x===o)return 0;const s=(t.x-e.x)/r.x,a=e.y+s*r.y;return t.y===a?0:t.y<a?-1:1}getIntersection(t){const e=this.bbox(),n=t.bbox(),r=f(e,n);if(null===r)return null;const i=this.leftSE.point,o=this.rightSE.point,s=t.leftSE.point,a=t.rightSE.point,l=d(e,s)&&0===this.comparePoint(s),u=d(n,i)&&0===t.comparePoint(i),c=d(e,a)&&0===this.comparePoint(a),h=d(n,o)&&0===t.comparePoint(o);if(u&&l)return h&&!c?o:!h&&c?a:null;if(u)return c&&i.x===a.x&&i.y===a.y?null:i;if(l)return h&&o.x===s.x&&o.y===s.y?null:s;if(h&&c)return null;if(h)return o;if(c)return a;const p=((t,e,n,r)=>{if(0===e.x)return j(n,r,t.x);if(0===r.x)return j(t,e,n.x);if(0===e.y)return N(n,r,t.y);if(0===r.y)return N(t,e,n.y);const i=R(e,r);if(0==i)return null;const o={x:n.x-t.x,y:n.y-t.y},s=R(o,e)/i,a=R(o,r)/i;return{x:(t.x+a*e.x+(n.x+s*r.x))/2,y:(t.y+a*e.y+(n.y+s*r.y))/2}})(i,this.vector(),s,t.vector());return null===p?null:d(r,p)?v.round(p.x,p.y):null}split(t){const e=[],n=void 0!==t.events,r=new G(t,!0),i=new G(t,!1),o=this.rightSE;this.replaceRightSE(i),e.push(i),e.push(r);const s=new z(r,o,this.rings.slice(),this.windings.slice());return G.comparePoints(s.leftSE.point,s.rightSE.point)>0&&s.swapEvents(),G.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),n&&(r.checkForConsuming(),i.checkForConsuming()),e}swapEvents(){const t=this.rightSE;this.rightSE=this.leftSE,this.leftSE=t,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(let t=0,e=this.windings.length;t<e;t++)this.windings[t]*=-1}consume(t){let e=this,n=t;for(;e.consumedBy;)e=e.consumedBy;for(;n.consumedBy;)n=n.consumedBy;const r=z.compare(e,n);if(0!==r){if(r>0){const t=e;e=n,n=t}if(e.prev===n){const t=e;e=n,n=t}for(let t=0,r=n.rings.length;t<r;t++){const r=n.rings[t],i=n.windings[t],o=e.rings.indexOf(r);-1===o?(e.rings.push(r),e.windings.push(i)):e.windings[o]+=i}n.rings=null,n.windings=null,n.consumedBy=e,n.leftSE.consumedBy=e.leftSE,n.rightSE.consumedBy=e.rightSE}}prevInResult(){return void 0!==this._prevInResult||(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null),this._prevInResult}beforeState(){if(void 0!==this._beforeState)return this._beforeState;if(this.prev){const t=this.prev.consumedBy||this.prev;this._beforeState=t.afterState()}else this._beforeState={rings:[],windings:[],multiPolys:[]};return this._beforeState}afterState(){if(void 0!==this._afterState)return this._afterState;const t=this.beforeState();this._afterState={rings:t.rings.slice(0),windings:t.windings.slice(0),multiPolys:[]};const e=this._afterState.rings,n=this._afterState.windings,r=this._afterState.multiPolys;for(let t=0,r=this.rings.length;t<r;t++){const r=this.rings[t],i=this.windings[t],o=e.indexOf(r);-1===o?(e.push(r),n.push(i)):n[o]+=i}const i=[],o=[];for(let t=0,r=e.length;t<r;t++){if(0===n[t])continue;const r=e[t],s=r.poly;if(-1===o.indexOf(s))if(r.isExterior)i.push(s);else{-1===o.indexOf(s)&&o.push(s);const t=i.indexOf(r.poly);-1!==t&&i.splice(t,1)}}for(let t=0,e=i.length;t<e;t++){const e=i[t].multiPoly;-1===r.indexOf(e)&&r.push(e)}return this._afterState}isInResult(){if(this.consumedBy)return!1;if(void 0!==this._isInResult)return this._isInResult;const t=this.beforeState().multiPolys,e=this.afterState().multiPolys;switch(Q.type){case"union":{const n=0===t.length,r=0===e.length;this._isInResult=n!==r;break}case"intersection":{let n,r;t.length<e.length?(n=t.length,r=e.length):(n=e.length,r=t.length),this._isInResult=r===Q.numMultiPolys&&n<r;break}case"xor":{const n=Math.abs(t.length-e.length);this._isInResult=n%2==1;break}case"difference":{const n=t=>1===t.length&&t[0].isSubject;this._isInResult=n(t)!==n(e);break}default:throw new Error(`Unrecognized operation type found ${Q.type}`)}return this._isInResult}}class V{constructor(t,e,n){if(!Array.isArray(t)||0===t.length)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=e,this.isExterior=n,this.segments=[],"number"!=typeof t[0][0]||"number"!=typeof t[0][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const r=v.round(t[0][0],t[0][1]);this.bbox={ll:{x:r.x,y:r.y},ur:{x:r.x,y:r.y}};let i=r;for(let e=1,n=t.length;e<n;e++){if("number"!=typeof t[e][0]||"number"!=typeof t[e][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");let n=v.round(t[e][0],t[e][1]);n.x===i.x&&n.y===i.y||(this.segments.push(z.fromRing(i,n,this)),n.x<this.bbox.ll.x&&(this.bbox.ll.x=n.x),n.y<this.bbox.ll.y&&(this.bbox.ll.y=n.y),n.x>this.bbox.ur.x&&(this.bbox.ur.x=n.x),n.y>this.bbox.ur.y&&(this.bbox.ur.y=n.y),i=n)}r.x===i.x&&r.y===i.y||this.segments.push(z.fromRing(i,r,this))}getSweepEvents(){const t=[];for(let e=0,n=this.segments.length;e<n;e++){const n=this.segments[e];t.push(n.leftSE),t.push(n.rightSE)}return t}}class H{constructor(t,e){if(!Array.isArray(t))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new V(t[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(let e=1,n=t.length;e<n;e++){const n=new V(t[e],this,!1);n.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=n.bbox.ll.x),n.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=n.bbox.ll.y),n.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=n.bbox.ur.x),n.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=n.bbox.ur.y),this.interiorRings.push(n)}this.multiPoly=e}getSweepEvents(){const t=this.exteriorRing.getSweepEvents();for(let e=0,n=this.interiorRings.length;e<n;e++){const n=this.interiorRings[e].getSweepEvents();for(let e=0,r=n.length;e<r;e++)t.push(n[e])}return t}}class q{constructor(t,e){if(!Array.isArray(t))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{"number"==typeof t[0][0][0]&&(t=[t])}catch(t){}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(let e=0,n=t.length;e<n;e++){const n=new H(t[e],this);n.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=n.bbox.ll.x),n.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=n.bbox.ll.y),n.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=n.bbox.ur.x),n.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=n.bbox.ur.y),this.polys.push(n)}this.isSubject=e}getSweepEvents(){const t=[];for(let e=0,n=this.polys.length;e<n;e++){const n=this.polys[e].getSweepEvents();for(let e=0,r=n.length;e<r;e++)t.push(n[e])}return t}}class W{static factory(t){const e=[];for(let n=0,r=t.length;n<r;n++){const r=t[n];if(!r.isInResult()||r.ringOut)continue;let i=null,o=r.leftSE,s=r.rightSE;const a=[o],l=o.point,u=[];for(;i=o,o=s,a.push(o),o.point!==l;)for(;;){const t=o.getAvailableLinkedEvents();if(0===t.length){const t=a[0].point,e=a[a.length-1].point;throw new Error(`Unable to complete output ring starting at [${t.x}, ${t.y}]. Last matching segment found ends at [${e.x}, ${e.y}].`)}if(1===t.length){s=t[0].otherSE;break}let n=null;for(let t=0,e=u.length;t<e;t++)if(u[t].point===o.point){n=t;break}if(null!==n){const t=u.splice(n)[0],r=a.splice(t.index);r.unshift(r[0].otherSE),e.push(new W(r.reverse()));continue}u.push({index:a.length,point:o.point});const r=o.getLeftmostComparator(i);s=t.sort(r)[0].otherSE;break}e.push(new W(a))}return e}constructor(t){this.events=t;for(let e=0,n=t.length;e<n;e++)t[e].segment.ringOut=this;this.poly=null}getGeom(){let t=this.events[0].point;const e=[t];for(let n=1,r=this.events.length-1;n<r;n++){const r=this.events[n].point,i=this.events[n+1].point;0!==L(r,t,i)&&(e.push(r),t=r)}if(1===e.length)return null;const n=e[0],r=e[1];0===L(n,t,r)&&e.shift(),e.push(e[0]);const i=this.isExteriorRing()?1:-1,o=this.isExteriorRing()?0:e.length-1,s=this.isExteriorRing()?e.length:-1,a=[];for(let t=o;t!=s;t+=i)a.push([e[t].x,e[t].y]);return a}isExteriorRing(){if(void 0===this._isExteriorRing){const t=this.enclosingRing();this._isExteriorRing=!t||!t.isExteriorRing()}return this._isExteriorRing}enclosingRing(){return void 0===this._enclosingRing&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}_calcEnclosingRing(){let t=this.events[0];for(let e=1,n=this.events.length;e<n;e++){const n=this.events[e];G.compare(t,n)>0&&(t=n)}let e=t.segment.prevInResult(),n=e?e.prevInResult():null;for(;;){if(!e)return null;if(!n)return e.ringOut;if(n.ringOut!==e.ringOut)return n.ringOut.enclosingRing()!==e.ringOut?e.ringOut:e.ringOut.enclosingRing();e=n.prevInResult(),n=e?e.prevInResult():null}}}class J{constructor(t){this.exteriorRing=t,t.poly=this,this.interiorRings=[]}addInterior(t){this.interiorRings.push(t),t.poly=this}getGeom(){const t=[this.exteriorRing.getGeom()];if(null===t[0])return null;for(let e=0,n=this.interiorRings.length;e<n;e++){const n=this.interiorRings[e].getGeom();null!==n&&t.push(n)}return t}}class Y{constructor(t){this.rings=t,this.polys=this._composePolys(t)}getGeom(){const t=[];for(let e=0,n=this.polys.length;e<n;e++){const n=this.polys[e].getGeom();null!==n&&t.push(n)}return t}_composePolys(t){const e=[];for(let n=0,r=t.length;n<r;n++){const r=t[n];if(!r.poly)if(r.isExteriorRing())e.push(new J(r));else{const t=r.enclosingRing();t.poly||e.push(new J(t)),t.poly.addInterior(r)}}return e}}class X{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:z.compare;this.queue=t,this.tree=new l(e),this.segments=[]}process(t){const e=t.segment,n=[];if(t.consumedBy)return t.isLeft?this.queue.remove(t.otherSE):this.tree.remove(e),n;const r=t.isLeft?this.tree.add(e):this.tree.find(e);if(!r)throw new Error(`Unable to find segment #${e.id} [${e.leftSE.point.x}, ${e.leftSE.point.y}] -> [${e.rightSE.point.x}, ${e.rightSE.point.y}] in SweepLine tree.`);let i,o,s=r,a=r;for(;void 0===i;)s=this.tree.prev(s),null===s?i=null:void 0===s.key.consumedBy&&(i=s.key);for(;void 0===o;)a=this.tree.next(a),null===a?o=null:void 0===a.key.consumedBy&&(o=a.key);if(t.isLeft){let r=null;if(i){const t=i.getIntersection(e);if(null!==t&&(e.isAnEndpoint(t)||(r=t),!i.isAnEndpoint(t))){const e=this._splitSafely(i,t);for(let t=0,r=e.length;t<r;t++)n.push(e[t])}}let s=null;if(o){const t=o.getIntersection(e);if(null!==t&&(e.isAnEndpoint(t)||(s=t),!o.isAnEndpoint(t))){const e=this._splitSafely(o,t);for(let t=0,r=e.length;t<r;t++)n.push(e[t])}}if(null!==r||null!==s){let t=null;t=null===r?s:null===s||G.comparePoints(r,s)<=0?r:s,this.queue.remove(e.rightSE),n.push(e.rightSE);const i=e.split(t);for(let t=0,e=i.length;t<e;t++)n.push(i[t])}n.length>0?(this.tree.remove(e),n.push(t)):(this.segments.push(e),e.prev=i)}else{if(i&&o){const t=i.getIntersection(o);if(null!==t){if(!i.isAnEndpoint(t)){const e=this._splitSafely(i,t);for(let t=0,r=e.length;t<r;t++)n.push(e[t])}if(!o.isAnEndpoint(t)){const e=this._splitSafely(o,t);for(let t=0,r=e.length;t<r;t++)n.push(e[t])}}}this.tree.remove(e)}return n}_splitSafely(t,e){this.tree.remove(t);const n=t.rightSE;this.queue.remove(n);const r=t.split(e);return r.push(n),void 0===t.consumedBy&&this.tree.add(t),r}}const K=void 0!==r&&r.env.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,Z=void 0!==r&&r.env.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6;const Q=new class{run(t,e,n){Q.type=t,v.reset();const r=[new q(e,!0)];for(let t=0,e=n.length;t<e;t++)r.push(new q(n[t],!1));if(Q.numMultiPolys=r.length,"difference"===Q.type){const t=r[0];let e=1;for(;e<r.length;)null!==f(r[e].bbox,t.bbox)?e++:r.splice(e,1)}if("intersection"===Q.type)for(let t=0,e=r.length;t<e;t++){const e=r[t];for(let n=t+1,i=r.length;n<i;n++)if(null===f(e.bbox,r[n].bbox))return[]}const i=new l(G.compare);for(let t=0,e=r.length;t<e;t++){const e=r[t].getSweepEvents();for(let t=0,n=e.length;t<n;t++)if(i.insert(e[t]),i.size>K)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big).")}const o=new X(i);let s=i.size,a=i.pop();for(;a;){const t=a.key;if(i.size===s){const e=t.segment;throw new Error(`Unable to pop() ${t.isLeft?"left":"right"} SweepEvent [${t.point.x}, ${t.point.y}] from segment #${e.id} [${e.leftSE.point.x}, ${e.leftSE.point.y}] -> [${e.rightSE.point.x}, ${e.rightSE.point.y}] from queue.`)}if(i.size>K)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big).");if(o.segments.length>Z)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments).");const e=o.process(t);for(let t=0,n=e.length;t<n;t++){const n=e[t];void 0===n.consumedBy&&i.insert(n)}s=i.size,a=i.pop()}v.reset();const u=W.factory(o.segments);return new Y(u).getGeom()}};return{union:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return Q.run("union",t,n)},intersection:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return Q.run("intersection",t,n)},xor:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return Q.run("xor",t,n)},difference:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return Q.run("difference",t,n)}}}()},2694:(t,e,n)=>{"use strict";var r=n(6925);function i(){}function o(){}o.resetWarningCache=i,t.exports=function(){function t(t,e,n,i,o,s){if(s!==r){var a=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw a.name="Invariant Violation",a}}function e(){return t}t.isRequired=t;var n={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:o,resetWarningCache:i};return n.PropTypes=n,n}},5556:(t,e,n)=>{t.exports=n(2694)()},6925:t=>{"use strict";t.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},38909:(t,e,n)=>{"use strict";n.r(e),n.d(e,{createSelector:()=>a,createSelectorCreator:()=>s,createStructuredSelector:()=>l,defaultEqualityCheck:()=>i,defaultMemoize:()=>o});var r="NOT_FOUND",i=function(t,e){return t===e};function o(t,e){var n,o,s="object"==typeof e?e:{equalityCheck:e},a=s.equalityCheck,l=void 0===a?i:a,u=s.maxSize,c=void 0===u?1:u,h=s.resultEqualityCheck,d=function(t){return function(e,n){if(null===e||null===n||e.length!==n.length)return!1;for(var r=e.length,i=0;i<r;i++)if(!t(e[i],n[i]))return!1;return!0}}(l),f=1===c?(n=d,{get:function(t){return o&&n(o.key,t)?o.value:r},put:function(t,e){o={key:t,value:e}},getEntries:function(){return o?[o]:[]},clear:function(){o=void 0}}):function(t,e){var n=[];function i(t){var i=n.findIndex((function(n){return e(t,n.key)}));if(i>-1){var o=n[i];return i>0&&(n.splice(i,1),n.unshift(o)),o.value}return r}return{get:i,put:function(e,o){i(e)===r&&(n.unshift({key:e,value:o}),n.length>t&&n.pop())},getEntries:function(){return n},clear:function(){n=[]}}}(c,d);function p(){var e=f.get(arguments);if(e===r){if(e=t.apply(null,arguments),h){var n=f.getEntries().find((function(t){return h(t.value,e)}));n&&(e=n.value)}f.put(arguments,e)}return e}return p.clearCache=function(){return f.clear()},p}function s(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return function(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];var o,s=0,a={memoizeOptions:void 0},l=r.pop();if("object"==typeof l&&(a=l,l=r.pop()),"function"!=typeof l)throw new Error("createSelector expects an output function after the inputs, but received: ["+typeof l+"]");var u=a.memoizeOptions,c=void 0===u?n:u,h=Array.isArray(c)?c:[c],d=function(t){var e=Array.isArray(t[0])?t[0]:t;if(!e.every((function(t){return"function"==typeof t}))){var n=e.map((function(t){return"function"==typeof t?"function "+(t.name||"unnamed")+"()":typeof t})).join(", ");throw new Error("createSelector expects all input-selectors to be functions, but received the following types: ["+n+"]")}return e}(r),f=t.apply(void 0,[function(){return s++,l.apply(null,arguments)}].concat(h)),p=t((function(){for(var t=[],e=d.length,n=0;n<e;n++)t.push(d[n].apply(null,arguments));return o=f.apply(null,t)}));return Object.assign(p,{resultFunc:l,memoizedResultFunc:f,dependencies:d,lastResult:function(){return o},recomputations:function(){return s},resetRecomputations:function(){return s=0}}),p}}var a=s(o),l=function(t,e){if(void 0===e&&(e=a),"object"!=typeof t)throw new Error("createStructuredSelector expects first argument to be an object where each property is a selector, instead received a "+typeof t);var n=Object.keys(t),r=e(n.map((function(e){return t[e]})),(function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return e.reduce((function(t,e,r){return t[n[r]]=e,t}),{})}));return r}},96309:(t,e,n)=>{!function(t){"use strict";var e=t.S2={L:{}};e.L.LatLng=function(t,e,n){var r=parseFloat(t,10),i=parseFloat(e,10);if(isNaN(r)||isNaN(i))throw new Error("Invalid LatLng object: ("+t+", "+e+")");return!0!==n&&(r=Math.max(Math.min(r,90),-90),i=(i+180)%360+(i<-180||180===i?180:-180)),{lat:r,lng:i}},e.L.LatLng.DEG_TO_RAD=Math.PI/180,e.L.LatLng.RAD_TO_DEG=180/Math.PI,e.LatLngToXYZ=function(t){var n=e.L.LatLng.DEG_TO_RAD,r=t.lat*n,i=t.lng*n,o=Math.cos(r);return[Math.cos(i)*o,Math.sin(i)*o,Math.sin(r)]},e.XYZToLatLng=function(t){var n=e.L.LatLng.RAD_TO_DEG,r=Math.atan2(t[2],Math.sqrt(t[0]*t[0]+t[1]*t[1])),i=Math.atan2(t[1],t[0]);return e.L.LatLng(r*n,i*n)},e.XYZToFaceUV=function(t){var e=function(t){var e=[Math.abs(t[0]),Math.abs(t[1]),Math.abs(t[2])];return e[0]>e[1]?e[0]>e[2]?0:2:e[1]>e[2]?1:2}(t);t[e]<0&&(e+=3);var n=function(t,e){var n,r;switch(t){case 0:n=e[1]/e[0],r=e[2]/e[0];break;case 1:n=-e[0]/e[1],r=e[2]/e[1];break;case 2:n=-e[0]/e[2],r=-e[1]/e[2];break;case 3:n=e[2]/e[0],r=e[1]/e[0];break;case 4:n=e[2]/e[1],r=-e[0]/e[1];break;case 5:n=-e[1]/e[2],r=-e[0]/e[2];break;default:throw{error:"Invalid face"}}return[n,r]}(e,t);return[e,n]},e.FaceUVToXYZ=function(t,e){var n=e[0],r=e[1];switch(t){case 0:return[1,n,r];case 1:return[-n,1,r];case 2:return[-n,-r,1];case 3:return[-1,-r,-n];case 4:return[r,-1,-n];case 5:return[r,n,-1];default:throw{error:"Invalid face"}}};var r=function(t){return t>=.5?1/3*(4*t*t-1):1/3*(1-4*(1-t)*(1-t))};e.STToUV=function(t){return[r(t[0]),r(t[1])]};var i=function(t){return t>=0?.5*Math.sqrt(1+3*t):1-.5*Math.sqrt(1-3*t)};e.UVToST=function(t){return[i(t[0]),i(t[1])]},e.STToIJ=function(t,e){var n=1<<e,r=function(t){var e=Math.floor(t*n);return Math.max(0,Math.min(n-1,e))};return[r(t[0]),r(t[1])]},e.IJToST=function(t,e,n){var r=1<<e;return[(t[0]+n[0])/r,(t[1]+n[1])/r]};var o=function(t,e,n,r){if(0==r){1==n&&(e.x=t-1-e.x,e.y=t-1-e.y);var i=e.x;e.x=e.y,e.y=i}},s=function(t,e,n,r){var i={a:[[0,"d"],[1,"a"],[3,"b"],[2,"a"]],b:[[2,"b"],[1,"b"],[3,"a"],[0,"c"]],c:[[2,"c"],[3,"d"],[1,"c"],[0,"b"]],d:[[0,"a"],[3,"c"],[1,"d"],[2,"d"]]};"number"!=typeof r&&console.warn(new Error("called pointToHilbertQuadList without face value, defaulting to '0'").stack);for(var o=r%2?"d":"a",s=[],a=n-1;a>=0;a--){var l=1<<a,u=i[o][2*(t&l?1:0)+(e&l?1:0)];s.push(u[0]),o=u[1]}return s};e.S2Cell=function(){},e.S2Cell.FromHilbertQuadKey=function(t){var n,r,i,s,a,l,u=t.split("/"),c=parseInt(u[0]),h=u[1],d=h.length,f={x:0,y:0};for(n=d-1;n>=0;n--)r=d-n,s=0,a=0,"1"===(i=h[n])?a=1:"2"===i?(s=1,a=1):"3"===i&&(s=1),l=Math.pow(2,r-1),o(l,f,s,a),f.x+=l*s,f.y+=l*a;if(c%2==1){var p=f.x;f.x=f.y,f.y=p}return e.S2Cell.FromFaceIJ(parseInt(c),[f.x,f.y],r)},e.S2Cell.FromLatLng=function(t,n){if(!t.lat&&0!==t.lat||!t.lng&&0!==t.lng)throw new Error("Pass { lat: lat, lng: lng } to S2.S2Cell.FromLatLng");var r=e.LatLngToXYZ(t),i=e.XYZToFaceUV(r),o=e.UVToST(i[1]),s=e.STToIJ(o,n);return e.S2Cell.FromFaceIJ(i[0],s,n)},e.S2Cell.FromFaceIJ=function(t,n,r){var i=new e.S2Cell;return i.face=t,i.ij=n,i.level=r,i},e.S2Cell.prototype.toString=function(){return"F"+this.face+"ij["+this.ij[0]+","+this.ij[1]+"]@"+this.level},e.S2Cell.prototype.getLatLng=function(){var t=e.IJToST(this.ij,this.level,[.5,.5]),n=e.STToUV(t),r=e.FaceUVToXYZ(this.face,n);return e.XYZToLatLng(r)},e.S2Cell.prototype.getCornerLatLngs=function(){for(var t=[],n=[[0,0],[0,1],[1,1],[1,0]],r=0;r<4;r++){var i=e.IJToST(this.ij,this.level,n[r]),o=e.STToUV(i),s=e.FaceUVToXYZ(this.face,o);t.push(e.XYZToLatLng(s))}return t},e.S2Cell.prototype.getFaceAndQuads=function(){var t=s(this.ij[0],this.ij[1],this.level,this.face);return[this.face,t]},e.S2Cell.prototype.toHilbertQuadkey=function(){var t=s(this.ij[0],this.ij[1],this.level,this.face);return this.face.toString(10)+"/"+t.join("")},e.latLngToNeighborKeys=e.S2Cell.latLngToNeighborKeys=function(t,n,r){return e.S2Cell.FromLatLng({lat:t,lng:n},r).getNeighbors().map((function(t){return t.toHilbertQuadkey()}))},e.S2Cell.prototype.getNeighbors=function(){var t=function(t,n,r){var i=1<<r;if(n[0]>=0&&n[1]>=0&&n[0]<i&&n[1]<i)return e.S2Cell.FromFaceIJ(t,n,r);var o=e.IJToST(n,r,[.5,.5]),s=e.STToUV(o),a=e.FaceUVToXYZ(t,s),l=e.XYZToFaceUV(a);return t=l[0],s=l[1],o=e.UVToST(s),n=e.STToIJ(o,r),e.S2Cell.FromFaceIJ(t,n,r)},n=this.face,r=this.ij[0],i=this.ij[1],o=this.level;return[t(n,[r-1,i],o),t(n,[r,i-1],o),t(n,[r+1,i],o),t(n,[r,i+1],o)]},e.FACE_BITS=3,e.MAX_LEVEL=30,e.POS_BITS=2*e.MAX_LEVEL+1,e.facePosLevelToId=e.S2Cell.facePosLevelToId=e.fromFacePosLevel=function(r,i,o){var s,a,l,u=t.dcodeIO&&t.dcodeIO.Long||n(60004);for(o||(o=i.length),i.length>o&&(i=i.substr(0,o)),s=u.fromString(r.toString(10),!0,10).toString(2);s.length<e.FACE_BITS;)s="0"+s;for(a=u.fromString(i,!0,4).toString(2);a.length<2*o;)a="0"+a;for(l=s+a,l+="1";l.length<e.FACE_BITS+e.POS_BITS;)l+="0";return u.fromString(l,!0,2).toString(10)},e.keyToId=e.S2Cell.keyToId=e.toId=e.toCellId=e.fromKey=function(t){var n=t.split("/");return e.fromFacePosLevel(n[0],n[1],n[1].length)},e.idToKey=e.S2Cell.idToKey=e.S2Cell.toKey=e.toKey=e.fromId=e.fromCellId=e.S2Cell.toHilbertQuadkey=e.toHilbertQuadkey=function(r){for(var i=t.dcodeIO&&t.dcodeIO.Long||n(60004),o=i.fromString(r,!0,10).toString(2);o.length<e.FACE_BITS+e.POS_BITS;)o="0"+o;for(var s=o.lastIndexOf("1"),a=o.substring(0,3),l=o.substring(3,s),u=l.length/2,c=i.fromString(a,!0,2).toString(10),h=i.fromString(l,!0,2).toString(4);h.length<u;)h="0"+h;return c+"/"+h},e.keyToLatLng=e.S2Cell.keyToLatLng=function(t){return e.S2Cell.FromHilbertQuadKey(t).getLatLng()},e.idToLatLng=e.S2Cell.idToLatLng=function(t){var n=e.idToKey(t);return e.keyToLatLng(n)},e.S2Cell.latLngToKey=e.latLngToKey=e.latLngToQuadkey=function(t,n,r){if(isNaN(r)||r<1||r>30)throw new Error("'level' is not a number between 1 and 30 (but it should be)");return e.S2Cell.FromLatLng({lat:t,lng:n},r).toHilbertQuadkey()},e.stepKey=function(e,r){var i,o=t.dcodeIO&&t.dcodeIO.Long||n(60004),s=e.split("/"),a=s[0],l=s[1],u=s[1].length,c=o.fromString(l,!0,4);r>0?i=c.add(Math.abs(r)):r<0&&(i=c.subtract(Math.abs(r)));var h=i.toString(4);for("0"===h&&console.warning(new Error("face/position wrapping is not yet supported"));h.length<u;)h="0"+h;return a+"/"+h},e.S2Cell.prevKey=e.prevKey=function(t){return e.stepKey(t,-1)},e.S2Cell.nextKey=e.nextKey=function(t){return e.stepKey(t,1)}}(t.exports)},17983:t=>{const e=/^[-+]?0x[a-fA-F0-9]+$/,n=/^([\-\+])?(0*)(\.[0-9]+([eE]\-?[0-9]+)?|[0-9]+(\.[0-9]+([eE]\-?[0-9]+)?)?)$/;!Number.parseInt&&window.parseInt&&(Number.parseInt=window.parseInt),!Number.parseFloat&&window.parseFloat&&(Number.parseFloat=window.parseFloat);const r={hex:!0,leadingZeros:!0,decimalPoint:".",eNotation:!0};t.exports=function(t,i={}){if(i=Object.assign({},r,i),!t||"string"!=typeof t)return t;let o=t.trim();if(void 0!==i.skipLike&&i.skipLike.test(o))return t;if(i.hex&&e.test(o))return Number.parseInt(o,16);{const e=n.exec(o);if(e){const n=e[1],r=e[2];let a=(s=e[3])&&-1!==s.indexOf(".")?("."===(s=s.replace(/0+$/,""))?s="0":"."===s[0]?s="0"+s:"."===s[s.length-1]&&(s=s.substr(0,s.length-1)),s):s;const l=e[4]||e[6];if(!i.leadingZeros&&r.length>0&&n&&"."!==o[2])return t;if(!i.leadingZeros&&r.length>0&&!n&&"."!==o[1])return t;{const e=Number(o),s=""+e;return-1!==s.search(/[eE]/)||l?i.eNotation?e:t:-1!==o.indexOf(".")?"0"===s&&""===a||s===a||n&&s==="-"+a?e:t:r?a===s||n+a===s?e:t:o===s||o===n+s?e:t}}return t}var s}},59138:(t,e,n)=>{"use strict";function r(t,e,n,o,s,a){if(s-o<=n)return;const l=o+s>>1;i(t,e,l,o,s,a%2),r(t,e,n,o,l-1,a+1),r(t,e,n,l+1,s,a+1)}function i(t,e,n,r,s,a){for(;s>r;){if(s-r>600){const o=s-r+1,l=n-r+1,u=Math.log(o),c=.5*Math.exp(2*u/3),h=.5*Math.sqrt(u*c*(o-c)/o)*(l-o/2<0?-1:1);i(t,e,n,Math.max(r,Math.floor(n-l*c/o+h)),Math.min(s,Math.floor(n+(o-l)*c/o+h)),a)}const l=e[2*n+a];let u=r,c=s;for(o(t,e,r,n),e[2*s+a]>l&&o(t,e,r,s);u<c;){for(o(t,e,u,c),u++,c--;e[2*u+a]<l;)u++;for(;e[2*c+a]>l;)c--}e[2*r+a]===l?o(t,e,r,c):(c++,o(t,e,c,s)),c<=n&&(r=c+1),n<=c&&(s=c-1)}}function o(t,e,n,r){s(t,n,r),s(e,2*n,2*r),s(e,2*n+1,2*r+1)}function s(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function a(t,e,n,r){const i=t-n,o=e-r;return i*i+o*o}n.r(e),n.d(e,{default:()=>p});const l=t=>t[0],u=t=>t[1];class c{constructor(t,e=l,n=u,i=64,o=Float64Array){this.nodeSize=i,this.points=t;const s=t.length<65536?Uint16Array:Uint32Array,a=this.ids=new s(t.length),c=this.coords=new o(2*t.length);for(let r=0;r<t.length;r++)a[r]=r,c[2*r]=e(t[r]),c[2*r+1]=n(t[r]);r(a,c,i,0,a.length-1,0)}range(t,e,n,r){return function(t,e,n,r,i,o,s){const a=[0,t.length-1,0],l=[];let u,c;for(;a.length;){const h=a.pop(),d=a.pop(),f=a.pop();if(d-f<=s){for(let s=f;s<=d;s++)u=e[2*s],c=e[2*s+1],u>=n&&u<=i&&c>=r&&c<=o&&l.push(t[s]);continue}const p=Math.floor((f+d)/2);u=e[2*p],c=e[2*p+1],u>=n&&u<=i&&c>=r&&c<=o&&l.push(t[p]);const g=(h+1)%2;(0===h?n<=u:r<=c)&&(a.push(f),a.push(p-1),a.push(g)),(0===h?i>=u:o>=c)&&(a.push(p+1),a.push(d),a.push(g))}return l}(this.ids,this.coords,t,e,n,r,this.nodeSize)}within(t,e,n){return function(t,e,n,r,i,o){const s=[0,t.length-1,0],l=[],u=i*i;for(;s.length;){const c=s.pop(),h=s.pop(),d=s.pop();if(h-d<=o){for(let i=d;i<=h;i++)a(e[2*i],e[2*i+1],n,r)<=u&&l.push(t[i]);continue}const f=Math.floor((d+h)/2),p=e[2*f],g=e[2*f+1];a(p,g,n,r)<=u&&l.push(t[f]);const y=(c+1)%2;(0===c?n-i<=p:r-i<=g)&&(s.push(d),s.push(f-1),s.push(y)),(0===c?n+i>=p:r+i>=g)&&(s.push(f+1),s.push(h),s.push(y))}return l}(this.ids,this.coords,t,e,n,this.nodeSize)}}const h={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:t=>t},d=Math.fround||(f=new Float32Array(1),t=>(f[0]=+t,f[0]));var f;class p{constructor(t){this.options=x(Object.create(h),t),this.trees=new Array(this.options.maxZoom+1)}load(t){const{log:e,minZoom:n,maxZoom:r,nodeSize:i}=this.options;e&&console.time("total time");const o=`prepare ${t.length} points`;e&&console.time(o),this.points=t;let s=[];for(let e=0;e<t.length;e++)t[e].geometry&&s.push(y(t[e],e));this.trees[r+1]=new c(s,w,C,i,Float32Array),e&&console.timeEnd(o);for(let t=r;t>=n;t--){const n=+Date.now();s=this._cluster(s,t),this.trees[t]=new c(s,w,C,i,Float32Array),e&&console.log("z%d: %d clusters in %dms",t,s.length,+Date.now()-n)}return e&&console.timeEnd("total time"),this}getClusters(t,e){let n=((t[0]+180)%360+360)%360-180;const r=Math.max(-90,Math.min(90,t[1]));let i=180===t[2]?180:((t[2]+180)%360+360)%360-180;const o=Math.max(-90,Math.min(90,t[3]));if(t[2]-t[0]>=360)n=-180,i=180;else if(n>i){const t=this.getClusters([n,r,180,o],e),s=this.getClusters([-180,r,i,o],e);return t.concat(s)}const s=this.trees[this._limitZoom(e)],a=s.range(b(n),_(o),b(i),_(r)),l=[];for(const t of a){const e=s.points[t];l.push(e.numPoints?m(e):this.points[e.index])}return l}getChildren(t){const e=this._getOriginId(t),n=this._getOriginZoom(t),r="No cluster with the specified id.",i=this.trees[n];if(!i)throw new Error(r);const o=i.points[e];if(!o)throw new Error(r);const s=this.options.radius/(this.options.extent*Math.pow(2,n-1)),a=i.within(o.x,o.y,s),l=[];for(const e of a){const n=i.points[e];n.parentId===t&&l.push(n.numPoints?m(n):this.points[n.index])}if(0===l.length)throw new Error(r);return l}getLeaves(t,e,n){e=e||10,n=n||0;const r=[];return this._appendLeaves(r,t,e,n,0),r}getTile(t,e,n){const r=this.trees[this._limitZoom(t)],i=Math.pow(2,t),{extent:o,radius:s}=this.options,a=s/o,l=(n-a)/i,u=(n+1+a)/i,c={features:[]};return this._addTileFeatures(r.range((e-a)/i,l,(e+1+a)/i,u),r.points,e,n,i,c),0===e&&this._addTileFeatures(r.range(1-a/i,l,1,u),r.points,i,n,i,c),e===i-1&&this._addTileFeatures(r.range(0,l,a/i,u),r.points,-1,n,i,c),c.features.length?c:null}getClusterExpansionZoom(t){let e=this._getOriginZoom(t)-1;for(;e<=this.options.maxZoom;){const n=this.getChildren(t);if(e++,1!==n.length)break;t=n[0].properties.cluster_id}return e}_appendLeaves(t,e,n,r,i){const o=this.getChildren(e);for(const e of o){const o=e.properties;if(o&&o.cluster?i+o.point_count<=r?i+=o.point_count:i=this._appendLeaves(t,o.cluster_id,n,r,i):i<r?i++:t.push(e),t.length===n)break}return i}_addTileFeatures(t,e,n,r,i,o){for(const s of t){const t=e[s],a=t.numPoints;let l,u,c;if(a)l=v(t),u=t.x,c=t.y;else{const e=this.points[t.index];l=e.properties,u=b(e.geometry.coordinates[0]),c=_(e.geometry.coordinates[1])}const h={type:1,geometry:[[Math.round(this.options.extent*(u*i-n)),Math.round(this.options.extent*(c*i-r))]],tags:l};let d;a?d=t.id:this.options.generateId?d=t.index:this.points[t.index].id&&(d=this.points[t.index].id),void 0!==d&&(h.id=d),o.features.push(h)}}_limitZoom(t){return Math.max(this.options.minZoom,Math.min(Math.floor(+t),this.options.maxZoom+1))}_cluster(t,e){const n=[],{radius:r,extent:i,reduce:o,minPoints:s}=this.options,a=r/(i*Math.pow(2,e));for(let r=0;r<t.length;r++){const i=t[r];if(i.zoom<=e)continue;i.zoom=e;const l=this.trees[e+1],u=l.within(i.x,i.y,a),c=i.numPoints||1;let h=c;for(const t of u){const n=l.points[t];n.zoom>e&&(h+=n.numPoints||1)}if(h>c&&h>=s){let t=i.x*c,s=i.y*c,a=o&&c>1?this._map(i,!0):null;const d=(r<<5)+(e+1)+this.points.length;for(const n of u){const r=l.points[n];if(r.zoom<=e)continue;r.zoom=e;const u=r.numPoints||1;t+=r.x*u,s+=r.y*u,r.parentId=d,o&&(a||(a=this._map(i,!0)),o(a,this._map(r)))}i.parentId=d,n.push(g(t/h,s/h,d,h,a))}else if(n.push(i),h>1)for(const t of u){const r=l.points[t];r.zoom<=e||(r.zoom=e,n.push(r))}}return n}_getOriginId(t){return t-this.points.length>>5}_getOriginZoom(t){return(t-this.points.length)%32}_map(t,e){if(t.numPoints)return e?x({},t.properties):t.properties;const n=this.points[t.index].properties,r=this.options.map(n);return e&&r===n?x({},r):r}}function g(t,e,n,r,i){return{x:d(t),y:d(e),zoom:1/0,id:n,parentId:-1,numPoints:r,properties:i}}function y(t,e){const[n,r]=t.geometry.coordinates;return{x:d(b(n)),y:d(_(r)),zoom:1/0,index:e,parentId:-1}}function m(t){return{type:"Feature",id:t.id,properties:v(t),geometry:{type:"Point",coordinates:[(e=t.x,360*(e-.5)),A(t.y)]}};var e}function v(t){const e=t.numPoints,n=e>=1e4?`${Math.round(e/1e3)}k`:e>=1e3?Math.round(e/100)/10+"k":e;return x(x({},t.properties),{cluster:!0,cluster_id:t.id,point_count:e,point_count_abbreviated:n})}function b(t){return t/360+.5}function _(t){const e=Math.sin(t*Math.PI/180),n=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return n<0?0:n>1?1:n}function A(t){const e=(180-360*t)*Math.PI/180;return 360*Math.atan(Math.exp(e))/Math.PI-90}function x(t,e){for(const n in e)t[n]=e[n];return t}function w(t){return t.x}function C(t){return t.y}},23494:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>p});class r{constructor(t=[],e=i){if(this.data=t,this.length=this.data.length,this.compare=e,this.length>0)for(let t=(this.length>>1)-1;t>=0;t--)this._down(t)}push(t){this.data.push(t),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const t=this.data[0],e=this.data.pop();return this.length--,this.length>0&&(this.data[0]=e,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:e,compare:n}=this,r=e[t];for(;t>0;){const i=t-1>>1,o=e[i];if(n(r,o)>=0)break;e[t]=o,t=i}e[t]=r}_down(t){const{data:e,compare:n}=this,r=this.length>>1,i=e[t];for(;t<r;){let r=1+(t<<1),o=e[r];const s=r+1;if(s<this.length&&n(e[s],o)<0&&(r=s,o=e[s]),n(o,i)>=0)break;e[t]=o,t=r}e[t]=i}}function i(t,e){return t<e?-1:t>e?1:0}function o(t,e){return t.p.x>e.p.x?1:t.p.x<e.p.x?-1:t.p.y!==e.p.y?t.p.y>e.p.y?1:-1:1}function s(t,e){return t.rightSweepEvent.p.x>e.rightSweepEvent.p.x?1:t.rightSweepEvent.p.x<e.rightSweepEvent.p.x?-1:t.rightSweepEvent.p.y!==e.rightSweepEvent.p.y?t.rightSweepEvent.p.y<e.rightSweepEvent.p.y?1:-1:1}class a{constructor(t,e,n,r){this.p={x:t[0],y:t[1]},this.featureId=e,this.ringId=n,this.eventId=r,this.otherEvent=null,this.isLeftEndpoint=null}isSamePoint(t){return this.p.x===t.p.x&&this.p.y===t.p.y}}let l=0,u=0,c=0;function h(t,e){const n="Feature"===t.type?t.geometry:t;let r=n.coordinates;"Polygon"!==n.type&&"MultiLineString"!==n.type||(r=[r]),"LineString"===n.type&&(r=[[r]]);for(let t=0;t<r.length;t++)for(let n=0;n<r[t].length;n++){let i=r[t][n][0],s=null;u+=1;for(let h=0;h<r[t][n].length-1;h++){s=r[t][n][h+1];const d=new a(i,l,u,c),f=new a(s,l,u,c+1);d.otherEvent=f,f.otherEvent=d,o(d,f)>0?(f.isLeftEndpoint=!0,d.isLeftEndpoint=!1):(d.isLeftEndpoint=!0,f.isLeftEndpoint=!1),e.push(d),e.push(f),i=s,c+=1}}l+=1}class d{constructor(t){this.leftSweepEvent=t,this.rightSweepEvent=t.otherEvent}}function f(t,e){if(null===t||null===e)return!1;if(t.leftSweepEvent.ringId===e.leftSweepEvent.ringId&&(t.rightSweepEvent.isSamePoint(e.leftSweepEvent)||t.rightSweepEvent.isSamePoint(e.leftSweepEvent)||t.rightSweepEvent.isSamePoint(e.rightSweepEvent)||t.leftSweepEvent.isSamePoint(e.leftSweepEvent)||t.leftSweepEvent.isSamePoint(e.rightSweepEvent)))return!1;const n=t.leftSweepEvent.p.x,r=t.leftSweepEvent.p.y,i=t.rightSweepEvent.p.x,o=t.rightSweepEvent.p.y,s=e.leftSweepEvent.p.x,a=e.leftSweepEvent.p.y,l=e.rightSweepEvent.p.x,u=e.rightSweepEvent.p.y,c=(u-a)*(i-n)-(l-s)*(o-r);if(0===c)return!1;const h=((l-s)*(r-a)-(u-a)*(n-s))/c,d=((i-n)*(r-a)-(o-r)*(n-s))/c;return h>=0&&h<=1&&d>=0&&d<=1&&[n+h*(i-n),r+h*(o-r)]}const p=function(t,e){const n=new r([],o);return function(t,e){if("FeatureCollection"===t.type){const n=t.features;for(let t=0;t<n.length;t++)h(n[t],e)}else h(t,e)}(t,n),function(t,e){e=e||!1;const n=[],i=new r([],s);for(;t.length;){const r=t.pop();if(r.isLeftEndpoint){const t=new d(r);for(let o=0;o<i.data.length;o++){const s=i.data[o];if(e&&s.leftSweepEvent.featureId===r.featureId)continue;const a=f(t,s);!1!==a&&n.push(a)}i.push(t)}else!1===r.isLeftEndpoint&&i.pop()}return n}(n,e)}},16426:t=>{t.exports=function(){var t=document.getSelection();if(!t.rangeCount)return function(){};for(var e=document.activeElement,n=[],r=0;r<t.rangeCount;r++)n.push(t.getRangeAt(r));switch(e.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":e.blur();break;default:e=null}return t.removeAllRanges(),function(){"Caret"===t.type&&t.removeAllRanges(),t.rangeCount||n.forEach((function(e){t.addRange(e)})),e&&e.focus()}}},73712:(t,e,n)=>{"use strict";var r,i=Object.defineProperty,o=Object.getOwnPropertyDescriptor,s=Object.getOwnPropertyNames,a=Object.prototype.hasOwnProperty,l={};((t,e)=>{for(var n in e)i(t,n,{get:e[n],enumerable:!0})})(l,{DRACO_EXTERNAL_LIBRARIES:()=>x,DRACO_EXTERNAL_LIBRARY_URLS:()=>w,DracoLoader:()=>O,DracoWorkerLoader:()=>c,DracoWriter:()=>P,DracoWriterWorker:()=>T}),t.exports=(r=l,((t,e,n,r)=>{if(e&&"object"==typeof e||"function"==typeof e)for(let n of s(e))a.call(t,n)||undefined===n||i(t,n,{get:()=>e[n],enumerable:!(r=o(e,n))||r.enumerable});return t})(i({},"__esModule",{value:!0}),r));var u="4.2.1",c={dataType:null,batchType:null,name:"Draco",id:"draco",module:"draco",version:u,worker:!0,extensions:["drc"],mimeTypes:["application/octet-stream"],binary:!0,tests:["DRACO"],options:{draco:{decoderType:"object"==typeof WebAssembly?"wasm":"js",libraryPath:"libs/",extraAttributes:{},attributeNameEntry:void 0}}},h=n(33561),d=n(33561);function f(t,e,n){const r=n?p(n.metadata):void 0;return(0,d.deduceMeshField)(t,e,r)}function p(t){Object.entries(t);const e={};for(const n in t)e[`${n}.string`]=JSON.stringify(t[n]);return e}var g,y,m={POSITION:"POSITION",NORMAL:"NORMAL",COLOR:"COLOR_0",TEX_COORD:"TEXCOORD_0"},v={1:Int8Array,2:Uint8Array,3:Int16Array,4:Uint16Array,5:Int32Array,6:Uint32Array,9:Float32Array},b=class{draco;decoder;metadataQuerier;constructor(t){this.draco=t,this.decoder=new this.draco.Decoder,this.metadataQuerier=new this.draco.MetadataQuerier}destroy(){this.draco.destroy(this.decoder),this.draco.destroy(this.metadataQuerier)}parseSync(t,e={}){const n=new this.draco.DecoderBuffer;n.Init(new Int8Array(t),t.byteLength),this._disableAttributeTransforms(e);const r=this.decoder.GetEncodedGeometryType(n),i=r===this.draco.TRIANGULAR_MESH?new this.draco.Mesh:new this.draco.PointCloud;try{let t;switch(r){case this.draco.TRIANGULAR_MESH:t=this.decoder.DecodeBufferToMesh(n,i);break;case this.draco.POINT_CLOUD:t=this.decoder.DecodeBufferToPointCloud(n,i);break;default:throw new Error("DRACO: Unknown geometry type.")}if(!t.ok()||!i.ptr){const e=`DRACO decompression failed: ${t.error_msg()}`;throw new Error(e)}const o=this._getDracoLoaderData(i,r,e),s=this._getMeshData(i,o,e),a=(0,h.getMeshBoundingBox)(s.attributes),l=function(t,e,n){const r=p(e.metadata),i=[],o=function(t){const e={};for(const n in t){const r=t[n];e[r.name||"undefined"]=r}return e}(e.attributes);for(const e in t){const n=f(e,t[e],o[e]);i.push(n)}if(n){const t=f("indices",n);i.push(t)}return{fields:i,metadata:r}}(s.attributes,o,s.indices);return{loader:"draco",loaderData:o,header:{vertexCount:i.num_points(),boundingBox:a},...s,schema:l}}finally{this.draco.destroy(n),i&&this.draco.destroy(i)}}_getDracoLoaderData(t,e,n){const r=this._getTopLevelMetadata(t),i=this._getDracoAttributes(t,n);return{geometry_type:e,num_attributes:t.num_attributes(),num_points:t.num_points(),num_faces:t instanceof this.draco.Mesh?t.num_faces():0,metadata:r,attributes:i}}_getDracoAttributes(t,e){const n={};for(let r=0;r<t.num_attributes();r++){const i=this.decoder.GetAttribute(t,r),o=this._getAttributeMetadata(t,r);n[i.unique_id()]={unique_id:i.unique_id(),attribute_type:i.attribute_type(),data_type:i.data_type(),num_components:i.num_components(),byte_offset:i.byte_offset(),byte_stride:i.byte_stride(),normalized:i.normalized(),attribute_index:r,metadata:o};const s=this._getQuantizationTransform(i,e);s&&(n[i.unique_id()].quantization_transform=s);const a=this._getOctahedronTransform(i,e);a&&(n[i.unique_id()].octahedron_transform=a)}return n}_getMeshData(t,e,n){const r=this._getMeshAttributes(e,t,n);if(!r.POSITION)throw new Error("DRACO: No position attribute found.");return t instanceof this.draco.Mesh?"triangle-strip"===n.topology?{topology:"triangle-strip",mode:4,attributes:r,indices:{value:this._getTriangleStripIndices(t),size:1}}:{topology:"triangle-list",mode:5,attributes:r,indices:{value:this._getTriangleListIndices(t),size:1}}:{topology:"point-list",mode:0,attributes:r}}_getMeshAttributes(t,e,n){const r={};for(const i of Object.values(t.attributes)){const t=this._deduceAttributeName(i,n);i.name=t;const o=this._getAttributeValues(e,i);if(o){const{value:e,size:n}=o;r[t]={value:e,size:n,byteOffset:i.byte_offset,byteStride:i.byte_stride,normalized:i.normalized}}}return r}_getTriangleListIndices(t){const e=3*t.num_faces(),n=4*e,r=this.draco._malloc(n);try{return this.decoder.GetTrianglesUInt32Array(t,n,r),new Uint32Array(this.draco.HEAPF32.buffer,r,e).slice()}finally{this.draco._free(r)}}_getTriangleStripIndices(t){const e=new this.draco.DracoInt32Array;try{return this.decoder.GetTriangleStripsFromMesh(t,e),function(t){const e=t.size(),n=new Int32Array(e);for(let r=0;r<e;r++)n[r]=t.GetValue(r);return n}(e)}finally{this.draco.destroy(e)}}_getAttributeValues(t,e){const n=v[e.data_type];if(!n)return console.warn(`DRACO: Unsupported attribute type ${e.data_type}`),null;const r=e.num_components,i=t.num_points()*r,o=i*n.BYTES_PER_ELEMENT,s=function(t,e){switch(e){case Float32Array:return t.DT_FLOAT32;case Int8Array:return t.DT_INT8;case Int16Array:return t.DT_INT16;case Int32Array:return t.DT_INT32;case Uint8Array:return t.DT_UINT8;case Uint16Array:return t.DT_UINT16;case Uint32Array:return t.DT_UINT32;default:return t.DT_INVALID}}(this.draco,n);let a;const l=this.draco._malloc(o);try{const r=this.decoder.GetAttribute(t,e.attribute_index);this.decoder.GetAttributeDataArrayForAllPoints(t,r,s,o,l),a=new n(this.draco.HEAPF32.buffer,l,i).slice()}finally{this.draco._free(l)}return{value:a,size:r}}_deduceAttributeName(t,e){const n=t.unique_id;for(const[t,r]of Object.entries(e.extraAttributes||{}))if(r===n)return t;const r=t.attribute_type;for(const t in m)if(this.draco[t]===r)return m[t];const i=e.attributeNameEntry||"name";return t.metadata[i]?t.metadata[i].string:`CUSTOM_ATTRIBUTE_${n}`}_getTopLevelMetadata(t){const e=this.decoder.GetMetadata(t);return this._getDracoMetadata(e)}_getAttributeMetadata(t,e){const n=this.decoder.GetAttributeMetadata(t,e);return this._getDracoMetadata(n)}_getDracoMetadata(t){if(!t||!t.ptr)return{};const e={},n=this.metadataQuerier.NumEntries(t);for(let r=0;r<n;r++){const n=this.metadataQuerier.GetEntryName(t,r);e[n]=this._getDracoMetadataField(t,n)}return e}_getDracoMetadataField(t,e){const n=new this.draco.DracoInt32Array;try{this.metadataQuerier.GetIntEntryArray(t,e,n);const r=function(t){const e=t.size(),n=new Int32Array(e);for(let r=0;r<e;r++)n[r]=t.GetValue(r);return n}(n);return{int:this.metadataQuerier.GetIntEntry(t,e),string:this.metadataQuerier.GetStringEntry(t,e),double:this.metadataQuerier.GetDoubleEntry(t,e),intArray:r}}finally{this.draco.destroy(n)}}_disableAttributeTransforms(t){const{quantizedAttributes:e=[],octahedronAttributes:n=[]}=t,r=[...e,...n];for(const t of r)this.decoder.SkipAttributeTransform(this.draco[t])}_getQuantizationTransform(t,e){const{quantizedAttributes:n=[]}=e,r=t.attribute_type();if(n.map((t=>this.decoder[t])).includes(r)){const e=new this.draco.AttributeQuantizationTransform;try{if(e.InitFromAttribute(t))return{quantization_bits:e.quantization_bits(),range:e.range(),min_values:new Float32Array([1,2,3]).map((t=>e.min_value(t)))}}finally{this.draco.destroy(e)}}return null}_getOctahedronTransform(t,e){const{octahedronAttributes:n=[]}=e,r=t.attribute_type();if(n.map((t=>this.decoder[t])).includes(r)){const e=new this.draco.AttributeQuantizationTransform;try{if(e.InitFromAttribute(t))return{quantization_bits:e.quantization_bits()}}finally{this.draco.destroy(e)}}return null}},_=n(96288),A="https://www.gstatic.com/draco/versioned/decoders/1.5.6",x={DECODER:"draco_wasm_wrapper.js",DECODER_WASM:"draco_decoder.wasm",FALLBACK_DECODER:"draco_decoder.js",ENCODER:"draco_encoder.js"},w={[x.DECODER]:`${A}/${x.DECODER}`,[x.DECODER_WASM]:`${A}/${x.DECODER_WASM}`,[x.FALLBACK_DECODER]:`${A}/${x.FALLBACK_DECODER}`,[x.ENCODER]:`https://raw.githubusercontent.com/google/draco/1.4.1/javascript/${x.ENCODER}`};var C={POSITION:"POSITION",NORMAL:"NORMAL",COLOR_0:"COLOR",TEXCOORD_0:"TEX_COORD"},S=()=>{},E=class{draco;dracoEncoder;dracoMeshBuilder;dracoMetadataBuilder;log;constructor(t){this.draco=t,this.dracoEncoder=new this.draco.Encoder,this.dracoMeshBuilder=new this.draco.MeshBuilder,this.dracoMetadataBuilder=new this.draco.MetadataBuilder}destroy(){this.destroyEncodedObject(this.dracoMeshBuilder),this.destroyEncodedObject(this.dracoEncoder),this.destroyEncodedObject(this.dracoMetadataBuilder),this.dracoMeshBuilder=null,this.dracoEncoder=null,this.draco=null}destroyEncodedObject(t){t&&this.draco.destroy(t)}encodeSync(t,e={}){return this.log=S,this._setOptions(e),e.pointcloud?this._encodePointCloud(t,e):this._encodeMesh(t,e)}_getAttributesFromMesh(t){const e={...t,...t.attributes};return t.indices&&(e.indices=t.indices),e}_encodePointCloud(t,e){const n=new this.draco.PointCloud;e.metadata&&this._addGeometryMetadata(n,e.metadata);const r=this._getAttributesFromMesh(t);this._createDracoPointCloud(n,r,e);const i=new this.draco.DracoInt8Array;try{const t=this.dracoEncoder.EncodePointCloudToDracoBuffer(n,!1,i);if(!(t>0))throw new Error("Draco encoding failed.");return this.log(`DRACO encoded ${n.num_points()} points\n        with ${n.num_attributes()} attributes into ${t} bytes`),M(i)}finally{this.destroyEncodedObject(i),this.destroyEncodedObject(n)}}_encodeMesh(t,e){const n=new this.draco.Mesh;e.metadata&&this._addGeometryMetadata(n,e.metadata);const r=this._getAttributesFromMesh(t);this._createDracoMesh(n,r,e);const i=new this.draco.DracoInt8Array;try{const t=this.dracoEncoder.EncodeMeshToDracoBuffer(n,i);if(t<=0)throw new Error("Draco encoding failed.");return this.log(`DRACO encoded ${n.num_points()} points\n        with ${n.num_attributes()} attributes into ${t} bytes`),M(i)}finally{this.destroyEncodedObject(i),this.destroyEncodedObject(n)}}_setOptions(t){if("speed"in t&&this.dracoEncoder.SetSpeedOptions(...t.speed),"method"in t){const e=this.draco[t.method||"MESH_SEQUENTIAL_ENCODING"];this.dracoEncoder.SetEncodingMethod(e)}if("quantization"in t)for(const e in t.quantization){const n=t.quantization[e],r=this.draco[e];this.dracoEncoder.SetAttributeQuantization(r,n)}}_createDracoMesh(t,e,n){const r=n.attributesMetadata||{};try{const n=this._getPositionAttribute(e);if(!n)throw new Error("positions");const i=n.length/3;for(let n in e){const o=e[n];n=C[n]||n;const s=this._addAttributeToMesh(t,n,o,i);-1!==s&&this._addAttributeMetadata(t,s,{name:n,...r[n]||{}})}}catch(e){throw this.destroyEncodedObject(t),e}return t}_createDracoPointCloud(t,e,n){const r=n.attributesMetadata||{};try{const n=this._getPositionAttribute(e);if(!n)throw new Error("positions");const i=n.length/3;for(let n in e){const o=e[n];n=C[n]||n;const s=this._addAttributeToMesh(t,n,o,i);-1!==s&&this._addAttributeMetadata(t,s,{name:n,...r[n]||{}})}}catch(e){throw this.destroyEncodedObject(t),e}return t}_addAttributeToMesh(t,e,n,r){if(!ArrayBuffer.isView(n))return-1;const i=this._getDracoAttributeType(e),o=n.length/r;if("indices"===i){const r=n.length/3;return this.log(`Adding attribute ${e}, size ${r}`),this.dracoMeshBuilder.AddFacesToMesh(t,r,n),-1}this.log(`Adding attribute ${e}, size ${o}`);const s=this.dracoMeshBuilder,{buffer:a}=n;switch(n.constructor){case Int8Array:return s.AddInt8Attribute(t,i,r,o,new Int8Array(a));case Int16Array:return s.AddInt16Attribute(t,i,r,o,new Int16Array(a));case Int32Array:return s.AddInt32Attribute(t,i,r,o,new Int32Array(a));case Uint8Array:case Uint8ClampedArray:return s.AddUInt8Attribute(t,i,r,o,new Uint8Array(a));case Uint16Array:return s.AddUInt16Attribute(t,i,r,o,new Uint16Array(a));case Uint32Array:return s.AddUInt32Attribute(t,i,r,o,new Uint32Array(a));case Float32Array:return s.AddFloatAttribute(t,i,r,o,new Float32Array(a));default:return console.warn("Unsupported attribute type",n),-1}}_getDracoAttributeType(t){switch(t.toLowerCase()){case"indices":return"indices";case"position":case"positions":case"vertices":return this.draco.POSITION;case"normal":case"normals":return this.draco.NORMAL;case"color":case"colors":return this.draco.COLOR;case"texcoord":case"texcoords":return this.draco.TEX_COORD;default:return this.draco.GENERIC}}_getPositionAttribute(t){for(const e in t){const n=t[e];if(this._getDracoAttributeType(e)===this.draco.POSITION)return n}return null}_addGeometryMetadata(t,e){const n=new this.draco.Metadata;this._populateDracoMetadata(n,e),this.dracoMeshBuilder.AddMetadata(t,n)}_addAttributeMetadata(t,e,n){const r=new this.draco.Metadata;this._populateDracoMetadata(r,n),this.dracoMeshBuilder.SetMetadataForAttribute(t,e,r)}_populateDracoMetadata(t,e){for(const[r,i]of(n=e).entries&&!n.hasOwnProperty("entries")?n.entries():Object.entries(n))switch(typeof i){case"number":Math.trunc(i)===i?this.dracoMetadataBuilder.AddIntEntry(t,r,i):this.dracoMetadataBuilder.AddDoubleEntry(t,r,i);break;case"object":i instanceof Int32Array&&this.dracoMetadataBuilder.AddIntEntryArray(t,r,i,i.length);break;default:this.dracoMetadataBuilder.AddStringEntry(t,r,i)}var n}};function M(t){const e=t.size(),n=new ArrayBuffer(e),r=new Int8Array(n);for(let n=0;n<e;++n)r[n]=t.GetValue(n);return n}var P={name:"DRACO",id:"draco",module:"draco",version:u,extensions:["drc"],options:{draco:{pointcloud:!1,attributeNameEntry:"name"}},encode:async function(t,e={}){const{draco:n}=await async function(t){const e=t.modules||{};return e.draco3d?y||=e.draco3d.createEncoderModule({}).then((t=>({draco:t}))):y||=async function(t){let e=await(0,_.loadLibrary)(w[x.ENCODER],"draco",t,x.ENCODER);return e=e||globalThis.DracoEncoderModule,new Promise((t=>{e({onModuleLoaded:e=>t({draco:e})})}))}(t),await y}(e),r=new E(n);try{return r.encodeSync(t,e.draco)}finally{r.destroy()}}},T={id:"draco-writer",name:"Draco compressed geometry writer",module:"draco",version:u,worker:!0,options:{draco:{},source:null}},O={...c,parse:async function(t,e){const{draco:n}=await async function(t){const e=t.modules||{};return e.draco3d?g||=e.draco3d.createDecoderModule({}).then((t=>({draco:t}))):g||=async function(t){let e,n;return"js"===(t.draco&&t.draco.decoderType)?e=await(0,_.loadLibrary)(w[x.FALLBACK_DECODER],"draco",t,x.FALLBACK_DECODER):[e,n]=await Promise.all([await(0,_.loadLibrary)(w[x.DECODER],"draco",t,x.DECODER),await(0,_.loadLibrary)(w[x.DECODER_WASM],"draco",t,x.DECODER_WASM)]),e=e||globalThis.DracoDecoderModule,await function(t,e){const n={};return e&&(n.wasmBinary=e),new Promise((e=>{t({...n,onModuleLoaded:t=>e({draco:t})})}))}(e,n)}(t),await g}(e),r=new b(n);try{return r.parseSync(t,null==e?void 0:e.draco)}finally{r.destroy()}}}},9256:(t,e,n)=>{"use strict";var r,i=Object.defineProperty,o=Object.getOwnPropertyDescriptor,s=Object.getOwnPropertyNames,a=Object.prototype.hasOwnProperty,l=(t,e)=>{for(var n in e)i(t,n,{get:e[n],enumerable:!0})},u={};l(u,{EXT_FEATURE_METADATA:()=>ot,EXT_MESH_FEATURES:()=>V,EXT_STRUCTURAL_METADATA:()=>Y,GLBLoader:()=>en,GLBWriter:()=>rn,GLTFLoader:()=>qe,GLTFScenegraph:()=>M,GLTFWriter:()=>$e,_getMemoryUsageGLTF:()=>E,postProcessGLTF:()=>gn}),t.exports=(r=u,((t,e,n,r)=>{if(e&&"object"==typeof e||"function"==typeof e)for(let n of s(e))a.call(t,n)||undefined===n||i(t,n,{get:()=>e[n],enumerable:!(r=o(e,n))||r.enumerable});return t})(i({},"__esModule",{value:!0}),r));var c={};l(c,{decode:()=>H,name:()=>V});var h=n(48043),d=n(63666);function f(t,e){if(!t)throw new Error(e||"assert failed: gltf")}var p={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},g={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},y=1.33,m=["SCALAR","VEC2","VEC3","VEC4"],v=[[Int8Array,5120],[Uint8Array,5121],[Int16Array,5122],[Uint16Array,5123],[Uint32Array,5125],[Float32Array,5126],[Float64Array,5130]],b=new Map(v),_={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},A={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},x={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function w(t){return m[t-1]||m[0]}function C(t){const e=b.get(t.constructor);if(!e)throw new Error("Illegal typed array");return e}function S(t,e){const n=x[t.componentType],r=_[t.type],i=A[t.componentType],o=t.count*r,s=t.count*r*i;return f(s>=0&&s<=e.byteLength),{ArrayType:n,length:o,byteLength:s,componentByteSize:g[t.componentType],numberOfComponentsInElement:p[t.type]}}function E(t){let{images:e,bufferViews:n}=t;e=e||[],n=n||[];const r=e.map((t=>t.bufferView));n=n.filter((t=>!r.includes(t)));const i=n.reduce(((t,e)=>t+e.byteLength),0),o=e.reduce(((t,e)=>{const{width:n,height:r}=e.image;return t+n*r}),0);return i+Math.ceil(4*o*y)}var M=class{gltf;sourceBuffers;byteLength;constructor(t){this.gltf={json:(null==t?void 0:t.json)||{asset:{version:"2.0",generator:"loaders.gl"},buffers:[],extensions:{},extensionsRequired:[],extensionsUsed:[]},buffers:(null==t?void 0:t.buffers)||[],images:(null==t?void 0:t.images)||[]},this.sourceBuffers=[],this.byteLength=0,this.gltf.buffers&&this.gltf.buffers[0]&&(this.byteLength=this.gltf.buffers[0].byteLength,this.sourceBuffers=[this.gltf.buffers[0]])}get json(){return this.gltf.json}getApplicationData(t){return this.json[t]}getExtraData(t){return(this.json.extras||{})[t]}hasExtension(t){const e=this.getUsedExtensions().find((e=>e===t)),n=this.getRequiredExtensions().find((e=>e===t));return"string"==typeof e||"string"==typeof n}getExtension(t){const e=this.getUsedExtensions().find((e=>e===t)),n=this.json.extensions||{};return e?n[t]:null}getRequiredExtension(t){return this.getRequiredExtensions().find((e=>e===t))?this.getExtension(t):null}getRequiredExtensions(){return this.json.extensionsRequired||[]}getUsedExtensions(){return this.json.extensionsUsed||[]}getRemovedExtensions(){return this.json.extensionsRemoved||[]}getObjectExtension(t,e){return(t.extensions||{})[e]}getScene(t){return this.getObject("scenes",t)}getNode(t){return this.getObject("nodes",t)}getSkin(t){return this.getObject("skins",t)}getMesh(t){return this.getObject("meshes",t)}getMaterial(t){return this.getObject("materials",t)}getAccessor(t){return this.getObject("accessors",t)}getTexture(t){return this.getObject("textures",t)}getSampler(t){return this.getObject("samplers",t)}getImage(t){return this.getObject("images",t)}getBufferView(t){return this.getObject("bufferViews",t)}getBuffer(t){return this.getObject("buffers",t)}getObject(t,e){if("object"==typeof e)return e;const n=this.json[t]&&this.json[t][e];if(!n)throw new Error(`glTF file error: Could not find ${t}[${e}]`);return n}getTypedArrayForBufferView(t){const e=(t=this.getBufferView(t)).buffer,n=this.gltf.buffers[e];f(n);const r=(t.byteOffset||0)+n.byteOffset;return new Uint8Array(n.arrayBuffer,r,t.byteLength)}getTypedArrayForAccessor(t){const e=this.getAccessor(t);return function(t,e,n){var r,i;const o="number"==typeof n?null==(r=t.accessors)?void 0:r[n]:n;if(!o)throw new Error(`No gltf accessor ${JSON.stringify(n)}`);const s=null==(i=t.bufferViews)?void 0:i[o.bufferView||0];if(!s)throw new Error(`No gltf buffer view for accessor ${s}`);const{arrayBuffer:a,byteOffset:l}=e[s.buffer],u=(l||0)+(o.byteOffset||0)+(s.byteOffset||0),{ArrayType:c,length:h,componentByteSize:d,numberOfComponentsInElement:f}=S(o,s),p=d*f,g=s.byteStride||p;if(void 0===s.byteStride||s.byteStride===p)return new c(a,u,h);const y=new c(h);for(let t=0;t<o.count;t++){const e=new c(a,u+t*g,f);y.set(e,t*f)}return y}(this.gltf.json,this.gltf.buffers,e)}getTypedArrayForImageData(t){t=this.getAccessor(t);const e=this.getBufferView(t.bufferView),n=this.getBuffer(e.buffer).data,r=e.byteOffset||0;return new Uint8Array(n,r,e.byteLength)}addApplicationData(t,e){return this.json[t]=e,this}addExtraData(t,e){return this.json.extras=this.json.extras||{},this.json.extras[t]=e,this}addObjectExtension(t,e,n){return t.extensions=t.extensions||{},t.extensions[e]=n,this.registerUsedExtension(e),this}setObjectExtension(t,e,n){(t.extensions||{})[e]=n}removeObjectExtension(t,e){const n=(null==t?void 0:t.extensions)||{};if(n[e]){this.json.extensionsRemoved=this.json.extensionsRemoved||[];const t=this.json.extensionsRemoved;t.includes(e)||t.push(e)}delete n[e]}addExtension(t,e={}){return f(e),this.json.extensions=this.json.extensions||{},this.json.extensions[t]=e,this.registerUsedExtension(t),e}addRequiredExtension(t,e={}){return f(e),this.addExtension(t,e),this.registerRequiredExtension(t),e}registerUsedExtension(t){this.json.extensionsUsed=this.json.extensionsUsed||[],this.json.extensionsUsed.find((e=>e===t))||this.json.extensionsUsed.push(t)}registerRequiredExtension(t){this.registerUsedExtension(t),this.json.extensionsRequired=this.json.extensionsRequired||[],this.json.extensionsRequired.find((e=>e===t))||this.json.extensionsRequired.push(t)}removeExtension(t){var e;if(null==(e=this.json.extensions)?void 0:e[t]){this.json.extensionsRemoved=this.json.extensionsRemoved||[];const e=this.json.extensionsRemoved;e.includes(t)||e.push(t)}this.json.extensions&&delete this.json.extensions[t],this.json.extensionsRequired&&this._removeStringFromArray(this.json.extensionsRequired,t),this.json.extensionsUsed&&this._removeStringFromArray(this.json.extensionsUsed,t)}setDefaultScene(t){this.json.scene=t}addScene(t){const{nodeIndices:e}=t;return this.json.scenes=this.json.scenes||[],this.json.scenes.push({nodes:e}),this.json.scenes.length-1}addNode(t){const{meshIndex:e,matrix:n}=t;this.json.nodes=this.json.nodes||[];const r={mesh:e};return n&&(r.matrix=n),this.json.nodes.push(r),this.json.nodes.length-1}addMesh(t){const{attributes:e,indices:n,material:r,mode:i=4}=t,o={primitives:[{attributes:this._addAttributes(e),mode:i}]};if(n){const t=this._addIndices(n);o.primitives[0].indices=t}return Number.isFinite(r)&&(o.primitives[0].material=r),this.json.meshes=this.json.meshes||[],this.json.meshes.push(o),this.json.meshes.length-1}addPointCloud(t){const e={primitives:[{attributes:this._addAttributes(t),mode:0}]};return this.json.meshes=this.json.meshes||[],this.json.meshes.push(e),this.json.meshes.length-1}addImage(t,e){const n=(0,h.getBinaryImageMetadata)(t),r=e||(null==n?void 0:n.mimeType),i={bufferView:this.addBufferView(t),mimeType:r};return this.json.images=this.json.images||[],this.json.images.push(i),this.json.images.length-1}addBufferView(t,e=0,n=this.byteLength){const r=t.byteLength;f(Number.isFinite(r)),this.sourceBuffers=this.sourceBuffers||[],this.sourceBuffers.push(t);const i={buffer:e,byteOffset:n,byteLength:r};return this.byteLength+=(0,d.padToNBytes)(r,4),this.json.bufferViews=this.json.bufferViews||[],this.json.bufferViews.push(i),this.json.bufferViews.length-1}addAccessor(t,e){const n={bufferView:t,type:w(e.size),componentType:e.componentType,count:e.count,max:e.max,min:e.min};return this.json.accessors=this.json.accessors||[],this.json.accessors.push(n),this.json.accessors.length-1}addBinaryBuffer(t,e={size:3}){const n=this.addBufferView(t);let r={min:e.min,max:e.max};r.min&&r.max||(r=this._getAccessorMinMax(t,e.size));const i={size:e.size,componentType:C(t),count:Math.round(t.length/e.size),min:r.min,max:r.max};return this.addAccessor(n,Object.assign(i,e))}addTexture(t){const{imageIndex:e}=t,n={source:e};return this.json.textures=this.json.textures||[],this.json.textures.push(n),this.json.textures.length-1}addMaterial(t){return this.json.materials=this.json.materials||[],this.json.materials.push(t),this.json.materials.length-1}createBinaryChunk(){var t,e;this.gltf.buffers=[];const n=this.byteLength,r=new ArrayBuffer(n),i=new Uint8Array(r);let o=0;for(const t of this.sourceBuffers||[])o=(0,d.copyToArray)(t,i,o);(null==(e=null==(t=this.json)?void 0:t.buffers)?void 0:e[0])?this.json.buffers[0].byteLength=n:this.json.buffers=[{byteLength:n}],this.gltf.binary=r,this.sourceBuffers=[r]}_removeStringFromArray(t,e){let n=!0;for(;n;){const r=t.indexOf(e);r>-1?t.splice(r,1):n=!1}}_addAttributes(t={}){const e={};for(const n in t){const r=t[n],i=this._getGltfAttributeName(n),o=this.addBinaryBuffer(r.value,r);e[i]=o}return e}_addIndices(t){return this.addBinaryBuffer(t,{size:1})}_getGltfAttributeName(t){switch(t.toLowerCase()){case"position":case"positions":case"vertices":return"POSITION";case"normal":case"normals":return"NORMAL";case"color":case"colors":return"COLOR_0";case"texcoord":case"texcoords":return"TEXCOORD_0";default:return t}}_getAccessorMinMax(t,e){const n={min:null,max:null};if(t.length<e)return n;n.min=[],n.max=[];const r=t.subarray(0,e);for(const t of r)n.min.push(t),n.max.push(t);for(let r=e;r<t.length;r+=e)for(let i=0;i<e;i++)n.min[0+i]=Math.min(n.min[0+i],t[r+i]),n.max[0+i]=Math.max(n.max[0+i],t[r+i]);return n}},P=n(48043);function T(t){return(t%1+1)%1}var O={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16,BOOLEAN:1,STRING:1,ENUM:1},I={INT8:Int8Array,UINT8:Uint8Array,INT16:Int16Array,UINT16:Uint16Array,INT32:Int32Array,UINT32:Uint32Array,INT64:BigInt64Array,UINT64:BigUint64Array,FLOAT32:Float32Array,FLOAT64:Float64Array},R={INT8:1,UINT8:1,INT16:2,UINT16:2,INT32:4,UINT32:4,INT64:8,UINT64:8,FLOAT32:4,FLOAT64:8};function B(t,e){return R[e]*O[t]}function L(t,e,n,r){if("UINT8"!==n&&"UINT16"!==n&&"UINT32"!==n&&"UINT64"!==n)return null;const i=k(t.getTypedArrayForBufferView(e),"SCALAR",n,r+1);return i instanceof BigInt64Array||i instanceof BigUint64Array?null:i}function k(t,e,n,r=1){const i=O[e],o=I[n],s=R[n],a=r*i,l=a*s;let u=t.buffer,c=t.byteOffset;return c%s!=0&&(u=new Uint8Array(u).slice(c,c+l).buffer,c=0),new o(u,c,a)}function D(t,e,n){var r,i,o,s,a;const l=`TEXCOORD_${e.texCoord||0}`,u=n.attributes[l],c=t.getTypedArrayForAccessor(u),h=t.gltf.json,d=e.index,f=null==(i=null==(r=h.textures)?void 0:r[d])?void 0:i.source;if(void 0!==f){const n=null==(s=null==(o=h.images)?void 0:o[f])?void 0:s.mimeType,r=null==(a=t.gltf.images)?void 0:a[f];if(r&&void 0!==r.width){const t=[];for(let i=0;i<c.length;i+=2){const o=N(r,n,c,i,e.channels);t.push(o)}return t}}return[]}function F(t,e,n,r,i){if(!(null==n?void 0:n.length))return;const o=[];for(const t of n){let e=r.findIndex((e=>e===t));-1===e&&(e=r.push(t)-1),o.push(e)}const s=new Uint32Array(o),a=t.gltf.buffers.push({arrayBuffer:s.buffer,byteOffset:s.byteOffset,byteLength:s.byteLength})-1,l=t.addBufferView(s,a,0),u=t.addAccessor(l,{size:1,componentType:C(s),count:s.length});i.attributes[e]=u}function N(t,e,n,r,i=[0]){const o={r:{offset:0,shift:0},g:{offset:1,shift:8},b:{offset:2,shift:16},a:{offset:3,shift:24}},s=n[r],a=n[r+1];let l=1;!e||-1===e.indexOf("image/jpeg")&&-1===e.indexOf("image/png")||(l=4);const u=function(t,e,n,r=1){const i=n.width,o=T(t)*(i-1),s=Math.round(o),a=n.height,l=T(e)*(a-1);return(Math.round(l)*i+s)*(n.components?n.components:r)}(s,a,t,l);let c=0;for(const e of i){const n="number"==typeof e?Object.values(o)[e]:o[e],r=u+n.offset,i=(0,P.getImageData)(t);if(i.data.length<=r)throw new Error(`${i.data.length} <= ${r}`);c|=i.data[r]<<n.shift}return c}function j(t,e,n,r,i){const o=[];for(let s=0;s<e;s++){const e=n[s],a=n[s+1]-n[s];if(a+e>r)break;const l=e/i,u=a/i;o.push(t.slice(l,l+u))}return o}function G(t,e,n){const r=[];for(let i=0;i<e;i++){const e=i*n;r.push(t.slice(e,e+n))}return r}function U(t,e,n,r){if(n)throw new Error("Not implemented - arrayOffsets for strings is specified");if(r){const n=[],i=new TextDecoder("utf8");let o=0;for(let s=0;s<t;s++){const t=r[s+1]-r[s];if(t+o<=e.length){const r=e.subarray(o,t+o),s=i.decode(r);n.push(s),o+=t}}return n}return[]}var z="EXT_mesh_features",V=z;async function H(t,e){!function(t,e){const n=t.gltf.json;if(n.meshes)for(const r of n.meshes)for(const n of r.primitives)q(t,n,e)}(new M(t),e)}function q(t,e,n){var r,i,o;if(!(null==(r=null==n?void 0:n.gltf)?void 0:r.loadBuffers))return;const s=null==(i=e.extensions)?void 0:i[z],a=null==s?void 0:s.featureIds;if(a)for(const r of a){let i;if(void 0!==r.attribute){const n=`_FEATURE_ID_${r.attribute}`,o=e.attributes[n];i=t.getTypedArrayForAccessor(o)}else i=void 0!==r.texture&&(null==(o=null==n?void 0:n.gltf)?void 0:o.loadImages)?D(t,r.texture,e):[];r.data=i}}var W={};l(W,{decode:()=>X,name:()=>Y});var J="EXT_structural_metadata",Y=J;async function X(t,e){!function(t,e){var n,r;if(!(null==(n=e.gltf)?void 0:n.loadBuffers))return;const i=t.getExtension(J);i&&((null==(r=e.gltf)?void 0:r.loadImages)&&function(t,e){const n=e.propertyTextures,r=t.gltf.json;if(n&&r.meshes)for(const i of r.meshes)for(const r of i.primitives)Z(t,n,r,e)}(t,i),function(t,e){const n=e.schema;if(!n)return;const r=n.classes,i=e.propertyTables;if(r&&i)for(const e in r){const r=K(i,e);r&&$(t,n,r)}}(t,i))}(new M(t),e)}function K(t,e){for(const n of t)if(n.class===e)return n;return null}function Z(t,e,n,r){var i;if(!e)return;const o=null==(i=n.extensions)?void 0:i[J],s=null==o?void 0:o.propertyTextures;if(s)for(const i of s)Q(t,e[i],n,r)}function Q(t,e,n,r){var i;if(!e.properties)return;r.dataAttributeNames||(r.dataAttributeNames=[]);const o=e.class;for(const s in e.properties){const a=`${o}_${s}`,l=null==(i=e.properties)?void 0:i[s];if(!l)continue;l.data||(l.data=[]);const u=l.data,c=D(t,l,n);null!==c&&(F(t,a,c,u,n),l.data=u,r.dataAttributeNames.push(a))}}function $(t,e,n){var r,i;const o=null==(r=e.classes)?void 0:r[n.class];if(!o)throw new Error(`Incorrect data in the EXT_structural_metadata extension: no schema class with name ${n.class}`);const s=n.count;for(const r in o.properties){const a=o.properties[r],l=null==(i=n.properties)?void 0:i[r];if(l){const n=tt(t,e,a,s,l);l.data=n}}}function tt(t,e,n,r,i){let o=[];const s=i.values,a=t.getTypedArrayForBufferView(s),l=function(t,e,n,r){return e.array&&void 0===e.count&&void 0!==n.arrayOffsets?L(t,n.arrayOffsets,n.arrayOffsetType||"UINT32",r):null}(t,n,i,r),u=function(t,e,n){return void 0!==e.stringOffsets?L(t,e.stringOffsets,e.stringOffsetType||"UINT32",n):null}(t,i,r);switch(n.type){case"SCALAR":case"VEC2":case"VEC3":case"VEC4":case"MAT2":case"MAT3":case"MAT4":o=function(t,e,n,r){const i=t.array,o=t.count,s=B(t.type,t.componentType),a=n.byteLength/s;let l;return l=t.componentType?k(n,t.type,t.componentType,a):n,i?r?j(l,e,r,n.length,s):o?G(l,e,o):[]:l}(n,r,a,l);break;case"BOOLEAN":throw new Error(`Not implemented - classProperty.type=${n.type}`);case"STRING":o=U(r,a,l,u);break;case"ENUM":o=function(t,e,n,r,i){var o;const s=e.enumType;if(!s)throw new Error("Incorrect data in the EXT_structural_metadata extension: classProperty.enumType is not set for type ENUM");const a=null==(o=t.enums)?void 0:o[s];if(!a)throw new Error(`Incorrect data in the EXT_structural_metadata extension: schema.enums does't contain ${s}`);const l=a.valueType||"UINT16",u=B(e.type,l),c=r.byteLength/u;let h=k(r,e.type,l,c);if(h||(h=r),e.array){if(i)return function(t){const{valuesData:e,numberOfElements:n,arrayOffsets:r,valuesDataBytesLength:i,elementSize:o,enumEntry:s}=t,a=[];for(let t=0;t<n;t++){const n=r[t],l=r[t+1]-r[t];if(l+n>i)break;const u=et(e,n/o,l/o,s);a.push(u)}return a}({valuesData:h,numberOfElements:n,arrayOffsets:i,valuesDataBytesLength:r.length,elementSize:u,enumEntry:a});const t=e.count;return t?function(t,e,n,r){const i=[];for(let o=0;o<e;o++){const e=et(t,n*o,n,r);i.push(e)}return i}(h,n,t,a):[]}return et(h,0,n,a)}(e,n,r,a,l);break;default:throw new Error(`Unknown classProperty type ${n.type}`)}return o}function et(t,e,n,r){const i=[];for(let o=0;o<n;o++)if(t instanceof BigInt64Array||t instanceof BigUint64Array)i.push("");else{const n=nt(r,t[e+o]);n?i.push(n.name):i.push("")}return i}function nt(t,e){for(const n of t.values)if(n.value===e)return n;return null}var rt={};l(rt,{decode:()=>st,name:()=>ot});var it="EXT_feature_metadata",ot=it;async function st(t,e){!function(t,e){var n,r;if(!(null==(n=e.gltf)?void 0:n.loadBuffers))return;const i=t.getExtension(it);i&&((null==(r=e.gltf)?void 0:r.loadImages)&&function(t,e){const n=e.schema;if(!n)return;const r=n.classes,{featureTextures:i}=e;if(r&&i)for(const e in r){const n=r[e],o=lt(i,e);o&&ct(t,o,n)}}(t,i),function(t,e){const n=e.schema;if(!n)return;const r=n.classes,i=e.featureTables;if(r&&i)for(const e in r){const r=at(i,e);r&&ut(t,n,r)}}(t,i))}(new M(t),e)}function at(t,e){for(const n in t){const r=t[n];if(r.class===e)return r}return null}function lt(t,e){for(const n in t){const r=t[n];if(r.class===e)return r}return null}function ut(t,e,n){var r,i;if(!n.class)return;const o=null==(r=e.classes)?void 0:r[n.class];if(!o)throw new Error(`Incorrect data in the EXT_structural_metadata extension: no schema class with name ${n.class}`);const s=n.count;for(const e in o.properties){const r=o.properties[e],a=null==(i=n.properties)?void 0:i[e];if(a){const e=ht(t,0,r,s,a);a.data=e}}}function ct(t,e,n){var r;const i=e.class;for(const o in n.properties){const n=null==(r=null==e?void 0:e.properties)?void 0:r[o];if(n){const e=dt(t,n,i);n.data=e}}}function ht(t,e,n,r,i){let o=[];const s=i.bufferView,a=t.getTypedArrayForBufferView(s),l=function(t,e,n,r){return"ARRAY"===e.type&&void 0===e.componentCount&&void 0!==n.arrayOffsetBufferView?L(t,n.arrayOffsetBufferView,n.offsetType||"UINT32",r):null}(t,n,i,r),u=function(t,e,n,r){return void 0!==n.stringOffsetBufferView?L(t,n.stringOffsetBufferView,n.offsetType||"UINT32",r):null}(t,0,i,r);return"STRING"===n.type||"STRING"===n.componentType?o=U(r,a,l,u):function(t){const e=["UINT8","INT16","UINT16","INT32","UINT32","INT64","UINT64","FLOAT32","FLOAT64"];return e.includes(t.type)||void 0!==t.componentType&&e.includes(t.componentType)}(n)&&(o=function(t,e,n,r){const i="ARRAY"===t.type,o=t.componentCount,s="SCALAR",a=t.componentType||t.type,l=B(s,a),u=k(n,s,a,n.byteLength/l);return i?r?j(u,e,r,n.length,l):o?G(u,e,o):[]:u}(n,r,a,l)),o}function dt(t,e,n){const r=t.gltf.json;if(!r.meshes)return[];const i=[];for(const o of r.meshes)for(const r of o.primitives)ft(t,n,e,i,r);return i}function ft(t,e,n,r,i){const o=D(t,{channels:n.channels,...n.texture},i);o&&F(t,e,o,r,i)}var pt="4.2.1",gt=n(63666),yt=n(48043),mt=n(38453),vt=n(63666),bt=!0,_t=1735152710,At=12,xt=8,wt=1313821514,Ct=5130562,St=0,Et=0,Mt=1;function Pt(t,e,n=0,r={}){const i=new DataView(e),o=function(t,e=0){return`${String.fromCharCode(t.getUint8(e+0))}${String.fromCharCode(t.getUint8(e+1))}${String.fromCharCode(t.getUint8(e+2))}${String.fromCharCode(t.getUint8(e+3))}`}(i,n+0),s=i.getUint32(n+4,bt),a=i.getUint32(n+8,bt);switch(Object.assign(t,{header:{byteOffset:n,byteLength:a,hasBinChunk:!1},type:o,version:s,json:{},binChunks:[]}),n+=At,t.version){case 1:return function(t,e,n){(0,vt.assert)(t.header.byteLength>At+xt);const r=e.getUint32(n+0,bt),i=e.getUint32(n+4,bt);return n+=xt,(0,vt.assert)(i===St),Tt(t,e,n,r),n+=r,n+=Ot(t,e,n,t.header.byteLength)}(t,i,n);case 2:return function(t,e,n){return(0,vt.assert)(t.header.byteLength>At+xt),function(t,e,n,r){for(;n+8<=t.header.byteLength;){const i=e.getUint32(n+0,bt),o=e.getUint32(n+4,bt);switch(n+=xt,o){case wt:Tt(t,e,n,i);break;case Ct:Ot(t,e,n,i);break;case Et:r.strict||Tt(t,e,n,i);break;case Mt:r.strict||Ot(t,e,n,i)}n+=(0,vt.padToNBytes)(i,4)}}(t,e,n,{}),n+t.header.byteLength}(t,i,n);default:throw new Error(`Invalid GLB version ${t.version}. Only supports version 1 and 2.`)}}function Tt(t,e,n,r){const i=new Uint8Array(e.buffer,n,r),o=new TextDecoder("utf8").decode(i);return t.json=JSON.parse(o),(0,vt.padToNBytes)(r,4)}function Ot(t,e,n,r){return t.header.hasBinChunk=!0,t.binChunks.push({byteOffset:n,byteLength:r,arrayBuffer:e.buffer}),(0,vt.padToNBytes)(r,4)}function It(t,e){if(t.startsWith("data:")||t.startsWith("http:")||t.startsWith("https:"))return t;const n=e.baseUri||e.uri;if(!n)throw new Error(`'baseUri' must be provided to resolve relative url ${t}`);return n.substr(0,n.lastIndexOf("/")+1)+t}var Rt={};l(Rt,{decode:()=>zt,name:()=>Ut});var Bt,Lt="B9h9z9tFBBBF8fL9gBB9gLaaaaaFa9gEaaaB9gFaFa9gEaaaFaEMcBFFFGGGEIIILF9wFFFLEFBFKNFaFCx/IFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBF8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBGy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBEn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBIi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBKI9z9iqlBOc+x8ycGBM/qQFTa8jUUUUBCU/EBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAGTkUUUBRNCUoBAG9uC/wgBZHKCUGAKCUG9JyRVAECFJRICBRcGXEXAcAF9PQFAVAFAclAcAVJAF9JyRMGXGXAG9FQBAMCbJHKC9wZRSAKCIrCEJCGrRQANCUGJRfCBRbAIRTEXGXAOATlAQ9PQBCBRISEMATAQJRIGXAS9FQBCBRtCBREEXGXAOAIlCi9PQBCBRISLMANCU/CBJAEJRKGXGXGXGXGXATAECKrJ2BBAtCKZrCEZfIBFGEBMAKhB83EBAKCNJhB83EBSEMAKAI2BIAI2BBHmCKrHYAYCE6HYy86BBAKCFJAICIJAYJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCGJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCEJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCIJAYAmJHY2BBAI2BFHmCKrHPAPCE6HPy86BBAKCLJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCKJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCOJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCNJAYAmJHY2BBAI2BGHmCKrHPAPCE6HPy86BBAKCVJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCcJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCMJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCSJAYAmJHm2BBAI2BEHICKrHYAYCE6HYy86BBAKCQJAmAYJHm2BBAICIrCEZHYAYCE6HYy86BBAKCfJAmAYJHm2BBAICGrCEZHYAYCE6HYy86BBAKCbJAmAYJHK2BBAICEZHIAICE6HIy86BBAKAIJRISGMAKAI2BNAI2BBHmCIrHYAYCb6HYy86BBAKCFJAICNJAYJHY2BBAmCbZHmAmCb6Hmy86BBAKCGJAYAmJHm2BBAI2BFHYCIrHPAPCb6HPy86BBAKCEJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCIJAmAYJHm2BBAI2BGHYCIrHPAPCb6HPy86BBAKCLJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCKJAmAYJHm2BBAI2BEHYCIrHPAPCb6HPy86BBAKCOJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCNJAmAYJHm2BBAI2BIHYCIrHPAPCb6HPy86BBAKCVJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCcJAmAYJHm2BBAI2BLHYCIrHPAPCb6HPy86BBAKCMJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCSJAmAYJHm2BBAI2BKHYCIrHPAPCb6HPy86BBAKCQJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCfJAmAYJHm2BBAI2BOHICIrHYAYCb6HYy86BBAKCbJAmAYJHK2BBAICbZHIAICb6HIy86BBAKAIJRISFMAKAI8pBB83BBAKCNJAICNJ8pBB83BBAICTJRIMAtCGJRtAECTJHEAS9JQBMMGXAIQBCBRISEMGXAM9FQBANAbJ2BBRtCBRKAfREEXAEANCU/CBJAKJ2BBHTCFrCBATCFZl9zAtJHt86BBAEAGJREAKCFJHKAM9HQBMMAfCFJRfAIRTAbCFJHbAG9HQBMMABAcAG9sJANCUGJAMAG9sTkUUUBpANANCUGJAMCaJAG9sJAGTkUUUBpMAMCBAIyAcJRcAIQBMC9+RKSFMCBC99AOAIlAGCAAGCA9Ly6yRKMALCU/EBJ8kUUUUBAKM+OmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUFT+JUUUBpALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM+lLKFaF99GaG99FaG99GXGXAGCI9HQBAF9FQFEXGXGX9DBBB8/9DBBB+/ABCGJHG1BB+yAB1BBHE+yHI+L+TABCFJHL1BBHK+yHO+L+THN9DBBBB9gHVyAN9DBB/+hANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE86BBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG86BBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG86BBABCIJRBAFCaJHFQBSGMMAF9FQBEXGXGX9DBBB8/9DBBB+/ABCIJHG8uFB+yAB8uFBHE+yHI+L+TABCGJHL8uFBHK+yHO+L+THN9DBBBB9gHVyAN9DB/+g6ANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE87FBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG87FBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG87FBABCNJRBAFCaJHFQBMMM/SEIEaE99EaF99GXAF9FQBCBREABRIEXGXGX9D/zI818/AICKJ8uFBHLCEq+y+VHKAI8uFB+y+UHO9DB/+g6+U9DBBB8/9DBBB+/AO9DBBBB9gy+SHN+L9DBBB9P9d9FQBAN+oRVSFMCUUUU94RVMAICIJ8uFBRcAICGJ8uFBRMABALCFJCEZAEqCFWJAV87FBGXGXAKAM+y+UHN9DB/+g6+U9DBBB8/9DBBB+/AN9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRMSFMCUUUU94RMMABALCGJCEZAEqCFWJAM87FBGXGXAKAc+y+UHK9DB/+g6+U9DBBB8/9DBBB+/AK9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRcSFMCUUUU94RcMABALCaJCEZAEqCFWJAc87FBGXGX9DBBU8/AOAO+U+TANAN+U+TAKAK+U+THO9DBBBBAO9DBBBB9gy+R9DB/+g6+U9DBBB8/+SHO+L9DBBB9P9d9FQBAO+oRcSFMCUUUU94RcMABALCEZAEqCFWJAc87FBAICNJRIAECIJREAFCaJHFQBMMM9JBGXAGCGrAF9sHF9FQBEXABAB8oGBHGCNWCN91+yAGCi91CnWCUUU/8EJ+++U84GBABCIJRBAFCaJHFQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEM/lFFFaGXGXAFABqCEZ9FQBABRESFMGXGXAGCT9PQBABRESFMABREEXAEAF8oGBjGBAECIJAFCIJ8oGBjGBAECNJAFCNJ8oGBjGBAECSJAFCSJ8oGBjGBAECTJREAFCTJRFAGC9wJHGCb9LQBMMAGCI9JQBEXAEAF8oGBjGBAFCIJRFAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF2BB86BBAECFJREAFCFJRFAGCaJHGQBMMABMoFFGaGXGXABCEZ9FQBABRESFMAFCgFZC+BwsN9sRIGXGXAGCT9PQBABRESFMABREEXAEAIjGBAECSJAIjGBAECNJAIjGBAECIJAIjGBAECTJREAGC9wJHGCb9LQBMMAGCI9JQBEXAEAIjGBAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF86BBAECFJREAGCaJHGQBMMABMMMFBCUNMIT9kBB",kt="B9h9z9tFBBBF8dL9gBB9gLaaaaaFa9gEaaaB9gGaaB9gFaFaEQSBBFBFFGEGEGIILF9wFFFLEFBFKNFaFCx/aFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBG8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBIy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBKi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBNn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBcI9z9iqlBMc/j9JSIBTEM9+FLa8jUUUUBCTlRBCBRFEXCBRGCBREEXABCNJAGJAECUaAFAGrCFZHIy86BBAEAIJREAGCFJHGCN9HQBMAFCx+YUUBJAE86BBAFCEWCxkUUBJAB8pEN83EBAFCFJHFCUG9HQBMMkRIbaG97FaK978jUUUUBCU/KBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAG/8cBBCUoBAG9uC/wgBZHKCUGAKCUG9JyRNAECFJRKCBRVGXEXAVAF9PQFANAFAVlAVANJAF9JyRcGXGXAG9FQBAcCbJHIC9wZHMCE9sRSAMCFWRQAICIrCEJCGrRfCBRbEXAKRTCBRtGXEXGXAOATlAf9PQBCBRKSLMALCU/CBJAtAM9sJRmATAfJRKCBREGXAMCoB9JQBAOAKlC/gB9JQBCBRIEXAmAIJREGXGXGXGXGXATAICKrJ2BBHYCEZfIBFGEBMAECBDtDMIBSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMIBAKCTJRKMGXGXGXGXGXAYCGrCEZfIBFGEBMAECBDtDMITSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMITAKCTJRKMGXGXGXGXGXAYCIrCEZfIBFGEBMAECBDtDMIASEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMIAAKCTJRKMGXGXGXGXGXAYCKrfIBFGEBMAECBDtDMI8wSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCIJAnDeBJAYCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCNJAnDeBJAYCx+YUUBJ2BBJRKSFMAEAKDBBBDMI8wAKCTJRKMAICoBJREAICUFJAM9LQFAERIAOAKlC/fB9LQBMMGXAEAM9PQBAECErRIEXGXAOAKlCi9PQBCBRKSOMAmAEJRYGXGXGXGXGXATAECKrJ2BBAICKZrCEZfIBFGEBMAYCBDtDMIBSEMAYAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAYAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAYAKDBBBDMIBAKCTJRKMAICGJRIAECTJHEAM9JQBMMGXAK9FQBAKRTAtCFJHtCI6QGSFMMCBRKSEMGXAM9FQBALCUGJAbJREALAbJDBGBRnCBRYEXAEALCU/CBJAYJHIDBIBHdCFD9tAdCFDbHPD9OD9hD9RHdAIAMJDBIBHiCFD9tAiAPD9OD9hD9RHiDQBTFtGmEYIPLdKeOnH8ZAIAQJDBIBHpCFD9tApAPD9OD9hD9RHpAIASJDBIBHyCFD9tAyAPD9OD9hD9RHyDQBTFtGmEYIPLdKeOnH8cDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGEAnD9uHnDyBjGBAEAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnA8ZA8cDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnAdAiDQNiV8ZcpMyS8cQ8df8eb8fHdApAyDQNiV8ZcpMyS8cQ8df8eb8fHiDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnAdAiDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJREAYCTJHYAM9JQBMMAbCIJHbAG9JQBMMABAVAG9sJALCUGJAcAG9s/8cBBALALCUGJAcCaJAG9sJAG/8cBBMAcCBAKyAVJRVAKQBMC9+RKSFMCBC99AOAKlAGCAAGCA9Ly6yRKMALCU/KBJ8kUUUUBAKMNBT+BUUUBM+KmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUF/8MBALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM/xLGEaK978jUUUUBCAlHE8kUUUUBGXGXAGCI9HQBGXAFC98ZHI9FQBABRGCBRLEXAGAGDBBBHKCiD+rFCiD+sFD/6FHOAKCND+rFCiD+sFD/6FAOD/gFAKCTD+rFCiD+sFD/6FHND/gFD/kFD/lFHVCBDtD+2FHcAOCUUUU94DtHMD9OD9RD/kFHO9DBB/+hDYAOAOD/mFAVAVD/mFANAcANAMD9OD9RD/kFHOAOD/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHcD/kFCgFDtD9OAKCUUU94DtD9OD9QAOAND/mFAcD/kFCND+rFCU/+EDtD9OD9QAVAND/mFAcD/kFCTD+rFCUU/8ODtD9OD9QDMBBAGCTJRGALCIJHLAI9JQBMMAIAF9PQFAEAFCEZHLCGWHGqCBCTAGl/8MBAEABAICGWJHIAG/8cBBGXAL9FQBAEAEDBIBHKCiD+rFCiD+sFD/6FHOAKCND+rFCiD+sFD/6FAOD/gFAKCTD+rFCiD+sFD/6FHND/gFD/kFD/lFHVCBDtD+2FHcAOCUUUU94DtHMD9OD9RD/kFHO9DBB/+hDYAOAOD/mFAVAVD/mFANAcANAMD9OD9RD/kFHOAOD/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHcD/kFCgFDtD9OAKCUUU94DtD9OD9QAOAND/mFAcD/kFCND+rFCU/+EDtD9OD9QAVAND/mFAcD/kFCTD+rFCUU/8ODtD9OD9QDMIBMAIAEAG/8cBBSFMABAFC98ZHGT+HUUUBAGAF9PQBAEAFCEZHICEWHLJCBCAALl/8MBAEABAGCEWJHGAL/8cBBAEAIT+HUUUBAGAEAL/8cBBMAECAJ8kUUUUBM+yEGGaO97GXAF9FQBCBRGEXABCTJHEAEDBBBHICBDtHLCUU98D8cFCUU98D8cEHKD9OABDBBBHOAIDQILKOSQfbPden8c8d8e8fCggFDtD9OD/6FAOAIDQBFGENVcMTtmYi8ZpyHICTD+sFD/6FHND/gFAICTD+rFCTD+sFD/6FHVD/gFD/kFD/lFHI9DB/+g6DYAVAIALD+2FHLAVCUUUU94DtHcD9OD9RD/kFHVAVD/mFAIAID/mFANALANAcD9OD9RD/kFHIAID/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHLD/kFCTD+rFAVAND/mFALD/kFCggEDtD9OD9QHVAIAND/mFALD/kFCaDbCBDnGCBDnECBDnKCBDnOCBDncCBDnMCBDnfCBDnbD9OHIDQNVi8ZcMpySQ8c8dfb8e8fD9QDMBBABAOAKD9OAVAIDQBFTtGEmYILPdKOenD9QDMBBABCAJRBAGCIJHGAF9JQBMMM94FEa8jUUUUBCAlHE8kUUUUBABAFC98ZHIT+JUUUBGXAIAF9PQBAEAFCEZHLCEWHFJCBCAAFl/8MBAEABAICEWJHBAF/8cBBAEALT+JUUUBABAEAF/8cBBMAECAJ8kUUUUBM/hEIGaF97FaL978jUUUUBCTlRGGXAF9FQBCBREEXAGABDBBBHIABCTJHLDBBBHKDQILKOSQfbPden8c8d8e8fHOCTD+sFHNCID+rFDMIBAB9DBBU8/DY9D/zI818/DYANCEDtD9QD/6FD/nFHNAIAKDQBFGENVcMTtmYi8ZpyHICTD+rFCTD+sFD/6FD/mFHKAKD/mFANAICTD+sFD/6FD/mFHVAVD/mFANAOCTD+rFCTD+sFD/6FD/mFHOAOD/mFD/kFD/kFD/lFCBDtD+4FD/jF9DB/+g6DYHND/mF9DBBX9LDYHID/kFCggEDtHcD9OAVAND/mFAID/kFCTD+rFD9QHVAOAND/mFAID/kFCTD+rFAKAND/mFAID/kFAcD9OD9QHNDQBFTtGEmYILPdKOenHID8dBAGDBIBDyB+t+J83EBABCNJAID8dFAGDBIBDyF+t+J83EBALAVANDQNVi8ZcMpySQ8c8dfb8e8fHND8dBAGDBIBDyG+t+J83EBABCiJAND8dFAGDBIBDyE+t+J83EBABCAJRBAECIJHEAF9JQBMMM/3FGEaF978jUUUUBCoBlREGXAGCGrAF9sHIC98ZHL9FQBCBRGABRFEXAFAFDBBBHKCND+rFCND+sFD/6FAKCiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMBBAFCTJRFAGCIJHGAL9JQBMMGXALAI9PQBAEAICEZHGCGWHFqCBCoBAFl/8MBAEABALCGWJHLAF/8cBBGXAG9FQBAEAEDBIBHKCND+rFCND+sFD/6FAKCiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMIBMALAEAF/8cBBMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEMMMFBCUNMIT9tBB",Dt=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),Ft=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]),Nt={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},jt={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};var Gt="EXT_meshopt_compression",Ut=Gt;async function zt(t,e){var n,r;const i=new M(t);if(!(null==(n=null==e?void 0:e.gltf)?void 0:n.decompressMeshes)||!(null==(r=e.gltf)?void 0:r.loadBuffers))return;const o=[];for(const e of t.json.bufferViews||[])o.push(Vt(i,e));await Promise.all(o),i.removeExtension(Gt)}async function Vt(t,e){const n=t.getObjectExtension(e,Gt);if(n){const{byteOffset:r=0,byteLength:i=0,byteStride:o,count:s,mode:a,filter:l="NONE",buffer:u}=n,c=t.gltf.buffers[u],h=new Uint8Array(c.arrayBuffer,c.byteOffset+r,i),d=new Uint8Array(t.gltf.buffers[e.buffer].arrayBuffer,e.byteOffset,e.byteLength);await async function(t,e,n,r,i,o="NONE"){const s=await async function(){return Bt||(Bt=async function(){let t=Lt;WebAssembly.validate(Dt)&&(t=kt,console.log("Warning: meshopt_decoder is using experimental SIMD support"));const e=await WebAssembly.instantiate(function(t){const e=new Uint8Array(t.length);for(let n=0;n<t.length;++n){const r=t.charCodeAt(n);e[n]=r>96?r-71:r>64?r-65:r>47?r+4:r>46?63:62}let n=0;for(let r=0;r<t.length;++r)e[n++]=e[r]<60?Ft[e[r]]:64*(e[r]-60)+e[++r];return e.buffer.slice(0,n)}(t),{});return await e.instance.exports.__wasm_call_ctors(),e.instance}()),Bt}();!function(t,e,n,r,i,o,s){const a=t.exports.sbrk,l=r+3&-4,u=a(l*i),c=a(o.length),h=new Uint8Array(t.exports.memory.buffer);h.set(o,c);const d=e(u,r,i,c,o.length);if(0===d&&s&&s(u,l,i),n.set(h.subarray(u,u+r*i)),a(u-a(0)),0!==d)throw new Error(`Malformed buffer data: ${d}`)}(s,s.exports[jt[i]],t,e,n,r,s.exports[Nt[o||"NONE"]])}(d,s,o,h,a,l),t.removeObjectExtension(e,Gt)}}var Ht={};l(Ht,{name:()=>Jt,preprocess:()=>Yt});var qt=n(48043),Wt="EXT_texture_webp",Jt=Wt;function Yt(t,e){const n=new M(t);if(!(0,qt.isImageFormatSupported)("image/webp")){if(n.getRequiredExtensions().includes(Wt))throw new Error(`gltf: Required extension ${Wt} not supported by browser`);return}const{json:r}=n;for(const t of r.textures||[]){const e=n.getObjectExtension(t,Wt);e&&(t.source=e.source),n.removeObjectExtension(t,Wt)}n.removeExtension(Wt)}var Xt={};l(Xt,{name:()=>Zt,preprocess:()=>Qt});var Kt="KHR_texture_basisu",Zt=Kt;function Qt(t,e){const n=new M(t),{json:r}=n;for(const t of r.textures||[]){const e=n.getObjectExtension(t,Kt);e&&(t.source=e.source,n.removeObjectExtension(t,Kt))}n.removeExtension(Kt)}var $t={};l($t,{decode:()=>se,encode:()=>ae,name:()=>ie,preprocess:()=>oe});var te=n(63666),ee=n(73712);function ne(t){const{buffer:e,size:n,count:r}=function(t){let e=t,n=1,r=0;return t&&t.value&&(e=t.value,n=t.size||1),e&&(ArrayBuffer.isView(e)||(e=function(t,e,n=!1){return t?Array.isArray(t)?new e(t):!n||t instanceof e?t:new e(t):null}(e,Float32Array)),r=e.length/n),{buffer:e,size:n,count:r}}(t);return{value:e,size:n,byteOffset:0,count:r,type:w(n),componentType:C(e)}}var re="KHR_draco_mesh_compression",ie=re;function oe(t,e,n){const r=new M(t);for(const t of ce(r))r.getObjectExtension(t,re)}async function se(t,e,n){var r;if(!(null==(r=null==e?void 0:e.gltf)?void 0:r.decompressMeshes))return;const i=new M(t),o=[];for(const t of ce(i))i.getObjectExtension(t,re)&&o.push(le(i,t,e,n));await Promise.all(o),i.removeExtension(re)}function ae(t,e={}){const n=new M(t);for(const t of n.json.meshes||[])ue(t),n.addRequiredExtension(re)}async function le(t,e,n,r){const i=t.getObjectExtension(e,re);if(!i)return;const o=t.getTypedArrayForBufferView(i.bufferView),s=(0,te.sliceArrayBuffer)(o.buffer,o.byteOffset),a={...n};delete a["3d-tiles"];const l=await(0,te.parseFromContext)(s,ee.DracoLoader,a,r),u=function(t){const e={};for(const n in t){const r=t[n];if("indices"!==n){const t=ne(r);e[n]=t}}return e}(l.attributes);for(const[n,r]of Object.entries(u))if(n in e.attributes){const i=e.attributes[n],o=t.getAccessor(i);(null==o?void 0:o.min)&&(null==o?void 0:o.max)&&(r.min=o.min,r.max=o.max)}e.attributes=u,l.indices&&(e.indices=ne(l.indices)),t.removeObjectExtension(e,re),function(t){if(!t.attributes&&Object.keys(t.attributes).length>0)throw new Error("glTF: Empty primitive detected: Draco decompression failure?")}(e)}function ue(t,e,n=4,r,i){var o;if(!r.DracoWriter)throw new Error("options.gltf.DracoWriter not provided");const s=r.DracoWriter.encodeSync({attributes:t}),a=null==(o=null==i?void 0:i.parseSync)?void 0:o.call(i,{attributes:t}),l=r._addFauxAttributes(a.attributes),u=r.addBufferView(s);return{primitives:[{attributes:l,mode:n,extensions:{[re]:{bufferView:u,attributes:l}}}]}}function*ce(t){for(const e of t.json.meshes||[])for(const t of e.primitives)yield t}var he={};l(he,{decode:()=>ve,name:()=>pe});var de=n(54054),fe="KHR_texture_transform",pe=fe,ge=new de.Vector3,ye=new de.Matrix3,me=new de.Matrix3;async function ve(t,e){var n;if(!new M(t).hasExtension(fe)||!(null==(n=e.gltf)?void 0:n.loadBuffers))return;const r=t.json.materials||[];for(let e=0;e<r.length;e++)be(e,t)}function be(t,e){var n,r,i,o;const s=null==(n=e.json.materials)?void 0:n[t],a=[null==(r=null==s?void 0:s.pbrMetallicRoughness)?void 0:r.baseColorTexture,null==s?void 0:s.emissiveTexture,null==s?void 0:s.normalTexture,null==s?void 0:s.occlusionTexture,null==(i=null==s?void 0:s.pbrMetallicRoughness)?void 0:i.metallicRoughnessTexture],l=[];for(const n of a)n&&(null==(o=null==n?void 0:n.extensions)?void 0:o[fe])&&_e(e,t,n,l)}function _e(t,e,n,r){const i=function(t,e){var n;const r=null==(n=t.extensions)?void 0:n[fe],{texCoord:i=0}=t,{texCoord:o=i}=r;if(!(-1!==e.findIndex((([t,e])=>t===i&&e===o)))){const n=function(t){const{offset:e=[0,0],rotation:n=0,scale:r=[1,1]}=t,i=(new de.Matrix3).set(1,0,0,0,1,0,e[0],e[1],1),o=ye.set(Math.cos(n),Math.sin(n),0,-Math.sin(n),Math.cos(n),0,0,0,1),s=me.set(r[0],0,0,0,r[1],0,0,0,1);return i.multiplyRight(o).multiplyRight(s)}(r);return i!==o&&(t.texCoord=o),e.push([i,o]),{originalTexCoord:i,texCoord:o,matrix:n}}return null}(n,r);if(!i)return;const o=t.json.meshes||[];for(const n of o)for(const r of n.primitives){const n=r.material;Number.isFinite(n)&&e===n&&Ae(t,r,i)}}function Ae(t,e,n){var r,i;const{originalTexCoord:o,texCoord:s,matrix:a}=n,l=e.attributes[`TEXCOORD_${o}`];if(Number.isFinite(l)){const n=null==(r=t.json.accessors)?void 0:r[l];if(n&&n.bufferView){const r=null==(i=t.json.bufferViews)?void 0:i[n.bufferView];if(r){const{arrayBuffer:i,byteOffset:l}=t.buffers[r.buffer],u=(l||0)+(n.byteOffset||0)+(r.byteOffset||0),{ArrayType:c,length:h}=S(n,r),d=g[n.componentType],f=p[n.type],y=r.byteStride||d*f,m=new Float32Array(h);for(let t=0;t<n.count;t++){const e=new c(i,u+t*y,2);ge.set(e[0],e[1],1),ge.transformByMatrix3(a),m.set([ge[0],ge[1]],t*f)}o===s?function(t,e,n,r){t.componentType=5126,n.push({arrayBuffer:r.buffer,byteOffset:0,byteLength:r.buffer.byteLength}),e.buffer=n.length-1,e.byteLength=r.buffer.byteLength,e.byteOffset=0,delete e.byteStride}(n,r,t.buffers,m):function(t,e,n,r,i){r.buffers.push({arrayBuffer:i.buffer,byteOffset:0,byteLength:i.buffer.byteLength});const o=r.json.bufferViews;if(!o)return;o.push({buffer:r.buffers.length-1,byteLength:i.buffer.byteLength,byteOffset:0});const s=r.json.accessors;s&&(s.push({bufferView:(null==o?void 0:o.length)-1,byteOffset:0,componentType:5126,count:e.count,type:"VEC2"}),n.attributes[`TEXCOORD_${t}`]=s.length-1)}(s,n,e,t,m)}}}}var xe={};l(xe,{decode:()=>Se,encode:()=>Ee,name:()=>Ce});var we="KHR_lights_punctual",Ce=we;async function Se(t){const e=new M(t),{json:n}=e,r=e.getExtension(we);r&&(e.json.lights=r.lights,e.removeExtension(we));for(const t of n.nodes||[]){const n=e.getObjectExtension(t,we);n&&(t.light=n.light),e.removeObjectExtension(t,we)}}async function Ee(t){const e=new M(t),{json:n}=e;if(n.lights){const t=e.addExtension(we);f(!t.lights),t.lights=n.lights,delete n.lights}if(e.json.lights){for(const t of e.json.lights){const n=t.node;e.addObjectExtension(n,we,t)}delete e.json.lights}}var Me={};l(Me,{decode:()=>Oe,encode:()=>Ie,name:()=>Te});var Pe="KHR_materials_unlit",Te=Pe;async function Oe(t){const e=new M(t),{json:n}=e;for(const t of n.materials||[])t.extensions&&t.extensions.KHR_materials_unlit&&(t.unlit=!0),e.removeObjectExtension(t,Pe);e.removeExtension(Pe)}function Ie(t){const e=new M(t),{json:n}=e;if(e.materials)for(const t of n.materials||[])t.unlit&&(delete t.unlit,e.addObjectExtension(t,Pe,{}),e.addExtension(Pe))}var Re={};l(Re,{decode:()=>ke,encode:()=>De,name:()=>Le});var Be="KHR_techniques_webgl",Le=Be;async function ke(t){const e=new M(t),{json:n}=e,r=e.getExtension(Be);if(r){const t=function(t,e){const{programs:n=[],shaders:r=[],techniques:i=[]}=t,o=new TextDecoder;return r.forEach((t=>{if(!Number.isFinite(t.bufferView))throw new Error("KHR_techniques_webgl: no shader code");t.code=o.decode(e.getTypedArrayForBufferView(t.bufferView))})),n.forEach((t=>{t.fragmentShader=r[t.fragmentShader],t.vertexShader=r[t.vertexShader]})),i.forEach((t=>{t.program=n[t.program]})),i}(r,e);for(const r of n.materials||[]){const n=e.getObjectExtension(r,Be);n&&(r.technique=Object.assign({},n,t[n.technique]),r.technique.values=Fe(r.technique,e)),e.removeObjectExtension(r,Be)}e.removeExtension(Be)}}async function De(t,e){}function Fe(t,e){const n=Object.assign({},t.values);return Object.keys(t.uniforms||{}).forEach((e=>{t.uniforms[e].value&&!(e in n)&&(n[e]=t.uniforms[e].value)})),Object.keys(n).forEach((t=>{"object"==typeof n[t]&&void 0!==n[t].index&&(n[t].texture=e.getTexture(n[t].index))})),n}var Ne=[W,c,Rt,Ht,Xt,$t,xe,Me,Re,he,rt];function je(t,e){var n;const r=(null==(n=null==e?void 0:e.gltf)?void 0:n.excludeExtensions)||{};return!(t in r&&!r[t])}var Ge="KHR_binary_glTF",Ue={accessors:"accessor",animations:"animation",buffers:"buffer",bufferViews:"bufferView",images:"image",materials:"material",meshes:"mesh",nodes:"node",samplers:"sampler",scenes:"scene",skins:"skin",textures:"texture"},ze={accessor:"accessors",animations:"animation",buffer:"buffers",bufferView:"bufferViews",image:"images",material:"materials",mesh:"meshes",node:"nodes",sampler:"samplers",scene:"scenes",skin:"skins",texture:"textures"},Ve=class{idToIndexMap={animations:{},accessors:{},buffers:{},bufferViews:{},images:{},materials:{},meshes:{},nodes:{},samplers:{},scenes:{},skins:{},textures:{}};json;normalize(t,e){this.json=t.json;const n=t.json;switch(n.asset&&n.asset.version){case"2.0":return;case void 0:case"1.0":break;default:return void console.warn(`glTF: Unknown version ${n.asset.version}`)}if(!e.normalize)throw new Error("glTF v1 is not supported.");console.warn("Converting glTF v1 to glTF v2 format. This is experimental and may fail."),this._addAsset(n),this._convertTopLevelObjectsToArrays(n),function(t){const e=new M(t),{json:n}=e;for(const t of n.images||[]){const n=e.getObjectExtension(t,Ge);n&&Object.assign(t,n),e.removeObjectExtension(t,Ge)}n.buffers&&n.buffers[0]&&delete n.buffers[0].uri,e.removeExtension(Ge)}(t),this._convertObjectIdsToArrayIndices(n),this._updateObjects(n),this._updateMaterial(n)}_addAsset(t){t.asset=t.asset||{},t.asset.version="2.0",t.asset.generator=t.asset.generator||"Normalized to glTF 2.0 by loaders.gl"}_convertTopLevelObjectsToArrays(t){for(const e in Ue)this._convertTopLevelObjectToArray(t,e)}_convertTopLevelObjectToArray(t,e){const n=t[e];if(n&&!Array.isArray(n)){t[e]=[];for(const r in n){const i=n[r];i.id=i.id||r;const o=t[e].length;t[e].push(i),this.idToIndexMap[e][r]=o}}}_convertObjectIdsToArrayIndices(t){for(const e in Ue)this._convertIdsToIndices(t,e);"scene"in t&&(t.scene=this._convertIdToIndex(t.scene,"scene"));for(const e of t.textures)this._convertTextureIds(e);for(const e of t.meshes)this._convertMeshIds(e);for(const e of t.nodes)this._convertNodeIds(e);for(const e of t.scenes)this._convertSceneIds(e)}_convertTextureIds(t){t.source&&(t.source=this._convertIdToIndex(t.source,"image"))}_convertMeshIds(t){for(const e of t.primitives){const{attributes:t,indices:n,material:r}=e;for(const e in t)t[e]=this._convertIdToIndex(t[e],"accessor");n&&(e.indices=this._convertIdToIndex(n,"accessor")),r&&(e.material=this._convertIdToIndex(r,"material"))}}_convertNodeIds(t){t.children&&(t.children=t.children.map((t=>this._convertIdToIndex(t,"node")))),t.meshes&&(t.meshes=t.meshes.map((t=>this._convertIdToIndex(t,"mesh"))))}_convertSceneIds(t){t.nodes&&(t.nodes=t.nodes.map((t=>this._convertIdToIndex(t,"node"))))}_convertIdsToIndices(t,e){t[e]||(console.warn(`gltf v1: json doesn't contain attribute ${e}`),t[e]=[]);for(const n of t[e])for(const t in n){const e=n[t],r=this._convertIdToIndex(e,t);n[t]=r}}_convertIdToIndex(t,e){const n=ze[e];if(n in this.idToIndexMap){const r=this.idToIndexMap[n][t];if(!Number.isFinite(r))throw new Error(`gltf v1: failed to resolve ${e} with id ${t}`);return r}return t}_updateObjects(t){for(const t of this.json.buffers)delete t.type}_updateMaterial(t){var e,n,r;for(const i of t.materials){i.pbrMetallicRoughness={baseColorFactor:[1,1,1,1],metallicFactor:1,roughnessFactor:1};const o=(null==(e=i.values)?void 0:e.tex)||(null==(n=i.values)?void 0:n.texture2d_0)||(null==(r=i.values)?void 0:r.diffuseTex),s=t.textures.findIndex((t=>t.id===o));-1!==s&&(i.pbrMetallicRoughness.baseColorTexture={index:s})}}};async function He(t,e,n,r,i){let o;if(e.uri&&!e.hasOwnProperty("bufferView")){const t=It(e.uri,r),{fetch:n}=i,s=await n(t);o=await s.arrayBuffer(),e.bufferView={data:o}}if(Number.isFinite(e.bufferView)){const n=function(t,e,n){const r=t.bufferViews[n];f(r);const i=e[r.buffer];f(i);const o=(r.byteOffset||0)+i.byteOffset;return new Uint8Array(i.arrayBuffer,o,r.byteLength)}(t.json,t.buffers,e.bufferView);o=(0,gt.sliceArrayBuffer)(n.buffer,n.byteOffset,n.byteLength)}f(o,"glTF image has no data");let s=await(0,gt.parseFromContext)(o,[yt.ImageLoader,mt.BasisLoader],{...r,mimeType:e.mimeType,basis:r.basis||{format:(0,mt.selectSupportedBasisFormat)()}},i);s&&s[0]&&(s={compressed:!0,mipmaps:!1,width:s[0].width,height:s[0].height,data:s[0]}),t.images=t.images||[],t.images[n]=s}var qe={dataType:null,batchType:null,name:"glTF",id:"gltf",module:"gltf",version:pt,extensions:["gltf","glb"],mimeTypes:["model/gltf+json","model/gltf-binary"],text:!0,binary:!0,tests:["glTF"],parse:async function(t,e={},n){(e={...qe.options,...e}).gltf={...qe.options.gltf,...e.gltf};const{byteOffset:r=0}=e;return await async function(t,e,n=0,r,i){var o,s,a;return function(t,e,n,r){if(r.uri&&(t.baseUri=r.uri),e instanceof ArrayBuffer&&!function(t,e=0,n={}){const r=new DataView(t),{magic:i=_t}=n,o=r.getUint32(e,!1);return o===i||o===_t}(e,n,r)&&(e=(new TextDecoder).decode(e)),"string"==typeof e)t.json=(0,gt.parseJSON)(e);else if(e instanceof ArrayBuffer){const i={};n=Pt(i,e,n,r.glb),f("glTF"===i.type,`Invalid GLB magic string ${i.type}`),t._glb=i,t.json=i.json}else f(!1,"GLTF: must be ArrayBuffer or string");const i=t.json.buffers||[];if(t.buffers=new Array(i.length).fill(null),t._glb&&t._glb.header.hasBinChunk){const{binChunks:e}=t._glb;t.buffers[0]={arrayBuffer:e[0].arrayBuffer,byteOffset:e[0].byteOffset,byteLength:e[0].byteLength}}const o=t.json.images||[];t.images=new Array(o.length).fill({})}(t,e,n,r),function(t,e={}){(new Ve).normalize(t,e)}(t,{normalize:null==(o=null==r?void 0:r.gltf)?void 0:o.normalize}),function(t,e={},n){var r;const i=Ne.filter((t=>je(t.name,e)));for(const o of i)null==(r=o.preprocess)||r.call(o,t,e,n)}(t,r,i),(null==(s=null==r?void 0:r.gltf)?void 0:s.loadBuffers)&&t.json.buffers&&await async function(t,e,n){var r,i;const o=t.json.buffers||[];for(let s=0;s<o.length;++s){const a=o[s];if(a.uri){const{fetch:o}=n;f(o);const l=It(a.uri,e),u=await(null==(r=null==n?void 0:n.fetch)?void 0:r.call(n,l)),c=await(null==(i=null==u?void 0:u.arrayBuffer)?void 0:i.call(u));t.buffers[s]={arrayBuffer:c,byteOffset:0,byteLength:c.byteLength},delete a.uri}else null===t.buffers[s]&&(t.buffers[s]={arrayBuffer:new ArrayBuffer(a.byteLength),byteOffset:0,byteLength:a.byteLength})}}(t,r,i),(null==(a=null==r?void 0:r.gltf)?void 0:a.loadImages)&&await async function(t,e,n){const r=function(t){const e=new Set,n=t.json.textures||[];for(const t of n)void 0!==t.source&&e.add(t.source);return Array.from(e).sort()}(t),i=t.json.images||[],o=[];for(const s of r)o.push(He(t,i[s],s,e,n));return await Promise.all(o)}(t,r,i),await async function(t,e={},n){var r;const i=Ne.filter((t=>je(t.name,e)));for(const o of i)await(null==(r=o.decode)?void 0:r.call(o,t,e,n))}(t,r,i),t}({},t,r,e,n)},options:{gltf:{normalize:!0,loadBuffers:!0,loadImages:!0,decompressMeshes:!0},log:console}},We=n(63666),Je=1179937895,Ye=1313821514,Xe=5130562,Ke=!0;function Ze(t,e,n=0,r={}){const{magic:i=Je,version:o=2,json:s={},binary:a}=t,l=n;e&&(e.setUint32(n+0,i,Ke),e.setUint32(n+4,o,Ke),e.setUint32(n+8,0,Ke));const u=n+8,c=n+=12;e&&(e.setUint32(n+0,0,Ke),e.setUint32(n+4,Ye,Ke)),n+=8;const h=JSON.stringify(s);if(n=(0,We.copyPaddedStringToDataView)(e,n,h,4),e){const t=n-c-8;e.setUint32(c+0,t,Ke)}if(a){const t=n;if(e&&(e.setUint32(n+0,0,Ke),e.setUint32(n+4,Xe,Ke)),n+=8,n=(0,We.copyPaddedArrayBufferToDataView)(e,n,a,4),e){const r=n-t-8;e.setUint32(t+0,r,Ke)}}if(e){const t=n-l;e.setUint32(u,t,Ke)}return n}function Qe(t,e,n,r){return function(t,{firstBuffer:e=0}={}){if(t.buffers&&t.buffers.length>e)throw new Error("encodeGLTF: multiple buffers not yet implemented")}(t),Ze(t,e,n,r)}var $e={dataType:null,batchType:null,name:"glTF",id:"gltf",module:"gltf",version:pt,extensions:["glb"],mimeTypes:["model/gltf-binary"],binary:!0,options:{gltf:{}},encode:async(t,e={})=>tn(t,e),encodeSync:tn};function tn(t,e={}){const{byteOffset:n=0}=e,r=Qe(t,null,n,e),i=new ArrayBuffer(r);return Qe(t,new DataView(i),n,e),i}var en={dataType:null,batchType:null,name:"GLB",id:"glb",module:"gltf",version:pt,extensions:["glb"],mimeTypes:["model/gltf-binary"],binary:!0,parse:async function(t,e){return nn(t,e)},parseSync:nn,options:{glb:{strict:!1}}};function nn(t,e){const{byteOffset:n=0}=e||{},r={};return Pt(r,t,n,null==e?void 0:e.glb),r}var rn={name:"GLB",id:"glb",module:"gltf",version:pt,extensions:["glb"],mimeTypes:["model/gltf-binary"],binary:!0,options:{glb:{}},encode:async(t,e={})=>on(t,e),encodeSync:on};function on(t,e){const{byteOffset:n=0}=e,r=Ze(t,null,n,e),i=new ArrayBuffer(r);return Ze(t,new DataView(i),n,e),i}var sn={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},an={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},ln=10240,un=10241,cn=10242,hn=10243,dn={magFilter:10240,minFilter:10241,wrapS:10242,wrapT:10243},fn={[ln]:9729,[un]:9986,[cn]:10497,[hn]:10497},pn=class{baseUri="";jsonUnprocessed;json;buffers=[];images=[];postProcess(t,e={}){const{json:n,buffers:r=[],images:i=[]}=t,{baseUri:o=""}=t;return f(n),this.baseUri=o,this.buffers=r,this.images=i,this.jsonUnprocessed=n,this.json=this._resolveTree(t.json,e),this.json}_resolveTree(t,e={}){const n={...t};return this.json=n,t.bufferViews&&(n.bufferViews=t.bufferViews.map(((t,e)=>this._resolveBufferView(t,e)))),t.images&&(n.images=t.images.map(((t,e)=>this._resolveImage(t,e)))),t.samplers&&(n.samplers=t.samplers.map(((t,e)=>this._resolveSampler(t,e)))),t.textures&&(n.textures=t.textures.map(((t,e)=>this._resolveTexture(t,e)))),t.accessors&&(n.accessors=t.accessors.map(((t,e)=>this._resolveAccessor(t,e)))),t.materials&&(n.materials=t.materials.map(((t,e)=>this._resolveMaterial(t,e)))),t.meshes&&(n.meshes=t.meshes.map(((t,e)=>this._resolveMesh(t,e)))),t.nodes&&(n.nodes=t.nodes.map(((t,e)=>this._resolveNode(t,e))),n.nodes=n.nodes.map(((t,e)=>this._resolveNodeChildren(t)))),t.skins&&(n.skins=t.skins.map(((t,e)=>this._resolveSkin(t,e)))),t.scenes&&(n.scenes=t.scenes.map(((t,e)=>this._resolveScene(t,e)))),"number"==typeof this.json.scene&&n.scenes&&(n.scene=n.scenes[this.json.scene]),n}getScene(t){return this._get(this.json.scenes,t)}getNode(t){return this._get(this.json.nodes,t)}getSkin(t){return this._get(this.json.skins,t)}getMesh(t){return this._get(this.json.meshes,t)}getMaterial(t){return this._get(this.json.materials,t)}getAccessor(t){return this._get(this.json.accessors,t)}getCamera(t){return this._get(this.json.cameras,t)}getTexture(t){return this._get(this.json.textures,t)}getSampler(t){return this._get(this.json.samplers,t)}getImage(t){return this._get(this.json.images,t)}getBufferView(t){return this._get(this.json.bufferViews,t)}getBuffer(t){return this._get(this.json.buffers,t)}_get(t,e){if("object"==typeof e)return e;const n=t&&t[e];return n||console.warn(`glTF file error: Could not find ${t}[${e}]`),n}_resolveScene(t,e){return{...t,id:t.id||`scene-${e}`,nodes:(t.nodes||[]).map((t=>this.getNode(t)))}}_resolveNode(t,e){const n={...t,id:(null==t?void 0:t.id)||`node-${e}`};return void 0!==t.mesh&&(n.mesh=this.getMesh(t.mesh)),void 0!==t.camera&&(n.camera=this.getCamera(t.camera)),void 0!==t.skin&&(n.skin=this.getSkin(t.skin)),void 0!==t.meshes&&t.meshes.length&&(n.mesh=t.meshes.reduce(((t,e)=>{const n=this.getMesh(e);return t.id=n.id,t.primitives=t.primitives.concat(n.primitives),t}),{primitives:[]})),n}_resolveNodeChildren(t){return t.children&&(t.children=t.children.map((t=>this.getNode(t)))),t}_resolveSkin(t,e){const n="number"==typeof t.inverseBindMatrices?this.getAccessor(t.inverseBindMatrices):void 0;return{...t,id:t.id||`skin-${e}`,inverseBindMatrices:n}}_resolveMesh(t,e){const n={...t,id:t.id||`mesh-${e}`,primitives:[]};return t.primitives&&(n.primitives=t.primitives.map((t=>{const e={...t,attributes:{},indices:void 0,material:void 0},n=t.attributes;for(const t in n)e.attributes[t]=this.getAccessor(n[t]);return void 0!==t.indices&&(e.indices=this.getAccessor(t.indices)),void 0!==t.material&&(e.material=this.getMaterial(t.material)),e}))),n}_resolveMaterial(t,e){const n={...t,id:t.id||`material-${e}`};if(n.normalTexture&&(n.normalTexture={...n.normalTexture},n.normalTexture.texture=this.getTexture(n.normalTexture.index)),n.occlusionTexture&&(n.occlusionTexture={...n.occlusionTexture},n.occlusionTexture.texture=this.getTexture(n.occlusionTexture.index)),n.emissiveTexture&&(n.emissiveTexture={...n.emissiveTexture},n.emissiveTexture.texture=this.getTexture(n.emissiveTexture.index)),n.emissiveFactor||(n.emissiveFactor=n.emissiveTexture?[1,1,1]:[0,0,0]),n.pbrMetallicRoughness){n.pbrMetallicRoughness={...n.pbrMetallicRoughness};const t=n.pbrMetallicRoughness;t.baseColorTexture&&(t.baseColorTexture={...t.baseColorTexture},t.baseColorTexture.texture=this.getTexture(t.baseColorTexture.index)),t.metallicRoughnessTexture&&(t.metallicRoughnessTexture={...t.metallicRoughnessTexture},t.metallicRoughnessTexture.texture=this.getTexture(t.metallicRoughnessTexture.index))}return n}_resolveAccessor(t,e){const n=(r=t.componentType,an[r]);var r;const i=(o=t.type,sn[o]);var o;const s=n*i,a={...t,id:t.id||`accessor-${e}`,bytesPerComponent:n,components:i,bytesPerElement:s,value:void 0,bufferView:void 0,sparse:void 0};if(void 0!==t.bufferView&&(a.bufferView=this.getBufferView(t.bufferView)),a.bufferView){const t=a.bufferView.buffer,{ArrayType:e,byteLength:n}=S(a,a.bufferView),r=(a.bufferView.byteOffset||0)+(a.byteOffset||0)+t.byteOffset;let i=t.arrayBuffer.slice(r,r+n);a.bufferView.byteStride&&(i=this._getValueFromInterleavedBuffer(t,r,a.bufferView.byteStride,a.bytesPerElement,a.count)),a.value=new e(i)}return a}_getValueFromInterleavedBuffer(t,e,n,r,i){const o=new Uint8Array(i*r);for(let s=0;s<i;s++){const i=e+s*n;o.set(new Uint8Array(t.arrayBuffer.slice(i,i+r)),s*r)}return o.buffer}_resolveTexture(t,e){return{...t,id:t.id||`texture-${e}`,sampler:"number"==typeof t.sampler?this.getSampler(t.sampler):{id:"default-sampler",parameters:fn},source:"number"==typeof t.source?this.getImage(t.source):void 0}}_resolveSampler(t,e){const n={id:t.id||`sampler-${e}`,...t,parameters:{}};for(const t in n){const e=this._enumSamplerParameter(t);void 0!==e&&(n.parameters[e]=n[t])}return n}_enumSamplerParameter(t){return dn[t]}_resolveImage(t,e){const n={...t,id:t.id||`image-${e}`,image:null,bufferView:void 0!==t.bufferView?this.getBufferView(t.bufferView):void 0},r=this.images[e];return r&&(n.image=r),n}_resolveBufferView(t,e){const n=t.buffer,r=this.buffers[n].arrayBuffer;let i=this.buffers[n].byteOffset||0;return t.byteOffset&&(i+=t.byteOffset),{id:`bufferView-${e}`,...t,buffer:this.buffers[n],data:new Uint8Array(r,i,t.byteLength)}}_resolveCamera(t,e){const n={...t,id:t.id||`camera-${e}`};return n.perspective,n.orthographic,n}};function gn(t,e){return(new pn).postProcess(t,e)}},48043:(t,e,n)=>{"use strict";var r,i=Object.defineProperty,o=Object.getOwnPropertyDescriptor,s=Object.getOwnPropertyNames,a=Object.prototype.hasOwnProperty,l={};((t,e)=>{for(var n in e)i(t,n,{get:e[n],enumerable:!0})})(l,{ImageLoader:()=>N,ImageWriter:()=>U,getBinaryImageMetadata:()=>k,getDefaultImageType:()=>b,getImageData:()=>w,getImageSize:()=>x,getImageType:()=>A,getSupportedImageFormats:()=>q,isImage:()=>_,isImageFormatSupported:()=>J,isImageTypeSupported:()=>v,loadImage:()=>Z}),t.exports=(r=l,((t,e,n,r)=>{if(e&&"object"==typeof e||"function"==typeof e)for(let n of s(e))a.call(t,n)||undefined===n||i(t,n,{get:()=>e[n],enumerable:!(r=o(e,n))||r.enumerable});return t})(i({},"__esModule",{value:!0}),r));var u,c="4.2.1",h=n(63666),d=n(63666),f=null==(u=globalThis.loaders)?void 0:u.parseImageNode,p="undefined"!=typeof Image,g="undefined"!=typeof ImageBitmap,y=Boolean(f),m=!!d.isBrowser||y;function v(t){switch(t){case"auto":return g||p||m;case"imagebitmap":return g;case"image":return p;case"data":return m;default:throw new Error(`@loaders.gl/images: image ${t} not supported in this environment`)}}function b(){if(g)return"imagebitmap";if(p)return"image";if(m)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}function _(t){return Boolean(C(t))}function A(t){const e=C(t);if(!e)throw new Error("Not an image");return e}function x(t){return w(t)}function w(t){switch(A(t)){case"data":return t;case"image":case"imagebitmap":const e=document.createElement("canvas"),n=e.getContext("2d");if(!n)throw new Error("getImageData");return e.width=t.width,e.height=t.height,n.drawImage(t,0,0),n.getImageData(0,0,t.width,t.height);default:throw new Error("getImageData")}}function C(t){return"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap?"imagebitmap":"undefined"!=typeof Image&&t instanceof Image?"image":t&&"object"==typeof t&&t.data&&t.width&&t.height?"data":null}var S=/^data:image\/svg\+xml/,E=/\.svg((\?|#).*)?$/;function M(t){return t&&(S.test(t)||E.test(t))}function P(t,e){if(M(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(t)])}async function T(t,e,n){const r=function(t,e){if(M(e)){let e=(new TextDecoder).decode(t);try{"function"==typeof unescape&&"function"==typeof encodeURIComponent&&(e=unescape(encodeURIComponent(e)))}catch(t){throw new Error(t.message)}return`data:image/svg+xml;base64,${btoa(e)}`}return P(t,e)}(t,n),i=self.URL||self.webkitURL,o="string"!=typeof r&&i.createObjectURL(r);try{return await async function(t,e){const n=new Image;return n.src=t,e.image&&e.image.decode&&n.decode?(await n.decode(),n):await new Promise(((t,e)=>{try{n.onload=()=>t(n),n.onerror=t=>{const n=t instanceof Error?t.message:"error";e(new Error(n))}}catch(t){e(t)}}))}(o||r,e)}finally{o&&i.revokeObjectURL(o)}}var O={},I=!0;var R=n(63666);var B=!1,L=!0;function k(t){const e=D(t);return function(t){const e=D(t);return e.byteLength>=24&&2303741511===e.getUint32(0,B)?{mimeType:"image/png",width:e.getUint32(16,B),height:e.getUint32(20,B)}:null}(e)||function(t){const e=D(t);if(!(e.byteLength>=3&&65496===e.getUint16(0,B)&&255===e.getUint8(2)))return null;const{tableMarkers:n,sofMarkers:r}=function(){const t=new Set([65499,65476,65484,65501,65534]);for(let e=65504;e<65520;++e)t.add(e);return{tableMarkers:t,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}();let i=2;for(;i+9<e.byteLength;){const t=e.getUint16(i,B);if(r.has(t))return{mimeType:"image/jpeg",height:e.getUint16(i+5,B),width:e.getUint16(i+7,B)};if(!n.has(t))return null;i+=2,i+=e.getUint16(i,B)}return null}(e)||function(t){const e=D(t);return e.byteLength>=10&&1195984440===e.getUint32(0,B)?{mimeType:"image/gif",width:e.getUint16(6,L),height:e.getUint16(8,L)}:null}(e)||function(t){const e=D(t);return e.byteLength>=14&&16973===e.getUint16(0,B)&&e.getUint32(2,L)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,L),height:e.getUint32(22,L)}:null}(e)||function(t){const e=function(t){return function(t,e,n=0){const r=(i="ftyp",[...i].map((t=>t.charCodeAt(0))));var i;for(let e=0;e<r.length;++e)if(r[e]!==t[e+n])return!1;return!0}(t,0,4)&&96&t[8]?function(t){switch((e=t,String.fromCharCode(...e.slice(8,12))).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}var e}(t):null}(new Uint8Array(t instanceof DataView?t.buffer:t));return e?{mimeType:e.mimeType,width:0,height:0}:null}(e)}function D(t){if(t instanceof DataView)return t;if(ArrayBuffer.isView(t))return new DataView(t.buffer);if(t instanceof ArrayBuffer)return new DataView(t);throw new Error("toDataView")}var F,N={dataType:null,batchType:null,id:"image",module:"images",name:"Images",version:c,mimeTypes:["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],extensions:["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],parse:async function(t,e,n){const r=((e=e||{}).image||{}).type||"auto",{url:i}=n||{};let o;switch(function(t){switch(t){case"auto":case"data":return b();default:return v(t),t}}(r)){case"imagebitmap":o=await async function(t,e,n){let r;r=M(n)?await T(t,e,n):P(t,n);const i=e&&e.imagebitmap;return await async function(t,e=null){if(!function(t){for(const e in t||O)return!1;return!0}(e)&&I||(e=null),e)try{return await createImageBitmap(t,e)}catch(t){console.warn(t),I=!1}return await createImageBitmap(t)}(r,i)}(t,e,i);break;case"image":o=await T(t,e,i);break;case"data":o=await async function(t){var e;const{mimeType:n}=k(t)||{},r=null==(e=globalThis.loaders)?void 0:e.parseImageNode;return(0,R.assert)(r),await r(t,n)}(t);break;default:(0,h.assert)(!1)}return"data"===r&&(o=w(o)),o},tests:[t=>Boolean(k(new DataView(t)))],options:{image:{type:"auto",decode:!0}}},j=null==(F=globalThis.loaders)?void 0:F.encodeImageNode,G=!0,U={name:"Images",id:"image",module:"images",version:c,extensions:["jpeg"],options:{image:{mimeType:"image/png",jpegQuality:null}},encode:async function(t,e){return(e=e||{}).image=e.image||{},j?j(t,{type:e.image.mimeType}):async function(t,e){const{mimeType:n,jpegQuality:r}=e.image,{width:i,height:o}=x(t),s=document.createElement("canvas");s.width=i,s.height=o,function(t,e,n=0,r=0){if(0===n&&0===r&&"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap){const n=e.getContext("bitmaprenderer");if(n)return n.transferFromImageBitmap(t),e}const i=e.getContext("2d");if(t.data){const n=new Uint8ClampedArray(t.data),r=new ImageData(n,t.width,t.height);return i.putImageData(r,0,0),e}i.drawImage(t,0,0)}(t,s);const a=await new Promise((t=>{if(r&&G)try{return void s.toBlob(t,n,r)}catch(t){G=!1}s.toBlob(t,n)}));if(!a)throw new Error("image encoding failed");return await a.arrayBuffer()}(t,e)}},z=n(63666),V=["image/png","image/jpeg","image/gif","image/webp","image/avif","image/tiff","image/svg","image/svg+xml","image/bmp","image/vnd.microsoft.icon"],H=null;async function q(){if(H)return await H;const t=new Set;for(const e of V)(z.isBrowser?await K(e):Y(e))&&t.add(e);return t}var W={};function J(t){if(void 0===W[t]){const e=z.isBrowser?function(t){switch(t){case"image/avif":case"image/webp":return function(t){try{return 0===document.createElement("canvas").toDataURL(t).indexOf(`data:${t}`)}catch{return!1}}(t);default:return!0}}(t):Y(t);W[t]=e}return W[t]}function Y(t){var e,n;const r=(null==(e=globalThis.loaders)?void 0:e.imageFormatsNode)||["image/png","image/jpeg","image/gif"],i=null==(n=globalThis.loaders)?void 0:n.parseImageNode;return Boolean(i)&&r.includes(t)}var X={"image/avif":"data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A=","image/webp":"data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA"};async function K(t){const e=X[t];return!e||await async function(t){return new Promise((e=>{const n=new Image;n.src=t,n.onload=()=>e(n.height>0),n.onerror=()=>e(!1)}))}(e)}function Z(){throw new Error("loadImage has moved to @loaders.gl/textures")}},63666:(t,e,n)=>{"use strict";var r,i=n(65606),o=Object.defineProperty,s=Object.getOwnPropertyDescriptor,a=Object.getOwnPropertyNames,l=Object.prototype.hasOwnProperty,u=(t,e)=>{for(var n in e)o(t,n,{get:e[n],enumerable:!0})},c=(t,e,n)=>(((t,e,n)=>{e in t?o(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n})(t,"symbol"!=typeof e?e+"":e,n),n),h={};async function d(t,e,n,r){return r._parse(t,e,n,r)}function f(t,e,n,r){if(!r._parseSync)throw new Error("parseSync");return r._parseSync(t,e,n,r)}async function p(t,e,n,r){if(!r._parseInBatches)throw new Error("parseInBatches");return r._parseInBatches(t,e,n,r)}function g(t,e){if(!t)throw new Error(e||"loader assertion failed.")}u(h,{BlobFile:()=>Nt,DataSource:()=>Yt,DataViewFile:()=>Jt,FileHandleFile:()=>qt,HttpFile:()=>jt,ImageSource:()=>Xt,JSONLoader:()=>_t,NodeFile:()=>Ut,NodeFilesystem:()=>Vt,RequestScheduler:()=>ft,_addAliases:()=>vt,assert:()=>g,canEncodeWithWorker:()=>z,canParseWithWorker:()=>N,checkJSModule:()=>T,compareArrayBuffers:()=>W,concatenateArrayBuffers:()=>J,concatenateArrayBuffersAsync:()=>ct,concatenateArrayBuffersFromArray:()=>Y,concatenateTypedArrays:()=>X,copyArrayBuffer:()=>Q,copyBinaryToDataView:()=>nt,copyPaddedArrayBufferToDataView:()=>rt,copyPaddedStringToDataView:()=>it,copyStringToDataView:()=>et,copyToArray:()=>$,createLoaderWorker:()=>L,document:()=>_,forEach:()=>ut,getFirstCharacters:()=>V,getJSModule:()=>O,getJSModuleOrNull:()=>I,getMagicString:()=>H,getPathPrefix:()=>mt,global:()=>b,isBrowser:()=>A,isBuffer:()=>wt,isFileProvider:()=>Ht,isWorker:()=>x,log:()=>S,makeLineIterator:()=>at,makeNumberedLineIterator:()=>lt,makeTextDecoderIterator:()=>ot,makeTextEncoderIterator:()=>st,mergeLoaderOptions:()=>E,nodeVersion:()=>C,padStringToByteAlignment:()=>tt,padToNBytes:()=>Z,parseFromContext:()=>d,parseInBatchesFromContext:()=>p,parseJSON:()=>q,parseSyncFromContext:()=>f,parseWithWorker:()=>j,path:()=>Pt,promisify1:()=>Et,promisify2:()=>Mt,registerJSModules:()=>P,resolvePath:()=>bt,self:()=>m,setPathPrefix:()=>yt,sliceArrayBuffer:()=>K,stream:()=>Dt,toArrayBuffer:()=>St,toBuffer:()=>Ct,window:()=>v}),t.exports=(r=h,((t,e,n,r)=>{if(e&&"object"==typeof e||"function"==typeof e)for(let n of a(e))l.call(t,n)||undefined===n||o(t,n,{get:()=>e[n],enumerable:!(r=s(e,n))||r.enumerable});return t})(o({},"__esModule",{value:!0}),r));var y={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:void 0!==n.g&&n.g,document:"undefined"!=typeof document&&document},m=y.self||y.window||y.global||{},v=y.window||y.self||y.global||{},b=y.global||y.self||y.window||{},_=y.document||{},A=Boolean("object"!=typeof i||"[object process]"!==String(i)||i.browser),x="function"==typeof importScripts,w=void 0!==i&&i.version&&/v([0-9]*)/.exec(i.version),C=w&&parseFloat(w[1])||0,S=new(n(40122).Log)({id:"loaders.gl"});function E(t,e){return M(t||{},e)}function M(t,e,n=0){if(n>3)return e;const r={...t};for(const[t,i]of Object.entries(e))i&&"object"==typeof i&&!Array.isArray(i)?r[t]=M(r[t]||{},e[t],n+1):r[t]=e[t];return r}function P(t){globalThis.loaders||={},globalThis.loaders.modules||={},Object.assign(globalThis.loaders.modules,t)}function T(t,e){var n,r;(null==(r=null==(n=globalThis.loaders)?void 0:n.modules)?void 0:r[t])||S.warn(`${e}: ${t} library not installed`)()}function O(t,e){var n,r;const i=null==(r=null==(n=globalThis.loaders)?void 0:n.modules)?void 0:r[t];if(!i)throw new Error(`${e}: ${t} library not installed`);return i}function I(t){var e,n;return(null==(n=null==(e=globalThis.loaders)?void 0:e.modules)?void 0:n[t])||null}var R=n(96288),B=0;async function L(t){await R.WorkerBody.inWorkerThread()&&(R.WorkerBody.onmessage=async(e,n)=>{if("process"===e)try{const{input:e,options:r={},context:i={}}=n,o=await async function({loader:t,arrayBuffer:e,options:n,context:r}){let i,o;if(t.parseSync||t.parse)i=e,o=t.parseSync||t.parse;else{if(!t.parseTextSync)throw new Error(`Could not load data with ${t.name} loader`);i=(new TextDecoder).decode(e),o=t.parseTextSync}return n={...n,modules:t&&t.options&&t.options.modules||{},worker:!1},await o(i,{...n},r,t)}({loader:t,arrayBuffer:e,options:r,context:{...i,_parse:k}});R.WorkerBody.postMessage("done",{result:o})}catch(t){const e=t instanceof Error?t.message:"";R.WorkerBody.postMessage("error",{error:e})}})}function k(t,e,n,r){return new Promise(((e,r)=>{const i=B++,o=(t,n)=>{if(n.id===i)switch(t){case"done":R.WorkerBody.removeEventListener(o),e(n.result);break;case"error":R.WorkerBody.removeEventListener(o),r(n.error)}};R.WorkerBody.addEventListener(o);const s={id:i,input:t,options:n};R.WorkerBody.postMessage("process",s)}))}var D=n(96288),F=n(96288);function N(t,e){return!!F.WorkerFarm.isSupported()&&!(!D.isBrowser&&!(null==e?void 0:e._nodeWorkers))&&t.worker&&(null==e?void 0:e.worker)}async function j(t,e,n,r,i){const o=t.id,s=(0,F.getWorkerURL)(t,n),a=F.WorkerFarm.getWorkerFarm(n).getWorkerPool({name:o,url:s});n=JSON.parse(JSON.stringify(n)),r=JSON.parse(JSON.stringify(r||{}));const l=await a.startJob("process-on-worker",G.bind(null,i));l.postMessage("process",{input:e,options:n,context:r});const u=await l.result;return await u.result}async function G(t,e,n,r){switch(n){case"done":e.done(r);break;case"error":e.error(new Error(r.error));break;case"process":const{id:i,input:o,options:s}=r;try{const n=await t(o,s);e.postMessage("done",{id:i,result:n})}catch(t){const n=t instanceof Error?t.message:"unknown error";e.postMessage("error",{id:i,error:n})}break;default:console.warn(`parse-with-worker unknown message ${n}`)}}var U=n(96288);function z(t,e){return!!U.WorkerFarm.isSupported()&&!(!A&&!(null==e?void 0:e._nodeWorkers))&&t.worker&&(null==e?void 0:e.worker)}function V(t,e=5){return"string"==typeof t?t.slice(0,e):ArrayBuffer.isView(t)?H(t.buffer,t.byteOffset,e):t instanceof ArrayBuffer?H(t,0,e):""}function H(t,e,n){if(t.byteLength<=e+n)return"";const r=new DataView(t);let i="";for(let t=0;t<n;t++)i+=String.fromCharCode(r.getUint8(e+t));return i}function q(t){try{return JSON.parse(t)}catch(e){throw new Error(`Failed to parse JSON from data starting with "${V(t)}"`)}}function W(t,e,n){if(n=n||t.byteLength,t.byteLength<n||e.byteLength<n)return!1;const r=new Uint8Array(t),i=new Uint8Array(e);for(let t=0;t<r.length;++t)if(r[t]!==i[t])return!1;return!0}function J(...t){return Y(t)}function Y(t){const e=t.map((t=>t instanceof ArrayBuffer?new Uint8Array(t):t)),n=e.reduce(((t,e)=>t+e.byteLength),0),r=new Uint8Array(n);let i=0;for(const t of e)r.set(t,i),i+=t.byteLength;return r.buffer}function X(...t){const e=t,n=e&&e.length>1&&e[0].constructor||null;if(!n)throw new Error('"concatenateTypedArrays" - incorrect quantity of arguments or arguments have incompatible data types');const r=new n(e.reduce(((t,e)=>t+e.length),0));let i=0;for(const t of e)r.set(t,i),i+=t.length;return r}function K(t,e,n){const r=void 0!==n?new Uint8Array(t).subarray(e,e+n):new Uint8Array(t).subarray(e);return new Uint8Array(r).buffer}function Z(t,e){return g(t>=0),g(e>0),t+(e-1)&~(e-1)}function Q(t,e,n,r=e.byteLength){const i=new Uint8Array(t,n,r),o=new Uint8Array(e);return i.set(o),t}function $(t,e,n){let r;if(t instanceof ArrayBuffer)r=new Uint8Array(t);else{const e=t.byteOffset,n=t.byteLength;r=new Uint8Array(t.buffer||t.arrayBuffer,e,n)}return e.set(r,n),n+Z(r.byteLength,4)}function tt(t,e){const n=t.length,r=Math.ceil(n/e)*e-n;let i="";for(let t=0;t<r;++t)i+=" ";return t+i}function et(t,e,n,r){if(t)for(let i=0;i<r;i++)t.setUint8(e+i,n.charCodeAt(i));return e+r}function nt(t,e,n,r){if(t)for(let i=0;i<r;i++)t.setUint8(e+i,n[i]);return e+r}function rt(t,e,n,r){const i=Z(n.byteLength,r),o=i-n.byteLength;if(t){const r=new Uint8Array(t.buffer,t.byteOffset+e,n.byteLength),i=new Uint8Array(n);r.set(i);for(let r=0;r<o;++r)t.setUint8(e+n.byteLength+r,32)}return e+i}function it(t,e,n,r){return rt(t,e,(new TextEncoder).encode(n),r)}async function*ot(t,e={}){const n=new TextDecoder(void 0,e);for await(const e of t)yield"string"==typeof e?e:n.decode(e,{stream:!0})}async function*st(t){const e=new TextEncoder;for await(const n of t)yield"string"==typeof n?e.encode(n):n}async function*at(t){let e="";for await(const n of t){let t;for(e+=n;(t=e.indexOf("\n"))>=0;){const n=e.slice(0,t+1);e=e.slice(t+1),yield n}}e.length>0&&(yield e)}async function*lt(t){let e=1;for await(const n of t)yield{counter:e,line:n},e++}async function ut(t,e){for(;;){const{done:n,value:r}=await t.next();if(n)return void t.return();if(e(r))return}}async function ct(t){const e=[];for await(const n of t)e.push(n);return J(...e)}var ht=n(36590),dt={id:"request-scheduler",throttleRequests:!0,maxRequests:6,debounceTime:0},ft=class{props;stats;activeRequestCount=0;requestQueue=[];requestMap=new Map;updateTimer=null;constructor(t={}){this.props={...dt,...t},this.stats=new ht.Stats({id:this.props.id}),this.stats.get("Queued Requests"),this.stats.get("Active Requests"),this.stats.get("Cancelled Requests"),this.stats.get("Queued Requests Ever"),this.stats.get("Active Requests Ever")}scheduleRequest(t,e=()=>0){if(!this.props.throttleRequests)return Promise.resolve({done:()=>{}});if(this.requestMap.has(t))return this.requestMap.get(t);const n={handle:t,priority:0,getPriority:e},r=new Promise((t=>(n.resolve=t,n)));return this.requestQueue.push(n),this.requestMap.set(t,r),this._issueNewRequests(),r}_issueRequest(t){const{handle:e,resolve:n}=t;let r=!1;const i=()=>{r||(r=!0,this.requestMap.delete(e),this.activeRequestCount--,this._issueNewRequests())};return this.activeRequestCount++,n?n({done:i}):Promise.resolve({done:i})}_issueNewRequests(){null!==this.updateTimer&&clearTimeout(this.updateTimer),this.updateTimer=setTimeout((()=>this._issueNewRequestsAsync()),this.props.debounceTime)}_issueNewRequestsAsync(){null!==this.updateTimer&&clearTimeout(this.updateTimer),this.updateTimer=null;const t=Math.max(this.props.maxRequests-this.activeRequestCount,0);if(0!==t){this._updateAllRequests();for(let e=0;e<t;++e){const t=this.requestQueue.shift();t&&this._issueRequest(t)}}}_updateAllRequests(){const t=this.requestQueue;for(let e=0;e<t.length;++e){const n=t[e];this._updateRequest(n)||(t.splice(e,1),this.requestMap.delete(n.handle),e--)}t.sort(((t,e)=>t.priority-e.priority))}_updateRequest(t){return t.priority=t.getPriority(t.handle),!(t.priority<0&&(t.resolve(null),1))}},pt="",gt={};function yt(t){pt=t}function mt(){return pt}function vt(t){Object.assign(gt,t)}function bt(t){for(const e in gt)if(t.startsWith(e)){const n=gt[e];t=t.replace(e,n)}return t.startsWith("http://")||t.startsWith("https://")||(t=`${pt}${t}`),t}var _t={dataType:null,batchType:null,name:"JSON",id:"json",module:"json",version:"4.2.1",extensions:["json","geojson"],mimeTypes:["application/json"],category:"json",text:!0,parseTextSync:At,parse:async t=>At((new TextDecoder).decode(t)),options:{}};function At(t){return JSON.parse(t)}function xt(t){throw new Error("Buffer not supported in browser")}function wt(t){return t&&"object"==typeof t&&t.isBuffer}function Ct(t){return xt?xt():t}function St(t){if(wt(t))return t;if(t instanceof ArrayBuffer)return t;if(ArrayBuffer.isView(t))return 0===t.byteOffset&&t.byteLength===t.buffer.byteLength?t.buffer:t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength);if("string"==typeof t){const e=t;return(new TextEncoder).encode(e).buffer}if(t&&"object"==typeof t&&t._toArrayBuffer)return t._toArrayBuffer();throw new Error("toArrayBuffer")}function Et(t){return e=>new Promise(((n,r)=>t(e,((t,e)=>t?r(t):n(e)))))}function Mt(t){return(e,n)=>new Promise(((r,i)=>t(e,n,((t,e)=>t?i(t):r(e)))))}var Pt={};function Tt(){var t;if(void 0!==i&&void 0!==i.cwd)return i.cwd();const e=null==(t=window.location)?void 0:t.pathname;return(null==e?void 0:e.slice(0,e.lastIndexOf("/")+1))||""}function Ot(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(e+1):""}function It(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(0,e):""}function Rt(...t){return(t=t.map(((e,n)=>(n&&(e=e.replace(new RegExp("^/"),"")),n!==t.length-1&&(e=e.replace(new RegExp("/$"),"")),e)))).join("/")}function Bt(...t){const e=[];for(let n=0;n<t.length;n++)e[n]=t[n];let n,r="",i=!1;for(let t=e.length-1;t>=-1&&!i;t--){let o;t>=0?o=e[t]:(void 0===n&&(n=Tt()),o=n),0!==o.length&&(r=`${o}/${r}`,i=o.charCodeAt(0)===Lt)}return r=function(t,e){let n,r="",i=-1,o=0,s=!1;for(let a=0;a<=t.length;++a){if(a<t.length)n=t.charCodeAt(a);else{if(n===Lt)break;n=Lt}if(n===Lt){if(i===a-1||1===o);else if(i!==a-1&&2===o){if(r.length<2||!s||r.charCodeAt(r.length-1)!==kt||r.charCodeAt(r.length-2)!==kt)if(r.length>2){const t=r.length-1;let e=t;for(;e>=0&&r.charCodeAt(e)!==Lt;--e);if(e!==t){r=-1===e?"":r.slice(0,e),i=a,o=0,s=!1;continue}}else if(2===r.length||1===r.length){r="",i=a,o=0,s=!1;continue}e&&(r.length>0?r+="/..":r="..",s=!0)}else{const e=t.slice(i+1,a);r.length>0?r+=`/${e}`:r=e,s=!1}i=a,o=0}else n===kt&&-1!==o?++o:o=-1}return r}(r,!i),i?`/${r}`:r.length>0?r:"."}u(Pt,{dirname:()=>It,filename:()=>Ot,join:()=>Rt,resolve:()=>Bt});var Lt=47,kt=46,Dt={};u(Dt,{isSupported:()=>Ft});var Ft=!1,Nt=class{handle;size;bigsize;url;constructor(t){this.handle=t instanceof ArrayBuffer?new Blob([t]):t,this.size=t instanceof ArrayBuffer?t.byteLength:t.size,this.bigsize=BigInt(this.size),this.url=t instanceof File?t.name:""}async close(){}async stat(){return{size:this.handle.size,bigsize:BigInt(this.handle.size),isDirectory:!1}}async read(t,e){return await this.handle.slice(t,t+e).arrayBuffer()}},jt=class{handle;size=0;bigsize=0n;url;constructor(t){this.handle=t,this.url=t}async close(){}async stat(){const t=await fetch(this.handle,{method:"HEAD"});if(!t.ok)throw new Error(`Failed to fetch HEAD ${this.handle}`);const e=parseInt(t.headers.get("Content-Length")||"0");return{size:e,bigsize:BigInt(e),isDirectory:!1}}async read(t,e){const n=await this.fetchRange(t,e);return await n.arrayBuffer()}async fetchRange(t,e,n){const r=Number(t),i=Number(e);let o;n||(o=new AbortController,n=o.signal);const s=this.handle;let a=await fetch(s,{signal:n,headers:{Range:`bytes=${r}-${r+i-1}`}});switch(a.status){case 206:break;case 200:const r=a.headers.get("Content-Length");if(!r||Number(r)>e)throw o&&o.abort(),Error("content-length header missing or exceeding request. Server must support HTTP Byte Serving.");case 416:if(0===t){const t=a.headers.get("Content-Range");if(!t||!t.startsWith("bytes *"))throw Error("Missing content-length on 416 response");const e=Number(t.substr(8));a=await fetch(this.url,{signal:n,headers:{Range:"bytes=0-"+(e-1)}})}break;default:if(a.status>=300)throw Error(`Bad response code: ${a.status}`)}return a}},Gt=new Error("Not implemented"),Ut=class{handle;size=0;bigsize=0n;url="";constructor(t,e,n){var r;if(null==(r=globalThis.loaders)?void 0:r.NodeFile)return new globalThis.loaders.NodeFile(t,e,n);if(A)throw new Error("Can't instantiate NodeFile in browser.");throw new Error("Can't instantiate NodeFile. Make sure to import @loaders.gl/polyfills first.")}async read(t,e){throw Gt}async write(t,e,n){throw Gt}async stat(){throw Gt}async truncate(t){throw Gt}async append(t){throw Gt}async close(){}},zt=new Error("Not implemented"),Vt=class{constructor(t){var e;if(null==(e=globalThis.loaders)?void 0:e.NodeFileSystem)return new globalThis.loaders.NodeFileSystem(t);if(A)throw new Error("Can't instantiate NodeFileSystem in browser.");throw new Error("Can't instantiate NodeFileSystem. Make sure to import @loaders.gl/polyfills first.")}readable=!0;writable=!0;async openReadableFile(t,e){throw zt}async openWritableFile(t,e,n){throw zt}async readdir(t=".",e){throw zt}async stat(t,e){throw zt}async unlink(t){throw zt}async fetch(t,e){throw zt}},Ht=t=>(null==t?void 0:t.getUint8)&&(null==t?void 0:t.slice)&&(null==t?void 0:t.length),qt=class{file;constructor(t,e=!1){this.file=new Ut(t,e?"a+":"r")}async truncate(t){await this.file.truncate(t)}async append(t){await this.file.append(t)}async destroy(){await this.file.close()}async getUint8(t){const e=await this.file.read(t,1),n=new Uint8Array(e).at(0);if(void 0===n)throw new Error("something went wrong");return n}async getUint16(t){const e=await this.file.read(t,2),n=new Uint16Array(e).at(0);if(void 0===n)throw new Error("something went wrong");return n}async getUint32(t){const e=await this.file.read(t,4),n=new Uint32Array(e).at(0);if(void 0===n)throw new Error("something went wrong");return n}async getBigUint64(t){const e=await this.file.read(t,8),n=new BigInt64Array(e).at(0);if(void 0===n)throw new Error("something went wrong");return n}async slice(t,e){const n=e-t;if(n>Number.MAX_SAFE_INTEGER)throw new Error("too big slice");const r=Number(n);return await this.file.read(t,r)}get length(){return this.file.bigsize}},Wt=t=>{if(t>Number.MAX_SAFE_INTEGER)throw new Error("Offset is out of bounds");return Number(t)},Jt=class{file;constructor(t){this.file=t}async destroy(){}async getUint8(t){return this.file.getUint8(Wt(t))}async getUint16(t){return this.file.getUint16(Wt(t),!0)}async getUint32(t){return this.file.getUint32(Wt(t),!0)}async getBigUint64(t){return this.file.getBigUint64(Wt(t),!0)}async slice(t,e){return this.file.buffer.slice(Wt(t),Wt(e))}get length(){return BigInt(this.file.byteLength)}},Yt=class{fetch;loadOptions;_needsRefresh=!0;props;constructor(t){this.props={...t},this.loadOptions={...t.loadOptions},this.fetch=function(t){const e=null==t?void 0:t.fetch;if(e&&"function"==typeof e)return(t,n)=>e(t,n);const n=null==t?void 0:t.fetch;return n&&"function"!=typeof n?t=>fetch(t,n):t=>fetch(t)}(this.loadOptions)}setProps(t){this.props=Object.assign(this.props,t),this.setNeedsRefresh()}setNeedsRefresh(){this._needsRefresh=!0}getNeedsRefresh(t=!0){const e=this._needsRefresh;return t&&(this._needsRefresh=!1),e}},Xt=class extends Yt{};c(Xt,"type","template"),c(Xt,"testURL",(t=>!1))},38453:(t,e,n)=>{"use strict";var r,i=Object.defineProperty,o=Object.getOwnPropertyDescriptor,s=Object.getOwnPropertyNames,a=Object.prototype.hasOwnProperty,l={};((t,e)=>{for(var n in e)i(t,n,{get:e[n],enumerable:!0})})(l,{BASIS_EXTERNAL_LIBRARIES:()=>p,BasisLoader:()=>N,BasisWorkerLoader:()=>F,CRUNCH_EXTERNAL_LIBRARIES:()=>vt,CompressedTextureLoader:()=>ct,CompressedTextureWorkerLoader:()=>ut,CompressedTextureWriter:()=>_t,CrunchLoader:()=>ht,CrunchWorkerLoader:()=>ht,GL_EXTENSIONS_CONSTANTS:()=>m,KTX2BasisWriter:()=>At,KTX2BasisWriterWorker:()=>Ft,NPYLoader:()=>mt,NPYWorkerLoader:()=>yt,getSupportedGPUTextureFormats:()=>A,loadImageTexture:()=>Ot,loadImageTextureArray:()=>Bt,loadImageTextureCube:()=>Dt,selectSupportedBasisFormat:()=>D}),t.exports=(r=l,((t,e,n,r)=>{if(e&&"object"==typeof e||"function"==typeof e)for(let n of s(e))a.call(t,n)||undefined===n||i(t,n,{get:()=>e[n],enumerable:!(r=o(e,n))||r.enumerable});return t})(i({},"__esModule",{value:!0}),r));var u,c,h="4.2.1",d=n(63666),f=n(96288),p={TRANSCODER:"basis_transcoder.js",TRANSCODER_WASM:"basis_transcoder.wasm",ENCODER:"basis_encoder.js",ENCODER_WASM:"basis_encoder.wasm"};async function g(t){(0,d.registerJSModules)(t.modules);return(0,d.getJSModuleOrNull)("basis")||(u||=async function(t){let e=null,n=null;return[e,n]=await Promise.all([await(0,f.loadLibrary)(p.TRANSCODER,"textures",t),await(0,f.loadLibrary)(p.TRANSCODER_WASM,"textures",t)]),e=e||globalThis.BASIS,await function(t,e){const n={};return e&&(n.wasmBinary=e),new Promise((e=>{t(n).then((t=>{const{BasisFile:n,initializeBasis:r}=t;r(),e({BasisFile:n})}))}))}(e,n)}(t),await u)}async function y(t){const e=t.modules||{};return e.basisEncoder?e.basisEncoder:(c=c||async function(t){let e=null,n=null;return[e,n]=await Promise.all([await(0,f.loadLibrary)(p.ENCODER,"textures",t),await(0,f.loadLibrary)(p.ENCODER_WASM,"textures",t)]),e=e||globalThis.BASIS,await function(t,e){const n={};return e&&(n.wasmBinary=e),new Promise((e=>{t(n).then((t=>{const{BasisFile:n,KTX2File:r,initializeBasis:i,BasisEncoder:o}=t;i(),e({BasisFile:n,KTX2File:r,BasisEncoder:o})}))}))}(e,n)}(t),await c)}var m={COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_RGBA8_ETC2_EAC:37493,COMPRESSED_SRGB8_ETC2:37494,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37495,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37496,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37497,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGB_ETC1_WEBGL:36196,COMPRESSED_RGB_ATC_WEBGL:35986,COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL:35987,COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL:34798,COMPRESSED_RGBA_ASTC_4X4_KHR:37808,COMPRESSED_RGBA_ASTC_5X4_KHR:37809,COMPRESSED_RGBA_ASTC_5X5_KHR:37810,COMPRESSED_RGBA_ASTC_6X5_KHR:37811,COMPRESSED_RGBA_ASTC_6X6_KHR:37812,COMPRESSED_RGBA_ASTC_8X5_KHR:37813,COMPRESSED_RGBA_ASTC_8X6_KHR:37814,COMPRESSED_RGBA_ASTC_8X8_KHR:37815,COMPRESSED_RGBA_ASTC_10X5_KHR:37816,COMPRESSED_RGBA_ASTC_10X6_KHR:37817,COMPRESSED_RGBA_ASTC_10X8_KHR:37818,COMPRESSED_RGBA_ASTC_10X10_KHR:37819,COMPRESSED_RGBA_ASTC_12X10_KHR:37820,COMPRESSED_RGBA_ASTC_12X12_KHR:37821,COMPRESSED_SRGB8_ALPHA8_ASTC_4X4_KHR:37840,COMPRESSED_SRGB8_ALPHA8_ASTC_5X4_KHR:37841,COMPRESSED_SRGB8_ALPHA8_ASTC_5X5_KHR:37842,COMPRESSED_SRGB8_ALPHA8_ASTC_6X5_KHR:37843,COMPRESSED_SRGB8_ALPHA8_ASTC_6X6_KHR:37844,COMPRESSED_SRGB8_ALPHA8_ASTC_8X5_KHR:37845,COMPRESSED_SRGB8_ALPHA8_ASTC_8X6_KHR:37846,COMPRESSED_SRGB8_ALPHA8_ASTC_8X8_KHR:37847,COMPRESSED_SRGB8_ALPHA8_ASTC_10X5_KHR:37848,COMPRESSED_SRGB8_ALPHA8_ASTC_10X6_KHR:37849,COMPRESSED_SRGB8_ALPHA8_ASTC_10X8_KHR:37850,COMPRESSED_SRGB8_ALPHA8_ASTC_10X10_KHR:37851,COMPRESSED_SRGB8_ALPHA8_ASTC_12X10_KHR:37852,COMPRESSED_SRGB8_ALPHA8_ASTC_12X12_KHR:37853,COMPRESSED_RED_RGTC1_EXT:36283,COMPRESSED_SIGNED_RED_RGTC1_EXT:36284,COMPRESSED_RED_GREEN_RGTC2_EXT:36285,COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT:36286,COMPRESSED_SRGB_S3TC_DXT1_EXT:35916,COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT:35917,COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT:35918,COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT:35919},v=["","WEBKIT_","MOZ_"],b={WEBGL_compressed_texture_s3tc:"dxt",WEBGL_compressed_texture_s3tc_srgb:"dxt-srgb",WEBGL_compressed_texture_etc1:"etc1",WEBGL_compressed_texture_etc:"etc2",WEBGL_compressed_texture_pvrtc:"pvrtc",WEBGL_compressed_texture_atc:"atc",WEBGL_compressed_texture_astc:"astc",EXT_texture_compression_rgtc:"rgtc"},_=null;function A(t){if(!_){t=t||function(){try{return document.createElement("canvas").getContext("webgl")}catch(t){return null}}()||void 0,_=new Set;for(const e of v)for(const n in b)if(t&&t.getExtension(`${e}${n}`)){const t=b[n];_.add(t)}}return _}var x=n(43853);function w(t,e){const n=new Array(e.mipMapLevels);let r=e.width,i=e.height,o=0;for(let s=0;s<e.mipMapLevels;++s){const a=S(e,r,i,t,s),l=C(t,s,o,a);n[s]={compressed:!0,format:e.internalFormat,data:l,width:r,height:i,levelSize:a},r=Math.max(1,r>>1),i=Math.max(1,i>>1),o+=a}return n}function C(t,e,n,r){return Array.isArray(t)?t[e].levelData:new Uint8Array(t.buffer,t.byteOffset+n,r)}function S(t,e,n,r,i){return Array.isArray(r)?t.sizeFunction(r[i]):t.sizeFunction(e,n)}var E={131:m.COMPRESSED_RGB_S3TC_DXT1_EXT,132:m.COMPRESSED_SRGB_S3TC_DXT1_EXT,133:m.COMPRESSED_RGBA_S3TC_DXT1_EXT,134:m.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,135:m.COMPRESSED_RGBA_S3TC_DXT3_EXT,136:m.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,137:m.COMPRESSED_RGBA_S3TC_DXT5_EXT,138:m.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT,139:m.COMPRESSED_RED_RGTC1_EXT,140:m.COMPRESSED_SIGNED_RED_RGTC1_EXT,141:m.COMPRESSED_RED_GREEN_RGTC2_EXT,142:m.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT,147:m.COMPRESSED_RGB8_ETC2,148:m.COMPRESSED_SRGB8_ETC2,149:m.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2,150:m.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2,151:m.COMPRESSED_RGBA8_ETC2_EAC,152:m.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC,153:m.COMPRESSED_R11_EAC,154:m.COMPRESSED_SIGNED_R11_EAC,155:m.COMPRESSED_RG11_EAC,156:m.COMPRESSED_SIGNED_RG11_EAC,157:m.COMPRESSED_RGBA_ASTC_4x4_KHR,158:m.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR,159:m.COMPRESSED_RGBA_ASTC_5x4_KHR,160:m.COMPRESSED_SRGB8_ALPHA8_ASTC_5X4_KHR,161:m.COMPRESSED_RGBA_ASTC_5x5_KHR,162:m.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR,163:m.COMPRESSED_RGBA_ASTC_6x5_KHR,164:m.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR,165:m.COMPRESSED_RGBA_ASTC_6x6_KHR,166:m.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR,167:m.COMPRESSED_RGBA_ASTC_8x5_KHR,168:m.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR,169:m.COMPRESSED_RGBA_ASTC_8x6_KHR,170:m.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR,171:m.COMPRESSED_RGBA_ASTC_8x8_KHR,172:m.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR,173:m.COMPRESSED_RGBA_ASTC_10x5_KHR,174:m.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR,175:m.COMPRESSED_RGBA_ASTC_10x6_KHR,176:m.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR,177:m.COMPRESSED_RGBA_ASTC_10x8_KHR,178:m.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR,179:m.COMPRESSED_RGBA_ASTC_10x10_KHR,180:m.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR,181:m.COMPRESSED_RGBA_ASTC_12x10_KHR,182:m.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR,183:m.COMPRESSED_RGBA_ASTC_12x12_KHR,184:m.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR,1000054e3:m.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG,1000054001:m.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG,1000066e3:m.COMPRESSED_RGBA_ASTC_4x4_KHR,1000066001:m.COMPRESSED_RGBA_ASTC_5x4_KHR,1000066002:m.COMPRESSED_RGBA_ASTC_5x5_KHR,1000066003:m.COMPRESSED_RGBA_ASTC_6x5_KHR,1000066004:m.COMPRESSED_RGBA_ASTC_6x6_KHR,1000066005:m.COMPRESSED_RGBA_ASTC_8x5_KHR,1000066006:m.COMPRESSED_RGBA_ASTC_8x6_KHR,1000066007:m.COMPRESSED_RGBA_ASTC_8x8_KHR,1000066008:m.COMPRESSED_RGBA_ASTC_10x5_KHR,1000066009:m.COMPRESSED_RGBA_ASTC_10x6_KHR,1000066010:m.COMPRESSED_RGBA_ASTC_10x8_KHR,1000066011:m.COMPRESSED_RGBA_ASTC_10x10_KHR,1000066012:m.COMPRESSED_RGBA_ASTC_12x10_KHR,1000066013:m.COMPRESSED_RGBA_ASTC_12x12_KHR},M=[171,75,84,88,32,50,48,187,13,10,26,10];function P(t){const e=new Uint8Array(t);return!(e.byteLength<M.length||e[0]!==M[0]||e[1]!==M[1]||e[2]!==M[2]||e[3]!==M[3]||e[4]!==M[4]||e[5]!==M[5]||e[6]!==M[6]||e[7]!==M[7]||e[8]!==M[8]||e[9]!==M[9]||e[10]!==M[10]||e[11]!==M[11])}var T={etc1:{basisFormat:0,compressed:!0,format:m.COMPRESSED_RGB_ETC1_WEBGL},etc2:{basisFormat:1,compressed:!0},bc1:{basisFormat:2,compressed:!0,format:m.COMPRESSED_RGB_S3TC_DXT1_EXT},bc3:{basisFormat:3,compressed:!0,format:m.COMPRESSED_RGBA_S3TC_DXT5_EXT},bc4:{basisFormat:4,compressed:!0},bc5:{basisFormat:5,compressed:!0},"bc7-m6-opaque-only":{basisFormat:6,compressed:!0},"bc7-m5":{basisFormat:7,compressed:!0},"pvrtc1-4-rgb":{basisFormat:8,compressed:!0,format:m.COMPRESSED_RGB_PVRTC_4BPPV1_IMG},"pvrtc1-4-rgba":{basisFormat:9,compressed:!0,format:m.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG},"astc-4x4":{basisFormat:10,compressed:!0,format:m.COMPRESSED_RGBA_ASTC_4X4_KHR},"atc-rgb":{basisFormat:11,compressed:!0},"atc-rgba-interpolated-alpha":{basisFormat:12,compressed:!0},rgba32:{basisFormat:13,compressed:!1},rgb565:{basisFormat:14,compressed:!1},bgr565:{basisFormat:15,compressed:!1},rgba4444:{basisFormat:16,compressed:!1}};async function O(t,e){if("auto"===e.basis.containerFormat){if(P(t))return B((await y(e)).KTX2File,t,e);const{BasisFile:n}=await g(e);return I(n,t,e)}if("encoder"===e.basis.module){const n=await y(e);return"ktx2"===e.basis.containerFormat?B(n.KTX2File,t,e):I(n.BasisFile,t,e)}{const{BasisFile:n}=await g(e);return I(n,t,e)}}function I(t,e,n){const r=new t(new Uint8Array(e));try{if(!r.startTranscoding())throw new Error("Failed to start basis transcoding");const t=r.getNumImages(),e=[];for(let i=0;i<t;i++){const t=r.getNumLevels(i),o=[];for(let e=0;e<t;e++)o.push(R(r,i,e,n));e.push(o)}return e}finally{r.close(),r.delete()}}function R(t,e,n,r){const i=t.getImageWidth(e,n),o=t.getImageHeight(e,n),s=t.getHasAlpha(),{compressed:a,format:l,basisFormat:u}=k(r,s),c=t.getImageTranscodedSizeInBytes(e,n,u),h=new Uint8Array(c);if(!t.transcodeImage(h,e,n,u,0,0))throw new Error("failed to start Basis transcoding");return{width:i,height:o,data:h,compressed:a,format:l,hasAlpha:s}}function B(t,e,n){const r=new t(new Uint8Array(e));try{if(!r.startTranscoding())throw new Error("failed to start KTX2 transcoding");const t=r.getLevels(),e=[];for(let i=0;i<t;i++){e.push(L(r,i,n));break}return[e]}finally{r.close(),r.delete()}}function L(t,e,n){const{alphaFlag:r,height:i,width:o}=t.getImageLevelInfo(e,0,0),{compressed:s,format:a,basisFormat:l}=k(n,r),u=t.getImageTranscodedSizeInBytes(e,0,0,l),c=new Uint8Array(u);if(!t.transcodeImage(c,e,0,0,l,0,-1,-1))throw new Error("Failed to transcode KTX2 image");return{width:o,height:i,data:c,compressed:s,levelSize:u,hasAlpha:r,format:a}}function k(t,e){let n=t&&t.basis&&t.basis.format;return"auto"===n&&(n=D()),"object"==typeof n&&(n=e?n.alpha:n.noAlpha),n=n.toLowerCase(),T[n]}function D(){const t=A();return t.has("astc")?"astc-4x4":t.has("dxt")?{alpha:"bc3",noAlpha:"bc1"}:t.has("pvrtc")?{alpha:"pvrtc1-4-rgba",noAlpha:"pvrtc1-4-rgb"}:t.has("etc1")?"etc1":t.has("etc2")?"etc2":"rgb565"}var F={dataType:null,batchType:null,name:"Basis",id:"basis",module:"textures",version:h,worker:!0,extensions:["basis","ktx2"],mimeTypes:["application/octet-stream","image/ktx2"],tests:["sB"],binary:!0,options:{basis:{format:"auto",libraryPath:"libs/",containerFormat:"auto",module:"transcoder"}}},N={...F,parse:O},j=n(63666),G={MAGIC_NUMBER:542327876,HEADER_LENGTH:31,MAGIC_NUMBER_INDEX:0,HEADER_SIZE_INDEX:1,HEADER_FLAGS_INDEX:2,HEADER_HEIGHT_INDEX:3,HEADER_WIDTH_INDEX:4,MIPMAPCOUNT_INDEX:7,HEADER_PF_FLAGS_INDEX:20,HEADER_PF_FOURCC_INDEX:21,DDSD_MIPMAPCOUNT:131072,DDPF_FOURCC:4},U={DXT1:m.COMPRESSED_RGB_S3TC_DXT1_EXT,DXT3:m.COMPRESSED_RGBA_S3TC_DXT3_EXT,DXT5:m.COMPRESSED_RGBA_S3TC_DXT5_EXT,"ATC ":m.COMPRESSED_RGB_ATC_WEBGL,ATCA:m.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL,ATCI:m.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL},z={DXT1:V,DXT3:H,DXT5:H,"ATC ":V,ATCA:H,ATCI:H};function V(t,e){return(t+3>>2)*(e+3>>2)*8}function H(t,e){return(t+3>>2)*(e+3>>2)*16}var q=55727696,W=1347834371,J=13,Y=52,X=0,K=2,Z=4,Q=6,$=7,tt=11,et=12,nt={0:[m.COMPRESSED_RGB_PVRTC_2BPPV1_IMG],1:[m.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG],2:[m.COMPRESSED_RGB_PVRTC_4BPPV1_IMG],3:[m.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG],6:[m.COMPRESSED_RGB_ETC1_WEBGL],7:[m.COMPRESSED_RGB_S3TC_DXT1_EXT],9:[m.COMPRESSED_RGBA_S3TC_DXT3_EXT],11:[m.COMPRESSED_RGBA_S3TC_DXT5_EXT],22:[m.COMPRESSED_RGB8_ETC2],23:[m.COMPRESSED_RGBA8_ETC2_EAC],24:[m.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2],25:[m.COMPRESSED_R11_EAC],26:[m.COMPRESSED_RG11_EAC],27:[m.COMPRESSED_RGBA_ASTC_4X4_KHR,m.COMPRESSED_SRGB8_ALPHA8_ASTC_4X4_KHR],28:[m.COMPRESSED_RGBA_ASTC_5X4_KHR,m.COMPRESSED_SRGB8_ALPHA8_ASTC_5X4_KHR],29:[m.COMPRESSED_RGBA_ASTC_5X5_KHR,m.COMPRESSED_SRGB8_ALPHA8_ASTC_5X5_KHR],30:[m.COMPRESSED_RGBA_ASTC_6X5_KHR,m.COMPRESSED_SRGB8_ALPHA8_ASTC_6X5_KHR],31:[m.COMPRESSED_RGBA_ASTC_6X6_KHR,m.COMPRESSED_SRGB8_ALPHA8_ASTC_6X6_KHR],32:[m.COMPRESSED_RGBA_ASTC_8X5_KHR,m.COMPRESSED_SRGB8_ALPHA8_ASTC_8X5_KHR],33:[m.COMPRESSED_RGBA_ASTC_8X6_KHR,m.COMPRESSED_SRGB8_ALPHA8_ASTC_8X6_KHR],34:[m.COMPRESSED_RGBA_ASTC_8X8_KHR,m.COMPRESSED_SRGB8_ALPHA8_ASTC_8X8_KHR],35:[m.COMPRESSED_RGBA_ASTC_10X5_KHR,m.COMPRESSED_SRGB8_ALPHA8_ASTC_10X5_KHR],36:[m.COMPRESSED_RGBA_ASTC_10X6_KHR,m.COMPRESSED_SRGB8_ALPHA8_ASTC_10X6_KHR],37:[m.COMPRESSED_RGBA_ASTC_10X8_KHR,m.COMPRESSED_SRGB8_ALPHA8_ASTC_10X8_KHR],38:[m.COMPRESSED_RGBA_ASTC_10X10_KHR,m.COMPRESSED_SRGB8_ALPHA8_ASTC_10X10_KHR],39:[m.COMPRESSED_RGBA_ASTC_12X10_KHR,m.COMPRESSED_SRGB8_ALPHA8_ASTC_12X10_KHR],40:[m.COMPRESSED_RGBA_ASTC_12X12_KHR,m.COMPRESSED_SRGB8_ALPHA8_ASTC_12X12_KHR]},rt={0:it,1:it,2:ot,3:ot,6:st,7:st,9:at,11:at,22:st,23:at,24:st,25:st,26:at,27:at,28:function(t,e){return Math.floor((t+4)/5)*Math.floor((e+3)/4)*16},29:function(t,e){return Math.floor((t+4)/5)*Math.floor((e+4)/5)*16},30:function(t,e){return Math.floor((t+5)/6)*Math.floor((e+4)/5)*16},31:function(t,e){return Math.floor((t+5)/6)*Math.floor((e+5)/6)*16},32:function(t,e){return Math.floor((t+7)/8)*Math.floor((e+4)/5)*16},33:function(t,e){return Math.floor((t+7)/8)*Math.floor((e+5)/6)*16},34:function(t,e){return Math.floor((t+7)/8)*Math.floor((e+7)/8)*16},35:function(t,e){return Math.floor((t+9)/10)*Math.floor((e+4)/5)*16},36:function(t,e){return Math.floor((t+9)/10)*Math.floor((e+5)/6)*16},37:function(t,e){return Math.floor((t+9)/10)*Math.floor((e+7)/8)*16},38:function(t,e){return Math.floor((t+9)/10)*Math.floor((e+9)/10)*16},39:function(t,e){return Math.floor((t+11)/12)*Math.floor((e+9)/10)*16},40:function(t,e){return Math.floor((t+11)/12)*Math.floor((e+11)/12)*16}};function it(t,e){return(t=Math.max(t,16))*(e=Math.max(e,8))/4}function ot(t,e){return(t=Math.max(t,8))*(e=Math.max(e,8))/2}function st(t,e){return Math.floor((t+3)/4)*Math.floor((e+3)/4)*8}function at(t,e){return Math.floor((t+3)/4)*Math.floor((e+3)/4)*16}function lt(t){if(P(t))return function(t){const e=new Uint8Array(t),n=(0,x.read)(e),r=Math.max(1,n.levels.length),i=n.pixelWidth,o=n.pixelHeight,s=(a=n.vkFormat,E[a]);var a;return w(n.levels,{mipMapLevels:r,width:i,height:o,sizeFunction:t=>t.uncompressedByteLength,internalFormat:s})}(t);if(function(t){return new Uint32Array(t,0,G.HEADER_LENGTH)[G.MAGIC_NUMBER_INDEX]===G.MAGIC_NUMBER}(t))return function(t){const e=new Int32Array(t,0,G.HEADER_LENGTH),n=e[G.HEADER_PF_FOURCC_INDEX];(0,j.assert)(Boolean(e[G.HEADER_PF_FLAGS_INDEX]&G.DDPF_FOURCC),"DDS: Unsupported format, must contain a FourCC code");const r=(i=n,String.fromCharCode(255&i,i>>8&255,i>>16&255,i>>24&255));var i;const o=U[r],s=z[r];(0,j.assert)(o&&s,`DDS: Unknown pixel format ${n}`);let a=1;e[G.HEADER_FLAGS_INDEX]&G.DDSD_MIPMAPCOUNT&&(a=Math.max(1,e[G.MIPMAPCOUNT_INDEX]));const l=e[G.HEADER_WIDTH_INDEX],u=e[G.HEADER_HEIGHT_INDEX],c=e[G.HEADER_SIZE_INDEX]+4;return w(new Uint8Array(t,c),{mipMapLevels:a,width:l,height:u,sizeFunction:s,internalFormat:o})}(t);if(function(t){const e=new Uint32Array(t,0,J)[X];return e===q||e===W}(t))return function(t){const e=new Uint32Array(t,0,J),n=e[K],r=e[Z],i=nt[n]||[],o=i.length>1&&r?i[1]:i[0],s=rt[n],a=e[tt],l=e[$],u=e[Q],c=Y+e[et];return w(new Uint8Array(t,c),{mipMapLevels:a,width:l,height:u,sizeFunction:s,internalFormat:o})}(t);throw new Error("Texture container format not recognized")}var ut={dataType:null,batchType:null,name:"Texture Containers",id:"compressed-texture",module:"textures",version:h,worker:!0,extensions:["ktx","ktx2","dds","pvr"],mimeTypes:["image/ktx2","image/ktx","image/vnd-ms.dds","image/x-dds","application/octet-stream"],binary:!0,options:{"compressed-texture":{libraryPath:"libs/",useBasis:!1}}},ct={...ut,parse:async(t,e)=>{var n;return(null==(n=null==e?void 0:e["compressed-texture"])?void 0:n.useBasis)?(e.basis={format:{alpha:"BC3",noAlpha:"BC1"},...e.basis,containerFormat:"ktx2",module:"encoder"},(await O(t,e))[0]):lt(t)}},ht={dataType:null,batchType:null,id:"crunch",name:"Crunch",module:"textures",version:h,worker:!0,extensions:["crn"],mimeTypes:["image/crn","image/x-crn","application/octet-stream"],binary:!0,options:{crunch:{libraryPath:"libs/"}}},dt=new Uint32Array([305419896]),ft=!(18===new Uint8Array(dt.buffer,dt.byteOffset,dt.byteLength)[0]),pt={u1:Uint8Array,i1:Int8Array,u2:Uint16Array,i2:Int16Array,u4:Uint32Array,i4:Int32Array,f4:Float32Array,f8:Float64Array};function gt(t,e){var n;const r=new DataView(t),{header:i,headerEndOffset:o}=function(t){const e=t.getUint8(6);let n,r=8;e>=2?(n=t.getUint32(r,!0),r+=4):(n=t.getUint16(r,!0),r+=2);const i=new TextDecoder(e<=2?"latin1":"utf-8"),o=new Uint8Array(t.buffer,r,n),s=i.decode(o);r+=n;return{header:JSON.parse(s.replace(/'/g,'"').replace("False","false").replace("(","[").replace(/,*\),*/g,"]")),headerEndOffset:r}}(r),s=i.descr,a=pt[s.slice(1,3)];if(!a)throw new Error(`Unimplemented type ${s}`);const l=(null==(n=i.shape)?void 0:n.reduce(((t,e)=>t*e)))*a.BYTES_PER_ELEMENT;if(t.byteLength<o+l)throw new Error("Buffer overflow");const u=new a(t.slice(o,o+l));if(">"===s[0]&&ft||"<"===s[0]&&!ft)throw new Error("Incorrect endianness");return{data:u,header:i}}var yt={dataType:null,batchType:null,name:"NPY",id:"npy",module:"textures",version:h,worker:!0,extensions:["npy"],mimeTypes:[],tests:[new Uint8Array([147,78,85,77,80,89]).buffer],options:{npy:{}}},mt={...yt,parseSync:gt,parse:async(t,e)=>gt(t)},vt=(n(63666),n(96288),{DECODER:"crunch.js"}),bt=n(96288),_t={name:"DDS Texture Container",id:"dds",module:"textures",version:h,extensions:["dds"],options:{texture:{format:"auto",compression:"auto",quality:"auto",mipmap:!1,flipY:!1,toolFlags:""}},encodeURLtoURL:async function(t,e,n){const r=["texture-compressor","--type","s3tc","--compression","DXT1","--quality","normal","--input",t,"--output",e],i=new bt.ChildProcessProxy;return await i.start({command:"npx",arguments:r,spawn:n}),e},encode(){throw new Error("Not implemented")}},At={name:"Basis Universal Supercompressed GPU Texture",id:"ktx2-basis-writer",module:"textures",version:h,extensions:["ktx2"],options:{"ktx2-basis-writer":{useSRGB:!1,qualityLevel:10,encodeUASTC:!1,mipmaps:!1}},encode:async function(t,e={}){const{useSRGB:n=!1,qualityLevel:r=10,encodeUASTC:i=!1,mipmaps:o=!1}=(null==e?void 0:e["ktx2-basis-writer"])||{},{BasisEncoder:s}=await y(e),a=new s;try{const e=new Uint8Array(t.width*t.height*4);a.setCreateKTX2File(!0),a.setKTX2UASTCSupercompression(!0),a.setKTX2SRGBTransferFunc(!0),a.setSliceSourceImage(0,t.data,t.width,t.height,!1),a.setPerceptual(n),a.setMipSRGB(n),a.setQualityLevel(r),a.setUASTC(i),a.setMipGen(o);const s=a.encode(e);return e.subarray(0,s).buffer}catch(t){throw console.error("Basis Universal Supercompressed GPU Texture encoder Error: ",t),t}finally{a.delete()}}},xt=n(63666),wt=n(48043),Ct=n(63666);function St(t,e,n){let r="function"==typeof t?t({...e,...n}):t;const i=e.baseUrl;return i&&(r="/"===i[i.length-1]?`${i}${r}`:`${i}/${r}`),(0,Ct.resolvePath)(r)}var Et=t=>t&&"object"==typeof t;async function Mt(t,e,n){if(Array.isArray(t))return await async function(t,e,n={}){const r=t.map((t=>Mt(t,e,n)));return await Promise.all(r)}(t,e,n);if(Et(t))return await async function(t,e,n){const r=[],i={};for(const o in t){const s=Mt(t[o],e,n).then((t=>{i[o]=t}));r.push(s)}return await Promise.all(r),i}(t,e,n);const r=t;return await e(r,n)}async function Pt(t,e,n){return await async function(t,e,n={}){return await Mt(t,e,n)}(t,(t=>Tt(t,e,n)))}async function Tt(t,e,n){const r=await fetch(t,n.fetch),i=await r.arrayBuffer();return await e(i,n)}async function Ot(t,e={}){const n=await It(t,e);return await Pt(n,wt.ImageLoader.parse,e)}async function It(t,e,n={}){const r=e&&e.image&&e.image.mipLevels||0;return 0!==r?await async function(t,e,n,r){const i=[];if("auto"===e){const s=St(t,n,{...r,lod:0}),a=await Tt(s,wt.ImageLoader.parse,n),{width:l,height:u}=(0,wt.getImageSize)(a);o={width:l,height:u},e=1+Math.floor(Math.log2(Math.max(o.width,o.height))),i.push(s)}var o;(0,xt.assert)(e>0);for(let o=i.length;o<e;++o){const e=St(t,n,{...r,lod:o});i.push(e)}return i}(t,r,e,n):St(t,e,n)}var Rt=n(48043);async function Bt(t,e,n={}){const r=await async function(t,e,n={}){const r=[];for(let i=0;i<t;i++){const t=It(e,n,{index:i});r.push(t)}return await Promise.all(r)}(t,e,n);return await Pt(r,Rt.ImageLoader.parse,n)}var Lt=n(48043),kt=[{face:34069,direction:"right",axis:"x",sign:"positive"},{face:34070,direction:"left",axis:"x",sign:"negative"},{face:34071,direction:"top",axis:"y",sign:"positive"},{face:34072,direction:"bottom",axis:"y",sign:"negative"},{face:34073,direction:"front",axis:"z",sign:"positive"},{face:34074,direction:"back",axis:"z",sign:"negative"}];async function Dt(t,e={}){const n=await async function(t,e){const n={},r=[];let i=0;for(let o=0;o<kt.length;++o){const o=kt[i],s=It(t,e,{...o,index:i++}).then((t=>{n[o.face]=t}));r.push(s)}return await Promise.all(r),n}(t,e);return await Pt(n,Lt.ImageLoader.parse,e)}var Ft={name:"Basis Universal Supercompressed GPU Texture",id:"ktx2-basis-writer",module:"textures",version:h,extensions:["ktx2"],worker:!0,options:{useSRGB:!1,qualityLevel:10,encodeUASTC:!1,mipmaps:!1}}},54054:t=>{var e,n=Object.defineProperty,r=Object.getOwnPropertyDescriptor,i=Object.getOwnPropertyNames,o=Object.prototype.hasOwnProperty,s=(t,e)=>{for(var r in e)n(t,r,{get:e[r],enumerable:!0})},a={};s(a,{Euler:()=>po,Matrix3:()=>xn,Matrix4:()=>bi,Pose:()=>go,Quaternion:()=>lo,SphericalCoordinates:()=>co,Vector2:()=>kt,Vector3:()=>ke,Vector4:()=>De,_Euler:()=>po,_MathUtils:()=>yo,_Pose:()=>go,_SphericalCoordinates:()=>co,acos:()=>w,asin:()=>x,assert:()=>L,atan:()=>C,clamp:()=>S,clone:()=>p,config:()=>c,configure:()=>h,cos:()=>_,degrees:()=>v,equals:()=>M,exactEquals:()=>P,formatValue:()=>d,isArray:()=>f,lerp:()=>E,mat3:()=>Ne,mat4:()=>Cn,quat:()=>Ai,radians:()=>m,sin:()=>b,tan:()=>A,toDegrees:()=>y,toRadians:()=>g,vec2:()=>D,vec3:()=>Dt,vec4:()=>wr,withEpsilon:()=>T}),t.exports=(e=a,((t,e,s,a)=>{if(e&&"object"==typeof e||"function"==typeof e)for(let s of i(e))o.call(t,s)||undefined===s||n(t,s,{get:()=>e[s],enumerable:!(a=r(e,s))||a.enumerable});return t})(n({},"__esModule",{value:!0}),e));var l=1/Math.PI*180,u=1/180*Math.PI;globalThis.mathgl=globalThis.mathgl||{config:{EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0,_cartographicRadians:!1}};var c=globalThis.mathgl.config;function h(t){return Object.assign(c,t),c}function d(t,{precision:e=c.precision}={}){return t=function(t){return Math.round(t/c.EPSILON)*c.EPSILON}(t),`${parseFloat(t.toPrecision(e))}`}function f(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function p(t){return"clone"in t?t.clone():t.slice()}function g(t){return m(t)}function y(t){return v(t)}function m(t,e){return O(t,(t=>t*u),e)}function v(t,e){return O(t,(t=>t*l),e)}function b(t,e){return O(t,(t=>Math.sin(t)),e)}function _(t,e){return O(t,(t=>Math.cos(t)),e)}function A(t,e){return O(t,(t=>Math.tan(t)),e)}function x(t,e){return O(t,(t=>Math.asin(t)),e)}function w(t,e){return O(t,(t=>Math.acos(t)),e)}function C(t,e){return O(t,(t=>Math.atan(t)),e)}function S(t,e,n){return O(t,(t=>Math.max(e,Math.min(n,t))))}function E(t,e,n){return f(t)?t.map(((t,r)=>E(t,e[r],n))):n*e+(1-n)*t}function M(t,e,n){const r=c.EPSILON;n&&(c.EPSILON=n);try{if(t===e)return!0;if(f(t)&&f(e)){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!M(t[n],e[n]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):"number"==typeof t&&"number"==typeof e&&Math.abs(t-e)<=c.EPSILON*Math.max(1,Math.abs(t),Math.abs(e))}finally{c.EPSILON=r}}function P(t,e){if(t===e)return!0;if(t&&"object"==typeof t&&e&&"object"==typeof e){if(t.constructor!==e.constructor)return!1;if(t.exactEquals)return t.exactEquals(e)}if(f(t)&&f(e)){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!P(t[n],e[n]))return!1;return!0}return!1}function T(t,e){const n=c.EPSILON;let r;c.EPSILON=t;try{r=e()}finally{c.EPSILON=n}return r}function O(t,e,n){if(f(t)){const r=t;n=n||function(t){return t.clone?t.clone():new Array(t.length)}(r);for(let i=0;i<n.length&&i<r.length;++i){const r="number"==typeof t?t:t[i];n[i]=e(r,i,n)}return n}return e(t)}var I=class extends Array{clone(){return(new this.constructor).copy(this)}fromArray(t,e=0){for(let n=0;n<this.ELEMENTS;++n)this[n]=t[n+e];return this.check()}toArray(t=[],e=0){for(let n=0;n<this.ELEMENTS;++n)t[e+n]=this[n];return t}toObject(t){return t}from(t){return Array.isArray(t)?this.copy(t):this.fromObject(t)}to(t){return t===this?this:f(t)?this.toArray(t):this.toObject(t)}toTarget(t){return t?this.to(t):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(c)}formatString(t){let e="";for(let n=0;n<this.ELEMENTS;++n)e+=(n>0?", ":"")+d(this[n],t);return`${t.printTypes?this.constructor.name:""}[${e}]`}equals(t){if(!t||this.length!==t.length)return!1;for(let e=0;e<this.ELEMENTS;++e)if(!M(this[e],t[e]))return!1;return!0}exactEquals(t){if(!t||this.length!==t.length)return!1;for(let e=0;e<this.ELEMENTS;++e)if(this[e]!==t[e])return!1;return!0}negate(){for(let t=0;t<this.ELEMENTS;++t)this[t]=-this[t];return this.check()}lerp(t,e,n){if(void 0===n)return this.lerp(this,t,e);for(let r=0;r<this.ELEMENTS;++r){const i=t[r],o="number"==typeof e?e:e[r];this[r]=i+n*(o-i)}return this.check()}min(t){for(let e=0;e<this.ELEMENTS;++e)this[e]=Math.min(t[e],this[e]);return this.check()}max(t){for(let e=0;e<this.ELEMENTS;++e)this[e]=Math.max(t[e],this[e]);return this.check()}clamp(t,e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t[n]),e[n]);return this.check()}add(...t){for(const e of t)for(let t=0;t<this.ELEMENTS;++t)this[t]+=e[t];return this.check()}subtract(...t){for(const e of t)for(let t=0;t<this.ELEMENTS;++t)this[t]-=e[t];return this.check()}scale(t){if("number"==typeof t)for(let e=0;e<this.ELEMENTS;++e)this[e]*=t;else for(let e=0;e<this.ELEMENTS&&e<t.length;++e)this[e]*=t[e];return this.check()}multiplyByScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]*=t;return this.check()}check(){if(c.debug&&!this.validate())throw new Error(`math.gl: ${this.constructor.name} some fields set to invalid numbers'`);return this}validate(){let t=this.length===this.ELEMENTS;for(let e=0;e<this.ELEMENTS;++e)t=t&&Number.isFinite(this[e]);return t}sub(t){return this.subtract(t)}setScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]=t;return this.check()}addScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]+=t;return this.check()}subScalar(t){return this.addScalar(-t)}multiplyScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]*=t;return this.check()}divideScalar(t){return this.multiplyByScalar(1/t)}clampScalar(t,e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t),e);return this.check()}get elements(){return this}};function R(t){if(!Number.isFinite(t))throw new Error(`Invalid number ${JSON.stringify(t)}`);return t}function B(t,e,n=""){if(c.debug&&!function(t,e){if(t.length!==e)return!1;for(let e=0;e<t.length;++e)if(!Number.isFinite(t[e]))return!1;return!0}(t,e))throw new Error(`math.gl: ${n} some fields set to invalid numbers'`);return t}function L(t,e){if(!t)throw new Error(`math.gl assertion ${e}`)}var k=class extends I{get x(){return this[0]}set x(t){this[0]=R(t)}get y(){return this[1]}set y(t){this[1]=R(t)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let t=0;for(let e=0;e<this.ELEMENTS;++e)t+=this[e]*this[e];return t}magnitudeSquared(){return this.lengthSquared()}distance(t){return Math.sqrt(this.distanceSquared(t))}distanceSquared(t){let e=0;for(let n=0;n<this.ELEMENTS;++n){const r=this[n]-t[n];e+=r*r}return R(e)}dot(t){let e=0;for(let n=0;n<this.ELEMENTS;++n)e+=this[n]*t[n];return R(e)}normalize(){const t=this.magnitude();if(0!==t)for(let e=0;e<this.ELEMENTS;++e)this[e]/=t;return this.check()}multiply(...t){for(const e of t)for(let t=0;t<this.ELEMENTS;++t)this[t]*=e[t];return this.check()}divide(...t){for(const e of t)for(let t=0;t<this.ELEMENTS;++t)this[t]/=e[t];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(t){return this.distance(t)}distanceToSquared(t){return this.distanceSquared(t)}getComponent(t){return L(t>=0&&t<this.ELEMENTS,"index is out of range"),R(this[t])}setComponent(t,e){return L(t>=0&&t<this.ELEMENTS,"index is out of range"),this[t]=e,this.check()}addVectors(t,e){return this.copy(t).add(e)}subVectors(t,e){return this.copy(t).subtract(e)}multiplyVectors(t,e){return this.copy(t).multiply(e)}addScaledVector(t,e){return this.add(new this.constructor(t).multiplyScalar(e))}},D={};s(D,{add:()=>W,angle:()=>bt,ceil:()=>K,clone:()=>z,copy:()=>H,create:()=>U,cross:()=>ht,dist:()=>Pt,distance:()=>rt,div:()=>Mt,divide:()=>X,dot:()=>ct,equals:()=>wt,exactEquals:()=>xt,floor:()=>Z,forEach:()=>It,fromValues:()=>V,inverse:()=>lt,len:()=>Ct,length:()=>ot,lerp:()=>dt,max:()=>$,min:()=>Q,mul:()=>Et,multiply:()=>Y,negate:()=>at,normalize:()=>ut,random:()=>ft,rotate:()=>vt,round:()=>tt,scale:()=>et,scaleAndAdd:()=>nt,set:()=>q,sqrDist:()=>Tt,sqrLen:()=>Ot,squaredDistance:()=>it,squaredLength:()=>st,str:()=>At,sub:()=>St,subtract:()=>J,transformMat2:()=>pt,transformMat2d:()=>gt,transformMat3:()=>yt,transformMat4:()=>mt,zero:()=>_t});var F=1e-6,N="undefined"!=typeof Float32Array?Float32Array:Array,j=Math.random;function G(t){return t>=0?Math.round(t):t%.5==0?Math.floor(t):Math.round(t)}function U(){const t=new N(2);return N!=Float32Array&&(t[0]=0,t[1]=0),t}function z(t){const e=new N(2);return e[0]=t[0],e[1]=t[1],e}function V(t,e){const n=new N(2);return n[0]=t,n[1]=e,n}function H(t,e){return t[0]=e[0],t[1]=e[1],t}function q(t,e,n){return t[0]=e,t[1]=n,t}function W(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function J(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}function Y(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t}function X(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t}function K(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t}function Z(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t}function Q(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t}function $(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t}function tt(t,e){return t[0]=G(e[0]),t[1]=G(e[1]),t}function et(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t}function nt(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t}function rt(t,e){const n=e[0]-t[0],r=e[1]-t[1];return Math.sqrt(n*n+r*r)}function it(t,e){const n=e[0]-t[0],r=e[1]-t[1];return n*n+r*r}function ot(t){const e=t[0],n=t[1];return Math.sqrt(e*e+n*n)}function st(t){const e=t[0],n=t[1];return e*e+n*n}function at(t,e){return t[0]=-e[0],t[1]=-e[1],t}function lt(t,e){return t[0]=1/e[0],t[1]=1/e[1],t}function ut(t,e){const n=e[0],r=e[1];let i=n*n+r*r;return i>0&&(i=1/Math.sqrt(i)),t[0]=e[0]*i,t[1]=e[1]*i,t}function ct(t,e){return t[0]*e[0]+t[1]*e[1]}function ht(t,e,n){const r=e[0]*n[1]-e[1]*n[0];return t[0]=t[1]=0,t[2]=r,t}function dt(t,e,n,r){const i=e[0],o=e[1];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t}function ft(t,e){e=void 0===e?1:e;const n=2*j()*Math.PI;return t[0]=Math.cos(n)*e,t[1]=Math.sin(n)*e,t}function pt(t,e,n){const r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t}function gt(t,e,n){const r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i+n[4],t[1]=n[1]*r+n[3]*i+n[5],t}function yt(t,e,n){const r=e[0],i=e[1];return t[0]=n[0]*r+n[3]*i+n[6],t[1]=n[1]*r+n[4]*i+n[7],t}function mt(t,e,n){const r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t}function vt(t,e,n,r){const i=e[0]-n[0],o=e[1]-n[1],s=Math.sin(r),a=Math.cos(r);return t[0]=i*a-o*s+n[0],t[1]=i*s+o*a+n[1],t}function bt(t,e){const n=t[0],r=t[1],i=e[0],o=e[1],s=Math.sqrt((n*n+r*r)*(i*i+o*o)),a=s&&(n*i+r*o)/s;return Math.acos(Math.min(Math.max(a,-1),1))}function _t(t){return t[0]=0,t[1]=0,t}function At(t){return`vec2(${t[0]}, ${t[1]})`}function xt(t,e){return t[0]===e[0]&&t[1]===e[1]}function wt(t,e){const n=t[0],r=t[1],i=e[0],o=e[1];return Math.abs(n-i)<=F*Math.max(1,Math.abs(n),Math.abs(i))&&Math.abs(r-o)<=F*Math.max(1,Math.abs(r),Math.abs(o))}Math.PI;var Ct=ot,St=J,Et=Y,Mt=X,Pt=rt,Tt=it,Ot=st,It=function(){const t=U();return function(e,n,r,i,o,s){let a,l;for(n||(n=2),r||(r=0),l=i?Math.min(i*n+r,e.length):e.length,a=r;a<l;a+=n)t[0]=e[a],t[1]=e[a+1],o(t,t,s),e[a]=t[0],e[a+1]=t[1];return e}}();function Rt(t,e,n){const r=e[0],i=e[1],o=n[3]*r+n[7]*i||1;return t[0]=(n[0]*r+n[4]*i)/o,t[1]=(n[1]*r+n[5]*i)/o,t}function Bt(t,e,n){const r=e[0],i=e[1],o=e[2],s=n[3]*r+n[7]*i+n[11]*o||1;return t[0]=(n[0]*r+n[4]*i+n[8]*o)/s,t[1]=(n[1]*r+n[5]*i+n[9]*o)/s,t[2]=(n[2]*r+n[6]*i+n[10]*o)/s,t}function Lt(t,e,n){const r=e[0],i=e[1],o=e[2];return t[0]=n[0]*r+n[3]*i+n[6]*o,t[1]=n[1]*r+n[4]*i+n[7]*o,t[2]=n[2]*r+n[5]*i+n[8]*o,t[3]=e[3],t}var kt=class extends k{constructor(t=0,e=0){super(2),f(t)&&1===arguments.length?this.copy(t):(c.debug&&(R(t),R(e)),this[0]=t,this[1]=e)}set(t,e){return this[0]=t,this[1]=e,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this.check()}fromObject(t){return c.debug&&(R(t.x),R(t.y)),this[0]=t.x,this[1]=t.y,this.check()}toObject(t){return t.x=this[0],t.y=this[1],t}get ELEMENTS(){return 2}horizontalAngle(){return Math.atan2(this.y,this.x)}verticalAngle(){return Math.atan2(this.x,this.y)}transform(t){return this.transformAsPoint(t)}transformAsPoint(t){return mt(this,this,t),this.check()}transformAsVector(t){return Rt(this,this,t),this.check()}transformByMatrix3(t){return yt(this,this,t),this.check()}transformByMatrix2x3(t){return gt(this,this,t),this.check()}transformByMatrix2(t){return pt(this,this,t),this.check()}},Dt={};function Ft(){const t=new N(3);return N!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function Nt(t){const e=new N(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function jt(t){const e=t[0],n=t[1],r=t[2];return Math.sqrt(e*e+n*n+r*r)}function Gt(t,e,n){const r=new N(3);return r[0]=t,r[1]=e,r[2]=n,r}function Ut(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function zt(t,e,n,r){return t[0]=e,t[1]=n,t[2]=r,t}function Vt(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function Ht(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function qt(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function Wt(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t}function Jt(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}function Yt(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}function Xt(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t}function Kt(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t}function Zt(t,e){return t[0]=G(e[0]),t[1]=G(e[1]),t[2]=G(e[2]),t}function Qt(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function $t(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t}function te(t,e){const n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return Math.sqrt(n*n+r*r+i*i)}function ee(t,e){const n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return n*n+r*r+i*i}function ne(t){const e=t[0],n=t[1],r=t[2];return e*e+n*n+r*r}function re(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function ie(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function oe(t,e){const n=e[0],r=e[1],i=e[2];let o=n*n+r*r+i*i;return o>0&&(o=1/Math.sqrt(o)),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o,t}function se(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function ae(t,e,n){const r=e[0],i=e[1],o=e[2],s=n[0],a=n[1],l=n[2];return t[0]=i*l-o*a,t[1]=o*s-r*l,t[2]=r*a-i*s,t}function le(t,e,n,r){const i=e[0],o=e[1],s=e[2];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t[2]=s+r*(n[2]-s),t}function ue(t,e,n,r){const i=Math.acos(Math.min(Math.max(se(e,n),-1),1)),o=Math.sin(i),s=Math.sin((1-r)*i)/o,a=Math.sin(r*i)/o;return t[0]=s*e[0]+a*n[0],t[1]=s*e[1]+a*n[1],t[2]=s*e[2]+a*n[2],t}function ce(t,e,n,r,i,o){const s=o*o,a=s*(2*o-3)+1,l=s*(o-2)+o,u=s*(o-1),c=s*(3-2*o);return t[0]=e[0]*a+n[0]*l+r[0]*u+i[0]*c,t[1]=e[1]*a+n[1]*l+r[1]*u+i[1]*c,t[2]=e[2]*a+n[2]*l+r[2]*u+i[2]*c,t}function he(t,e,n,r,i,o){const s=1-o,a=s*s,l=o*o,u=a*s,c=3*o*a,h=3*l*s,d=l*o;return t[0]=e[0]*u+n[0]*c+r[0]*h+i[0]*d,t[1]=e[1]*u+n[1]*c+r[1]*h+i[1]*d,t[2]=e[2]*u+n[2]*c+r[2]*h+i[2]*d,t}function de(t,e){e=void 0===e?1:e;const n=2*j()*Math.PI,r=2*j()-1,i=Math.sqrt(1-r*r)*e;return t[0]=Math.cos(n)*i,t[1]=Math.sin(n)*i,t[2]=r*e,t}function fe(t,e,n){const r=e[0],i=e[1],o=e[2];let s=n[3]*r+n[7]*i+n[11]*o+n[15];return s=s||1,t[0]=(n[0]*r+n[4]*i+n[8]*o+n[12])/s,t[1]=(n[1]*r+n[5]*i+n[9]*o+n[13])/s,t[2]=(n[2]*r+n[6]*i+n[10]*o+n[14])/s,t}function pe(t,e,n){const r=e[0],i=e[1],o=e[2];return t[0]=r*n[0]+i*n[3]+o*n[6],t[1]=r*n[1]+i*n[4]+o*n[7],t[2]=r*n[2]+i*n[5]+o*n[8],t}function ge(t,e,n){const r=n[0],i=n[1],o=n[2],s=n[3],a=e[0],l=e[1],u=e[2];let c=i*u-o*l,h=o*a-r*u,d=r*l-i*a,f=i*d-o*h,p=o*c-r*d,g=r*h-i*c;const y=2*s;return c*=y,h*=y,d*=y,f*=2,p*=2,g*=2,t[0]=a+c+f,t[1]=l+h+p,t[2]=u+d+g,t}function ye(t,e,n,r){const i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[0],o[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),o[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function me(t,e,n,r){const i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),o[1]=i[1],o[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function ve(t,e,n,r){const i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),o[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),o[2]=i[2],t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function be(t,e){const n=t[0],r=t[1],i=t[2],o=e[0],s=e[1],a=e[2],l=Math.sqrt((n*n+r*r+i*i)*(o*o+s*s+a*a)),u=l&&se(t,e)/l;return Math.acos(Math.min(Math.max(u,-1),1))}function _e(t){return t[0]=0,t[1]=0,t[2]=0,t}function Ae(t){return`vec3(${t[0]}, ${t[1]}, ${t[2]})`}function xe(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function we(t,e){const n=t[0],r=t[1],i=t[2],o=e[0],s=e[1],a=e[2];return Math.abs(n-o)<=F*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(r-s)<=F*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(i-a)<=F*Math.max(1,Math.abs(i),Math.abs(a))}s(Dt,{add:()=>Vt,angle:()=>be,bezier:()=>he,ceil:()=>Jt,clone:()=>Nt,copy:()=>Ut,create:()=>Ft,cross:()=>ae,dist:()=>Te,distance:()=>te,div:()=>Pe,divide:()=>Wt,dot:()=>se,equals:()=>we,exactEquals:()=>xe,floor:()=>Yt,forEach:()=>Be,fromValues:()=>Gt,hermite:()=>ce,inverse:()=>ie,len:()=>Ie,length:()=>jt,lerp:()=>le,max:()=>Kt,min:()=>Xt,mul:()=>Me,multiply:()=>qt,negate:()=>re,normalize:()=>oe,random:()=>de,rotateX:()=>ye,rotateY:()=>me,rotateZ:()=>ve,round:()=>Zt,scale:()=>Qt,scaleAndAdd:()=>$t,set:()=>zt,slerp:()=>ue,sqrDist:()=>Oe,sqrLen:()=>Re,squaredDistance:()=>ee,squaredLength:()=>ne,str:()=>Ae,sub:()=>Ee,subtract:()=>Ht,transformMat3:()=>pe,transformMat4:()=>fe,transformQuat:()=>ge,zero:()=>_e});var Ce,Se,Ee=Ht,Me=qt,Pe=Wt,Te=te,Oe=ee,Ie=jt,Re=ne,Be=function(){const t=Ft();return function(e,n,r,i,o,s){let a,l;for(n||(n=3),r||(r=0),l=i?Math.min(i*n+r,e.length):e.length,a=r;a<l;a+=n)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],o(t,t,s),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2];return e}}(),Le=[0,0,0],ke=class extends k{static get ZERO(){return Ce||(Ce=new ke(0,0,0),Object.freeze(Ce)),Ce}constructor(t=0,e=0,n=0){super(-0,-0,-0),1===arguments.length&&f(t)?this.copy(t):(c.debug&&(R(t),R(e),R(n)),this[0]=t,this[1]=e,this[2]=n)}set(t,e,n){return this[0]=t,this[1]=e,this[2]=n,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this.check()}fromObject(t){return c.debug&&(R(t.x),R(t.y),R(t.z)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this.check()}toObject(t){return t.x=this[0],t.y=this[1],t.z=this[2],t}get ELEMENTS(){return 3}get z(){return this[2]}set z(t){this[2]=R(t)}angle(t){return be(this,t)}cross(t){return ae(this,this,t),this.check()}rotateX({radians:t,origin:e=Le}){return ye(this,this,e,t),this.check()}rotateY({radians:t,origin:e=Le}){return me(this,this,e,t),this.check()}rotateZ({radians:t,origin:e=Le}){return ve(this,this,e,t),this.check()}transform(t){return this.transformAsPoint(t)}transformAsPoint(t){return fe(this,this,t),this.check()}transformAsVector(t){return Bt(this,this,t),this.check()}transformByMatrix3(t){return pe(this,this,t),this.check()}transformByMatrix2(t){return function(t,e,n){const r=e[0],i=e[1];t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t[2]=e[2]}(this,this,t),this.check()}transformByQuaternion(t){return ge(this,this,t),this.check()}},De=class extends k{static get ZERO(){return Se||(Se=new De(0,0,0,0),Object.freeze(Se)),Se}constructor(t=0,e=0,n=0,r=0){super(-0,-0,-0,-0),f(t)&&1===arguments.length?this.copy(t):(c.debug&&(R(t),R(e),R(n),R(r)),this[0]=t,this[1]=e,this[2]=n,this[3]=r)}set(t,e,n,r){return this[0]=t,this[1]=e,this[2]=n,this[3]=r,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this.check()}fromObject(t){return c.debug&&(R(t.x),R(t.y),R(t.z),R(t.w)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this[3]=t.w,this}toObject(t){return t.x=this[0],t.y=this[1],t.z=this[2],t.w=this[3],t}get ELEMENTS(){return 4}get z(){return this[2]}set z(t){this[2]=R(t)}get w(){return this[3]}set w(t){this[3]=R(t)}transform(t){return fe(this,this,t),this.check()}transformByMatrix3(t){return Lt(this,this,t),this.check()}transformByMatrix2(t){return function(t,e,n){const r=e[0],i=e[1];t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t[2]=e[2],t[3]=e[3]}(this,this,t),this.check()}transformByQuaternion(t){return ge(this,this,t),this.check()}applyMatrix4(t){return t.transform(this,this),this}},Fe=class extends I{toString(){let t="[";if(c.printRowMajor){t+="row-major:";for(let e=0;e<this.RANK;++e)for(let n=0;n<this.RANK;++n)t+=` ${this[n*this.RANK+e]}`}else{t+="column-major:";for(let e=0;e<this.ELEMENTS;++e)t+=` ${this[e]}`}return t+="]",t}getElementIndex(t,e){return e*this.RANK+t}getElement(t,e){return this[e*this.RANK+t]}setElement(t,e,n){return this[e*this.RANK+t]=R(n),this}getColumn(t,e=new Array(this.RANK).fill(-0)){const n=t*this.RANK;for(let t=0;t<this.RANK;++t)e[t]=this[n+t];return e}setColumn(t,e){const n=t*this.RANK;for(let t=0;t<this.RANK;++t)this[n+t]=e[t];return this}},Ne={};function je(){const t=new N(9);return N!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function Ge(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}function Ue(t){const e=new N(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function ze(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function Ve(t,e,n,r,i,o,s,a,l){const u=new N(9);return u[0]=t,u[1]=e,u[2]=n,u[3]=r,u[4]=i,u[5]=o,u[6]=s,u[7]=a,u[8]=l,u}function He(t,e,n,r,i,o,s,a,l,u){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=o,t[5]=s,t[6]=a,t[7]=l,t[8]=u,t}function qe(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function We(t,e){if(t===e){const n=e[1],r=e[2],i=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=r,t[7]=i}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function Je(t,e){const n=e[0],r=e[1],i=e[2],o=e[3],s=e[4],a=e[5],l=e[6],u=e[7],c=e[8],h=c*s-a*u,d=-c*o+a*l,f=u*o-s*l;let p=n*h+r*d+i*f;return p?(p=1/p,t[0]=h*p,t[1]=(-c*r+i*u)*p,t[2]=(a*r-i*s)*p,t[3]=d*p,t[4]=(c*n-i*l)*p,t[5]=(-a*n+i*o)*p,t[6]=f*p,t[7]=(-u*n+r*l)*p,t[8]=(s*n-r*o)*p,t):null}function Ye(t,e){const n=e[0],r=e[1],i=e[2],o=e[3],s=e[4],a=e[5],l=e[6],u=e[7],c=e[8];return t[0]=s*c-a*u,t[1]=i*u-r*c,t[2]=r*a-i*s,t[3]=a*l-o*c,t[4]=n*c-i*l,t[5]=i*o-n*a,t[6]=o*u-s*l,t[7]=r*l-n*u,t[8]=n*s-r*o,t}function Xe(t){const e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],s=t[5],a=t[6],l=t[7],u=t[8];return e*(u*o-s*l)+n*(-u*i+s*a)+r*(l*i-o*a)}function Ke(t,e,n){const r=e[0],i=e[1],o=e[2],s=e[3],a=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=n[0],f=n[1],p=n[2],g=n[3],y=n[4],m=n[5],v=n[6],b=n[7],_=n[8];return t[0]=d*r+f*s+p*u,t[1]=d*i+f*a+p*c,t[2]=d*o+f*l+p*h,t[3]=g*r+y*s+m*u,t[4]=g*i+y*a+m*c,t[5]=g*o+y*l+m*h,t[6]=v*r+b*s+_*u,t[7]=v*i+b*a+_*c,t[8]=v*o+b*l+_*h,t}function Ze(t,e,n){const r=e[0],i=e[1],o=e[2],s=e[3],a=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=n[0],f=n[1];return t[0]=r,t[1]=i,t[2]=o,t[3]=s,t[4]=a,t[5]=l,t[6]=d*r+f*s+u,t[7]=d*i+f*a+c,t[8]=d*o+f*l+h,t}function Qe(t,e,n){const r=e[0],i=e[1],o=e[2],s=e[3],a=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=Math.sin(n),f=Math.cos(n);return t[0]=f*r+d*s,t[1]=f*i+d*a,t[2]=f*o+d*l,t[3]=f*s-d*r,t[4]=f*a-d*i,t[5]=f*l-d*o,t[6]=u,t[7]=c,t[8]=h,t}function $e(t,e,n){const r=n[0],i=n[1];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=i*e[3],t[4]=i*e[4],t[5]=i*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function tn(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t}function en(t,e){const n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=-n,t[4]=r,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function nn(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function rn(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t}function on(t,e){const n=e[0],r=e[1],i=e[2],o=e[3],s=n+n,a=r+r,l=i+i,u=n*s,c=r*s,h=r*a,d=i*s,f=i*a,p=i*l,g=o*s,y=o*a,m=o*l;return t[0]=1-h-p,t[3]=c-m,t[6]=d+y,t[1]=c+m,t[4]=1-u-p,t[7]=f-g,t[2]=d-y,t[5]=f+g,t[8]=1-u-h,t}function sn(t,e){const n=e[0],r=e[1],i=e[2],o=e[3],s=e[4],a=e[5],l=e[6],u=e[7],c=e[8],h=e[9],d=e[10],f=e[11],p=e[12],g=e[13],y=e[14],m=e[15],v=n*a-r*s,b=n*l-i*s,_=n*u-o*s,A=r*l-i*a,x=r*u-o*a,w=i*u-o*l,C=c*g-h*p,S=c*y-d*p,E=c*m-f*p,M=h*y-d*g,P=h*m-f*g,T=d*m-f*y;let O=v*T-b*P+_*M+A*E-x*S+w*C;return O?(O=1/O,t[0]=(a*T-l*P+u*M)*O,t[1]=(l*E-s*T-u*S)*O,t[2]=(s*P-a*E+u*C)*O,t[3]=(i*P-r*T-o*M)*O,t[4]=(n*T-i*E+o*S)*O,t[5]=(r*E-n*P-o*C)*O,t[6]=(g*w-y*x+m*A)*O,t[7]=(y*_-p*w-m*b)*O,t[8]=(p*x-g*_+m*v)*O,t):null}function an(t,e,n){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/n,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}function ln(t){return`mat3(${t[0]}, ${t[1]}, ${t[2]}, ${t[3]}, ${t[4]}, ${t[5]}, ${t[6]}, ${t[7]}, ${t[8]})`}function un(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]+t[3]*t[3]+t[4]*t[4]+t[5]*t[5]+t[6]*t[6]+t[7]*t[7]+t[8]*t[8])}function cn(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t}function hn(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t}function dn(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t}function fn(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t}function pn(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]}function gn(t,e){const n=t[0],r=t[1],i=t[2],o=t[3],s=t[4],a=t[5],l=t[6],u=t[7],c=t[8],h=e[0],d=e[1],f=e[2],p=e[3],g=e[4],y=e[5],m=e[6],v=e[7],b=e[8];return Math.abs(n-h)<=F*Math.max(1,Math.abs(n),Math.abs(h))&&Math.abs(r-d)<=F*Math.max(1,Math.abs(r),Math.abs(d))&&Math.abs(i-f)<=F*Math.max(1,Math.abs(i),Math.abs(f))&&Math.abs(o-p)<=F*Math.max(1,Math.abs(o),Math.abs(p))&&Math.abs(s-g)<=F*Math.max(1,Math.abs(s),Math.abs(g))&&Math.abs(a-y)<=F*Math.max(1,Math.abs(a),Math.abs(y))&&Math.abs(l-m)<=F*Math.max(1,Math.abs(l),Math.abs(m))&&Math.abs(u-v)<=F*Math.max(1,Math.abs(u),Math.abs(v))&&Math.abs(c-b)<=F*Math.max(1,Math.abs(c),Math.abs(b))}s(Ne,{add:()=>cn,adjoint:()=>Ye,clone:()=>Ue,copy:()=>ze,create:()=>je,determinant:()=>Xe,equals:()=>gn,exactEquals:()=>pn,frob:()=>un,fromMat2d:()=>rn,fromMat4:()=>Ge,fromQuat:()=>on,fromRotation:()=>en,fromScaling:()=>nn,fromTranslation:()=>tn,fromValues:()=>Ve,identity:()=>qe,invert:()=>Je,mul:()=>vn,multiply:()=>Ke,multiplyScalar:()=>dn,multiplyScalarAndAdd:()=>fn,normalFromMat4:()=>sn,projection:()=>an,rotate:()=>Qe,scale:()=>$e,set:()=>He,str:()=>ln,sub:()=>bn,subtract:()=>hn,translate:()=>Ze,transpose:()=>We});var yn,mn,vn=Ke,bn=hn;(mn=yn||(yn={}))[mn.COL0ROW0=0]="COL0ROW0",mn[mn.COL0ROW1=1]="COL0ROW1",mn[mn.COL0ROW2=2]="COL0ROW2",mn[mn.COL1ROW0=3]="COL1ROW0",mn[mn.COL1ROW1=4]="COL1ROW1",mn[mn.COL1ROW2=5]="COL1ROW2",mn[mn.COL2ROW0=6]="COL2ROW0",mn[mn.COL2ROW1=7]="COL2ROW1",mn[mn.COL2ROW2=8]="COL2ROW2";var _n,An=Object.freeze([1,0,0,0,1,0,0,0,1]),xn=class extends Fe{static get IDENTITY(){return wn||(wn=new xn,Object.freeze(wn)),wn}static get ZERO(){return _n||(_n=new xn([0,0,0,0,0,0,0,0,0]),Object.freeze(_n)),_n}get ELEMENTS(){return 9}get RANK(){return 3}get INDICES(){return yn}constructor(t,...e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(t)?this.copy(t):e.length>0?this.copy([t,...e]):this.identity()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this.check()}identity(){return this.copy(An)}fromObject(t){return this.check()}fromQuaternion(t){return on(this,t),this.check()}set(t,e,n,r,i,o,s,a,l){return this[0]=t,this[1]=e,this[2]=n,this[3]=r,this[4]=i,this[5]=o,this[6]=s,this[7]=a,this[8]=l,this.check()}setRowMajor(t,e,n,r,i,o,s,a,l){return this[0]=t,this[1]=r,this[2]=s,this[3]=e,this[4]=i,this[5]=a,this[6]=n,this[7]=o,this[8]=l,this.check()}determinant(){return Xe(this)}transpose(){return We(this,this),this.check()}invert(){return Je(this,this),this.check()}multiplyLeft(t){return Ke(this,t,this),this.check()}multiplyRight(t){return Ke(this,this,t),this.check()}rotate(t){return Qe(this,this,t),this.check()}scale(t){return Array.isArray(t)?$e(this,this,t):$e(this,this,[t,t]),this.check()}translate(t){return Ze(this,this,t),this.check()}transform(t,e){let n;switch(t.length){case 2:n=yt(e||[-0,-0],t,this);break;case 3:n=pe(e||[-0,-0,-0],t,this);break;case 4:n=Lt(e||[-0,-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return B(n,t.length),n}transformVector(t,e){return this.transform(t,e)}transformVector2(t,e){return this.transform(t,e)}transformVector3(t,e){return this.transform(t,e)}},wn=null,Cn={};function Sn(){const t=new N(16);return N!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function En(t){const e=new N(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Mn(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Pn(t,e,n,r,i,o,s,a,l,u,c,h,d,f,p,g){const y=new N(16);return y[0]=t,y[1]=e,y[2]=n,y[3]=r,y[4]=i,y[5]=o,y[6]=s,y[7]=a,y[8]=l,y[9]=u,y[10]=c,y[11]=h,y[12]=d,y[13]=f,y[14]=p,y[15]=g,y}function Tn(t,e,n,r,i,o,s,a,l,u,c,h,d,f,p,g,y){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=o,t[5]=s,t[6]=a,t[7]=l,t[8]=u,t[9]=c,t[10]=h,t[11]=d,t[12]=f,t[13]=p,t[14]=g,t[15]=y,t}function On(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function In(t,e){if(t===e){const n=e[1],r=e[2],i=e[3],o=e[6],s=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=o,t[11]=e[14],t[12]=i,t[13]=s,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function Rn(t,e){const n=e[0],r=e[1],i=e[2],o=e[3],s=e[4],a=e[5],l=e[6],u=e[7],c=e[8],h=e[9],d=e[10],f=e[11],p=e[12],g=e[13],y=e[14],m=e[15],v=n*a-r*s,b=n*l-i*s,_=n*u-o*s,A=r*l-i*a,x=r*u-o*a,w=i*u-o*l,C=c*g-h*p,S=c*y-d*p,E=c*m-f*p,M=h*y-d*g,P=h*m-f*g,T=d*m-f*y;let O=v*T-b*P+_*M+A*E-x*S+w*C;return O?(O=1/O,t[0]=(a*T-l*P+u*M)*O,t[1]=(i*P-r*T-o*M)*O,t[2]=(g*w-y*x+m*A)*O,t[3]=(d*x-h*w-f*A)*O,t[4]=(l*E-s*T-u*S)*O,t[5]=(n*T-i*E+o*S)*O,t[6]=(y*_-p*w-m*b)*O,t[7]=(c*w-d*_+f*b)*O,t[8]=(s*P-a*E+u*C)*O,t[9]=(r*E-n*P-o*C)*O,t[10]=(p*x-g*_+m*v)*O,t[11]=(h*_-c*x-f*v)*O,t[12]=(a*S-s*M-l*C)*O,t[13]=(n*M-r*S+i*C)*O,t[14]=(g*b-p*A-y*v)*O,t[15]=(c*A-h*b+d*v)*O,t):null}function Bn(t,e){const n=e[0],r=e[1],i=e[2],o=e[3],s=e[4],a=e[5],l=e[6],u=e[7],c=e[8],h=e[9],d=e[10],f=e[11],p=e[12],g=e[13],y=e[14],m=e[15],v=n*a-r*s,b=n*l-i*s,_=n*u-o*s,A=r*l-i*a,x=r*u-o*a,w=i*u-o*l,C=c*g-h*p,S=c*y-d*p,E=c*m-f*p,M=h*y-d*g,P=h*m-f*g,T=d*m-f*y;return t[0]=a*T-l*P+u*M,t[1]=i*P-r*T-o*M,t[2]=g*w-y*x+m*A,t[3]=d*x-h*w-f*A,t[4]=l*E-s*T-u*S,t[5]=n*T-i*E+o*S,t[6]=y*_-p*w-m*b,t[7]=c*w-d*_+f*b,t[8]=s*P-a*E+u*C,t[9]=r*E-n*P-o*C,t[10]=p*x-g*_+m*v,t[11]=h*_-c*x-f*v,t[12]=a*S-s*M-l*C,t[13]=n*M-r*S+i*C,t[14]=g*b-p*A-y*v,t[15]=c*A-h*b+d*v,t}function Ln(t){const e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],s=t[5],a=t[6],l=t[7],u=t[8],c=t[9],h=t[10],d=t[11],f=t[12],p=t[13],g=t[14],y=e*s-n*o,m=e*a-r*o,v=n*a-r*s,b=u*p-c*f,_=u*g-h*f,A=c*g-h*p;return l*(e*A-n*_+r*b)-i*(o*A-s*_+a*b)+t[15]*(u*v-c*m+h*y)-d*(f*v-p*m+g*y)}function kn(t,e,n){const r=e[0],i=e[1],o=e[2],s=e[3],a=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=e[9],f=e[10],p=e[11],g=e[12],y=e[13],m=e[14],v=e[15];let b=n[0],_=n[1],A=n[2],x=n[3];return t[0]=b*r+_*a+A*h+x*g,t[1]=b*i+_*l+A*d+x*y,t[2]=b*o+_*u+A*f+x*m,t[3]=b*s+_*c+A*p+x*v,b=n[4],_=n[5],A=n[6],x=n[7],t[4]=b*r+_*a+A*h+x*g,t[5]=b*i+_*l+A*d+x*y,t[6]=b*o+_*u+A*f+x*m,t[7]=b*s+_*c+A*p+x*v,b=n[8],_=n[9],A=n[10],x=n[11],t[8]=b*r+_*a+A*h+x*g,t[9]=b*i+_*l+A*d+x*y,t[10]=b*o+_*u+A*f+x*m,t[11]=b*s+_*c+A*p+x*v,b=n[12],_=n[13],A=n[14],x=n[15],t[12]=b*r+_*a+A*h+x*g,t[13]=b*i+_*l+A*d+x*y,t[14]=b*o+_*u+A*f+x*m,t[15]=b*s+_*c+A*p+x*v,t}function Dn(t,e,n){const r=n[0],i=n[1],o=n[2];let s,a,l,u,c,h,d,f,p,g,y,m;return e===t?(t[12]=e[0]*r+e[4]*i+e[8]*o+e[12],t[13]=e[1]*r+e[5]*i+e[9]*o+e[13],t[14]=e[2]*r+e[6]*i+e[10]*o+e[14],t[15]=e[3]*r+e[7]*i+e[11]*o+e[15]):(s=e[0],a=e[1],l=e[2],u=e[3],c=e[4],h=e[5],d=e[6],f=e[7],p=e[8],g=e[9],y=e[10],m=e[11],t[0]=s,t[1]=a,t[2]=l,t[3]=u,t[4]=c,t[5]=h,t[6]=d,t[7]=f,t[8]=p,t[9]=g,t[10]=y,t[11]=m,t[12]=s*r+c*i+p*o+e[12],t[13]=a*r+h*i+g*o+e[13],t[14]=l*r+d*i+y*o+e[14],t[15]=u*r+f*i+m*o+e[15]),t}function Fn(t,e,n){const r=n[0],i=n[1],o=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Nn(t,e,n,r){let i,o,s,a,l,u,c,h,d,f,p,g,y,m,v,b,_,A,x,w,C,S,E,M,P=r[0],T=r[1],O=r[2],I=Math.sqrt(P*P+T*T+O*O);return I<F?null:(I=1/I,P*=I,T*=I,O*=I,o=Math.sin(n),i=Math.cos(n),s=1-i,a=e[0],l=e[1],u=e[2],c=e[3],h=e[4],d=e[5],f=e[6],p=e[7],g=e[8],y=e[9],m=e[10],v=e[11],b=P*P*s+i,_=T*P*s+O*o,A=O*P*s-T*o,x=P*T*s-O*o,w=T*T*s+i,C=O*T*s+P*o,S=P*O*s+T*o,E=T*O*s-P*o,M=O*O*s+i,t[0]=a*b+h*_+g*A,t[1]=l*b+d*_+y*A,t[2]=u*b+f*_+m*A,t[3]=c*b+p*_+v*A,t[4]=a*x+h*w+g*C,t[5]=l*x+d*w+y*C,t[6]=u*x+f*w+m*C,t[7]=c*x+p*w+v*C,t[8]=a*S+h*E+g*M,t[9]=l*S+d*E+y*M,t[10]=u*S+f*E+m*M,t[11]=c*S+p*E+v*M,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function jn(t,e,n){const r=Math.sin(n),i=Math.cos(n),o=e[4],s=e[5],a=e[6],l=e[7],u=e[8],c=e[9],h=e[10],d=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*i+u*r,t[5]=s*i+c*r,t[6]=a*i+h*r,t[7]=l*i+d*r,t[8]=u*i-o*r,t[9]=c*i-s*r,t[10]=h*i-a*r,t[11]=d*i-l*r,t}function Gn(t,e,n){const r=Math.sin(n),i=Math.cos(n),o=e[0],s=e[1],a=e[2],l=e[3],u=e[8],c=e[9],h=e[10],d=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i-u*r,t[1]=s*i-c*r,t[2]=a*i-h*r,t[3]=l*i-d*r,t[8]=o*r+u*i,t[9]=s*r+c*i,t[10]=a*r+h*i,t[11]=l*r+d*i,t}function Un(t,e,n){const r=Math.sin(n),i=Math.cos(n),o=e[0],s=e[1],a=e[2],l=e[3],u=e[4],c=e[5],h=e[6],d=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i+u*r,t[1]=s*i+c*r,t[2]=a*i+h*r,t[3]=l*i+d*r,t[4]=u*i-o*r,t[5]=c*i-s*r,t[6]=h*i-a*r,t[7]=d*i-l*r,t}function zn(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function Vn(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Hn(t,e,n){let r,i,o,s=n[0],a=n[1],l=n[2],u=Math.sqrt(s*s+a*a+l*l);return u<F?null:(u=1/u,s*=u,a*=u,l*=u,i=Math.sin(e),r=Math.cos(e),o=1-r,t[0]=s*s*o+r,t[1]=a*s*o+l*i,t[2]=l*s*o-a*i,t[3]=0,t[4]=s*a*o-l*i,t[5]=a*a*o+r,t[6]=l*a*o+s*i,t[7]=0,t[8]=s*l*o+a*i,t[9]=a*l*o-s*i,t[10]=l*l*o+r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function qn(t,e){const n=Math.sin(e),r=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Wn(t,e){const n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Jn(t,e){const n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Yn(t,e,n){const r=e[0],i=e[1],o=e[2],s=e[3],a=r+r,l=i+i,u=o+o,c=r*a,h=r*l,d=r*u,f=i*l,p=i*u,g=o*u,y=s*a,m=s*l,v=s*u;return t[0]=1-(f+g),t[1]=h+v,t[2]=d-m,t[3]=0,t[4]=h-v,t[5]=1-(c+g),t[6]=p+y,t[7]=0,t[8]=d+m,t[9]=p-y,t[10]=1-(c+f),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function Xn(t,e){const n=new N(3),r=-e[0],i=-e[1],o=-e[2],s=e[3],a=e[4],l=e[5],u=e[6],c=e[7],h=r*r+i*i+o*o+s*s;return h>0?(n[0]=2*(a*s+c*r+l*o-u*i)/h,n[1]=2*(l*s+c*i+u*r-a*o)/h,n[2]=2*(u*s+c*o+a*i-l*r)/h):(n[0]=2*(a*s+c*r+l*o-u*i),n[1]=2*(l*s+c*i+u*r-a*o),n[2]=2*(u*s+c*o+a*i-l*r)),Yn(t,e,n),t}function Kn(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function Zn(t,e){const n=e[0],r=e[1],i=e[2],o=e[4],s=e[5],a=e[6],l=e[8],u=e[9],c=e[10];return t[0]=Math.sqrt(n*n+r*r+i*i),t[1]=Math.sqrt(o*o+s*s+a*a),t[2]=Math.sqrt(l*l+u*u+c*c),t}function Qn(t,e){const n=new N(3);Zn(n,e);const r=1/n[0],i=1/n[1],o=1/n[2],s=e[0]*r,a=e[1]*i,l=e[2]*o,u=e[4]*r,c=e[5]*i,h=e[6]*o,d=e[8]*r,f=e[9]*i,p=e[10]*o,g=s+c+p;let y=0;return g>0?(y=2*Math.sqrt(g+1),t[3]=.25*y,t[0]=(h-f)/y,t[1]=(d-l)/y,t[2]=(a-u)/y):s>c&&s>p?(y=2*Math.sqrt(1+s-c-p),t[3]=(h-f)/y,t[0]=.25*y,t[1]=(a+u)/y,t[2]=(d+l)/y):c>p?(y=2*Math.sqrt(1+c-s-p),t[3]=(d-l)/y,t[0]=(a+u)/y,t[1]=.25*y,t[2]=(h+f)/y):(y=2*Math.sqrt(1+p-s-c),t[3]=(a-u)/y,t[0]=(d+l)/y,t[1]=(h+f)/y,t[2]=.25*y),t}function $n(t,e,n,r){e[0]=r[12],e[1]=r[13],e[2]=r[14];const i=r[0],o=r[1],s=r[2],a=r[4],l=r[5],u=r[6],c=r[8],h=r[9],d=r[10];n[0]=Math.sqrt(i*i+o*o+s*s),n[1]=Math.sqrt(a*a+l*l+u*u),n[2]=Math.sqrt(c*c+h*h+d*d);const f=1/n[0],p=1/n[1],g=1/n[2],y=i*f,m=o*p,v=s*g,b=a*f,_=l*p,A=u*g,x=c*f,w=h*p,C=d*g,S=y+_+C;let E=0;return S>0?(E=2*Math.sqrt(S+1),t[3]=.25*E,t[0]=(A-w)/E,t[1]=(x-v)/E,t[2]=(m-b)/E):y>_&&y>C?(E=2*Math.sqrt(1+y-_-C),t[3]=(A-w)/E,t[0]=.25*E,t[1]=(m+b)/E,t[2]=(x+v)/E):_>C?(E=2*Math.sqrt(1+_-y-C),t[3]=(x-v)/E,t[0]=(m+b)/E,t[1]=.25*E,t[2]=(A+w)/E):(E=2*Math.sqrt(1+C-y-_),t[3]=(m-b)/E,t[0]=(x+v)/E,t[1]=(A+w)/E,t[2]=.25*E),t}function tr(t,e,n,r){const i=e[0],o=e[1],s=e[2],a=e[3],l=i+i,u=o+o,c=s+s,h=i*l,d=i*u,f=i*c,p=o*u,g=o*c,y=s*c,m=a*l,v=a*u,b=a*c,_=r[0],A=r[1],x=r[2];return t[0]=(1-(p+y))*_,t[1]=(d+b)*_,t[2]=(f-v)*_,t[3]=0,t[4]=(d-b)*A,t[5]=(1-(h+y))*A,t[6]=(g+m)*A,t[7]=0,t[8]=(f+v)*x,t[9]=(g-m)*x,t[10]=(1-(h+p))*x,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function er(t,e,n,r,i){const o=e[0],s=e[1],a=e[2],l=e[3],u=o+o,c=s+s,h=a+a,d=o*u,f=o*c,p=o*h,g=s*c,y=s*h,m=a*h,v=l*u,b=l*c,_=l*h,A=r[0],x=r[1],w=r[2],C=i[0],S=i[1],E=i[2],M=(1-(g+m))*A,P=(f+_)*A,T=(p-b)*A,O=(f-_)*x,I=(1-(d+m))*x,R=(y+v)*x,B=(p+b)*w,L=(y-v)*w,k=(1-(d+g))*w;return t[0]=M,t[1]=P,t[2]=T,t[3]=0,t[4]=O,t[5]=I,t[6]=R,t[7]=0,t[8]=B,t[9]=L,t[10]=k,t[11]=0,t[12]=n[0]+C-(M*C+O*S+B*E),t[13]=n[1]+S-(P*C+I*S+L*E),t[14]=n[2]+E-(T*C+R*S+k*E),t[15]=1,t}function nr(t,e){const n=e[0],r=e[1],i=e[2],o=e[3],s=n+n,a=r+r,l=i+i,u=n*s,c=r*s,h=r*a,d=i*s,f=i*a,p=i*l,g=o*s,y=o*a,m=o*l;return t[0]=1-h-p,t[1]=c+m,t[2]=d-y,t[3]=0,t[4]=c-m,t[5]=1-u-p,t[6]=f+g,t[7]=0,t[8]=d+y,t[9]=f-g,t[10]=1-u-h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function rr(t,e,n,r,i,o,s){const a=1/(n-e),l=1/(i-r),u=1/(o-s);return t[0]=2*o*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*l,t[6]=0,t[7]=0,t[8]=(n+e)*a,t[9]=(i+r)*l,t[10]=(s+o)*u,t[11]=-1,t[12]=0,t[13]=0,t[14]=s*o*2*u,t[15]=0,t}function ir(t,e,n,r,i){const o=1/Math.tan(e/2);if(t[0]=o/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0){const e=1/(r-i);t[10]=(i+r)*e,t[14]=2*i*r*e}else t[10]=-1,t[14]=-2*r;return t}s(Cn,{add:()=>gr,adjoint:()=>Bn,clone:()=>En,copy:()=>Mn,create:()=>Sn,decompose:()=>$n,determinant:()=>Ln,equals:()=>_r,exactEquals:()=>br,frob:()=>pr,fromQuat:()=>nr,fromQuat2:()=>Xn,fromRotation:()=>Hn,fromRotationTranslation:()=>Yn,fromRotationTranslationScale:()=>tr,fromRotationTranslationScaleOrigin:()=>er,fromScaling:()=>Vn,fromTranslation:()=>zn,fromValues:()=>Pn,fromXRotation:()=>qn,fromYRotation:()=>Wn,fromZRotation:()=>Jn,frustum:()=>rr,getRotation:()=>Qn,getScaling:()=>Zn,getTranslation:()=>Kn,identity:()=>On,invert:()=>Rn,lookAt:()=>hr,mul:()=>Ar,multiply:()=>kn,multiplyScalar:()=>mr,multiplyScalarAndAdd:()=>vr,ortho:()=>ur,orthoNO:()=>lr,orthoZO:()=>cr,perspective:()=>or,perspectiveFromFieldOfView:()=>ar,perspectiveNO:()=>ir,perspectiveZO:()=>sr,rotate:()=>Nn,rotateX:()=>jn,rotateY:()=>Gn,rotateZ:()=>Un,scale:()=>Fn,set:()=>Tn,str:()=>fr,sub:()=>xr,subtract:()=>yr,targetTo:()=>dr,translate:()=>Dn,transpose:()=>In});var or=ir;function sr(t,e,n,r,i){const o=1/Math.tan(e/2);if(t[0]=o/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0){const e=1/(r-i);t[10]=i*e,t[14]=i*r*e}else t[10]=-1,t[14]=-r;return t}function ar(t,e,n,r){const i=Math.tan(e.upDegrees*Math.PI/180),o=Math.tan(e.downDegrees*Math.PI/180),s=Math.tan(e.leftDegrees*Math.PI/180),a=Math.tan(e.rightDegrees*Math.PI/180),l=2/(s+a),u=2/(i+o);return t[0]=l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=u,t[6]=0,t[7]=0,t[8]=-(s-a)*l*.5,t[9]=(i-o)*u*.5,t[10]=r/(n-r),t[11]=-1,t[12]=0,t[13]=0,t[14]=r*n/(n-r),t[15]=0,t}function lr(t,e,n,r,i,o,s){const a=1/(e-n),l=1/(r-i),u=1/(o-s);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+n)*a,t[13]=(i+r)*l,t[14]=(s+o)*u,t[15]=1,t}var ur=lr;function cr(t,e,n,r,i,o,s){const a=1/(e-n),l=1/(r-i),u=1/(o-s);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=u,t[11]=0,t[12]=(e+n)*a,t[13]=(i+r)*l,t[14]=o*u,t[15]=1,t}function hr(t,e,n,r){let i,o,s,a,l,u,c,h,d,f;const p=e[0],g=e[1],y=e[2],m=r[0],v=r[1],b=r[2],_=n[0],A=n[1],x=n[2];return Math.abs(p-_)<F&&Math.abs(g-A)<F&&Math.abs(y-x)<F?On(t):(h=p-_,d=g-A,f=y-x,i=1/Math.sqrt(h*h+d*d+f*f),h*=i,d*=i,f*=i,o=v*f-b*d,s=b*h-m*f,a=m*d-v*h,i=Math.sqrt(o*o+s*s+a*a),i?(i=1/i,o*=i,s*=i,a*=i):(o=0,s=0,a=0),l=d*a-f*s,u=f*o-h*a,c=h*s-d*o,i=Math.sqrt(l*l+u*u+c*c),i?(i=1/i,l*=i,u*=i,c*=i):(l=0,u=0,c=0),t[0]=o,t[1]=l,t[2]=h,t[3]=0,t[4]=s,t[5]=u,t[6]=d,t[7]=0,t[8]=a,t[9]=c,t[10]=f,t[11]=0,t[12]=-(o*p+s*g+a*y),t[13]=-(l*p+u*g+c*y),t[14]=-(h*p+d*g+f*y),t[15]=1,t)}function dr(t,e,n,r){const i=e[0],o=e[1],s=e[2],a=r[0],l=r[1],u=r[2];let c=i-n[0],h=o-n[1],d=s-n[2],f=c*c+h*h+d*d;f>0&&(f=1/Math.sqrt(f),c*=f,h*=f,d*=f);let p=l*d-u*h,g=u*c-a*d,y=a*h-l*c;return f=p*p+g*g+y*y,f>0&&(f=1/Math.sqrt(f),p*=f,g*=f,y*=f),t[0]=p,t[1]=g,t[2]=y,t[3]=0,t[4]=h*y-d*g,t[5]=d*p-c*y,t[6]=c*g-h*p,t[7]=0,t[8]=c,t[9]=h,t[10]=d,t[11]=0,t[12]=i,t[13]=o,t[14]=s,t[15]=1,t}function fr(t){return`mat4(${t[0]}, ${t[1]}, ${t[2]}, ${t[3]}, ${t[4]}, ${t[5]}, ${t[6]}, ${t[7]}, ${t[8]}, ${t[9]}, ${t[10]}, ${t[11]}, ${t[12]}, ${t[13]}, ${t[14]}, ${t[15]})`}function pr(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]+t[3]*t[3]+t[4]*t[4]+t[5]*t[5]+t[6]*t[6]+t[7]*t[7]+t[8]*t[8]+t[9]*t[9]+t[10]*t[10]+t[11]*t[11]+t[12]*t[12]+t[13]*t[13]+t[14]*t[14]+t[15]*t[15])}function gr(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t}function yr(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t}function mr(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t}function vr(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t[9]=e[9]+n[9]*r,t[10]=e[10]+n[10]*r,t[11]=e[11]+n[11]*r,t[12]=e[12]+n[12]*r,t[13]=e[13]+n[13]*r,t[14]=e[14]+n[14]*r,t[15]=e[15]+n[15]*r,t}function br(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function _r(t,e){const n=t[0],r=t[1],i=t[2],o=t[3],s=t[4],a=t[5],l=t[6],u=t[7],c=t[8],h=t[9],d=t[10],f=t[11],p=t[12],g=t[13],y=t[14],m=t[15],v=e[0],b=e[1],_=e[2],A=e[3],x=e[4],w=e[5],C=e[6],S=e[7],E=e[8],M=e[9],P=e[10],T=e[11],O=e[12],I=e[13],R=e[14],B=e[15];return Math.abs(n-v)<=F*Math.max(1,Math.abs(n),Math.abs(v))&&Math.abs(r-b)<=F*Math.max(1,Math.abs(r),Math.abs(b))&&Math.abs(i-_)<=F*Math.max(1,Math.abs(i),Math.abs(_))&&Math.abs(o-A)<=F*Math.max(1,Math.abs(o),Math.abs(A))&&Math.abs(s-x)<=F*Math.max(1,Math.abs(s),Math.abs(x))&&Math.abs(a-w)<=F*Math.max(1,Math.abs(a),Math.abs(w))&&Math.abs(l-C)<=F*Math.max(1,Math.abs(l),Math.abs(C))&&Math.abs(u-S)<=F*Math.max(1,Math.abs(u),Math.abs(S))&&Math.abs(c-E)<=F*Math.max(1,Math.abs(c),Math.abs(E))&&Math.abs(h-M)<=F*Math.max(1,Math.abs(h),Math.abs(M))&&Math.abs(d-P)<=F*Math.max(1,Math.abs(d),Math.abs(P))&&Math.abs(f-T)<=F*Math.max(1,Math.abs(f),Math.abs(T))&&Math.abs(p-O)<=F*Math.max(1,Math.abs(p),Math.abs(O))&&Math.abs(g-I)<=F*Math.max(1,Math.abs(g),Math.abs(I))&&Math.abs(y-R)<=F*Math.max(1,Math.abs(y),Math.abs(R))&&Math.abs(m-B)<=F*Math.max(1,Math.abs(m),Math.abs(B))}var Ar=kn,xr=yr,wr={};function Cr(){const t=new N(4);return N!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function Sr(t){const e=new N(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function Er(t,e,n,r){const i=new N(4);return i[0]=t,i[1]=e,i[2]=n,i[3]=r,i}function Mr(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function Pr(t,e,n,r,i){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t}function Tr(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t}function Or(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t}function Ir(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t[3]=e[3]*n[3],t}function Rr(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t[3]=e[3]/n[3],t}function Br(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t}function Lr(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t}function kr(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t[3]=Math.min(e[3],n[3]),t}function Dr(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t[3]=Math.max(e[3],n[3]),t}function Fr(t,e){return t[0]=G(e[0]),t[1]=G(e[1]),t[2]=G(e[2]),t[3]=G(e[3]),t}function Nr(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function jr(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t}function Gr(t,e){const n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2],o=e[3]-t[3];return Math.sqrt(n*n+r*r+i*i+o*o)}function Ur(t,e){const n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2],o=e[3]-t[3];return n*n+r*r+i*i+o*o}function zr(t){const e=t[0],n=t[1],r=t[2],i=t[3];return Math.sqrt(e*e+n*n+r*r+i*i)}function Vr(t){const e=t[0],n=t[1],r=t[2],i=t[3];return e*e+n*n+r*r+i*i}function Hr(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t}function qr(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t}function Wr(t,e){const n=e[0],r=e[1],i=e[2],o=e[3];let s=n*n+r*r+i*i+o*o;return s>0&&(s=1/Math.sqrt(s)),t[0]=n*s,t[1]=r*s,t[2]=i*s,t[3]=o*s,t}function Jr(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function Yr(t,e,n,r){const i=n[0]*r[1]-n[1]*r[0],o=n[0]*r[2]-n[2]*r[0],s=n[0]*r[3]-n[3]*r[0],a=n[1]*r[2]-n[2]*r[1],l=n[1]*r[3]-n[3]*r[1],u=n[2]*r[3]-n[3]*r[2],c=e[0],h=e[1],d=e[2],f=e[3];return t[0]=h*u-d*l+f*a,t[1]=-c*u+d*s-f*o,t[2]=c*l-h*s+f*i,t[3]=-c*a+h*o-d*i,t}function Xr(t,e,n,r){const i=e[0],o=e[1],s=e[2],a=e[3];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t[2]=s+r*(n[2]-s),t[3]=a+r*(n[3]-a),t}function Kr(t,e){let n,r,i,o,s,a;e=void 0===e?1:e;do{n=2*j()-1,r=2*j()-1,s=n*n+r*r}while(s>=1);do{i=2*j()-1,o=2*j()-1,a=i*i+o*o}while(a>=1);const l=Math.sqrt((1-s)/a);return t[0]=e*n,t[1]=e*r,t[2]=e*i*l,t[3]=e*o*l,t}function Zr(t,e,n){const r=e[0],i=e[1],o=e[2],s=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*o+n[12]*s,t[1]=n[1]*r+n[5]*i+n[9]*o+n[13]*s,t[2]=n[2]*r+n[6]*i+n[10]*o+n[14]*s,t[3]=n[3]*r+n[7]*i+n[11]*o+n[15]*s,t}function Qr(t,e,n){const r=e[0],i=e[1],o=e[2],s=n[0],a=n[1],l=n[2],u=n[3],c=u*r+a*o-l*i,h=u*i+l*r-s*o,d=u*o+s*i-a*r,f=-s*r-a*i-l*o;return t[0]=c*u+f*-s+h*-l-d*-a,t[1]=h*u+f*-a+d*-s-c*-l,t[2]=d*u+f*-l+c*-a-h*-s,t[3]=e[3],t}function $r(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}function ti(t){return`vec4(${t[0]}, ${t[1]}, ${t[2]}, ${t[3]})`}function ei(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function ni(t,e){const n=t[0],r=t[1],i=t[2],o=t[3],s=e[0],a=e[1],l=e[2],u=e[3];return Math.abs(n-s)<=F*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(r-a)<=F*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(i-l)<=F*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(o-u)<=F*Math.max(1,Math.abs(o),Math.abs(u))}s(wr,{add:()=>Tr,ceil:()=>Br,clone:()=>Sr,copy:()=>Mr,create:()=>Cr,cross:()=>Yr,dist:()=>ai,distance:()=>Gr,div:()=>si,divide:()=>Rr,dot:()=>Jr,equals:()=>ni,exactEquals:()=>ei,floor:()=>Lr,forEach:()=>hi,fromValues:()=>Er,inverse:()=>qr,len:()=>ui,length:()=>zr,lerp:()=>Xr,max:()=>Dr,min:()=>kr,mul:()=>oi,multiply:()=>Ir,negate:()=>Hr,normalize:()=>Wr,random:()=>Kr,round:()=>Fr,scale:()=>Nr,scaleAndAdd:()=>jr,set:()=>Pr,sqrDist:()=>li,sqrLen:()=>ci,squaredDistance:()=>Ur,squaredLength:()=>Vr,str:()=>ti,sub:()=>ii,subtract:()=>Or,transformMat4:()=>Zr,transformQuat:()=>Qr,zero:()=>$r});var ri,ii=Or,oi=Ir,si=Rr,ai=Gr,li=Ur,ui=zr,ci=Vr,hi=function(){const t=Cr();return function(e,n,r,i,o,s){let a,l;for(n||(n=4),r||(r=0),l=i?Math.min(i*n+r,e.length):e.length,a=r;a<l;a+=n)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],t[3]=e[a+3],o(t,t,s),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2],e[a+3]=t[3];return e}}();!function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL0ROW3=3]="COL0ROW3",t[t.COL1ROW0=4]="COL1ROW0",t[t.COL1ROW1=5]="COL1ROW1",t[t.COL1ROW2=6]="COL1ROW2",t[t.COL1ROW3=7]="COL1ROW3",t[t.COL2ROW0=8]="COL2ROW0",t[t.COL2ROW1=9]="COL2ROW1",t[t.COL2ROW2=10]="COL2ROW2",t[t.COL2ROW3=11]="COL2ROW3",t[t.COL3ROW0=12]="COL3ROW0",t[t.COL3ROW1=13]="COL3ROW1",t[t.COL3ROW2=14]="COL3ROW2",t[t.COL3ROW3=15]="COL3ROW3"}(ri||(ri={}));var di,fi,pi=45*Math.PI/180,gi=1,yi=.1,mi=500,vi=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),bi=class extends Fe{static get IDENTITY(){return fi||(fi=new bi,Object.freeze(fi)),fi}static get ZERO(){return di||(di=new bi([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(di)),di}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return ri}constructor(t){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(t)?this.copy(t):this.identity()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this[9]=t[9],this[10]=t[10],this[11]=t[11],this[12]=t[12],this[13]=t[13],this[14]=t[14],this[15]=t[15],this.check()}set(t,e,n,r,i,o,s,a,l,u,c,h,d,f,p,g){return this[0]=t,this[1]=e,this[2]=n,this[3]=r,this[4]=i,this[5]=o,this[6]=s,this[7]=a,this[8]=l,this[9]=u,this[10]=c,this[11]=h,this[12]=d,this[13]=f,this[14]=p,this[15]=g,this.check()}setRowMajor(t,e,n,r,i,o,s,a,l,u,c,h,d,f,p,g){return this[0]=t,this[1]=i,this[2]=l,this[3]=d,this[4]=e,this[5]=o,this[6]=u,this[7]=f,this[8]=n,this[9]=s,this[10]=c,this[11]=p,this[12]=r,this[13]=a,this[14]=h,this[15]=g,this.check()}toRowMajor(t){return t[0]=this[0],t[1]=this[4],t[2]=this[8],t[3]=this[12],t[4]=this[1],t[5]=this[5],t[6]=this[9],t[7]=this[13],t[8]=this[2],t[9]=this[6],t[10]=this[10],t[11]=this[14],t[12]=this[3],t[13]=this[7],t[14]=this[11],t[15]=this[15],t}identity(){return this.copy(vi)}fromObject(t){return this.check()}fromQuaternion(t){return nr(this,t),this.check()}frustum(t){const{left:e,right:n,bottom:r,top:i,near:o=yi,far:s=mi}=t;return s===1/0?function(t,e,n,r,i,o){const s=2*o/(n-e),a=2*o/(i-r),l=(n+e)/(n-e),u=(i+r)/(i-r),c=-2*o;t[0]=s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=l,t[9]=u,t[10]=-1,t[11]=-1,t[12]=0,t[13]=0,t[14]=c,t[15]=0}(this,e,n,r,i,o):rr(this,e,n,r,i,o,s),this.check()}lookAt(t){const{eye:e,center:n=[0,0,0],up:r=[0,1,0]}=t;return hr(this,e,n,r),this.check()}ortho(t){const{left:e,right:n,bottom:r,top:i,near:o=yi,far:s=mi}=t;return ur(this,e,n,r,i,o,s),this.check()}orthographic(t){const{fovy:e=pi,aspect:n=gi,focalDistance:r=1,near:i=yi,far:o=mi}=t;_i(e);const s=e/2,a=r*Math.tan(s),l=a*n;return this.ortho({left:-l,right:l,bottom:-a,top:a,near:i,far:o})}perspective(t){const{fovy:e=45*Math.PI/180,aspect:n=1,near:r=.1,far:i=500}=t;return _i(e),or(this,e,n,r,i),this.check()}determinant(){return Ln(this)}getScale(t=[-0,-0,-0]){return t[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),t[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),t[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),t}getTranslation(t=[-0,-0,-0]){return t[0]=this[12],t[1]=this[13],t[2]=this[14],t}getRotation(t,e){t=t||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],e=e||[-0,-0,-0];const n=this.getScale(e),r=1/n[0],i=1/n[1],o=1/n[2];return t[0]=this[0]*r,t[1]=this[1]*i,t[2]=this[2]*o,t[3]=0,t[4]=this[4]*r,t[5]=this[5]*i,t[6]=this[6]*o,t[7]=0,t[8]=this[8]*r,t[9]=this[9]*i,t[10]=this[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}getRotationMatrix3(t,e){t=t||[-0,-0,-0,-0,-0,-0,-0,-0,-0],e=e||[-0,-0,-0];const n=this.getScale(e),r=1/n[0],i=1/n[1],o=1/n[2];return t[0]=this[0]*r,t[1]=this[1]*i,t[2]=this[2]*o,t[3]=this[4]*r,t[4]=this[5]*i,t[5]=this[6]*o,t[6]=this[8]*r,t[7]=this[9]*i,t[8]=this[10]*o,t}transpose(){return In(this,this),this.check()}invert(){return Rn(this,this),this.check()}multiplyLeft(t){return kn(this,t,this),this.check()}multiplyRight(t){return kn(this,this,t),this.check()}rotateX(t){return jn(this,this,t),this.check()}rotateY(t){return Gn(this,this,t),this.check()}rotateZ(t){return Un(this,this,t),this.check()}rotateXYZ(t){return this.rotateX(t[0]).rotateY(t[1]).rotateZ(t[2])}rotateAxis(t,e){return Nn(this,this,t,e),this.check()}scale(t){return Fn(this,this,Array.isArray(t)?t:[t,t,t]),this.check()}translate(t){return Dn(this,this,t),this.check()}transform(t,e){return 4===t.length?(B(e=Zr(e||[-0,-0,-0,-0],t,this),4),e):this.transformAsPoint(t,e)}transformAsPoint(t,e){const{length:n}=t;let r;switch(n){case 2:r=mt(e||[-0,-0],t,this);break;case 3:r=fe(e||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return B(r,t.length),r}transformAsVector(t,e){let n;switch(t.length){case 2:n=Rt(e||[-0,-0],t,this);break;case 3:n=Bt(e||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return B(n,t.length),n}transformPoint(t,e){return this.transformAsPoint(t,e)}transformVector(t,e){return this.transformAsPoint(t,e)}transformDirection(t,e){return this.transformAsVector(t,e)}makeRotationX(t){return this.identity().rotateX(t)}makeTranslation(t,e,n){return this.identity().translate([t,e,n])}};function _i(t){if(t>2*Math.PI)throw Error("expected radians")}var Ai={};function xi(){const t=new N(4);return N!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function wi(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function Ci(t,e,n){n*=.5;const r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t}function Si(t,e){const n=2*Math.acos(e[3]),r=Math.sin(n/2);return r>F?(t[0]=e[0]/r,t[1]=e[1]/r,t[2]=e[2]/r):(t[0]=1,t[1]=0,t[2]=0),n}function Ei(t,e){const n=Ji(t,e);return Math.acos(2*n*n-1)}function Mi(t,e,n){const r=e[0],i=e[1],o=e[2],s=e[3],a=n[0],l=n[1],u=n[2],c=n[3];return t[0]=r*c+s*a+i*u-o*l,t[1]=i*c+s*l+o*a-r*u,t[2]=o*c+s*u+r*l-i*a,t[3]=s*c-r*a-i*l-o*u,t}function Pi(t,e,n){n*=.5;const r=e[0],i=e[1],o=e[2],s=e[3],a=Math.sin(n),l=Math.cos(n);return t[0]=r*l+s*a,t[1]=i*l+o*a,t[2]=o*l-i*a,t[3]=s*l-r*a,t}function Ti(t,e,n){n*=.5;const r=e[0],i=e[1],o=e[2],s=e[3],a=Math.sin(n),l=Math.cos(n);return t[0]=r*l-o*a,t[1]=i*l+s*a,t[2]=o*l+r*a,t[3]=s*l-i*a,t}function Oi(t,e,n){n*=.5;const r=e[0],i=e[1],o=e[2],s=e[3],a=Math.sin(n),l=Math.cos(n);return t[0]=r*l+i*a,t[1]=i*l-r*a,t[2]=o*l+s*a,t[3]=s*l-o*a,t}function Ii(t,e){const n=e[0],r=e[1],i=e[2];return t[0]=n,t[1]=r,t[2]=i,t[3]=Math.sqrt(Math.abs(1-n*n-r*r-i*i)),t}function Ri(t,e){const n=e[0],r=e[1],i=e[2],o=e[3],s=Math.sqrt(n*n+r*r+i*i),a=Math.exp(o),l=s>0?a*Math.sin(s)/s:0;return t[0]=n*l,t[1]=r*l,t[2]=i*l,t[3]=a*Math.cos(s),t}function Bi(t,e){const n=e[0],r=e[1],i=e[2],o=e[3],s=Math.sqrt(n*n+r*r+i*i),a=s>0?Math.atan2(s,o)/s:0;return t[0]=n*a,t[1]=r*a,t[2]=i*a,t[3]=.5*Math.log(n*n+r*r+i*i+o*o),t}function Li(t,e,n){return Bi(t,e),Wi(t,t,n),Ri(t,t),t}function ki(t,e,n,r){const i=e[0],o=e[1],s=e[2],a=e[3];let l,u,c,h,d,f=n[0],p=n[1],g=n[2],y=n[3];return l=i*f+o*p+s*g+a*y,l<0&&(l=-l,f=-f,p=-p,g=-g,y=-y),1-l>F?(u=Math.acos(l),d=Math.sin(u),c=Math.sin((1-r)*u)/d,h=Math.sin(r*u)/d):(c=1-r,h=r),t[0]=c*i+h*f,t[1]=c*o+h*p,t[2]=c*s+h*g,t[3]=c*a+h*y,t}function Di(t,e){const n=e[0],r=e[1],i=e[2],o=e[3],s=n*n+r*r+i*i+o*o,a=s?1/s:0;return t[0]=-n*a,t[1]=-r*a,t[2]=-i*a,t[3]=o*a,t}function Fi(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function Ni(t,e){const n=e[0]+e[4]+e[8];let r;if(n>0)r=Math.sqrt(n+1),t[3]=.5*r,r=.5/r,t[0]=(e[5]-e[7])*r,t[1]=(e[6]-e[2])*r,t[2]=(e[1]-e[3])*r;else{let n=0;e[4]>e[0]&&(n=1),e[8]>e[3*n+n]&&(n=2);const i=(n+1)%3,o=(n+2)%3;r=Math.sqrt(e[3*n+n]-e[3*i+i]-e[3*o+o]+1),t[n]=.5*r,r=.5/r,t[3]=(e[3*i+o]-e[3*o+i])*r,t[i]=(e[3*i+n]+e[3*n+i])*r,t[o]=(e[3*o+n]+e[3*n+o])*r}return t}function ji(t){return`quat(${t[0]}, ${t[1]}, ${t[2]}, ${t[3]})`}s(Ai,{add:()=>Hi,calculateW:()=>Ii,clone:()=>Gi,conjugate:()=>Fi,copy:()=>zi,create:()=>xi,dot:()=>Ji,equals:()=>eo,exactEquals:()=>to,exp:()=>Ri,fromMat3:()=>Ni,fromValues:()=>Ui,getAngle:()=>Ei,getAxisAngle:()=>Si,identity:()=>wi,invert:()=>Di,len:()=>Ki,length:()=>Xi,lerp:()=>Yi,ln:()=>Bi,mul:()=>qi,multiply:()=>Mi,normalize:()=>$i,pow:()=>Li,rotateX:()=>Pi,rotateY:()=>Ti,rotateZ:()=>Oi,rotationTo:()=>io,scale:()=>Wi,set:()=>Vi,setAxes:()=>so,setAxisAngle:()=>Ci,slerp:()=>ki,sqlerp:()=>oo,sqrLen:()=>Qi,squaredLength:()=>Zi,str:()=>ji});var Gi=Sr,Ui=Er,zi=Mr,Vi=Pr,Hi=Tr,qi=Mi,Wi=Nr,Ji=Jr,Yi=Xr,Xi=zr,Ki=Xi,Zi=Vr,Qi=Zi,$i=Wr,to=ei;function eo(t,e){return Math.abs(Jr(t,e))>=1-F}var no,ro,io=function(){const t=Ft(),e=Gt(1,0,0),n=Gt(0,1,0);return function(r,i,o){const s=se(i,o);return s<-.999999?(ae(t,e,i),Ie(t)<1e-6&&ae(t,n,i),oe(t,t),Ci(r,t,Math.PI),r):s>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(ae(t,i,o),r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=1+s,$i(r,r))}}(),oo=function(){const t=xi(),e=xi();return function(n,r,i,o,s,a){return ki(t,r,s,a),ki(e,i,o,a),ki(n,t,e,2*a*(1-a)),n}}(),so=function(){const t=je();return function(e,n,r,i){return t[0]=r[0],t[3]=r[1],t[6]=r[2],t[1]=i[0],t[4]=i[1],t[7]=i[2],t[2]=-n[0],t[5]=-n[1],t[8]=-n[2],$i(e,Ni(e,t))}}(),ao=[0,0,0,1],lo=class extends I{constructor(t=0,e=0,n=0,r=1){super(-0,-0,-0,-0),Array.isArray(t)&&1===arguments.length?this.copy(t):this.set(t,e,n,r)}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this.check()}set(t,e,n,r){return this[0]=t,this[1]=e,this[2]=n,this[3]=r,this.check()}fromObject(t){return this[0]=t.x,this[1]=t.y,this[2]=t.z,this[3]=t.w,this.check()}fromMatrix3(t){return Ni(this,t),this.check()}fromAxisRotation(t,e){return Ci(this,t,e),this.check()}identity(){return wi(this),this.check()}setAxisAngle(t,e){return this.fromAxisRotation(t,e)}get ELEMENTS(){return 4}get x(){return this[0]}set x(t){this[0]=R(t)}get y(){return this[1]}set y(t){this[1]=R(t)}get z(){return this[2]}set z(t){this[2]=R(t)}get w(){return this[3]}set w(t){this[3]=R(t)}len(){return Xi(this)}lengthSquared(){return Zi(this)}dot(t){return Ji(this,t)}rotationTo(t,e){return io(this,t,e),this.check()}add(t){return Hi(this,this,t),this.check()}calculateW(){return Ii(this,this),this.check()}conjugate(){return Fi(this,this),this.check()}invert(){return Di(this,this),this.check()}lerp(t,e,n){return void 0===n?this.lerp(this,t,e):(Yi(this,t,e,n),this.check())}multiplyRight(t){return Mi(this,this,t),this.check()}multiplyLeft(t){return Mi(this,t,this),this.check()}normalize(){const t=this.len(),e=t>0?1/t:0;return this[0]=this[0]*e,this[1]=this[1]*e,this[2]=this[2]*e,this[3]=this[3]*e,0===t&&(this[3]=1),this.check()}rotateX(t){return Pi(this,this,t),this.check()}rotateY(t){return Ti(this,this,t),this.check()}rotateZ(t){return Oi(this,this,t),this.check()}scale(t){return Wi(this,this,t),this.check()}slerp(t,e,n){let r,i,o;switch(arguments.length){case 1:({start:r=ao,target:i,ratio:o}=t);break;case 2:r=this,i=t,o=e;break;default:r=t,i=e,o=n}return ki(this,r,i,o),this.check()}transformVector4(t,e=new De){return Qr(e,t,this),B(e,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(t,e){return this.setAxisAngle(t,e)}premultiply(t){return this.multiplyLeft(t)}multiply(t){return this.multiplyRight(t)}},uo=1e-6,co=class{constructor({phi:t=0,theta:e=0,radius:n=1,bearing:r,pitch:i,altitude:o,radiusScale:s=6371e3}={}){this.phi=t,this.theta=e,this.radius=n||o||1,this.radiusScale=s||1,void 0!==r&&(this.bearing=r),void 0!==i&&(this.pitch=i),this.check()}toString(){return this.formatString(c)}formatString({printTypes:t=!1}){const e=d;return`${t?"Spherical":""}[rho:${e(this.radius)},theta:${e(this.theta)},phi:${e(this.phi)}]`}equals(t){return M(this.radius,t.radius)&&M(this.theta,t.theta)&&M(this.phi,t.phi)}exactEquals(t){return this.radius===t.radius&&this.theta===t.theta&&this.phi===t.phi}get bearing(){return 180-v(this.phi)}set bearing(t){this.phi=Math.PI-m(t)}get pitch(){return v(this.theta)}set pitch(t){this.theta=m(t)}get longitude(){return v(this.phi)}get latitude(){return v(this.theta)}get lng(){return v(this.phi)}get lat(){return v(this.theta)}get z(){return(this.radius-1)*this.radiusScale}set(t,e,n){return this.radius=t,this.phi=e,this.theta=n,this.check()}clone(){return(new co).copy(this)}copy(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this.check()}fromLngLatZ([t,e,n]){return this.radius=1+n/this.radiusScale,this.phi=m(e),this.theta=m(t),this.check()}fromVector3(t){return this.radius=jt(t),this.radius>0&&(this.theta=Math.atan2(t[0],t[1]),this.phi=Math.acos(S(t[2]/this.radius,-1,1))),this.check()}toVector3(){return new ke(0,0,this.radius).rotateX({radians:this.theta}).rotateZ({radians:this.phi})}makeSafe(){return this.phi=Math.max(uo,Math.min(Math.PI-uo,this.phi)),this}check(){if(!(Number.isFinite(this.phi)&&Number.isFinite(this.theta)&&this.radius>0))throw new Error("SphericalCoordinates: some fields set to invalid numbers");return this}},ho="Unknown Euler angle order",fo=.99999;(ro=no||(no={}))[ro.ZYX=0]="ZYX",ro[ro.YXZ=1]="YXZ",ro[ro.XZY=2]="XZY",ro[ro.ZXY=3]="ZXY",ro[ro.YZX=4]="YZX",ro[ro.XYZ=5]="XYZ";var po=class extends I{static get ZYX(){return no.ZYX}static get YXZ(){return no.YXZ}static get XZY(){return no.XZY}static get ZXY(){return no.ZXY}static get YZX(){return no.YZX}static get XYZ(){return no.XYZ}static get RollPitchYaw(){return no.ZYX}static get DefaultOrder(){return no.ZYX}static get RotationOrders(){return no}static rotationOrder(t){return no[t]}get ELEMENTS(){return 4}constructor(t=0,e=0,n=0,r=po.DefaultOrder){super(-0,-0,-0,-0),arguments.length>0&&Array.isArray(arguments[0])?this.fromVector3(...arguments):this.set(t,e,n,r)}fromQuaternion(t){const[e,n,r,i]=t,o=n*n,s=-2*(o+r*r)+1,a=2*(e*n+i*r);let l=-2*(e*r-i*n);const u=2*(n*r+i*e),c=-2*(e*e+o)+1;l=l>1?1:l,l=l<-1?-1:l;const h=Math.atan2(u,c),d=Math.asin(l),f=Math.atan2(a,s);return this.set(h,d,f,po.RollPitchYaw)}fromObject(t){throw new Error("not implemented")}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=Number.isFinite(t[3])||this.order,this.check()}set(t=0,e=0,n=0,r){return this[0]=t,this[1]=e,this[2]=n,this[3]=Number.isFinite(r)?r:this[3],this.check()}validate(){return(t=this[3])>=0&&t<6&&Number.isFinite(this[0])&&Number.isFinite(this[1])&&Number.isFinite(this[2]);var t}toArray(t=[],e=0){return t[e]=this[0],t[e+1]=this[1],t[e+2]=this[2],t}toArray4(t=[],e=0){return t[e]=this[0],t[e+1]=this[1],t[e+2]=this[2],t[e+3]=this[3],t}toVector3(t=[-0,-0,-0]){return t[0]=this[0],t[1]=this[1],t[2]=this[2],t}get x(){return this[0]}set x(t){this[0]=R(t)}get y(){return this[1]}set y(t){this[1]=R(t)}get z(){return this[2]}set z(t){this[2]=R(t)}get alpha(){return this[0]}set alpha(t){this[0]=R(t)}get beta(){return this[1]}set beta(t){this[1]=R(t)}get gamma(){return this[2]}set gamma(t){this[2]=R(t)}get phi(){return this[0]}set phi(t){this[0]=R(t)}get theta(){return this[1]}set theta(t){this[1]=R(t)}get psi(){return this[2]}set psi(t){this[2]=R(t)}get roll(){return this[0]}set roll(t){this[0]=R(t)}get pitch(){return this[1]}set pitch(t){this[1]=R(t)}get yaw(){return this[2]}set yaw(t){this[2]=R(t)}get order(){return this[3]}set order(t){this[3]=function(t){if(t<0&&t>=6)throw new Error(ho);return t}(t)}fromVector3(t,e){return this.set(t[0],t[1],t[2],Number.isFinite(e)?e:this[3])}fromArray(t,e=0){return this[0]=t[0+e],this[1]=t[1+e],this[2]=t[2+e],void 0!==t[3]&&(this[3]=t[3]),this.check()}fromRollPitchYaw(t,e,n){return this.set(t,e,n,no.ZYX)}fromRotationMatrix(t,e=po.DefaultOrder){return this._fromRotationMatrix(t,e),this.check()}getRotationMatrix(t){return this._getRotationMatrix(t)}getQuaternion(){const t=new lo;switch(this[3]){case no.XYZ:return t.rotateX(this[0]).rotateY(this[1]).rotateZ(this[2]);case no.YXZ:return t.rotateY(this[0]).rotateX(this[1]).rotateZ(this[2]);case no.ZXY:return t.rotateZ(this[0]).rotateX(this[1]).rotateY(this[2]);case no.ZYX:return t.rotateZ(this[0]).rotateY(this[1]).rotateX(this[2]);case no.YZX:return t.rotateY(this[0]).rotateZ(this[1]).rotateX(this[2]);case no.XZY:return t.rotateX(this[0]).rotateZ(this[1]).rotateY(this[2]);default:throw new Error(ho)}}_fromRotationMatrix(t,e=po.DefaultOrder){const n=t[0],r=t[4],i=t[8],o=t[1],s=t[5],a=t[9],l=t[2],u=t[6],c=t[10];switch(e=e||this[3]){case po.XYZ:this[1]=Math.asin(S(i,-1,1)),Math.abs(i)<fo?(this[0]=Math.atan2(-a,c),this[2]=Math.atan2(-r,n)):(this[0]=Math.atan2(u,s),this[2]=0);break;case po.YXZ:this[0]=Math.asin(-S(a,-1,1)),Math.abs(a)<fo?(this[1]=Math.atan2(i,c),this[2]=Math.atan2(o,s)):(this[1]=Math.atan2(-l,n),this[2]=0);break;case po.ZXY:this[0]=Math.asin(S(u,-1,1)),Math.abs(u)<fo?(this[1]=Math.atan2(-l,c),this[2]=Math.atan2(-r,s)):(this[1]=0,this[2]=Math.atan2(o,n));break;case po.ZYX:this[1]=Math.asin(-S(l,-1,1)),Math.abs(l)<fo?(this[0]=Math.atan2(u,c),this[2]=Math.atan2(o,n)):(this[0]=0,this[2]=Math.atan2(-r,s));break;case po.YZX:this[2]=Math.asin(S(o,-1,1)),Math.abs(o)<fo?(this[0]=Math.atan2(-a,s),this[1]=Math.atan2(-l,n)):(this[0]=0,this[1]=Math.atan2(i,c));break;case po.XZY:this[2]=Math.asin(-S(r,-1,1)),Math.abs(r)<fo?(this[0]=Math.atan2(u,s),this[1]=Math.atan2(i,n)):(this[0]=Math.atan2(-a,c),this[1]=0);break;default:throw new Error(ho)}return this[3]=e,this}_getRotationMatrix(t){const e=t||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],n=this.x,r=this.y,i=this.z,o=Math.cos(n),s=Math.cos(r),a=Math.cos(i),l=Math.sin(n),u=Math.sin(r),c=Math.sin(i);switch(this[3]){case po.XYZ:{const t=o*a,n=o*c,r=l*a,i=l*c;e[0]=s*a,e[4]=-s*c,e[8]=u,e[1]=n+r*u,e[5]=t-i*u,e[9]=-l*s,e[2]=i-t*u,e[6]=r+n*u,e[10]=o*s;break}case po.YXZ:{const t=s*a,n=s*c,r=u*a,i=u*c;e[0]=t+i*l,e[4]=r*l-n,e[8]=o*u,e[1]=o*c,e[5]=o*a,e[9]=-l,e[2]=n*l-r,e[6]=i+t*l,e[10]=o*s;break}case po.ZXY:{const t=s*a,n=s*c,r=u*a,i=u*c;e[0]=t-i*l,e[4]=-o*c,e[8]=r+n*l,e[1]=n+r*l,e[5]=o*a,e[9]=i-t*l,e[2]=-o*u,e[6]=l,e[10]=o*s;break}case po.ZYX:{const t=o*a,n=o*c,r=l*a,i=l*c;e[0]=s*a,e[4]=r*u-n,e[8]=t*u+i,e[1]=s*c,e[5]=i*u+t,e[9]=n*u-r,e[2]=-u,e[6]=l*s,e[10]=o*s;break}case po.YZX:{const t=o*s,n=o*u,r=l*s,i=l*u;e[0]=s*a,e[4]=i-t*c,e[8]=r*c+n,e[1]=c,e[5]=o*a,e[9]=-l*a,e[2]=-u*a,e[6]=n*c+r,e[10]=t-i*c;break}case po.XZY:{const t=o*s,n=o*u,r=l*s,i=l*u;e[0]=s*a,e[4]=-c,e[8]=u*a,e[1]=t*c+i,e[5]=o*a,e[9]=n*c-r,e[2]=r*c-n,e[6]=l*a,e[10]=i*c+t;break}default:throw new Error(ho)}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}toQuaternion(){const t=Math.cos(.5*this.yaw),e=Math.sin(.5*this.yaw),n=Math.cos(.5*this.roll),r=Math.sin(.5*this.roll),i=Math.cos(.5*this.pitch),o=Math.sin(.5*this.pitch);return new lo(t*r*i-e*n*o,t*n*o+e*r*i,e*n*i-t*r*o,t*n*i+e*r*o)}},go=class{constructor({x:t=0,y:e=0,z:n=0,roll:r=0,pitch:i=0,yaw:o=0,position:s,orientation:a}={}){Array.isArray(s)&&3===s.length?this.position=new ke(s):this.position=new ke(t,e,n),Array.isArray(a)&&4===a.length?this.orientation=new po(a,a[3]):this.orientation=new po(r,i,o,po.RollPitchYaw)}get x(){return this.position.x}set x(t){this.position.x=t}get y(){return this.position.y}set y(t){this.position.y=t}get z(){return this.position.z}set z(t){this.position.z=t}get roll(){return this.orientation.roll}set roll(t){this.orientation.roll=t}get pitch(){return this.orientation.pitch}set pitch(t){this.orientation.pitch=t}get yaw(){return this.orientation.yaw}set yaw(t){this.orientation.yaw=t}getPosition(){return this.position}getOrientation(){return this.orientation}equals(t){return!!t&&this.position.equals(t.position)&&this.orientation.equals(t.orientation)}exactEquals(t){return!!t&&this.position.exactEquals(t.position)&&this.orientation.exactEquals(t.orientation)}getTransformationMatrix(){const t=Math.sin(this.roll),e=Math.sin(this.pitch),n=Math.sin(this.yaw),r=Math.cos(this.roll),i=Math.cos(this.pitch),o=Math.cos(this.yaw);return(new bi).setRowMajor(o*i,-n*r+o*e*t,n*t+o*e*r,this.x,n*i,o*r+n*e*t,-o*t+n*e*r,this.y,-e,i*t,i*r,this.z,0,0,0,1)}getTransformationMatrixFromPose(t){return(new bi).multiplyRight(this.getTransformationMatrix()).multiplyRight(t.getTransformationMatrix().invert())}getTransformationMatrixToPose(t){return(new bi).multiplyRight(t.getTransformationMatrix()).multiplyRight(this.getTransformationMatrix().invert())}},yo={};s(yo,{EPSILON1:()=>mo,EPSILON10:()=>Eo,EPSILON11:()=>Mo,EPSILON12:()=>Po,EPSILON13:()=>To,EPSILON14:()=>Oo,EPSILON15:()=>Io,EPSILON16:()=>Ro,EPSILON17:()=>Bo,EPSILON18:()=>Lo,EPSILON19:()=>ko,EPSILON2:()=>vo,EPSILON20:()=>Do,EPSILON3:()=>bo,EPSILON4:()=>_o,EPSILON5:()=>Ao,EPSILON6:()=>xo,EPSILON7:()=>wo,EPSILON8:()=>Co,EPSILON9:()=>So,PI_OVER_FOUR:()=>No,PI_OVER_SIX:()=>jo,PI_OVER_TWO:()=>Fo,TWO_PI:()=>Go});var mo=.1,vo=.01,bo=.001,_o=1e-4,Ao=1e-5,xo=1e-6,wo=1e-7,Co=1e-8,So=1e-9,Eo=1e-10,Mo=1e-11,Po=1e-12,To=1e-13,Oo=1e-14,Io=1e-15,Ro=1e-16,Bo=1e-17,Lo=1e-18,ko=1e-19,Do=1e-20,Fo=Math.PI/2,No=Math.PI/4,jo=Math.PI/6,Go=2*Math.PI},36590:(t,e,n)=>{var r,i=n(65606),o=Object.defineProperty,s=Object.getOwnPropertyDescriptor,a=Object.getOwnPropertyNames,l=Object.prototype.hasOwnProperty,u={};function c(){let t;if("undefined"!=typeof window&&window.performance)t=window.performance.now();else if(void 0!==i&&i.hrtime){const e=i.hrtime();t=1e3*e[0]+e[1]/1e6}else t=Date.now();return t}((t,e)=>{for(var n in e)o(t,n,{get:e[n],enumerable:!0})})(u,{Stat:()=>h,Stats:()=>d,_getHiResTimestamp:()=>c}),t.exports=(r=u,((t,e,n,r)=>{if(e&&"object"==typeof e||"function"==typeof e)for(let n of a(e))l.call(t,n)||undefined===n||o(t,n,{get:()=>e[n],enumerable:!(r=s(e,n))||r.enumerable});return t})(o({},"__esModule",{value:!0}),r));var h=class{constructor(t,e){this.sampleSize=1,this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this.name=t,this.type=e,this.reset()}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}setSampleSize(t){return this.sampleSize=t,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(t){return this._count+=t,this._samples++,this._checkSampling(),this}subtractCount(t){return this._count-=t,this._samples++,this._checkSampling(),this}addTime(t){return this._time+=t,this.lastTiming=t,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=c(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(c()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}},d=class{constructor(t){this.stats={},this.id=t.id,this.stats={},this._initializeStats(t.stats),Object.seal(this)}get(t,e="count"){return this._getOrCreate({name:t,type:e})}get size(){return Object.keys(this.stats).length}reset(){for(const t of Object.values(this.stats))t.reset();return this}forEach(t){for(const e of Object.values(this.stats))t(e)}getTable(){const t={};return this.forEach((e=>{t[e.name]={time:e.time||0,count:e.count||0,average:e.getAverageTime()||0,hz:e.getHz()||0}})),t}_initializeStats(t=[]){t.forEach((t=>this._getOrCreate(t)))}_getOrCreate(t){const{name:e,type:n}=t;let r=this.stats[e];return r||(r=t instanceof h?t:new h(e,n),this.stats[e]=r),r}}},24059:(t,e,n)=>{"use strict";var r,i=Object.defineProperty,o=Object.getOwnPropertyDescriptor,s=Object.getOwnPropertyNames,a=Object.prototype.hasOwnProperty,l={};((t,e)=>{for(var n in e)i(t,n,{get:e[n],enumerable:!0})})(l,{GEOPARQUET_METADATA_JSON_SCHEMA:()=>u,binaryToGeojson:()=>G,binaryToGeometry:()=>U,convertWKBTableToGeoJSON:()=>w,flatGeojsonToBinary:()=>E,geojsonToBinary:()=>j,geojsonToFlatGeojson:()=>k,getGeoMetadata:()=>c,getGeometryColumnsFromSchema:()=>_,setGeoMetadata:()=>h,transformBinaryCoords:()=>W,transformGeoJsonCoords:()=>Y,unpackGeoMetadata:()=>d,unpackJSONStringMetadata:()=>y}),t.exports=(r=l,((t,e,n,r)=>{if(e&&"object"==typeof e||"function"==typeof e)for(let n of s(e))a.call(t,n)||undefined===n||i(t,n,{get:()=>e[n],enumerable:!(r=o(e,n))||r.enumerable});return t})(i({},"__esModule",{value:!0}),r));var u={$schema:"http://json-schema.org/draft-07/schema#",title:"GeoParquet",description:"Parquet metadata included in the geo field.",type:"object",required:["version","primary_column","columns"],properties:{version:{type:"string",const:"1.0.0-beta.1"},primary_column:{type:"string",minLength:1},columns:{type:"object",minProperties:1,patternProperties:{".+":{type:"object",required:["encoding","geometry_types"],properties:{encoding:{type:"string",const:"WKB"},geometry_types:{type:"array",uniqueItems:!0,items:{type:"string",pattern:"^(GeometryCollection|(Multi)?(Point|LineString|Polygon))( Z)?$"}},crs:{oneOf:[{$ref:"https://proj.org/schemas/v0.5/projjson.schema.json"},{type:"null"}]},edges:{type:"string",enum:["planar","spherical"]},orientation:{type:"string",const:"counterclockwise"},bbox:{type:"array",items:{type:"number"},oneOf:[{description:"2D bbox consisting of (xmin, ymin, xmax, ymax)",minItems:4,maxItems:4},{description:"3D bbox consisting of (xmin, ymin, zmin, xmax, ymax, zmax)",minItems:6,maxItems:6}]},epoch:{type:"number"}}}},additionalProperties:!1}}};function c(t){const e=g(t,"geo");if(!e)return null;for(const t of Object.values(e.columns||{}))t.encoding&&(t.encoding=t.encoding.toLowerCase());return e}function h(t,e){const n=JSON.stringify(e);t.metadata.geo=n}function d(t){const e=c(t);if(!e)return;const{version:n,primary_column:r,columns:i}=e;n&&(t.metadata["geo.version"]=n),r&&(t.metadata["geo.primary_column"]=r),t.metadata["geo.columns"]=Object.keys(i||{}).join("");for(const[e,n]of Object.entries(i||{})){const i=t.fields.find((t=>t.name===e));i&&(i.name===r&&p(i,"geo.primary_field","true"),f(i,n))}}function f(t,e){for(const[n,r]of Object.entries(e||{}))switch(n){case"geometry_types":p(t,`geo.${n}`,r.join(","));break;case"bbox":p(t,`geo.crs.${n}`,JSON.stringify(r));break;case"crs":for(const[e,n]of Object.entries(r||{}))p(t,`geo.crs.${e}`,"id"===e?"object"==typeof n?`${null==n?void 0:n.authority}:${null==n?void 0:n.code}`:JSON.stringify(n):"string"==typeof n?n:JSON.stringify(n));break;default:p(t,`geo.${n}`,"string"==typeof r?r:JSON.stringify(r))}}function p(t,e,n){t.metadata=t.metadata||{},t.metadata[e]=n}function g(t,e){const n=t.metadata[e];if(!n)return null;try{const t=JSON.parse(n);return t&&"object"==typeof t?t:null}catch{return null}}function y(t,e){const n=g(t,e);for(const[r,i]of Object.entries(n||{}))t.metadata[`${e}.${r}`]="string"==typeof i?i:JSON.stringify(i)}var m=["geoarrow.multipolygon","geoarrow.polygon","geoarrow.multilinestring","geoarrow.linestring","geoarrow.multipoint","geoarrow.point","geoarrow.wkb","geoarrow.wkt"],v="ARROW:extension:name",b="ARROW:extension:metadata";function _(t){const e={};for(const n of t.fields){const t=A(n);t&&(e[n.name]=t)}return e}function A(t){var e,n;let r=null,i=null==(e=t.metadata)?void 0:e[v];i&&(i=i.toLowerCase(),"wkb"===i&&(i="geoarrow.wkb"),"wkt"===i&&(i="geoarrow.wkt"),m.includes(i)?(r=r||{},r.encoding=i):console.warn(`Invalid GeoArrow encoding: ${i}`));const o=null==(n=t.metadata)?void 0:n[b];if(o)try{r=JSON.parse(o)}catch(t){console.warn("Failed to parse GeoArrow metadata",t)}return r||null}var x=n(33561);function w(t,e,n){const r=c(e),i=null==r?void 0:r.primary_column;if(!i)throw new Error("no geometry column");const o=r.columns[i],s=[],a=(0,x.getTableLength)(t);for(let e=0;e<a;e++){const r=(0,x.getTableRowAsObject)(t,e),a=C(r[i],o,n);delete r[i];const l={type:"Feature",geometry:a,properties:r};s.push(l)}return{shape:"geojson-table",schema:e,type:"FeatureCollection",features:s}}function C(t,e,n){var r,i;if("wkt"===e.encoding){const e=n.find((t=>"wkt"===t.id));return(null==(r=null==e?void 0:e.parseTextSync)?void 0:r.call(e,t))||null}{const e=n.find((t=>"wkb"===t.id)),r=ArrayBuffer.isView(t)?t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength):t;return null==(i=null==e?void 0:e.parseSync)?void 0:i.call(e,r,{wkb:{shape:"geojson-geometry"}})}}var S=n(44313);function E(t,e,n){const r=function(t){const e={};for(const i of t)if(i.properties)for(const t in i.properties){const o=i.properties[t];e[t]=(n=o,(r=e[t])!==Array&&Number.isFinite(n)?r===Float64Array||Math.fround(n)!==n?Float64Array:Float32Array:Array)}var n,r;return e}(t),i=Object.keys(r).filter((t=>r[t]!==Array));return function(t,e,n){const{pointPositionsCount:r,pointFeaturesCount:i,linePositionsCount:o,linePathsCount:s,lineFeaturesCount:a,polygonPositionsCount:l,polygonObjectsCount:u,polygonRingsCount:c,polygonFeaturesCount:h,propArrayTypes:d,coordLength:f}=e,{numericPropKeys:p=[],PositionDataType:g=Float32Array,triangulate:y=!0}=n,m=t[0]&&"id"in t[0],v=t.length>65535?Uint32Array:Uint16Array,b={type:"Point",positions:new g(r*f),globalFeatureIds:new v(r),featureIds:i>65535?new Uint32Array(r):new Uint16Array(r),numericProps:{},properties:[],fields:[]},_={type:"LineString",pathIndices:o>65535?new Uint32Array(s+1):new Uint16Array(s+1),positions:new g(o*f),globalFeatureIds:new v(o),featureIds:a>65535?new Uint32Array(o):new Uint16Array(o),numericProps:{},properties:[],fields:[]},A={type:"Polygon",polygonIndices:l>65535?new Uint32Array(u+1):new Uint16Array(u+1),primitivePolygonIndices:l>65535?new Uint32Array(c+1):new Uint16Array(c+1),positions:new g(l*f),globalFeatureIds:new v(l),featureIds:h>65535?new Uint32Array(l):new Uint16Array(l),numericProps:{},properties:[],fields:[]};y&&(A.triangles=[]);for(const t of[b,_,A])for(const e of p){const n=d[e];t.numericProps[e]=new n(t.positions.length/f)}_.pathIndices[s]=o,A.polygonIndices[u]=l,A.primitivePolygonIndices[c]=l;const x={pointPosition:0,pointFeature:0,linePosition:0,linePath:0,lineFeature:0,polygonPosition:0,polygonObject:0,polygonRing:0,polygonFeature:0,feature:0};for(const e of t){const t=e.geometry,n=e.properties||{};switch(t.type){case"Point":M(t,b,x,f,n),b.properties.push(B(n,p)),m&&b.fields.push({id:e.id}),x.pointFeature++;break;case"LineString":P(t,_,x,f,n),_.properties.push(B(n,p)),m&&_.fields.push({id:e.id}),x.lineFeature++;break;case"Polygon":T(t,A,x,f,n),A.properties.push(B(n,p)),m&&A.fields.push({id:e.id}),x.polygonFeature++;break;default:throw new Error("Invalid geometry type")}x.feature++}return function(t,e,n,r){const i={shape:"binary-feature-collection",points:{...t,positions:{value:t.positions,size:r},globalFeatureIds:{value:t.globalFeatureIds,size:1},featureIds:{value:t.featureIds,size:1},numericProps:I(t.numericProps,1)},lines:{...e,positions:{value:e.positions,size:r},pathIndices:{value:e.pathIndices,size:1},globalFeatureIds:{value:e.globalFeatureIds,size:1},featureIds:{value:e.featureIds,size:1},numericProps:I(e.numericProps,1)},polygons:{...n,positions:{value:n.positions,size:r},polygonIndices:{value:n.polygonIndices,size:1},primitivePolygonIndices:{value:n.primitivePolygonIndices,size:1},globalFeatureIds:{value:n.globalFeatureIds,size:1},featureIds:{value:n.featureIds,size:1},numericProps:I(n.numericProps,1)}};return i.polygons&&n.triangles&&(i.polygons.triangles={value:new Uint32Array(n.triangles),size:1}),i}(b,_,A,f)}(t,{propArrayTypes:r,...e},{numericPropKeys:n&&n.numericPropKeys||i,PositionDataType:n?n.PositionDataType:Float32Array,triangulate:!n||n.triangulate})}function M(t,e,n,r,i){e.positions.set(t.data,n.pointPosition*r);const o=t.data.length/r;R(e,i,n.pointPosition,o),e.globalFeatureIds.fill(n.feature,n.pointPosition,n.pointPosition+o),e.featureIds.fill(n.pointFeature,n.pointPosition,n.pointPosition+o),n.pointPosition+=o}function P(t,e,n,r,i){e.positions.set(t.data,n.linePosition*r);const o=t.data.length/r;R(e,i,n.linePosition,o),e.globalFeatureIds.fill(n.feature,n.linePosition,n.linePosition+o),e.featureIds.fill(n.lineFeature,n.linePosition,n.linePosition+o);for(let i=0,o=t.indices.length;i<o;++i){const s=t.indices[i],a=i===o-1?t.data.length:t.indices[i+1];e.pathIndices[n.linePath++]=n.linePosition,n.linePosition+=(a-s)/r}}function T(t,e,n,r,i){e.positions.set(t.data,n.polygonPosition*r);const o=t.data.length/r;R(e,i,n.polygonPosition,o),e.globalFeatureIds.fill(n.feature,n.polygonPosition,n.polygonPosition+o),e.featureIds.fill(n.polygonFeature,n.polygonPosition,n.polygonPosition+o);for(let i=0,o=t.indices.length;i<o;++i){const o=n.polygonPosition;e.polygonIndices[n.polygonObject++]=o;const s=t.areas[i],a=t.indices[i],l=t.indices[i+1];for(let i=0,o=a.length;i<o;++i){const s=a[i],u=i===o-1?void 0===l?t.data.length:l[0]:a[i+1];e.primitivePolygonIndices[n.polygonRing++]=n.polygonPosition,n.polygonPosition+=(u-s)/r}O(e,s,a,{startPosition:o,endPosition:n.polygonPosition,coordLength:r})}}function O(t,e,n,{startPosition:r,endPosition:i,coordLength:o}){if(!t.triangles)return;const s=r*o,a=i*o,l=t.positions.subarray(s,a),u=n[0],c=n.slice(1).map((t=>(t-u)/o)),h=(0,S.earcut)(l,c,o,e);for(let e=0,n=h.length;e<n;++e)t.triangles.push(r+h[e])}function I(t,e){const n={};for(const r in t)n[r]={value:t[r],size:e};return n}function R(t,e,n,r){for(const i in t.numericProps)if(i in e){const o=e[i];t.numericProps[i].fill(o,n,n+r)}}function B(t,e){const n={};for(const r in t)e.includes(r)||(n[r]=t[r]);return n}var L=n(44313);function k(t,e={coordLength:2,fixRingWinding:!0}){return t.map((t=>function(t,e){const{geometry:n}=t;if("GeometryCollection"===n.type)throw new Error("GeometryCollection type not supported");const r=[],i=[];let o,s;switch(n.type){case"Point":s="Point",D(n.coordinates,r,i,e);break;case"MultiPoint":s="Point",n.coordinates.map((t=>D(t,r,i,e)));break;case"LineString":s="LineString",F(n.coordinates,r,i,e);break;case"MultiLineString":s="LineString",n.coordinates.map((t=>F(t,r,i,e)));break;case"Polygon":s="Polygon",o=[],N(n.coordinates,r,i,o,e);break;case"MultiPolygon":s="Polygon",o=[],n.coordinates.map((t=>N(t,r,i,o,e)));break;default:throw new Error(`Unknown type: ${s}`)}return{...t,geometry:{type:s,indices:i,data:r,areas:o}}}(t,e)))}function D(t,e,n,r){n.push(e.length),e.push(...t);for(let n=t.length;n<r.coordLength;n++)e.push(0)}function F(t,e,n,r){n.push(e.length);for(const n of t){e.push(...n);for(let t=n.length;t<r.coordLength;t++)e.push(0)}}function N(t,e,n,r,i){let o=0;const s=[],a=[];for(const n of t){const t=n.map((t=>t.slice(0,2)));let r=(0,L.getPolygonSignedArea)(t.flat());const l=r<0;i.fixRingWinding&&(0===o&&!l||o>0&&l)&&(n.reverse(),r=-r),s.push(r),F(n,e,a,i),o++}o>0&&(r.push(s),n.push(a))}function j(t,e={fixRingWinding:!0,triangulate:!0}){const n=function(t){let e=0,n=0,r=0,i=0,o=0,s=0,a=0,l=0,u=0;const c=new Set;for(const h of t){const t=h.geometry;switch(t.type){case"Point":n++,e++,c.add(t.coordinates.length);break;case"MultiPoint":n++,e+=t.coordinates.length;for(const e of t.coordinates)c.add(e.length);break;case"LineString":o++,r+=t.coordinates.length,i++;for(const e of t.coordinates)c.add(e.length);break;case"MultiLineString":o++;for(const e of t.coordinates){r+=e.length,i++;for(const t of e)c.add(t.length)}break;case"Polygon":u++,a++,l+=t.coordinates.length;const h=t.coordinates.flat();s+=h.length;for(const t of h)c.add(t.length);break;case"MultiPolygon":u++;for(const e of t.coordinates){a++,l+=e.length;const t=e.flat();s+=t.length;for(const e of t)c.add(e.length)}break;default:throw new Error(`Unsupported geometry type: ${t.type}`)}}return{coordLength:c.size>0?Math.max(...c):2,pointPositionsCount:e,pointFeaturesCount:n,linePositionsCount:r,linePathsCount:i,lineFeaturesCount:o,polygonPositionsCount:s,polygonObjectsCount:a,polygonRingsCount:l,polygonFeaturesCount:u}}(t),r=n.coordLength,{fixRingWinding:i}=e;return E(k(t,{coordLength:r,fixRingWinding:i}),n,{numericPropKeys:e.numericPropKeys,PositionDataType:e.PositionDataType||Float32Array,triangulate:e.triangulate})}function G(t,e){const n=null==e?void 0:e.globalFeatureId;return void 0!==n?function(t,e){const n=z(t);for(const t of n){let n=0,r=t.featureIds.value[0];for(let i=0;i<t.featureIds.value.length;i++){const o=t.featureIds.value[i];if(o!==r){if(e===t.globalFeatureIds.value[n])return V(t,n,i);n=i,r=o}}if(e===t.globalFeatureIds.value[n])return V(t,n,t.featureIds.value.length)}throw new Error(`featureId:${e} not found`)}(t,n):function(t){return function(t){const e=[];for(const n of t){if(0===n.featureIds.value.length)continue;let t=0,r=n.featureIds.value[0];for(let i=0;i<n.featureIds.value.length;i++){const o=n.featureIds.value[i];o!==r&&(e.push(V(n,t,i)),t=i,r=o)}e.push(V(n,t,n.featureIds.value.length))}return e}(z(t))}(t,null==e||e.type)}function U(t,e,n){switch(t.type){case"Point":return function(t,e,n){const{positions:r}=t,i=q(r,e,n);return i.length>1?{type:"MultiPoint",coordinates:i}:{type:"Point",coordinates:i[0]}}(t,e,n);case"LineString":return function(t,e=-1/0,n=1/0){const{positions:r}=t,i=t.pathIndices.value.filter((t=>t>=e&&t<=n));if(!(i.length>2))return{type:"LineString",coordinates:q(r,i[0],i[1])};const o=[];for(let t=0;t<i.length-1;t++){const e=q(r,i[t],i[t+1]);o.push(e)}return{type:"MultiLineString",coordinates:o}}(t,e,n);case"Polygon":return H(t,e,n);default:throw new Error(`Unsupported geometry type: ${null==t?void 0:t.type}`)}}function z(t,e){const n=[];return t.points&&(t.points.type="Point",n.push(t.points)),t.lines&&(t.lines.type="LineString",n.push(t.lines)),t.polygons&&(t.polygons.type="Polygon",n.push(t.polygons)),n}function V(t,e,n){const r=U(t,e,n),i=function(t,e=0){const n=Object.assign({},t.properties[t.featureIds.value[e]]);for(const r in t.numericProps)n[r]=t.numericProps[r].value[e];return n}(t,e),o=function(t,e=0){return t.fields&&t.fields[t.featureIds.value[e]]}(t,e);return{type:"Feature",geometry:r,properties:i,...o}}function H(t,e=-1/0,n=1/0){const{positions:r}=t,i=t.polygonIndices.value.filter((t=>t>=e&&t<=n)),o=t.primitivePolygonIndices.value.filter((t=>t>=e&&t<=n));if(!(i.length>2)){const t=[];for(let e=0;e<o.length-1;e++){const n=q(r,o[e],o[e+1]);t.push(n)}return{type:"Polygon",coordinates:t}}const s=[];for(let e=0;e<i.length-1;e++){const n=H(t,i[e],i[e+1]).coordinates;s.push(n)}return{type:"MultiPolygon",coordinates:s}}function q(t,e,n){e=e||0,n=n||t.value.length/t.size;const r=[];for(let i=e;i<n;i++){const e=Array();for(let n=i*t.size;n<(i+1)*t.size;n++)e.push(Number(t.value[n]));r.push(e)}return r}function W(t,e){return t.points&&J(t.points,e),t.lines&&J(t.lines,e),t.polygons&&J(t.polygons,e),t}function J(t,e){const{positions:n}=t;for(let t=0;t<n.value.length;t+=n.size){const r=e(Array.from(n.value.subarray(t,t+n.size)));n.value.set(r,t)}}function Y(t,e){for(const n of t)n.geometry.coordinates=X(n.geometry.coordinates,e);return t}function X(t,e){return function(t){return Array.isArray(t)&&Number.isFinite(t[0])&&Number.isFinite(t[1])}(t)?e(t):t.map((t=>X(t,e)))}},47502:t=>{var e,n=Object.defineProperty,r=Object.getOwnPropertyDescriptor,i=Object.getOwnPropertyNames,o=Object.prototype.hasOwnProperty,s=(t,e)=>{for(var r in e)n(t,r,{get:e[r],enumerable:!0})},a={};s(a,{Euler:()=>po,Matrix3:()=>xn,Matrix4:()=>bi,Pose:()=>go,Quaternion:()=>lo,SphericalCoordinates:()=>co,Vector2:()=>kt,Vector3:()=>ke,Vector4:()=>De,_Euler:()=>po,_MathUtils:()=>yo,_Pose:()=>go,_SphericalCoordinates:()=>co,acos:()=>w,asin:()=>x,assert:()=>L,atan:()=>C,clamp:()=>S,clone:()=>p,config:()=>c,configure:()=>h,cos:()=>_,degrees:()=>v,equals:()=>M,exactEquals:()=>P,formatValue:()=>d,isArray:()=>f,lerp:()=>E,mat3:()=>Ne,mat4:()=>Cn,quat:()=>Ai,radians:()=>m,sin:()=>b,tan:()=>A,toDegrees:()=>y,toRadians:()=>g,vec2:()=>D,vec3:()=>Dt,vec4:()=>wr,withEpsilon:()=>T}),t.exports=(e=a,((t,e,s,a)=>{if(e&&"object"==typeof e||"function"==typeof e)for(let s of i(e))o.call(t,s)||undefined===s||n(t,s,{get:()=>e[s],enumerable:!(a=r(e,s))||a.enumerable});return t})(n({},"__esModule",{value:!0}),e));var l=1/Math.PI*180,u=1/180*Math.PI;globalThis.mathgl=globalThis.mathgl||{config:{EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0,_cartographicRadians:!1}};var c=globalThis.mathgl.config;function h(t){return Object.assign(c,t),c}function d(t,{precision:e=c.precision}={}){return t=function(t){return Math.round(t/c.EPSILON)*c.EPSILON}(t),`${parseFloat(t.toPrecision(e))}`}function f(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function p(t){return"clone"in t?t.clone():t.slice()}function g(t){return m(t)}function y(t){return v(t)}function m(t,e){return O(t,(t=>t*u),e)}function v(t,e){return O(t,(t=>t*l),e)}function b(t,e){return O(t,(t=>Math.sin(t)),e)}function _(t,e){return O(t,(t=>Math.cos(t)),e)}function A(t,e){return O(t,(t=>Math.tan(t)),e)}function x(t,e){return O(t,(t=>Math.asin(t)),e)}function w(t,e){return O(t,(t=>Math.acos(t)),e)}function C(t,e){return O(t,(t=>Math.atan(t)),e)}function S(t,e,n){return O(t,(t=>Math.max(e,Math.min(n,t))))}function E(t,e,n){return f(t)?t.map(((t,r)=>E(t,e[r],n))):n*e+(1-n)*t}function M(t,e,n){const r=c.EPSILON;n&&(c.EPSILON=n);try{if(t===e)return!0;if(f(t)&&f(e)){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!M(t[n],e[n]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):"number"==typeof t&&"number"==typeof e&&Math.abs(t-e)<=c.EPSILON*Math.max(1,Math.abs(t),Math.abs(e))}finally{c.EPSILON=r}}function P(t,e){if(t===e)return!0;if(t&&"object"==typeof t&&e&&"object"==typeof e){if(t.constructor!==e.constructor)return!1;if(t.exactEquals)return t.exactEquals(e)}if(f(t)&&f(e)){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!P(t[n],e[n]))return!1;return!0}return!1}function T(t,e){const n=c.EPSILON;let r;c.EPSILON=t;try{r=e()}finally{c.EPSILON=n}return r}function O(t,e,n){if(f(t)){const r=t;n=n||function(t){return t.clone?t.clone():new Array(t.length)}(r);for(let i=0;i<n.length&&i<r.length;++i){const r="number"==typeof t?t:t[i];n[i]=e(r,i,n)}return n}return e(t)}var I=class extends Array{clone(){return(new this.constructor).copy(this)}fromArray(t,e=0){for(let n=0;n<this.ELEMENTS;++n)this[n]=t[n+e];return this.check()}toArray(t=[],e=0){for(let n=0;n<this.ELEMENTS;++n)t[e+n]=this[n];return t}toObject(t){return t}from(t){return Array.isArray(t)?this.copy(t):this.fromObject(t)}to(t){return t===this?this:f(t)?this.toArray(t):this.toObject(t)}toTarget(t){return t?this.to(t):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(c)}formatString(t){let e="";for(let n=0;n<this.ELEMENTS;++n)e+=(n>0?", ":"")+d(this[n],t);return`${t.printTypes?this.constructor.name:""}[${e}]`}equals(t){if(!t||this.length!==t.length)return!1;for(let e=0;e<this.ELEMENTS;++e)if(!M(this[e],t[e]))return!1;return!0}exactEquals(t){if(!t||this.length!==t.length)return!1;for(let e=0;e<this.ELEMENTS;++e)if(this[e]!==t[e])return!1;return!0}negate(){for(let t=0;t<this.ELEMENTS;++t)this[t]=-this[t];return this.check()}lerp(t,e,n){if(void 0===n)return this.lerp(this,t,e);for(let r=0;r<this.ELEMENTS;++r){const i=t[r],o="number"==typeof e?e:e[r];this[r]=i+n*(o-i)}return this.check()}min(t){for(let e=0;e<this.ELEMENTS;++e)this[e]=Math.min(t[e],this[e]);return this.check()}max(t){for(let e=0;e<this.ELEMENTS;++e)this[e]=Math.max(t[e],this[e]);return this.check()}clamp(t,e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t[n]),e[n]);return this.check()}add(...t){for(const e of t)for(let t=0;t<this.ELEMENTS;++t)this[t]+=e[t];return this.check()}subtract(...t){for(const e of t)for(let t=0;t<this.ELEMENTS;++t)this[t]-=e[t];return this.check()}scale(t){if("number"==typeof t)for(let e=0;e<this.ELEMENTS;++e)this[e]*=t;else for(let e=0;e<this.ELEMENTS&&e<t.length;++e)this[e]*=t[e];return this.check()}multiplyByScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]*=t;return this.check()}check(){if(c.debug&&!this.validate())throw new Error(`math.gl: ${this.constructor.name} some fields set to invalid numbers'`);return this}validate(){let t=this.length===this.ELEMENTS;for(let e=0;e<this.ELEMENTS;++e)t=t&&Number.isFinite(this[e]);return t}sub(t){return this.subtract(t)}setScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]=t;return this.check()}addScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]+=t;return this.check()}subScalar(t){return this.addScalar(-t)}multiplyScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]*=t;return this.check()}divideScalar(t){return this.multiplyByScalar(1/t)}clampScalar(t,e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t),e);return this.check()}get elements(){return this}};function R(t){if(!Number.isFinite(t))throw new Error(`Invalid number ${JSON.stringify(t)}`);return t}function B(t,e,n=""){if(c.debug&&!function(t,e){if(t.length!==e)return!1;for(let e=0;e<t.length;++e)if(!Number.isFinite(t[e]))return!1;return!0}(t,e))throw new Error(`math.gl: ${n} some fields set to invalid numbers'`);return t}function L(t,e){if(!t)throw new Error(`math.gl assertion ${e}`)}var k=class extends I{get x(){return this[0]}set x(t){this[0]=R(t)}get y(){return this[1]}set y(t){this[1]=R(t)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let t=0;for(let e=0;e<this.ELEMENTS;++e)t+=this[e]*this[e];return t}magnitudeSquared(){return this.lengthSquared()}distance(t){return Math.sqrt(this.distanceSquared(t))}distanceSquared(t){let e=0;for(let n=0;n<this.ELEMENTS;++n){const r=this[n]-t[n];e+=r*r}return R(e)}dot(t){let e=0;for(let n=0;n<this.ELEMENTS;++n)e+=this[n]*t[n];return R(e)}normalize(){const t=this.magnitude();if(0!==t)for(let e=0;e<this.ELEMENTS;++e)this[e]/=t;return this.check()}multiply(...t){for(const e of t)for(let t=0;t<this.ELEMENTS;++t)this[t]*=e[t];return this.check()}divide(...t){for(const e of t)for(let t=0;t<this.ELEMENTS;++t)this[t]/=e[t];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(t){return this.distance(t)}distanceToSquared(t){return this.distanceSquared(t)}getComponent(t){return L(t>=0&&t<this.ELEMENTS,"index is out of range"),R(this[t])}setComponent(t,e){return L(t>=0&&t<this.ELEMENTS,"index is out of range"),this[t]=e,this.check()}addVectors(t,e){return this.copy(t).add(e)}subVectors(t,e){return this.copy(t).subtract(e)}multiplyVectors(t,e){return this.copy(t).multiply(e)}addScaledVector(t,e){return this.add(new this.constructor(t).multiplyScalar(e))}},D={};s(D,{add:()=>W,angle:()=>bt,ceil:()=>K,clone:()=>z,copy:()=>H,create:()=>U,cross:()=>ht,dist:()=>Pt,distance:()=>rt,div:()=>Mt,divide:()=>X,dot:()=>ct,equals:()=>wt,exactEquals:()=>xt,floor:()=>Z,forEach:()=>It,fromValues:()=>V,inverse:()=>lt,len:()=>Ct,length:()=>ot,lerp:()=>dt,max:()=>$,min:()=>Q,mul:()=>Et,multiply:()=>Y,negate:()=>at,normalize:()=>ut,random:()=>ft,rotate:()=>vt,round:()=>tt,scale:()=>et,scaleAndAdd:()=>nt,set:()=>q,sqrDist:()=>Tt,sqrLen:()=>Ot,squaredDistance:()=>it,squaredLength:()=>st,str:()=>At,sub:()=>St,subtract:()=>J,transformMat2:()=>pt,transformMat2d:()=>gt,transformMat3:()=>yt,transformMat4:()=>mt,zero:()=>_t});var F=1e-6,N="undefined"!=typeof Float32Array?Float32Array:Array,j=Math.random;function G(t){return t>=0?Math.round(t):t%.5==0?Math.floor(t):Math.round(t)}function U(){const t=new N(2);return N!=Float32Array&&(t[0]=0,t[1]=0),t}function z(t){const e=new N(2);return e[0]=t[0],e[1]=t[1],e}function V(t,e){const n=new N(2);return n[0]=t,n[1]=e,n}function H(t,e){return t[0]=e[0],t[1]=e[1],t}function q(t,e,n){return t[0]=e,t[1]=n,t}function W(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function J(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}function Y(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t}function X(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t}function K(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t}function Z(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t}function Q(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t}function $(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t}function tt(t,e){return t[0]=G(e[0]),t[1]=G(e[1]),t}function et(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t}function nt(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t}function rt(t,e){const n=e[0]-t[0],r=e[1]-t[1];return Math.sqrt(n*n+r*r)}function it(t,e){const n=e[0]-t[0],r=e[1]-t[1];return n*n+r*r}function ot(t){const e=t[0],n=t[1];return Math.sqrt(e*e+n*n)}function st(t){const e=t[0],n=t[1];return e*e+n*n}function at(t,e){return t[0]=-e[0],t[1]=-e[1],t}function lt(t,e){return t[0]=1/e[0],t[1]=1/e[1],t}function ut(t,e){const n=e[0],r=e[1];let i=n*n+r*r;return i>0&&(i=1/Math.sqrt(i)),t[0]=e[0]*i,t[1]=e[1]*i,t}function ct(t,e){return t[0]*e[0]+t[1]*e[1]}function ht(t,e,n){const r=e[0]*n[1]-e[1]*n[0];return t[0]=t[1]=0,t[2]=r,t}function dt(t,e,n,r){const i=e[0],o=e[1];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t}function ft(t,e){e=void 0===e?1:e;const n=2*j()*Math.PI;return t[0]=Math.cos(n)*e,t[1]=Math.sin(n)*e,t}function pt(t,e,n){const r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t}function gt(t,e,n){const r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i+n[4],t[1]=n[1]*r+n[3]*i+n[5],t}function yt(t,e,n){const r=e[0],i=e[1];return t[0]=n[0]*r+n[3]*i+n[6],t[1]=n[1]*r+n[4]*i+n[7],t}function mt(t,e,n){const r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t}function vt(t,e,n,r){const i=e[0]-n[0],o=e[1]-n[1],s=Math.sin(r),a=Math.cos(r);return t[0]=i*a-o*s+n[0],t[1]=i*s+o*a+n[1],t}function bt(t,e){const n=t[0],r=t[1],i=e[0],o=e[1],s=Math.sqrt((n*n+r*r)*(i*i+o*o)),a=s&&(n*i+r*o)/s;return Math.acos(Math.min(Math.max(a,-1),1))}function _t(t){return t[0]=0,t[1]=0,t}function At(t){return`vec2(${t[0]}, ${t[1]})`}function xt(t,e){return t[0]===e[0]&&t[1]===e[1]}function wt(t,e){const n=t[0],r=t[1],i=e[0],o=e[1];return Math.abs(n-i)<=F*Math.max(1,Math.abs(n),Math.abs(i))&&Math.abs(r-o)<=F*Math.max(1,Math.abs(r),Math.abs(o))}Math.PI;var Ct=ot,St=J,Et=Y,Mt=X,Pt=rt,Tt=it,Ot=st,It=function(){const t=U();return function(e,n,r,i,o,s){let a,l;for(n||(n=2),r||(r=0),l=i?Math.min(i*n+r,e.length):e.length,a=r;a<l;a+=n)t[0]=e[a],t[1]=e[a+1],o(t,t,s),e[a]=t[0],e[a+1]=t[1];return e}}();function Rt(t,e,n){const r=e[0],i=e[1],o=n[3]*r+n[7]*i||1;return t[0]=(n[0]*r+n[4]*i)/o,t[1]=(n[1]*r+n[5]*i)/o,t}function Bt(t,e,n){const r=e[0],i=e[1],o=e[2],s=n[3]*r+n[7]*i+n[11]*o||1;return t[0]=(n[0]*r+n[4]*i+n[8]*o)/s,t[1]=(n[1]*r+n[5]*i+n[9]*o)/s,t[2]=(n[2]*r+n[6]*i+n[10]*o)/s,t}function Lt(t,e,n){const r=e[0],i=e[1],o=e[2];return t[0]=n[0]*r+n[3]*i+n[6]*o,t[1]=n[1]*r+n[4]*i+n[7]*o,t[2]=n[2]*r+n[5]*i+n[8]*o,t[3]=e[3],t}var kt=class extends k{constructor(t=0,e=0){super(2),f(t)&&1===arguments.length?this.copy(t):(c.debug&&(R(t),R(e)),this[0]=t,this[1]=e)}set(t,e){return this[0]=t,this[1]=e,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this.check()}fromObject(t){return c.debug&&(R(t.x),R(t.y)),this[0]=t.x,this[1]=t.y,this.check()}toObject(t){return t.x=this[0],t.y=this[1],t}get ELEMENTS(){return 2}horizontalAngle(){return Math.atan2(this.y,this.x)}verticalAngle(){return Math.atan2(this.x,this.y)}transform(t){return this.transformAsPoint(t)}transformAsPoint(t){return mt(this,this,t),this.check()}transformAsVector(t){return Rt(this,this,t),this.check()}transformByMatrix3(t){return yt(this,this,t),this.check()}transformByMatrix2x3(t){return gt(this,this,t),this.check()}transformByMatrix2(t){return pt(this,this,t),this.check()}},Dt={};function Ft(){const t=new N(3);return N!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function Nt(t){const e=new N(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function jt(t){const e=t[0],n=t[1],r=t[2];return Math.sqrt(e*e+n*n+r*r)}function Gt(t,e,n){const r=new N(3);return r[0]=t,r[1]=e,r[2]=n,r}function Ut(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function zt(t,e,n,r){return t[0]=e,t[1]=n,t[2]=r,t}function Vt(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function Ht(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function qt(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function Wt(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t}function Jt(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}function Yt(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}function Xt(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t}function Kt(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t}function Zt(t,e){return t[0]=G(e[0]),t[1]=G(e[1]),t[2]=G(e[2]),t}function Qt(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function $t(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t}function te(t,e){const n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return Math.sqrt(n*n+r*r+i*i)}function ee(t,e){const n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return n*n+r*r+i*i}function ne(t){const e=t[0],n=t[1],r=t[2];return e*e+n*n+r*r}function re(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function ie(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function oe(t,e){const n=e[0],r=e[1],i=e[2];let o=n*n+r*r+i*i;return o>0&&(o=1/Math.sqrt(o)),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o,t}function se(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function ae(t,e,n){const r=e[0],i=e[1],o=e[2],s=n[0],a=n[1],l=n[2];return t[0]=i*l-o*a,t[1]=o*s-r*l,t[2]=r*a-i*s,t}function le(t,e,n,r){const i=e[0],o=e[1],s=e[2];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t[2]=s+r*(n[2]-s),t}function ue(t,e,n,r){const i=Math.acos(Math.min(Math.max(se(e,n),-1),1)),o=Math.sin(i),s=Math.sin((1-r)*i)/o,a=Math.sin(r*i)/o;return t[0]=s*e[0]+a*n[0],t[1]=s*e[1]+a*n[1],t[2]=s*e[2]+a*n[2],t}function ce(t,e,n,r,i,o){const s=o*o,a=s*(2*o-3)+1,l=s*(o-2)+o,u=s*(o-1),c=s*(3-2*o);return t[0]=e[0]*a+n[0]*l+r[0]*u+i[0]*c,t[1]=e[1]*a+n[1]*l+r[1]*u+i[1]*c,t[2]=e[2]*a+n[2]*l+r[2]*u+i[2]*c,t}function he(t,e,n,r,i,o){const s=1-o,a=s*s,l=o*o,u=a*s,c=3*o*a,h=3*l*s,d=l*o;return t[0]=e[0]*u+n[0]*c+r[0]*h+i[0]*d,t[1]=e[1]*u+n[1]*c+r[1]*h+i[1]*d,t[2]=e[2]*u+n[2]*c+r[2]*h+i[2]*d,t}function de(t,e){e=void 0===e?1:e;const n=2*j()*Math.PI,r=2*j()-1,i=Math.sqrt(1-r*r)*e;return t[0]=Math.cos(n)*i,t[1]=Math.sin(n)*i,t[2]=r*e,t}function fe(t,e,n){const r=e[0],i=e[1],o=e[2];let s=n[3]*r+n[7]*i+n[11]*o+n[15];return s=s||1,t[0]=(n[0]*r+n[4]*i+n[8]*o+n[12])/s,t[1]=(n[1]*r+n[5]*i+n[9]*o+n[13])/s,t[2]=(n[2]*r+n[6]*i+n[10]*o+n[14])/s,t}function pe(t,e,n){const r=e[0],i=e[1],o=e[2];return t[0]=r*n[0]+i*n[3]+o*n[6],t[1]=r*n[1]+i*n[4]+o*n[7],t[2]=r*n[2]+i*n[5]+o*n[8],t}function ge(t,e,n){const r=n[0],i=n[1],o=n[2],s=n[3],a=e[0],l=e[1],u=e[2];let c=i*u-o*l,h=o*a-r*u,d=r*l-i*a,f=i*d-o*h,p=o*c-r*d,g=r*h-i*c;const y=2*s;return c*=y,h*=y,d*=y,f*=2,p*=2,g*=2,t[0]=a+c+f,t[1]=l+h+p,t[2]=u+d+g,t}function ye(t,e,n,r){const i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[0],o[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),o[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function me(t,e,n,r){const i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),o[1]=i[1],o[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function ve(t,e,n,r){const i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),o[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),o[2]=i[2],t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function be(t,e){const n=t[0],r=t[1],i=t[2],o=e[0],s=e[1],a=e[2],l=Math.sqrt((n*n+r*r+i*i)*(o*o+s*s+a*a)),u=l&&se(t,e)/l;return Math.acos(Math.min(Math.max(u,-1),1))}function _e(t){return t[0]=0,t[1]=0,t[2]=0,t}function Ae(t){return`vec3(${t[0]}, ${t[1]}, ${t[2]})`}function xe(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function we(t,e){const n=t[0],r=t[1],i=t[2],o=e[0],s=e[1],a=e[2];return Math.abs(n-o)<=F*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(r-s)<=F*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(i-a)<=F*Math.max(1,Math.abs(i),Math.abs(a))}s(Dt,{add:()=>Vt,angle:()=>be,bezier:()=>he,ceil:()=>Jt,clone:()=>Nt,copy:()=>Ut,create:()=>Ft,cross:()=>ae,dist:()=>Te,distance:()=>te,div:()=>Pe,divide:()=>Wt,dot:()=>se,equals:()=>we,exactEquals:()=>xe,floor:()=>Yt,forEach:()=>Be,fromValues:()=>Gt,hermite:()=>ce,inverse:()=>ie,len:()=>Ie,length:()=>jt,lerp:()=>le,max:()=>Kt,min:()=>Xt,mul:()=>Me,multiply:()=>qt,negate:()=>re,normalize:()=>oe,random:()=>de,rotateX:()=>ye,rotateY:()=>me,rotateZ:()=>ve,round:()=>Zt,scale:()=>Qt,scaleAndAdd:()=>$t,set:()=>zt,slerp:()=>ue,sqrDist:()=>Oe,sqrLen:()=>Re,squaredDistance:()=>ee,squaredLength:()=>ne,str:()=>Ae,sub:()=>Ee,subtract:()=>Ht,transformMat3:()=>pe,transformMat4:()=>fe,transformQuat:()=>ge,zero:()=>_e});var Ce,Se,Ee=Ht,Me=qt,Pe=Wt,Te=te,Oe=ee,Ie=jt,Re=ne,Be=function(){const t=Ft();return function(e,n,r,i,o,s){let a,l;for(n||(n=3),r||(r=0),l=i?Math.min(i*n+r,e.length):e.length,a=r;a<l;a+=n)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],o(t,t,s),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2];return e}}(),Le=[0,0,0],ke=class extends k{static get ZERO(){return Ce||(Ce=new ke(0,0,0),Object.freeze(Ce)),Ce}constructor(t=0,e=0,n=0){super(-0,-0,-0),1===arguments.length&&f(t)?this.copy(t):(c.debug&&(R(t),R(e),R(n)),this[0]=t,this[1]=e,this[2]=n)}set(t,e,n){return this[0]=t,this[1]=e,this[2]=n,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this.check()}fromObject(t){return c.debug&&(R(t.x),R(t.y),R(t.z)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this.check()}toObject(t){return t.x=this[0],t.y=this[1],t.z=this[2],t}get ELEMENTS(){return 3}get z(){return this[2]}set z(t){this[2]=R(t)}angle(t){return be(this,t)}cross(t){return ae(this,this,t),this.check()}rotateX({radians:t,origin:e=Le}){return ye(this,this,e,t),this.check()}rotateY({radians:t,origin:e=Le}){return me(this,this,e,t),this.check()}rotateZ({radians:t,origin:e=Le}){return ve(this,this,e,t),this.check()}transform(t){return this.transformAsPoint(t)}transformAsPoint(t){return fe(this,this,t),this.check()}transformAsVector(t){return Bt(this,this,t),this.check()}transformByMatrix3(t){return pe(this,this,t),this.check()}transformByMatrix2(t){return function(t,e,n){const r=e[0],i=e[1];t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t[2]=e[2]}(this,this,t),this.check()}transformByQuaternion(t){return ge(this,this,t),this.check()}},De=class extends k{static get ZERO(){return Se||(Se=new De(0,0,0,0),Object.freeze(Se)),Se}constructor(t=0,e=0,n=0,r=0){super(-0,-0,-0,-0),f(t)&&1===arguments.length?this.copy(t):(c.debug&&(R(t),R(e),R(n),R(r)),this[0]=t,this[1]=e,this[2]=n,this[3]=r)}set(t,e,n,r){return this[0]=t,this[1]=e,this[2]=n,this[3]=r,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this.check()}fromObject(t){return c.debug&&(R(t.x),R(t.y),R(t.z),R(t.w)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this[3]=t.w,this}toObject(t){return t.x=this[0],t.y=this[1],t.z=this[2],t.w=this[3],t}get ELEMENTS(){return 4}get z(){return this[2]}set z(t){this[2]=R(t)}get w(){return this[3]}set w(t){this[3]=R(t)}transform(t){return fe(this,this,t),this.check()}transformByMatrix3(t){return Lt(this,this,t),this.check()}transformByMatrix2(t){return function(t,e,n){const r=e[0],i=e[1];t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t[2]=e[2],t[3]=e[3]}(this,this,t),this.check()}transformByQuaternion(t){return ge(this,this,t),this.check()}applyMatrix4(t){return t.transform(this,this),this}},Fe=class extends I{toString(){let t="[";if(c.printRowMajor){t+="row-major:";for(let e=0;e<this.RANK;++e)for(let n=0;n<this.RANK;++n)t+=` ${this[n*this.RANK+e]}`}else{t+="column-major:";for(let e=0;e<this.ELEMENTS;++e)t+=` ${this[e]}`}return t+="]",t}getElementIndex(t,e){return e*this.RANK+t}getElement(t,e){return this[e*this.RANK+t]}setElement(t,e,n){return this[e*this.RANK+t]=R(n),this}getColumn(t,e=new Array(this.RANK).fill(-0)){const n=t*this.RANK;for(let t=0;t<this.RANK;++t)e[t]=this[n+t];return e}setColumn(t,e){const n=t*this.RANK;for(let t=0;t<this.RANK;++t)this[n+t]=e[t];return this}},Ne={};function je(){const t=new N(9);return N!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function Ge(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}function Ue(t){const e=new N(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function ze(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function Ve(t,e,n,r,i,o,s,a,l){const u=new N(9);return u[0]=t,u[1]=e,u[2]=n,u[3]=r,u[4]=i,u[5]=o,u[6]=s,u[7]=a,u[8]=l,u}function He(t,e,n,r,i,o,s,a,l,u){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=o,t[5]=s,t[6]=a,t[7]=l,t[8]=u,t}function qe(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function We(t,e){if(t===e){const n=e[1],r=e[2],i=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=r,t[7]=i}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function Je(t,e){const n=e[0],r=e[1],i=e[2],o=e[3],s=e[4],a=e[5],l=e[6],u=e[7],c=e[8],h=c*s-a*u,d=-c*o+a*l,f=u*o-s*l;let p=n*h+r*d+i*f;return p?(p=1/p,t[0]=h*p,t[1]=(-c*r+i*u)*p,t[2]=(a*r-i*s)*p,t[3]=d*p,t[4]=(c*n-i*l)*p,t[5]=(-a*n+i*o)*p,t[6]=f*p,t[7]=(-u*n+r*l)*p,t[8]=(s*n-r*o)*p,t):null}function Ye(t,e){const n=e[0],r=e[1],i=e[2],o=e[3],s=e[4],a=e[5],l=e[6],u=e[7],c=e[8];return t[0]=s*c-a*u,t[1]=i*u-r*c,t[2]=r*a-i*s,t[3]=a*l-o*c,t[4]=n*c-i*l,t[5]=i*o-n*a,t[6]=o*u-s*l,t[7]=r*l-n*u,t[8]=n*s-r*o,t}function Xe(t){const e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],s=t[5],a=t[6],l=t[7],u=t[8];return e*(u*o-s*l)+n*(-u*i+s*a)+r*(l*i-o*a)}function Ke(t,e,n){const r=e[0],i=e[1],o=e[2],s=e[3],a=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=n[0],f=n[1],p=n[2],g=n[3],y=n[4],m=n[5],v=n[6],b=n[7],_=n[8];return t[0]=d*r+f*s+p*u,t[1]=d*i+f*a+p*c,t[2]=d*o+f*l+p*h,t[3]=g*r+y*s+m*u,t[4]=g*i+y*a+m*c,t[5]=g*o+y*l+m*h,t[6]=v*r+b*s+_*u,t[7]=v*i+b*a+_*c,t[8]=v*o+b*l+_*h,t}function Ze(t,e,n){const r=e[0],i=e[1],o=e[2],s=e[3],a=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=n[0],f=n[1];return t[0]=r,t[1]=i,t[2]=o,t[3]=s,t[4]=a,t[5]=l,t[6]=d*r+f*s+u,t[7]=d*i+f*a+c,t[8]=d*o+f*l+h,t}function Qe(t,e,n){const r=e[0],i=e[1],o=e[2],s=e[3],a=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=Math.sin(n),f=Math.cos(n);return t[0]=f*r+d*s,t[1]=f*i+d*a,t[2]=f*o+d*l,t[3]=f*s-d*r,t[4]=f*a-d*i,t[5]=f*l-d*o,t[6]=u,t[7]=c,t[8]=h,t}function $e(t,e,n){const r=n[0],i=n[1];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=i*e[3],t[4]=i*e[4],t[5]=i*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function tn(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t}function en(t,e){const n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=-n,t[4]=r,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function nn(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function rn(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t}function on(t,e){const n=e[0],r=e[1],i=e[2],o=e[3],s=n+n,a=r+r,l=i+i,u=n*s,c=r*s,h=r*a,d=i*s,f=i*a,p=i*l,g=o*s,y=o*a,m=o*l;return t[0]=1-h-p,t[3]=c-m,t[6]=d+y,t[1]=c+m,t[4]=1-u-p,t[7]=f-g,t[2]=d-y,t[5]=f+g,t[8]=1-u-h,t}function sn(t,e){const n=e[0],r=e[1],i=e[2],o=e[3],s=e[4],a=e[5],l=e[6],u=e[7],c=e[8],h=e[9],d=e[10],f=e[11],p=e[12],g=e[13],y=e[14],m=e[15],v=n*a-r*s,b=n*l-i*s,_=n*u-o*s,A=r*l-i*a,x=r*u-o*a,w=i*u-o*l,C=c*g-h*p,S=c*y-d*p,E=c*m-f*p,M=h*y-d*g,P=h*m-f*g,T=d*m-f*y;let O=v*T-b*P+_*M+A*E-x*S+w*C;return O?(O=1/O,t[0]=(a*T-l*P+u*M)*O,t[1]=(l*E-s*T-u*S)*O,t[2]=(s*P-a*E+u*C)*O,t[3]=(i*P-r*T-o*M)*O,t[4]=(n*T-i*E+o*S)*O,t[5]=(r*E-n*P-o*C)*O,t[6]=(g*w-y*x+m*A)*O,t[7]=(y*_-p*w-m*b)*O,t[8]=(p*x-g*_+m*v)*O,t):null}function an(t,e,n){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/n,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}function ln(t){return`mat3(${t[0]}, ${t[1]}, ${t[2]}, ${t[3]}, ${t[4]}, ${t[5]}, ${t[6]}, ${t[7]}, ${t[8]})`}function un(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]+t[3]*t[3]+t[4]*t[4]+t[5]*t[5]+t[6]*t[6]+t[7]*t[7]+t[8]*t[8])}function cn(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t}function hn(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t}function dn(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t}function fn(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t}function pn(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]}function gn(t,e){const n=t[0],r=t[1],i=t[2],o=t[3],s=t[4],a=t[5],l=t[6],u=t[7],c=t[8],h=e[0],d=e[1],f=e[2],p=e[3],g=e[4],y=e[5],m=e[6],v=e[7],b=e[8];return Math.abs(n-h)<=F*Math.max(1,Math.abs(n),Math.abs(h))&&Math.abs(r-d)<=F*Math.max(1,Math.abs(r),Math.abs(d))&&Math.abs(i-f)<=F*Math.max(1,Math.abs(i),Math.abs(f))&&Math.abs(o-p)<=F*Math.max(1,Math.abs(o),Math.abs(p))&&Math.abs(s-g)<=F*Math.max(1,Math.abs(s),Math.abs(g))&&Math.abs(a-y)<=F*Math.max(1,Math.abs(a),Math.abs(y))&&Math.abs(l-m)<=F*Math.max(1,Math.abs(l),Math.abs(m))&&Math.abs(u-v)<=F*Math.max(1,Math.abs(u),Math.abs(v))&&Math.abs(c-b)<=F*Math.max(1,Math.abs(c),Math.abs(b))}s(Ne,{add:()=>cn,adjoint:()=>Ye,clone:()=>Ue,copy:()=>ze,create:()=>je,determinant:()=>Xe,equals:()=>gn,exactEquals:()=>pn,frob:()=>un,fromMat2d:()=>rn,fromMat4:()=>Ge,fromQuat:()=>on,fromRotation:()=>en,fromScaling:()=>nn,fromTranslation:()=>tn,fromValues:()=>Ve,identity:()=>qe,invert:()=>Je,mul:()=>vn,multiply:()=>Ke,multiplyScalar:()=>dn,multiplyScalarAndAdd:()=>fn,normalFromMat4:()=>sn,projection:()=>an,rotate:()=>Qe,scale:()=>$e,set:()=>He,str:()=>ln,sub:()=>bn,subtract:()=>hn,translate:()=>Ze,transpose:()=>We});var yn,mn,vn=Ke,bn=hn;(mn=yn||(yn={}))[mn.COL0ROW0=0]="COL0ROW0",mn[mn.COL0ROW1=1]="COL0ROW1",mn[mn.COL0ROW2=2]="COL0ROW2",mn[mn.COL1ROW0=3]="COL1ROW0",mn[mn.COL1ROW1=4]="COL1ROW1",mn[mn.COL1ROW2=5]="COL1ROW2",mn[mn.COL2ROW0=6]="COL2ROW0",mn[mn.COL2ROW1=7]="COL2ROW1",mn[mn.COL2ROW2=8]="COL2ROW2";var _n,An=Object.freeze([1,0,0,0,1,0,0,0,1]),xn=class extends Fe{static get IDENTITY(){return wn||(wn=new xn,Object.freeze(wn)),wn}static get ZERO(){return _n||(_n=new xn([0,0,0,0,0,0,0,0,0]),Object.freeze(_n)),_n}get ELEMENTS(){return 9}get RANK(){return 3}get INDICES(){return yn}constructor(t,...e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(t)?this.copy(t):e.length>0?this.copy([t,...e]):this.identity()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this.check()}identity(){return this.copy(An)}fromObject(t){return this.check()}fromQuaternion(t){return on(this,t),this.check()}set(t,e,n,r,i,o,s,a,l){return this[0]=t,this[1]=e,this[2]=n,this[3]=r,this[4]=i,this[5]=o,this[6]=s,this[7]=a,this[8]=l,this.check()}setRowMajor(t,e,n,r,i,o,s,a,l){return this[0]=t,this[1]=r,this[2]=s,this[3]=e,this[4]=i,this[5]=a,this[6]=n,this[7]=o,this[8]=l,this.check()}determinant(){return Xe(this)}transpose(){return We(this,this),this.check()}invert(){return Je(this,this),this.check()}multiplyLeft(t){return Ke(this,t,this),this.check()}multiplyRight(t){return Ke(this,this,t),this.check()}rotate(t){return Qe(this,this,t),this.check()}scale(t){return Array.isArray(t)?$e(this,this,t):$e(this,this,[t,t]),this.check()}translate(t){return Ze(this,this,t),this.check()}transform(t,e){let n;switch(t.length){case 2:n=yt(e||[-0,-0],t,this);break;case 3:n=pe(e||[-0,-0,-0],t,this);break;case 4:n=Lt(e||[-0,-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return B(n,t.length),n}transformVector(t,e){return this.transform(t,e)}transformVector2(t,e){return this.transform(t,e)}transformVector3(t,e){return this.transform(t,e)}},wn=null,Cn={};function Sn(){const t=new N(16);return N!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function En(t){const e=new N(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Mn(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Pn(t,e,n,r,i,o,s,a,l,u,c,h,d,f,p,g){const y=new N(16);return y[0]=t,y[1]=e,y[2]=n,y[3]=r,y[4]=i,y[5]=o,y[6]=s,y[7]=a,y[8]=l,y[9]=u,y[10]=c,y[11]=h,y[12]=d,y[13]=f,y[14]=p,y[15]=g,y}function Tn(t,e,n,r,i,o,s,a,l,u,c,h,d,f,p,g,y){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=o,t[5]=s,t[6]=a,t[7]=l,t[8]=u,t[9]=c,t[10]=h,t[11]=d,t[12]=f,t[13]=p,t[14]=g,t[15]=y,t}function On(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function In(t,e){if(t===e){const n=e[1],r=e[2],i=e[3],o=e[6],s=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=o,t[11]=e[14],t[12]=i,t[13]=s,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function Rn(t,e){const n=e[0],r=e[1],i=e[2],o=e[3],s=e[4],a=e[5],l=e[6],u=e[7],c=e[8],h=e[9],d=e[10],f=e[11],p=e[12],g=e[13],y=e[14],m=e[15],v=n*a-r*s,b=n*l-i*s,_=n*u-o*s,A=r*l-i*a,x=r*u-o*a,w=i*u-o*l,C=c*g-h*p,S=c*y-d*p,E=c*m-f*p,M=h*y-d*g,P=h*m-f*g,T=d*m-f*y;let O=v*T-b*P+_*M+A*E-x*S+w*C;return O?(O=1/O,t[0]=(a*T-l*P+u*M)*O,t[1]=(i*P-r*T-o*M)*O,t[2]=(g*w-y*x+m*A)*O,t[3]=(d*x-h*w-f*A)*O,t[4]=(l*E-s*T-u*S)*O,t[5]=(n*T-i*E+o*S)*O,t[6]=(y*_-p*w-m*b)*O,t[7]=(c*w-d*_+f*b)*O,t[8]=(s*P-a*E+u*C)*O,t[9]=(r*E-n*P-o*C)*O,t[10]=(p*x-g*_+m*v)*O,t[11]=(h*_-c*x-f*v)*O,t[12]=(a*S-s*M-l*C)*O,t[13]=(n*M-r*S+i*C)*O,t[14]=(g*b-p*A-y*v)*O,t[15]=(c*A-h*b+d*v)*O,t):null}function Bn(t,e){const n=e[0],r=e[1],i=e[2],o=e[3],s=e[4],a=e[5],l=e[6],u=e[7],c=e[8],h=e[9],d=e[10],f=e[11],p=e[12],g=e[13],y=e[14],m=e[15],v=n*a-r*s,b=n*l-i*s,_=n*u-o*s,A=r*l-i*a,x=r*u-o*a,w=i*u-o*l,C=c*g-h*p,S=c*y-d*p,E=c*m-f*p,M=h*y-d*g,P=h*m-f*g,T=d*m-f*y;return t[0]=a*T-l*P+u*M,t[1]=i*P-r*T-o*M,t[2]=g*w-y*x+m*A,t[3]=d*x-h*w-f*A,t[4]=l*E-s*T-u*S,t[5]=n*T-i*E+o*S,t[6]=y*_-p*w-m*b,t[7]=c*w-d*_+f*b,t[8]=s*P-a*E+u*C,t[9]=r*E-n*P-o*C,t[10]=p*x-g*_+m*v,t[11]=h*_-c*x-f*v,t[12]=a*S-s*M-l*C,t[13]=n*M-r*S+i*C,t[14]=g*b-p*A-y*v,t[15]=c*A-h*b+d*v,t}function Ln(t){const e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],s=t[5],a=t[6],l=t[7],u=t[8],c=t[9],h=t[10],d=t[11],f=t[12],p=t[13],g=t[14],y=e*s-n*o,m=e*a-r*o,v=n*a-r*s,b=u*p-c*f,_=u*g-h*f,A=c*g-h*p;return l*(e*A-n*_+r*b)-i*(o*A-s*_+a*b)+t[15]*(u*v-c*m+h*y)-d*(f*v-p*m+g*y)}function kn(t,e,n){const r=e[0],i=e[1],o=e[2],s=e[3],a=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=e[9],f=e[10],p=e[11],g=e[12],y=e[13],m=e[14],v=e[15];let b=n[0],_=n[1],A=n[2],x=n[3];return t[0]=b*r+_*a+A*h+x*g,t[1]=b*i+_*l+A*d+x*y,t[2]=b*o+_*u+A*f+x*m,t[3]=b*s+_*c+A*p+x*v,b=n[4],_=n[5],A=n[6],x=n[7],t[4]=b*r+_*a+A*h+x*g,t[5]=b*i+_*l+A*d+x*y,t[6]=b*o+_*u+A*f+x*m,t[7]=b*s+_*c+A*p+x*v,b=n[8],_=n[9],A=n[10],x=n[11],t[8]=b*r+_*a+A*h+x*g,t[9]=b*i+_*l+A*d+x*y,t[10]=b*o+_*u+A*f+x*m,t[11]=b*s+_*c+A*p+x*v,b=n[12],_=n[13],A=n[14],x=n[15],t[12]=b*r+_*a+A*h+x*g,t[13]=b*i+_*l+A*d+x*y,t[14]=b*o+_*u+A*f+x*m,t[15]=b*s+_*c+A*p+x*v,t}function Dn(t,e,n){const r=n[0],i=n[1],o=n[2];let s,a,l,u,c,h,d,f,p,g,y,m;return e===t?(t[12]=e[0]*r+e[4]*i+e[8]*o+e[12],t[13]=e[1]*r+e[5]*i+e[9]*o+e[13],t[14]=e[2]*r+e[6]*i+e[10]*o+e[14],t[15]=e[3]*r+e[7]*i+e[11]*o+e[15]):(s=e[0],a=e[1],l=e[2],u=e[3],c=e[4],h=e[5],d=e[6],f=e[7],p=e[8],g=e[9],y=e[10],m=e[11],t[0]=s,t[1]=a,t[2]=l,t[3]=u,t[4]=c,t[5]=h,t[6]=d,t[7]=f,t[8]=p,t[9]=g,t[10]=y,t[11]=m,t[12]=s*r+c*i+p*o+e[12],t[13]=a*r+h*i+g*o+e[13],t[14]=l*r+d*i+y*o+e[14],t[15]=u*r+f*i+m*o+e[15]),t}function Fn(t,e,n){const r=n[0],i=n[1],o=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Nn(t,e,n,r){let i,o,s,a,l,u,c,h,d,f,p,g,y,m,v,b,_,A,x,w,C,S,E,M,P=r[0],T=r[1],O=r[2],I=Math.sqrt(P*P+T*T+O*O);return I<F?null:(I=1/I,P*=I,T*=I,O*=I,o=Math.sin(n),i=Math.cos(n),s=1-i,a=e[0],l=e[1],u=e[2],c=e[3],h=e[4],d=e[5],f=e[6],p=e[7],g=e[8],y=e[9],m=e[10],v=e[11],b=P*P*s+i,_=T*P*s+O*o,A=O*P*s-T*o,x=P*T*s-O*o,w=T*T*s+i,C=O*T*s+P*o,S=P*O*s+T*o,E=T*O*s-P*o,M=O*O*s+i,t[0]=a*b+h*_+g*A,t[1]=l*b+d*_+y*A,t[2]=u*b+f*_+m*A,t[3]=c*b+p*_+v*A,t[4]=a*x+h*w+g*C,t[5]=l*x+d*w+y*C,t[6]=u*x+f*w+m*C,t[7]=c*x+p*w+v*C,t[8]=a*S+h*E+g*M,t[9]=l*S+d*E+y*M,t[10]=u*S+f*E+m*M,t[11]=c*S+p*E+v*M,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function jn(t,e,n){const r=Math.sin(n),i=Math.cos(n),o=e[4],s=e[5],a=e[6],l=e[7],u=e[8],c=e[9],h=e[10],d=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*i+u*r,t[5]=s*i+c*r,t[6]=a*i+h*r,t[7]=l*i+d*r,t[8]=u*i-o*r,t[9]=c*i-s*r,t[10]=h*i-a*r,t[11]=d*i-l*r,t}function Gn(t,e,n){const r=Math.sin(n),i=Math.cos(n),o=e[0],s=e[1],a=e[2],l=e[3],u=e[8],c=e[9],h=e[10],d=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i-u*r,t[1]=s*i-c*r,t[2]=a*i-h*r,t[3]=l*i-d*r,t[8]=o*r+u*i,t[9]=s*r+c*i,t[10]=a*r+h*i,t[11]=l*r+d*i,t}function Un(t,e,n){const r=Math.sin(n),i=Math.cos(n),o=e[0],s=e[1],a=e[2],l=e[3],u=e[4],c=e[5],h=e[6],d=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i+u*r,t[1]=s*i+c*r,t[2]=a*i+h*r,t[3]=l*i+d*r,t[4]=u*i-o*r,t[5]=c*i-s*r,t[6]=h*i-a*r,t[7]=d*i-l*r,t}function zn(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function Vn(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Hn(t,e,n){let r,i,o,s=n[0],a=n[1],l=n[2],u=Math.sqrt(s*s+a*a+l*l);return u<F?null:(u=1/u,s*=u,a*=u,l*=u,i=Math.sin(e),r=Math.cos(e),o=1-r,t[0]=s*s*o+r,t[1]=a*s*o+l*i,t[2]=l*s*o-a*i,t[3]=0,t[4]=s*a*o-l*i,t[5]=a*a*o+r,t[6]=l*a*o+s*i,t[7]=0,t[8]=s*l*o+a*i,t[9]=a*l*o-s*i,t[10]=l*l*o+r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function qn(t,e){const n=Math.sin(e),r=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Wn(t,e){const n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Jn(t,e){const n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Yn(t,e,n){const r=e[0],i=e[1],o=e[2],s=e[3],a=r+r,l=i+i,u=o+o,c=r*a,h=r*l,d=r*u,f=i*l,p=i*u,g=o*u,y=s*a,m=s*l,v=s*u;return t[0]=1-(f+g),t[1]=h+v,t[2]=d-m,t[3]=0,t[4]=h-v,t[5]=1-(c+g),t[6]=p+y,t[7]=0,t[8]=d+m,t[9]=p-y,t[10]=1-(c+f),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function Xn(t,e){const n=new N(3),r=-e[0],i=-e[1],o=-e[2],s=e[3],a=e[4],l=e[5],u=e[6],c=e[7],h=r*r+i*i+o*o+s*s;return h>0?(n[0]=2*(a*s+c*r+l*o-u*i)/h,n[1]=2*(l*s+c*i+u*r-a*o)/h,n[2]=2*(u*s+c*o+a*i-l*r)/h):(n[0]=2*(a*s+c*r+l*o-u*i),n[1]=2*(l*s+c*i+u*r-a*o),n[2]=2*(u*s+c*o+a*i-l*r)),Yn(t,e,n),t}function Kn(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function Zn(t,e){const n=e[0],r=e[1],i=e[2],o=e[4],s=e[5],a=e[6],l=e[8],u=e[9],c=e[10];return t[0]=Math.sqrt(n*n+r*r+i*i),t[1]=Math.sqrt(o*o+s*s+a*a),t[2]=Math.sqrt(l*l+u*u+c*c),t}function Qn(t,e){const n=new N(3);Zn(n,e);const r=1/n[0],i=1/n[1],o=1/n[2],s=e[0]*r,a=e[1]*i,l=e[2]*o,u=e[4]*r,c=e[5]*i,h=e[6]*o,d=e[8]*r,f=e[9]*i,p=e[10]*o,g=s+c+p;let y=0;return g>0?(y=2*Math.sqrt(g+1),t[3]=.25*y,t[0]=(h-f)/y,t[1]=(d-l)/y,t[2]=(a-u)/y):s>c&&s>p?(y=2*Math.sqrt(1+s-c-p),t[3]=(h-f)/y,t[0]=.25*y,t[1]=(a+u)/y,t[2]=(d+l)/y):c>p?(y=2*Math.sqrt(1+c-s-p),t[3]=(d-l)/y,t[0]=(a+u)/y,t[1]=.25*y,t[2]=(h+f)/y):(y=2*Math.sqrt(1+p-s-c),t[3]=(a-u)/y,t[0]=(d+l)/y,t[1]=(h+f)/y,t[2]=.25*y),t}function $n(t,e,n,r){e[0]=r[12],e[1]=r[13],e[2]=r[14];const i=r[0],o=r[1],s=r[2],a=r[4],l=r[5],u=r[6],c=r[8],h=r[9],d=r[10];n[0]=Math.sqrt(i*i+o*o+s*s),n[1]=Math.sqrt(a*a+l*l+u*u),n[2]=Math.sqrt(c*c+h*h+d*d);const f=1/n[0],p=1/n[1],g=1/n[2],y=i*f,m=o*p,v=s*g,b=a*f,_=l*p,A=u*g,x=c*f,w=h*p,C=d*g,S=y+_+C;let E=0;return S>0?(E=2*Math.sqrt(S+1),t[3]=.25*E,t[0]=(A-w)/E,t[1]=(x-v)/E,t[2]=(m-b)/E):y>_&&y>C?(E=2*Math.sqrt(1+y-_-C),t[3]=(A-w)/E,t[0]=.25*E,t[1]=(m+b)/E,t[2]=(x+v)/E):_>C?(E=2*Math.sqrt(1+_-y-C),t[3]=(x-v)/E,t[0]=(m+b)/E,t[1]=.25*E,t[2]=(A+w)/E):(E=2*Math.sqrt(1+C-y-_),t[3]=(m-b)/E,t[0]=(x+v)/E,t[1]=(A+w)/E,t[2]=.25*E),t}function tr(t,e,n,r){const i=e[0],o=e[1],s=e[2],a=e[3],l=i+i,u=o+o,c=s+s,h=i*l,d=i*u,f=i*c,p=o*u,g=o*c,y=s*c,m=a*l,v=a*u,b=a*c,_=r[0],A=r[1],x=r[2];return t[0]=(1-(p+y))*_,t[1]=(d+b)*_,t[2]=(f-v)*_,t[3]=0,t[4]=(d-b)*A,t[5]=(1-(h+y))*A,t[6]=(g+m)*A,t[7]=0,t[8]=(f+v)*x,t[9]=(g-m)*x,t[10]=(1-(h+p))*x,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function er(t,e,n,r,i){const o=e[0],s=e[1],a=e[2],l=e[3],u=o+o,c=s+s,h=a+a,d=o*u,f=o*c,p=o*h,g=s*c,y=s*h,m=a*h,v=l*u,b=l*c,_=l*h,A=r[0],x=r[1],w=r[2],C=i[0],S=i[1],E=i[2],M=(1-(g+m))*A,P=(f+_)*A,T=(p-b)*A,O=(f-_)*x,I=(1-(d+m))*x,R=(y+v)*x,B=(p+b)*w,L=(y-v)*w,k=(1-(d+g))*w;return t[0]=M,t[1]=P,t[2]=T,t[3]=0,t[4]=O,t[5]=I,t[6]=R,t[7]=0,t[8]=B,t[9]=L,t[10]=k,t[11]=0,t[12]=n[0]+C-(M*C+O*S+B*E),t[13]=n[1]+S-(P*C+I*S+L*E),t[14]=n[2]+E-(T*C+R*S+k*E),t[15]=1,t}function nr(t,e){const n=e[0],r=e[1],i=e[2],o=e[3],s=n+n,a=r+r,l=i+i,u=n*s,c=r*s,h=r*a,d=i*s,f=i*a,p=i*l,g=o*s,y=o*a,m=o*l;return t[0]=1-h-p,t[1]=c+m,t[2]=d-y,t[3]=0,t[4]=c-m,t[5]=1-u-p,t[6]=f+g,t[7]=0,t[8]=d+y,t[9]=f-g,t[10]=1-u-h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function rr(t,e,n,r,i,o,s){const a=1/(n-e),l=1/(i-r),u=1/(o-s);return t[0]=2*o*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*l,t[6]=0,t[7]=0,t[8]=(n+e)*a,t[9]=(i+r)*l,t[10]=(s+o)*u,t[11]=-1,t[12]=0,t[13]=0,t[14]=s*o*2*u,t[15]=0,t}function ir(t,e,n,r,i){const o=1/Math.tan(e/2);if(t[0]=o/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0){const e=1/(r-i);t[10]=(i+r)*e,t[14]=2*i*r*e}else t[10]=-1,t[14]=-2*r;return t}s(Cn,{add:()=>gr,adjoint:()=>Bn,clone:()=>En,copy:()=>Mn,create:()=>Sn,decompose:()=>$n,determinant:()=>Ln,equals:()=>_r,exactEquals:()=>br,frob:()=>pr,fromQuat:()=>nr,fromQuat2:()=>Xn,fromRotation:()=>Hn,fromRotationTranslation:()=>Yn,fromRotationTranslationScale:()=>tr,fromRotationTranslationScaleOrigin:()=>er,fromScaling:()=>Vn,fromTranslation:()=>zn,fromValues:()=>Pn,fromXRotation:()=>qn,fromYRotation:()=>Wn,fromZRotation:()=>Jn,frustum:()=>rr,getRotation:()=>Qn,getScaling:()=>Zn,getTranslation:()=>Kn,identity:()=>On,invert:()=>Rn,lookAt:()=>hr,mul:()=>Ar,multiply:()=>kn,multiplyScalar:()=>mr,multiplyScalarAndAdd:()=>vr,ortho:()=>ur,orthoNO:()=>lr,orthoZO:()=>cr,perspective:()=>or,perspectiveFromFieldOfView:()=>ar,perspectiveNO:()=>ir,perspectiveZO:()=>sr,rotate:()=>Nn,rotateX:()=>jn,rotateY:()=>Gn,rotateZ:()=>Un,scale:()=>Fn,set:()=>Tn,str:()=>fr,sub:()=>xr,subtract:()=>yr,targetTo:()=>dr,translate:()=>Dn,transpose:()=>In});var or=ir;function sr(t,e,n,r,i){const o=1/Math.tan(e/2);if(t[0]=o/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0){const e=1/(r-i);t[10]=i*e,t[14]=i*r*e}else t[10]=-1,t[14]=-r;return t}function ar(t,e,n,r){const i=Math.tan(e.upDegrees*Math.PI/180),o=Math.tan(e.downDegrees*Math.PI/180),s=Math.tan(e.leftDegrees*Math.PI/180),a=Math.tan(e.rightDegrees*Math.PI/180),l=2/(s+a),u=2/(i+o);return t[0]=l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=u,t[6]=0,t[7]=0,t[8]=-(s-a)*l*.5,t[9]=(i-o)*u*.5,t[10]=r/(n-r),t[11]=-1,t[12]=0,t[13]=0,t[14]=r*n/(n-r),t[15]=0,t}function lr(t,e,n,r,i,o,s){const a=1/(e-n),l=1/(r-i),u=1/(o-s);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+n)*a,t[13]=(i+r)*l,t[14]=(s+o)*u,t[15]=1,t}var ur=lr;function cr(t,e,n,r,i,o,s){const a=1/(e-n),l=1/(r-i),u=1/(o-s);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=u,t[11]=0,t[12]=(e+n)*a,t[13]=(i+r)*l,t[14]=o*u,t[15]=1,t}function hr(t,e,n,r){let i,o,s,a,l,u,c,h,d,f;const p=e[0],g=e[1],y=e[2],m=r[0],v=r[1],b=r[2],_=n[0],A=n[1],x=n[2];return Math.abs(p-_)<F&&Math.abs(g-A)<F&&Math.abs(y-x)<F?On(t):(h=p-_,d=g-A,f=y-x,i=1/Math.sqrt(h*h+d*d+f*f),h*=i,d*=i,f*=i,o=v*f-b*d,s=b*h-m*f,a=m*d-v*h,i=Math.sqrt(o*o+s*s+a*a),i?(i=1/i,o*=i,s*=i,a*=i):(o=0,s=0,a=0),l=d*a-f*s,u=f*o-h*a,c=h*s-d*o,i=Math.sqrt(l*l+u*u+c*c),i?(i=1/i,l*=i,u*=i,c*=i):(l=0,u=0,c=0),t[0]=o,t[1]=l,t[2]=h,t[3]=0,t[4]=s,t[5]=u,t[6]=d,t[7]=0,t[8]=a,t[9]=c,t[10]=f,t[11]=0,t[12]=-(o*p+s*g+a*y),t[13]=-(l*p+u*g+c*y),t[14]=-(h*p+d*g+f*y),t[15]=1,t)}function dr(t,e,n,r){const i=e[0],o=e[1],s=e[2],a=r[0],l=r[1],u=r[2];let c=i-n[0],h=o-n[1],d=s-n[2],f=c*c+h*h+d*d;f>0&&(f=1/Math.sqrt(f),c*=f,h*=f,d*=f);let p=l*d-u*h,g=u*c-a*d,y=a*h-l*c;return f=p*p+g*g+y*y,f>0&&(f=1/Math.sqrt(f),p*=f,g*=f,y*=f),t[0]=p,t[1]=g,t[2]=y,t[3]=0,t[4]=h*y-d*g,t[5]=d*p-c*y,t[6]=c*g-h*p,t[7]=0,t[8]=c,t[9]=h,t[10]=d,t[11]=0,t[12]=i,t[13]=o,t[14]=s,t[15]=1,t}function fr(t){return`mat4(${t[0]}, ${t[1]}, ${t[2]}, ${t[3]}, ${t[4]}, ${t[5]}, ${t[6]}, ${t[7]}, ${t[8]}, ${t[9]}, ${t[10]}, ${t[11]}, ${t[12]}, ${t[13]}, ${t[14]}, ${t[15]})`}function pr(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]+t[3]*t[3]+t[4]*t[4]+t[5]*t[5]+t[6]*t[6]+t[7]*t[7]+t[8]*t[8]+t[9]*t[9]+t[10]*t[10]+t[11]*t[11]+t[12]*t[12]+t[13]*t[13]+t[14]*t[14]+t[15]*t[15])}function gr(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t}function yr(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t}function mr(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t}function vr(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t[9]=e[9]+n[9]*r,t[10]=e[10]+n[10]*r,t[11]=e[11]+n[11]*r,t[12]=e[12]+n[12]*r,t[13]=e[13]+n[13]*r,t[14]=e[14]+n[14]*r,t[15]=e[15]+n[15]*r,t}function br(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function _r(t,e){const n=t[0],r=t[1],i=t[2],o=t[3],s=t[4],a=t[5],l=t[6],u=t[7],c=t[8],h=t[9],d=t[10],f=t[11],p=t[12],g=t[13],y=t[14],m=t[15],v=e[0],b=e[1],_=e[2],A=e[3],x=e[4],w=e[5],C=e[6],S=e[7],E=e[8],M=e[9],P=e[10],T=e[11],O=e[12],I=e[13],R=e[14],B=e[15];return Math.abs(n-v)<=F*Math.max(1,Math.abs(n),Math.abs(v))&&Math.abs(r-b)<=F*Math.max(1,Math.abs(r),Math.abs(b))&&Math.abs(i-_)<=F*Math.max(1,Math.abs(i),Math.abs(_))&&Math.abs(o-A)<=F*Math.max(1,Math.abs(o),Math.abs(A))&&Math.abs(s-x)<=F*Math.max(1,Math.abs(s),Math.abs(x))&&Math.abs(a-w)<=F*Math.max(1,Math.abs(a),Math.abs(w))&&Math.abs(l-C)<=F*Math.max(1,Math.abs(l),Math.abs(C))&&Math.abs(u-S)<=F*Math.max(1,Math.abs(u),Math.abs(S))&&Math.abs(c-E)<=F*Math.max(1,Math.abs(c),Math.abs(E))&&Math.abs(h-M)<=F*Math.max(1,Math.abs(h),Math.abs(M))&&Math.abs(d-P)<=F*Math.max(1,Math.abs(d),Math.abs(P))&&Math.abs(f-T)<=F*Math.max(1,Math.abs(f),Math.abs(T))&&Math.abs(p-O)<=F*Math.max(1,Math.abs(p),Math.abs(O))&&Math.abs(g-I)<=F*Math.max(1,Math.abs(g),Math.abs(I))&&Math.abs(y-R)<=F*Math.max(1,Math.abs(y),Math.abs(R))&&Math.abs(m-B)<=F*Math.max(1,Math.abs(m),Math.abs(B))}var Ar=kn,xr=yr,wr={};function Cr(){const t=new N(4);return N!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function Sr(t){const e=new N(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function Er(t,e,n,r){const i=new N(4);return i[0]=t,i[1]=e,i[2]=n,i[3]=r,i}function Mr(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function Pr(t,e,n,r,i){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t}function Tr(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t}function Or(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t}function Ir(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t[3]=e[3]*n[3],t}function Rr(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t[3]=e[3]/n[3],t}function Br(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t}function Lr(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t}function kr(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t[3]=Math.min(e[3],n[3]),t}function Dr(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t[3]=Math.max(e[3],n[3]),t}function Fr(t,e){return t[0]=G(e[0]),t[1]=G(e[1]),t[2]=G(e[2]),t[3]=G(e[3]),t}function Nr(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function jr(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t}function Gr(t,e){const n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2],o=e[3]-t[3];return Math.sqrt(n*n+r*r+i*i+o*o)}function Ur(t,e){const n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2],o=e[3]-t[3];return n*n+r*r+i*i+o*o}function zr(t){const e=t[0],n=t[1],r=t[2],i=t[3];return Math.sqrt(e*e+n*n+r*r+i*i)}function Vr(t){const e=t[0],n=t[1],r=t[2],i=t[3];return e*e+n*n+r*r+i*i}function Hr(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t}function qr(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t}function Wr(t,e){const n=e[0],r=e[1],i=e[2],o=e[3];let s=n*n+r*r+i*i+o*o;return s>0&&(s=1/Math.sqrt(s)),t[0]=n*s,t[1]=r*s,t[2]=i*s,t[3]=o*s,t}function Jr(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function Yr(t,e,n,r){const i=n[0]*r[1]-n[1]*r[0],o=n[0]*r[2]-n[2]*r[0],s=n[0]*r[3]-n[3]*r[0],a=n[1]*r[2]-n[2]*r[1],l=n[1]*r[3]-n[3]*r[1],u=n[2]*r[3]-n[3]*r[2],c=e[0],h=e[1],d=e[2],f=e[3];return t[0]=h*u-d*l+f*a,t[1]=-c*u+d*s-f*o,t[2]=c*l-h*s+f*i,t[3]=-c*a+h*o-d*i,t}function Xr(t,e,n,r){const i=e[0],o=e[1],s=e[2],a=e[3];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t[2]=s+r*(n[2]-s),t[3]=a+r*(n[3]-a),t}function Kr(t,e){let n,r,i,o,s,a;e=void 0===e?1:e;do{n=2*j()-1,r=2*j()-1,s=n*n+r*r}while(s>=1);do{i=2*j()-1,o=2*j()-1,a=i*i+o*o}while(a>=1);const l=Math.sqrt((1-s)/a);return t[0]=e*n,t[1]=e*r,t[2]=e*i*l,t[3]=e*o*l,t}function Zr(t,e,n){const r=e[0],i=e[1],o=e[2],s=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*o+n[12]*s,t[1]=n[1]*r+n[5]*i+n[9]*o+n[13]*s,t[2]=n[2]*r+n[6]*i+n[10]*o+n[14]*s,t[3]=n[3]*r+n[7]*i+n[11]*o+n[15]*s,t}function Qr(t,e,n){const r=e[0],i=e[1],o=e[2],s=n[0],a=n[1],l=n[2],u=n[3],c=u*r+a*o-l*i,h=u*i+l*r-s*o,d=u*o+s*i-a*r,f=-s*r-a*i-l*o;return t[0]=c*u+f*-s+h*-l-d*-a,t[1]=h*u+f*-a+d*-s-c*-l,t[2]=d*u+f*-l+c*-a-h*-s,t[3]=e[3],t}function $r(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}function ti(t){return`vec4(${t[0]}, ${t[1]}, ${t[2]}, ${t[3]})`}function ei(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function ni(t,e){const n=t[0],r=t[1],i=t[2],o=t[3],s=e[0],a=e[1],l=e[2],u=e[3];return Math.abs(n-s)<=F*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(r-a)<=F*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(i-l)<=F*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(o-u)<=F*Math.max(1,Math.abs(o),Math.abs(u))}s(wr,{add:()=>Tr,ceil:()=>Br,clone:()=>Sr,copy:()=>Mr,create:()=>Cr,cross:()=>Yr,dist:()=>ai,distance:()=>Gr,div:()=>si,divide:()=>Rr,dot:()=>Jr,equals:()=>ni,exactEquals:()=>ei,floor:()=>Lr,forEach:()=>hi,fromValues:()=>Er,inverse:()=>qr,len:()=>ui,length:()=>zr,lerp:()=>Xr,max:()=>Dr,min:()=>kr,mul:()=>oi,multiply:()=>Ir,negate:()=>Hr,normalize:()=>Wr,random:()=>Kr,round:()=>Fr,scale:()=>Nr,scaleAndAdd:()=>jr,set:()=>Pr,sqrDist:()=>li,sqrLen:()=>ci,squaredDistance:()=>Ur,squaredLength:()=>Vr,str:()=>ti,sub:()=>ii,subtract:()=>Or,transformMat4:()=>Zr,transformQuat:()=>Qr,zero:()=>$r});var ri,ii=Or,oi=Ir,si=Rr,ai=Gr,li=Ur,ui=zr,ci=Vr,hi=function(){const t=Cr();return function(e,n,r,i,o,s){let a,l;for(n||(n=4),r||(r=0),l=i?Math.min(i*n+r,e.length):e.length,a=r;a<l;a+=n)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],t[3]=e[a+3],o(t,t,s),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2],e[a+3]=t[3];return e}}();!function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL0ROW3=3]="COL0ROW3",t[t.COL1ROW0=4]="COL1ROW0",t[t.COL1ROW1=5]="COL1ROW1",t[t.COL1ROW2=6]="COL1ROW2",t[t.COL1ROW3=7]="COL1ROW3",t[t.COL2ROW0=8]="COL2ROW0",t[t.COL2ROW1=9]="COL2ROW1",t[t.COL2ROW2=10]="COL2ROW2",t[t.COL2ROW3=11]="COL2ROW3",t[t.COL3ROW0=12]="COL3ROW0",t[t.COL3ROW1=13]="COL3ROW1",t[t.COL3ROW2=14]="COL3ROW2",t[t.COL3ROW3=15]="COL3ROW3"}(ri||(ri={}));var di,fi,pi=45*Math.PI/180,gi=1,yi=.1,mi=500,vi=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),bi=class extends Fe{static get IDENTITY(){return fi||(fi=new bi,Object.freeze(fi)),fi}static get ZERO(){return di||(di=new bi([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(di)),di}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return ri}constructor(t){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(t)?this.copy(t):this.identity()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this[9]=t[9],this[10]=t[10],this[11]=t[11],this[12]=t[12],this[13]=t[13],this[14]=t[14],this[15]=t[15],this.check()}set(t,e,n,r,i,o,s,a,l,u,c,h,d,f,p,g){return this[0]=t,this[1]=e,this[2]=n,this[3]=r,this[4]=i,this[5]=o,this[6]=s,this[7]=a,this[8]=l,this[9]=u,this[10]=c,this[11]=h,this[12]=d,this[13]=f,this[14]=p,this[15]=g,this.check()}setRowMajor(t,e,n,r,i,o,s,a,l,u,c,h,d,f,p,g){return this[0]=t,this[1]=i,this[2]=l,this[3]=d,this[4]=e,this[5]=o,this[6]=u,this[7]=f,this[8]=n,this[9]=s,this[10]=c,this[11]=p,this[12]=r,this[13]=a,this[14]=h,this[15]=g,this.check()}toRowMajor(t){return t[0]=this[0],t[1]=this[4],t[2]=this[8],t[3]=this[12],t[4]=this[1],t[5]=this[5],t[6]=this[9],t[7]=this[13],t[8]=this[2],t[9]=this[6],t[10]=this[10],t[11]=this[14],t[12]=this[3],t[13]=this[7],t[14]=this[11],t[15]=this[15],t}identity(){return this.copy(vi)}fromObject(t){return this.check()}fromQuaternion(t){return nr(this,t),this.check()}frustum(t){const{left:e,right:n,bottom:r,top:i,near:o=yi,far:s=mi}=t;return s===1/0?function(t,e,n,r,i,o){const s=2*o/(n-e),a=2*o/(i-r),l=(n+e)/(n-e),u=(i+r)/(i-r),c=-2*o;t[0]=s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=l,t[9]=u,t[10]=-1,t[11]=-1,t[12]=0,t[13]=0,t[14]=c,t[15]=0}(this,e,n,r,i,o):rr(this,e,n,r,i,o,s),this.check()}lookAt(t){const{eye:e,center:n=[0,0,0],up:r=[0,1,0]}=t;return hr(this,e,n,r),this.check()}ortho(t){const{left:e,right:n,bottom:r,top:i,near:o=yi,far:s=mi}=t;return ur(this,e,n,r,i,o,s),this.check()}orthographic(t){const{fovy:e=pi,aspect:n=gi,focalDistance:r=1,near:i=yi,far:o=mi}=t;_i(e);const s=e/2,a=r*Math.tan(s),l=a*n;return this.ortho({left:-l,right:l,bottom:-a,top:a,near:i,far:o})}perspective(t){const{fovy:e=45*Math.PI/180,aspect:n=1,near:r=.1,far:i=500}=t;return _i(e),or(this,e,n,r,i),this.check()}determinant(){return Ln(this)}getScale(t=[-0,-0,-0]){return t[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),t[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),t[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),t}getTranslation(t=[-0,-0,-0]){return t[0]=this[12],t[1]=this[13],t[2]=this[14],t}getRotation(t,e){t=t||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],e=e||[-0,-0,-0];const n=this.getScale(e),r=1/n[0],i=1/n[1],o=1/n[2];return t[0]=this[0]*r,t[1]=this[1]*i,t[2]=this[2]*o,t[3]=0,t[4]=this[4]*r,t[5]=this[5]*i,t[6]=this[6]*o,t[7]=0,t[8]=this[8]*r,t[9]=this[9]*i,t[10]=this[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}getRotationMatrix3(t,e){t=t||[-0,-0,-0,-0,-0,-0,-0,-0,-0],e=e||[-0,-0,-0];const n=this.getScale(e),r=1/n[0],i=1/n[1],o=1/n[2];return t[0]=this[0]*r,t[1]=this[1]*i,t[2]=this[2]*o,t[3]=this[4]*r,t[4]=this[5]*i,t[5]=this[6]*o,t[6]=this[8]*r,t[7]=this[9]*i,t[8]=this[10]*o,t}transpose(){return In(this,this),this.check()}invert(){return Rn(this,this),this.check()}multiplyLeft(t){return kn(this,t,this),this.check()}multiplyRight(t){return kn(this,this,t),this.check()}rotateX(t){return jn(this,this,t),this.check()}rotateY(t){return Gn(this,this,t),this.check()}rotateZ(t){return Un(this,this,t),this.check()}rotateXYZ(t){return this.rotateX(t[0]).rotateY(t[1]).rotateZ(t[2])}rotateAxis(t,e){return Nn(this,this,t,e),this.check()}scale(t){return Fn(this,this,Array.isArray(t)?t:[t,t,t]),this.check()}translate(t){return Dn(this,this,t),this.check()}transform(t,e){return 4===t.length?(B(e=Zr(e||[-0,-0,-0,-0],t,this),4),e):this.transformAsPoint(t,e)}transformAsPoint(t,e){const{length:n}=t;let r;switch(n){case 2:r=mt(e||[-0,-0],t,this);break;case 3:r=fe(e||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return B(r,t.length),r}transformAsVector(t,e){let n;switch(t.length){case 2:n=Rt(e||[-0,-0],t,this);break;case 3:n=Bt(e||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return B(n,t.length),n}transformPoint(t,e){return this.transformAsPoint(t,e)}transformVector(t,e){return this.transformAsPoint(t,e)}transformDirection(t,e){return this.transformAsVector(t,e)}makeRotationX(t){return this.identity().rotateX(t)}makeTranslation(t,e,n){return this.identity().translate([t,e,n])}};function _i(t){if(t>2*Math.PI)throw Error("expected radians")}var Ai={};function xi(){const t=new N(4);return N!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function wi(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function Ci(t,e,n){n*=.5;const r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t}function Si(t,e){const n=2*Math.acos(e[3]),r=Math.sin(n/2);return r>F?(t[0]=e[0]/r,t[1]=e[1]/r,t[2]=e[2]/r):(t[0]=1,t[1]=0,t[2]=0),n}function Ei(t,e){const n=Ji(t,e);return Math.acos(2*n*n-1)}function Mi(t,e,n){const r=e[0],i=e[1],o=e[2],s=e[3],a=n[0],l=n[1],u=n[2],c=n[3];return t[0]=r*c+s*a+i*u-o*l,t[1]=i*c+s*l+o*a-r*u,t[2]=o*c+s*u+r*l-i*a,t[3]=s*c-r*a-i*l-o*u,t}function Pi(t,e,n){n*=.5;const r=e[0],i=e[1],o=e[2],s=e[3],a=Math.sin(n),l=Math.cos(n);return t[0]=r*l+s*a,t[1]=i*l+o*a,t[2]=o*l-i*a,t[3]=s*l-r*a,t}function Ti(t,e,n){n*=.5;const r=e[0],i=e[1],o=e[2],s=e[3],a=Math.sin(n),l=Math.cos(n);return t[0]=r*l-o*a,t[1]=i*l+s*a,t[2]=o*l+r*a,t[3]=s*l-i*a,t}function Oi(t,e,n){n*=.5;const r=e[0],i=e[1],o=e[2],s=e[3],a=Math.sin(n),l=Math.cos(n);return t[0]=r*l+i*a,t[1]=i*l-r*a,t[2]=o*l+s*a,t[3]=s*l-o*a,t}function Ii(t,e){const n=e[0],r=e[1],i=e[2];return t[0]=n,t[1]=r,t[2]=i,t[3]=Math.sqrt(Math.abs(1-n*n-r*r-i*i)),t}function Ri(t,e){const n=e[0],r=e[1],i=e[2],o=e[3],s=Math.sqrt(n*n+r*r+i*i),a=Math.exp(o),l=s>0?a*Math.sin(s)/s:0;return t[0]=n*l,t[1]=r*l,t[2]=i*l,t[3]=a*Math.cos(s),t}function Bi(t,e){const n=e[0],r=e[1],i=e[2],o=e[3],s=Math.sqrt(n*n+r*r+i*i),a=s>0?Math.atan2(s,o)/s:0;return t[0]=n*a,t[1]=r*a,t[2]=i*a,t[3]=.5*Math.log(n*n+r*r+i*i+o*o),t}function Li(t,e,n){return Bi(t,e),Wi(t,t,n),Ri(t,t),t}function ki(t,e,n,r){const i=e[0],o=e[1],s=e[2],a=e[3];let l,u,c,h,d,f=n[0],p=n[1],g=n[2],y=n[3];return l=i*f+o*p+s*g+a*y,l<0&&(l=-l,f=-f,p=-p,g=-g,y=-y),1-l>F?(u=Math.acos(l),d=Math.sin(u),c=Math.sin((1-r)*u)/d,h=Math.sin(r*u)/d):(c=1-r,h=r),t[0]=c*i+h*f,t[1]=c*o+h*p,t[2]=c*s+h*g,t[3]=c*a+h*y,t}function Di(t,e){const n=e[0],r=e[1],i=e[2],o=e[3],s=n*n+r*r+i*i+o*o,a=s?1/s:0;return t[0]=-n*a,t[1]=-r*a,t[2]=-i*a,t[3]=o*a,t}function Fi(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function Ni(t,e){const n=e[0]+e[4]+e[8];let r;if(n>0)r=Math.sqrt(n+1),t[3]=.5*r,r=.5/r,t[0]=(e[5]-e[7])*r,t[1]=(e[6]-e[2])*r,t[2]=(e[1]-e[3])*r;else{let n=0;e[4]>e[0]&&(n=1),e[8]>e[3*n+n]&&(n=2);const i=(n+1)%3,o=(n+2)%3;r=Math.sqrt(e[3*n+n]-e[3*i+i]-e[3*o+o]+1),t[n]=.5*r,r=.5/r,t[3]=(e[3*i+o]-e[3*o+i])*r,t[i]=(e[3*i+n]+e[3*n+i])*r,t[o]=(e[3*o+n]+e[3*n+o])*r}return t}function ji(t){return`quat(${t[0]}, ${t[1]}, ${t[2]}, ${t[3]})`}s(Ai,{add:()=>Hi,calculateW:()=>Ii,clone:()=>Gi,conjugate:()=>Fi,copy:()=>zi,create:()=>xi,dot:()=>Ji,equals:()=>eo,exactEquals:()=>to,exp:()=>Ri,fromMat3:()=>Ni,fromValues:()=>Ui,getAngle:()=>Ei,getAxisAngle:()=>Si,identity:()=>wi,invert:()=>Di,len:()=>Ki,length:()=>Xi,lerp:()=>Yi,ln:()=>Bi,mul:()=>qi,multiply:()=>Mi,normalize:()=>$i,pow:()=>Li,rotateX:()=>Pi,rotateY:()=>Ti,rotateZ:()=>Oi,rotationTo:()=>io,scale:()=>Wi,set:()=>Vi,setAxes:()=>so,setAxisAngle:()=>Ci,slerp:()=>ki,sqlerp:()=>oo,sqrLen:()=>Qi,squaredLength:()=>Zi,str:()=>ji});var Gi=Sr,Ui=Er,zi=Mr,Vi=Pr,Hi=Tr,qi=Mi,Wi=Nr,Ji=Jr,Yi=Xr,Xi=zr,Ki=Xi,Zi=Vr,Qi=Zi,$i=Wr,to=ei;function eo(t,e){return Math.abs(Jr(t,e))>=1-F}var no,ro,io=function(){const t=Ft(),e=Gt(1,0,0),n=Gt(0,1,0);return function(r,i,o){const s=se(i,o);return s<-.999999?(ae(t,e,i),Ie(t)<1e-6&&ae(t,n,i),oe(t,t),Ci(r,t,Math.PI),r):s>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(ae(t,i,o),r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=1+s,$i(r,r))}}(),oo=function(){const t=xi(),e=xi();return function(n,r,i,o,s,a){return ki(t,r,s,a),ki(e,i,o,a),ki(n,t,e,2*a*(1-a)),n}}(),so=function(){const t=je();return function(e,n,r,i){return t[0]=r[0],t[3]=r[1],t[6]=r[2],t[1]=i[0],t[4]=i[1],t[7]=i[2],t[2]=-n[0],t[5]=-n[1],t[8]=-n[2],$i(e,Ni(e,t))}}(),ao=[0,0,0,1],lo=class extends I{constructor(t=0,e=0,n=0,r=1){super(-0,-0,-0,-0),Array.isArray(t)&&1===arguments.length?this.copy(t):this.set(t,e,n,r)}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this.check()}set(t,e,n,r){return this[0]=t,this[1]=e,this[2]=n,this[3]=r,this.check()}fromObject(t){return this[0]=t.x,this[1]=t.y,this[2]=t.z,this[3]=t.w,this.check()}fromMatrix3(t){return Ni(this,t),this.check()}fromAxisRotation(t,e){return Ci(this,t,e),this.check()}identity(){return wi(this),this.check()}setAxisAngle(t,e){return this.fromAxisRotation(t,e)}get ELEMENTS(){return 4}get x(){return this[0]}set x(t){this[0]=R(t)}get y(){return this[1]}set y(t){this[1]=R(t)}get z(){return this[2]}set z(t){this[2]=R(t)}get w(){return this[3]}set w(t){this[3]=R(t)}len(){return Xi(this)}lengthSquared(){return Zi(this)}dot(t){return Ji(this,t)}rotationTo(t,e){return io(this,t,e),this.check()}add(t){return Hi(this,this,t),this.check()}calculateW(){return Ii(this,this),this.check()}conjugate(){return Fi(this,this),this.check()}invert(){return Di(this,this),this.check()}lerp(t,e,n){return void 0===n?this.lerp(this,t,e):(Yi(this,t,e,n),this.check())}multiplyRight(t){return Mi(this,this,t),this.check()}multiplyLeft(t){return Mi(this,t,this),this.check()}normalize(){const t=this.len(),e=t>0?1/t:0;return this[0]=this[0]*e,this[1]=this[1]*e,this[2]=this[2]*e,this[3]=this[3]*e,0===t&&(this[3]=1),this.check()}rotateX(t){return Pi(this,this,t),this.check()}rotateY(t){return Ti(this,this,t),this.check()}rotateZ(t){return Oi(this,this,t),this.check()}scale(t){return Wi(this,this,t),this.check()}slerp(t,e,n){let r,i,o;switch(arguments.length){case 1:({start:r=ao,target:i,ratio:o}=t);break;case 2:r=this,i=t,o=e;break;default:r=t,i=e,o=n}return ki(this,r,i,o),this.check()}transformVector4(t,e=new De){return Qr(e,t,this),B(e,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(t,e){return this.setAxisAngle(t,e)}premultiply(t){return this.multiplyLeft(t)}multiply(t){return this.multiplyRight(t)}},uo=1e-6,co=class{constructor({phi:t=0,theta:e=0,radius:n=1,bearing:r,pitch:i,altitude:o,radiusScale:s=6371e3}={}){this.phi=t,this.theta=e,this.radius=n||o||1,this.radiusScale=s||1,void 0!==r&&(this.bearing=r),void 0!==i&&(this.pitch=i),this.check()}toString(){return this.formatString(c)}formatString({printTypes:t=!1}){const e=d;return`${t?"Spherical":""}[rho:${e(this.radius)},theta:${e(this.theta)},phi:${e(this.phi)}]`}equals(t){return M(this.radius,t.radius)&&M(this.theta,t.theta)&&M(this.phi,t.phi)}exactEquals(t){return this.radius===t.radius&&this.theta===t.theta&&this.phi===t.phi}get bearing(){return 180-v(this.phi)}set bearing(t){this.phi=Math.PI-m(t)}get pitch(){return v(this.theta)}set pitch(t){this.theta=m(t)}get longitude(){return v(this.phi)}get latitude(){return v(this.theta)}get lng(){return v(this.phi)}get lat(){return v(this.theta)}get z(){return(this.radius-1)*this.radiusScale}set(t,e,n){return this.radius=t,this.phi=e,this.theta=n,this.check()}clone(){return(new co).copy(this)}copy(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this.check()}fromLngLatZ([t,e,n]){return this.radius=1+n/this.radiusScale,this.phi=m(e),this.theta=m(t),this.check()}fromVector3(t){return this.radius=jt(t),this.radius>0&&(this.theta=Math.atan2(t[0],t[1]),this.phi=Math.acos(S(t[2]/this.radius,-1,1))),this.check()}toVector3(){return new ke(0,0,this.radius).rotateX({radians:this.theta}).rotateZ({radians:this.phi})}makeSafe(){return this.phi=Math.max(uo,Math.min(Math.PI-uo,this.phi)),this}check(){if(!(Number.isFinite(this.phi)&&Number.isFinite(this.theta)&&this.radius>0))throw new Error("SphericalCoordinates: some fields set to invalid numbers");return this}},ho="Unknown Euler angle order",fo=.99999;(ro=no||(no={}))[ro.ZYX=0]="ZYX",ro[ro.YXZ=1]="YXZ",ro[ro.XZY=2]="XZY",ro[ro.ZXY=3]="ZXY",ro[ro.YZX=4]="YZX",ro[ro.XYZ=5]="XYZ";var po=class extends I{static get ZYX(){return no.ZYX}static get YXZ(){return no.YXZ}static get XZY(){return no.XZY}static get ZXY(){return no.ZXY}static get YZX(){return no.YZX}static get XYZ(){return no.XYZ}static get RollPitchYaw(){return no.ZYX}static get DefaultOrder(){return no.ZYX}static get RotationOrders(){return no}static rotationOrder(t){return no[t]}get ELEMENTS(){return 4}constructor(t=0,e=0,n=0,r=po.DefaultOrder){super(-0,-0,-0,-0),arguments.length>0&&Array.isArray(arguments[0])?this.fromVector3(...arguments):this.set(t,e,n,r)}fromQuaternion(t){const[e,n,r,i]=t,o=n*n,s=-2*(o+r*r)+1,a=2*(e*n+i*r);let l=-2*(e*r-i*n);const u=2*(n*r+i*e),c=-2*(e*e+o)+1;l=l>1?1:l,l=l<-1?-1:l;const h=Math.atan2(u,c),d=Math.asin(l),f=Math.atan2(a,s);return this.set(h,d,f,po.RollPitchYaw)}fromObject(t){throw new Error("not implemented")}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=Number.isFinite(t[3])||this.order,this.check()}set(t=0,e=0,n=0,r){return this[0]=t,this[1]=e,this[2]=n,this[3]=Number.isFinite(r)?r:this[3],this.check()}validate(){return(t=this[3])>=0&&t<6&&Number.isFinite(this[0])&&Number.isFinite(this[1])&&Number.isFinite(this[2]);var t}toArray(t=[],e=0){return t[e]=this[0],t[e+1]=this[1],t[e+2]=this[2],t}toArray4(t=[],e=0){return t[e]=this[0],t[e+1]=this[1],t[e+2]=this[2],t[e+3]=this[3],t}toVector3(t=[-0,-0,-0]){return t[0]=this[0],t[1]=this[1],t[2]=this[2],t}get x(){return this[0]}set x(t){this[0]=R(t)}get y(){return this[1]}set y(t){this[1]=R(t)}get z(){return this[2]}set z(t){this[2]=R(t)}get alpha(){return this[0]}set alpha(t){this[0]=R(t)}get beta(){return this[1]}set beta(t){this[1]=R(t)}get gamma(){return this[2]}set gamma(t){this[2]=R(t)}get phi(){return this[0]}set phi(t){this[0]=R(t)}get theta(){return this[1]}set theta(t){this[1]=R(t)}get psi(){return this[2]}set psi(t){this[2]=R(t)}get roll(){return this[0]}set roll(t){this[0]=R(t)}get pitch(){return this[1]}set pitch(t){this[1]=R(t)}get yaw(){return this[2]}set yaw(t){this[2]=R(t)}get order(){return this[3]}set order(t){this[3]=function(t){if(t<0&&t>=6)throw new Error(ho);return t}(t)}fromVector3(t,e){return this.set(t[0],t[1],t[2],Number.isFinite(e)?e:this[3])}fromArray(t,e=0){return this[0]=t[0+e],this[1]=t[1+e],this[2]=t[2+e],void 0!==t[3]&&(this[3]=t[3]),this.check()}fromRollPitchYaw(t,e,n){return this.set(t,e,n,no.ZYX)}fromRotationMatrix(t,e=po.DefaultOrder){return this._fromRotationMatrix(t,e),this.check()}getRotationMatrix(t){return this._getRotationMatrix(t)}getQuaternion(){const t=new lo;switch(this[3]){case no.XYZ:return t.rotateX(this[0]).rotateY(this[1]).rotateZ(this[2]);case no.YXZ:return t.rotateY(this[0]).rotateX(this[1]).rotateZ(this[2]);case no.ZXY:return t.rotateZ(this[0]).rotateX(this[1]).rotateY(this[2]);case no.ZYX:return t.rotateZ(this[0]).rotateY(this[1]).rotateX(this[2]);case no.YZX:return t.rotateY(this[0]).rotateZ(this[1]).rotateX(this[2]);case no.XZY:return t.rotateX(this[0]).rotateZ(this[1]).rotateY(this[2]);default:throw new Error(ho)}}_fromRotationMatrix(t,e=po.DefaultOrder){const n=t[0],r=t[4],i=t[8],o=t[1],s=t[5],a=t[9],l=t[2],u=t[6],c=t[10];switch(e=e||this[3]){case po.XYZ:this[1]=Math.asin(S(i,-1,1)),Math.abs(i)<fo?(this[0]=Math.atan2(-a,c),this[2]=Math.atan2(-r,n)):(this[0]=Math.atan2(u,s),this[2]=0);break;case po.YXZ:this[0]=Math.asin(-S(a,-1,1)),Math.abs(a)<fo?(this[1]=Math.atan2(i,c),this[2]=Math.atan2(o,s)):(this[1]=Math.atan2(-l,n),this[2]=0);break;case po.ZXY:this[0]=Math.asin(S(u,-1,1)),Math.abs(u)<fo?(this[1]=Math.atan2(-l,c),this[2]=Math.atan2(-r,s)):(this[1]=0,this[2]=Math.atan2(o,n));break;case po.ZYX:this[1]=Math.asin(-S(l,-1,1)),Math.abs(l)<fo?(this[0]=Math.atan2(u,c),this[2]=Math.atan2(o,n)):(this[0]=0,this[2]=Math.atan2(-r,s));break;case po.YZX:this[2]=Math.asin(S(o,-1,1)),Math.abs(o)<fo?(this[0]=Math.atan2(-a,s),this[1]=Math.atan2(-l,n)):(this[0]=0,this[1]=Math.atan2(i,c));break;case po.XZY:this[2]=Math.asin(-S(r,-1,1)),Math.abs(r)<fo?(this[0]=Math.atan2(u,s),this[1]=Math.atan2(i,n)):(this[0]=Math.atan2(-a,c),this[1]=0);break;default:throw new Error(ho)}return this[3]=e,this}_getRotationMatrix(t){const e=t||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],n=this.x,r=this.y,i=this.z,o=Math.cos(n),s=Math.cos(r),a=Math.cos(i),l=Math.sin(n),u=Math.sin(r),c=Math.sin(i);switch(this[3]){case po.XYZ:{const t=o*a,n=o*c,r=l*a,i=l*c;e[0]=s*a,e[4]=-s*c,e[8]=u,e[1]=n+r*u,e[5]=t-i*u,e[9]=-l*s,e[2]=i-t*u,e[6]=r+n*u,e[10]=o*s;break}case po.YXZ:{const t=s*a,n=s*c,r=u*a,i=u*c;e[0]=t+i*l,e[4]=r*l-n,e[8]=o*u,e[1]=o*c,e[5]=o*a,e[9]=-l,e[2]=n*l-r,e[6]=i+t*l,e[10]=o*s;break}case po.ZXY:{const t=s*a,n=s*c,r=u*a,i=u*c;e[0]=t-i*l,e[4]=-o*c,e[8]=r+n*l,e[1]=n+r*l,e[5]=o*a,e[9]=i-t*l,e[2]=-o*u,e[6]=l,e[10]=o*s;break}case po.ZYX:{const t=o*a,n=o*c,r=l*a,i=l*c;e[0]=s*a,e[4]=r*u-n,e[8]=t*u+i,e[1]=s*c,e[5]=i*u+t,e[9]=n*u-r,e[2]=-u,e[6]=l*s,e[10]=o*s;break}case po.YZX:{const t=o*s,n=o*u,r=l*s,i=l*u;e[0]=s*a,e[4]=i-t*c,e[8]=r*c+n,e[1]=c,e[5]=o*a,e[9]=-l*a,e[2]=-u*a,e[6]=n*c+r,e[10]=t-i*c;break}case po.XZY:{const t=o*s,n=o*u,r=l*s,i=l*u;e[0]=s*a,e[4]=-c,e[8]=u*a,e[1]=t*c+i,e[5]=o*a,e[9]=n*c-r,e[2]=r*c-n,e[6]=l*a,e[10]=i*c+t;break}default:throw new Error(ho)}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}toQuaternion(){const t=Math.cos(.5*this.yaw),e=Math.sin(.5*this.yaw),n=Math.cos(.5*this.roll),r=Math.sin(.5*this.roll),i=Math.cos(.5*this.pitch),o=Math.sin(.5*this.pitch);return new lo(t*r*i-e*n*o,t*n*o+e*r*i,e*n*i-t*r*o,t*n*i+e*r*o)}},go=class{constructor({x:t=0,y:e=0,z:n=0,roll:r=0,pitch:i=0,yaw:o=0,position:s,orientation:a}={}){Array.isArray(s)&&3===s.length?this.position=new ke(s):this.position=new ke(t,e,n),Array.isArray(a)&&4===a.length?this.orientation=new po(a,a[3]):this.orientation=new po(r,i,o,po.RollPitchYaw)}get x(){return this.position.x}set x(t){this.position.x=t}get y(){return this.position.y}set y(t){this.position.y=t}get z(){return this.position.z}set z(t){this.position.z=t}get roll(){return this.orientation.roll}set roll(t){this.orientation.roll=t}get pitch(){return this.orientation.pitch}set pitch(t){this.orientation.pitch=t}get yaw(){return this.orientation.yaw}set yaw(t){this.orientation.yaw=t}getPosition(){return this.position}getOrientation(){return this.orientation}equals(t){return!!t&&this.position.equals(t.position)&&this.orientation.equals(t.orientation)}exactEquals(t){return!!t&&this.position.exactEquals(t.position)&&this.orientation.exactEquals(t.orientation)}getTransformationMatrix(){const t=Math.sin(this.roll),e=Math.sin(this.pitch),n=Math.sin(this.yaw),r=Math.cos(this.roll),i=Math.cos(this.pitch),o=Math.cos(this.yaw);return(new bi).setRowMajor(o*i,-n*r+o*e*t,n*t+o*e*r,this.x,n*i,o*r+n*e*t,-o*t+n*e*r,this.y,-e,i*t,i*r,this.z,0,0,0,1)}getTransformationMatrixFromPose(t){return(new bi).multiplyRight(this.getTransformationMatrix()).multiplyRight(t.getTransformationMatrix().invert())}getTransformationMatrixToPose(t){return(new bi).multiplyRight(t.getTransformationMatrix()).multiplyRight(this.getTransformationMatrix().invert())}},yo={};s(yo,{EPSILON1:()=>mo,EPSILON10:()=>Eo,EPSILON11:()=>Mo,EPSILON12:()=>Po,EPSILON13:()=>To,EPSILON14:()=>Oo,EPSILON15:()=>Io,EPSILON16:()=>Ro,EPSILON17:()=>Bo,EPSILON18:()=>Lo,EPSILON19:()=>ko,EPSILON2:()=>vo,EPSILON20:()=>Do,EPSILON3:()=>bo,EPSILON4:()=>_o,EPSILON5:()=>Ao,EPSILON6:()=>xo,EPSILON7:()=>wo,EPSILON8:()=>Co,EPSILON9:()=>So,PI_OVER_FOUR:()=>No,PI_OVER_SIX:()=>jo,PI_OVER_TWO:()=>Fo,TWO_PI:()=>Go});var mo=.1,vo=.01,bo=.001,_o=1e-4,Ao=1e-5,xo=1e-6,wo=1e-7,Co=1e-8,So=1e-9,Eo=1e-10,Mo=1e-11,Po=1e-12,To=1e-13,Oo=1e-14,Io=1e-15,Ro=1e-16,Bo=1e-17,Lo=1e-18,ko=1e-19,Do=1e-20,Fo=Math.PI/2,No=Math.PI/4,jo=Math.PI/6,Go=2*Math.PI},44313:(t,e,n)=>{var r,i=Object.defineProperty,o=Object.getOwnPropertyDescriptor,s=Object.getOwnPropertyNames,a=Object.prototype.hasOwnProperty,l={};((t,e)=>{for(var n in e)i(t,n,{get:e[n],enumerable:!0})})(l,{Polygon:()=>v,WINDING:()=>h,_Polygon:()=>v,clipPolygon:()=>Y,clipPolyline:()=>J,cutPolygonByGrid:()=>tt,cutPolygonByMercatorBounds:()=>lt,cutPolylineByGrid:()=>Z,cutPolylineByMercatorBounds:()=>at,earcut:()=>b,forEachSegmentInPolygon:()=>y,getPolygonSignedArea:()=>g,getPolygonWindingDirection:()=>f,modifyPolygonWindingDirection:()=>d}),t.exports=(r=l,((t,e,n,r)=>{if(e&&"object"==typeof e||"function"==typeof e)for(let n of s(e))a.call(t,n)||undefined===n||i(t,n,{get:()=>e[n],enumerable:!(r=o(e,n))||r.enumerable});return t})(i({},"__esModule",{value:!0}),r));var u=n(47502),c=n(47502),h={CLOCKWISE:1,COUNTER_CLOCKWISE:-1};function d(t,e,n={}){return f(t,n)!==e&&(function(t,e){const{start:n=0,end:r=t.length,size:i=2}=e,o=(r-n)/i,s=Math.floor(o/2);for(let e=0;e<s;++e){const r=n+e*i,s=n+(o-1-e)*i;for(let e=0;e<i;++e){const n=t[r+e];t[r+e]=t[s+e],t[s+e]=n}}}(t,n),!0)}function f(t,e={}){return Math.sign(g(t,e))}var p={x:0,y:1,z:2};function g(t,e={}){const{start:n=0,end:r=t.length,plane:i="xy"}=e,o=e.size||2;let s=0;const a=p[i[0]],l=p[i[1]];for(let e=n,i=r-o;e<r;e+=o)s+=(t[e+a]-t[i+a])*(t[e+l]+t[i+l]),i=e;return s/2}function y(t,e,n={}){const{start:r=0,end:i=t.length,size:o=2,isClosed:s}=n,a=(i-r)/o;for(let n=0;n<a-1;++n)e(t[r+n*o],t[r+n*o+1],t[r+(n+1)*o],t[r+(n+1)*o+1],n,n+1);const l=r+(a-1)*o;s||(0,c.equals)(t[r],t[l])&&(0,c.equals)(t[r+1],t[l+1])||e(t[l],t[l+1],t[r],t[r+1],a-1,0)}function m(t,e={}){const{start:n=0,end:r=t.length,plane:i="xy"}=e;let o=0;const s=p[i[0]],a=p[i[1]];for(let e=n,i=r-1;e<r;++e)o+=(t[e][s]-t[i][s])*(t[e][a]+t[i][a]),i=e;return o/2}var v=class{constructor(t,e={}){this.points=t,this.isFlatArray=!(0,u.isArray)(t[0]),this.options={start:e.start||0,end:e.end||t.length,size:e.size||2,isClosed:e.isClosed},Object.freeze(this)}getSignedArea(){return this.isFlatArray?g(this.points,this.options):m(this.points,this.options)}getArea(){return Math.abs(this.getSignedArea())}getWindingDirection(){return Math.sign(this.getSignedArea())}forEachSegment(t){this.isFlatArray?y(this.points,((e,n,r,i,o,s)=>{t([e,n],[r,i],o,s)}),this.options):function(t,e,n={}){const{start:r=0,end:i=t.length,isClosed:o}=n;for(let n=r;n<i-1;++n)e(t[n],t[n+1],n,n+1);o||(0,c.equals)(t[i-1],t[0])||e(t[i-1],t[0],i-1,0)}(this.points,t,this.options)}modifyWindingDirection(t){return this.isFlatArray?d(this.points,t,this.options):function(t,e,n={}){return function(t,e={}){return Math.sign(m(t,e))}(t,n)!==e&&(t.reverse(),!0)}(this.points,t,this.options)}};function b(t,e,n=2,r,i="xy"){const o=e&&e.length,s=o?e[0]*n:t.length;let a=_(t,0,s,n,!0,r&&r[0],i);const l=[];if(!a||a.next===a.prev)return l;let u,c,h,d,f,p,g;if(o&&(a=function(t,e,n,r,i,o){const s=[];let a,l,u,c,h;for(a=0,l=e.length;a<l;a++)u=e[a]*r,c=a<l-1?e[a+1]*r:t.length,h=_(t,u,c,r,!1,i&&i[a+1],o),h===h.next&&(h.steiner=!0),s.push(I(h));for(s.sort(M),a=0;a<s.length;a++)n=P(s[a],n);return n}(t,e,a,n,r,i)),t.length>80*n){d=c=t[0],f=h=t[1];for(let e=n;e<s;e+=n)p=t[e],g=t[e+1],p<d&&(d=p),g<f&&(f=g),p>c&&(c=p),g>h&&(h=g);u=Math.max(c-d,h-f),u=0!==u?32767/u:0}return x(a,l,n,d,f,u,0),l}function _(t,e,n,r,i,o,s){let a,l;void 0===o&&(o=g(t,{start:e,end:n,size:r,plane:s}));let u=p[s[0]],c=p[s[1]];if(i===o<0)for(a=e;a<n;a+=r)l=U(a,t[a+u],t[a+c],l);else for(a=n-r;a>=e;a-=r)l=U(a,t[a+u],t[a+c],l);return l&&k(l,l.next)&&(z(l),l=l.next),l}function A(t,e){if(!t)return t;e||(e=t);let n,r=t;do{if(n=!1,r.steiner||!k(r,r.next)&&0!==L(r.prev,r,r.next))r=r.next;else{if(z(r),r=e=r.prev,r===r.next)break;n=!0}}while(n||r!==e);return e}function x(t,e,n,r,i,o,s){if(!t)return;!s&&o&&function(t,e,n,r){let i=t;do{0===i.z&&(i.z=O(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,function(t){let e,n,r,i,o,s,a,l,u=1;do{for(i=t,t=null,l=null,r=0;i;){for(r++,s=i,o=0,n=0;n<u&&(o++,s=s.nextZ,s);n++);for(a=u;o>0||a>0&&s;)0!==o&&(0===a||!s||i.z<=s.z)?(e=i,i=i.nextZ,o--):(e=s,s=s.nextZ,a--),l?l.nextZ=e:t=e,e.prevZ=l,l=e;i=s}l.nextZ=null,u*=2}while(r>1)}(i)}(t,r,i,o);let a,l,u=t;for(;t.prev!==t.next;)if(a=t.prev,l=t.next,o?C(t,r,i,o):w(t))e.push(a.i/n|0),e.push(t.i/n|0),e.push(l.i/n|0),z(t),t=l.next,u=l.next;else if((t=l)===u){s?1===s?x(t=S(A(t),e,n),e,n,r,i,o,2):2===s&&E(t,e,n,r,i,o):x(A(t),e,n,r,i,o,1);break}}function w(t){const e=t.prev,n=t,r=t.next;if(L(e,n,r)>=0)return!1;const i=e.x,o=n.x,s=r.x,a=e.y,l=n.y,u=r.y,c=i<o?i<s?i:s:o<s?o:s,h=a<l?a<u?a:u:l<u?l:u,d=i>o?i>s?i:s:o>s?o:s,f=a>l?a>u?a:u:l>u?l:u;let p=r.next;for(;p!==e;){if(p.x>=c&&p.x<=d&&p.y>=h&&p.y<=f&&R(i,a,o,l,s,u,p.x,p.y)&&L(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function C(t,e,n,r){const i=t.prev,o=t,s=t.next;if(L(i,o,s)>=0)return!1;const a=i.x,l=o.x,u=s.x,c=i.y,h=o.y,d=s.y,f=a<l?a<u?a:u:l<u?l:u,p=c<h?c<d?c:d:h<d?h:d,g=a>l?a>u?a:u:l>u?l:u,y=c>h?c>d?c:d:h>d?h:d,m=O(f,p,e,n,r),v=O(g,y,e,n,r);let b=t.prevZ,_=t.nextZ;for(;b&&b.z>=m&&_&&_.z<=v;){if(b.x>=f&&b.x<=g&&b.y>=p&&b.y<=y&&b!==i&&b!==s&&R(a,c,l,h,u,d,b.x,b.y)&&L(b.prev,b,b.next)>=0)return!1;if(b=b.prevZ,_.x>=f&&_.x<=g&&_.y>=p&&_.y<=y&&_!==i&&_!==s&&R(a,c,l,h,u,d,_.x,_.y)&&L(_.prev,_,_.next)>=0)return!1;_=_.nextZ}for(;b&&b.z>=m;){if(b.x>=f&&b.x<=g&&b.y>=p&&b.y<=y&&b!==i&&b!==s&&R(a,c,l,h,u,d,b.x,b.y)&&L(b.prev,b,b.next)>=0)return!1;b=b.prevZ}for(;_&&_.z<=v;){if(_.x>=f&&_.x<=g&&_.y>=p&&_.y<=y&&_!==i&&_!==s&&R(a,c,l,h,u,d,_.x,_.y)&&L(_.prev,_,_.next)>=0)return!1;_=_.nextZ}return!0}function S(t,e,n){let r=t;do{const i=r.prev,o=r.next.next;!k(i,o)&&D(i,r,r.next,o)&&j(i,o)&&j(o,i)&&(e.push(i.i/n|0),e.push(r.i/n|0),e.push(o.i/n|0),z(r),z(r.next),r=t=o),r=r.next}while(r!==t);return A(r)}function E(t,e,n,r,i,o){let s=t;do{let t=s.next.next;for(;t!==s.prev;){if(s.i!==t.i&&B(s,t)){let a=G(s,t);return s=A(s,s.next),a=A(a,a.next),x(s,e,n,r,i,o,0),void x(a,e,n,r,i,o,0)}t=t.next}s=s.next}while(s!==t)}function M(t,e){return t.x-e.x}function P(t,e){const n=function(t,e){let n=e;const r=t.x,i=t.y;let o,s=-1/0;do{if(i<=n.y&&i>=n.next.y&&n.next.y!==n.y){const t=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(t<=r&&t>s&&(s=t,o=n.x<n.next.x?n:n.next,t===r))return o}n=n.next}while(n!==e);if(!o)return null;const a=o,l=o.x,u=o.y;let c,h=1/0;n=o;do{r>=n.x&&n.x>=l&&r!==n.x&&R(i<u?r:s,i,l,u,i<u?s:r,i,n.x,n.y)&&(c=Math.abs(i-n.y)/(r-n.x),j(n,t)&&(c<h||c===h&&(n.x>o.x||n.x===o.x&&T(o,n)))&&(o=n,h=c)),n=n.next}while(n!==a);return o}(t,e);if(!n)return e;const r=G(n,t);return A(r,r.next),A(n,n.next)}function T(t,e){return L(t.prev,t,e.prev)<0&&L(e.next,t,t.next)<0}function O(t,e,n,r,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*i|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-r)*i|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function I(t){let e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function R(t,e,n,r,i,o,s,a){return(i-s)*(e-a)>=(t-s)*(o-a)&&(t-s)*(r-a)>=(n-s)*(e-a)&&(n-s)*(o-a)>=(i-s)*(r-a)}function B(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){let n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&D(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(j(t,e)&&j(e,t)&&function(t,e){let n=t,r=!1;const i=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)&&(L(t.prev,t,e.prev)||L(t,e.prev,e))||k(t,e)&&L(t.prev,t,t.next)>0&&L(e.prev,e,e.next)>0)}function L(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function k(t,e){return t.x===e.x&&t.y===e.y}function D(t,e,n,r){const i=N(L(t,e,n)),o=N(L(t,e,r)),s=N(L(n,r,t)),a=N(L(n,r,e));return i!==o&&s!==a||!(0!==i||!F(t,n,e))||!(0!==o||!F(t,r,e))||!(0!==s||!F(n,t,r))||!(0!==a||!F(n,e,r))}function F(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function N(t){return t>0?1:t<0?-1:0}function j(t,e){return L(t.prev,t,t.next)<0?L(t,e,t.next)>=0&&L(t,t.prev,e)>=0:L(t,e,t.prev)<0||L(t,t.next,e)<0}function G(t,e){const n=new V(t.i,t.x,t.y),r=new V(e.i,e.x,e.y),i=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function U(t,e,n,r){const i=new V(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function z(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}var V=class{constructor(t,e,n){this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1,this.i=t,this.x=e,this.y=n}};function H(t,e){const n=e.length,r=t.length;if(r>0){let i=!0;for(let o=0;o<n;o++)if(t[r-n+o]!==e[o]){i=!1;break}if(i)return!1}for(let i=0;i<n;i++)t[r+i]=e[i];return!0}function q(t,e){const n=e.length;for(let r=0;r<n;r++)t[r]=e[r]}function W(t,e,n,r,i=[]){const o=r+e*n;for(let e=0;e<n;e++)i[e]=t[o+e];return i}function J(t,e,n){const{size:r=2,startIndex:i=0,endIndex:o=t.length}=n||{},s=(o-i)/r,a=[];let l,u,c,h,d=[],f=-1;for(let n=1;n<s;n++){for(l=W(t,n-1,r,i,l),u=W(t,n,r,i,u),f<0&&(f=K(l,e)),c=h=K(u,e);;){if(!(f|c)){H(d,l),c!==h?(H(d,u),n<s-1&&(a.push(d),d=[])):n===s-1&&H(d,u);break}if(f&c)break;f?(X(l,u,f,e,l),f=K(l,e)):(X(l,u,c,e,u),c=K(u,e))}f=h}return d.length&&a.push(d),a}function Y(t,e,n){const{size:r=2,endIndex:i=t.length}=n||{};let o,s,a,l,u,{startIndex:c=0}=n||{},h=(i-c)/r;for(let n=1;n<=8;n*=2){o=[],a=W(t,h-1,r,c,a),u=!(K(a,e)&n);for(let i=0;i<h;i++)s=W(t,i,r,c,s),l=!(K(s,e)&n),l!==u&&H(o,X(a,s,n,e)),l&&H(o,s),q(a,s),u=l;if(t=o,c=0,h=o.length/r,!h)break}return o}function X(t,e,n,r,i=[]){let o,s;if(8&n)o=(r[3]-t[1])/(e[1]-t[1]),s=3;else if(4&n)o=(r[1]-t[1])/(e[1]-t[1]),s=1;else if(2&n)o=(r[2]-t[0])/(e[0]-t[0]),s=2;else{if(!(1&n))return null;o=(r[0]-t[0])/(e[0]-t[0]),s=0}for(let n=0;n<t.length;n++)i[n]=(1&s)===n?r[s]:o*(e[n]-t[n])+t[n];return i}function K(t,e){let n=0;return t[0]<e[0]?n|=1:t[0]>e[2]&&(n|=2),t[1]<e[1]?n|=4:t[1]>e[3]&&(n|=8),n}function Z(t,e){const{size:n=2,broken:r=!1,gridResolution:i=10,gridOffset:o=[0,0],startIndex:s=0,endIndex:a=t.length}=e||{},l=(a-s)/n;let u=[];const c=[u],h=W(t,0,n,s);let d,f;const p=nt(h,i,o,[]),g=[];H(u,h);for(let e=1;e<l;e++){for(d=W(t,e,n,s,d),f=K(d,p);f;){X(h,d,f,p,g);const t=K(g,p);t&&(X(h,g,t,p,g),f=t),H(u,g),q(h,g),rt(p,i,f),r&&u.length>n&&(u=[],c.push(u),H(u,h)),f=K(d,p)}H(u,d),q(h,d)}return r?c:c[0]}var Q=0,$=1;function tt(t,e=null,n){if(!t.length)return[];const{size:r=2,gridResolution:i=10,gridOffset:o=[0,0],edgeTypes:s=!1}=n||{},a=[],l=[{pos:t,types:s?new Array(t.length/r).fill($):null,holes:e||[]}],u=[[],[]];let c=[];for(;l.length;){const{pos:t,types:e,holes:n}=l.shift();it(t,r,n[0]||t.length,u),c=nt(u[0],i,o,c);const h=K(u[1],c);if(h){let i=et(t,e,r,0,n[0]||t.length,c,h);const o={pos:i[0].pos,types:i[0].types,holes:[]},a={pos:i[1].pos,types:i[1].types,holes:[]};l.push(o,a);for(let l=0;l<n.length;l++)i=et(t,e,r,n[l],n[l+1]||t.length,c,h),i[0]&&(o.holes.push(o.pos.length),o.pos=ot(o.pos,i[0].pos),s&&(o.types=ot(o.types,i[0].types))),i[1]&&(a.holes.push(a.pos.length),a.pos=ot(a.pos,i[1].pos),s&&(a.types=ot(a.types,i[1].types)))}else{const r={positions:t};s&&(r.edgeTypes=e),n.length&&(r.holeIndices=n),a.push(r)}}return a}function et(t,e,n,r,i,o,s){const a=(i-r)/n,l=[],u=[],c=[],h=[],d=[];let f,p,g;const y=W(t,a-1,n,r);let m=Math.sign(8&s?y[1]-o[3]:y[0]-o[2]),v=e&&e[a-1],b=0,_=0;for(let i=0;i<a;i++)f=W(t,i,n,r,f),p=Math.sign(8&s?f[1]-o[3]:f[0]-o[2]),g=e&&e[r/n+i],p&&m&&m!==p&&(X(y,f,s,o,d),H(l,d)&&c.push(v),H(u,d)&&h.push(v)),p<=0?(H(l,f)&&c.push(g),b-=p):c.length&&(c[c.length-1]=Q),p>=0?(H(u,f)&&h.push(g),_+=p):h.length&&(h[h.length-1]=Q),q(y,f),m=p,v=g;return[b?{pos:l,types:e&&c}:null,_?{pos:u,types:e&&h}:null]}function nt(t,e,n,r){const i=Math.floor((t[0]-n[0])/e)*e+n[0],o=Math.floor((t[1]-n[1])/e)*e+n[1];return r[0]=i,r[1]=o,r[2]=i+e,r[3]=o+e,r}function rt(t,e,n){8&n?(t[1]+=e,t[3]+=e):4&n?(t[1]-=e,t[3]-=e):2&n?(t[0]+=e,t[2]+=e):1&n&&(t[0]-=e,t[2]-=e)}function it(t,e,n,r){let i=1/0,o=-1/0,s=1/0,a=-1/0;for(let r=0;r<n;r+=e){const e=t[r],n=t[r+1];i=e<i?e:i,o=e>o?e:o,s=n<s?n:s,a=n>a?n:a}return r[0][0]=i,r[0][1]=s,r[1][0]=o,r[1][1]=a,r}function ot(t,e){for(let n=0;n<e.length;n++)t.push(e[n]);return t}var st=85.051129;function at(t,e){const{size:n=2,startIndex:r=0,endIndex:i=t.length,normalize:o=!0}=e||{},s=t.slice(r,i);ht(s,n,0,i-r);const a=Z(s,{size:n,broken:!0,gridResolution:360,gridOffset:[-180,-180]});if(o)for(const t of a)dt(t,n);return a}function lt(t,e=null,n){const{size:r=2,normalize:i=!0,edgeTypes:o=!1}=n||{};e=e||[];const s=[],a=[];let l=0,u=0;for(let i=0;i<=e.length;i++){const o=e[i]||t.length,c=u,h=ut(t,r,l,o);for(let e=h;e<o;e++)s[u++]=t[e];for(let e=l;e<h;e++)s[u++]=t[e];ht(s,r,c,u),ct(s,r,c,u,null==n?void 0:n.maxLatitude),l=o,a[i]=u}a.pop();const c=tt(s,a,{size:r,gridResolution:360,gridOffset:[-180,-180],edgeTypes:o});if(i)for(const t of c)dt(t.positions,r);return c}function ut(t,e,n,r){let i=-1,o=-1;for(let s=n+1;s<r;s+=e){const e=Math.abs(t[s]);e>i&&(i=e,o=s-1)}return o}function ct(t,e,n,r,i=st){const o=t[n],s=t[r-e];if(Math.abs(o-s)>180){const r=W(t,0,e,n);r[0]+=360*Math.round((s-o)/360),H(t,r),r[1]=Math.sign(r[1])*i,H(t,r),r[0]=o,H(t,r)}}function ht(t,e,n,r){let i,o=t[0];for(let s=n;s<r;s+=e){i=t[s];const e=i-o;(e>180||e<-180)&&(i-=360*Math.round(e/360)),t[s]=o=i}}function dt(t,e){let n;const r=t.length/e;for(let i=0;i<r&&(n=t[i*e],(n+180)%360==0);i++);const i=360*-Math.round(n/360);if(0!==i)for(let n=0;n<r;n++)t[n*e]+=i}},33561:(t,e,n)=>{"use strict";var r,i=Object.defineProperty,o=Object.getOwnPropertyDescriptor,s=Object.getOwnPropertyNames,a=Object.prototype.hasOwnProperty,l={};((t,e)=>{for(var n in e)i(t,n,{get:e[n],enumerable:!0})})(l,{ArrowLikeDataType:()=>tt,ArrowLikeField:()=>O,ArrowLikeSchema:()=>I,ArrowLikeTable:()=>G,AsyncQueue:()=>Ut,Binary:()=>yt,Bool:()=>nt,ColumnarTableBatchAggregator:()=>p,Date:()=>bt,DateDay:()=>_t,DateMillisecond:()=>At,FixedSizeList:()=>kt,Float:()=>dt,Float16:()=>ft,Float32:()=>pt,Float64:()=>gt,Int:()=>rt,Int16:()=>ot,Int32:()=>st,Int64:()=>at,Int8:()=>it,Interval:()=>Rt,IntervalDayTime:()=>Bt,IntervalYearMonth:()=>Lt,Null:()=>et,RowTableBatchAggregator:()=>f,Struct:()=>Dt,TableBatchBuilder:()=>m,Time:()=>wt,TimeMillisecond:()=>St,TimeSecond:()=>Ct,Timestamp:()=>Et,TimestampMicrosecond:()=>Tt,TimestampMillisecond:()=>Pt,TimestampNanosecond:()=>Ot,TimestampSecond:()=>Mt,Uint16:()=>ut,Uint32:()=>ct,Uint64:()=>ht,Uint8:()=>lt,Utf8:()=>mt,convertTable:()=>Y,convertToArrayRow:()=>h,convertToObjectRow:()=>c,deduceMeshField:()=>Q,deduceMeshSchema:()=>Z,deduceTableSchema:()=>D,getDataTypeFromArray:()=>L,getMeshBoundingBox:()=>K,getMeshSize:()=>X,getTableCell:()=>A,getTableColumnIndex:()=>w,getTableColumnName:()=>C,getTableLength:()=>b,getTableNumCols:()=>_,getTableRowAsArray:()=>E,getTableRowAsObject:()=>S,getTableRowShape:()=>x,getTypeInfo:()=>Ft,isTable:()=>v,makeArrayRowIterator:()=>P,makeBatchFromTable:()=>q,makeMeshAttributeMetadata:()=>$,makeObjectRowIterator:()=>T,makeRowIterator:()=>M,makeTableFromBatches:()=>W,makeTableFromData:()=>U}),t.exports=(r=l,((t,e,n,r)=>{if(e&&"object"==typeof e||"function"==typeof e)for(let n of s(e))a.call(t,n)||undefined===n||i(t,n,{get:()=>e[n],enumerable:!(r=o(e,n))||r.enumerable});return t})(i({},"__esModule",{value:!0}),r));var u=class{schema;options;shape;length=0;rows=null;cursor=0;_headers=[];constructor(t,e){if(this.options=e,this.schema=t,!Array.isArray(t)){this._headers=[];for(const e in t)this._headers[t[e].index]=t[e].name}}rowCount(){return this.length}addArrayRow(t,e){Number.isFinite(e)&&(this.cursor=e),this.shape="array-row-table",this.rows=this.rows||new Array(100),this.rows[this.length]=t,this.length++}addObjectRow(t,e){Number.isFinite(e)&&(this.cursor=e),this.shape="object-row-table",this.rows=this.rows||new Array(100),this.rows[this.length]=t,this.length++}getBatch(){let t=this.rows;return t?(t=t.slice(0,this.length),this.rows=null,{shape:this.shape||"array-row-table",batchType:"data",data:t,length:this.length,schema:this.schema,cursor:this.cursor}):null}};function c(t,e){if(!t)throw new Error("null row");const n={};if(e)for(let r=0;r<e.length;r++)n[e[r]]=t[r];else for(let e=0;e<t.length;e++)n[`column-${e}`]=t[e];return n}function h(t,e){if(!t)throw new Error("null row");if(e){const n=new Array(e.length);for(let r=0;r<e.length;r++)n[r]=t[e[r]];return n}return Object.values(t)}var d,f=class{schema;options;length=0;objectRows=null;arrayRows=null;cursor=0;_headers=null;constructor(t,e){if(this.options=e,this.schema=t,t){this._headers=[];for(const e in t)this._headers[t[e].index]=t[e].name}}rowCount(){return this.length}addArrayRow(t,e){switch(Number.isFinite(e)&&(this.cursor=e),this._headers||=function(t){const e=[];for(let n=0;n<t.length;n++){const t=`column-${n}`;e.push(t)}return e}(t),this.options.shape){case"object-row-table":const n=c(t,this._headers);this.addObjectRow(n,e);break;case"array-row-table":this.arrayRows=this.arrayRows||new Array(100),this.arrayRows[this.length]=t,this.length++}}addObjectRow(t,e){switch(Number.isFinite(e)&&(this.cursor=e),this._headers||=function(t){return Object.keys(t)}(t),this.options.shape){case"array-row-table":const n=h(t,this._headers);this.addArrayRow(n,e);break;case"object-row-table":this.objectRows=this.objectRows||new Array(100),this.objectRows[this.length]=t,this.length++}}getBatch(){let t=this.arrayRows||this.objectRows;return t?(t=t.slice(0,this.length),this.arrayRows=null,this.objectRows=null,{shape:this.options.shape,batchType:"data",data:t,length:this.length,schema:this.schema,cursor:this.cursor}):null}},p=class{schema;length=0;allocated=0;columns={};constructor(t,e){this.schema=t,this._reallocateColumns()}rowCount(){return this.length}addArrayRow(t){this._reallocateColumns();let e=0;for(const n in this.columns)this.columns[n][this.length]=t[e++];this.length++}addObjectRow(t){this._reallocateColumns();for(const e in t)this.columns[e][this.length]=t[e];this.length++}getBatch(){this._pruneColumns();const t=Array.isArray(this.schema)?this.columns:{};if(!Array.isArray(this.schema))for(const e in this.schema){const n=this.schema[e];t[n.name]=this.columns[n.index]}return this.columns={},{shape:"columnar-table",batchType:"data",data:t,schema:this.schema,length:this.length}}_reallocateColumns(){if(!(this.length<this.allocated)){this.allocated=this.allocated>0?this.allocated*=2:100,this.columns={};for(const t in this.schema){const e=this.schema[t],n=e.type||Float32Array,r=this.columns[e.index];if(r&&ArrayBuffer.isView(r)){const t=new n(this.allocated);t.set(r),this.columns[e.index]=t}else r?(r.length=this.allocated,this.columns[e.index]=r):this.columns[e.index]=new n(this.allocated)}}}_pruneColumns(){for(const[t,e]of Object.entries(this.columns))this.columns[t]=e.slice(0,this.length)}},g={shape:void 0,batchSize:"auto",batchDebounceMs:0,limit:0,_limitMB:0},y=class{schema;options;aggregator=null;batchCount=0;bytesUsed=0;isChunkComplete=!1;lastBatchEmittedMs=Date.now();totalLength=0;totalBytes=0;rowBytes=0;constructor(t,e){this.schema=t,this.options={...g,...e}}limitReached(){var t,e;return!!(Boolean(null==(t=this.options)?void 0:t.limit)&&this.totalLength>=this.options.limit)||!!(Boolean(null==(e=this.options)?void 0:e._limitMB)&&this.totalBytes/1e6>=this.options._limitMB)}addRow(t){this.limitReached()||(this.totalLength++,this.rowBytes=this.rowBytes||this._estimateRowMB(t),this.totalBytes+=this.rowBytes,Array.isArray(t)?this.addArrayRow(t):this.addObjectRow(t))}addArrayRow(t){if(!this.aggregator){const t=this._getTableBatchType();this.aggregator=new t(this.schema,this.options)}this.aggregator.addArrayRow(t)}addObjectRow(t){if(!this.aggregator){const t=this._getTableBatchType();this.aggregator=new t(this.schema,this.options)}this.aggregator.addObjectRow(t)}chunkComplete(t){t instanceof ArrayBuffer&&(this.bytesUsed+=t.byteLength),"string"==typeof t&&(this.bytesUsed+=t.length),this.isChunkComplete=!0}getFullBatch(t){return this._isFull()?this._getBatch(t):null}getFinalBatch(t){return this._getBatch(t)}_estimateRowMB(t){return Array.isArray(t)?8*t.length:8*Object.keys(t).length}_isFull(){if(!this.aggregator||0===this.aggregator.rowCount())return!1;if("auto"===this.options.batchSize){if(!this.isChunkComplete)return!1}else if(this.options.batchSize>this.aggregator.rowCount())return!1;return!(this.options.batchDebounceMs>Date.now()-this.lastBatchEmittedMs||(this.isChunkComplete=!1,this.lastBatchEmittedMs=Date.now(),0))}_getBatch(t){if(!this.aggregator)return null;(null==t?void 0:t.bytesUsed)&&(this.bytesUsed=t.bytesUsed);const e=this.aggregator.getBatch();return e.count=this.batchCount,e.bytesUsed=this.bytesUsed,Object.assign(e,t),this.batchCount++,this.aggregator=null,e}_getTableBatchType(){switch(this.options.shape){case"array-row-table":case"object-row-table":return f;case"columnar-table":return p;case"arrow-table":if(!y.ArrowBatch)throw new Error("TableBatchBuilder");return y.ArrowBatch;default:return u}}},m=y;function v(t){var e;switch("object"==typeof t&&(null==t?void 0:t.shape)){case"array-row-table":case"object-row-table":return Array.isArray(t.data);case"geojson-table":return Array.isArray(t.features);case"columnar-table":return t.data&&"object"==typeof t.data;case"arrow-table":return Boolean(void 0!==(null==(e=null==t?void 0:t.data)?void 0:e.numRows));default:return!1}}function b(t){switch(t.shape){case"array-row-table":case"object-row-table":return t.data.length;case"geojson-table":return t.features.length;case"arrow-table":return t.data.numRows;case"columnar-table":for(const e of Object.values(t.data))return e.length||0;return 0;default:throw new Error("table")}}function _(t){if(t.schema)return t.schema.fields.length;if(0===b(t))throw new Error("empty table");switch(t.shape){case"array-row-table":return t.data[0].length;case"object-row-table":return Object.keys(t.data[0]).length;case"geojson-table":return Object.keys(t.features[0]).length;case"columnar-table":return Object.keys(t.data).length;case"arrow-table":return t.data.numCols;default:throw new Error("table")}}function A(t,e,n){var r;switch(t.shape){case"array-row-table":const i=w(t,n);return t.data[e][i];case"object-row-table":return t.data[e][n];case"geojson-table":return t.features[e][n];case"columnar-table":return t.data[n][e];case"arrow-table":const o=t.data,s=o.schema.fields.findIndex((t=>t.name===n));return null==(r=o.getChildAt(s))?void 0:r.get(e);default:throw new Error("todo")}}function x(t){switch(t.shape){case"array-row-table":case"object-row-table":return t.shape;case"geojson-table":return"object-row-table";default:throw new Error("Not a row table")}}function w(t,e){var n;const r=null==(n=t.schema)?void 0:n.fields.findIndex((t=>t.name===e));if(void 0===r)throw new Error(e);return r}function C(t,e){var n,r;const i=null==(r=null==(n=t.schema)?void 0:n.fields[e])?void 0:r.name;if(!i)throw new Error(`${e}`);return i}function S(t,e,n,r){switch(t.shape){case"object-row-table":return r?Object.fromEntries(Object.entries(t.data[e])):t.data[e];case"array-row-table":if(t.schema){const r=n||{};for(let n=0;n<t.schema.fields.length;n++)r[t.schema.fields[n].name]=t.data[e][n];return r}throw new Error("no schema");case"geojson-table":if(t.schema){const r=n||{};for(let n=0;n<t.schema.fields.length;n++)r[t.schema.fields[n].name]=t.features[e][n];return r}throw new Error("no schema");case"columnar-table":if(t.schema){const r=n||{};for(let n=0;n<t.schema.fields.length;n++)r[t.schema.fields[n].name]=t.data[t.schema.fields[n].name][e];return r}{const r=n||{};for(const[n,i]of Object.entries(t.data))r[n]=i[e];return r}case"arrow-table":const i=t.data,o=n||{},s=i.get(e),a=i.schema;for(let t=0;t<a.fields.length;t++)o[a.fields[t].name]=null==s?void 0:s[a.fields[t].name];return o;default:throw new Error("shape")}}function E(t,e,n,r){switch(t.shape){case"array-row-table":return r?Array.from(t.data[e]):t.data[e];case"object-row-table":if(t.schema){const r=n||[];for(let n=0;n<t.schema.fields.length;n++)r[n]=t.data[e][t.schema.fields[n].name];return r}return Object.values(t.data[e]);case"geojson-table":if(t.schema){const r=n||[];for(let n=0;n<t.schema.fields.length;n++)r[n]=t.features[e][t.schema.fields[n].name];return r}return Object.values(t.features[e]);case"columnar-table":if(t.schema){const r=n||[];for(let n=0;n<t.schema.fields.length;n++)r[n]=t.data[t.schema.fields[n].name][e];return r}{const r=n||[];let i=0;for(const n of Object.values(t.data))r[i]=n[e],i++;return r}case"arrow-table":const i=t.data,o=n||[],s=i.get(e),a=i.schema;for(let t=0;t<a.fields.length;t++)o[t]=null==s?void 0:s[a.fields[t].name];return o;default:throw new Error("shape")}}function*M(t,e){switch(e){case"array-row-table":yield*P(t);break;case"object-row-table":yield*T(t);break;default:throw new Error(`Unknown row type ${e}`)}}function*P(t,e=[]){const n=b(t);for(let r=0;r<n;r++)yield E(t,r,e)}function*T(t,e={}){const n=b(t);for(let r=0;r<n;r++)yield S(t,r,e)}((t,e,n)=>{e in t?i(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n})(m,"symbol"!=typeof(d="ArrowBatch")?d+"":d,undefined);var O=class{name;type;nullable;metadata;constructor(t,e,n=!1,r=new Map){this.name=t,this.type=e,this.nullable=n,this.metadata=r}get typeId(){return this.type&&this.type.typeId}clone(){return new O(this.name,this.type,this.nullable,this.metadata)}compareTo(t){return this.name===t.name&&this.type===t.type&&this.nullable===t.nullable&&this.metadata===t.metadata}toString(){return`${JSON.stringify(this.type)}${this.nullable?", nullable":""}${this.metadata?`, metadata: ${JSON.stringify(this.metadata)}`:""}`}},I=class{fields;metadata;constructor(t,e=new Map){this.fields=t.map((t=>new O(t.name,t.type,t.nullable,t.metadata))),this.metadata=e instanceof Map?e:new Map(Object.entries(e))}compareTo(t){if(this.metadata!==t.metadata)return!1;if(this.fields.length!==t.fields.length)return!1;for(let e=0;e<this.fields.length;++e)if(!this.fields[e].compareTo(t.fields[e]))return!1;return!0}select(...t){const e=Object.create(null);for(const n of t)e[n]=!0;const n=this.fields.filter((t=>e[t.name]));return new I(n,this.metadata)}selectAt(...t){const e=t.map((t=>this.fields[t])).filter(Boolean);return new I(e,this.metadata)}assign(t){let e,n=this.metadata;if(t instanceof I){const r=t;e=r.fields,n=R(R(new Map,this.metadata),r.metadata)}else e=t;const r=Object.create(null);for(const t of this.fields)r[t.name]=t;for(const t of e)r[t.name]=t;const i=Object.values(r);return new I(i,n)}};function R(t,e){return new Map([...t||new Map,...e||new Map])}function B(t,e="float32"){return t instanceof Date?"date-millisecond":t instanceof Number?e:"string"==typeof t?"utf8":"null"}function L(t){let e=k(t);return"null"!==e?{type:e,nullable:!1}:t.length>0?(e=B(t[0]),{type:e,nullable:!0}):{type:"null",nullable:!0}}function k(t){switch(t.constructor){case Int8Array:return"int8";case Uint8Array:case Uint8ClampedArray:return"uint8";case Int16Array:return"int16";case Uint16Array:return"uint16";case Int32Array:return"int32";case Uint32Array:return"uint32";case Float32Array:return"float32";case Float64Array:return"float64";default:return"null"}}function D(t){switch(t.shape){case"array-row-table":case"object-row-table":return function(t){if(!t.length)throw new Error("deduce from empty table");const e=[],n=t[0];for(const[t,r]of Object.entries(n))e.push(N(r,t));return{fields:e,metadata:{}}}(t.data);case"columnar-table":return function(t){const e=[];for(const[n,r]of Object.entries(t)){const t=F(r,n);e.push(t)}return{fields:e,metadata:{}}}(t.data);default:throw new Error("Deduce schema")}}function F(t,e){if(ArrayBuffer.isView(t)){const n=L(t);return{name:e,type:n.type||"null",nullable:n.nullable}}if(Array.isArray(t)&&t.length>0)return{name:e,type:B(t[0]),nullable:!0};throw new Error("empty table")}function N(t,e){return{name:e,type:B(t),nullable:!0}}var j=class{table;columnName;constructor(t,e){this.table=t,this.columnName=e}get(t){return A(this.table,t,this.columnName)}toArray(){var t;switch(this.table.shape){case"arrow-table":return null==(t=this.table.data.getChild(this.columnName))?void 0:t.toArray();case"columnar-table":return this.table.data[this.columnName];default:throw new Error(this.table.shape)}}},G=class{schema;table;constructor(t){const e=t.schema||D(t);this.schema=new I(e.fields,e.metadata),this.table={...t,schema:e}}get data(){return"geojson-table"===this.table.shape?this.table.features:this.table.data}get numCols(){return _(this.table)}get length(){return b(this.table)}getChild(t){return new j(this.table,t)}};function U(t){let e;switch(function(t){if(Array.isArray(t)){if(0===t.length)throw new Error("cannot deduce type of empty table");const e=t[0];if(Array.isArray(e))return"array-row-table";if(e&&"object"==typeof e)return"object-row-table"}if(t&&"object"==typeof t)return"columnar-table";throw new Error("invalid table")}(t)){case"array-row-table":e={shape:"array-row-table",data:t};break;case"object-row-table":e={shape:"object-row-table",data:t};break;case"columnar-table":e={shape:"columnar-table",data:t};break;default:throw new Error("table")}const n=D(e);return{...e,schema:n}}var z,V,H=n(33561);function q(t){return{...t,length:(0,H.getTableLength)(t),batchType:"data"}}async function W(t){let e,n,r,i,o=null;for await(const s of t)switch(o=o||s.shape,i=i||s.schema,s.shape){case"array-row-table":e=e||[];for(let t=0;t<(0,H.getTableLength)(s);t++){const n=s.data[t];e.push(n)}break;case"object-row-table":n=n||[];for(let t=0;t<(0,H.getTableLength)(s);t++){const e=s.data[t];n.push(e)}break;case"geojson-table":r=r||[];for(let t=0;t<(0,H.getTableLength)(s);t++){const e=s.features[t];r.push(e)}break;default:throw new Error("shape")}if(!o)return null;switch(o){case"array-row-table":return{shape:"array-row-table",data:e,schema:i};case"object-row-table":return{shape:"object-row-table",data:n,schema:i};case"geojson-table":return{shape:"geojson-table",type:"FeatureCollection",features:r,schema:i};default:return null}}function J(t,e){return new(function(t,e){if(!e)switch(t){case"int8":return Int8Array;case"uint8":return Uint8Array;case"int16":return Int16Array;case"uint16":return Uint16Array;case"int32":return Int32Array;case"uint32":return Uint32Array;case"float32":return Float32Array;case"float64":return Float64Array}return Array}(t.type,t.nullable))(e)}function Y(t,e){switch(e){case"object-row-table":return function(t){if("object-row-table"===t.shape)return t;const e=b(t),n=new Array(e);for(let r=0;r<e;r++)n[r]=S(t,r);return{shape:"object-row-table",schema:t.schema,data:n}}(t);case"array-row-table":return function(t){if("array-row-table"===t.shape)return t;const e=b(t),n=new Array(e);for(let r=0;r<e;r++)n[r]=E(t,r);return{shape:"array-row-table",schema:t.schema,data:n}}(t);case"columnar-table":return function(t){var e;const n=t.schema||D(t),r=(null==(e=t.schema)?void 0:e.fields)||[];if("columnar-table"===t.shape)return{...t,schema:n};const i=b(t),o={};for(const e of r){const n=J(e,i);o[e.name]=n;for(let r=0;r<i;r++)n[r]=A(t,r,e.name)}return{shape:"columnar-table",schema:n,data:o}}(t);case"arrow-table":return function(t){var e;const n=null==(e=globalThis.__loaders)?void 0:e._makeArrowTable;if(!n)throw new Error("");return n(t)}(t);default:throw new Error(e)}}function X(t){let e=0;for(const n in t){const r=t[n];ArrayBuffer.isView(r)&&(e+=r.byteLength*r.BYTES_PER_ELEMENT)}return e}function K(t){let e=1/0,n=1/0,r=1/0,i=-1/0,o=-1/0,s=-1/0;const a=t.POSITION?t.POSITION.value:[],l=a&&a.length;for(let t=0;t<l;t+=3){const l=a[t],u=a[t+1],c=a[t+2];e=l<e?l:e,n=u<n?u:n,r=c<r?c:r,i=l>i?l:i,o=u>o?u:o,s=c>s?c:s}return[[e,n,r],[i,o,s]]}function Z(t,e={}){const n=function(t){const e=[];for(const n in t){const r=t[n];e.push(Q(n,r))}return e}(t);return{fields:n,metadata:e}}function Q(t,e,n){const r=k(e.value),i=n||$(e);return{name:t,type:{type:"fixed-size-list",listSize:e.size,children:[{name:"value",type:r}]},nullable:!1,metadata:i}}function $(t){const e={};return"byteOffset"in t&&(e.byteOffset=t.byteOffset.toString(10)),"byteStride"in t&&(e.byteStride=t.byteStride.toString(10)),"normalized"in t&&(e.normalized=t.normalized.toString()),e}(V=z||(z={}))[V.NONE=0]="NONE",V[V.Null=1]="Null",V[V.Int=2]="Int",V[V.Float=3]="Float",V[V.Binary=4]="Binary",V[V.Utf8=5]="Utf8",V[V.Bool=6]="Bool",V[V.Decimal=7]="Decimal",V[V.Date=8]="Date",V[V.Time=9]="Time",V[V.Timestamp=10]="Timestamp",V[V.Interval=11]="Interval",V[V.List=12]="List",V[V.Struct=13]="Struct",V[V.Union=14]="Union",V[V.FixedSizeBinary=15]="FixedSizeBinary",V[V.FixedSizeList=16]="FixedSizeList",V[V.Map=17]="Map",V[V.Dictionary=-1]="Dictionary",V[V.Int8=-2]="Int8",V[V.Int16=-3]="Int16",V[V.Int32=-4]="Int32",V[V.Int64=-5]="Int64",V[V.Uint8=-6]="Uint8",V[V.Uint16=-7]="Uint16",V[V.Uint32=-8]="Uint32",V[V.Uint64=-9]="Uint64",V[V.Float16=-10]="Float16",V[V.Float32=-11]="Float32",V[V.Float64=-12]="Float64",V[V.DateDay=-13]="DateDay",V[V.DateMillisecond=-14]="DateMillisecond",V[V.TimestampSecond=-15]="TimestampSecond",V[V.TimestampMillisecond=-16]="TimestampMillisecond",V[V.TimestampMicrosecond=-17]="TimestampMicrosecond",V[V.TimestampNanosecond=-18]="TimestampNanosecond",V[V.TimeSecond=-19]="TimeSecond",V[V.TimeMillisecond=-20]="TimeMillisecond",V[V.TimeMicrosecond=-21]="TimeMicrosecond",V[V.TimeNanosecond=-22]="TimeNanosecond",V[V.DenseUnion=-23]="DenseUnion",V[V.SparseUnion=-24]="SparseUnion",V[V.IntervalDayTime=-25]="IntervalDayTime",V[V.IntervalYearMonth=-26]="IntervalYearMonth";var tt=class{static isNull(t){return t&&t.typeId===z.Null}static isInt(t){return t&&t.typeId===z.Int}static isFloat(t){return t&&t.typeId===z.Float}static isBinary(t){return t&&t.typeId===z.Binary}static isUtf8(t){return t&&t.typeId===z.Utf8}static isBool(t){return t&&t.typeId===z.Bool}static isDecimal(t){return t&&t.typeId===z.Decimal}static isDate(t){return t&&t.typeId===z.Date}static isTime(t){return t&&t.typeId===z.Time}static isTimestamp(t){return t&&t.typeId===z.Timestamp}static isInterval(t){return t&&t.typeId===z.Interval}static isList(t){return t&&t.typeId===z.List}static isStruct(t){return t&&t.typeId===z.Struct}static isUnion(t){return t&&t.typeId===z.Union}static isFixedSizeBinary(t){return t&&t.typeId===z.FixedSizeBinary}static isFixedSizeList(t){return t&&t.typeId===z.FixedSizeList}static isMap(t){return t&&t.typeId===z.Map}static isDictionary(t){return t&&t.typeId===z.Dictionary}get typeId(){return z.NONE}compareTo(t){return this===t}},et=class extends tt{get typeId(){return z.Null}get[Symbol.toStringTag](){return"Null"}toString(){return"Null"}},nt=class extends tt{get typeId(){return z.Bool}get[Symbol.toStringTag](){return"Bool"}toString(){return"Bool"}},rt=class extends tt{isSigned;bitWidth;constructor(t,e){super(),this.isSigned=t,this.bitWidth=e}get typeId(){return z.Int}get[Symbol.toStringTag](){return"Int"}toString(){return`${this.isSigned?"I":"Ui"}nt${this.bitWidth}`}},it=class extends rt{constructor(){super(!0,8)}},ot=class extends rt{constructor(){super(!0,16)}},st=class extends rt{constructor(){super(!0,32)}},at=class extends rt{constructor(){super(!0,64)}},lt=class extends rt{constructor(){super(!1,8)}},ut=class extends rt{constructor(){super(!1,16)}},ct=class extends rt{constructor(){super(!1,32)}},ht=class extends rt{constructor(){super(!1,64)}},dt=class extends tt{precision;constructor(t){super(),this.precision=t}get typeId(){return z.Float}get[Symbol.toStringTag](){return"Float"}toString(){return`Float${this.precision}`}},ft=class extends dt{constructor(){super(16)}},pt=class extends dt{constructor(){super(32)}},gt=class extends dt{constructor(){super(64)}},yt=class extends tt{constructor(){super()}get typeId(){return z.Binary}toString(){return"Binary"}get[Symbol.toStringTag](){return"Binary"}},mt=class extends tt{get typeId(){return z.Utf8}get[Symbol.toStringTag](){return"Utf8"}toString(){return"Utf8"}},vt={DAY:0,MILLISECOND:1},bt=class extends tt{unit;constructor(t){super(),this.unit=t}get typeId(){return z.Date}get[Symbol.toStringTag](){return"Date"}toString(){return`Date${32*(this.unit+1)}<${vt[this.unit]}>`}},_t=class extends bt{constructor(){super(vt.DAY)}},At=class extends bt{constructor(){super(vt.MILLISECOND)}},xt={SECOND:1,MILLISECOND:1e3,MICROSECOND:1e6,NANOSECOND:1e9},wt=class extends tt{unit;bitWidth;constructor(t,e){super(),this.unit=t,this.bitWidth=e}get typeId(){return z.Time}toString(){return`Time${this.bitWidth}<${xt[this.unit]}>`}get[Symbol.toStringTag](){return"Time"}},Ct=class extends wt{constructor(){super(xt.SECOND,32)}},St=class extends wt{constructor(){super(xt.MILLISECOND,32)}},Et=class extends tt{unit;timezone;constructor(t,e=null){super(),this.unit=t,this.timezone=e}get typeId(){return z.Timestamp}get[Symbol.toStringTag](){return"Timestamp"}toString(){return`Timestamp<${xt[this.unit]}${this.timezone?`, ${this.timezone}`:""}>`}},Mt=class extends Et{constructor(t=null){super(xt.SECOND,t)}},Pt=class extends Et{constructor(t=null){super(xt.MILLISECOND,t)}},Tt=class extends Et{constructor(t=null){super(xt.MICROSECOND,t)}},Ot=class extends Et{constructor(t=null){super(xt.NANOSECOND,t)}},It={DAY_TIME:0,YEAR_MONTH:1},Rt=class extends tt{unit;constructor(t){super(),this.unit=t}get typeId(){return z.Interval}get[Symbol.toStringTag](){return"Interval"}toString(){return`Interval<${It[this.unit]}>`}},Bt=class extends Rt{constructor(){super(It.DAY_TIME)}},Lt=class extends Rt{constructor(){super(It.YEAR_MONTH)}},kt=class extends tt{listSize;children;constructor(t,e){super(),this.listSize=t,this.children=[e]}get typeId(){return z.FixedSizeList}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get[Symbol.toStringTag](){return"FixedSizeList"}toString(){return`FixedSizeList[${this.listSize}]<${JSON.stringify(this.valueType)}>`}},Dt=class extends tt{children;constructor(t){super(),this.children=t}get typeId(){return z.Struct}toString(){return`Struct<{${this.children.map((t=>`${t.name}:${JSON.stringify(t.type)}`)).join(", ")}}>`}get[Symbol.toStringTag](){return"Struct"}};function Ft(t){return{typeId:t.typeId,ArrayType:t.ArrayType,typeName:t.toString(),typeEnumName:jt(t.typeId),precision:t.precision}}var Nt=null;function jt(t){if(!Nt){Nt={};for(const t in z)Nt[z[t]]=t}return Nt[t]}var Gt=class extends Array{enqueue(t){return this.push(t)}dequeue(){return this.shift()}},Ut=class{_values;_settlers;_closed;constructor(){this._values=new Gt,this._settlers=new Gt,this._closed=!1}close(){for(;this._settlers.length>0;)this._settlers.dequeue().resolve({done:!0});this._closed=!0}[Symbol.asyncIterator](){return this}enqueue(t){if(this._closed)throw new Error("Closed");if(this._settlers.length>0){if(this._values.length>0)throw new Error("Illegal internal state");const e=this._settlers.dequeue();t instanceof Error?e.reject(t):e.resolve({value:t})}else this._values.enqueue(t)}next(){if(this._values.length>0){const t=this._values.dequeue();return t instanceof Error?Promise.reject(t):Promise.resolve({value:t})}if(this._closed){if(this._settlers.length>0)throw new Error("Illegal internal state");return Promise.resolve({done:!0})}return new Promise(((t,e)=>{this._settlers.enqueue({resolve:t,reject:e})}))}}},36520:(t,e,n)=>{"use strict";var r,i=Object.defineProperty,o=Object.getOwnPropertyDescriptor,s=Object.getOwnPropertyNames,a=Object.prototype.hasOwnProperty,l={};((t,e)=>{for(var n in e)i(t,n,{get:e[n],enumerable:!0})})(l,{HexWKBLoader:()=>wt,TWKBLoader:()=>Bt,TWKBWriter:()=>jt,WKBLoader:()=>Q,WKBWorkerLoader:()=>Z,WKBWriter:()=>mt,WKTCRSLoader:()=>d,WKTCRSWriter:()=>p,WKTLoader:()=>E,WKTWorkerLoader:()=>S,WKTWriter:()=>R,decodeHex:()=>xt,encodeHex:()=>At,isTWKB:()=>Et,isWKB:()=>U,isWKT:()=>v,parseWKBHeader:()=>z}),t.exports=(r=l,((t,e,n,r)=>{if(e&&"object"==typeof e||"function"==typeof e)for(let n of s(e))a.call(t,n)||undefined===n||i(t,n,{get:()=>e[n],enumerable:!(r=o(e,n))||r.enumerable});return t})(i({},"__esModule",{value:!0}),r));var u="4.2.1";function c(t,e){let n;(null==e?void 0:e.debug)&&console.log("[wktcrs] parse starting with\n",t),t=(t=t.replace(/[A-Z][A-Z\d_]+\[/gi,(t=>`["${t.substr(0,t.length-1)}",`))).replace(/, ?([A-Z][A-Z\d_]+[,\]])/gi,((t,n)=>{const r=n.substr(0,n.length-1);return`,"${(null==e?void 0:e.raw)?"raw:":""}${r}"${n[n.length-1]}`})),(null==e?void 0:e.raw)&&(t=t.replace(/, {0,2}(-?[\.\d]+)(?=,|\])/g,(function(t,n){return`,"${(null==e?void 0:e.raw)?"raw:":""}${n}"`}))),(null==e?void 0:e.debug)&&console.log(`[wktcrs] json'd wkt: '${t}'`);try{n=JSON.parse(t)}catch(e){throw console.error(`[wktcrs] failed to parse '${t}'`),e}(null==e?void 0:e.debug)&&console.log(`[wktcrs] json parsed: '${t}'`);const r=function t(e,n){const r=e[0];e.forEach((function(n){Array.isArray(n)&&t(n,e)}));const i=`MULTIPLE_${r}`;return i in n?n[i].push(e):r in n?(n[i]=[n[r],e],delete n[r]):n[r]=e,n}(n,[n]);return(null==e?void 0:e.debug)&&console.log("[wktcrs] parse returning",r),(null==e?void 0:e.sort)&&h(r,e),r}function h(t,e){const n=Object.keys(t).filter((t=>!/\d+/.test(t))),r=(null==e?void 0:e.keywords)||[];if(!(null==e?void 0:e.keywords)){const e={};if(Array.isArray(t)){t.forEach((t=>{if(Array.isArray(t)&&t.length>=2&&"string"==typeof t[1]){const n=t[0];e[n]||(e[n]=0),e[n]++}}));for(const t in e)e[t]>0&&r.push(t)}}return n.forEach((e=>{t[e]=h(t[e])})),r.forEach((e=>{const n=[],r=[];t.forEach(((t,i)=>{Array.isArray(t)&&t[0]===e&&(n.push(i),r.push(t))})),r.sort(((t,e)=>(t=t[1].toString())<(e=e[1].toString())?-1:t>e?1:0)),r.forEach(((e,r)=>{t[n[r]]=e}))})),t}var d={dataType:null,batchType:null,name:"WKT CRS (Well-Known Text Coordinate Reference System)",id:"wkt-crs",module:"wkt-crs",version:u,worker:!0,extensions:[],mimeTypes:["text/plain"],category:"json",text:!0,options:{"wkt-crs":{}},parse:async(t,e)=>c((new TextDecoder).decode(t),null==e?void 0:e["wkt-crs"]),parseTextSync:(t,e)=>c(t,null==e?void 0:e["wkt-crs"])};function f(t,e){Array.isArray(t)&&1===t.length&&Array.isArray(t[0])&&(t=t[0]);const[n,...r]=t;return`${n}[${r.map((t=>{if(Array.isArray(t))return f(t,e);if("number"==typeof t)return t.toString();if("string"==typeof t)return t.startsWith("raw:")?t.replace("raw:",""):`"${t}"`;throw new Error(`[wktcrs] unexpected attribute "${t}"`)})).join(",")}]`}var p={name:"WKT CRS (Well-Known Text Coordinate Reference System)",id:"wkt-crs",module:"wkt-crs",version:u,worker:!0,extensions:[],mimeTypes:["text/plain"],text:!0,options:{"wkt-crs":{}},encode:async(t,e)=>(new TextEncoder).encode(f(t,null==e?void 0:e["wkt-crs"])),encodeSync:(t,e)=>(new TextEncoder).encode(f(t,null==e?void 0:e["wkt-crs"])),encodeTextSync:(t,e)=>f(t,null==e?void 0:e["wkt-crs"])},g=/[-+]?([0-9]*\.[0-9]+|[0-9]+)([eE][-+]?[0-9]+)?/,y=new RegExp("^"+g.source+"(\\s"+g.source+"){1,}"),m=["POINT(","LINESTRING(","POLYGON(","MULTIPOINT(","MULTILINESTRING(","MULTIPOLYGON(","GEOMETRYCOLLECTION("];function v(t){return m.some((e=>t.startsWith(e)))}function b(t,e){return function(t,e){var n;const r=t.split(";");let i=r.pop();const o=(r.shift()||"").split("=").pop(),s=_({parts:r,_:i,i:0});return(null==(n=null==e?void 0:e.wkt)?void 0:n.crs)?function(t,e){if(t&&(null==e?void 0:e.match(/\d+/))){const n={type:"name",properties:{name:"urn:ogc:def:crs:EPSG::"+e}};t.crs=n}return t}(s,o):s}(t,e)}function _(t){return function(t){if(!w(/^(POINT(\sz)?)/i,t))return null;if(C(t),!w(/^(\()/,t))return null;const e=x(t);return e?(C(t),w(/^(\))/,t)?{type:"Point",coordinates:e[0]}:null):null}(t)||function(t){if(!w(/^(LINESTRING(\sz)?)/i,t))return null;if(C(t),!w(/^(\()/,t))return null;const e=x(t);return e&&w(/^(\))/,t)?{type:"LineString",coordinates:e}:null}(t)||function(t){if(!w(/^(POLYGON(\sz)?)/i,t))return null;C(t);const e=A(t);return e?{type:"Polygon",coordinates:e}:null}(t)||function(t){var e,n;if(!w(/^(MULTIPOINT)/i,t))return null;C(t);const r=null==(n=t._)?void 0:n.substring((null==(e=t._)?void 0:e.indexOf("("))+1,t._.length-1).replace(/\(/g,"").replace(/\)/g,"");t._="MULTIPOINT ("+r+")";const i=A(t);return i?(C(t),{type:"MultiPoint",coordinates:i}):null}(t)||function(t){if(!w(/^(MULTILINESTRING)/i,t))return null;C(t);const e=A(t);return e?(C(t),{type:"MultiLineString",coordinates:e}):null}(t)||function(t){if(!w(/^(MULTIPOLYGON)/i,t))return null;C(t);const e=A(t);return e?{type:"MultiPolygon",coordinates:e}:null}(t)||function(t){const e=[];let n;if(!w(/^(GEOMETRYCOLLECTION)/i,t))return null;if(C(t),!w(/^(\()/,t))return null;for(;n=_(t);)e.push(n),C(t),w(/^(,)/,t),C(t);return w(/^(\))/,t)?{type:"GeometryCollection",geometries:e}:null}(t)}function A(t){C(t);let e=0;const n=[],r=[n];let i,o=n;for(;i=w(/^(\()/,t)||w(/^(\))/,t)||w(/^(,)/,t)||w(y,t);){if("("===i)r.push(o),o=[],r[r.length-1].push(o),e++;else if(")"===i){if(0===o.length)return null;if(o=r.pop(),!o)return null;if(e--,0===e)break}else if(","===i)o=[],r[r.length-1].push(o);else{if(i.split(/\s/g).some(isNaN))return null;Array.prototype.push.apply(o,i.split(/\s/g).map(parseFloat))}C(t)}return 0!==e?null:n}function x(t){const e=[];let n,r;for(;r=w(y,t)||w(/^(,)/,t);)","===r?(e.push(n),n=[]):r.split(/\s/g).some(isNaN)||(n||(n=[]),Array.prototype.push.apply(n,r.split(/\s/g).map(parseFloat))),C(t);return n?(e.push(n),e.length?e:null):null}function w(t,e){var n;const r=null==(n=e._)?void 0:n.substring(e.i).match(t);return r?(e.i+=r[0].length,r[0]):null}function C(t){w(/^\s*/,t)}var S={dataType:null,batchType:null,name:"WKT (Well-Known Text)",id:"wkt",module:"wkt",version:u,worker:!0,extensions:["wkt"],mimeTypes:["text/plain"],category:"geometry",text:!0,tests:m,testText:v,options:{wkt:{shape:"geojson-geometry",crs:!0}}},E={...S,parse:async(t,e)=>b((new TextDecoder).decode(t),e),parseTextSync:(t,e)=>b(t,e)};function M(t){switch("Feature"===t.type&&(t=t.geometry),t.type){case"Point":return`POINT ${I(P(t.coordinates))}`;case"LineString":return`LINESTRING ${I(T(t.coordinates))}`;case"Polygon":return`POLYGON ${I(O(t.coordinates))}`;case"MultiPoint":return`MULTIPOINT ${I(T(t.coordinates))}`;case"MultiPolygon":return`MULTIPOLYGON ${I((e=t.coordinates,e.map(O).map(I).join(", ")))}`;case"MultiLineString":return`MULTILINESTRING ${I(O(t.coordinates))}`;case"GeometryCollection":return`GEOMETRYCOLLECTION ${I(t.geometries.map(M).join(", "))}`;default:throw new Error("stringify requires a valid GeoJSON Feature or geometry object as input")}var e}function P(t){return t.join(" ")}function T(t){return t.map(P).join(", ")}function O(t){return t.map(T).map(I).join(", ")}function I(t){return`(${t})`}var R={name:"WKT (Well Known Text)",id:"wkt",module:"wkt",version:u,extensions:["wkt"],text:!0,encode:async t=>B(t),encodeSync:B,encodeTextSync:M,options:{wkt:{}}};function B(t){return(new TextEncoder).encode(M(t)).buffer}var L,k,D=n(24059),F=2147483648,N=1073741824,j=536870912,G=1e4;function U(t){const e=new DataView(t);let n=0;const r=e.getUint8(n);if(n+=1,r>1)return!1;const i=1===r,o=e.getUint32(n,i);n+=4;const s=7&o;if(0===s||s>7)return!1;const a=o-s;if(0===a||1e3===a||2e3===a||3e3===a)return!0;if(a&~(F|N|j))return!1;if(a&j){const t=e.getUint32(n,i);if(n+=4,t>G)return!1}return!0}function z(t,e){const n=Object.assign(e||{},{type:"wkb",geometryType:1,dimensions:2,coordinates:"xy",littleEndian:!0,byteOffset:0});n.littleEndian=1===t.getUint8(n.byteOffset),n.byteOffset++;const r=t.getUint32(n.byteOffset,n.littleEndian);n.byteOffset+=4,n.geometryType=7&r;const i=(r-n.geometryType)/1e3;switch(i){case 0:break;case 1:n.type="iso-wkb",n.dimensions=3,n.coordinates="xyz";break;case 2:n.type="iso-wkb",n.dimensions=3,n.coordinates="xym";break;case 3:n.type="iso-wkb",n.dimensions=4,n.coordinates="xyzm";break;default:throw new Error(`WKB: Unsupported iso-wkb type: ${i}`)}const o=r&F,s=r&N,a=r&j;return o&&s?(n.type="ewkb",n.dimensions=4,n.coordinates="xyzm"):o?(n.type="ewkb",n.dimensions=3,n.coordinates="xyz"):s&&(n.type="ewkb",n.dimensions=3,n.coordinates="xym"),a&&(n.type="ewkb",n.srid=t.getUint32(n.byteOffset,n.littleEndian),n.byteOffset+=4),n}function V(t,e){var n;const r=function(t){const e=new DataView(t),n=z(e),{geometryType:r,dimensions:i,littleEndian:o}=n,s=n.byteOffset;switch(r){case L.Point:return H(e,s,i,o).geometry;case L.LineString:return q(e,s,i,o).geometry;case L.Polygon:return J(e,s,i,o).geometry;case L.MultiPoint:const t=function(t,e,n,r){const i=t.getUint32(e,r);e+=4;const o=[];for(let r=0;r<i;r++){const r=1===t.getUint8(e);if(e++,t.getUint32(e,r)%1e3!=1)throw new Error("WKB: Inner geometries of MultiPoint not of type Point");const i=H(t,e+=4,n,r);e=i.offset,o.push(i.geometry)}return function(t,e){const n=t.map((t=>t.positions.value));return{type:"Point",positions:{value:new Float64Array(Y(n).buffer),size:e}}}(o,n)}(e,s,i,o);return t.type="Point",t;case L.MultiLineString:const n=function(t,e,n,r){const i=t.getUint32(e,r);e+=4;const o=[];for(let r=0;r<i;r++){const r=1===t.getUint8(e);if(e++,t.getUint32(e,r)%1e3!=2)throw new Error("WKB: Inner geometries of MultiLineString not of type LineString");const i=q(t,e+=4,n,r);e=i.offset,o.push(i.geometry)}return function(t,e){const n=t.map((t=>t.positions.value)),r=new Float64Array(Y(n).buffer),i=n.map((t=>t.length/e)).map(W(0));return i.unshift(0),{type:"LineString",positions:{value:r,size:e},pathIndices:{value:new Uint32Array(i),size:1}}}(o,n)}(e,s,i,o);return n.type="LineString",n;case L.MultiPolygon:const a=function(t,e,n,r){const i=t.getUint32(e,r);e+=4;const o=[];for(let r=0;r<i;r++){const r=1===t.getUint8(e);if(e++,t.getUint32(e,r)%1e3!=3)throw new Error("WKB: Inner geometries of MultiPolygon not of type Polygon");const i=J(t,e+=4,n,r);e=i.offset,o.push(i.geometry)}return function(t,e){const n=[],r=[];for(const e of t){const{positions:t,primitivePolygonIndices:i}=e;n.push(t.value),r.push(i.value)}const i=new Float64Array(Y(n).buffer),o=n.map((t=>t.length/e)).map(W(0));o.unshift(0);const s=[0];for(const t of r)s.push(...t.filter((t=>t>0)).map((t=>t+s[s.length-1])));return{type:"Polygon",positions:{value:i,size:e},polygonIndices:{value:new Uint32Array(o),size:1},primitivePolygonIndices:{value:new Uint32Array(s),size:1}}}(o,n)}(e,s,i,o);return a.type="Polygon",a;default:throw new Error(`WKB: Unsupported geometry type: ${r}`)}}(t),i=(null==(n=null==e?void 0:e.wkb)?void 0:n.shape)||"binary-geometry";switch(i){case"binary-geometry":return r;case"geojson-geometry":return(0,D.binaryToGeometry)(r);case"geometry":return console.error('WKBLoader: "geometry" shape is deprecated, use "binary-geometry" instead'),(0,D.binaryToGeometry)(r);default:throw new Error(i)}}function H(t,e,n,r){const i=new Float64Array(n);for(let o=0;o<n;o++)i[o]=t.getFloat64(e,r),e+=8;return{geometry:{type:"Point",positions:{value:i,size:n}},offset:e}}function q(t,e,n,r){const i=t.getUint32(e,r);e+=4;const o=new Float64Array(i*n);for(let s=0;s<i*n;s++)o[s]=t.getFloat64(e,r),e+=8;const s=[0];return i>0&&s.push(i),{geometry:{type:"LineString",positions:{value:o,size:n},pathIndices:{value:new Uint32Array(s),size:1}},offset:e}}(k=L||(L={}))[k.Point=1]="Point",k[k.LineString=2]="LineString",k[k.Polygon=3]="Polygon",k[k.MultiPoint=4]="MultiPoint",k[k.MultiLineString=5]="MultiLineString",k[k.MultiPolygon=6]="MultiPolygon",k[k.GeometryCollection=7]="GeometryCollection";var W=t=>e=>t+=e;function J(t,e,n,r){const i=t.getUint32(e,r);e+=4;const o=[];for(let s=0;s<i;s++){const i=q(t,e,n,r),{positions:s}=i.geometry;e=i.offset,o.push(s.value)}const s=new Float64Array(Y(o).buffer),a=[0];s.length>0&&a.push(s.length/n);const l=o.map((t=>t.length/n)).map(W(0));return l.unshift(0),{geometry:{type:"Polygon",positions:{value:s,size:n},polygonIndices:{value:new Uint32Array(a),size:1},primitivePolygonIndices:{value:new Uint32Array(l),size:1}},offset:e}}function Y(t){let e=0;for(let n=0;n<t.length;++n)e+=t[n].byteLength;const n=new Uint8Array(e);let r=0;for(let i=0;i<t.length;++i){const o=new Uint8Array(t[i].buffer);e=o.length;for(let t=0;t<e;++t)n[r++]=o[t]}return n}var X,K,Z={dataType:null,batchType:null,name:"WKB",id:"wkb",module:"wkt",version:u,worker:!0,category:"geometry",extensions:["wkb"],mimeTypes:[],tests:[U],options:{wkb:{shape:"binary-geometry"}}},Q={...Z,parse:async t=>V(t),parseSync:V},$=!0,tt=!1,et=class{arrayBuffer;dataView;byteOffset=0;allowResize=!1;constructor(t,e){this.arrayBuffer=new ArrayBuffer(t),this.dataView=new DataView(this.arrayBuffer),this.byteOffset=0,this.allowResize=e||!1}writeUInt8(t){this._ensureSize(1),this.dataView.setUint8(this.byteOffset,t),this.byteOffset+=1}writeUInt16LE(t){this._ensureSize(2),this.dataView.setUint16(this.byteOffset,t,$),this.byteOffset+=2}writeUInt16BE(t){this._ensureSize(2),this.dataView.setUint16(this.byteOffset,t,tt),this.byteOffset+=2}writeUInt32LE(t){this._ensureSize(4),this.dataView.setUint32(this.byteOffset,t,$),this.byteOffset+=4}writeUInt32BE(t){this._ensureSize(4),this.dataView.setUint32(this.byteOffset,t,tt),this.byteOffset+=4}writeInt8(t){this._ensureSize(1),this.dataView.setInt8(this.byteOffset,t),this.byteOffset+=1}writeInt16LE(t){this._ensureSize(2),this.dataView.setInt16(this.byteOffset,t,$),this.byteOffset+=2}writeInt16BE(t){this._ensureSize(2),this.dataView.setInt16(this.byteOffset,t,tt),this.byteOffset+=2}writeInt32LE(t){this._ensureSize(4),this.dataView.setInt32(this.byteOffset,t,$),this.byteOffset+=4}writeInt32BE(t){this._ensureSize(4),this.dataView.setInt32(this.byteOffset,t,tt),this.byteOffset+=4}writeFloatLE(t){this._ensureSize(4),this.dataView.setFloat32(this.byteOffset,t,$),this.byteOffset+=4}writeFloatBE(t){this._ensureSize(4),this.dataView.setFloat32(this.byteOffset,t,tt),this.byteOffset+=4}writeDoubleLE(t){this._ensureSize(8),this.dataView.setFloat64(this.byteOffset,t,$),this.byteOffset+=8}writeDoubleBE(t){this._ensureSize(8),this.dataView.setFloat64(this.byteOffset,t,tt),this.byteOffset+=8}writeVarInt(t){let e=1;for(;4294967168&t;)this.writeUInt8(127&t|128),t>>>=7,e++;return this.writeUInt8(127&t),e}writeBuffer(t){this._ensureSize(t.byteLength),new Uint8Array(this.arrayBuffer).set(new Uint8Array(t),this.byteOffset),this.byteOffset+=t.byteLength}_ensureSize(t){if(this.arrayBuffer.byteLength<this.byteOffset+t){if(!this.allowResize)throw new Error("BinaryWriter overflow");{const e=new ArrayBuffer(this.byteOffset+t);new Uint8Array(e).set(new Uint8Array(this.arrayBuffer)),this.arrayBuffer=e}}}};function nt(t,e={}){switch("Feature"===t.type&&(t=t.geometry),t.type){case"Point":return it(t.coordinates,e);case"LineString":return at(t.coordinates,e);case"Polygon":return ut(t.coordinates,e);case"MultiPoint":return function(t,e){const n=new et(ht(t,e)),r=t.coordinates;n.writeInt8(1),gt(n,X.MultiPoint,e),n.writeUInt32LE(r.length);for(const t of r){const r=it(t,e);n.writeBuffer(r)}return n.arrayBuffer}(t,e);case"MultiPolygon":return function(t,e){const n=new et(ft(t,e)),r=t.coordinates;n.writeInt8(1),gt(n,X.MultiPolygon,e),n.writeUInt32LE(r.length);for(const t of r){const r=ut(t,e);n.writeBuffer(r)}return n.arrayBuffer}(t,e);case"MultiLineString":return function(t,e){const n=new et(dt(t,e)),r=t.coordinates;n.writeInt8(1),gt(n,X.MultiLineString,e),n.writeUInt32LE(r.length);for(const t of r){const r=at(t,e);n.writeBuffer(r)}return n.arrayBuffer}(t,e);case"GeometryCollection":return function(t,e){const n=new et(pt(t,e));n.writeInt8(1),gt(n,X.GeometryCollection,e),n.writeUInt32LE(t.geometries.length);for(const r of t.geometries){const t=nt(r,e);n.writeBuffer(t)}return n.arrayBuffer}(t,e);default:throw new Error(`Unhandled case: ${t}`)}}function rt(t,e){switch(t.type){case"Point":return st(e);case"LineString":return lt(t.coordinates,e);case"Polygon":return ct(t.coordinates,e);case"MultiPoint":return ht(t,e);case"MultiPolygon":return ft(t,e);case"MultiLineString":return dt(t,e);case"GeometryCollection":return pt(t,e);default:throw new Error(`Unhandled case: ${t}`)}}function it(t,e){const n=new et(st(e));return n.writeInt8(1),gt(n,X.Point,e),void 0===t[0]&&void 0===t[1]?(n.writeDoubleLE(NaN),n.writeDoubleLE(NaN),e.hasZ&&n.writeDoubleLE(NaN),e.hasM&&n.writeDoubleLE(NaN)):ot(n,t,e),n.arrayBuffer}function ot(t,e,n){t.writeDoubleLE(e[0]),t.writeDoubleLE(e[1]),n.hasZ&&t.writeDoubleLE(e[2]),n.hasM&&t.writeDoubleLE(e[3])}function st(t){return 5+yt(t)}function at(t,e){const n=lt(t,e),r=new et(n);r.writeInt8(1),gt(r,X.LineString,e),r.writeUInt32LE(t.length);for(const n of t)ot(r,n,e);return r.arrayBuffer}function lt(t,e){const n=yt(e);return 9+t.length*n}function ut(t,e){const n=new et(ct(t,e));n.writeInt8(1),gt(n,X.Polygon,e);const[r,...i]=t;r.length>0?(n.writeUInt32LE(1+i.length),n.writeUInt32LE(r.length)):n.writeUInt32LE(0);for(const t of r)ot(n,t,e);for(const t of i){n.writeUInt32LE(t.length);for(const r of t)ot(n,r,e)}return n.arrayBuffer}function ct(t,e){const n=yt(e),[r,...i]=t;let o=9;r.length>0&&(o+=4+r.length*n);for(const t of i)o+=4+t.length*n;return o}function ht(t,e){let n=yt(e);return n+=5,9+t.coordinates.length*n}function dt(t,e){let n=9;const r=t.coordinates;for(const t of r)n+=lt(t,e);return n}function ft(t,e){let n=9;const r=t.coordinates;for(const t of r)n+=ct(t,e);return n}function pt(t,e){let n=9;for(const r of t.geometries)n+=rt(r,e);return n}function gt(t,e,n){const{hasZ:r,hasM:i,srid:o}=n;let s=0;o?(r&&(s|=2147483648),i&&(s|=1073741824)):r&&i?s+=3e3:r?s+=1e3:i&&(s+=2e3),t.writeUInt32LE(s+e>>>0)}function yt(t){let e=16;return t.hasZ&&(e+=8),t.hasM&&(e+=8),e}(K=X||(X={}))[K.Point=1]="Point",K[K.LineString=2]="LineString",K[K.Polygon=3]="Polygon",K[K.MultiPoint=4]="MultiPoint",K[K.MultiLineString=5]="MultiLineString",K[K.MultiPolygon=6]="MultiPolygon",K[K.GeometryCollection=7]="GeometryCollection";var mt={name:"WKB (Well Known Binary)",id:"wkb",module:"wkt",version:u,extensions:["wkb"],options:{wkb:{hasZ:!1,hasM:!1}},encode:async(t,e)=>nt(t,null==e?void 0:e.wkb),encodeSync:(t,e)=>nt(t,null==e?void 0:e.wkb)},vt="0123456789abcdef",bt=[],_t=[];for(let t=0;t<256;t++)bt[t]=vt[t>>4&15]+vt[15&t],t<16&&(t<10?_t[48+t]=t:_t[87+t]=t);function At(t){const e=t.length;let n="",r=0;for(;r<e;)n+=bt[t[r++]];return n}function xt(t){const e=t.length>>1,n=e<<1,r=new Uint8Array(e);let i=0,o=0;for(;o<n;)r[i++]=_t[t.charCodeAt(o++)]<<4|_t[t.charCodeAt(o++)];return r}var wt={dataType:null,batchType:null,name:"Hexadecimal WKB",id:"wkb",module:"wkt",version:u,worker:!0,category:"geometry",extensions:["wkb"],mimeTypes:[],options:Q.options,text:!0,testText:function(t){return!!t&&(!(t.length<10||t.length%2!=0)&&(!(!t.startsWith("00")&&!t.startsWith("01"))&&/^[0-9a-fA-F]+$/.test(t.slice(2))))},parse:async t=>Ct((new TextDecoder).decode(t)),parseTextSync:Ct};function Ct(t,e){var n,r;const i=xt(t);return null==(r=(n=Q).parseSync)?void 0:r.call(n,i.buffer,e)}var St=class{arrayBuffer;dataView;byteOffset;littleEndian;constructor(t,e=!1){this.arrayBuffer=t,this.dataView=new DataView(t),this.byteOffset=0,this.littleEndian=!e}readUInt8(){const t=this.dataView.getUint8(this.byteOffset);return this.byteOffset+=1,t}readUInt16(){const t=this.dataView.getUint16(this.byteOffset,this.littleEndian);return this.byteOffset+=2,t}readUInt32(){const t=this.dataView.getUint32(this.byteOffset,this.littleEndian);return this.byteOffset+=4,t}readInt8(){const t=this.dataView.getInt8(this.byteOffset);return this.byteOffset+=1,t}readInt16(){const t=this.dataView.getInt16(this.byteOffset,this.littleEndian);return this.byteOffset+=2,t}readInt32(){const t=this.dataView.getInt32(this.byteOffset,this.littleEndian);return this.byteOffset+=4,t}readFloat(){const t=this.dataView.getFloat32(this.byteOffset,this.littleEndian);return this.byteOffset+=4,t}readDouble(){const t=this.dataView.getFloat64(this.byteOffset,this.littleEndian);return this.byteOffset+=8,t}readVarInt(){let t,e=0,n=0;do{t=this.dataView.getUint8(this.byteOffset+n),e+=(127&t)<<7*n,n++}while(t>=128);return this.byteOffset+=n,e}};function Et(t){const e=15&new St(t).readUInt8();return!(e<1||e>7)}function Mt(t){const e=new St(t),n=function(t){const e=t.readUInt8(),n=t.readUInt8(),r=15&e,i=Pt(e>>4),o=Boolean(n>>3&1);let s=!1,a=!1,l=0,u=1,c=0,h=1;if(o){const e=t.readUInt8();s=!(1&~e),a=!(2&~e),l=Pt((28&e)>>2),u=Math.pow(10,l),c=Pt((224&e)>>5),h=Math.pow(10,c)}return{geometryType:r,precision:i,precisionFactor:Math.pow(10,i),hasBoundingBox:Boolean(1&n),hasSizeAttribute:Boolean(n>>1&1),hasIdList:Boolean(n>>2&1),hasExtendedPrecision:o,isEmpty:Boolean(n>>4&1),hasZ:s,hasM:a,zPrecision:l,zPrecisionFactor:u,mPrecision:c,mPrecisionFactor:h}}(e);if(n.hasSizeAttribute&&e.readVarInt(),n.hasBoundingBox){let t=2;n.hasZ&&t++,n.hasM&&t++;for(let n=0;n<t;n++)e.readVarInt(),e.readVarInt()}return function(t,e,n){switch(n){case L.Point:return function(t,e){return e.isEmpty?{type:"Point",coordinates:[]}:{type:"Point",coordinates:It(t,e)}}(t,e);case L.LineString:return function(t,e){if(e.isEmpty)return{type:"LineString",coordinates:[]};const n=t.readVarInt(),r=Ot(e),i=[];for(let o=0;o<n;o++)i.push(Rt(t,e,r));return{type:"LineString",coordinates:i}}(t,e);case L.Polygon:return function(t,e){if(e.isEmpty)return{type:"Polygon",coordinates:[]};const n=t.readVarInt(),r=Ot(e),i=t.readVarInt(),o=[];for(let n=0;n<i;n++)o.push(Rt(t,e,r));const s=[o];for(let i=1;i<n;i++){const n=t.readVarInt(),i=[];for(let o=0;o<n;o++)i.push(Rt(t,e,r));s.push(i)}return{type:"Polygon",coordinates:s}}(t,e);case L.MultiPoint:return function(t,e){if(e.isEmpty)return{type:"MultiPoint",coordinates:[]};const n=Ot(e),r=t.readVarInt(),i=[];for(let o=0;o<r;o++)i.push(Rt(t,e,n));return{type:"MultiPoint",coordinates:i}}(t,e);case L.MultiLineString:return function(t,e){if(e.isEmpty)return{type:"MultiLineString",coordinates:[]};const n=Ot(e),r=t.readVarInt(),i=[];for(let o=0;o<r;o++){const r=t.readVarInt(),o=[];for(let i=0;i<r;i++)o.push(Rt(t,e,n));i.push(o)}return{type:"MultiLineString",coordinates:i}}(t,e);case L.MultiPolygon:return function(t,e){if(e.isEmpty)return{type:"MultiPolygon",coordinates:[]};const n=Ot(e),r=t.readVarInt(),i=[];for(let o=0;o<r;o++){const r=t.readVarInt(),o=t.readVarInt(),s=[];for(let r=0;r<o;r++)s.push(Rt(t,e,n));const a=s?[s]:[];for(let i=1;i<r;i++){const r=[],i=t.readVarInt();for(let o=0;o<i;o++)r.push(Rt(t,e,n));a.push(r)}i.push(a)}return{type:"MultiPolygon",coordinates:i}}(t,e);case L.GeometryCollection:return{type:"GeometryCollection",geometries:[]};default:throw new Error(`GeometryType ${n} not supported`)}}(e,n,n.geometryType)}function Pt(t){return t>>1^-(1&t)}function Tt(t,e,n,r){return void 0!==n?void 0!==r?[t,e,n,r]:[t,e,n]:[t,e]}function Ot(t){return Tt(0,0,t.hasZ?0:void 0,t.hasM?0:void 0)}function It(t,e){return Tt(Pt(t.readVarInt())/e.precisionFactor,Pt(t.readVarInt())/e.precisionFactor,e.hasZ?Pt(t.readVarInt())/e.zPrecisionFactor:void 0,e.hasM?Pt(t.readVarInt())/e.mPrecisionFactor:void 0)}function Rt(t,e,n){return n[0]+=Pt(t.readVarInt())/e.precisionFactor,n[1]+=Pt(t.readVarInt())/e.precisionFactor,e.hasZ&&(n[2]+=Pt(t.readVarInt())/e.zPrecisionFactor),e.hasM&&(n[3]+=Pt(t.readVarInt())/e.mPrecisionFactor),n.slice()}var Bt={dataType:null,batchType:null,name:"TWKB (Tiny Well-Known Binary)",id:"twkb",module:"wkt",version:u,worker:!0,category:"geometry",extensions:["twkb"],mimeTypes:[],tests:[Et],options:{wkb:{shape:"binary-geometry"}},parse:async t=>Mt(t),parseSync:Mt};function Lt(t,e){const n=new et(0,!0);return kt(n,t,{...{xy:5,z:0,m:0,xyFactor:Math.pow(10,5),zFactor:Math.pow(10,0),mFactor:Math.pow(10,0)},hasZ:null==e?void 0:e.hasZ,hasM:null==e?void 0:e.hasM}),n.arrayBuffer}function kt(t,e,n){switch(e.type){case"Point":return function(t,e,n){const r=0===n.coordinates.length||"undefined"===n[0]||"undefined"===n[1];if(Dt(t,e,L.Point,r),!r){const r=[0,0,0,0];Ft(t,e,n.coordinates,r)}}(t,n,e);case"LineString":return function(t,e,n){const r=n.coordinates,i=0===r.length;if(Dt(t,e,L.LineString,i),!i){t.writeVarInt(r.length);const n=[0,0,0,0];for(const i of r)Ft(t,e,i,n)}return t.arrayBuffer}(t,n,e);case"Polygon":return function(t,e,n){const r=n.coordinates,i=0===r.length;if(Dt(t,e,L.Polygon,i),!i){t.writeVarInt(r.length);const n=[0,0,0,0];for(const i of r){t.writeVarInt(i.length);for(const r of i)Ft(t,e,n,r)}}return t.arrayBuffer}(t,n,e);case"MultiPoint":return function(t,e,n){const r=n.coordinates,i=0===r.length;if(Dt(t,e,L.MultiPoint,i),!i){t.writeVarInt(r.length);const n=[0,0,0,0];for(let i=0;i<r.length;i++)Ft(t,e,n,r[i])}}(t,n,e);case"MultiLineString":return function(t,e,n){const r=n.coordinates,i=0===r.length;if(Dt(t,e,L.MultiLineString,i),!i){t.writeVarInt(r.length);const n=[0,0,0,0];for(const i of r){t.writeVarInt(i.length);for(const r of i)Ft(t,e,n,r)}}return t.arrayBuffer}(t,n,e);case"MultiPolygon":return function(t,e,n){const{coordinates:r}=n,i=0===r.length;if(Dt(t,e,L.MultiPolygon,i),!i){const n=r;t.writeVarInt(n.length);const i=[0,0,0,0];for(const r of n){t.writeVarInt(r.length);for(const n of r){t.writeVarInt(n.length);for(const r of n)Ft(t,e,i,r)}}}}(t,n,e);case"GeometryCollection":return function(t,e,n){const{geometries:r}=n,i=0===r.length;if(Dt(t,e,L.GeometryCollection,i),r.length>0){t.writeVarInt(r.length);for(const n of r)kt(t,n,e)}}(t,n,e);default:throw new Error("unsupported geometry type")}}function Dt(t,e,n,r){const i=(Nt(e.xy)<<4)+n;let o=e.hasZ||e.hasM?8:0;if(o+=r?16:0,t.writeUInt8(i),t.writeUInt8(o),e.hasZ||e.hasM){let n=0;e.hasZ&&(n|=1),e.hasM&&(n|=2),t.writeUInt8(n)}}function Ft(t,e,n,r){const i=n[0]*e.xyFactor,o=n[1]*e.xyFactor,s=n[2]*e.zFactor,a=n[3]*e.mFactor;t.writeVarInt(Nt(i-r[0])),t.writeVarInt(Nt(o-r[1])),e.hasZ&&t.writeVarInt(Nt(s-r[2])),e.hasM&&t.writeVarInt(Nt(a-r[3])),r[0]=i,r[1]=o,r[2]=s,r[3]=a}function Nt(t){return t<<1^t>>31}var jt={name:"TWKB (Tiny Well Known Binary)",id:"twkb",module:"wkt",version:u,extensions:["twkb"],encode:async(t,e)=>Lt(t,null==e?void 0:e.twkb),encodeSync:(t,e)=>Lt(t,null==e?void 0:e.twkb),options:{twkb:{hasZ:!1,hasM:!1}}}},96288:(t,e,n)=>{"use strict";var r,i=n(65606),o=Object.create,s=Object.defineProperty,a=Object.getOwnPropertyDescriptor,l=Object.getOwnPropertyNames,u=Object.getPrototypeOf,c=Object.prototype.hasOwnProperty,h=(t,e,n,r)=>{if(e&&"object"==typeof e||"function"==typeof e)for(let i of l(e))c.call(t,i)||i===n||s(t,i,{get:()=>e[i],enumerable:!(r=a(e,i))||r.enumerable});return t},d=(t,e,n)=>(n=null!=t?o(u(t)):{},h(!e&&t&&t.__esModule?n:s(n,"default",{value:t,enumerable:!0}),t)),f={};((t,e)=>{for(var n in e)s(t,n,{get:e[n],enumerable:!0})})(f,{AsyncQueue:()=>q,ChildProcessProxy:()=>nt,NullWorker:()=>rt,WorkerBody:()=>N,WorkerFarm:()=>k,WorkerJob:()=>x,WorkerPool:()=>R,WorkerThread:()=>I,assert:()=>m,canProcessOnWorker:()=>G,createWorker:()=>J,getLibraryUrl:()=>Q,getTransferList:()=>E,getTransferListForWriter:()=>P,getWorkerURL:()=>j,isBrowser:()=>v,isWorker:()=>b,loadLibrary:()=>Z,processOnWorker:()=>U,validateWorkerVersion:()=>X}),t.exports=(r=f,h(s({},"__esModule",{value:!0}),r));var p,g="latest",y=((null==(p=globalThis._loadersgl_)?void 0:p.version)||(globalThis._loadersgl_=globalThis._loadersgl_||{},globalThis._loadersgl_.version="4.2.1"),globalThis._loadersgl_.version);function m(t,e){if(!t)throw new Error(e||"loaders.gl assertion failed.")}"undefined"!=typeof self&&self,"undefined"!=typeof window&&window,void 0!==n.g&&n.g,"undefined"!=typeof document&&document;var v="object"!=typeof i||"[object process]"!==String(i)||i.browser,b="function"==typeof importScripts,_="undefined"!=typeof window&&void 0!==window.orientation,A=void 0!==i&&i.version&&/v([0-9]*)/.exec(i.version),x=(A&&parseFloat(A[1]),class{name;workerThread;isRunning=!0;result;_resolve=()=>{};_reject=()=>{};constructor(t,e){this.name=t,this.workerThread=e,this.result=new Promise(((t,e)=>{this._resolve=t,this._reject=e}))}postMessage(t,e){this.workerThread.postMessage({source:"loaders.gl",type:t,payload:e})}done(t){m(this.isRunning),this.isRunning=!1,this._resolve(t)}error(t){m(this.isRunning),this.isRunning=!1,this._reject(t)}}),w=class{terminate(){}},C=new Map;function S(t){const e=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(e)}function E(t,e=!0,n){const r=n||new Set;if(t)if(M(t))r.add(t);else if(M(t.buffer))r.add(t.buffer);else if(ArrayBuffer.isView(t));else if(e&&"object"==typeof t)for(const n in t)E(t[n],e,r);return void 0===n?Array.from(r):[]}function M(t){return!!t&&(t instanceof ArrayBuffer||"undefined"!=typeof MessagePort&&t instanceof MessagePort||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap||"undefined"!=typeof OffscreenCanvas&&t instanceof OffscreenCanvas)}function P(t){if(null===t)return{};const e=Object.assign({},t);return Object.keys(e).forEach((n=>{"object"!=typeof t[n]||ArrayBuffer.isView(t[n])||t[n]instanceof Array?"function"==typeof e[n]||e[n]instanceof RegExp?e[n]={}:e[n]=t[n]:e[n]=P(t[n])})),e}var T,O=()=>{},I=class{name;source;url;terminated=!1;worker;onMessage;onError;_loadableURL="";static isSupported(){return"undefined"!=typeof Worker&&v||void 0!==w&&!v}constructor(t){const{name:e,source:n,url:r}=t;m(n||r),this.name=e,this.source=n,this.url=r,this.onMessage=O,this.onError=t=>console.log(t),this.worker=v?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=O,this.onError=O,this.worker.terminate(),this.terminated=!0}get isRunning(){return Boolean(this.onMessage)}postMessage(t,e){e=e||E(t),this.worker.postMessage(t,e)}_getErrorFromErrorEvent(t){let e="Failed to load ";return e+=`worker ${this.name} from ${this.url}. `,t.message&&(e+=`${t.message} in `),t.lineno&&(e+=`:${t.lineno}:${t.colno}`),new Error(e)}_createBrowserWorker(){this._loadableURL=function(t){m(t.source&&!t.url||!t.source&&t.url);let e=C.get(t.source||t.url);return e||(t.url&&(e=(n=t.url).startsWith("http")?S(`try {\n  importScripts('${n}');\n} catch (error) {\n  console.error(error);\n  throw error;\n}`):n,C.set(t.url,e)),t.source&&(e=S(t.source),C.set(t.source,e))),m(e),e;var n}({source:this.source,url:this.url});const t=new Worker(this._loadableURL,{name:this.name});return t.onmessage=t=>{t.data?this.onMessage(t.data):this.onError(new Error("No data received"))},t.onerror=t=>{this.onError(this._getErrorFromErrorEvent(t)),this.terminated=!0},t.onmessageerror=t=>console.error(t),t}_createNodeWorker(){let t;if(this.url){const e=this.url.includes(":/")||this.url.startsWith("/")?this.url:`./${this.url}`;t=new w(e,{eval:!1})}else{if(!this.source)throw new Error("no worker");t=new w(this.source,{eval:!0})}return t.on("message",(t=>{this.onMessage(t)})),t.on("error",(t=>{this.onError(t)})),t.on("exit",(t=>{})),t}},R=class{name="unnamed";source;url;maxConcurrency=1;maxMobileConcurrency=1;onDebug=()=>{};reuseWorkers=!0;props={};jobQueue=[];idleQueue=[];count=0;isDestroyed=!1;static isSupported(){return I.isSupported()}constructor(t){this.source=t.source,this.url=t.url,this.setProps(t)}destroy(){this.idleQueue.forEach((t=>t.destroy())),this.isDestroyed=!0}setProps(t){this.props={...this.props,...t},void 0!==t.name&&(this.name=t.name),void 0!==t.maxConcurrency&&(this.maxConcurrency=t.maxConcurrency),void 0!==t.maxMobileConcurrency&&(this.maxMobileConcurrency=t.maxMobileConcurrency),void 0!==t.reuseWorkers&&(this.reuseWorkers=t.reuseWorkers),void 0!==t.onDebug&&(this.onDebug=t.onDebug)}async startJob(t,e=(t,e,n)=>t.done(n),n=(t,e)=>t.error(e)){const r=new Promise((r=>(this.jobQueue.push({name:t,onMessage:e,onError:n,onStart:r}),this)));return this._startQueuedJob(),await r}async _startQueuedJob(){if(!this.jobQueue.length)return;const t=this._getAvailableWorker();if(!t)return;const e=this.jobQueue.shift();if(e){this.onDebug({message:"Starting job",name:e.name,workerThread:t,backlog:this.jobQueue.length});const n=new x(e.name,t);t.onMessage=t=>e.onMessage(n,t.type,t.payload),t.onError=t=>e.onError(n,t),e.onStart(n);try{await n.result}catch(t){console.error(`Worker exception: ${t}`)}finally{this.returnWorkerToQueue(t)}}}returnWorkerToQueue(t){!v||this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(t.destroy(),this.count--):this.idleQueue.push(t),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const t=`${this.name.toLowerCase()} (#${this.count} of ${this.maxConcurrency})`;return new I({name:t,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return _?this.maxMobileConcurrency:this.maxConcurrency}},B={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}},L=class{props;workerPools=new Map;static isSupported(){return I.isSupported()}static getWorkerFarm(t={}){return L._workerFarm=L._workerFarm||new L({}),L._workerFarm.setProps(t),L._workerFarm}constructor(t){this.props={...B},this.setProps(t),this.workerPools=new Map}destroy(){for(const t of this.workerPools.values())t.destroy();this.workerPools=new Map}setProps(t){this.props={...this.props,...t};for(const t of this.workerPools.values())t.setProps(this._getWorkerPoolProps())}getWorkerPool(t){const{name:e,source:n,url:r}=t;let i=this.workerPools.get(e);return i||(i=new R({name:e,source:n,url:r}),i.setProps(this._getWorkerPoolProps()),this.workerPools.set(e,i)),i}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}},k=L;async function D(){return null}((t,e,n)=>{e in t?s(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n})(k,"symbol"!=typeof(T="_workerFarm")?T+"":T,undefined);var F=new Map,N=class{static async inWorkerThread(){return"undefined"!=typeof self||Boolean(await D())}static set onmessage(t){async function e(e){const n=await D(),{type:r,payload:i}=n?e:e.data;t(r,i)}D().then((t=>{t?(t.on("message",(t=>{e(t)})),t.on("exit",(()=>console.debug("Node worker closing")))):globalThis.onmessage=e}))}static async addEventListener(t){let e=F.get(t);e||(e=async e=>{if(!function(t){const{type:e,data:n}=t;return"message"===e&&n&&"string"==typeof n.source&&n.source.startsWith("loaders.gl")}(e))return;const n=await D(),{type:r,payload:i}=n?e:e.data;t(r,i)}),await D()?console.error("not implemented"):globalThis.addEventListener("message",e)}static async removeEventListener(t){const e=F.get(t);F.delete(t),await D()?console.error("not implemented"):globalThis.removeEventListener("message",e)}static async postMessage(t,e){const n={source:"loaders.gl",type:t,payload:e},r=E(e),i=await D();i?i.postMessage(n,r):globalThis.postMessage(n,r)}};function j(t,e={}){const n=e[t.id]||{},r=v?`${t.id}-worker.js`:`${t.id}-worker-node.js`;let i=n.workerUrl;if(i||"compression"!==t.id||(i=e.workerUrl),"test"===e._workerType&&(i=v?`modules/${t.module}/dist/${r}`:`modules/${t.module}/src/workers/${t.id}-worker-node.ts`),!i){let e=t.version;"latest"===e&&(e=g);const n=e?`@${e}`:"";i=`https://unpkg.com/@loaders.gl/${t.module}${n}/dist/${r}`}return m(i),i}function G(t,e){return!!k.isSupported()&&t.worker&&(null==e?void 0:e.worker)}async function U(t,e,n={},r={}){const i=function(t){const e=t.version!==y?` (worker-utils@${y})`:"";return`${t.name}@${t.version}${e}`}(t),o=k.getWorkerFarm(n),{source:s}=n,a={name:i,source:s};s||(a.url=j(t,n));const l=o.getWorkerPool(a),u=n.jobName||t.name,c=await l.startJob(u,z.bind(null,r)),h=P(n);return c.postMessage("process",{input:e,options:h}),(await c.result).result}async function z(t,e,n,r){switch(n){case"done":e.done(r);break;case"error":e.error(new Error(r.error));break;case"process":const{id:i,input:o,options:s}=r;try{if(!t.process)return void e.postMessage("error",{id:i,error:"Worker not set up to process on main thread"});const n=await t.process(o,s);e.postMessage("done",{id:i,result:n})}catch(t){const n=t instanceof Error?t.message:"unknown error";e.postMessage("error",{id:i,error:n})}break;default:console.warn(`process-on-worker: unknown message ${n}`)}}var V,H,q=class{_values;_settlers;_closed;constructor(){this._values=[],this._settlers=[],this._closed=!1}[Symbol.asyncIterator](){return this}push(t){return this.enqueue(t)}enqueue(t){if(this._closed)throw new Error("Closed");if(this._settlers.length>0){if(this._values.length>0)throw new Error("Illegal internal state");const e=this._settlers.shift();t instanceof Error?e.reject(t):e.resolve({value:t})}else this._values.push(t)}close(){for(;this._settlers.length>0;)this._settlers.shift().resolve({done:!0});this._closed=!0}next(){if(this._values.length>0){const t=this._values.shift();return t instanceof Error?Promise.reject(t):Promise.resolve({done:!1,value:t})}if(this._closed){if(this._settlers.length>0)throw new Error("Illegal internal state");return Promise.resolve({done:!0,value:void 0})}return new Promise(((t,e)=>{this._settlers.push({resolve:t,reject:e})}))}},W=0;async function J(t,e){if(!await N.inWorkerThread())return;const n={process:Y};N.onmessage=async(r,i)=>{try{switch(r){case"process":if(!t)throw new Error("Worker does not support atomic processing");const r=await t(i.input,i.options||{},n);N.postMessage("done",{result:r});break;case"process-in-batches":if(!e)throw new Error("Worker does not support batched processing");V=new q,H=i.options||{};const o=e(V,H,n);for await(const t of o)N.postMessage("output-batch",{result:t});N.postMessage("done",{});break;case"input-batch":V.push(i.input);break;case"input-done":V.close()}}catch(t){const e=t instanceof Error?t.message:"";N.postMessage("error",{error:e})}}}function Y(t,e={}){return new Promise(((n,r)=>{const i=W++,o=(t,e)=>{if(e.id===i)switch(t){case"done":N.removeEventListener(o),n(e.result);break;case"error":N.removeEventListener(o),r(e.error)}};N.addEventListener(o);const s={id:i,input:t,options:e};N.postMessage("process",s)}))}function X(t,e=y){m(t,"no worker provided");const n=t.version;return!(!e||!n)}var K={};async function Z(t,e=null,n={},r=null){return e&&(t=Q(t,e,n,r)),K[t]=K[t]||async function(t){if(t.endsWith("wasm"))return await async function(t){const{readFileAsArrayBuffer:e}=globalThis.loaders||{};if(v||!e||t.startsWith("http")){const e=await fetch(t);return await e.arrayBuffer()}return await e(t)}(t);if(!v)try{const{requireFromFile:e}=globalThis.loaders||{};return await(null==e?void 0:e(t))}catch(t){return console.error(t),null}if(b)return importScripts(t);return function(t,e){if(!v){const{requireFromString:n}=globalThis.loaders||{};return null==n?void 0:n(t,e)}if(b)return eval.call(globalThis,t),null;const n=document.createElement("script");n.id=e;try{n.appendChild(document.createTextNode(t))}catch(e){n.text=t}return document.body.appendChild(n),null}(await async function(t){const{readFileAsText:e}=globalThis.loaders||{};if(v||!e||t.startsWith("http")){const e=await fetch(t);return await e.text()}return await e(t)}(t),t)}(t),await K[t]}function Q(t,e,n={},r=null){if(!n.useLocalLibraries&&t.startsWith("http"))return t;r=r||t;const i=n.modules||{};return i[r]?i[r]:v?n.CDN?(m(n.CDN.startsWith("http")),`${n.CDN}/${e}@${y}/dist/libs/${r}`):b?`../src/libs/${r}`:`modules/${e}/src/libs/${r}`:`modules/${e}/dist/libs/${r}`}var $=d(n(95904),1),tt=d(n(95904),1),et={command:"",arguments:[],port:5e3,autoPort:!0,wait:2e3,onSuccess:t=>{console.log(`Started ${t.props.command}`)}},nt=class{id;props={...et};childProcess=null;port=0;successTimer;constructor({id:t="browser-driver"}={}){this.id=t}async start(t){t={...et,...t},this.props=t;const e=[...t.arguments];return this.port=Number(t.port),t.portArg&&(t.autoPort&&(this.port=await function(t=3e3){return new Promise((e=>{tt.default.exec("lsof -i -P -n | grep LISTEN",((n,r)=>{if(n)return void e(t);const i=[],o=/:(\d+) \(LISTEN\)/;r.split("\n").forEach((t=>{const e=o.exec(t);e&&i.push(Number(e[1]))}));let s=t;for(;i.includes(s);)s++;e(s)}))}))}(t.port)),e.push(t.portArg,String(this.port))),await new Promise(((n,r)=>{try{this._setTimeout((()=>{t.onSuccess&&t.onSuccess(this),n({})})),console.log(`Spawning ${t.command} ${t.arguments.join(" ")}`);const i=$.spawn(t.command,e,t.spawn);this.childProcess=i,i.stdout.on("data",(t=>{console.log(t.toString())})),i.stderr.on("data",(e=>{console.log(`Child process wrote to stderr: "${e}".`),t.ignoreStderr||(this._clearTimeout(),r(new Error(e)))})),i.on("error",(t=>{console.log(`Child process errored with ${t}`),this._clearTimeout(),r(t)})),i.on("close",(t=>{console.log(`Child process exited with ${t}`),this.childProcess=null,this._clearTimeout(),n({})}))}catch(t){r(t)}}))}async stop(){this.childProcess&&(this.childProcess.kill(),this.childProcess=null)}async exit(t=0){try{await this.stop(),i.exit(t)}catch(t){console.error(t.message||t),i.exit(1)}}_setTimeout(t){Number(this.props.wait)>0&&(this.successTimer=setTimeout(t,this.props.wait))}_clearTimeout(){this.successTimer&&clearTimeout(this.successTimer)}},rt={id:"null",name:"null",module:"worker-utils",version:y,options:{null:{}}}},28664:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(74955);function i(t){const e=r.getCoords.call(void 0,t);let n,i,o=0,s=1;for(;s<e.length;)n=i||e[0],i=e[s],o+=(i[0]-n[0])*(i[1]+n[1]),s++;return o>0}var o=i;e.booleanClockwise=i,e.default=o},76916:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(67174),i=n(28664),o=n(66030),s=n(74955),a=n(85846);function l(t,e={}){var n,i;if(e=e||{},!a.isObject.call(void 0,e))throw new Error("options is invalid");const s=null!=(n=e.mutate)&&n,l=null!=(i=e.reverse)&&i;if(!t)throw new Error("<geojson> is required");if("boolean"!=typeof l)throw new Error("<reverse> must be a boolean");if("boolean"!=typeof s)throw new Error("<mutate> must be a boolean");s||"Point"===t.type||"MultiPoint"===t.type||(t=r.clone.call(void 0,t));const c=[];switch(t.type){case"GeometryCollection":return o.geomEach.call(void 0,t,(function(t){u(t,l)})),t;case"FeatureCollection":return o.featureEach.call(void 0,t,(function(t){const e=u(t,l);o.featureEach.call(void 0,e,(function(t){c.push(t)}))})),a.featureCollection.call(void 0,c)}return u(t,l)}function u(t,e){switch("Feature"===t.type?t.geometry.type:t.type){case"GeometryCollection":return o.geomEach.call(void 0,t,(function(t){u(t,e)})),t;case"LineString":return c(s.getCoords.call(void 0,t),e),t;case"Polygon":return h(s.getCoords.call(void 0,t),e),t;case"MultiLineString":return s.getCoords.call(void 0,t).forEach((function(t){c(t,e)})),t;case"MultiPolygon":return s.getCoords.call(void 0,t).forEach((function(t){h(t,e)})),t;case"Point":case"MultiPoint":return t}}function c(t,e){i.booleanClockwise.call(void 0,t)===e&&t.reverse()}function h(t,e){i.booleanClockwise.call(void 0,t[0])!==e&&t[0].reverse();for(let n=1;n<t.length;n++)i.booleanClockwise.call(void 0,t[n])===e&&t[n].reverse()}var d=l;e.default=d,e.rewind=l},23478:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(17021),i=n(92091),o=n(78208),s=n(85846),a=n(74955);function l(t,e,n={}){const l=a.getGeom.call(void 0,t).coordinates;let u=0;for(let t=0;t<l.length&&!(e>=u&&t===l.length-1);t++){if(u>=e){const o=e-u;if(o){const e=r.bearing.call(void 0,l[t],l[t-1])-180;return i.destination.call(void 0,l[t],o,e,n)}return s.point.call(void 0,l[t])}u+=o.distance.call(void 0,l[t],l[t+1],n)}return s.point.call(void 0,l[l.length-1])}var u=l;e.along=l,e.default=u},61990:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(85846),i=n(66030);function o(t){return i.geomReduce.call(void 0,t,((t,e)=>t+function(t){let e,n=0;switch(t.type){case"Polygon":return s(t.coordinates);case"MultiPolygon":for(e=0;e<t.coordinates.length;e++)n+=s(t.coordinates[e]);return n;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}(e)),0)}function s(t){let e=0;if(t&&t.length>0){e+=Math.abs(u(t[0]));for(let n=1;n<t.length;n++)e-=Math.abs(u(t[n]))}return e}var a=r.earthRadius*r.earthRadius/2,l=Math.PI/180;function u(t){const e=t.length-1;if(e<=2)return 0;let n=0,r=0;for(;r<e;){const i=t[r],o=t[r+1===e?0:r+1],s=t[r+2>=e?(r+2)%e:r+2],a=i[0]*l,u=o[1]*l;n+=(s[0]*l-a)*Math.sin(u),r++}return n*a}var c=o;e.area=o,e.default=c},6039:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(85846);function i(t,e={}){const n=Number(t[0]),i=Number(t[1]),o=Number(t[2]),s=Number(t[3]);if(6===t.length)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");const a=[n,i],l=[n,s],u=[o,s],c=[o,i];return r.polygon.call(void 0,[[a,c,u,l,a]],e.properties,{bbox:t,id:e.id})}var o=i;e.bboxPolygon=i,e.default=o},25368:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(66030);function i(t,e={}){if(null!=t.bbox&&!0!==e.recompute)return t.bbox;const n=[1/0,1/0,-1/0,-1/0];return r.coordEach.call(void 0,t,(t=>{n[0]>t[0]&&(n[0]=t[0]),n[1]>t[1]&&(n[1]=t[1]),n[2]<t[0]&&(n[2]=t[0]),n[3]<t[1]&&(n[3]=t[1])})),n}var o=i;e.bbox=i,e.default=o},17021:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(85846),i=n(74955);function o(t,e,n={}){if(!0===n.final)return function(t,e){let n=o(e,t);return n=(n+180)%360,n}(t,e);const s=i.getCoord.call(void 0,t),a=i.getCoord.call(void 0,e),l=r.degreesToRadians.call(void 0,s[0]),u=r.degreesToRadians.call(void 0,a[0]),c=r.degreesToRadians.call(void 0,s[1]),h=r.degreesToRadians.call(void 0,a[1]),d=Math.sin(u-l)*Math.cos(h),f=Math.cos(c)*Math.sin(h)-Math.sin(c)*Math.cos(h)*Math.cos(u-l);return r.radiansToDegrees.call(void 0,Math.atan2(d,f))}var s=o;e.bearing=o,e.default=s},68081:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=(r=n(62564))&&r.__esModule?r:{default:r},o=n(74955);function s(t,e,n={}){if(!t)throw new Error("point is required");if(!e)throw new Error("polygon is required");const r=o.getCoord.call(void 0,t),s=o.getGeom.call(void 0,e),a=s.type,l=e.bbox;let u=s.coordinates;if(l&&!1===function(t,e){return e[0]<=t[0]&&e[1]<=t[1]&&e[2]>=t[0]&&e[3]>=t[1]}(r,l))return!1;"Polygon"===a&&(u=[u]);let c=!1;for(var h=0;h<u.length;++h){const t=i.default.call(void 0,r,u[h]);if(0===t)return!n.ignoreBoundary;t&&(c=!0)}return c}var a=s;e.booleanPointInPolygon=s,e.default=a},36593:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=n(38622),o=(r=n(53114))&&r.__esModule?r:{default:r},s=n(66030),a=n(39515),l=n(85846),{BufferOp:u,GeoJSONReader:c,GeoJSONWriter:h}=o.default;function d(t,e,n){var r=(n=n||{}).units||"kilometers",i=n.steps||8;if(!t)throw new Error("geojson is required");if("object"!=typeof n)throw new Error("options must be an object");if("number"!=typeof i)throw new Error("steps must be an number");if(void 0===e)throw new Error("radius is required");if(i<=0)throw new Error("steps must be greater than 0");var o=[];switch(t.type){case"GeometryCollection":return s.geomEach.call(void 0,t,(function(t){var n=f(t,e,r,i);n&&o.push(n)})),l.featureCollection.call(void 0,o);case"FeatureCollection":return s.featureEach.call(void 0,t,(function(t){var n=f(t,e,r,i);n&&s.featureEach.call(void 0,n,(function(t){t&&o.push(t)}))})),l.featureCollection.call(void 0,o)}return f(t,e,r,i)}function f(t,e,n,r){var o=t.properties||{},d="Feature"===t.type?t.geometry:t;if("GeometryCollection"===d.type){var m=[];return s.geomEach.call(void 0,t,(function(t){var i=f(t,e,n,r);i&&m.push(i)})),l.featureCollection.call(void 0,m)}var v=function(t){var e=i.center.call(void 0,t).geometry.coordinates,n=[-e[0],-e[1]];return a.geoAzimuthalEquidistant.call(void 0).rotate(n).scale(l.earthRadius)}(d),b={type:d.type,coordinates:g(d.coordinates,v)},_=(new c).read(b),A=l.radiansToLength.call(void 0,l.lengthToRadians.call(void 0,e,n),"meters"),x=u.bufferOp(_,A,r);if(!p((x=(new h).write(x)).coordinates)){var w={type:x.type,coordinates:y(x.coordinates,v)};return l.feature.call(void 0,w,o)}}function p(t){return Array.isArray(t[0])?p(t[0]):isNaN(t[0])}function g(t,e){return"object"!=typeof t[0]?e(t):t.map((function(t){return g(t,e)}))}function y(t,e){return"object"!=typeof t[0]?e.invert(t):t.map((function(t){return y(t,e)}))}var m=d;e.buffer=d,e.default=m},38622:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(25368),i=n(85846);function o(t,e={}){const n=r.bbox.call(void 0,t),o=(n[0]+n[2])/2,s=(n[1]+n[3])/2;return i.point.call(void 0,[o,s],e.properties,e)}var s=o;e.center=o,e.default=s},30035:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(85846),i=n(66030);function o(t,e={}){let n=0,o=0,s=0;return i.coordEach.call(void 0,t,(function(t){n+=t[0],o+=t[1],s++}),!0),r.point.call(void 0,[n/s,o/s],e.properties)}var s=o;e.centroid=o,e.default=s},37879:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(92091),i=n(85846);function o(t,e,n={}){const o=n.steps||64,s=n.properties?n.properties:!Array.isArray(t)&&"Feature"===t.type&&t.properties?t.properties:{},a=[];for(let i=0;i<o;i++)a.push(r.destination.call(void 0,t,e,-360*i/o,n).geometry.coordinates);return a.push(a[0]),i.polygon.call(void 0,[a],s)}var s=o;e.circle=o,e.default=s},67174:(t,e)=>{"use strict";function n(t){if(!t)throw new Error("geojson is required");switch(t.type){case"Feature":return r(t);case"FeatureCollection":return function(t){const e={type:"FeatureCollection"};return Object.keys(t).forEach((n=>{switch(n){case"type":case"features":return;default:e[n]=t[n]}})),e.features=t.features.map((t=>r(t))),e}(t);case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":return o(t);default:throw new Error("unknown GeoJSON type")}}function r(t){const e={type:"Feature"};return Object.keys(t).forEach((n=>{switch(n){case"type":case"properties":case"geometry":return;default:e[n]=t[n]}})),e.properties=i(t.properties),null==t.geometry?e.geometry=null:e.geometry=o(t.geometry),e}function i(t){const e={};return t?(Object.keys(t).forEach((n=>{const r=t[n];"object"==typeof r?null===r?e[n]=null:Array.isArray(r)?e[n]=r.map((t=>t)):e[n]=i(r):e[n]=r})),e):e}function o(t){const e={type:t.type};return t.bbox&&(e.bbox=t.bbox),"GeometryCollection"===t.type?(e.geometries=t.geometries.map((t=>o(t))),e):(e.coordinates=s(t.coordinates),e)}function s(t){const e=t;return"object"!=typeof e[0]?e.slice():e.map((t=>s(t)))}Object.defineProperty(e,"__esModule",{value:!0});var a=n;e.clone=n,e.cloneProperties=i,e.default=a},92091:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(85846),i=n(74955);function o(t,e,n,o={}){const s=i.getCoord.call(void 0,t),a=r.degreesToRadians.call(void 0,s[0]),l=r.degreesToRadians.call(void 0,s[1]),u=r.degreesToRadians.call(void 0,n),c=r.lengthToRadians.call(void 0,e,o.units),h=Math.asin(Math.sin(l)*Math.cos(c)+Math.cos(l)*Math.sin(c)*Math.cos(u)),d=a+Math.atan2(Math.sin(u)*Math.sin(c)*Math.cos(l),Math.cos(c)-Math.sin(l)*Math.sin(h)),f=r.radiansToDegrees.call(void 0,d),p=r.radiansToDegrees.call(void 0,h);return r.point.call(void 0,[f,p],o.properties)}var s=o;e.default=s,e.destination=o},84136:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=(r=n(59004))&&r.__esModule?r:{default:r},o=n(85846),s=n(66030);function a(t){const e=[];if(s.geomEach.call(void 0,t,(t=>{e.push(t.coordinates)})),e.length<2)throw new Error("Must have at least two features");const n=t.features[0].properties||{},r=i.default.difference(e[0],...e.slice(1));return 0===r.length?null:1===r.length?o.polygon.call(void 0,r[0],n):o.multiPolygon.call(void 0,r,n)}var l=a;e.default=l,e.difference=a},78208:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(74955),i=n(85846);function o(t,e,n={}){var o=r.getCoord.call(void 0,t),s=r.getCoord.call(void 0,e),a=i.degreesToRadians.call(void 0,s[1]-o[1]),l=i.degreesToRadians.call(void 0,s[0]-o[0]),u=i.degreesToRadians.call(void 0,o[1]),c=i.degreesToRadians.call(void 0,s[1]),h=Math.pow(Math.sin(a/2),2)+Math.pow(Math.sin(l/2),2)*Math.cos(u)*Math.cos(c);return i.radiansToLength.call(void 0,2*Math.atan2(Math.sqrt(h),Math.sqrt(1-h)),n.units)}var s=o;e.default=s,e.distance=o},61021:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(85846),i=n(28416),o=n(56183),s=n(74955);function a(t,e,n,a){const u=(a=a||{}).steps||64,c=a.units||"kilometers",h=a.angle||0,d=a.pivot||t,f=a.properties||{};if(!t)throw new Error("center is required");if(!e)throw new Error("xSemiAxis is required");if(!n)throw new Error("ySemiAxis is required");if(!r.isObject.call(void 0,a))throw new Error("options must be an object");if(!r.isNumber.call(void 0,u))throw new Error("steps must be a number");if(!r.isNumber.call(void 0,h))throw new Error("angle must be a number");const p=s.getCoord.call(void 0,t);if("degrees"!==c){const r=i.rhumbDestination.call(void 0,t,e,90,{units:c}),o=i.rhumbDestination.call(void 0,t,n,0,{units:c});e=s.getCoord.call(void 0,r)[0]-p[0],n=s.getCoord.call(void 0,o)[1]-p[1]}const g=[];for(let t=0;t<u;t+=1){const i=-360*t/u;let o=e*n/Math.sqrt(Math.pow(n,2)+Math.pow(e,2)*Math.pow(l(i),2)),s=e*n/Math.sqrt(Math.pow(e,2)+Math.pow(n,2)/Math.pow(l(i),2));if(i<-90&&i>=-270&&(o=-o),i<-180&&i>=-360&&(s=-s),"degrees"===c){const t=r.degreesToRadians.call(void 0,h),e=o*Math.cos(t)+s*Math.sin(t),n=s*Math.cos(t)-o*Math.sin(t);o=e,s=n}g.push([o+p[0],s+p[1]])}return g.push(g[0]),"degrees"===c?r.polygon.call(void 0,[g],f):o.transformRotate.call(void 0,r.polygon.call(void 0,[g],f),h,{pivot:d})}function l(t){const e=t*Math.PI/180;return Math.tan(e)}var u=a;e.default=u,e.ellipse=a},85846:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=6371008.8,r={centimeters:637100880,centimetres:637100880,degrees:360/(2*Math.PI),feet:20902260.511392,inches:39.37*n,kilometers:6371.0088,kilometres:6371.0088,meters:n,metres:n,miles:3958.761333810546,millimeters:6371008800,millimetres:6371008800,nauticalmiles:n/1852,radians:1,yards:6967335.223679999},i={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,nauticalmiles:2.9155334959812285e-7,millimeters:1e6,millimetres:1e6,yards:1.195990046};function o(t,e,n={}){const r={type:"Feature"};return(0===n.id||n.id)&&(r.id=n.id),n.bbox&&(r.bbox=n.bbox),r.properties=e||{},r.geometry=t,r}function s(t,e,n={}){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!y(t[0])||!y(t[1]))throw new Error("coordinates must contain numbers");return o({type:"Point",coordinates:t},e,n)}function a(t,e,n={}){for(const e of t){if(e.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(e[e.length-1].length!==e[0].length)throw new Error("First and last Position are not equivalent.");for(let t=0;t<e[e.length-1].length;t++)if(e[e.length-1][t]!==e[0][t])throw new Error("First and last Position are not equivalent.")}return o({type:"Polygon",coordinates:t},e,n)}function l(t,e,n={}){if(t.length<2)throw new Error("coordinates must be an array of two or more positions");return o({type:"LineString",coordinates:t},e,n)}function u(t,e={}){const n={type:"FeatureCollection"};return e.id&&(n.id=e.id),e.bbox&&(n.bbox=e.bbox),n.features=t,n}function c(t,e,n={}){return o({type:"MultiLineString",coordinates:t},e,n)}function h(t,e,n={}){return o({type:"MultiPoint",coordinates:t},e,n)}function d(t,e,n={}){return o({type:"MultiPolygon",coordinates:t},e,n)}function f(t,e="kilometers"){const n=r[e];if(!n)throw new Error(e+" units is invalid");return t*n}function p(t,e="kilometers"){const n=r[e];if(!n)throw new Error(e+" units is invalid");return t/n}function g(t){return t%(2*Math.PI)*180/Math.PI}function y(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}e.areaFactors=i,e.azimuthToBearing=function(t){return(t%=360)>0?t>180?t-360:t:t<-180?t+360:t},e.bearingToAzimuth=function(t){let e=t%360;return e<0&&(e+=360),e},e.convertArea=function(t,e="meters",n="kilometers"){if(!(t>=0))throw new Error("area must be a positive number");const r=i[e];if(!r)throw new Error("invalid original units");const o=i[n];if(!o)throw new Error("invalid final units");return t/r*o},e.convertLength=function(t,e="kilometers",n="kilometers"){if(!(t>=0))throw new Error("length must be a positive number");return f(p(t,e),n)},e.degreesToRadians=function(t){return t%360*Math.PI/180},e.earthRadius=n,e.factors=r,e.feature=o,e.featureCollection=u,e.geometry=function(t,e,n={}){switch(t){case"Point":return s(e).geometry;case"LineString":return l(e).geometry;case"Polygon":return a(e).geometry;case"MultiPoint":return h(e).geometry;case"MultiLineString":return c(e).geometry;case"MultiPolygon":return d(e).geometry;default:throw new Error(t+" is invalid")}},e.geometryCollection=function(t,e,n={}){return o({type:"GeometryCollection",geometries:t},e,n)},e.isNumber=y,e.isObject=function(t){return null!==t&&"object"==typeof t&&!Array.isArray(t)},e.lengthToDegrees=function(t,e){return g(p(t,e))},e.lengthToRadians=p,e.lineString=l,e.lineStrings=function(t,e,n={}){return u(t.map((t=>l(t,e))),n)},e.multiLineString=c,e.multiPoint=h,e.multiPolygon=d,e.point=s,e.points=function(t,e,n={}){return u(t.map((t=>s(t,e))),n)},e.polygon=a,e.polygons=function(t,e,n={}){return u(t.map((t=>a(t,e))),n)},e.radiansToDegrees=g,e.radiansToLength=f,e.round=function(t,e=0){if(e&&!(e>=0))throw new Error("precision must be a positive number");const n=Math.pow(10,e||0);return Math.round(t*n)/n},e.validateBBox=function(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach((t=>{if(!y(t))throw new Error("bbox must only contain numbers")}))},e.validateId=function(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof t))throw new Error("id must be a number or a string")}},74:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=n(85846),o=n(66030),s=(r=n(59004))&&r.__esModule?r:{default:r};function a(t,e={}){const n=[];if(o.geomEach.call(void 0,t,(t=>{n.push(t.coordinates)})),n.length<2)throw new Error("Must specify at least 2 geometries");const r=s.default.intersection(n[0],...n.slice(1));return 0===r.length?null:1===r.length?i.polygon.call(void 0,r[0],e.properties):i.multiPolygon.call(void 0,r,e.properties)}var l=a;e.default=l,e.intersect=a},74955:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(85846);e.collectionOf=function(t,e,n){if(!t)throw new Error("No featureCollection passed");if(!n)throw new Error(".collectionOf() requires a name");if(!t||"FeatureCollection"!==t.type)throw new Error("Invalid input to "+n+", FeatureCollection required");for(const r of t.features){if(!r||"Feature"!==r.type||!r.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!r.geometry||r.geometry.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+r.geometry.type)}},e.containsNumber=function t(e){if(e.length>1&&r.isNumber.call(void 0,e[0])&&r.isNumber.call(void 0,e[1]))return!0;if(Array.isArray(e[0])&&e[0].length)return t(e[0]);throw new Error("coordinates must only contain numbers")},e.featureOf=function(t,e,n){if(!t)throw new Error("No feature passed");if(!n)throw new Error(".featureOf() requires a name");if(!t||"Feature"!==t.type||!t.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!t.geometry||t.geometry.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+t.geometry.type)},e.geojsonType=function(t,e,n){if(!e||!n)throw new Error("type and name required");if(!t||t.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+t.type)},e.getCoord=function(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if("Feature"===t.type&&null!==t.geometry&&"Point"===t.geometry.type)return[...t.geometry.coordinates];if("Point"===t.type)return[...t.coordinates]}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return[...t];throw new Error("coord must be GeoJSON Point or an Array of numbers")},e.getCoords=function(t){if(Array.isArray(t))return t;if("Feature"===t.type){if(null!==t.geometry)return t.geometry.coordinates}else if(t.coordinates)return t.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")},e.getGeom=function(t){return"Feature"===t.type?t.geometry:t},e.getType=function(t,e){return"FeatureCollection"===t.type?"FeatureCollection":"GeometryCollection"===t.type?"GeometryCollection":"Feature"===t.type&&null!==t.geometry?t.geometry.type:t.type}},38937:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=n(85846),o=((r=n(23494))&&r.__esModule?r:{default:r}).default;function s(t,e,n={}){const{removeDuplicates:r=!0,ignoreSelfIntersections:s=!1}=n;let a=[];"FeatureCollection"===t.type?a=a.concat(t.features):"Feature"===t.type?a.push(t):"LineString"!==t.type&&"Polygon"!==t.type&&"MultiLineString"!==t.type&&"MultiPolygon"!==t.type||a.push(i.feature.call(void 0,t)),"FeatureCollection"===e.type?a=a.concat(e.features):"Feature"===e.type?a.push(e):"LineString"!==e.type&&"Polygon"!==e.type&&"MultiLineString"!==e.type&&"MultiPolygon"!==e.type||a.push(i.feature.call(void 0,e));const l=o(i.featureCollection.call(void 0,a),s);let u=[];if(r){const t={};l.forEach((e=>{const n=e.join(",");t[n]||(t[n]=!0,u.push(e))}))}else u=l;return i.featureCollection.call(void 0,u.map((t=>i.point.call(void 0,t))))}var a=s;e.default=a,e.lineIntersect=s},66030:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(85846);function i(t,e,n){if(null!==t)for(var r,o,s,a,l,u,c,h,d=0,f=0,p=t.type,g="FeatureCollection"===p,y="Feature"===p,m=g?t.features.length:1,v=0;v<m;v++){l=(h=!!(c=g?t.features[v].geometry:y?t.geometry:t)&&"GeometryCollection"===c.type)?c.geometries.length:1;for(var b=0;b<l;b++){var _=0,A=0;if(null!==(a=h?c.geometries[b]:c)){u=a.coordinates;var x=a.type;switch(d=!n||"Polygon"!==x&&"MultiPolygon"!==x?0:1,x){case null:break;case"Point":if(!1===e(u,f,v,_,A))return!1;f++,_++;break;case"LineString":case"MultiPoint":for(r=0;r<u.length;r++){if(!1===e(u[r],f,v,_,A))return!1;f++,"MultiPoint"===x&&_++}"LineString"===x&&_++;break;case"Polygon":case"MultiLineString":for(r=0;r<u.length;r++){for(o=0;o<u[r].length-d;o++){if(!1===e(u[r][o],f,v,_,A))return!1;f++}"MultiLineString"===x&&_++,"Polygon"===x&&A++}"Polygon"===x&&_++;break;case"MultiPolygon":for(r=0;r<u.length;r++){for(A=0,o=0;o<u[r].length;o++){for(s=0;s<u[r][o].length-d;s++){if(!1===e(u[r][o][s],f,v,_,A))return!1;f++}A++}_++}break;case"GeometryCollection":for(r=0;r<a.geometries.length;r++)if(!1===i(a.geometries[r],e,n))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function o(t,e){var n;switch(t.type){case"FeatureCollection":for(n=0;n<t.features.length&&!1!==e(t.features[n].properties,n);n++);break;case"Feature":e(t.properties,0)}}function s(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var n=0;n<t.features.length&&!1!==e(t.features[n],n);n++);}function a(t,e){var n,r,i,o,s,a,l,u,c,h,d=0,f="FeatureCollection"===t.type,p="Feature"===t.type,g=f?t.features.length:1;for(n=0;n<g;n++){for(a=f?t.features[n].geometry:p?t.geometry:t,u=f?t.features[n].properties:p?t.properties:{},c=f?t.features[n].bbox:p?t.bbox:void 0,h=f?t.features[n].id:p?t.id:void 0,s=(l=!!a&&"GeometryCollection"===a.type)?a.geometries.length:1,i=0;i<s;i++)if(null!==(o=l?a.geometries[i]:a))switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===e(o,d,u,c,h))return!1;break;case"GeometryCollection":for(r=0;r<o.geometries.length;r++)if(!1===e(o.geometries[r],d,u,c,h))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===e(null,d,u,c,h))return!1;d++}}function l(t,e){a(t,(function(t,n,i,o,s){var a,l=null===t?null:t.type;switch(l){case null:case"Point":case"LineString":case"Polygon":return!1!==e(r.feature.call(void 0,t,i,{bbox:o,id:s}),n,0)&&void 0}switch(l){case"MultiPoint":a="Point";break;case"MultiLineString":a="LineString";break;case"MultiPolygon":a="Polygon"}for(var u=0;u<t.coordinates.length;u++){var c={type:a,coordinates:t.coordinates[u]};if(!1===e(r.feature.call(void 0,c,i),n,u))return!1}}))}function u(t,e){l(t,(function(t,n,o){var s=0;if(t.geometry){var a=t.geometry.type;if("Point"!==a&&"MultiPoint"!==a){var l,u=0,c=0,h=0;return!1!==i(t,(function(i,a,d,f,p){if(void 0===l||n>u||f>c||p>h)return l=i,u=n,c=f,h=p,void(s=0);var g=r.lineString.call(void 0,[l,i],t.properties);if(!1===e(g,n,o,p,s))return!1;s++,l=i}))&&void 0}}}))}function c(t,e){if(!t)throw new Error("geojson is required");l(t,(function(t,n,i){if(null!==t.geometry){var o=t.geometry.type,s=t.geometry.coordinates;switch(o){case"LineString":if(!1===e(t,n,i,0,0))return!1;break;case"Polygon":for(var a=0;a<s.length;a++)if(!1===e(r.lineString.call(void 0,s[a],t.properties),n,i,a))return!1}}}))}e.coordAll=function(t){var e=[];return i(t,(function(t){e.push(t)})),e},e.coordEach=i,e.coordReduce=function(t,e,n,r){var o=n;return i(t,(function(t,r,i,s,a){o=0===r&&void 0===n?t:e(o,t,r,i,s,a)}),r),o},e.featureEach=s,e.featureReduce=function(t,e,n){var r=n;return s(t,(function(t,i){r=0===i&&void 0===n?t:e(r,t,i)})),r},e.findPoint=function(t,e){if(e=e||{},!r.isObject.call(void 0,e))throw new Error("options is invalid");var n,i=e.featureIndex||0,o=e.multiFeatureIndex||0,s=e.geometryIndex||0,a=e.coordIndex||0,l=e.properties;switch(t.type){case"FeatureCollection":i<0&&(i=t.features.length+i),l=l||t.features[i].properties,n=t.features[i].geometry;break;case"Feature":l=l||t.properties,n=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":n=t;break;default:throw new Error("geojson is invalid")}if(null===n)return null;var u=n.coordinates;switch(n.type){case"Point":return r.point.call(void 0,u,l,e);case"MultiPoint":return o<0&&(o=u.length+o),r.point.call(void 0,u[o],l,e);case"LineString":return a<0&&(a=u.length+a),r.point.call(void 0,u[a],l,e);case"Polygon":return s<0&&(s=u.length+s),a<0&&(a=u[s].length+a),r.point.call(void 0,u[s][a],l,e);case"MultiLineString":return o<0&&(o=u.length+o),a<0&&(a=u[o].length+a),r.point.call(void 0,u[o][a],l,e);case"MultiPolygon":return o<0&&(o=u.length+o),s<0&&(s=u[o].length+s),a<0&&(a=u[o][s].length-a),r.point.call(void 0,u[o][s][a],l,e)}throw new Error("geojson is invalid")},e.findSegment=function(t,e){if(e=e||{},!r.isObject.call(void 0,e))throw new Error("options is invalid");var n,i=e.featureIndex||0,o=e.multiFeatureIndex||0,s=e.geometryIndex||0,a=e.segmentIndex||0,l=e.properties;switch(t.type){case"FeatureCollection":i<0&&(i=t.features.length+i),l=l||t.features[i].properties,n=t.features[i].geometry;break;case"Feature":l=l||t.properties,n=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":n=t;break;default:throw new Error("geojson is invalid")}if(null===n)return null;var u=n.coordinates;switch(n.type){case"Point":case"MultiPoint":return null;case"LineString":return a<0&&(a=u.length+a-1),r.lineString.call(void 0,[u[a],u[a+1]],l,e);case"Polygon":return s<0&&(s=u.length+s),a<0&&(a=u[s].length+a-1),r.lineString.call(void 0,[u[s][a],u[s][a+1]],l,e);case"MultiLineString":return o<0&&(o=u.length+o),a<0&&(a=u[o].length+a-1),r.lineString.call(void 0,[u[o][a],u[o][a+1]],l,e);case"MultiPolygon":return o<0&&(o=u.length+o),s<0&&(s=u[o].length+s),a<0&&(a=u[o][s].length-a-1),r.lineString.call(void 0,[u[o][s][a],u[o][s][a+1]],l,e)}throw new Error("geojson is invalid")},e.flattenEach=l,e.flattenReduce=function(t,e,n){var r=n;return l(t,(function(t,i,o){r=0===i&&0===o&&void 0===n?t:e(r,t,i,o)})),r},e.geomEach=a,e.geomReduce=function(t,e,n){var r=n;return a(t,(function(t,i,o,s,a){r=0===i&&void 0===n?t:e(r,t,i,o,s,a)})),r},e.lineEach=c,e.lineReduce=function(t,e,n){var r=n;return c(t,(function(t,i,o,s){r=0===i&&void 0===n?t:e(r,t,i,o,s)})),r},e.propEach=o,e.propReduce=function(t,e,n){var r=n;return o(t,(function(t,i){r=0===i&&void 0===n?t:e(r,t,i)})),r},e.segmentEach=u,e.segmentReduce=function(t,e,n){var r=n,i=!1;return u(t,(function(t,o,s,a,l){r=!1===i&&void 0===n?t:e(r,t,o,s,a,l),i=!0})),r}},40533:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=Object.defineProperty,i=Object.defineProperties,o=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,u=(t,e,n)=>e in t?r(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,c=(t,e)=>{for(var n in e||(e={}))a.call(e,n)&&u(t,n,e[n]);if(s)for(var n of s(e))l.call(e,n)&&u(t,n,e[n]);return t},h=(t,e)=>i(t,o(e)),d=n(17021),f=n(78208),p=n(92091),g=n(38937),y=n(66030),m=n(85846),v=n(74955);function b(t,e,n={}){if(!t||!e)throw new Error("lines and pt are required arguments");let r=m.point.call(void 0,[1/0,1/0],{dist:1/0,index:-1,multiFeatureIndex:-1,location:-1}),i=0;return y.flattenEach.call(void 0,t,(function(t,o,s){const a=v.getCoords.call(void 0,t);for(let t=0;t<a.length-1;t++){const o=m.point.call(void 0,a[t]);o.properties.dist=f.distance.call(void 0,e,o,n);const l=m.point.call(void 0,a[t+1]);l.properties.dist=f.distance.call(void 0,e,l,n);const u=f.distance.call(void 0,o,l,n),y=Math.max(o.properties.dist,l.properties.dist),v=d.bearing.call(void 0,o,l),b=p.destination.call(void 0,e,y,v+90,n),_=p.destination.call(void 0,e,y,v-90,n),A=g.lineIntersect.call(void 0,m.lineString.call(void 0,[b.geometry.coordinates,_.geometry.coordinates]),m.lineString.call(void 0,[o.geometry.coordinates,l.geometry.coordinates]));let x;A.features.length>0&&A.features[0]&&(x=h(c({},A.features[0]),{properties:{dist:f.distance.call(void 0,e,A.features[0],n),multiFeatureIndex:s,location:i+f.distance.call(void 0,o,A.features[0],n)}})),o.properties.dist<r.properties.dist&&(r=h(c({},o),{properties:h(c({},o.properties),{index:t,multiFeatureIndex:s,location:i})})),l.properties.dist<r.properties.dist&&(r=h(c({},l),{properties:h(c({},l.properties),{index:t+1,multiFeatureIndex:s,location:i+u})})),x&&x.properties.dist<r.properties.dist&&(r=h(c({},x),{properties:h(c({},x.properties),{index:t})})),i+=u}})),r}var _=b;e.default=_,e.nearestPointOnLine=b},92024:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(78208),i=n(85846),o=n(74955),s=n(66030),a=n(51217);function l(t,e,n={}){if(n.method||(n.method="geodesic"),n.units||(n.units="kilometers"),!t)throw new Error("pt is required");if(Array.isArray(t)?t=i.point.call(void 0,t):"Point"===t.type?t=i.feature.call(void 0,t):o.featureOf.call(void 0,t,"Point","point"),!e)throw new Error("line is required");Array.isArray(e)?e=i.lineString.call(void 0,e):"LineString"===e.type?e=i.feature.call(void 0,e):o.featureOf.call(void 0,e,"LineString","line");let r=1/0;const a=t.geometry.coordinates;return s.segmentEach.call(void 0,e,(t=>{const e=t.geometry.coordinates[0],i=t.geometry.coordinates[1],o=function(t,e,n,r){const i=[n[0]-e[0],n[1]-e[1]],o=u([t[0]-e[0],t[1]-e[1]],i);if(o<=0)return c(t,e,{method:r.method,units:"degrees"});const s=u(i,i);if(s<=o)return c(t,n,{method:r.method,units:"degrees"});const a=o/s;return c(t,[e[0]+a*i[0],e[1]+a*i[1]],{method:r.method,units:"degrees"})}(a,e,i,n);o<r&&(r=o)})),i.convertLength.call(void 0,r,"degrees",n.units)}function u(t,e){return t[0]*e[0]+t[1]*e[1]}function c(t,e,n){return"planar"===n.method?a.rhumbDistance.call(void 0,t,e,n):r.distance.call(void 0,t,e,n)}var h=l;e.default=h,e.pointToLineDistance=l},11698:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(85846),i=n(74955);function o(t,e={}){const n=i.getGeom.call(void 0,t);switch(e.properties||"Feature"!==t.type||(e.properties=t.properties),n.type){case"Polygon":return s(n,e);case"MultiPolygon":return a(n,e);default:throw new Error("invalid poly")}}function s(t,e={}){return l(i.getGeom.call(void 0,t).coordinates,e.properties?e.properties:"Feature"===t.type?t.properties:{})}function a(t,e={}){const n=i.getGeom.call(void 0,t).coordinates,o=e.properties?e.properties:"Feature"===t.type?t.properties:{},s=[];return n.forEach((t=>{s.push(l(t,o))})),r.featureCollection.call(void 0,s)}function l(t,e){return t.length>1?r.multiLineString.call(void 0,t,e):r.lineString.call(void 0,t[0],e)}var u=o;e.coordsToLine=l,e.default=u,e.multiPolygonToLine=a,e.polygonToLine=o,e.singlePolygonToLine=s},72934:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(85846),i=n(74955);function o(t,e,n={}){let r;return r=n.final?s(i.getCoord.call(void 0,e),i.getCoord.call(void 0,t)):s(i.getCoord.call(void 0,t),i.getCoord.call(void 0,e)),r>180?-(360-r):r}function s(t,e){const n=r.degreesToRadians.call(void 0,t[1]),i=r.degreesToRadians.call(void 0,e[1]);let o=r.degreesToRadians.call(void 0,e[0]-t[0]);o>Math.PI&&(o-=2*Math.PI),o<-Math.PI&&(o+=2*Math.PI);const s=Math.log(Math.tan(i/2+Math.PI/4)/Math.tan(n/2+Math.PI/4)),a=Math.atan2(o,s);return(r.radiansToDegrees.call(void 0,a)+360)%360}var a=o;e.default=a,e.rhumbBearing=o},28416:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(85846),i=n(74955);function o(t,e,n,o={}){const s=e<0;let a=r.convertLength.call(void 0,Math.abs(e),o.units,"meters");s&&(a=-Math.abs(a));const l=i.getCoord.call(void 0,t),u=function(t,e,n,i){const o=e/(i=void 0===i?r.earthRadius:Number(i)),s=t[0]*Math.PI/180,a=r.degreesToRadians.call(void 0,t[1]),l=r.degreesToRadians.call(void 0,n),u=o*Math.cos(l);let c=a+u;Math.abs(c)>Math.PI/2&&(c=c>0?Math.PI-c:-Math.PI-c);const h=Math.log(Math.tan(c/2+Math.PI/4)/Math.tan(a/2+Math.PI/4)),d=Math.abs(h)>1e-11?u/h:Math.cos(a);return[(180*(s+o*Math.sin(l)/d)/Math.PI+540)%360-180,180*c/Math.PI]}(l,a,n);return u[0]+=u[0]-l[0]>180?-360:l[0]-u[0]>180?360:0,r.point.call(void 0,u,o.properties)}var s=o;e.default=s,e.rhumbDestination=o},51217:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(85846),i=n(74955);function o(t,e,n={}){const o=i.getCoord.call(void 0,t),s=i.getCoord.call(void 0,e);s[0]+=s[0]-o[0]>180?-360:o[0]-s[0]>180?360:0;const a=function(t,e,n){const i=n=void 0===n?r.earthRadius:Number(n),o=t[1]*Math.PI/180,s=e[1]*Math.PI/180,a=s-o;let l=Math.abs(e[0]-t[0])*Math.PI/180;l>Math.PI&&(l-=2*Math.PI);const u=Math.log(Math.tan(s/2+Math.PI/4)/Math.tan(o/2+Math.PI/4)),c=Math.abs(u)>1e-11?a/u:Math.cos(o);return Math.sqrt(a*a+c*c*l*l)*i}(o,s);return r.convertLength.call(void 0,a,"meters",n.units)}var s=o;e.default=s,e.rhumbDistance=o},56183:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(30035),i=n(72934),o=n(51217),s=n(28416),a=n(67174),l=n(66030),u=n(74955),c=n(85846);function h(t,e,n){if(n=n||{},!c.isObject.call(void 0,n))throw new Error("options is invalid");const h=n.pivot,d=n.mutate;if(!t)throw new Error("geojson is required");if(null==e||isNaN(e))throw new Error("angle is required");if(0===e)return t;const f=null!=h?h:r.centroid.call(void 0,t);return!1!==d&&void 0!==d||(t=a.clone.call(void 0,t)),l.coordEach.call(void 0,t,(function(t){const n=i.rhumbBearing.call(void 0,f,t)+e,r=o.rhumbDistance.call(void 0,f,t),a=u.getCoords.call(void 0,s.rhumbDestination.call(void 0,f,r,n));t[0]=a[0],t[1]=a[1]})),t}var d=h;e.default=d,e.transformRotate=h},39504:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(67174),i=n(38622),o=n(30035),s=n(25368),a=n(72934),l=n(51217),u=n(28416),c=n(66030),h=n(85846),d=n(74955);function f(t,e,n){if(n=n||{},!h.isObject.call(void 0,n))throw new Error("options is invalid");const i=n.origin||"centroid",o=n.mutate||!1;if(!t)throw new Error("geojson required");if("number"!=typeof e||e<=0)throw new Error("invalid factor");const s=Array.isArray(i)||"object"==typeof i;return!0!==o&&(t=r.clone.call(void 0,t)),"FeatureCollection"!==t.type||s?p(t,e,i):(c.featureEach.call(void 0,t,(function(n,r){t.features[r]=p(n,e,i)})),t)}function p(t,e,n){const r="Point"===d.getType.call(void 0,t),f=function(t,e){if(null==e&&(e="centroid"),Array.isArray(e)||"object"==typeof e)return d.getCoord.call(void 0,e);const n=t.bbox?t.bbox:s.bbox.call(void 0,t,{recompute:!0}),r=n[0],a=n[1],l=n[2],u=n[3];switch(e){case"sw":case"southwest":case"westsouth":case"bottomleft":return h.point.call(void 0,[r,a]);case"se":case"southeast":case"eastsouth":case"bottomright":return h.point.call(void 0,[l,a]);case"nw":case"northwest":case"westnorth":case"topleft":return h.point.call(void 0,[r,u]);case"ne":case"northeast":case"eastnorth":case"topright":return h.point.call(void 0,[l,u]);case"center":return i.center.call(void 0,t);case void 0:case null:case"centroid":return o.centroid.call(void 0,t);default:throw new Error("invalid origin")}}(t,n);return 1===e||r||(c.coordEach.call(void 0,t,(function(t){const n=l.rhumbDistance.call(void 0,f,t),r=a.rhumbBearing.call(void 0,f,t),i=n*e,o=d.getCoords.call(void 0,u.rhumbDestination.call(void 0,f,i,r));t[0]=o[0],t[1]=o[1],3===t.length&&(t[2]*=e)})),delete t.bbox),t}var g=f;e.default=g,e.transformScale=f},52580:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(66030),i=n(85846),o=n(74955),s=n(67174),a=n(28416);function l(t,e,n,l){if(l=l||{},!i.isObject.call(void 0,l))throw new Error("options is invalid");var u=l.units,c=l.zTranslation,h=l.mutate;if(!t)throw new Error("geojson is required");if(null==e||isNaN(e))throw new Error("distance is required");if(c&&"number"!=typeof c&&isNaN(c))throw new Error("zTranslation is not a number");if(c=void 0!==c?c:0,0===e&&0===c)return t;if(null==n||isNaN(n))throw new Error("direction is required");return e<0&&(e=-e,n+=180),!1!==h&&void 0!==h||(t=s.clone.call(void 0,t)),r.coordEach.call(void 0,t,(function(t){var r=o.getCoords.call(void 0,a.rhumbDestination.call(void 0,t,e,n,{units:u}));t[0]=r[0],t[1]=r[1],c&&3===t.length&&(t[2]+=c)})),t}var u=l;e.default=u,e.transformTranslate=l},36112:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=(r=n(59004))&&r.__esModule?r:{default:r},o=n(85846),s=n(66030);function a(t,e={}){const n=[];if(s.geomEach.call(void 0,t,(t=>{n.push(t.coordinates)})),n.length<2)throw new Error("Must have at least 2 geometries");const r=i.default.union(n[0],...n.slice(1));return 0===r.length?null:1===r.length?o.polygon.call(void 0,r[0],e.properties):o.multiPolygon.call(void 0,r,e.properties)}var l=a;e.default=l,e.union=a}}]);