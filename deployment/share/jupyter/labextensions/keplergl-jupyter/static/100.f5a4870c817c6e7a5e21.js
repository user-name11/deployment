(self.webpackChunkkeplergl_jupyter=self.webpackChunkkeplergl_jupyter||[]).push([[100,7541],{96153:(e,t,r)=>{"use strict";var n=r(95709);Object.defineProperty(t,"__esModule",{value:!0}),t.insertBefore=g,t.default=void 0;var a=n(r(82274)),o=n(r(65044)),i=n(r(96220)),l=n(r(56994)),u=n(r(65611)),d=n(r(18337)),s=n(r(26396)),f=r(89840),c=r(98265),p=r(81251);function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function v(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function g(e,t,r,n){var a=e.indexOf(r);return a<0?(f.console.error("Cannot edit ".concat(t," layer shader")),e):e.slice(0,a)+n+e.slice(a)}var m=c.shadow?function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?v(Object(r),!0).forEach((function(t){(0,s.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},c.shadow):void 0;m.fs=g(m.fs,"custom shadow #1","uniform vec4 shadow_uColor;","uniform bool u_outputUniformShadow;"),m.fs=g(m.fs,"custom shadow #1","vec4 rgbaDepth = texture2D(shadowMap, position.xy);","if(u_outputUniformShadow) return 1.0;"),m.getUniforms=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=c.shadow.getUniforms(e,t);return void 0!==e.outputUniformShadow&&(r.u_outputUniformShadow=e.outputUniformShadow),r};var A=function(e){(0,l.default)(s,e);var t,r,n=(t=s,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,d.default)(t);if(r){var a=(0,d.default)(this).constructor;e=Reflect.construct(n,arguments,a)}else e=n.apply(this,arguments);return(0,u.default)(this,e)});function s(e){var t;return(0,a.default)(this,s),(t=n.call(this,e)).useOutputUniformShadow=!1,t}return(0,o.default)(s,[{key:"preRender",value:function(e,t){var r=t.layers,n=t.layerFilter,a=t.viewports,o=t.onViewportActive,i=t.views;if(this.shadow){this.shadowMatrices=this._calculateMatrices(),0===this.shadowPasses.length&&this._createShadowPasses(e),this.programManager||(this.programManager=p.ProgramManager.getDefaultProgramManager(e),m&&this.programManager.addDefaultModule(m)),this.dummyShadowMap||(this.dummyShadowMap=new p.Texture2D(e,{width:1,height:1}));for(var l=0;l<this.shadowPasses.length;l++)this.shadowPasses[l].render({layers:r,layerFilter:n,viewports:a,onViewportActive:o,views:i,moduleParameters:{shadowLightId:l,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices,useOutputUniformShadow:!1}})}}},{key:"getModuleParameters",value:function(e){var t=(0,i.default)((0,d.default)(s.prototype),"getModuleParameters",this).call(this,e);return t.outputUniformShadow=this.outputUniformShadow,t}},{key:"cleanup",value:function(){var e,t=function(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return y(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?y(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return i=e.done,e},e:function(e){l=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(l)throw o}}}}(this.shadowPasses);try{for(t.s();!(e=t.n()).done;)e.value.delete()}catch(e){t.e(e)}finally{t.f()}this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.delete(),this.dummyShadowMap=null),this.shadow&&this.programManager&&(this.programManager.removeDefaultModule(m),this.programManager=null)}}]),s}(c.LightingEffect);t.default=A},72076:(e,t,r)=>{"use strict";var n=r(95709);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.Effect=void 0;var a=n(r(82274)),o=n(r(65044)),i=n(r(26396)),l=r(77244),u=r(13848);function d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?d(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var f=function(){function e(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,a.default)(this,e),(0,i.default)(this,"id",void 0),(0,i.default)(this,"type",void 0),(0,i.default)(this,"isEnabled",void 0),(0,i.default)(this,"parameters",void 0),(0,i.default)(this,"isConfigActive",void 0),(0,i.default)(this,"isJsonEditorActive",void 0),(0,i.default)(this,"deckEffect",void 0),(0,i.default)(this,"_uiConfig",void 0),this.id=r.id||"e_".concat((0,l.generateHashId)(6));var n=this.getDefaultProps(r);this.type=n.type,this.isEnabled=n.isEnabled,this.isConfigActive=n.isConfigActive,this.isJsonEditorActive=n.isJsonEditorActive,this._uiConfig=u.LIGHT_AND_SHADOW_EFFECT.type===this.type?u.LIGHT_AND_SHADOW_EFFECT.parameters:(null===(t=u.POSTPROCESSING_EFFECTS[this.type])||void 0===t?void 0:t.parameters)||[],this.parameters=(0,l.validateEffectParameters)(n.parameters,this._uiConfig),this.deckEffect=null,this._initializeEffect()}return(0,o.default)(e,[{key:"_initializeEffect",value:function(){}},{key:"getDefaultProps",value:function(){var e,t,r,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{id:n.id||"e_".concat((0,l.generateHashId)(6)),type:n.type||u.DEFAULT_POST_PROCESSING_EFFECT_TYPE,isEnabled:null===(e=n.isEnabled)||void 0===e||e,isConfigActive:null===(t=n.isConfigActive)||void 0===t||t,isJsonEditorActive:null!==(r=n.isJsonEditorActive)&&void 0!==r&&r,parameters:s({},n.parameters)}}},{key:"setProps",value:function(e){var t,r,n,a,o;this.id=null!==(t=e.id)&&void 0!==t?t:this.id,this.type=null!==(r=e.type)&&void 0!==r?r:this.type,this.isEnabled=null!==(n=e.isEnabled)&&void 0!==n?n:this.isEnabled,this.isConfigActive=null!==(a=e.isConfigActive)&&void 0!==a?a:this.isConfigActive,this.isJsonEditorActive=null!==(o=e.isJsonEditorActive)&&void 0!==o?o:this.isJsonEditorActive,this.parameters=s(s({},this.parameters),(0,l.validateEffectParameters)(e.parameters,this._uiConfig))}},{key:"isValidToSave",value:function(){return Boolean(this.type&&this.id&&this.deckEffect)}},{key:"getParameterDescriptions",value:function(){return this._uiConfig||[]}}]),e}();t.Effect=f;var c=f;t.default=c},18761:(e,t,r)=>{"use strict";var n=r(95709);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"Effect",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(t,"createEffect",{enumerable:!0,get:function(){return o.createEffect}});var a=n(r(72076)),o=r(59780)},65571:(e,t,r)=>{"use strict";var n=r(95709);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(r(21259)),o=n(r(82274)),i=n(r(65044)),l=n(r(96220)),u=n(r(56994)),d=n(r(65611)),s=n(r(18337)),f=n(r(26396)),c=r(98265),p=n(r(84743)),y=r(13848),v=r(77244),g=n(r(72076)),m=n(r(96153));function A(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?A(Object(r),!0).forEach((function(t){(0,f.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):A(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var T=_(_({},y.LIGHT_AND_SHADOW_EFFECT),{},{class:null}),h=function(e){(0,u.default)(f,e);var t,r,n=(t=f,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,s.default)(t);if(r){var a=(0,s.default)(this).constructor;e=Reflect.construct(n,arguments,a)}else e=n.apply(this,arguments);return(0,d.default)(this,e)});function f(e){return(0,o.default)(this,f),n.call(this,e)}return(0,i.default)(f,[{key:"_initializeEffect",value:function(){this.parameters=_(_({},y.DEFAULT_LIGHT_AND_SHADOW_PROPS),{},{timezone:p.default.tz.guess(!0)},this.parameters);var e=this.parameters,t=new c.AmbientLight({color:e.ambientLightColor,intensity:e.ambientLightIntensity}),r=new c._SunLight({timestamp:e.timestamp,color:e.sunLightColor,intensity:e.sunLightIntensity,_shadow:!0});this.deckEffect=new m.default({ambientLight:t,sunLight:r}),this.deckEffect&&(this.deckEffect.shadowColor=[].concat((0,a.default)((0,v.normalizeColor)(e.shadowColor)),[e.shadowIntensity]))}},{key:"getDefaultProps",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,l.default)((0,s.default)(f.prototype),"getDefaultProps",this).call(this,_({type:T.type},e))}},{key:"setProps",value:function(e){if((0,l.default)((0,s.default)(f.prototype),"setProps",this).call(this,e),e.parameters){var t=this.parameters;if(this.type===T.type){var r=this.deckEffect;if(r){r.shadowColor=[].concat((0,a.default)((0,v.normalizeColor)(t.shadowColor)),[t.shadowIntensity]),r.ambientLight.intensity=t.ambientLightIntensity,r.ambientLight.color=t.ambientLightColor.slice();var n=r.directionalLights[0];n&&(n.intensity=t.sunLightIntensity,n.color=t.sunLightColor.slice(),n.timestamp=t.timestamp)}}}}}]),f}(g.default);t.default=h},52061:(e,t,r)=>{"use strict";var n=r(95709);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.getDefaultValueForParameter=void 0;var a=n(r(82274)),o=n(r(65044)),i=n(r(96220)),l=n(r(56994)),u=n(r(65611)),d=n(r(18337)),s=n(r(26396)),f=r(98265),c=r(87883),p=r(13848),y=n(r(72076));function v(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function g(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?v(Object(r),!0).forEach((function(t){(0,s.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var m=[g(g({},p.POSTPROCESSING_EFFECTS.ink),{},{class:c.ink}),g(g({},p.POSTPROCESSING_EFFECTS.brightnessContrast),{},{class:c.brightnessContrast}),g(g({},p.POSTPROCESSING_EFFECTS.hueSaturation),{},{class:c.hueSaturation}),g(g({},p.POSTPROCESSING_EFFECTS.vibrance),{},{class:c.vibrance}),g(g({},p.POSTPROCESSING_EFFECTS.sepia),{},{class:c.sepia}),g(g({},p.POSTPROCESSING_EFFECTS.dotScreen),{},{class:c.dotScreen}),g(g({},p.POSTPROCESSING_EFFECTS.colorHalftone),{},{class:c.colorHalftone}),g(g({},p.POSTPROCESSING_EFFECTS.noise),{},{class:c.noise}),g(g({},p.POSTPROCESSING_EFFECTS.triangleBlur),{},{class:c.triangleBlur}),g(g({},p.POSTPROCESSING_EFFECTS.zoomBlur),{},{class:c.zoomBlur}),g(g({},p.POSTPROCESSING_EFFECTS.tiltShift),{},{class:c.tiltShift}),g(g({},p.POSTPROCESSING_EFFECTS.edgeWork),{},{class:c.edgeWork}),g(g({},p.POSTPROCESSING_EFFECTS.vignette),{},{class:c.vignette}),g(g({},p.POSTPROCESSING_EFFECTS.magnify),{},{class:c.magnify}),g(g({},p.POSTPROCESSING_EFFECTS.hexagonalPixelate),{},{class:c.hexagonalPixelate})],A=function(e,t,r){var n,a,o,i=t.find((function(t){return t.name===e})),l=r[e];return null!==(n=null!==(a=null!==(o=null==i?void 0:i.defaultValue)&&void 0!==o?o:null==l?void 0:l.value)&&void 0!==a?a:l)&&void 0!==n?n:null==i?void 0:i.min};t.getDefaultValueForParameter=A;var _=function(e){(0,l.default)(s,e);var t,r,n=(t=s,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,d.default)(t);if(r){var a=(0,d.default)(this).constructor;e=Reflect.construct(n,arguments,a)}else e=n.apply(this,arguments);return(0,u.default)(this,e)});function s(e){return(0,a.default)(this,s),n.call(this,e)}return(0,o.default)(s,[{key:"_initializeEffect",value:function(){var e=this,t=m.find((function(t){return t.type===e.type}));if(t){var r,n;this.deckEffect=new f.PostProcessEffect(t.class,this.parameters);var a=null===(r=this.deckEffect)||void 0===r||null===(n=r.module)||void 0===n?void 0:n.uniforms;if(a){var o,i=Object.keys(a),l={};i.forEach((function(t){l[t]=A(t,e._uiConfig,a)})),this.parameters=g(g({},l),this.parameters),null===(o=this.deckEffect)||void 0===o||o.setProps(this.parameters)}}}},{key:"getDefaultProps",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,i.default)((0,d.default)(s.prototype),"getDefaultProps",this).call(this,g({type:p.DEFAULT_POST_PROCESSING_EFFECT_TYPE},e))}},{key:"setProps",value:function(e){var t;(0,i.default)((0,d.default)(s.prototype),"setProps",this).call(this,e),e.parameters&&(null===(t=this.deckEffect)||void 0===t||t.setProps(this.parameters))}}]),s}(y.default);t.default=_},59780:(e,t,r)=>{"use strict";var n=r(95709);Object.defineProperty(t,"__esModule",{value:!0}),t.createEffect=function(e){return(null==e?void 0:e.type)===a.LIGHT_AND_SHADOW_EFFECT.type?new o.default(e):new i.default(e)};var a=r(13848),o=n(r(65571)),i=n(r(52061))},27452:(e,t,r)=>{"use strict";var n=r(95709);Object.defineProperty(t,"__esModule",{value:!0}),t.replaceDataInMapUpdater=t.toggleSplitMapUpdater=t.combinedLayerTypeChangeUpdater=t.combinedMapStyleChangeUpdater=t.addDataToMapComposed=t.loadFilesSuccessUpdater=t.addDataToMapUpdater=t.defaultAddDataToMapOptions=t.isValidConfig=void 0;var a=n(r(26396)),o=r(4719),i=r(59254),l=r(57601),u=r(76081),d=r(6014),s=r(75544),f=r(77244),c=r(66698),p=r(13848);function y(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function v(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?y(Object(r),!0).forEach((function(t){(0,a.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var g=function(e){return(0,f.isPlainObject)(e)&&(0,f.isPlainObject)(e.config)&&e.version};t.isValidConfig=g;var m={centerMap:!0,keepExistingConfig:!1,autoCreateLayers:!0,autoCreateTooltips:!0};t.defaultAddDataToMapOptions=m;var A=function(e,t){var r,n,a,d=t.payload,f=d.datasets,p=d.config,y=d.info,A=v(v({},m),d.options);if(Array.isArray(f)&&"arrow"===(null===(r=f[0])||void 0===r?void 0:r.info.format)&&(null===(n=f[0])||void 0===n?void 0:n.info.id)&&(null===(a=f[0])||void 0===a?void 0:a.info.id)in e.visState.datasets)return(0,s.compose_)([(0,s.pick_)("visState")((0,s.apply_)(i.updateVisDataUpdater,{datasets:f,options:A,config:p}))])(e);var _=p;g(p)&&(_=e.visState.schema.parseSavedConfig(p));var T=e.visState.layers,h=function(e){return A.centerMap&&(0,c.findMapBounds)(e)||void 0};return(0,s.compose_)([(0,s.pick_)("visState")((0,s.apply_)(i.updateVisDataUpdater,{datasets:f,options:A,config:_})),(0,s.if_)(Boolean(y),(0,s.pick_)("visState")((0,s.apply_)(i.setMapInfoUpdater,{info:y}))),(0,s.with_)((function(e){var t,r=e.visState;return(0,s.pick_)("mapState")((0,s.apply_)(l.receiveMapConfigUpdater,(0,s.payload_)({config:_,options:A,bounds:h((t=r.layers,t.filter((function(e){return!T.find((function(t){return t===e}))}))))})))})),(0,s.pick_)("mapStyle")((0,s.apply_)(u.receiveMapConfigUpdater,(0,s.payload_)({config:_,options:A}))),(0,s.pick_)("uiState")((0,s.apply_)(o.loadFilesSuccessUpdater,(0,s.payload_)(null))),(0,s.pick_)("uiState")((0,s.apply_)(o.toggleModalUpdater,(0,s.payload_)(null))),(0,s.pick_)("uiState")((0,s.merge_)(A.hasOwnProperty("readOnly")?{readOnly:A.readOnly}:{}))])(e)};t.addDataToMapUpdater=A,t.loadFilesSuccessUpdater=function(e,t){var r=(0,d.filesToDataPayload)(t.result),n=(0,s.compose_)([(0,s.pick_)("visState")((0,s.merge_)({fileLoading:!1,fileLoadingProgress:{}}))])(e);return(0,s.compose_)(r.map((function(e){return(0,s.apply_)(A,(0,s.payload_)(e))})))(n)};var _=A;t.addDataToMapComposed=_;var T=function(e){return function(t){return t.overlayBlending!==p.OVERLAY_BLENDINGS.normal.value?v(v({},t),{},{overlayBlending:e}):t}},h=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return function(r){return v(v({},r),{},{layers:r.layers.map((function(r){if((!t||r.id===t)&&r.visConfigSettings.hasOwnProperty("darkBaseMapEnabled")){var n=r.config.visConfig;return r.updateLayerConfig({visConfig:v(v({},n),{},{darkBaseMapEnabled:e})})}return r}))})}};t.combinedMapStyleChangeUpdater=function(e,t){var r=t.payload,n=e.mapStyle,a=function(e){var t;return null===(t=n.mapStyles[e])||void 0===t?void 0:t.colorMode},o=a(n.styleType),i=a(r.styleType),l=e.visState;if(i!==o)switch(i){case p.BASE_MAP_COLOR_MODES.DARK:l=(0,s.compose_)([T(p.OVERLAY_BLENDINGS.screen.value),h(!0)])(l);break;case p.BASE_MAP_COLOR_MODES.LIGHT:l=(0,s.compose_)([T(p.OVERLAY_BLENDINGS.darken.value),h(!1)])(l)}return v(v({},e),{},{visState:l,mapStyle:(0,u.mapStyleChangeUpdater)(n,{payload:v({},r)})})},t.combinedLayerTypeChangeUpdater=function(e,t){var r=e.visState,n=r.layers.findIndex((function(e){return e===t.oldLayer})),a=(r=(0,i.layerTypeChangeUpdater)(r,t)).layers[n];if(null!=a&&a.visConfigSettings.hasOwnProperty("darkBaseMapEnabled")){var o=e.mapStyle,l=o.mapStyles[o.styleType].colorMode,u=a.config.visConfig.darkBaseMapEnabled;switch(l){case p.BASE_MAP_COLOR_MODES.DARK:u||(r=h(!0,a.id)(r));break;case p.BASE_MAP_COLOR_MODES.LIGHT:u&&(r=h(!1,a.id)(r))}}return v(v({},e),{},{visState:r})},t.toggleSplitMapUpdater=function(e,t){var r,n,a=v(v({},e),{},{visState:(0,i.toggleSplitMapUpdater)(e.visState,t),uiState:(0,o.toggleSplitMapUpdater)(e.uiState),mapState:(0,l.toggleSplitMapUpdater)(e.mapState,t)}),u=0!==a.visState.splitMaps.length,d=null===(r=a.uiState.mapControls)||void 0===r||null===(n=r.mapLegend)||void 0===n?void 0:n.active;return u&&!d&&(a.uiState=(0,o.toggleMapControlUpdater)(a.uiState,{payload:{panelId:"mapLegend",index:t.payload}})),a};var P={keepExistingConfig:!0,centerMap:!0,autoCreateLayers:!1};t.replaceDataInMapUpdater=function(e,t){var r=t.payload,n=r.datasetToReplaceId,a=r.datasetToUse,o=r.options,l=void 0===o?{}:o,u=v(v({},P),l);if(!e.visState.datasets[n])return e;var d=a.info.id;if(!d)return e;var f=v(v({},e),{},{visState:(0,i.prepareStateForDatasetReplace)(e.visState,n,d)});return A(f,(0,s.payload_)({datasets:a,options:u}))}},75544:(e,t,r)=>{"use strict";var n=r(95709);Object.defineProperty(t,"__esModule",{value:!0}),t.log=function(e){return function(t){return i.default.log(e,t)}},t.payload_=function(e){return{payload:e}},t.apply_=function(e,t){return function(r){return e(r,t)}},t.with_=function(e){return function(t){return e(t)(t)}},t.if_=function(e,t){return e?t:d},t.compose_=function(e){return function(t){return e.reduce((function(e,t){return t(e)}),t)}},t.merge_=function(e){return function(t){return u(u({},t),e)}},t.pick_=function(e){return function(t){return function(r){return u(u({},r),{},(0,o.default)({},e,t(r[e])))}}},t.swap_=function(e){return function(t){return t.map((function(t){return t.id===e.id?e:t}))}},t.map_=function(e){return function(t){return t.map((function(t){return e(t)}))}},t.filterOutById=function(e){return function(t){return t.filter((function(t){return t.id!==e}))}},t.removeElementAtIndex=function(e){return function(t){return[].concat((0,a.default)(t.slice(0,e)),(0,a.default)(t.slice(e+1,t.length)))}};var a=n(r(21259)),o=n(r(26396)),i=n(r(45439));function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){(0,o.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var d=function(e){return e}},47491:(e,t,r)=>{"use strict";var n=r(95709),a=r(58784);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,i=n(r(26396)),l=r(99150),u=a(r(27452)),d=(o={},(0,i.default)(o,l.ActionTypes.ADD_DATA_TO_MAP,u.addDataToMapUpdater),(0,i.default)(o,l.ActionTypes.MAP_STYLE_CHANGE,u.combinedMapStyleChangeUpdater),(0,i.default)(o,l.ActionTypes.LAYER_TYPE_CHANGE,u.combinedLayerTypeChangeUpdater),(0,i.default)(o,l.ActionTypes.LOAD_FILES_SUCCESS,u.loadFilesSuccessUpdater),(0,i.default)(o,l.ActionTypes.TOGGLE_SPLIT_MAP,u.toggleSplitMapUpdater),(0,i.default)(o,l.ActionTypes.REPLACE_DATA_IN_MAP,u.replaceDataInMapUpdater),o);t.default=d},5133:(e,t,r)=>{"use strict";var n=r(95709);Object.defineProperty(t,"__esModule",{value:!0}),t.providerStateLens=t.uiStateLens=t.visStateLens=t.mapStyleLens=t.mapStateLens=t.default=t.coreReducerFactory=void 0;var a=n(r(26396)),o=r(88517),i=r(59278),l=r(92166),u=r(71190),d=r(70648),s=r(38655),f=n(r(47491));function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(r,n){return f.default[n.type]?f.default[n.type](r,n):function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,o.combineReducers)(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){(0,a.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({visState:(0,i.visStateReducerFactory)(e.visState),mapState:(0,l.mapStateReducerFactory)(e.mapState),mapStyle:(0,u.mapStyleReducerFactory)(e.mapStyle),uiState:(0,d.uiStateReducerFactory)(e.uiState),providerState:(0,s.providerStateReducerFactory)(e.providerState)},t))}(e,t)(r,n)}};t.coreReducerFactory=p;var y=p();t.default=y,t.mapStateLens=function(e){return{mapState:e.mapState}},t.mapStyleLens=function(e){return{mapStyle:e.mapStyle}},t.visStateLens=function(e){return{visState:e.visState}},t.uiStateLens=function(e){return{uiState:e.uiState}},t.providerStateLens=function(e){return{providerState:e.providerState}}},66698:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.findMapBounds=function(e){var t=e.reduce((function(e,t){return t.meta&&t.meta.bounds&&e.push(t.meta.bounds),e}),[]);return 0===t.length?null:t.reduce((function(e,t){return[Math.min(e[0],t[0]),Math.min(e[1],t[1]),Math.max(e[2],t[2]),Math.max(e[3],t[3])]}),[a,r,o,n])};var r=90,n=-90,a=180,o=-180},18552:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.exportData=u,t.formatCsv=d,t.default=void 0;var n=r(89840),a=r(62085),o=r(13848),i=r(77244);function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function u(e,t){var r=e.visState,a=e.appName,l=r.datasets,u=t.selectedDataset,s=t.dataType,f=t.filtered,c=a||i.DEFAULT_DATA_NAME,p=l[u]?[l[u]]:Object.values(l);p.length&&p.forEach((function(e){var t=e,r=t.dataContainer,a=t.fields,l=t.label,u=t.filteredIdxCPU,p=void 0===u?[]:u,y=f?(0,i.createIndexedDataContainer)(r,p):r;if(s===o.EXPORT_DATA_TYPE.CSV){var v=d(y,a),g=new n.Blob([v],{type:"text/csv"});(0,i.downloadFile)(g,"".concat(c,"_").concat(l,".csv"))}}))}function d(e,t){var r,n=[t.map((function(e){return e.displayName||e.name}))],o=function(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return l(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?l(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,u=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return i=e.done,e},e:function(e){u=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(u)throw o}}}}(e.rows(!0));try{for(o.s();!(r=o.n()).done;){var u=r.value;n.push(u.map((function(e,r){return(0,i.parseFieldValue)(e,t[r].type)})))}}catch(e){o.e(e)}finally{o.f()}return(0,a.csvFormatRows)(n)}var s={exportData:u};t.default=s},70100:(e,t,r)=>{"use strict";var n=r(58784),a=r(95709);Object.defineProperty(t,"__esModule",{value:!0});var o={keplerGlReducer:!0,keplerGlReducerCore:!0,visStateLens:!0,mapStateLens:!0,uiStateLens:!0,mapStyleLens:!0,visStateReducer:!0,mapStateReducer:!0,uiStateReducer:!0,mapStyleReducer:!0,providerReducer:!0,visStateUpdaters:!0,fitBoundsUpdater:!0,pickViewportPropsFromMapState:!0,INITIAL_MAP_STATE:!0,mapStateUpdaters:!0,getInitialInputStyle:!0,loadMapStylesUpdater:!0,INITIAL_MAP_STYLE:!0,mapStyleUpdaters:!0,INITIAL_UI_STATE:!0,uiStateUpdaters:!0,addDataToMapUpdater:!0,replaceDataInMapUpdater:!0,combineUpdaters:!0,combinedUpdaters:!0,visStateMergers:!0,providerStateUpdaters:!0,enhanceReduxMiddleware:!0};Object.defineProperty(t,"default",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(t,"keplerGlReducer",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(t,"keplerGlReducerCore",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(t,"visStateLens",{enumerable:!0,get:function(){return l.visStateLens}}),Object.defineProperty(t,"mapStateLens",{enumerable:!0,get:function(){return l.mapStateLens}}),Object.defineProperty(t,"uiStateLens",{enumerable:!0,get:function(){return l.uiStateLens}}),Object.defineProperty(t,"mapStyleLens",{enumerable:!0,get:function(){return l.mapStyleLens}}),Object.defineProperty(t,"visStateReducer",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(t,"mapStateReducer",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(t,"uiStateReducer",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(t,"mapStyleReducer",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(t,"providerReducer",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(t,"fitBoundsUpdater",{enumerable:!0,get:function(){return y.fitBoundsUpdater}}),Object.defineProperty(t,"pickViewportPropsFromMapState",{enumerable:!0,get:function(){return y.pickViewportPropsFromMapState}}),Object.defineProperty(t,"INITIAL_MAP_STATE",{enumerable:!0,get:function(){return y.INITIAL_MAP_STATE}}),Object.defineProperty(t,"getInitialInputStyle",{enumerable:!0,get:function(){return v.getInitialInputStyle}}),Object.defineProperty(t,"loadMapStylesUpdater",{enumerable:!0,get:function(){return v.loadMapStylesUpdater}}),Object.defineProperty(t,"INITIAL_MAP_STYLE",{enumerable:!0,get:function(){return v.INITIAL_MAP_STYLE}}),Object.defineProperty(t,"INITIAL_UI_STATE",{enumerable:!0,get:function(){return g.INITIAL_UI_STATE}}),Object.defineProperty(t,"addDataToMapUpdater",{enumerable:!0,get:function(){return m.addDataToMapUpdater}}),Object.defineProperty(t,"replaceDataInMapUpdater",{enumerable:!0,get:function(){return m.replaceDataInMapUpdater}}),Object.defineProperty(t,"enhanceReduxMiddleware",{enumerable:!0,get:function(){return E.enhanceReduxMiddleware}}),t.providerStateUpdaters=t.visStateMergers=t.combinedUpdaters=t.combineUpdaters=t.uiStateUpdaters=t.mapStyleUpdaters=t.mapStateUpdaters=t.visStateUpdaters=void 0;var i=a(r(506)),l=n(r(5133)),u=a(r(59278)),d=n(r(92166));Object.keys(d).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(o,e)||e in t&&t[e]===d[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return d[e]}}))}));var s=n(r(70648));Object.keys(s).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(o,e)||e in t&&t[e]===s[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return s[e]}}))}));var f=a(r(71190)),c=n(r(38655));Object.keys(c).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(o,e)||e in t&&t[e]===c[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return c[e]}}))}));var p=n(r(59254));t.visStateUpdaters=p,Object.keys(p).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(o,e)||e in t&&t[e]===p[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return p[e]}}))}));var y=n(r(57601));t.mapStateUpdaters=y;var v=n(r(76081));t.mapStyleUpdaters=v;var g=n(r(4719));t.uiStateUpdaters=g;var m=n(r(27452));t.combineUpdaters=m,t.combinedUpdaters=m;var A=n(r(91978));t.visStateMergers=A,Object.keys(A).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(o,e)||e in t&&t[e]===A[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return A[e]}}))}));var _=r(77669);Object.keys(_).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(o,e)||e in t&&t[e]===_[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return _[e]}}))}));var T=n(r(96750));t.providerStateUpdaters=T,Object.keys(T).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(o,e)||e in t&&t[e]===T[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return T[e]}}))}));var h=r(75544);Object.keys(h).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(o,e)||e in t&&t[e]===h[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return h[e]}}))}));var P=r(66698);Object.keys(P).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(o,e)||e in t&&t[e]===P[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return P[e]}}))}));var b=r(18552);Object.keys(b).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(o,e)||e in t&&t[e]===b[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return b[e]}}))}));var S=r(52819);Object.keys(S).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(o,e)||e in t&&t[e]===S[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return S[e]}}))}));var O=r(95937);Object.keys(O).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(o,e)||e in t&&t[e]===O[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return O[e]}}))}));var E=r(94138)},52819:(e,t,r)=>{"use strict";var n=r(95709);Object.defineProperty(t,"__esModule",{value:!0}),t.findFieldsToShow=function(e){var t=e.fields,r=e.id,n=e.maxDefaultTooltips,l=i.DEFAULT_TOOLTIP_FIELDS.reduce((function(e,r){return t.find((function(e){var t=e.name;return r.name===t}))&&e.push(r),e}),[]);return(0,o.default)({},r,l.length?l:function(e,t){var r=i.TRIP_POINT_FIELDS.reduce((function(e,t){return[].concat((0,a.default)(e),(0,a.default)(t))}),[]);return e.filter((function(e){var t=e.name,n=e.type;return t.replace(/[_,.]+/g," ").trim().split(" ").every((function(e){return!r.includes(e)}))&&n!==i.ALL_FIELD_TYPES.geojson&&n!==i.ALL_FIELD_TYPES.geoarrow&&"object"!==n})).slice(0,t).map((function(e){return{name:e.name,format:null}}))}(t,n))},t.getTooltipDisplayDeltaValue=function(e){var t=e.primaryData,r=e.field,n=e.compareType,a=e.data,o=e.fieldIdx,s=null;if(t&&(r.type===i.ALL_FIELD_TYPES.integer||r.type===i.ALL_FIELD_TYPES.real)){var f=t.valueAt(o),c=a.valueAt(o);if((0,l.isNumber)(f)&&(0,l.isNumber)(c)){var p=n===i.COMPARE_TYPES.RELATIVE?c/f-1:c-f,y=n===i.COMPARE_TYPES.RELATIVE?i.TOOLTIP_FORMATS.DECIMAL_PERCENT_FULL_2[i.TOOLTIP_KEY]:r.displayFormat||i.TOOLTIP_FORMATS.DECIMAL_DECIMAL_FIXED_3[i.TOOLTIP_KEY];s=(0,l.getFormatter)(y,r)(p);var v=(s=(0,l.defaultFormatter)(s)).charAt(0);"+"===v||d.includes(v)||(s="+".concat(s))}else s=u}return s},t.getTooltipDisplayValue=function(e){var t=e.item,r=e.field,n=e.value;return(0,l.notNullorUndefined)(n)?null!=t&&t.format?(0,l.getFormatter)(null==t?void 0:t.format,r)(n):r.displayFormat?(0,l.getFormatter)(r.displayFormat,r)(n):(0,l.parseFieldValue)(n,r.type):""},t.BRUSH_CONFIG=t.NEGATIVE_SIGNS=t.TOOLTIP_MINUS_SIGN=void 0;var a=n(r(21259)),o=n(r(26396)),i=r(13848),l=r(77244),u="−";t.TOOLTIP_MINUS_SIGN=u;var d=["-","−"];t.NEGATIVE_SIGNS=d,t.BRUSH_CONFIG={range:[0,50]}},95937:(e,t,r)=>{"use strict";var n=r(95709);Object.defineProperty(t,"__esModule",{value:!0}),t.findDefaultLayer=function(e,t){return e?Object.keys(t).reduce((function(r,n){var a="function"==typeof t[n].findDefaultLayerProps?t[n].findDefaultLayerProps(e,r):{props:[]},o=Array.isArray(a)?a:a.props||[];return(a.foundLayers||r).concat(o.map((function(t){return p(p({},t),{},{type:n,dataId:e.id})})))}),[]).map((function(r){var n=new t[r.type](r);return"function"==typeof n.setInitialLayerConfig&&e.dataContainer?n.setInitialLayerConfig(e):n})):[]},t.calculateLayerData=function(e,t,r){var n;try{if(e.isValid||(e._oldDataUpdateTriggers=void 0),!e.type||!e.hasAllColumns()||!e.config.dataId)return{layer:e,layerData:{}};n=e.formatLayerData(t.datasets,r),e.isValid||(e=e.updateLayerConfig({isVisible:!0})),e.isValid=!0,e.errorMessage=null}catch(t){(e=e.updateLayerConfig({isVisible:!1})).isValid=!1,e.errorMessage=t instanceof Error&&t.message?t.message.substring(0,100):"Unknown error",n={}}return{layer:e,layerData:n}},t.getLayerHoverProp=function(e){var t=e.interactionConfig,r=e.hoverInfo,n=e.layers,a=e.layersToRender,o=e.datasets;if(t.tooltip.enabled&&r&&r.picked){var i=r.object,l=n[r.layer.props.idx];if((i||r.index>=0)&&l&&l.getHoverData&&a[l.id]){var u=l.config.dataId;if(!u)return null;var d=o[u],s=d.dataContainer,f=d.fields,c=l.getHoverData(i||r.index,s,f);return c?{data:c,fields:f,fieldsToShow:t.tooltip.config.fieldsToShow[u],layer:l}:null}}return null},t.renderDeckGlLayer=y,t.isLayerRenderable=v,t.isLayerVisible=g,t.prepareLayersForDeck=m,t.prepareLayersToRender=function(e,t,r){return e.reduce((function(e,n,a){return p(p({},e),{},(0,i.default)({},n.id,v(n,t[a])&&g(n,r)))}),{})},t.getCustomDeckLayers=A,t.bindLayerCallbacks=_,t.computeDeckLayers=function(e,t,r,n){var i=e.visState,l=e.mapState,u=e.mapStyle,c=i.datasets,v=i.layers,g=i.layerOrder,T=i.layerData,h=i.hoverInfo,P=i.clicked,b=i.interactionConfig,S=i.animationConfig,O=i.splitMaps,E=t||{},x=E.mapIndex,F=E.mapboxApiAccessToken,L=E.mapboxApiUrl,I=E.primaryMap,C=E.layersForDeck,U=E.editorInfo,M=[];if(T&&T.length){var w=(0,s.getMapLayersFromSplitMaps)(O,x||0),D=C||m(v,T);M=g.slice().reverse().filter((function(e){return D[e]})).reduce((function(e,t){var n=v.findIndex((function(e){return e.id===t})),a=r?_(r,n):{},o=v[n],i=T[n],u=y({datasets:c,layer:o,layerIndex:n,data:i,hoverInfo:h,clicked:P,mapState:l,interactionConfig:b,animationConfig:S,mapLayers:w},a);return e.concat(u||[])}),[])}if(!I)return M;null!=u&&u.visibleLayerGroups["3d building"]&&I&&F&&L&&M.push(new f.ThreeDBuildingLayer({id:"_keplergl_3d-building",mapboxApiAccessToken:F,mapboxApiUrl:L,threeDBuildingColor:u.threeDBuildingColor,updateTriggers:{getFillColor:u.threeDBuildingColor}}));var N=A(n),j=(0,o.default)(N,2),R=j[0],k=j[1],Y=[];return U&&Y.push((0,d.getEditorLayer)(p({},U))),[].concat((0,a.default)(R),(0,a.default)(M),(0,a.default)(k),Y)},t.getLayerOrderFromLayers=function(e){return e.map((function(e){return e.id}))},t.reorderLayerOrder=function(e,t,r){var n=e.indexOf(t),a=e.indexOf(r);return(0,l.arrayMove)(e,n,a)},t.addLayerToLayerOrder=function(e,t){return[t].concat((0,a.default)(e))};var a=n(r(21259)),o=n(r(22056)),i=n(r(26396)),l=r(43627),u=r(13848),d=r(40441),s=r(77244),f=r(29294);function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function p(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function y(e,t){var r=e.datasets,n=e.layer,a=e.layerIndex,o=e.data,i=e.hoverInfo,l=e.clicked,u=e.mapState,d=e.interactionConfig,s=e.animationConfig,f=e.mapLayers,c=(r[n.config.dataId]||{}).gpuFilter,p=l||i,y=!f||f&&f[n.id];return n.renderLayer({data:o,gpuFilter:c,idx:a,interactionConfig:d,layerCallbacks:t,mapState:u,animationConfig:s,objectHovered:p,visible:y})}function v(e,t){return e.id!==u.GEOCODER_LAYER_ID&&e.shouldRenderLayer(t)}function g(e,t){return e.config.isVisible&&(!t||t&&t[e.id])}function m(e,t){return e.reduce((function(e,r,n){return p(p({},e),{},(0,i.default)({},r.id,v(r,t[n])&&r.overlayType===d.OVERLAY_TYPE_CONST.deckgl))}),{})}function A(e){return[Array.isArray(null==e?void 0:e.layers)?null==e?void 0:e.layers:(0,s.isFunction)(null==e?void 0:e.layers)?null==e?void 0:e.layers():[],Array.isArray(null==e?void 0:e.topLayers)?null==e?void 0:e.topLayers:(0,s.isFunction)(null==e?void 0:e.topLayers)?null==e?void 0:e.topLayers():[]]}function _(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return Object.keys(e).reduce((function(r,n){return p(p({},r),{},(0,i.default)({},n,(function(r){return e[n](t,r)})))}),{})}},57601:(e,t,r)=>{"use strict";var n=r(95709);Object.defineProperty(t,"__esModule",{value:!0}),t.getMapDimForSplitMap=m,t.pickViewportPropsFromMapState=A,t.toggleSplitMapViewportUpdater=t.toggleSplitMapUpdater=t.receiveMapConfigUpdater=t.resetMapConfigUpdater=t.togglePerspectiveUpdater=t.fitBoundsUpdater=t.updateMapUpdater=t.INITIAL_MAP_STATE=void 0;var a=n(r(22056)),o=n(r(26396)),i=n(r(26439)),l=n(r(74960)),u=n(r(6039)),d=r(649),s=n(r(14744)),f=n(r(91863)),c=r(77244);function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function y(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach((function(t){(0,o.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var v={pitch:0,bearing:0,latitude:37.75043,longitude:-122.34679,zoom:9,dragRotate:!1,width:800,height:800,minZoom:void 0,maxZoom:void 0,maxBounds:void 0,isSplit:!1,isViewportSynced:!0,isZoomLocked:!1,splitMapViewports:[]};t.INITIAL_MAP_STATE=v,t.updateMapUpdater=function(e,t){var r=t.payload,n=r.viewport,a=r.mapIndex,o=void 0===a?0:a;if(e.isViewportSynced)return T(e,n);var i=-1,l=e.splitMapViewports.map((function(e,t){return t===o?T(e,n):(i=t,e)}));return Number.isFinite(i)&&i>-1&&(l[i]=y(y({},l[i]),{},{width:l[o].width,height:l[o].height}),e.isZoomLocked&&(l[i]=y(y({},l[i]),{},{zoom:l[o].zoom}))),y(y(y({},e),l[o]),{},{splitMapViewports:l})};var g=function(e,t){var r=(0,c.getCenterAndZoomFromBounds)(t.payload,{width:e.width,height:e.height});if(!r)return e;var n=y(y({},e),{},{latitude:r.center[1],longitude:r.center[0]},Number.isFinite(r.zoom)?{zoom:r.zoom}:{});return n.splitMapViewports.length&&(n.splitMapViewports=n.splitMapViewports.map((function(e){return y(y({},e),{},{latitude:n.latitude,longitude:n.longitude,zoom:n.zoom})}))),n};function m(e,t){return t.isSplit===e?{}:{width:t.isSplit&&!e?2*t.width:t.width/2}}function A(e){return(0,f.default)(e,["width","height","zoom","pitch","bearing","latitude","longitude","dragRotate","minZoom","maxZoom","maxBounds"])}t.fitBoundsUpdater=g,t.togglePerspectiveUpdater=function(e,t){var r=y(y(y({},e),{pitch:e.dragRotate?0:50,bearing:e.dragRotate?0:24}),{},{dragRotate:!e.dragRotate});return r.splitMapViewports.length&&(r.splitMapViewports=r.splitMapViewports.map((function(e){return y(y({},e),{},{pitch:r.pitch,bearing:r.bearing,dragRotate:r.dragRotate})}))),r},t.resetMapConfigUpdater=function(e){return y(y(y({},v),e.initialState),{},{initialState:e.initialState})},t.receiveMapConfigUpdater=function(e,t){var r=t.payload,n=r.config,a=void 0===n?{}:n,o=r.options,i=void 0===o?{}:o,l=r.bounds,u=void 0===l?null:l,d=(a||{}).mapState||{},f=(0,s.default)(e,d,{arrayMerge:function(e,t){return t}});return i.centerMap&&u&&(f=g(f,{payload:u})),y(y({},f),m(f.isSplit,e))},t.toggleSplitMapUpdater=function(e,t){return y(y(y({},e),m(!e.isSplit,e)),{},{isSplit:!e.isSplit},0==!e.isSplit?{isViewportSynced:!0,isZoomLocked:!1,splitMapViewports:[]}:{})},t.toggleSplitMapViewportUpdater=function(e,t){var r=y(y({},e),t.payload||{});if(r.isViewportSynced)r.splitMapViewports=[];else{if(e.isZoomLocked&&!r.isZoomLocked)return r;if(!e.isZoomLocked&&r.isZoomLocked){var n=r.splitMapViewports.findIndex((function(e){return r.zoom===e.zoom})),a=r.splitMapViewports.map((function(e,t){return t===n?e:y(y({},e),{},{zoom:r.splitMapViewports[n].zoom})}));return r.splitMapViewports=a,r}var o=A(r),i=A(r);r.splitMapViewports=[o,i]}return r};var _=function(e){return Object.entries(e).reduce((function(e,t){var r=(0,a.default)(t,2),n=r[0],i=r[1];return y(y({},e),void 0!==i?(0,o.default)({},n,i):{})}),{})};function T(e,t){var r=y(y({},e),_(t)||{});return r.minZoom&&r.zoom&&r.zoom<r.minZoom&&(r.zoom=r.minZoom),r.maxZoom&&r.zoom&&r.zoom>r.maxZoom&&(r.zoom=r.maxZoom),r.maxBounds&&(0,c.validateBounds)(r.maxBounds)&&(r=function(e,t){var r=i.default.bounds([t.longitude,t.latitude],t.zoom,[t.width,t.height],c.MAPBOX_TILE_SIZE),n=(0,u.default)(r),a=t.maxBounds,o=(0,u.default)(a);if(!e.maxBounds||!e.maxBounds.every((function(e,t){return e===a[t]}))){if(!(0,l.default)(n,o)){var s=(0,d.fitBounds)({width:t.width,height:t.width,bounds:[[a[0],a[1]],[a[2],a[3]]]}),f=s.latitude,p=s.longitude,v=s.zoom;t=y(y({},t),{},{latitude:f,longitude:p},Number.isFinite(v)?{zoom:v}:{})}return t}return(0,l.default)(n,o)||(t=y(y({},t),{},{longitude:e.longitude,latitude:e.latitude,zoom:e.zoom})),t}(e,r)),r}},92166:(e,t,r)=>{"use strict";var n=r(95709),a=r(58784);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.mapStateReducerFactory=void 0;var o,i=n(r(26396)),l=r(19913),u=r(99150),d=a(r(57601));function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var c=(o={},(0,i.default)(o,u.ActionTypes.UPDATE_MAP,d.updateMapUpdater),(0,i.default)(o,u.ActionTypes.FIT_BOUNDS,d.fitBoundsUpdater),(0,i.default)(o,u.ActionTypes.TOGGLE_PERSPECTIVE,d.togglePerspectiveUpdater),(0,i.default)(o,u.ActionTypes.RECEIVE_MAP_CONFIG,d.receiveMapConfigUpdater),(0,i.default)(o,u.ActionTypes.RESET_MAP_CONFIG,d.resetMapConfigUpdater),(0,i.default)(o,u.ActionTypes.TOGGLE_SPLIT_MAP,d.toggleSplitMapUpdater),(0,i.default)(o,u.ActionTypes.TOGGLE_SPLIT_MAP_VIEWPORT,d.toggleSplitMapViewportUpdater),o),p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,l.handleActions)(c,f(f(f({},d.INITIAL_MAP_STATE),e),{},{initialState:e}))};t.mapStateReducerFactory=p;var y=p();t.default=y},76081:(e,t,r)=>{"use strict";var n=r(58784),a=r(95709),o=r(85735);Object.defineProperty(t,"__esModule",{value:!0}),t.getMapStyles=h,t.getInitialInputStyle=function(){return{id:null,accessToken:null,error:!1,isValid:!1,label:null,style:null,url:null,icon:null,custom:"LOCAL",uploadedFile:null}},t.setBackgroundColorUpdater=t.set3dBuildingColorUpdater=t.removeCustomMapStyleUpdater=t.editCustomMapStyleUpdater=t.addCustomMapStyleUpdater=t.inputMapStyleUpdater=t.loadCustomMapStyleUpdater=t.resetMapConfigMapStyleUpdater=t.receiveMapConfigUpdater=t.loadMapStyleErrUpdater=t.loadMapStylesUpdater=t.mapStyleChangeUpdater=t.mapConfigChangeUpdater=t.initMapStyleUpdater=t.requestMapStylesUpdater=t.INITIAL_MAP_STYLE=void 0;var i=a(r(39892)),l=a(r(26396)),u=n(r(13370)),d=a(r(67193)),s=a(r(45439)),f=r(77244),c=r(13848),p=r(16441),y=r(58330),v=r(99150);function g(e){var t=function(e){if("object"!==o(e)||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!==o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===o(t)?t:String(t)}function m(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function A(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?m(Object(r),!0).forEach((function(t){(0,l.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var _=function(){return{styleType:"dark-matter",visibleLayerGroups:{},topLayerGroups:{},mapStyles:c.DEFAULT_MAP_STYLES.reduce((function(e,t){return A(A({},e),{},(0,l.default)({},t.id,t))}),{}),mapboxApiAccessToken:null,mapboxApiUrl:c.DEFAULT_MAPBOX_API_URL,mapStylesReplaceDefault:!1,inputStyle:{id:null,accessToken:null,error:!1,isValid:!1,label:null,style:null,url:null,icon:null,custom:"LOCAL",uploadedFile:null},threeDBuildingColor:(0,f.hexToRgb)(c.DEFAULT_BLDG_COLOR),custom3DBuildingColor:!1,backgroundColor:(0,f.hexToRgb)(c.DEFAULT_BACKGROUND_COLOR),isLoading:{},bottomMapStyle:void 0,topMapStyle:void 0}},T=_();function h(e){var t=e.styleType,r=e.visibleLayerGroups,n=e.topLayerGroups,a=e.mapStyles[t];if(!a||!a.style)return{};var o=Object.keys(r).length,i=o?(0,f.editBottomMapStyle)({id:t,mapStyle:a,visibleLayerGroups:r}):a.style,u=o>0&&Object.values(n).some((function(e){return e})),d=u&&Object.keys(n).reduce((function(e,t){return A(A({},e),{},(0,l.default)({},t,n[t]&&r[t]))}),{});return{bottomMapStyle:i,topMapStyle:u?(0,f.editTopMapStyle)({id:t,mapStyle:a,visibleLayerGroups:d}):null,editable:o}}function P(e){return e&&e.paint&&e.paint["background-color"]}function b(e){return Array.isArray(null==e?void 0:e.layers)?c.DEFAULT_LAYER_GROUPS.filter((function(t){return e.layers.filter(t.filter).length})):[]}t.INITIAL_MAP_STYLE=T;var S=function(e,t){var r=t.payload,n=r.mapStyles,a=r.onSuccess,o=Object.keys(n).reduce((function(t,r){return A(A({},t),e.isLoading[r]?{}:(0,l.default)({},r,n[r]))}),{}),i=function(e,t,r,n){return[u.default.all(Object.values(e).map((function(e){var n=e.id,a=e.url,o=e.accessToken;return{id:n,url:(0,f.isValidStyleUrl)(a)?(0,f.getStyleDownloadUrl)(a,o||t,r):a}})).map(p.LOAD_MAP_STYLE_TASK)).bimap((function(t){return(0,v.loadMapStyles)(t.reduce((function(t,r){var n=r.id,a=r.style;return A(A({},t),{},(0,l.default)({},n,A(A({},e[n]),{},{style:a})))}),{}),n)}),(function(t){return(0,v.loadMapStyleErr)(Object.keys(e),t)}))]}(o,e.mapboxApiAccessToken,e.mapboxApiUrl,a),d=Object.keys(o).reduce((function(e,t){return A(A({},e),{},(0,l.default)({},t,!0))}),{}),s=A(A({},e),{},{isLoading:d});return(0,u.withTask)(s,i)};t.requestMapStylesUpdater=S,t.initMapStyleUpdater=function(e,t){var r=t.payload,n=void 0===r?{}:r;return A(A({},e),{},{mapboxApiAccessToken:n.mapboxApiAccessToken||e.mapboxApiAccessToken,mapboxApiUrl:n.mapboxApiUrl||e.mapboxApiUrl,mapStyles:n.mapStylesReplaceDefault?{}:e.mapStyles,mapStylesReplaceDefault:n.mapStylesReplaceDefault||!1})};var O=function(e,t){return A(A(A({},e),t.payload),h(A(A({},e),t.payload)))};t.mapConfigChangeUpdater=O;var E=function(e){return(0,f.isPlainObject)(null==e?void 0:e.style)},x=function(e,t){var r,n,a=t.payload,o=a.styleType,i=a.onSuccess;if(!e.mapStyles[o]||"MANAGED"===(null===(r=e.mapStyles[o])||void 0===r?void 0:r.custom)&&(null===(n=e.mapStyles[o])||void 0===n||!n.url)&&!E(e.mapStyles[o]))return e;if(!E(e.mapStyles[o]))return S(A(A({},e),{},{styleType:o}),{payload:{mapStyles:(0,l.default)({},o,e.mapStyles[o]),onSuccess:i}});var u=(0,f.getDefaultLayerGroupVisibility)(e.mapStyles[o]),d=(0,f.mergeLayerGroupVisibility)(u,e.visibleLayerGroups),s=e.custom3DBuildingColor?e.threeDBuildingColor:function(e){if(!e.style)return(0,f.hexToRgb)(c.DEFAULT_BLDG_COLOR);var t=(e.style.layers||[]).find((function(e){return"background"===e.id})),r=P((e.style.layers||[]).find((function(e){return e.id.match(/building/)})))||P(t)||c.DEFAULT_BLDG_COLOR,n=e.id.match(/(?=(dark|night))/)?"brighter":"darker",a=(0,y.rgb)(r)[n]([.2]);return[a.r,a.g,a.b]}(e.mapStyles[o]),p=function(e,t){var r=e.mapStyles[e.styleType],n=e.backgroundColor||c.DEFAULT_BACKGROUND_COLOR;return t===c.NO_MAP_ID?function(e,t){var r;if(!e.style)return(0,f.colorMaybeToRGB)(t)||t;var n,a=(n=P((e.style.layers||[]).find((function(e){var t=e.id;return c.BASE_MAP_BACKGROUND_LAYER_IDS.includes(t)}))),Array.isArray(n)&&"interpolate"===n[0]?n[4]:n),o="string"==typeof a?a:t;return(null===(r=(0,f.colorMaybeToRGB)(o))||void 0===r?void 0:r.map((function(e){return Math.round(e)})))||t}(r,n):n}(e,o);return A(A({},e),{},{styleType:o,visibleLayerGroups:d,threeDBuildingColor:s,backgroundColor:p},h(A(A({},e),{},{visibleLayerGroups:d,styleType:o})))};function F(e){var t=e.inputStyle.id;return t?A(A({},e),{},{mapStyles:A(A({},e.mapStyles),{},(0,l.default)({},t,A(A({},e.mapStyles[t]),e.inputStyle))),inputStyle:{id:null,accessToken:null,error:!1,isValid:!1,label:null,style:null,url:null,icon:null,custom:"LOCAL",uploadedFile:null}}):e}t.mapStyleChangeUpdater=x,t.loadMapStylesUpdater=function(e,t){var r=t.payload||{},n=r.newStyles,a=r.onSuccess,o=Object.keys(n).reduce((function(e,t){return A(A({},e),{},(0,l.default)({},t,A(A({},n[t]),{},{layerGroups:n[t].layerGroups||b(n[t].style)})))}),{}),i=Object.keys(e.isLoading).reduce((function(t,r){return A(A({},t),e.isLoading[r]&&E(n[r])?(0,l.default)({},r,!1):(0,l.default)({},r,e.isLoading[r]))}),{}),d=A(A({},e),{},{isLoading:i,mapStyles:A(A({},e.mapStyles),o)}),s=function(e,t){return"function"==typeof e?(0,p.ACTION_TASK)().map((function(r){return e(t)})):null}(a,{styleType:e.styleType}),f=n[e.styleType]?x(d,{payload:{styleType:e.styleType}}):d;return s?(0,u.withTask)(f,s):f},t.loadMapStyleErrUpdater=function(e,t){var r=t.payload,n=r.ids,a=r.error;s.default.error(a);var o=Object.keys(e.isLoading).reduce((function(t,r){return A(A({},t),e.isLoading[r]&&(n||[]).includes(r)?(0,l.default)({},r,!1):(0,l.default)({},r,e.isLoading[r]))}),{});return A(A({},e),{},{isLoading:o})},t.receiveMapConfigUpdater=function(e,t){var r=(t.payload.config||{}).mapStyle;if(!r)return e;var n=r.mapStyles?A(A({},r),{},{mapStyles:A(A({},r.mapStyles),e.mapStyles)}):r;n.custom3DBuildingColor=Boolean(r.threeDBuildingColor)||n.custom3DBuildingColor;var a=O(e,{payload:n});return x(a,{payload:{styleType:a.styleType}})},t.resetMapConfigMapStyleUpdater=function(e){var t=A(A(A({},T),{},{mapboxApiAccessToken:e.mapboxApiAccessToken,mapboxApiUrl:e.mapboxApiUrl,mapStylesReplaceDefault:e.mapStylesReplaceDefault},e.initialState),{},{mapStyles:e.mapStyles,initialState:e.initialState});return x(t,{payload:{styleType:t.styleType}})},t.loadCustomMapStyleUpdater=function(e,t){var r=t.payload,n=r.icon,a=r.style,o=r.error;return A(A({},e),{},{inputStyle:A(A(A(A({},e.inputStyle),a?{id:"MANAGED"===e.inputStyle.custom?e.inputStyle.id:a.id||(0,f.generateHashId)(),style:(0,d.default)(a),label:e.inputStyle.label||a.name,layerGroups:b(a)}:{}),n?{icon:n}:{}),o?{error:o}:{})})},t.inputMapStyleUpdater=function(e,t){var r,n=t.payload,a=n.inputStyle,o=n.mapState,i=A(A({},e.inputStyle),a),l=(0,f.isValidStyleUrl)(i.url),u=null===(r=i.icon)||void 0===r?void 0:r.startsWith("data:image"),d=l||Boolean(i.uploadedFile),s=l&&!u?(0,f.getStyleImageIcon)({mapState:o,styleUrl:i.url||"",mapboxApiAccessToken:i.accessToken||e.mapboxApiAccessToken||"",mapboxApiUrl:e.mapboxApiUrl||c.DEFAULT_MAPBOX_API_URL}):i.icon;return A(A({},e),{},{inputStyle:A(A({},i),{},{isValid:d,icon:s})})},t.addCustomMapStyleUpdater=function(e){var t=e.inputStyle.id;if(!t)return e;var r=F(e);return x(r,{payload:{styleType:t}})},t.editCustomMapStyleUpdater=function(e){return F(e)},t.removeCustomMapStyleUpdater=function(e,t){var r=t.payload.id,n=e.mapStyles,a=(n[r],(0,i.default)(n,[r].map(g))),o=A(A({},e),{},{mapStyles:a});return e.styleType===r?x(o,{payload:{styleType:_().styleType}}):o},t.set3dBuildingColorUpdater=function(e,t){var r=t.payload;return A(A({},e),{},{threeDBuildingColor:r,custom3DBuildingColor:!0})},t.setBackgroundColorUpdater=function(e,t){var r=t.payload;return A(A({},e),{},{backgroundColor:r})}},71190:(e,t,r)=>{"use strict";var n=r(95709),a=r(58784);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.mapStyleReducerFactory=void 0;var o,i=n(r(26396)),l=r(19913),u=r(99150),d=a(r(76081));function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var c=(o={},(0,i.default)(o,u.ActionTypes.INIT,d.initMapStyleUpdater),(0,i.default)(o,u.ActionTypes.INPUT_MAP_STYLE,d.inputMapStyleUpdater),(0,i.default)(o,u.ActionTypes.MAP_CONFIG_CHANGE,d.mapConfigChangeUpdater),(0,i.default)(o,u.ActionTypes.MAP_STYLE_CHANGE,d.mapStyleChangeUpdater),(0,i.default)(o,u.ActionTypes.REQUEST_MAP_STYLES,d.requestMapStylesUpdater),(0,i.default)(o,u.ActionTypes.LOAD_MAP_STYLES,d.loadMapStylesUpdater),(0,i.default)(o,u.ActionTypes.LOAD_MAP_STYLE_ERR,d.loadMapStyleErrUpdater),(0,i.default)(o,u.ActionTypes.RECEIVE_MAP_CONFIG,d.receiveMapConfigUpdater),(0,i.default)(o,u.ActionTypes.LOAD_CUSTOM_MAP_STYLE,d.loadCustomMapStyleUpdater),(0,i.default)(o,u.ActionTypes.ADD_CUSTOM_MAP_STYLE,d.addCustomMapStyleUpdater),(0,i.default)(o,u.ActionTypes.EDIT_CUSTOM_MAP_STYLE,d.editCustomMapStyleUpdater),(0,i.default)(o,u.ActionTypes.REMOVE_CUSTOM_MAP_STYLE,d.removeCustomMapStyleUpdater),(0,i.default)(o,u.ActionTypes.RESET_MAP_CONFIG,d.resetMapConfigMapStyleUpdater),(0,i.default)(o,u.ActionTypes.SET_3D_BUILDING_COLOR,d.set3dBuildingColorUpdater),(0,i.default)(o,u.ActionTypes.SET_BACKGROUND_COLOR,d.setBackgroundColorUpdater),(0,i.default)(o,u.ActionTypes.RESET_MAP_CONFIG,d.resetMapConfigMapStyleUpdater),o),p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,l.handleActions)(c,f(f(f({},d.INITIAL_MAP_STYLE),e),{},{initialState:e}))};t.mapStyleReducerFactory=p;var y=p();t.default=y},79269:(e,t,r)=>{"use strict";var n=r(95709);Object.defineProperty(t,"__esModule",{value:!0}),t.isValidMerger=c,t.mergeStateFromMergers=function(e,t,r,n){for(var a=e,d=(0,l.default)(r),s=function(){var r,i,l=d.shift();if(l&&c(l)&&l.toMergeProp&&p(e,l.toMergeProp)){var s={mergers:d,postMergerPayload:n},f=y(a,l.toMergeProp,l.toMergeProp);a=v(a,t,l.toMergeProp);var g=(r=function(){return l.merge(a,f,!1,s)},i=(0,u.getGlobalTaskQueue)(),[r(),(0,u.getGlobalTaskQueue)().filter((function(e){return!i.includes(e)}))]),m=(0,o.default)(g,2),A=m[0],_=m[1];if(a=A,_.length&&l.waitToFinish)return{v:{mergedState:a,allMerged:!1}}}};d.length;){var f=s();if("object"===(0,i.default)(f))return f.v}return{mergedState:a,allMerged:!0}},t.hasPropsToMerge=p,t.getPropValueToMerger=y,t.resetStateToMergeProps=v;var a=n(r(26396)),o=n(r(22056)),i=n(r(85735)),l=n(r(21259)),u=r(13370),d=r(77244);function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){(0,a.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function c(e){return(0,d.isObject)(e)&&"function"==typeof e.merge&&("string"==typeof e.prop||Array.isArray(e.prop))}function p(e,t){return Array.isArray(t)?Boolean(t.some((function(t){return e.hasOwnProperty(t)}))):"string"==typeof t&&e.hasOwnProperty(t)}function y(e,t,r){return Array.isArray(t)?t.reduce((function(t,n,o){return r?f(f({},t),{},(0,a.default)({},r[o],e[n])):t}),{}):e[t]}function v(e,t,r){return(0,d.toArray)(r).reduce((function(e,r){return f(f({},e),{},(0,a.default)({},r,t[r]))}),e)}},94138:(e,t,r)=>{"use strict";var n=r(95709);Object.defineProperty(t,"__esModule",{value:!0}),t.enhanceReduxMiddleware=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return[].concat((0,a.default)(e),[o.taskMiddleware])};var a=n(r(21259)),o=r(13370)},96750:(e,t,r)=>{"use strict";var n=r(95709);Object.defineProperty(t,"__esModule",{value:!0}),t.resetProviderStatusUpdater=t.loadCloudMapErrorUpdater=t.loadCloudMapSuccessUpdater=t.loadCloudMapUpdater=t.exportFileErrorUpdater=t.postSaveLoadSuccessUpdater=t.exportFileSuccessUpdater=t.exportFileToCloudUpdater=t.INITIAL_PROVIDER_STATE=void 0;var a=n(r(21259)),o=n(r(26396)),i=r(13370),l=n(r(45439)),u=r(77244),d=r(16441),s=r(99150),f=r(13848),c=r(12117),p=r(6014);function y(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function v(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?y(Object(r),!0).forEach((function(t){(0,o.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function g(e,t){return"function"==typeof e?(0,d.ACTION_TASK)().map((function(r){return e(t)})):null}function m(e,t){return e?"function"==typeof e[t]||(l.default.error("".concat(t," is not a function of Cloud provider: ").concat(e.name)),!1):(l.default.error("provider is not defined"),!1)}function A(e){var t=e.type,r=e.message,n=e.delayClose,a=void 0===n||n,o=(0,u.generateHashId)(),i={id:o,type:f.DEFAULT_NOTIFICATION_TYPES[t||""]||f.DEFAULT_NOTIFICATION_TYPES.success,topic:f.DEFAULT_NOTIFICATION_TOPICS.global,message:r},l=(0,d.ACTION_TASK)().map((function(e){return(0,s.addNotification)(i)}));return a?[l,(0,d.DELAY_TASK)(3e3).map((function(e){return(0,s.removeNotification)(o)}))]:[l]}t.INITIAL_PROVIDER_STATE={isProviderLoading:!1,isCloudMapLoading:!1,providerError:null,currentProvider:null,successInfo:{},mapSaved:null,visualizations:[]},t.exportFileToCloudUpdater=function(e,t){var r=t.payload,n=r.mapData,a=r.provider,o=r.options,l=void 0===o?{}:o,u=r.onSuccess,f=r.onError,c=r.closeModal;if(!m(a,"uploadMap"))return e;var p=v(v({},e),{},{isProviderLoading:!0,currentProvider:a.name}),y={mapData:n,options:l},g=(0,d.EXPORT_FILE_TO_CLOUD_TASK)({provider:a,payload:y}).bimap((function(e){return(0,s.exportFileSuccess)({response:e,provider:a,options:l,onSuccess:u,closeModal:c})}),(function(e){return(0,s.exportFileError)({error:e,provider:a,options:l,onError:f})}));return(0,i.withTask)(p,g)},t.exportFileSuccessUpdater=function(e,t){var r=t.payload,n=r.response,a=r.provider,o=r.options,l=void 0===o?{}:o,u=r.onSuccess,f=r.closeModal,c=v(v({},e),{},{isProviderLoading:!1,successInfo:n},l.isPublic?{}:{mapSaved:a.name}),p=[g(u,{response:n,provider:a,options:l}),f&&(0,d.ACTION_TASK)().map((function(t){return(0,s.postSaveLoadSuccess)("Map saved to ".concat(e.currentProvider,"!"))}))].filter((function(e){return e}));return p.length?(0,i.withTask)(c,p):c},t.postSaveLoadSuccessUpdater=function(e,t){var r=t.payload||"Saved / Load to ".concat(e.currentProvider," Success"),n=[(0,d.ACTION_TASK)().map((function(e){return(0,s.toggleModal)(null)})),(0,d.ACTION_TASK)().map((function(e){return(0,s.resetProviderStatus)()}))].concat((0,a.default)(A({message:r})));return(0,i.withTask)(e,n)};var _=function(e,t){var r=t.payload,n=r.error,a=r.provider,o=r.onError,l=v(v({},e),{},{isProviderLoading:!1});if(function(e){return e&&e.message===c.FILE_CONFLICT_MSG}(n))return l.mapSaved=a.name,(0,i.withTask)(l,[(0,d.ACTION_TASK)().map((function(e){return(0,s.toggleModal)(f.OVERWRITE_MAP_ID)}))]);l.providerError=(0,u.getError)(n);var p=g(o,{error:n,provider:a});return p?(0,i.withTask)(l,p):l};t.exportFileErrorUpdater=_,t.loadCloudMapUpdater=function(e,t){var r=t.payload,n=r.loadParams,a=r.provider,o=r.onSuccess,u=r.onError;if(!n)return l.default.warn("load map error: loadParams is undefined"),e;if(!m(a,"downloadMap"))return e;var f=v(v({},e),{},{isProviderLoading:!0,isCloudMapLoading:!0}),c=(0,d.LOAD_CLOUD_MAP_TASK)({provider:a,payload:n}).bimap((function(e){return(0,s.loadCloudMapSuccess)({response:e,loadParams:n,provider:a,onSuccess:o,onError:u})}),(function(e){return(0,s.loadCloudMapError)({error:e,provider:a,onError:u})}));return(0,i.withTask)(f,c)},t.loadCloudMapSuccessUpdater=function(e,t){var r=t.payload,n=r.response,a=r.loadParams,o=r.provider,c=r.onSuccess,y=r.onError,m=function(e){return e&&(0,u.isPlainObject)(e)?(0,u.isPlainObject)(e.map)?e.map.datasets&&e.map.config?null:new Error("Load map response.map should be an object with property datasets or config"):new Error('Load map response should be an object property "map"'):new Error("Load map response is empty")}(n);if(m)return _(e,{payload:{error:m,provider:o,onError:y}});var A=v(v({},e),{},{mapSaved:o.name,currentProvider:o.name,isCloudMapLoading:!1,isProviderLoading:!1}),T=function(e,t,r){var n=e.map,a=e.format,o=function(e){var t=p.DATASET_HANDLERS[f.DATASET_FORMATS.csv];if(!e)return l.default.warn("format is not provided in load map response, will use csv by default"),t;if(!p.DATASET_HANDLERS[e]){var r=Object.keys(f.DATASET_FORMATS).map((function(e){return"'".concat(e,"'")})).join(", ");return l.default.warn("unknown format ".concat(e,". Please use one of ").concat(r,", will use csv by default")),t}return p.DATASET_HANDLERS[e]}(a),i=(0,u.toArray)(n.datasets).map((function(e,t){return a===f.DATASET_FORMATS.keplergl?o(e):{info:e&&e.info||{id:(0,u.generateHashId)(6)},data:o(e.data||e)}})),d=v(v({},n.info),{},{provider:r.name,loadParams:t});return v({datasets:i,info:d},n.config?{config:n.config}:{})}(n,a,o),h=[(0,d.ACTION_TASK)().map((function(e){return(0,s.addDataToMap)(T)})),g(c,{response:n,loadParams:a,provider:o}),(0,d.ACTION_TASK)().map((function(e){return(0,s.postSaveLoadSuccess)("Map from ".concat(o.name," loaded"))}))].filter((function(e){return e}));return h.length?(0,i.withTask)(A,h):A},t.loadCloudMapErrorUpdater=function(e,t){var r=(0,u.getError)(t.payload.error)||"Error loading saved map";l.default.warn(r);var n=v(v({},e),{},{isProviderLoading:!1,isCloudMapLoading:!1,providerError:null});return(0,i.withTask)(n,A({type:"error",message:r,delayClose:!1}))},t.resetProviderStatusUpdater=function(e){return v(v({},e),{},{isProviderLoading:!1,providerError:null,isCloudMapLoading:!1,successInfo:{}})}},38655:(e,t,r)=>{"use strict";var n=r(95709),a=r(58784);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.providerStateReducerFactory=void 0;var o,i=n(r(26396)),l=r(19913),u=a(r(96750)),d=r(99150);function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var c=(o={},(0,i.default)(o,d.ProviderActionTypes.EXPORT_FILE_TO_CLOUD,u.exportFileToCloudUpdater),(0,i.default)(o,d.ProviderActionTypes.EXPORT_FILE_SUCCESS,u.exportFileSuccessUpdater),(0,i.default)(o,d.ProviderActionTypes.EXPORT_FILE_ERROR,u.exportFileErrorUpdater),(0,i.default)(o,d.ProviderActionTypes.RESET_PROVIDER_STATUS,u.resetProviderStatusUpdater),(0,i.default)(o,d.ProviderActionTypes.POST_SAVE_LOAD_SUCCESS,u.postSaveLoadSuccessUpdater),(0,i.default)(o,d.ProviderActionTypes.LOAD_CLOUD_MAP,u.loadCloudMapUpdater),(0,i.default)(o,d.ProviderActionTypes.LOAD_CLOUD_MAP_SUCCESS,u.loadCloudMapSuccessUpdater),(0,i.default)(o,d.ProviderActionTypes.LOAD_CLOUD_MAP_ERROR,u.loadCloudMapErrorUpdater),o),p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,l.handleActions)(c,f(f(f({},u.INITIAL_PROVIDER_STATE),e),{},{initialState:e}))};t.providerStateReducerFactory=p;var y=p();t.default=y},506:(e,t,r)=>{"use strict";var n=r(95709);Object.defineProperty(t,"__esModule",{value:!0}),t.provideInitialState=p,t.default=void 0;var a=n(r(85735)),o=n(r(21259)),i=n(r(26396)),l=r(99150),u=r(19913),d=r(5133);function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var c={};function p(e,t){var r=(0,d.coreReducerFactory)(e,t),n=function(e,t){var n=t.payload,a=n.id,o=n.mint,u=n.mapboxApiAccessToken,d=n.mapboxApiUrl,s=n.mapStylesReplaceDefault,c=n.initialUiState,p=e[a]&&!1===o?e[a]:void 0;return f(f({},e),{},(0,i.default)({},a,r(p,(0,l.keplerGlInit)({mapboxApiAccessToken:u,mapboxApiUrl:d,mapStylesReplaceDefault:s,initialUiState:c}))))},a=function(e,t){var r=t.payload;return Object.keys(e).reduce((function(t,n){return f(f({},t),n===r?{}:(0,i.default)({},n,e[n]))}),{})},o=function(e,t){var r=t.payload,n=r.oldId,a=r.newId;return Object.keys(e).reduce((function(t,r){return f(f({},t),(0,i.default)({},r===n?a:r,e[r]))}),{})};return function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c,d=arguments.length>1?arguments[1]:void 0;Object.keys(t).forEach((function(e){var n=r(t[e],(0,l._actionFor)(e,d));t=(0,l._updateProperty)(t,e,n)}));var s=(e={},(0,i.default)(e,l.ActionTypes.REGISTER_ENTRY,n),(0,i.default)(e,l.ActionTypes.DELETE_ENTRY,a),(0,i.default)(e,l.ActionTypes.RENAME_ENTRY,o),e);return(0,u.handleActions)(s,c)(t,d)}}var y=function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.plugin=function(t,r){var n=this;return"object"===(0,a.default)(t)&&(t=(0,u.handleActions)(t,{})),e((function(){var e,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=a;return!o.type||null!=r&&null!==(e=r.override)&&void 0!==e&&e[o.type]||(i=n(a,o)),Object.keys(i).forEach((function(e){i=(0,l._updateProperty)(i,e,t(i[e],(0,l._actionFor)(e,o)))})),i}))},t.initialState=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=Object.keys(n),l=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return["mapState","mapStyle","visState","uiState"].concat((0,o.default)(r)).reduce((function(r,n){return f(f({},r),e[n]&&t[n]?(0,i.default)({},n,f(f({},e[n]),t[n])):(0,i.default)({},n,e[n]||t[n]||{}))}),{})}(r,t,a);return e(p(l,n),l)},t}(p(c));t.default=y},4719:(e,t,r)=>{"use strict";var n=r(95709);Object.defineProperty(t,"__esModule",{value:!0}),t.togglePanelListViewUpdater=t.setLocaleUpdater=t.showDatasetTableUpdater=t.toggleSplitMapUpdater=t.loadFilesErrUpdater=t.loadFilesSuccessUpdater=t.loadFilesUpdater=t.removeNotificationUpdater=t.addNotificationUpdater=t.setExportMapHTMLModeUpdater=t.setExportMapFormatUpdater=t.setUserMapboxAccessTokenUpdater=t.setExportDataUpdater=t.setExportFilteredUpdater=t.setExportDataTypeUpdater=t.setExportSelectedDatasetUpdater=t.startExportingImageUpdater=t.cleanupExportImageUpdater=t.setExportImageErrorUpdater=t.setExportImageDataUriUpdater=t.setExportImageSettingUpdater=t.openDeleteModalUpdater=t.setMapControlVisibilityUpdater=t.toggleMapControlUpdater=t.toggleSidePanelCloseButtonUpdater=t.hideExportDropdownUpdater=t.showExportDropdownUpdater=t.toggleModalUpdater=t.toggleSidePanelUpdater=t.initUiStateUpdater=t.INITIAL_UI_STATE=t.DEFAULT_EXPORT_MAP=t.DEFAULT_EXPORT_JSON=t.DEFAULT_EXPORT_HTML=t.DEFAULT_NOTIFICATIONS=t.DEFAULT_EXPORT_DATA=t.DEFAULT_LOAD_FILES=t.DEFAULT_EXPORT_IMAGE=t.DEFAULT_MAP_CONTROLS=t.DEFAULT_MODAL=t.DEFAULT_ACTIVE_SIDE_PANEL=void 0;var a,o=n(r(21259)),i=n(r(26396)),l=r(13848),u=r(80652),d=r(77244),s=r(75544);function f(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?f(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var p="layer";t.DEFAULT_ACTIVE_SIDE_PANEL=p;var y=l.ADD_DATA_ID;t.DEFAULT_MODAL=y;var v={show:!0,active:!1,disableClose:!1,activeMapIndex:0},g=Object.keys(l.MAP_CONTROLS).reduce((function(e,t){return c(c({},e),{},(0,i.default)({},t,v))}),{});t.DEFAULT_MAP_CONTROLS=g;var m={ratio:l.EXPORT_IMG_RATIOS.SCREEN,resolution:l.RESOLUTIONS.ONE_X,legend:!1,mapH:0,mapW:0,imageSize:{zoomOffset:0,scale:1,imageW:0,imageH:0},center:!1,imageDataUri:"",exporting:!1,processing:!1,error:!1,escapeXhtmlForWebpack:!0};t.DEFAULT_EXPORT_IMAGE=m;var A={fileLoading:!1};t.DEFAULT_LOAD_FILES=A;var _={selectedDataset:"",dataType:l.EXPORT_DATA_TYPE.CSV,filtered:!0};t.DEFAULT_EXPORT_DATA=_;var T=[];t.DEFAULT_NOTIFICATIONS=T;var h={exportMapboxAccessToken:null,userMapboxToken:"",mode:l.EXPORT_HTML_MAP_MODES.READ};t.DEFAULT_EXPORT_HTML=h;var P={hasData:!0};t.DEFAULT_EXPORT_JSON=P;var b=(a={},(0,i.default)(a,l.EXPORT_MAP_FORMATS.HTML,h),(0,i.default)(a,l.EXPORT_MAP_FORMATS.JSON,P),(0,i.default)(a,"format",l.EXPORT_MAP_FORMATS.HTML),a);t.DEFAULT_EXPORT_MAP=b;var S={readOnly:!1,activeSidePanel:p,currentModal:y,datasetKeyToRemove:null,visibleDropdown:null,exportImage:m,exportData:_,exportMap:b,mapControls:g,notifications:T,loadFiles:A,locale:u.LOCALE_CODES.en,layerPanelListView:"list",filterPanelListView:"list",isSidePanelCloseButtonVisible:!0};t.INITIAL_UI_STATE=S,t.initUiStateUpdater=function(e,t){return c(c({},e),(t.payload||{}).initialUiState)},t.toggleSidePanelUpdater=function(e,t){var r=t.payload;return r===e.activeSidePanel?e:c(c({},e),{},{activeSidePanel:r})};var O=function(e,t){var r=t.payload;return c(c({},e),{},{currentModal:r})};t.toggleModalUpdater=O,t.showExportDropdownUpdater=function(e,t){var r=t.payload;return c(c({},e),{},{visibleDropdown:r})},t.hideExportDropdownUpdater=function(e){return c(c({},e),{},{visibleDropdown:null})},t.toggleSidePanelCloseButtonUpdater=function(e,t){var r=t.payload.show;return c(c({},e),{},{isSidePanelCloseButtonVisible:r})},t.toggleMapControlUpdater=function(e,t){var r=t.payload,n=r.panelId,a=r.index,o=void 0===a?0:a;return c(c({},e),{},{mapControls:c(c({},e.mapControls),{},(0,i.default)({},n,c(c({},e.mapControls[n]),{},{active:!e.mapControls[n].active,activeMapIndex:o})))})},t.setMapControlVisibilityUpdater=function(e,t){var r,n=t.payload,a=n.panelId,o=n.show;return null!==(r=e.mapControls)&&void 0!==r&&r[a]?c(c({},e),{},{mapControls:c(c({},e.mapControls),{},(0,i.default)({},a,c(c({},e.mapControls[a]),{},{show:Boolean(o)})))}):e},t.openDeleteModalUpdater=function(e,t){var r=t.payload;return c(c({},e),{},{currentModal:l.DELETE_DATA_ID,datasetKeyToRemove:r})};var E=function(e,t){var r=t.payload,n=c(c({},e.exportImage),r),a=(0,d.calculateExportImageSize)(n)||e.exportImage.imageSize;return c(c({},e),{},{exportImage:c(c({},n),{},{imageSize:a})})};t.setExportImageSettingUpdater=E,t.setExportImageDataUriUpdater=function(e,t){var r=t.payload;return c(c({},e),{},{exportImage:c(c({},e.exportImage),{},{processing:!1,imageDataUri:r})})},t.setExportImageErrorUpdater=function(e,t){var r=t.payload;return c(c({},e),{},{exportImage:c(c({},e.exportImage),{},{processing:!1,error:r})})};var x=function(e){return c(c({},e),{},{exportImage:c(c({},e.exportImage),{},{exporting:!1,imageDataUri:"",error:!1,processing:!1,center:!1})})};t.cleanupExportImageUpdater=x,t.startExportingImageUpdater=function(e,t){var r=t.payload,n=c(c({},void 0===r?{}:r),{},{exporting:!0});return(0,s.compose_)([x,(0,s.apply_)(E,(0,s.payload_)(n))])(e)},t.setExportSelectedDatasetUpdater=function(e,t){var r=t.payload;return c(c({},e),{},{exportData:c(c({},e.exportData),{},{selectedDataset:r})})},t.setExportDataTypeUpdater=function(e,t){var r=t.payload;return c(c({},e),{},{exportData:c(c({},e.exportData),{},{dataType:r})})},t.setExportFilteredUpdater=function(e,t){var r=t.payload;return c(c({},e),{},{exportData:c(c({},e.exportData),{},{filtered:r})})},t.setExportDataUpdater=function(e){return c(c({},e),{},{exportMap:c(c({},e.exportMap),{},(0,i.default)({},l.EXPORT_MAP_FORMATS.JSON,c(c({},e.exportMap[l.EXPORT_MAP_FORMATS.JSON]),{},{hasData:!e.exportMap[l.EXPORT_MAP_FORMATS.JSON].hasData})))})},t.setUserMapboxAccessTokenUpdater=function(e,t){var r=t.payload;return c(c({},e),{},{exportMap:c(c({},e.exportMap),{},(0,i.default)({},l.EXPORT_MAP_FORMATS.HTML,c(c({},e.exportMap[l.EXPORT_MAP_FORMATS.HTML]),{},{userMapboxToken:r})))})},t.setExportMapFormatUpdater=function(e,t){var r=t.payload;return c(c({},e),{},{exportMap:c(c({},e.exportMap),{},{format:r})})},t.setExportMapHTMLModeUpdater=function(e,t){var r=t.payload;return c(c({},e),{},{exportMap:c(c({},e.exportMap),{},(0,i.default)({},l.EXPORT_MAP_FORMATS.HTML,c(c({},e.exportMap[l.EXPORT_MAP_FORMATS.HTML]),{},{mode:r})))})};var F=function(e,t){var r,n=t.payload,a=e.notifications||[],i=null==n?void 0:n.id;return r=i&&a.find((function(e){return e.id===i}))?a.map((function(e){return e.id===i?(0,d.createNotification)(c(c({},n),{},{count:e.count+1})):e})):[].concat((0,o.default)(a),[(0,d.createNotification)(n)]),c(c({},e),{},{notifications:r})};t.addNotificationUpdater=F,t.removeNotificationUpdater=function(e,t){var r=t.payload;return c(c({},e),{},{notifications:e.notifications.filter((function(e){return e.id!==r}))})},t.loadFilesUpdater=function(e){return c(c({},e),{},{loadFiles:c(c({},e.loadFiles),{},{fileLoading:!0})})},t.loadFilesSuccessUpdater=function(e){return c(c({},e),{},{loadFiles:c(c({},e.loadFiles),{},{fileLoading:!1})})},t.loadFilesErrUpdater=function(e,t){var r=t.error;return F(c(c({},e),{},{loadFiles:c(c({},e.loadFiles),{},{fileLoading:!1})}),{payload:(0,d.errorNotification)({message:(r||{}).message||"Failed to upload files",topic:l.DEFAULT_NOTIFICATION_TOPICS.global})})},t.toggleSplitMapUpdater=function(e){return c(c({},e),{},{mapControls:Object.entries(e.mapControls).reduce((function(e,t){return c(c({},e),{},(0,i.default)({},t[0],c(c({},t[1]),{},{activeMapIndex:0})))}),{})})},t.showDatasetTableUpdater=function(e){return O(e,{payload:l.DATA_TABLE_ID})},t.setLocaleUpdater=function(e,t){var r=t.payload.locale;return c(c({},e),{},{locale:r})},t.togglePanelListViewUpdater=function(e,t){var r=t.payload,n=r.panelId,a=r.listView,o="layer"===n?"layerPanelListView":"filter"===n?"filterPanelListView":null;return o&&e[o]!==a?c(c({},e),{},(0,i.default)({},o,a)):e}},70648:(e,t,r)=>{"use strict";var n=r(95709),a=r(58784);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.uiStateReducerFactory=void 0;var o,i=n(r(26396)),l=r(19913),u=r(99150),d=a(r(4719));function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var c=(o={},(0,i.default)(o,u.ActionTypes.INIT,d.initUiStateUpdater),(0,i.default)(o,u.ActionTypes.TOGGLE_SIDE_PANEL,d.toggleSidePanelUpdater),(0,i.default)(o,u.ActionTypes.TOGGLE_MODAL,d.toggleModalUpdater),(0,i.default)(o,u.ActionTypes.SHOW_EXPORT_DROPDOWN,d.showExportDropdownUpdater),(0,i.default)(o,u.ActionTypes.HIDE_EXPORT_DROPDOWN,d.hideExportDropdownUpdater),(0,i.default)(o,u.ActionTypes.TOGGLE_SIDE_PANEL_CLOSE_BUTTON,d.toggleSidePanelCloseButtonUpdater),(0,i.default)(o,u.ActionTypes.OPEN_DELETE_MODAL,d.openDeleteModalUpdater),(0,i.default)(o,u.ActionTypes.TOGGLE_MAP_CONTROL,d.toggleMapControlUpdater),(0,i.default)(o,u.ActionTypes.SET_MAP_CONTROL_VISIBILITY,d.setMapControlVisibilityUpdater),(0,i.default)(o,u.ActionTypes.ADD_NOTIFICATION,d.addNotificationUpdater),(0,i.default)(o,u.ActionTypes.REMOVE_NOTIFICATION,d.removeNotificationUpdater),(0,i.default)(o,u.ActionTypes.SET_EXPORT_IMAGE_SETTING,d.setExportImageSettingUpdater),(0,i.default)(o,u.ActionTypes.SET_EXPORT_IMAGE_DATA_URI,d.setExportImageDataUriUpdater),(0,i.default)(o,u.ActionTypes.SET_EXPORT_IMAGE_ERROR,d.setExportImageErrorUpdater),(0,i.default)(o,u.ActionTypes.CLEANUP_EXPORT_IMAGE,d.cleanupExportImageUpdater),(0,i.default)(o,u.ActionTypes.START_EXPORTING_IMAGE,d.startExportingImageUpdater),(0,i.default)(o,u.ActionTypes.SET_EXPORT_SELECTED_DATASET,d.setExportSelectedDatasetUpdater),(0,i.default)(o,u.ActionTypes.SET_EXPORT_DATA_TYPE,d.setExportDataTypeUpdater),(0,i.default)(o,u.ActionTypes.SET_EXPORT_FILTERED,d.setExportFilteredUpdater),(0,i.default)(o,u.ActionTypes.SET_EXPORT_DATA,d.setExportDataUpdater),(0,i.default)(o,u.ActionTypes.SET_USER_MAPBOX_ACCESS_TOKEN,d.setUserMapboxAccessTokenUpdater),(0,i.default)(o,u.ActionTypes.SET_EXPORT_MAP_FORMAT,d.setExportMapFormatUpdater),(0,i.default)(o,u.ActionTypes.SET_EXPORT_MAP_HTML_MODE,d.setExportMapHTMLModeUpdater),(0,i.default)(o,u.ActionTypes.LOAD_FILES,d.loadFilesUpdater),(0,i.default)(o,u.ActionTypes.LOAD_FILES_ERR,d.loadFilesErrUpdater),(0,i.default)(o,u.ActionTypes.TOGGLE_SPLIT_MAP,d.toggleSplitMapUpdater),(0,i.default)(o,u.ActionTypes.SHOW_DATASET_TABLE,d.showDatasetTableUpdater),(0,i.default)(o,u.ActionTypes.SET_LOCALE,d.setLocaleUpdater),(0,i.default)(o,u.ActionTypes.TOGGLE_PANEL_LIST_VIEW,d.togglePanelListViewUpdater),o),p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,l.handleActions)(c,f(f(f({},d.INITIAL_UI_STATE),e),{},{initialState:e}))};t.uiStateReducerFactory=p;var y=p();t.default=y},91978:(e,t,r)=>{"use strict";var n=r(95709);Object.defineProperty(t,"__esModule",{value:!0}),t.mergeFilters=h,t.replaceFilterDatasetIds=P,t.isSavedLayerConfigV1=b,t.parseLayerConfig=S,t.createLayerFromConfig=function(e,t){var r=b(t)?S(e.schema,t):t;if(!r)return null;var n=X(e.datasets,e.layerClasses,[r],{allowEmptyColumn:!0}),a=n.validated,o=n.failed;if(null!=o&&o.length||!a.length)return null;var i=a[0];return i.updateLayerDomain(e.datasets),i},t.serializeLayer=function(e,t){var r,n=E({layers:[e],layerOrder:[e.id]},t);return null==n||null===(r=n.layers)||void 0===r?void 0:r[0]},t.serializeEffect=function(e,t){var r,n=E({effects:[e],effectOrder:[e.id]},t);return null==n||null===(r=n.effects)||void 0===r?void 0:r[0]},t.serializeVisState=E,t.mergeLayers=x,t.insertLayerAtRightOrder=F,t.mergeInteractions=L,t.mergeSplitMaps=C,t.mergeEffects=U,t.mergeInteractionTooltipConfig=M,t.mergeLayerBlending=w,t.mergeOverlayBlending=D,t.mergeAnimationConfig=N,t.validateSavedLayerColumns=j,t.validateColumn=R,t.validateSavedTextLabel=k,t.validateSavedVisualChannels=Y,t.validateLayersByDatasets=X,t.validateLayerWithData=Q,t.mergeEditor=B,t.mergeDatasetsByOrder=function(e,t){var r=T(T({},e.datasets),t);if(Array.isArray(e.preserveDatasetOrder)){var n=Object.keys(r).filter((function(t){var r;return!(null!==(r=e.preserveDatasetOrder)&&void 0!==r&&r.includes(t))}));return[].concat((0,i.default)(e.preserveDatasetOrder),(0,i.default)(n)).reduce((function(e,t){return T(T({},e),r[t]?(0,l.default)({},t,r[t]):{})}),{})}return r},t.VIS_STATE_MERGERS=void 0;var a=n(r(22056)),o=n(r(39892)),i=n(r(21259)),l=n(r(26396)),u=n(r(90879)),d=n(r(91863)),s=n(r(42622)),f=n(r(14744)),c=r(77244),p=r(996),y=r(18761),v=r(13848),g=r(50094),m=r(68747);function A(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function T(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?_(Object(r),!0).forEach((function(t){(0,l.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function h(e,t,r){var n=r?null==t?void 0:t.map((function(e){return e.id})):e.preserveFilterOrder;if(!Array.isArray(t)||!t.length)return e;var a=(0,c.validateFiltersUpdateDatasets)(e,t),o=a.validated,l=a.failed,d=a.updatedDatasets,f=O(e.filters,o,n);f=(0,m.resetFilterGpuMode)(f),f=(0,m.assignGpuChannels)(f);var p=(0,u.default)((0,s.default)(o.map((function(e){return e.dataId})))),y=(0,c.applyFiltersToDatasets)(p,d,f,e.layers);return T(T({},e),{},{filters:f,datasets:y,preserveFilterOrder:n,filterToBeMerged:[].concat((0,i.default)(e.filterToBeMerged),(0,i.default)(l))})}function P(e,t,r){var n=[];return e.forEach((function(e){if(e.dataId.includes(t)){var a=e.dataId.map((function(e){return e===t?r:e}));n.push(T(T({},e),{},{dataId:a}))}})),n.length?n:null}function b(e){return null==e?void 0:e.visualChannels}function S(e,t){var r,n,a,o={version:g.CURRENT_VERSION,config:{visState:{layers:[t],layerOrder:[t.id]}}};return null===(r=e.parseSavedConfig(o))||void 0===r||null===(n=r.visState)||void 0===n||null===(a=n.layers)||void 0===a?void 0:a[0]}function O(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=arguments.length>3?arguments[3]:void 0,o=(0,i.default)(e),l=function(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return A(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?A(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return i=e.done,e},e:function(e){l=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(l)throw o}}}}(t);try{for(l.s();!(r=l.n()).done;){var u=r.value,d=n.indexOf(u.id),s=a?0:o.length;if(d>0){for(var f=d+1,p=-1,y=function(){var e=n[f-1];p=o.findIndex((function(t){return t.id===e}))};f-- >0&&p<0;)y();p>-1&&(s=p+1)}o=(0,c.arrayInsert)(o,s,u)}}catch(e){l.e(e)}finally{l.f()}return o}function E(e,t){var r,n=t.getConfigToSave({visState:e});return n?null===(r=t.parseSavedConfig(n))||void 0===r?void 0:r.visState:void 0}function x(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=(arguments.length>2?arguments[2]:void 0)?(0,p.getLayerOrderFromLayers)(t):e.preserveLayerOrder;if(!Array.isArray(t)||!t.length)return e;var n=[],a=[];t.forEach((function(t){var r;null!=t&&null!==(r=t.config)&&void 0!==r&&r.dataId&&e.isMergingDatasets[t.config.dataId]?n.push(t):a.push(t)}));var o=X(e.datasets,e.layerClasses,a),l=o.validated,u=o.failed;n.push.apply(n,(0,i.default)(u));var d=F(e.layers,l,e.layerOrder,r),s=d.newLayerOrder,f=d.newLayers;return T(T({},e),{},{layers:f,layerOrder:s,preserveLayerOrder:r,layerToBeMerged:[].concat((0,i.default)(e.layerToBeMerged),n)})}function F(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];if(null==t||!t.length)return{newLayers:e,newLayerOrder:r};var a=r.map((function(t){return(0,c.findById)(t)(e)})).filter((function(e){return Boolean(e)})),o=e.concat(t),i=O(a,t,n,!0);return{newLayerOrder:(0,p.getLayerOrderFromLayers)(i),newLayers:o}}function L(e,t,r){var n={},a={};return t&&Object.keys(t).forEach((function(r){if(e.interactionConfig[r]){var i="tooltip"===r||"brush"===r?e.interactionConfig[r].config:null,l=t[r]||{},u=l.enabled,s=(0,o.default)(l,["enabled"]),f=s;if("tooltip"===r){var c=M(e,s),p=c.mergedTooltip,y=c.unmergedTooltip;f={fieldsToShow:T(T({},i.fieldsToShow),p)},Object.keys(y).length&&(a.tooltip={fieldsToShow:y,enabled:Boolean(u)})}n[r]=T(T({},e.interactionConfig[r]),{},{enabled:Boolean(u)},i?{config:(0,d.default)(T(T({},i),f),Object.keys(i))}:{})}})),T(T({},e),{},{interactionConfig:T(T({},e.interactionConfig),n),interactionToBeMerged:I(e,a)})}function I(e,t){var r,n,a,o,i;return null!=t&&null!==(r=t.tooltip)&&void 0!==r&&r.fieldsToShow?{tooltip:T(T(T({},e.interactionToBeMerged.tooltip),"boolean"==typeof(null==t||null===(n=t.tooltip)||void 0===n?void 0:n.enabled)?{enabled:t.tooltip.enabled}:{}),{},{fieldsToShow:T(T({},null===(a=e.interactionToBeMerged)||void 0===a||null===(o=a.tooltip)||void 0===o?void 0:o.fieldsToShow),null==t||null===(i=t.tooltip)||void 0===i?void 0:i.fieldsToShow)})}:e.interactionToBeMerged}function C(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=(0,i.default)(e.splitMaps),n=[];return t.forEach((function(t,o){var i=Object.entries(t.layers);i.length>0?i.forEach((function(i){var u=(0,a.default)(i,2),d=u[0],s=u[1],f=e.layers.find((function(e){return e.id===d}))?r:n;f[o]=f[o]||T(T({},t),{},{layers:f===r?(0,c.getInitialMapLayersForSplitMap)(e.layers):[]}),f[o].layers=T(T({},f[o].layers),{},(0,l.default)({},d,s))})):r.push(t)})),T(T({},e),{},{splitMaps:r,splitMapsToBeMerged:[].concat((0,i.default)(e.splitMapsToBeMerged),n)})}function U(e,t,r){var n=[].concat((0,i.default)(e.effects),(0,i.default)((t||[]).map((function(e){return r?(0,y.createEffect)(f.default.all([e,{isConfigActive:!1}])):e})).filter((function(e){return Boolean(e&&e.isValidToSave())}))));return T(T({},e),{},{effects:n,effectOrder:n.map((function(e){return e.id}))})}function M(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r={},n={};if(!t||!t.fieldsToShow||!Object.keys(t.fieldsToShow).length)return{mergedTooltip:n,unmergedTooltip:r};for(var a in t.fieldsToShow)!e.datasets[a]||e.isMergingDatasets[a]?r[a]=t.fieldsToShow[a]:function(){var r=e.datasets[a].fields.map((function(e){return e.name})),o=t.fieldsToShow[a].filter((function(e){return r.includes(e.name)}));n[a]=o}();return{mergedTooltip:n,unmergedTooltip:r}}function w(e,t,r){return t&&v.LAYER_BLENDINGS[t]?T(T({},e),{},{layerBlending:t}):e}function D(e,t,r){return t&&v.OVERLAY_BLENDINGS[t]?T(T({},e),{},{overlayBlending:t}):e}function N(e,t,r){return t&&t.currentTime?T(T({},e),{},{animationConfig:T(T(T({},e.animationConfig),t),{},{domain:null})}):e}function j(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a={},o=function(){var n=l[i];a[n]=T({},r[n]);var o=t[n];if(o){var u=e.findIndex((function(e){return e.name===o}));u>-1&&(a[n].fieldIdx=u,a[n].value=o)}},i=0,l=Object.keys(r);i<l.length;i++)o();var u=Object.keys(a).every((function(t){return R(a[t],a,e)}))?a:null;if(n.throwOnError){var d=Object.keys(r).filter((function(e){return!r[e].optional})).filter((function(e){return!(null!=a&&a[e].value)}));if(d.length)throw new Error("Layer has missing or invalid columns: ".concat(d.join(", ")));var s=Object.keys(t).filter((function(e){var t;return!(null!=a&&null!==(t=a[e])&&void 0!==t&&t.value)}));if(s.length)throw new Error("Layer has invalid columns: ".concat(s.join(", ")))}return u}function R(e,t,r){return!(!e.optional&&!e.value)||!!e.validator&&e.validator(e,t,r)}function k(e,t,r){var n=(0,a.default)(t,1)[0],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return(Array.isArray(r)?r:[r]).map((function(t){var r=t.field?e.find((function(e){return Object.keys(t.field).every((function(r){return t.field[r]===e[r]}))})):null;if(void 0===r&&o.throwOnError)throw new Error("Layer has invalid text label field: ".concat(JSON.stringify(t.field)));return Object.keys(n).reduce((function(e,a){return T(T({},e),{},(0,l.default)({},a,"field"===a?r:t[a]||n[a]))}),{})}))}function Y(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return Object.values(t.visualChannels).forEach((function(a){var o,i=a.field,u=a.scale,d=a.key;if(r.config){r.config[i]&&(o=e.find((function(e){return r.config&&e.name===r.config[i].name})));var s=T(T({},o?(0,l.default)({},i,o):{}),r.config[u]?(0,l.default)({},u,r.config[u]):{});if(Object.keys(s).length&&t.updateLayerConfig(s),t.validateVisualChannel(d),n.throwOnError){var f,c,p,y=null===(f=r.config)||void 0===f||null===(c=f[i])||void 0===c?void 0:c.name;if(y&&y!==(null===(p=t.config[i])||void 0===p?void 0:p.name))throw new Error("Layer has invalid visual channel field: ".concat(i))}}})),t}function X(e,t){var r=arguments.length>3?arguments[3]:void 0,n=[],a=[];return(arguments.length>2&&void 0!==arguments[2]?arguments[2]:[]).forEach((function(o){var i,l=null;null!=o&&null!==(i=o.config)&&void 0!==i&&i.dataId&&e[o.config.dataId]&&(l=Q(e[o.config.dataId],o,t,r)),l?n.push(l):a.push(o)})),{validated:n,failed:a}}function Q(e,t,r){var n=e.fields,a=e.id,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=t.type,l=o.throwOnError;if(!i||!r.hasOwnProperty(i)||!t.config){if(l)throw new Error('Layer has invalid type "'.concat(i,'" or config is missing'));return null}var u=new r[i]({id:t.id,dataId:a,label:t.config.label,color:t.config.color,isVisible:t.config.isVisible,hidden:t.config.hidden,highlightColor:t.config.highlightColor}),d=u.getLayerColumns();if(Object.keys(d)){var s=j(n,t.config.columns,d,o);if(s)u.updateLayerConfig({columns:s});else if(!o.allowEmptyColumn)return null}var f=t.config.textLabel&&u.config.textLabel?k(n,u.config.textLabel,t.config.textLabel,o):u.config.textLabel,c=u.copyLayerConfig(u.config.visConfig,t.config.visConfig||{},{shallowCopy:["colorRange","strokeColorRange"]});if(u.updateLayerConfig({visConfig:c,textLabel:f}),u=Y(n,u,t,o),l&&!u.isValidToSave())throw new Error("Layer is not valid to save: ".concat(u.id));return u}function B(e,t){var r;return t?T(T({},e),{},{editor:T(T({},e.editor),{},{features:[].concat((0,i.default)(e.editor.features),(0,i.default)(t.features||[])),visible:null!==(r=t.visible)&&void 0!==r?r:e.editor.visible})}):e}var G=[{merge:x,prop:"layers",toMergeProp:"layerToBeMerged",preserveOrder:"preserveLayerOrder"},{merge:h,prop:"filters",toMergeProp:"filterToBeMerged",preserveOrder:"preserveFilterOrder",replaceParentDatasetIds:P},{merge:U,prop:"effects"},{merge:L,prop:"interactionConfig",toMergeProp:"interactionToBeMerged",replaceParentDatasetIds:function(e,t,r){var n,a;return null!=e&&null!==(n=e.tooltip)&&void 0!==n&&n.fieldsToShow[t]?T(T({},e),{},{tooltip:T(T({},e.tooltip),{},{fieldsToShow:(0,l.default)({},r,null==e||null===(a=e.tooltip)||void 0===a?void 0:a.fieldsToShow[t])})}):null},saveUnmerged:I},{merge:w,prop:"layerBlending"},{merge:D,prop:"overlayBlending"},{merge:C,prop:"splitMaps",toMergeProp:"splitMapsToBeMerged"},{merge:N,prop:"animationConfig"},{merge:B,prop:"editor"}];t.VIS_STATE_MERGERS=G},77669:(e,t,r)=>{"use strict";var n=r(95709);Object.defineProperty(t,"__esModule",{value:!0}),t.getFileExtensions=t.getFileFormatNames=void 0;var a=n(r(21259)),o=r(38909),i=["csv","json","geojson","arrow"],l=["CSV","Json","GeoJSON","Arrow"],u=(0,o.createSelector)((function(e){return e.loaders}),(function(e){return[].concat(l,(0,a.default)(e.map((function(e){return e.name}))))}));t.getFileFormatNames=u;var d=(0,o.createSelector)((function(e){return e.loaders}),(function(e){return[].concat(i,(0,a.default)(e.flatMap((function(e){return e.extensions}))))}));t.getFileExtensions=d},59254:(e,t,r)=>{"use strict";var n=r(95709),a=r(85735);Object.defineProperty(t,"__esModule",{value:!0}),t.updateStateWithLayerAndData=B,t.updateStateOnLayerVisibilityChange=G,t.applyLayerConfigUpdater=function e(t,r){var n,a=r.oldLayerId,o=r.newLayerConfig,i=r.layerIndex,l=(0,S.parseLayerConfig)(t.schema,o),u=t.layers.find((function(e){return e.id===a}));if(!u||!l)return t;if(null!=i&&t.layers[i]!==u)return t;var d=t.datasets[l.config.dataId];if(!d)return t;var s=(0,S.validateLayerWithData)(d,l,t.layerClasses);if(!s)return t;var f=t;if(s.type&&s.type!==u.type){var c=t.layers.findIndex((function(e){return e.id===a}));if(c>=0&&(f=K(f,(0,P.layerTypeChange)(u,s.type))).layers.length===t.layers.length){var p=f.layers[c].id;f=e(f,(0,P.applyLayerConfig)(p,R(R({},o),{},{id:p})))}return f}var y,v,g,_,T=null!==(n=(0,S.serializeLayer)(u,t.schema))&&void 0!==n?n:{config:{}},h=(0,S.serializeLayer)(s,t.schema);if(!h)return t;if(!(0,A.default)(T,h)){var b=(y=T.config,v=h.config,g={},(_=function(e){Object.keys(e).forEach((function(e){g.hasOwnProperty(e)||(0,A.default)(y[e],v[e])||(g[e]=v[e])}))})(y),_(v),g);"visConfig"in b&&(b.visConfig&&(f=q(f,(0,P.layerVisConfigChange)(u,b.visConfig))),delete b.visConfig),Object.keys(u.visualChannels).forEach((function(e){var t=u.visualChannels[e],r=V.map((function(e){return t[e]}));if(r.some((function(e){return e in b}))){f=Z(f,(0,P.layerVisualChannelConfigChange)(u,(0,m.default)(s.config,r),e));var n,a=D(r);try{for(a.s();!(n=a.n()).done;){var o=n.value;delete b[o]}}catch(e){a.e(e)}finally{a.f()}}})),Object.keys(b).length>0&&(f=z(f,(0,P.layerConfigChange)(u,(0,m.default)(s.config,Object.keys(b)))))}return f},t.layerConfigChangeUpdater=z,t.layerSetIsValidUpdater=function(e,t){var r=t.oldLayer,n=t.isValid,a=e.layers.findIndex((function(e){return e.id===r.id})),o=e.layers[a];if(o){var i,l=null;if(n){var u=(0,I.calculateLayerData)(o,e,void 0);i=u.layer,l=u.layerData}else(i=o.updateLayerConfig({isVisible:!1})).isValid=!1;return B(e,{idx:a,layer:i,layerData:l})}return e},t.layerTextLabelChangeUpdater=function(e,t){var r,n,a,o=t.oldLayer,i=t.idx,u=t.prop,s=t.value,f=o.config.textLabel,c=null!==(r=null===(n=o.getDefaultLayerConfig({dataId:""}))||void 0===n||null===(a=n.textLabel)||void 0===a?void 0:a[0])&&void 0!==r?r:x.DEFAULT_TEXT_LABEL,p=f.slice();return f[i]||i!==f.length||(p=[].concat((0,l.default)(f),[c])),p="all"===i&&"fields"===u?function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:x.DEFAULT_TEXT_LABEL,n=t.slice(),a=t.map((function(e){return e.field&&e.field.name})).filter((function(e){return e})),o=e.filter((function(e){return!a.includes(e.name)})),i=a.filter((function(t){return!e.find((function(e){return e.name===t}))}));return n=(n=n.filter((function(e){return e.field&&!i.includes(e.field.name)}))).length?n:[r],n=[].concat((0,l.default)(n.filter((function(e){return e.field}))),(0,l.default)(o.map((function(e){return R(R({},r),{},{field:e})}))))}(s,f,c):function(e,t,r,n){if(!n[e].hasOwnProperty(t))return n;var a=n.slice();return"field"===t&&null===r&&n.length>1?a.splice(e,1):t&&(a=n.map((function(n,a){return a===e?R(R({},n),{},(0,d.default)({},t,r)):n}))),a}(i,u,s,p),z(e,{oldLayer:o,newConfig:{textLabel:p}})},t.layerDataIdChangeUpdater=W,t.setInitialLayerConfig=H,t.layerTypeChangeUpdater=K,t.layerVisualChannelChangeUpdater=Z,t.layerVisConfigChangeUpdater=q,t.setFilterAnimationTimeUpdater=function(e,t){return J(e,t)},t.setFilterAnimationWindowUpdater=function(e,t){var r=t.id,n=t.animationWindow;return R(R({},e),{},{filters:e.filters.map((function(e){return e.id===r?R(R({},e),{},{animationWindow:n}):e}))})},t.setFilterUpdater=J,t.removeLayerUpdater=te,t.removeDatasetUpdater=ne,t.interactionConfigChangeUpdater=function(e,t){var r=t.config,n=R(R({},e.interactionConfig),(0,d.default)({},r.id,r)),a=["brush","tooltip"];a.includes(r.id)&&r.enabled&&!e.interactionConfig[r.id].enabled&&a.forEach((function(e){e!==r.id&&(n[e]=R(R({},n[e]),{},{enabled:!1}))}));var o=R(R({},e),{},{interactionConfig:n});return"geocoder"!==r.id||r.enabled?o:ne(o,{dataId:"geocoder_dataset"})},t.applyMergersUpdater=ie,t.renameDatasetUpdater=function(e,t){return de(e,{dataId:t.dataId,props:{label:t.label}})},t.updateDatasetPropsUpdater=de,t.closeSpecificMapAtIndex=se,t.loadFileStepSuccessUpdater=function(e,t){if(!e.fileLoading)return e;var r=t.fileName,n=t.fileCache,a=e.fileLoading,o=a.filesToLoad,i=a.onFinish,l=me(e,{fileName:r,progress:{percent:1,message:"Done"}}),u=(0,F.pick_)("fileLoading")((0,F.merge_)({fileCache:n}))(l);return(0,c.withTask)(u,(0,h.DELAY_TASK)(200).map(o.length?P.loadNextFile:function(){return i(n)}))},t.loadNextFileUpdater=fe,t.makeLoadFileTask=ce,t.processFileContentUpdater=function(e,t){var r=t.payload,n=r.content,a=r.fileCache,o=me(e,{fileName:n.fileName,progress:{percent:1,message:"processing..."}});return(0,c.withTask)(o,(0,h.PROCESS_FILE_DATA)({content:n,fileCache:a}).bimap((function(e){return(0,P.loadFileStepSuccess)({fileName:n.fileName,fileCache:e})}),(function(e){return(0,P.loadFilesErr)(n.fileName,e)})))},t.parseProgress=pe,t.addDefaultLayers=ye,t.addDefaultTooltips=ve,t.initialFileLoadingProgress=ge,t.updateFileLoadingProgressUpdater=me,t.updateAllLayerDomainData=Ae,t.updateAnimationDomain=_e,t.setFeaturesUpdater=function(e,t){var r=t.features,n=void 0===r?[]:r,a=n.length&&n[n.length-1],o=R(R({},e),{},{editor:R(R({},e.editor),{},{features:n.filter((function(e){return!(0,b.getFilterIdInFeature)(e)})),mode:a&&a.properties.isClosed?x.EDITOR_MODES.EDIT:e.editor.mode})}),i=e.editor.selectedFeature;if(!i)return o;var l=n.find((function(e){return e.id===i.id})),u=l&&(0,b.getFilterIdInFeature)(l);if(u&&l){l.properties&&(l.properties.bbox=(0,s.default)(l));var d=(0,b.featureToFilterValue)(l,u);return J(o,{idx:e.filters.findIndex((function(e){return e.id===u})),prop:"value",value:d})}return o},t.deleteFeatureUpdater=function(e,t){var r=t.feature;if(!r)return e;var n=R(R({},e),{},{editor:R(R({},e.editor),{},{selectedFeature:null})});if((0,b.getFilterIdInFeature)(r)){var a=n.filters.findIndex((function(e){return e.id===(0,b.getFilterIdInFeature)(r)}));return a>-1?$(n,{idx:a}):n}var o=R(R({},e.editor),{},{features:e.editor.features.filter((function(e){return e.id!==r.id})),selectedFeature:null});return R(R({},e),{},{editor:o})},t.setPolygonFilterLayerUpdater=function(e,t){var r,n=t.layer,a=t.feature,o=(0,b.getFilterIdInFeature)(a),i=[n.id],u=e;if(o){if(r=e.filters.findIndex((function(e){return e.id===o})),!e.filters[r]){var d=R(R({},a),{},{properties:R(R({},a.properties),{},{filterId:null})});return R(R({},e),{},{editor:R(R({},e.editor),{},{features:[].concat((0,l.default)(e.editor.features),[d]),selectedFeature:d})})}var s=e.filters[r].layerId,f=void 0===s?[]:s;i=f.includes(n.id)?f.filter((function(e){return e!==n.id})):[].concat((0,l.default)(f),[n.id])}else{var c=(0,b.generatePolygonFilter)([],a);r=e.filters.length,u=R(R({},e),{},{filters:[].concat((0,l.default)(e.filters),[c]),editor:R(R({},e.editor),{},{features:e.editor.features.filter((function(e){return e.id!==a.id})),selectedFeature:c.value})})}return J(u,{idx:r,prop:"layerId",value:i})},t.sortTableColumnUpdater=function(e,t){var r=t.dataId,n=t.column,a=t.mode,o=e.datasets[r];if(!o)return e;var i=a;if(!i){var l=(0,v.default)(o,["sortColumn",n]);i=l?Object.keys(x.SORT_ORDER).find((function(e){return e!==l})):x.SORT_ORDER.ASCENDING}var u=(0,C.sortDatasetByColumn)(o,n,i);return(0,b.set)(["datasets",r],u,e)},t.pinTableColumnUpdater=function(e,t){var r=t.dataId,n=t.column,a=e.datasets[r];if(!a)return e;var o=(0,C.pinTableColumns)(a,n);return(0,b.set)(["datasets",r],o,e)},t.copyTableColumnUpdater=function(e,t){var r=t.dataId,n=t.column,a=e.datasets[r];if(!a)return e;var o=a.fields.findIndex((function(e){return e.name===n}));if(o<0)return e;var i=a.fields[o].type,l=a.dataContainer.map((function(e){return(0,b.parseFieldValue)(e.valueAt(o),i)}),!0).join("\n");return(0,_.default)(l),e},t.setColumnDisplayFormatUpdater=function(e,t){var r=t.dataId,n=t.formats,a=e.datasets[r];if(!a)return e;var o=a.fields;Object.keys(n).forEach((function(e){var t=a.fields.findIndex((function(t){return t.name===e}));if(t>=0){var r=n[e],i=o[t];o=(0,F.swap_)((0,F.merge_)({displayFormat:r})(i))(o)}}));var i=(0,C.copyTableAndUpdate)(a,{fields:o});return(0,F.pick_)("datasets")((0,F.merge_)((0,d.default)({},r,i)))(e)},t.toggleEditorVisibilityUpdater=function(e,t){return R(R({},e),{},{editor:R(R({},e.editor),{},{visible:!e.editor.visible})})},t.setFilterAnimationTimeConfigUpdater=function(e,t){var r=t.idx,n=t.config,a=e.filters[r];if(!a)return f.console.error("filters.".concat(r," is undefined")),e;if(a.type!==x.FILTER_TYPES.timeRange)return f.console.error("setFilterAnimationTimeConfig can only be called to update a time filter. check filter.type === 'timeRange'"),e;var o=Te(n);return(0,F.pick_)("filters")((0,F.swap_)((0,F.merge_)(o)(a)))(e)},t.setLayerAnimationTimeConfigUpdater=function(e,t){var r=t.config;if(!r)return e;var n=Te(r);return(0,F.pick_)("animationConfig")((0,F.merge_)(n))(e)},t.prepareStateForDatasetReplace=function(e,t,r){var n,a,o=(0,S.serializeVisState)(e,e.schema),i=be(e,t,r),u=(0,l.default)(e.layerOrder);(i.preserveDatasetOrder=Object.keys(e.datasets).map((function(e){return e===t?r:e})),null!==(n=i.layerToBeMerged)&&void 0!==n&&n.length)&&(i.splitMapsToBeMerged=null!==(a=null==o?void 0:o.splitMaps)&&void 0!==a?a:[],i.layerOrder=(0,l.default)(u));return i},t.replaceDatasetDepsInState=Se,t.setSelectedFeatureUpdater=t.setEditorModeUpdater=t.setMapInfoUpdater=t.applyCPUFilterUpdater=t.loadFilesErrUpdater=t.nextFileBatchUpdater=t.loadFilesUpdater=t.updateVisDataUpdater=t.toggleLayerForMapUpdater=t.toggleSplitMapUpdater=t.mouseMoveUpdater=t.mapClickUpdater=t.layerClickUpdater=t.layerHoverUpdater=t.receiveMapConfigUpdater=t.resetMapConfigUpdater=t.updateTableColorUpdater=t.showDatasetTableUpdater=t.updateOverlayBlendingUpdater=t.updateLayerBlendingUpdater=t.updateEffectUpdater=t.reorderEffectUpdater=t.removeEffectUpdater=t.addEffectUpdater=t.duplicateLayerUpdater=t.reorderLayerUpdater=t.addLayerUpdater=t.removeFilterUpdater=t.toggleFilterFeatureUpdater=t.setFilterViewUpdater=t.updateLayerAnimationSpeedUpdater=t.setLayerAnimationTimeUpdater=t.updateFilterAnimationSpeedUpdater=t.toggleLayerAnimationControlUpdater=t.toggleLayerAnimationUpdater=t.toggleFilterAnimationUpdater=t.layerColorUIChangeUpdater=t.addFilterUpdater=t.setFilterPlotUpdater=t.INITIAL_VIS_STATE=t.DEFAULT_EDITOR=t.DEFAULT_ANIMATION_CONFIG=t.defaultInteractionConfig=void 0;var o=n(r(15890)),i=n(r(22056)),l=n(r(21259)),u=n(r(39892)),d=n(r(26396)),s=n(r(25697)),f=r(89840),c=r(13370),p=n(r(67193)),y=n(r(90879)),v=n(r(16762)),g=n(r(18039)),m=n(r(91863)),A=n(r(8142)),_=n(r(17965)),T=n(r(14744)),h=r(16441),P=r(99150),b=r(77244),S=r(91978),O=r(79269),E=r(40441),x=r(13848),F=r(75544),L=n(r(50094)),I=r(95937),C=r(68747),U=r(52819),M=r(18761);function w(e){var t=function(e){if("object"!==a(e)||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!==a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===a(t)?t:String(t)}function D(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return N(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?N(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return i=e.done,e},e:function(e){l=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(l)throw o}}}}function N(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function j(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function R(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?j(Object(r),!0).forEach((function(t){(0,d.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):j(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}(0,c.disableStackCapturing)();var k={tooltip:{id:"tooltip",label:"interactions.tooltip",enabled:!0,config:{fieldsToShow:{},compareMode:!1,compareType:x.COMPARE_TYPES.ABSOLUTE}},geocoder:{id:"geocoder",label:"interactions.geocoder",enabled:!1,position:null},brush:{id:"brush",label:"interactions.brush",enabled:!1,config:{size:.5}},coordinate:{id:"coordinate",label:"interactions.coordinate",enabled:!1,position:null}};t.defaultInteractionConfig=k;var Y={domain:null,currentTime:null,speed:1,isAnimating:!1,timeFormat:null,timezone:null,defaultTimeFormat:null,hideControl:!1,duration:null};t.DEFAULT_ANIMATION_CONFIG=Y;var X={mode:x.EDITOR_MODES.DRAW_POLYGON,features:[],selectedFeature:null,visible:!0};t.DEFAULT_EDITOR=X;var Q={mapInfo:{title:"",description:""},layers:[],layerData:[],layerToBeMerged:[],layerOrder:[],filters:[],filterToBeMerged:[],datasets:{},editingDataset:void 0,effects:[],effectOrder:[],interactionConfig:k,interactionToBeMerged:{},layerBlending:"normal",overlayBlending:"normal",hoverInfo:void 0,clicked:void 0,mousePos:{},maxDefaultTooltips:x.MAX_DEFAULT_TOOLTIPS,splitMaps:[],splitMapsToBeMerged:[],isMergingDatasets:{},layerClasses:E.LayerClasses,animationConfig:Y,editor:X,fileLoading:!1,fileLoadingProgress:{},loaders:[],loadOptions:{},mergers:S.VIS_STATE_MERGERS,schema:L.default};function B(e,t){var r=t.layerData,n=t.layer,a=t.idx;return R(R({},e),{},{layers:e.layers.map((function(e,t){return t===a?n:e})),layerData:r?e.layerData.map((function(e,t){return t===a?r:e})):e.layerData})}function G(e,t){var r=e;return e.splitMaps.length&&(r=R(R({},e),{},{splitMaps:t.config.isVisible?(0,b.addNewLayersToSplitMap)(e.splitMaps,t):(0,b.removeLayerFromSplitMaps)(e.splitMaps,t)})),t.config.animation.enabled&&(r=_e(e)),r}t.INITIAL_VIS_STATE=Q;var V=["field","scale","domain","aggregation"];function z(e,t){var r=t.oldLayer,n=e.layers.findIndex((function(e){return e.id===r.id})),a=Object.keys(t.newConfig);if("string"==typeof t.newConfig.dataId&&t.newConfig.dataId!==r.config.dataId){var o=t.newConfig,i=o.dataId,l=(0,u.default)(o,["dataId"]),d=W(e,{oldLayer:r,newConfig:{dataId:i}}),s=d.layers.find((function(e){return e.id===r.id}));return s&&Object.keys(l).length?z(d,{oldLayer:s,newConfig:l}):d}var f,c=r.updateLayerConfig(t.newConfig);if(c.shouldCalculateLayerData(a)){var p=e.layerData[n],y=(0,I.calculateLayerData)(c,e,p);c=y.layer,f=y.layerData}var v=e;return"isVisible"in t.newConfig&&(v=G(e,c)),B(v,{layer:c,layerData:f,idx:n})}function W(e,t){var r=t.oldLayer,n=t.newConfig.dataId;if(!r||!e.datasets[n])return e;var a,o,i,l,u,d=e.layers.findIndex((function(e){return e.id===r.id})),s=r.updateLayerConfig({dataId:n});s.isValidToSave()&&(s=(a=e.datasets[n],o=e.layerClasses,i=s,l=e.schema,(u=(0,S.serializeLayer)(i,l))?(0,S.validateLayerWithData)(a,u,o,{allowEmptyColumn:!0}):null)||new e.layerClasses[r.type]({dataId:n,id:r.id}));(s=s.updateLayerConfig({isVisible:r.config.isVisible,isConfigActive:!0})).updateLayerDomain(e.datasets);var f=(0,I.calculateLayerData)(s,e,void 0);return B(e,{layerData:f.layerData,layer:f.layer,idx:d})}function H(e,t,r){var n=e;if(!Object.keys(t).length)return e;e.config.dataId||(n=e.updateLayerConfig({dataId:Object.keys(t)[0]}));var a=t[n.config.dataId];if(!a)return e;var o="function"==typeof r[n.type].findDefaultLayerProps?r[n.type].findDefaultLayerProps(a,[]):{props:[]},i=Array.isArray(o)?o:o.props||[];return i.length&&"function"==typeof(n=new r[e.type](R(R({},i[0]),{},{label:n.config.label,dataId:n.config.dataId,isVisible:!0,isConfigActive:n.config.isConfigActive}))).setInitialLayerConfig?n.setInitialLayerConfig(a):n}function K(e,t){var r=t.oldLayer,n=t.newType;if(!r)return e;var a=r.id,o=e.layers.findIndex((function(e){return e.id===a}));if(!e.layerClasses[n])return f.console.error("".concat(n," is not a valid layer type")),e;var i=new e.layerClasses[n]({label:r.config.label,isConfigActive:r.config.isConfigActive,dataId:r.config.dataId});r.type?(i.assignConfigToLayer(r.config,r.visConfigSettings),i.updateLayerDomain(e.datasets)):i=H(i,e.datasets,e.layerClasses);var l=e.clicked,s=e.hoverInfo,c=R(R({},e),{},{clicked:r.isLayerHovered(l)?void 0:l,hoverInfo:r.isLayerHovered(s)?void 0:s}),p=(0,I.calculateLayerData)(i,c),y=p.layerData,v=p.layer;return c=B(c,{layerData:y,layer:v,idx:o}),(v.config.animation.enabled||r.config.animation.enabled)&&(c=_e(c)),e.splitMaps.length&&(c=R(R({},c),{},{splitMaps:c.splitMaps.map((function(e){var t=e.layers,r=t[a],n=(0,u.default)(t,[a].map(w));return a in e.layers?R(R({},e),{},{layers:R(R({},n),{},(0,d.default)({},v.id,r))}):e}))})),R(R({},c),{},{layerOrder:c.layerOrder.map((function(e){return e===r.id?i.id:e}))})}function Z(e,t){var r=t.oldLayer,n=t.newConfig,a=t.channel;if(!r.config.dataId)return e;var o=e.datasets[r.config.dataId],i=e.layers.findIndex((function(e){return e.id===r.id})),l=r.updateLayerConfig(n);l.updateLayerVisualChannel(o,a);var u=e.layerData[i],d=(0,I.calculateLayerData)(l,e,u);return B(e,{layerData:d.layerData,layer:d.layer,idx:i})}function q(e,t){var r=t.oldLayer,n=e.layers.findIndex((function(e){return e.id===r.id})),a=Object.keys(t.newVisConfig),o=R(R({},r.config.visConfig),t.newVisConfig),i=r.updateLayerConfig({visConfig:o});if(i.shouldCalculateLayerData(a)){var l=e.layerData[n],u=(0,I.calculateLayerData)(i,e,l);return B(e,{layerData:u.layerData,layer:u.layer,idx:n})}return B(e,{layer:i,idx:n})}function J(e,t){var r,n=t.idx,a=t.prop,o=t.value,i=t.valueIndex,l=void 0===i?0:i,u=e.filters[n];if(!u)return f.console.error("filters.".concat(n," is undefined")),e;var d=(0,b.set)([a],o,u),s=e,c=d.dataId,p=(0,b.toArray)(c);switch(a){case b.FILTER_UPDATER_PROPS.dataId:d=(0,b.updateFilterDataId)(c);break;case b.FILTER_UPDATER_PROPS.name:var m=d.dataId[l],A=(0,b.applyFilterFieldName)(d,e.datasets[m],o,l,{mergeDomain:!1}),_=A.filter,T=A.dataset;if(!_)return e;(d=_).gpu&&(d=(0,C.setFilterGpuMode)(d,e.filters),d=(0,C.assignGpuChannel)(d,e.filters)),s=(0,b.set)(["datasets",m],T,e);break;case b.FILTER_UPDATER_PROPS.layerId:var h=(0,g.default)(d.layerId,u.layerId);p=(0,y.default)(h.map((function(t){return(0,v.default)(e.layers.find((function(e){return e.id===t})),["config","dataId"])})).filter((function(e){return e})));var P=(0,y.default)(null===(r=d.layerId)||void 0===r?void 0:r.map((function(t){return(0,v.default)(e.layers.find((function(e){return e.id===t})),["config","dataId"])})).filter((function(e){return e})));d=R(R({},d),{},{dataId:P})}var S=e.filters.find((function(e){return e.view===x.FILTER_VIEW_TYPES.enlarged}));S&&S.id!==d.id&&(d.view=x.FILTER_VIEW_TYPES.side),s=(0,b.set)(["filters",n],d,s);var O=b.LIMITED_FILTER_EFFECT_PROPS[a]?[p[l]]:p,E=(0,b.applyFiltersToDatasets)(O,s.datasets,s.filters,s.layers);return Ae(s=(0,b.set)(["datasets"],E,s),O,d)}t.setFilterPlotUpdater=function(e,t){var r=t.idx,n=t.newProp,a=t.valueIndex,o=void 0===a?0:a,i=R(R({},e.filters[r]),n);if("yAxis"===Object.keys(n)[0]){var l=(0,b.getDefaultFilterPlotType)(i);l&&(i=R(R(R({},i),(0,b.getFilterPlot)(R(R({},i),{},{plotType:l}),e.datasets[i.dataId[o]])),{},{plotType:l}))}return R(R({},e),{},{filters:e.filters.map((function(e,t){return t===r?i:e}))})},t.addFilterUpdater=function(e,t){return t.dataId?R(R({},e),{},{filters:[].concat((0,l.default)(e.filters),[(0,b.getDefaultFilter)({dataId:t.dataId,id:t.id})])}):e},t.layerColorUIChangeUpdater=function(e,t){var r=t.oldLayer,n=t.prop,a=t.newConfig,o=r.config.visConfig[n],i=r.updateLayerColorUI(n,a),l=i.config.visConfig[n];return o!==l?q(e,{oldLayer:r,newVisConfig:(0,d.default)({},n,l)}):R(R({},e),{},{layers:e.layers.map((function(e){return e.id===r.id?i:e}))})},t.toggleFilterAnimationUpdater=function(e,t){return R(R({},e),{},{filters:e.filters.map((function(e,r){return r===t.idx?R(R({},e),{},{isAnimating:!e.isAnimating}):e}))})},t.toggleLayerAnimationUpdater=function(e,t){return R(R({},e),{},{animationConfig:R(R({},e.animationConfig),{},{isAnimating:!e.animationConfig.isAnimating})})},t.toggleLayerAnimationControlUpdater=function(e,t){return R(R({},e),{},{animationConfig:R(R({},e.animationConfig),{},{hideControl:!e.animationConfig.hideControl})})},t.updateFilterAnimationSpeedUpdater=function(e,t){return R(R({},e),{},{filters:e.filters.map((function(e,r){return r===t.idx?R(R({},e),{},{speed:t.speed}):e}))})},t.setLayerAnimationTimeUpdater=function(e,t){var r=t.value;return R(R({},e),{},{animationConfig:R(R({},e.animationConfig),{},{currentTime:r})})},t.updateLayerAnimationSpeedUpdater=function(e,t){var r=t.speed;return R(R({},e),{},{animationConfig:R(R({},e.animationConfig),{},{speed:r})})},t.setFilterViewUpdater=function(e,t){var r=t.view,n=t.idx,a=r===x.FILTER_VIEW_TYPES.enlarged;return R(R({},e),{},{filters:e.filters.map((function(e,t){return t===n?R(R({},e),{},{view:r}):a?R(R({},e),{},{view:x.FILTER_VIEW_TYPES.side}):e}))})},t.toggleFilterFeatureUpdater=function(e,t){var r=e.filters[t.idx],n=(0,v.default)(r,["value","properties","isVisible"]),a=J(e,{idx:t.idx,prop:"enabled",value:!n});return J(a,{idx:t.idx,prop:"value",value:(0,b.featureToFilterValue)(r.value,r.id,{isVisible:!n})})};var $=function(e,t){var r=t.idx,n=e.filters[r],a=n.dataId,o=n.id,i=[].concat((0,l.default)(e.filters.slice(0,r)),(0,l.default)(e.filters.slice(r+1,e.filters.length))),u=(0,b.applyFiltersToDatasets)(a,e.datasets,i,e.layers),d=(0,b.getFilterIdInFeature)(e.editor.selectedFeature)===o?R(R({},e.editor),{},{selectedFeature:null}):e.editor,s=(0,b.set)(["filters"],i,e);return s=(0,b.set)(["datasets"],u,s),Ae(s=(0,b.set)(["editor"],d,s),a,void 0)};t.removeFilterUpdater=$;var ee=function(e,t){var r,n;if(t.config){if(!(r=(0,S.createLayerFromConfig)(e,t.config)))return f.console.warn("Failed to create layer from config, it usually means the config is not be in correct format",t.config),e;var a=(0,I.calculateLayerData)(r,e);r=a.layer,n=a.layerData}else{var o,i=null!==(o=t.datasetId)&&void 0!==o?o:Object.keys(e.datasets)[0];r=new E.Layer({isVisible:!0,isConfigActive:!0,dataId:i}),n={}}var u=R(R({},e),{},{layers:[].concat((0,l.default)(e.layers),[r]),layerData:[].concat((0,l.default)(e.layerData),[n]),layerOrder:[r.id].concat((0,l.default)(e.layerOrder)),splitMaps:(0,b.addNewLayersToSplitMap)(e.splitMaps,r)});return r.config.animation.enabled&&(u=_e(u)),u};function te(e,t){var r=t.id,n=Number.isFinite(r)?Number(r):e.layers.findIndex((function(e){return e.id===r}));if(n<0||n>=e.layers.length)return f.console.warn("can not remove layer with invalid id|idx ".concat(r)),e;var a=e.layers,o=e.layerData,i=e.layerOrder,l=e.clicked,u=e.hoverInfo,d=a[n];return _e(R(R({},e),{},{layers:(0,F.filterOutById)(d.id)(a),layerData:(0,F.removeElementAtIndex)(n)(o),layerOrder:i.filter((function(e){return e!==d.id})),clicked:d.isLayerHovered(l)?void 0:l,hoverInfo:d.isLayerHovered(u)?void 0:u,splitMaps:(0,b.removeLayerFromSplitMaps)(e.splitMaps,d)}))}t.addLayerUpdater=ee;var re=function(e,t){var r=t.order;return R(R({},e),{},{layerOrder:r})};function ne(e,t){var r=t.dataId;if(!e.datasets[r])return e;var n=e.layers,a=e.datasets,o=(a[r],(0,u.default)(a,[r].map(w))),i=n.filter((function(e){return e.config.dataId===r})).map((function(e){return e.id})).reduce((function(e,t){return te(e,{id:t})}),R(R({},e),{},{datasets:o})),l=i.filters.filter((function(e){return!e.dataId.includes(r)}));return function(e,t){var r=t.dataId,n=e.interactionConfig,a=n.tooltip;if(a){var o=a.config,i=o.fieldsToShow,l=(i[r],(0,u.default)(i,[r].map(w)));n=R(R({},n),{},{tooltip:R(R({},a),{},{config:R(R({},o),{},{fieldsToShow:l})})})}return R(R({},e),{},{interactionConfig:n})}(i=R(R({},i),{},{filters:l}),{dataId:r})}t.reorderLayerUpdater=re,t.duplicateLayerUpdater=function(e,t){var r=t.id,n=Number.isFinite(r)?Number(r):e.layers.findIndex((function(e){return e.id===r}));if(n<0||!e.layers[n])return f.console.warn("layer ".concat(n," not found in layerOrder")),e;for(var a=e.layers,o=a[n],i=e.layerOrder.findIndex((function(e){return e===o.id})),l="Copy of ".concat(o.config.label),u=0;a.find((function(e){return e.config.label===l}));)l="Copy of ".concat(o.config.label," ").concat(++u);var d=(0,S.serializeLayer)(o,e.schema);if(null==d||!d.config)return e;d.config.label=l,d.id=(0,b.generateHashId)(E.LAYER_ID_LENGTH);var s=ee(e,{config:d}),c=s.layers[s.layers.length-1],p=(0,b.arrayInsert)(s.layerOrder.slice(1,s.layerOrder.length),i,c.id);return _e(s=re(s,{order:p}))},t.addEffectUpdater=function(e,t){var r=(0,M.createEffect)(t.config);e.effects.forEach((function(e){return e.setProps({isConfigActive:!1})}));var n=[].concat((0,l.default)(e.effects),[r]),a=(0,b.fixEffectOrder)(n,[r.id].concat((0,l.default)(e.effectOrder)));return R(R({},e),{},{effects:n,effectOrder:a})},t.removeEffectUpdater=function(e,t){var r=t.id,n=e.effects.findIndex((function(e){return e.id===r}));if(n<0||n>=e.effects.length)return f.console.warn("can not remove effect with invalid id ".concat(r)),e;var a=e.effects,o=e.effectOrder,i=a[n];return R(R({},e),{},{effects:(0,F.filterOutById)(i.id)(a),effectOrder:o.filter((function(e){return e!==i.id}))})},t.reorderEffectUpdater=function(e,t){var r=t.order;return R(R({},e),{},{effectOrder:(0,b.fixEffectOrder)(e.effects,(0,l.default)(r))})},t.updateEffectUpdater=function(e,t){var r=t.id,n=t.props,a=e.effects.findIndex((function(e){return e.id===r}));if(a<0||a>=e.effects.length)return f.console.warn("can not update effect with invalid id ".concat(r)),e;var o=e.effectOrder;if(void 0!==n.id&&n.id!==r){if(e.effects.findIndex((function(e){return e.id===n.id}))>=0)return f.console.warn("can not update effect with existing effect id ".concat(r)),e;o=o.map((function(e){return e===r?n.id:e}))}var i=(0,l.default)(e.effects);return i[a].setProps(n),R(R({},e),{},{effects:i,effectOrder:o})},t.updateLayerBlendingUpdater=function(e,t){return R(R({},e),{},{layerBlending:t.mode})},t.updateOverlayBlendingUpdater=function(e,t){return R(R({},e),{},{overlayBlending:t.mode})},t.showDatasetTableUpdater=function(e,t){return R(R({},e),{},{editingDataset:t.dataId})},t.updateTableColorUpdater=function(e,t){return de(e,{dataId:t.dataId,props:{color:t.newColor}})};var ae=function(e){return R(R(R({},Q),e.initialState),{},{initialState:e.initialState})};t.resetMapConfigUpdater=ae;var oe=function(e,t){var r=t.payload,n=r.config,a=void 0===n?{}:n,o=r.options,i=void 0===o?{}:o;if(!a.visState)return e;var l,u=i.keepExistingConfig?e:ae(e),d=D(e.mergers);try{for(d.s();!(l=d.n()).done;){var s=l.value;(0,O.isValidMerger)(s)&&(0,O.hasPropsToMerge)(a.visState,s.prop)&&(u=s.merge(u,(0,O.getPropValueToMerger)(a.visState,s.prop,s.toMergeProp),!0))}}catch(e){d.e(e)}finally{d.f()}return u};function ie(e,t){var r=t.mergers,n=t.postMergerPayload,a=(0,O.mergeStateFromMergers)(e,R(R({},Q),e.initialState),r,n);return a.allMerged?function(e,t){var r=t.newDataIds,n=t.options,a=t.layerMergers,o=e.filters.filter((function(e){return e.dataId.find((function(e){return r.includes(e)}))})),i=(0,y.default)(o.reduce((function(e,t){return[].concat((0,l.default)(e),(0,l.default)(t.dataId))}),[])),u=r.length<1,s=u?[]:e.layers.filter((function(e){return e.config.dataId&&r.includes(e.config.dataId)})),f=r.reduce((function(t,r){return R(R({},t),{},(0,d.default)({},r,e.datasets[r]))}),{});if(!s.length&&!1!==(n||{}).autoCreateLayers){var c=ye(e,f);e=c.state,s=c.newLayers}e.splitMaps.length&&(s=e.layers.filter((function(e){return e.config.dataId&&r.includes(e.config.dataId)})),e=R(R({},e),{},{splitMaps:(0,b.addNewLayersToSplitMap)(e.splitMaps,s)})),r.forEach((function(t){var r=e.interactionConfig.tooltip.config.fieldsToShow[t];!1===(null==n?void 0:n.autoCreateTooltips)||Array.isArray(r)&&r.length||(e=ve(e,f[t]))}));var p=u?Object.keys(e.datasets):(0,y.default)(Object.keys(f).concat(i)),v=Ae(e,p,void 0);return v=_e(v),a&&a.length>0?ie(v,{mergers:a,postMergerPayload:R(R({},t),{},{layerMergers:[]})}):v}(a.mergedState,n):a.mergedState}t.receiveMapConfigUpdater=oe,t.layerHoverUpdater=function(e,t){return R(R({},e),{},{hoverInfo:R({},t.info)})},t.layerClickUpdater=function(e,t){return R(R({},e),{},{mousePos:e.interactionConfig.coordinate.enabled?R(R({},e.mousePos),{},{pinned:e.mousePos.pinned?null:(0,p.default)(e.mousePos)}):e.mousePos,clicked:t.info&&t.info.picked?t.info:null})},t.mapClickUpdater=function(e,t){return R(R({},e),{},{clicked:null})},t.mouseMoveUpdater=function(e,t){var r=t.evt;return Object.values(e.interactionConfig).some((function(e){return e.enabled}))?R(R({},e),{},{mousePos:R(R(R({},e.mousePos),Array.isArray(r.point)?{mousePosition:(0,l.default)(r.point)}:{}),Array.isArray(r.lngLat)?{coordinate:(0,l.default)(r.lngLat)}:{})}):e},t.toggleSplitMapUpdater=function(e,t){return e.splitMaps&&0===e.splitMaps.length?R(R({},e),{},{splitMaps:(0,b.computeSplitMapLayers)(e.layers,{duplicate:!1})}):se(e,t)},t.toggleLayerForMapUpdater=function(e,t){var r=t.mapIndex,n=t.layerId,a=e.splitMaps;return R(R({},e),{},{splitMaps:a.map((function(e,t){return t===r?R(R({},a[t]),{},{layers:R(R({},a[t].layers),{},(0,d.default)({},n,!a[t].layers[n]))}):e}))})},t.updateVisDataUpdater=function(e,t){var r=t.config,n=t.options,a=r?oe(e,{payload:{config:r,options:n}}):e,o=(0,b.toArray)(t.datasets).reduce((function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.info,a=void 0===n?{}:n,o=(0,u.default)(r,["info"]);return R(R({},t),(0,C.createNewDataEntry)(R({info:a},o),e.datasets)||{})}),{}),i=R(R({},a),{},{datasets:(0,S.mergeDatasetsByOrder)(a,o)}),l=e.mergers.filter((function(e){return e.waitForLayerData}));return ie(i,{mergers:e.mergers.filter((function(e){return!l.includes(e)})),postMergerPayload:{newDataIds:Object.keys(o),options:n,layerMergers:l}})};var le=["label","color","metadata"],ue=function(e,t){return Object.entries(e).reduce((function(e,r){var n=(0,i.default)(r,2),a=n[0],o=n[1];return le.includes(a)&&("color"!==a||(0,b.isRgbColor)(o))?R(R({},e),{},(0,d.default)({},a,(0,b.isPlainObject)(o)?(0,T.default)(t[a]||{},o):o)):e}),{})};function de(e,t){var r=t.dataId,n=t.props,a=e.datasets,o=a[r];if(o){var i=ue(n,o);return R(R({},e),{},{datasets:R(R({},a),{},(0,d.default)({},r,(0,C.copyTableAndUpdate)(o,i)))})}return e}function se(e,t){var r,n=1-t.payload,a=null===(r=e.splitMaps[n])||void 0===r?void 0:r.layers,o=e.layers.map((function(e){return a&&!a[e.id]&&e.config.isVisible?e.updateLayerConfig({isVisible:!1}):e}));return R(R({},e),{},{layers:o,splitMaps:[]})}function fe(e){if(!e.fileLoading)return e;var t=e.fileLoading.filesToLoad,r=(0,o.default)(t),n=r[0],a=r.slice(1),i=(0,F.pick_)("fileLoading")((0,F.merge_)({filesToLoad:a}))(e),l=me(i,{fileName:n.name,progress:{percent:0,message:"loading..."}}),u=e.loaders,d=e.loadOptions;return(0,c.withTask)(l,ce(n,i.fileLoading&&i.fileLoading.fileCache,u,d))}function ce(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return(0,h.LOAD_FILE_TASK)({file:e,fileCache:t,loaders:r,loadOptions:n}).bimap((function(r){return(0,P.nextFileBatch)({gen:r,fileName:e.name,onFinish:function(e){return(0,P.processFileContent)({content:e,fileCache:t})}})}),(function(t){return(0,P.loadFilesErr)(e.name,t)}))}function pe(){var e=arguments.length>1?arguments[1]:void 0;return e&&e.percent?{percent:e.percent}:{}}function ye(e,t){var r=Object.values(t).reduce((function(t,r){var n=(0,I.findDefaultLayer)(r,e.layerClasses);return n&&n.length?t.concat(n):t}),[]);return{state:R(R({},e),{},{layers:[].concat((0,l.default)(e.layers),(0,l.default)(r)),layerOrder:[].concat((0,l.default)((0,I.getLayerOrderFromLayers)(r)),(0,l.default)(e.layerOrder))}),newLayers:r}}function ve(e,t){var r=(0,U.findFieldsToShow)(R(R({},t),{},{maxDefaultTooltips:e.maxDefaultTooltips})),n=R(R({},e.interactionConfig.tooltip.config.fieldsToShow),r);return(0,b.set)(["interactionConfig","tooltip","config","fieldsToShow"],n,e)}function ge(e,t){var r=e.name||"Untitled File ".concat(t);return(0,d.default)({},r,{percent:0,message:"",fileName:r,error:null})}function me(e,t){var r=t.fileName,n=t.progress;return(0,F.pick_)("fileLoadingProgress")((0,F.pick_)(r)((0,F.merge_)(n)))(e)}function Ae(e,t,r){var n="string"==typeof t?[t]:t,a=[],o=[];return e.layers.forEach((function(t,i){if(t.config.dataId&&n.includes(t.config.dataId)){var l=r&&r.fixedDomain?t:t.updateLayerDomain(e.datasets,r),u=(0,I.calculateLayerData)(l,e,e.layerData[i]),d=u.layerData,s=u.layer;a.push(s),o.push(d)}else a.push(t),o.push(e.layerData[i])})),R(R({},e),{},{layers:a,layerData:o})}function _e(e){var t=e.layers.filter((function(e){return e.config.isVisible&&e.config.animation&&e.config.animation.enabled&&Array.isArray(e.animationDomain)}));if(!t.length)return R(R({},e),{},{animationConfig:R(R({},e.animationConfig),{},{domain:null,defaultTimeFormat:null})});var r=t.reduce((function(e,t){return[Math.min(e[0],t.animationDomain[0]),Math.max(e[1],t.animationDomain[1])]}),[Number(1/0),-1/0]),n=(0,b.getTimeWidgetTitleFormatter)(r);return R(R({},e),{},{animationConfig:R(R({},e.animationConfig),{},{currentTime:(0,b.isInRange)(e.animationConfig.currentTime,r)?e.animationConfig.currentTime:r[0],domain:r,defaultTimeFormat:n})})}function Te(e){var t=["timeFormat","timezone"];return Object.keys(e).reduce((function(r,n){return t.includes(n)?(r[n]=e[n],r):(f.console.error("setLayerAnimationTimeConfig takes timeFormat and/or timezone as options, found ".concat(n)),r)}),{})}function he(e,t,r){var n,a;if(Array.isArray(e)){var o=e.map((function(e){return he(e,t,r)})).filter((function(e){return e}));return o.length?o:null}return"string"==typeof e.dataId&&e.dataId===t?R(R({},e),{},{dataId:r}):Array.isArray(e.dataId)&&e.dataId.includes(t)?R(R({},e),{},{dataId:e.dataId.map((function(e){return e===t?r:e}))}):null!==(n=e.config)&&void 0!==n&&n.dataId&&(null===(a=e.config)||void 0===a?void 0:a.dataId)===t?R(R({},e),{},{config:R(R({},e.config),{},{dataId:r})}):(0,b.isObject)(e)&&e.hasOwnProperty(t)?(0,d.default)({},r,e[t]):null}function Pe(e){var t;if(Array.isArray(e)){var r=e.map(Pe).filter((function(e){return e}));return r.length?r:null}return(null==e||null===(t=e.newDataset)||void 0===t?void 0:t.info.id)||null}function be(e,t,r){return(0,F.compose_)([(0,F.apply_)(Se,{dataId:t,dataIdToUse:r}),(0,F.apply_)(ne,{dataId:t})])(e)}function Se(e,t){var r=t.dataId,n=t.dataIdToUse,a=(0,S.serializeVisState)(e,e.schema),o=e.mergers.reduce((function(e,t){var o=t.prop,i=t.toMergeProp,u=t.replaceParentDatasetIds,s=t.getChildDatasetIds,f=t.saveUnmerged,c=t.preserveOrder,p=(0,b.toArray)(o),y=(0,b.toArray)(i),v=a?p.map((function(e){return a[e]})):[],g=e;return v.forEach((function(e,t){var a,o={prop:p[t],toMergeProp:y[t],getChildDatasetIds:s,saveUnmerged:f},i=(null==u?void 0:u(e,r,n))||he(e,r,n);g=i?function(e,t,r){var n=r.getChildDatasetIds,a=function(e,t,r){var n=r.prop,a=r.toMergeProp,o=r.saveUnmerged;if(!t)return e;var i="layers"===n?t.reduce((function(e,t){return te(e,{id:t.id})}),e):Array.isArray(e[n])?R(R({},e),{},(0,d.default)({},n,e[n].filter((function(e){return!t.find((function(t){return e.id===t.id}))})))):e,u=(0,d.default)({},a,o?o(i,t):Array.isArray(i[a])?[].concat((0,l.default)(i[a]),(0,l.default)(t)):(0,b.isObject)(i[a])?R(R({},i[a]),t):i[a]);return R(R({},i),u)}(e,t,{prop:r.prop,toMergeProp:r.toMergeProp,saveUnmerged:r.saveUnmerged}),o=(null==n?void 0:n(t))||Pe(t);return o&&(a=(0,b.toArray)(o).reduce((function(e,t){return be(e,t,t)}),a)),a}(g,i,o):g,void 0!==o.toMergeProp&&null!==(a=g[o.toMergeProp])&&void 0!==a&&a.length&&c&&(g[c]=e.map((function(e){return e.id})))})),g}),e);return o}t.loadFilesUpdater=function(e,t){var r=t.files,n=t.onFinish,a=void 0===n?P.loadFilesSuccess:n;if(!r.length)return e;var o=Array.from(r).reduce((function(e,t,r){return(0,F.merge_)(ge(t,r))(e)}),{}),i={fileCache:[],filesToLoad:r,onFinish:a};return fe((0,F.merge_)({fileLoadingProgress:o,fileLoading:i})(e))},t.nextFileBatchUpdater=function(e,t){var r,n=t.payload,a=n.gen,o=n.fileName,i=n.progress,u=n.accumulated,d=n.onFinish,s=me(e,{fileName:o,progress:pe(e.fileLoadingProgress[o],i)});return(0,c.withTask)(s,[].concat((0,l.default)(o.endsWith("arrow")&&(null==u||null===(r=u.data)||void 0===r?void 0:r.length)>0?[(0,h.PROCESS_FILE_DATA)({content:u,fileCache:[]}).bimap((function(e){return(0,P.loadFilesSuccess)(e)}),(function(e){return(0,P.loadFilesErr)(o,e)}))]:[]),[(0,h.UNWRAP_TASK)(a.next()).bimap((function(e){var t=e.value;return e.done?d(u):(0,P.nextFileBatch)({gen:a,fileName:o,progress:t.progress,accumulated:t,onFinish:d})}),(function(e){return(0,P.loadFilesErr)(o,e)}))]))},t.loadFilesErrUpdater=function(e,t){var r=t.error,n=t.fileName;if(f.console.warn(r),!e.fileLoading)return e;var a=e.fileLoading,o=a.filesToLoad,i=a.onFinish,l=a.fileCache,u=me(e,{fileName:n,progress:{error:r}});return(0,c.withTask)(u,(0,h.DELAY_TASK)(200).map(o.length?P.loadNextFile:function(){return i(l)}))},t.applyCPUFilterUpdater=function(e,t){var r=t.dataId;return(0,b.toArray)(r).reduce((function(e,t){return(0,b.filterDatasetCPU)(e,t)}),e)},t.setMapInfoUpdater=function(e,t){return R(R({},e),{},{mapInfo:R(R({},e.mapInfo),t.info)})},t.setEditorModeUpdater=function(e,t){var r=t.mode;return R(R({},e),{},{editor:R(R({},e.editor),{},{mode:r,selectedFeature:null})})},t.setSelectedFeatureUpdater=function(e,t){var r=t.feature,n=t.selectionContext;return r&&r.properties&&(r.properties.bbox=(0,s.default)(r)),R(R({},e),{},{editor:R(R({},e.editor),{},{selectedFeature:r,selectionContext:n})})}},59278:(e,t,r)=>{"use strict";var n=r(95709),a=r(58784);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.visStateReducerFactory=void 0;var o,i=n(r(26396)),l=r(99150),u=r(19913),d=a(r(59254));function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var c=(o={},(0,i.default)(o,l.ActionTypes.ADD_FILTER,d.addFilterUpdater),(0,i.default)(o,l.ActionTypes.ADD_LAYER,d.addLayerUpdater),(0,i.default)(o,l.ActionTypes.APPLY_LAYER_CONFIG,d.applyLayerConfigUpdater),(0,i.default)(o,l.ActionTypes.DUPLICATE_LAYER,d.duplicateLayerUpdater),(0,i.default)(o,l.ActionTypes.SET_FILTER_VIEW,d.setFilterViewUpdater),(0,i.default)(o,l.ActionTypes.INTERACTION_CONFIG_CHANGE,d.interactionConfigChangeUpdater),(0,i.default)(o,l.ActionTypes.LAYER_CLICK,d.layerClickUpdater),(0,i.default)(o,l.ActionTypes.LAYER_CONFIG_CHANGE,d.layerConfigChangeUpdater),(0,i.default)(o,l.ActionTypes.LAYER_SET_IS_VALID,d.layerSetIsValidUpdater),(0,i.default)(o,l.ActionTypes.LAYER_HOVER,d.layerHoverUpdater),(0,i.default)(o,l.ActionTypes.LAYER_TYPE_CHANGE,d.layerTypeChangeUpdater),(0,i.default)(o,l.ActionTypes.LAYER_VIS_CONFIG_CHANGE,d.layerVisConfigChangeUpdater),(0,i.default)(o,l.ActionTypes.LAYER_TEXT_LABEL_CHANGE,d.layerTextLabelChangeUpdater),(0,i.default)(o,l.ActionTypes.LAYER_VISUAL_CHANNEL_CHANGE,d.layerVisualChannelChangeUpdater),(0,i.default)(o,l.ActionTypes.LAYER_COLOR_UI_CHANGE,d.layerColorUIChangeUpdater),(0,i.default)(o,l.ActionTypes.TOGGLE_LAYER_ANIMATION,d.toggleLayerAnimationUpdater),(0,i.default)(o,l.ActionTypes.TOGGLE_LAYER_ANIMATION_CONTROL,d.toggleLayerAnimationControlUpdater),(0,i.default)(o,l.ActionTypes.LOAD_FILES,d.loadFilesUpdater),(0,i.default)(o,l.ActionTypes.LOAD_FILES_ERR,d.loadFilesErrUpdater),(0,i.default)(o,l.ActionTypes.LOAD_NEXT_FILE,d.loadNextFileUpdater),(0,i.default)(o,l.ActionTypes.LOAD_FILE_STEP_SUCCESS,d.loadFileStepSuccessUpdater),(0,i.default)(o,l.ActionTypes.MAP_CLICK,d.mapClickUpdater),(0,i.default)(o,l.ActionTypes.MOUSE_MOVE,d.mouseMoveUpdater),(0,i.default)(o,l.ActionTypes.RECEIVE_MAP_CONFIG,d.receiveMapConfigUpdater),(0,i.default)(o,l.ActionTypes.REMOVE_DATASET,d.removeDatasetUpdater),(0,i.default)(o,l.ActionTypes.REMOVE_FILTER,d.removeFilterUpdater),(0,i.default)(o,l.ActionTypes.REMOVE_LAYER,d.removeLayerUpdater),(0,i.default)(o,l.ActionTypes.REORDER_LAYER,d.reorderLayerUpdater),(0,i.default)(o,l.ActionTypes.RESET_MAP_CONFIG,d.resetMapConfigUpdater),(0,i.default)(o,l.ActionTypes.SET_FILTER,d.setFilterUpdater),(0,i.default)(o,l.ActionTypes.SET_FILTER_ANIMATION_TIME,d.setFilterAnimationTimeUpdater),(0,i.default)(o,l.ActionTypes.SET_FILTER_ANIMATION_TIME_CONFIG,d.setFilterAnimationTimeConfigUpdater),(0,i.default)(o,l.ActionTypes.SET_FILTER_ANIMATION_WINDOW,d.setFilterAnimationWindowUpdater),(0,i.default)(o,l.ActionTypes.SET_FILTER_PLOT,d.setFilterPlotUpdater),(0,i.default)(o,l.ActionTypes.SET_MAP_INFO,d.setMapInfoUpdater),(0,i.default)(o,l.ActionTypes.SHOW_DATASET_TABLE,d.showDatasetTableUpdater),(0,i.default)(o,l.ActionTypes.UPDATE_TABLE_COLOR,d.updateTableColorUpdater),(0,i.default)(o,l.ActionTypes.TOGGLE_FILTER_ANIMATION,d.toggleFilterAnimationUpdater),(0,i.default)(o,l.ActionTypes.UPDATE_FILTER_ANIMATION_SPEED,d.updateFilterAnimationSpeedUpdater),(0,i.default)(o,l.ActionTypes.SET_LAYER_ANIMATION_TIME,d.setLayerAnimationTimeUpdater),(0,i.default)(o,l.ActionTypes.UPDATE_LAYER_ANIMATION_SPEED,d.updateLayerAnimationSpeedUpdater),(0,i.default)(o,l.ActionTypes.TOGGLE_LAYER_FOR_MAP,d.toggleLayerForMapUpdater),(0,i.default)(o,l.ActionTypes.TOGGLE_SPLIT_MAP,d.toggleSplitMapUpdater),(0,i.default)(o,l.ActionTypes.UPDATE_LAYER_BLENDING,d.updateLayerBlendingUpdater),(0,i.default)(o,l.ActionTypes.UPDATE_OVERLAY_BLENDING,d.updateOverlayBlendingUpdater),(0,i.default)(o,l.ActionTypes.UPDATE_VIS_DATA,d.updateVisDataUpdater),(0,i.default)(o,l.ActionTypes.RENAME_DATASET,d.renameDatasetUpdater),(0,i.default)(o,l.ActionTypes.UPDATE_DATASET_PROPS,d.updateDatasetPropsUpdater),(0,i.default)(o,l.ActionTypes.SET_FEATURES,d.setFeaturesUpdater),(0,i.default)(o,l.ActionTypes.DELETE_FEATURE,d.deleteFeatureUpdater),(0,i.default)(o,l.ActionTypes.SET_POLYGON_FILTER_LAYER,d.setPolygonFilterLayerUpdater),(0,i.default)(o,l.ActionTypes.SET_SELECTED_FEATURE,d.setSelectedFeatureUpdater),(0,i.default)(o,l.ActionTypes.SET_EDITOR_MODE,d.setEditorModeUpdater),(0,i.default)(o,l.ActionTypes.TOGGLE_EDITOR_VISIBILITY,d.toggleEditorVisibilityUpdater),(0,i.default)(o,l.ActionTypes.TOGGLE_FILTER_FEATURE,d.toggleFilterFeatureUpdater),(0,i.default)(o,l.ActionTypes.APPLY_CPU_FILTER,d.applyCPUFilterUpdater),(0,i.default)(o,l.ActionTypes.SORT_TABLE_COLUMN,d.sortTableColumnUpdater),(0,i.default)(o,l.ActionTypes.PIN_TABLE_COLUMN,d.pinTableColumnUpdater),(0,i.default)(o,l.ActionTypes.COPY_TABLE_COLUMN,d.copyTableColumnUpdater),(0,i.default)(o,l.ActionTypes.SET_COLUMN_DISPLAY_FORMAT,d.setColumnDisplayFormatUpdater),(0,i.default)(o,l.ActionTypes.NEXT_FILE_BATCH,d.nextFileBatchUpdater),(0,i.default)(o,l.ActionTypes.PROCESS_FILE_CONTENT,d.processFileContentUpdater),(0,i.default)(o,l.ActionTypes.SET_LAYER_ANIMATION_TIME_CONFIG,d.setLayerAnimationTimeConfigUpdater),(0,i.default)(o,l.ActionTypes.ADD_EFFECT,d.addEffectUpdater),(0,i.default)(o,l.ActionTypes.REORDER_EFFECT,d.reorderEffectUpdater),(0,i.default)(o,l.ActionTypes.REMOVE_EFFECT,d.removeEffectUpdater),(0,i.default)(o,l.ActionTypes.UPDATE_EFFECT,d.updateEffectUpdater),o),p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,u.handleActions)(c,f(f(f({},d.INITIAL_VIS_STATE),e),{},{initialState:e}))};t.visStateReducerFactory=p;var y=p();t.default=y},25697:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(54043);function a(e){var t=[1/0,1/0,-1/0,-1/0];return n.coordEach(e,(function(e){t[0]>e[0]&&(t[0]=e[0]),t[1]>e[1]&&(t[1]=e[1]),t[2]<e[0]&&(t[2]=e[0]),t[3]<e[1]&&(t[3]=e[1])})),t}a.default=a,t.default=a},57033:(e,t)=>{"use strict";function r(e,t,r){void 0===r&&(r={});var n={type:"Feature"};return(0===r.id||r.id)&&(n.id=r.id),r.bbox&&(n.bbox=r.bbox),n.properties=t||{},n.geometry=e,n}function n(e,t,n){if(void 0===n&&(n={}),!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!p(e[0])||!p(e[1]))throw new Error("coordinates must contain numbers");return r({type:"Point",coordinates:e},t,n)}function a(e,t,n){void 0===n&&(n={});for(var a=0,o=e;a<o.length;a++){var i=o[a];if(i.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var l=0;l<i[i.length-1].length;l++)if(i[i.length-1][l]!==i[0][l])throw new Error("First and last Position are not equivalent.")}return r({type:"Polygon",coordinates:e},t,n)}function o(e,t,n){if(void 0===n&&(n={}),e.length<2)throw new Error("coordinates must be an array of two or more positions");return r({type:"LineString",coordinates:e},t,n)}function i(e,t){void 0===t&&(t={});var r={type:"FeatureCollection"};return t.id&&(r.id=t.id),t.bbox&&(r.bbox=t.bbox),r.features=e,r}function l(e,t,n){return void 0===n&&(n={}),r({type:"MultiLineString",coordinates:e},t,n)}function u(e,t,n){return void 0===n&&(n={}),r({type:"MultiPoint",coordinates:e},t,n)}function d(e,t,n){return void 0===n&&(n={}),r({type:"MultiPolygon",coordinates:e},t,n)}function s(e,r){void 0===r&&(r="kilometers");var n=t.factors[r];if(!n)throw new Error(r+" units is invalid");return e*n}function f(e,r){void 0===r&&(r="kilometers");var n=t.factors[r];if(!n)throw new Error(r+" units is invalid");return e/n}function c(e){return e%(2*Math.PI)*180/Math.PI}function p(e){return!isNaN(e)&&null!==e&&!Array.isArray(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.earthRadius=6371008.8,t.factors={centimeters:100*t.earthRadius,centimetres:100*t.earthRadius,degrees:t.earthRadius/111325,feet:3.28084*t.earthRadius,inches:39.37*t.earthRadius,kilometers:t.earthRadius/1e3,kilometres:t.earthRadius/1e3,meters:t.earthRadius,metres:t.earthRadius,miles:t.earthRadius/1609.344,millimeters:1e3*t.earthRadius,millimetres:1e3*t.earthRadius,nauticalmiles:t.earthRadius/1852,radians:1,yards:1.0936*t.earthRadius},t.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/t.earthRadius,yards:1.0936133},t.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},t.feature=r,t.geometry=function(e,t,r){switch(void 0===r&&(r={}),e){case"Point":return n(t).geometry;case"LineString":return o(t).geometry;case"Polygon":return a(t).geometry;case"MultiPoint":return u(t).geometry;case"MultiLineString":return l(t).geometry;case"MultiPolygon":return d(t).geometry;default:throw new Error(e+" is invalid")}},t.point=n,t.points=function(e,t,r){return void 0===r&&(r={}),i(e.map((function(e){return n(e,t)})),r)},t.polygon=a,t.polygons=function(e,t,r){return void 0===r&&(r={}),i(e.map((function(e){return a(e,t)})),r)},t.lineString=o,t.lineStrings=function(e,t,r){return void 0===r&&(r={}),i(e.map((function(e){return o(e,t)})),r)},t.featureCollection=i,t.multiLineString=l,t.multiPoint=u,t.multiPolygon=d,t.geometryCollection=function(e,t,n){return void 0===n&&(n={}),r({type:"GeometryCollection",geometries:e},t,n)},t.round=function(e,t){if(void 0===t&&(t=0),t&&!(t>=0))throw new Error("precision must be a positive number");var r=Math.pow(10,t||0);return Math.round(e*r)/r},t.radiansToLength=s,t.lengthToRadians=f,t.lengthToDegrees=function(e,t){return c(f(e,t))},t.bearingToAzimuth=function(e){var t=e%360;return t<0&&(t+=360),t},t.radiansToDegrees=c,t.degreesToRadians=function(e){return e%360*Math.PI/180},t.convertLength=function(e,t,r){if(void 0===t&&(t="kilometers"),void 0===r&&(r="kilometers"),!(e>=0))throw new Error("length must be a positive number");return s(f(e,t),r)},t.convertArea=function(e,r,n){if(void 0===r&&(r="meters"),void 0===n&&(n="kilometers"),!(e>=0))throw new Error("area must be a positive number");var a=t.areaFactors[r];if(!a)throw new Error("invalid original units");var o=t.areaFactors[n];if(!o)throw new Error("invalid final units");return e/a*o},t.isNumber=p,t.isObject=function(e){return!!e&&e.constructor===Object},t.validateBBox=function(e){if(!e)throw new Error("bbox is required");if(!Array.isArray(e))throw new Error("bbox must be an Array");if(4!==e.length&&6!==e.length)throw new Error("bbox must be an Array of 4 or 6 numbers");e.forEach((function(e){if(!p(e))throw new Error("bbox must only contain numbers")}))},t.validateId=function(e){if(!e)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof e))throw new Error("id must be a number or a string")}},54043:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(57033);function a(e,t,r){if(null!==e)for(var n,o,i,l,u,d,s,f,c=0,p=0,y=e.type,v="FeatureCollection"===y,g="Feature"===y,m=v?e.features.length:1,A=0;A<m;A++){u=(f=!!(s=v?e.features[A].geometry:g?e.geometry:e)&&"GeometryCollection"===s.type)?s.geometries.length:1;for(var _=0;_<u;_++){var T=0,h=0;if(null!==(l=f?s.geometries[_]:s)){d=l.coordinates;var P=l.type;switch(c=!r||"Polygon"!==P&&"MultiPolygon"!==P?0:1,P){case null:break;case"Point":if(!1===t(d,p,A,T,h))return!1;p++,T++;break;case"LineString":case"MultiPoint":for(n=0;n<d.length;n++){if(!1===t(d[n],p,A,T,h))return!1;p++,"MultiPoint"===P&&T++}"LineString"===P&&T++;break;case"Polygon":case"MultiLineString":for(n=0;n<d.length;n++){for(o=0;o<d[n].length-c;o++){if(!1===t(d[n][o],p,A,T,h))return!1;p++}"MultiLineString"===P&&T++,"Polygon"===P&&h++}"Polygon"===P&&T++;break;case"MultiPolygon":for(n=0;n<d.length;n++){for(h=0,o=0;o<d[n].length;o++){for(i=0;i<d[n][o].length-c;i++){if(!1===t(d[n][o][i],p,A,T,h))return!1;p++}h++}T++}break;case"GeometryCollection":for(n=0;n<l.geometries.length;n++)if(!1===a(l.geometries[n],t,r))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function o(e,t){var r;switch(e.type){case"FeatureCollection":for(r=0;r<e.features.length&&!1!==t(e.features[r].properties,r);r++);break;case"Feature":t(e.properties,0)}}function i(e,t){if("Feature"===e.type)t(e,0);else if("FeatureCollection"===e.type)for(var r=0;r<e.features.length&&!1!==t(e.features[r],r);r++);}function l(e,t){var r,n,a,o,i,l,u,d,s,f,c=0,p="FeatureCollection"===e.type,y="Feature"===e.type,v=p?e.features.length:1;for(r=0;r<v;r++){for(l=p?e.features[r].geometry:y?e.geometry:e,d=p?e.features[r].properties:y?e.properties:{},s=p?e.features[r].bbox:y?e.bbox:void 0,f=p?e.features[r].id:y?e.id:void 0,i=(u=!!l&&"GeometryCollection"===l.type)?l.geometries.length:1,a=0;a<i;a++)if(null!==(o=u?l.geometries[a]:l))switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===t(o,c,d,s,f))return!1;break;case"GeometryCollection":for(n=0;n<o.geometries.length;n++)if(!1===t(o.geometries[n],c,d,s,f))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===t(null,c,d,s,f))return!1;c++}}function u(e,t){l(e,(function(e,r,a,o,i){var l,u=null===e?null:e.type;switch(u){case null:case"Point":case"LineString":case"Polygon":return!1!==t(n.feature(e,a,{bbox:o,id:i}),r,0)&&void 0}switch(u){case"MultiPoint":l="Point";break;case"MultiLineString":l="LineString";break;case"MultiPolygon":l="Polygon"}for(var d=0;d<e.coordinates.length;d++){var s={type:l,coordinates:e.coordinates[d]};if(!1===t(n.feature(s,a),r,d))return!1}}))}function d(e,t){u(e,(function(e,r,o){var i=0;if(e.geometry){var l=e.geometry.type;if("Point"!==l&&"MultiPoint"!==l){var u,d=0,s=0,f=0;return!1!==a(e,(function(a,l,c,p,y){if(void 0===u||r>d||p>s||y>f)return u=a,d=r,s=p,f=y,void(i=0);var v=n.lineString([u,a],e.properties);if(!1===t(v,r,o,y,i))return!1;i++,u=a}))&&void 0}}}))}function s(e,t){if(!e)throw new Error("geojson is required");u(e,(function(e,r,a){if(null!==e.geometry){var o=e.geometry.type,i=e.geometry.coordinates;switch(o){case"LineString":if(!1===t(e,r,a,0,0))return!1;break;case"Polygon":for(var l=0;l<i.length;l++)if(!1===t(n.lineString(i[l],e.properties),r,a,l))return!1}}}))}t.coordAll=function(e){var t=[];return a(e,(function(e){t.push(e)})),t},t.coordEach=a,t.coordReduce=function(e,t,r,n){var o=r;return a(e,(function(e,n,a,i,l){o=0===n&&void 0===r?e:t(o,e,n,a,i,l)}),n),o},t.featureEach=i,t.featureReduce=function(e,t,r){var n=r;return i(e,(function(e,a){n=0===a&&void 0===r?e:t(n,e,a)})),n},t.findPoint=function(e,t){if(t=t||{},!n.isObject(t))throw new Error("options is invalid");var r,a=t.featureIndex||0,o=t.multiFeatureIndex||0,i=t.geometryIndex||0,l=t.coordIndex||0,u=t.properties;switch(e.type){case"FeatureCollection":a<0&&(a=e.features.length+a),u=u||e.features[a].properties,r=e.features[a].geometry;break;case"Feature":u=u||e.properties,r=e.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":r=e;break;default:throw new Error("geojson is invalid")}if(null===r)return null;var d=r.coordinates;switch(r.type){case"Point":return n.point(d,u,t);case"MultiPoint":return o<0&&(o=d.length+o),n.point(d[o],u,t);case"LineString":return l<0&&(l=d.length+l),n.point(d[l],u,t);case"Polygon":return i<0&&(i=d.length+i),l<0&&(l=d[i].length+l),n.point(d[i][l],u,t);case"MultiLineString":return o<0&&(o=d.length+o),l<0&&(l=d[o].length+l),n.point(d[o][l],u,t);case"MultiPolygon":return o<0&&(o=d.length+o),i<0&&(i=d[o].length+i),l<0&&(l=d[o][i].length-l),n.point(d[o][i][l],u,t)}throw new Error("geojson is invalid")},t.findSegment=function(e,t){if(t=t||{},!n.isObject(t))throw new Error("options is invalid");var r,a=t.featureIndex||0,o=t.multiFeatureIndex||0,i=t.geometryIndex||0,l=t.segmentIndex||0,u=t.properties;switch(e.type){case"FeatureCollection":a<0&&(a=e.features.length+a),u=u||e.features[a].properties,r=e.features[a].geometry;break;case"Feature":u=u||e.properties,r=e.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":r=e;break;default:throw new Error("geojson is invalid")}if(null===r)return null;var d=r.coordinates;switch(r.type){case"Point":case"MultiPoint":return null;case"LineString":return l<0&&(l=d.length+l-1),n.lineString([d[l],d[l+1]],u,t);case"Polygon":return i<0&&(i=d.length+i),l<0&&(l=d[i].length+l-1),n.lineString([d[i][l],d[i][l+1]],u,t);case"MultiLineString":return o<0&&(o=d.length+o),l<0&&(l=d[o].length+l-1),n.lineString([d[o][l],d[o][l+1]],u,t);case"MultiPolygon":return o<0&&(o=d.length+o),i<0&&(i=d[o].length+i),l<0&&(l=d[o][i].length-l-1),n.lineString([d[o][i][l],d[o][i][l+1]],u,t)}throw new Error("geojson is invalid")},t.flattenEach=u,t.flattenReduce=function(e,t,r){var n=r;return u(e,(function(e,a,o){n=0===a&&0===o&&void 0===r?e:t(n,e,a,o)})),n},t.geomEach=l,t.geomReduce=function(e,t,r){var n=r;return l(e,(function(e,a,o,i,l){n=0===a&&void 0===r?e:t(n,e,a,o,i,l)})),n},t.lineEach=s,t.lineReduce=function(e,t,r){var n=r;return s(e,(function(e,a,o,i){n=0===a&&void 0===r?e:t(n,e,a,o,i)})),n},t.propEach=o,t.propReduce=function(e,t,r){var n=r;return o(e,(function(e,a){n=0===a&&void 0===r?e:t(n,e,a)})),n},t.segmentEach=d,t.segmentReduce=function(e,t,r){var n=r,a=!1;return d(e,(function(e,o,i,l,u){n=!1===a&&void 0===r?e:t(n,e,o,i,l,u),a=!0})),n}},69047:(e,t,r)=>{"use strict";var n=r(95709);Object.defineProperty(t,"__esModule",{value:!0}),t.getNewDatasetColor=f,t.createNewDataEntry=function(e){var t=e.info,r=e.data,n=(0,o.default)(e,["info","data"]),i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=(0,u.validateInputData)(r);if(!s)return{};if(t&&t.id&&i[t.id]){var c=i[t.id];return c.update(s),(0,a.default)({},c.id,c)}var p=(t=t||{}).color||f(i),y=new l.default(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?d(Object(r),!0).forEach((function(t){(0,a.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({info:t,data:s,color:p},n));return(0,a.default)({},y.id,y)};var a=n(r(26396)),o=n(r(39892)),i=n(r(90879)),l=n(r(66301)),u=r(77244);function d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var s=["#8F2FBF","#005CFF","#C06C84","#F8B195","#547A82","#3EACA8","#A2D4AB"].map(u.hexToRgb);function f(e){var t=s.map(String),r=(0,i.default)(Object.values(e).map((function(e){return String(e.color)}))).filter((function(e){return t.includes(e)}));if(r.length===t.length)return u.datasetColorMaker.next().value;for(var n=u.datasetColorMaker.next().value;r.includes(String(n));)n=u.datasetColorMaker.next().value;return n}},50188:(e,t,r)=>{"use strict";var n=r(95709);Object.defineProperty(t,"__esModule",{value:!0}),t.setFilterGpuMode=function(e,t){return e.dataId.forEach((function(r,n){var a=t.filter((function(e){return e.dataId.includes(r)&&e.gpu}));e.gpu&&a.length===i.MAX_GPU_FILTERS&&(0,l.set)(["gpu"],!1,e)})),e},t.assignGpuChannels=function(e){return e.reduce((function(e,t,r){var n=e;return t.gpu&&(t=s(t,e),n=(0,l.set)([r],t,e)),n}),e)},t.assignGpuChannel=s,t.resetFilterGpuMode=function(e){var t={};return e.map((function(e,r){if(e.gpu){var n=!0;if((0,l.toArray)(e.dataId).forEach((function(e){var r=t[e];r===i.MAX_GPU_FILTERS?n=!1:t[e]=r?r+1:1})),!n)return(0,l.set)(["gpu"],!1,e)}return e}))},t.getGpuFilterProps=function(e,t,r){for(var n=new Array(i.MAX_GPU_FILTERS).fill(0).map((function(e){return[0,0]})),a={},o=[],l=function(r){var i,l,u=e.find((function(e){return e.gpu&&e.dataId.includes(t)&&e.gpuChannel&&e.gpuChannel[e.dataId.indexOf(t)]===r}));n[r][0]=u?u.value[0]-(null===(i=u.domain)||void 0===i?void 0:i[0]):0,n[r][1]=u?u.value[1]-(null===(l=u.domain)||void 0===l?void 0:l[0]):0,a["gpuFilter_".concat(r)]=u?u.name[u.dataId.indexOf(t)]:null,o.push(u)},u=0;u<i.MAX_GPU_FILTERS;u++)l(u);var d=p(o,t,r);return{filterRange:n,filterValueUpdateTriggers:a,filterValueAccessor:d}},t.getDatasetFieldIndexForFilter=y;var a=n(r(26396)),o=n(r(95093)),i=r(13848),l=r(77244);function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(Object(r),!0).forEach((function(t){(0,a.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){if(!e.gpu)return e;var r=e.gpuChannel||[];return e.dataId.forEach((function(n,a){var o=function(t){return function(r){var a=(0,l.toArray)(r.dataId).indexOf(n);return r.id!==e.id&&a>-1&&r.gpu&&(0,l.toArray)(r.gpuChannel)[a]===t}};if(!Number.isFinite(r[a])||t.find(o(r[a])))for(var u=0;u<i.MAX_GPU_FILTERS;){if(!t.find(o(u)))return void(r[a]=u);u++}})),r.length&&r.every(Number.isFinite)?d(d({},e),{},{gpuChannel:r}):d(d({},e),{},{gpu:!1})}var f=function(e){return e.index},c=function(e,t,r){return e.valueAt(t.index,r)},p=function(e,t,r){return function(n){return function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f,u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c;return function(d){return e.map((function(e){var s;if(!e)return 0;var f=y(t,e),c=r[f],p=e.type===i.FILTER_TYPES.timeRange?c.filterProps&&Array.isArray(c.filterProps.mappedValue)?c.filterProps.mappedValue[a(d)]:o.default.utc(u(n,d,f)).valueOf():u(n,d,f);return(0,l.notNullorUndefined)(p)?p-(null===(s=e.domain)||void 0===s?void 0:s[0]):Number.MIN_SAFE_INTEGER}))}}}};function y(e,t){var r=(0,l.toArray)(t.dataId).indexOf(e);if(r<0)return-1;var n=t.fieldIdx[r];return(0,l.notNullorUndefined)(n)?n:-1}},68747:(e,t,r)=>{"use strict";var n=r(58784);Object.defineProperty(t,"__esModule",{value:!0});var a={KeplerTable:!0,findPointFieldPairs:!0,copyTableAndUpdate:!0,pinTableColumns:!0,sortDatasetByColumn:!0,copyTable:!0,maybeToDate:!0};Object.defineProperty(t,"default",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"KeplerTable",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"findPointFieldPairs",{enumerable:!0,get:function(){return o.findPointFieldPairs}}),Object.defineProperty(t,"copyTableAndUpdate",{enumerable:!0,get:function(){return o.copyTableAndUpdate}}),Object.defineProperty(t,"pinTableColumns",{enumerable:!0,get:function(){return o.pinTableColumns}}),Object.defineProperty(t,"sortDatasetByColumn",{enumerable:!0,get:function(){return o.sortDatasetByColumn}}),Object.defineProperty(t,"copyTable",{enumerable:!0,get:function(){return o.copyTable}}),Object.defineProperty(t,"maybeToDate",{enumerable:!0,get:function(){return o.maybeToDate}});var o=n(r(66301)),i=r(50188);Object.keys(i).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(a,e)||e in t&&t[e]===i[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}}))}));var l=r(69047);Object.keys(l).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(a,e)||e in t&&t[e]===l[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return l[e]}}))}))},66301:(e,t,r)=>{"use strict";var n=r(95709);Object.defineProperty(t,"__esModule",{value:!0}),t.maybeToDate=m,t.findPointFieldPairs=T,t.sortDatasetByColumn=function(e,t,r){var n=e.allIndexes,a=e.fields,o=e.dataContainer,i=a.findIndex((function(e){return e.name===t}));if(i<0)return e;var u=s.SORT_ORDER[r||""]||s.SORT_ORDER.ASCENDING;if(u===s.SORT_ORDER.UNSORT)return e.sortColumn={},e.sortOrder=null,e;var f=u===s.SORT_ORDER.ASCENDING?d.ascending:d.descending,p=n.slice().sort((function(e,t){var r=o.valueAt(e,i),n=o.valueAt(t,i);return!(0,c.notNullorUndefined)(r)&&(0,c.notNullorUndefined)(n)?1:(0,c.notNullorUndefined)(r)&&!(0,c.notNullorUndefined)(n)?-1:f(r,n)}));return e.sortColumn=(0,l.default)({},t,u),e.sortOrder=p,e},t.pinTableColumns=function(e,t){var r,n=e.getColumnField(t);return n?(r=Array.isArray(e.pinnedColumns)&&e.pinnedColumns.includes(n.name)?e.pinnedColumns.filter((function(e){return e!==n.name})):(e.pinnedColumns||[]).concat(n.name),P(e,{pinnedColumns:r})):e},t.copyTable=h,t.copyTableAndUpdate=P,t.getFieldValueAccessor=b,t.default=void 0;var a=n(r(21259)),o=n(r(82274)),i=n(r(65044)),l=n(r(26396)),u=r(45439),d=r(55332),s=r(13848),f=r(50188),c=r(77244);function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function y(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function v(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?y(Object(r),!0).forEach((function(t){(0,l.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var g="name";function m(e,t,r,n,a){return e?(0,c.timeToUnixMilli)(n.valueAt(a.index,t),r):n.valueAt(a.index,t)}var A="[#_&@\\.\\-\\ ]";function _(e,t,r,n){var a=r.findIndex((function(r){return r===n.replace(e,(function(e){return e.replace(t[0],t[1])}))})),o=-1;return a>-1&&s.ALTITUDE_FIELDS.some((function(a){return(o=r.findIndex((function(r){return r===n.replace(e,(function(e){return e.replace(t[0],a)}))})))>-1})),{partnerIdx:a,altIdx:o}}function T(e){var t=e.map((function(e){return e.name.toLowerCase()}));return t.reduce((function(r,n,a){var o,i=function(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return p(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?p(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return i=e.done,e},e:function(e){l=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(l)throw o}}}}(s.TRIP_POINT_FIELDS);try{for(i.s();!(o=i.n()).done;){var l=o.value,u=new RegExp("(^|".concat(A,")").concat(l[0],"(").concat(A,"|$)"));if(u.test(n)){var d=_(u,l,t,n),f=d.partnerIdx,c=d.altIdx;if(f>-1){var y=n.replace(u,"").trim();return r.push({defaultName:y||"point",pair:v({lat:{fieldIdx:a,value:e[a].name},lng:{fieldIdx:f,value:e[f].name}},c>-1?{alt:{fieldIdx:c,value:e[c].name}}:{}),suffix:l}),r}}}}catch(e){i.e(e)}finally{i.f()}return r}),[])}function h(e){return Object.assign(Object.create(Object.getPrototypeOf(e)),e)}function P(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.entries(t).reduce((function(e,t){return e[t[0]]=t[1],e}),h(e))}function b(e,t,r){return m.bind(null,e.type===s.ALL_FIELD_TYPES.timestamp,t,e.format||"",r)}var S=function(){function e(t){var r=t.info,n=t.data,a=t.color,i=t.metadata,u=t.supportedFilterTypes,d=void 0===u?null:u,s=t.disableDataOperation,p=void 0!==s&&s;(0,o.default)(this,e),(0,l.default)(this,"id",void 0),(0,l.default)(this,"type",void 0),(0,l.default)(this,"label",void 0),(0,l.default)(this,"color",void 0),(0,l.default)(this,"fields",void 0),(0,l.default)(this,"dataContainer",void 0),(0,l.default)(this,"allIndexes",void 0),(0,l.default)(this,"filteredIndex",void 0),(0,l.default)(this,"filteredIdxCPU",void 0),(0,l.default)(this,"filteredIndexForDomain",void 0),(0,l.default)(this,"fieldPairs",void 0),(0,l.default)(this,"gpuFilter",void 0),(0,l.default)(this,"filterRecord",void 0),(0,l.default)(this,"filterRecordCPU",void 0),(0,l.default)(this,"changedFilters",void 0),(0,l.default)(this,"sortColumn",void 0),(0,l.default)(this,"sortOrder",void 0),(0,l.default)(this,"pinnedColumns",void 0),(0,l.default)(this,"supportedFilterTypes",void 0),(0,l.default)(this,"disableDataOperation",void 0),(0,l.default)(this,"metadata",void 0);var y=n.cols?n.cols:n.rows,g=n.cols?c.DataForm.COLS_ARRAY:c.DataForm.ROWS_ARRAY,m=(0,c.createDataContainer)(y,{fields:n.fields,inputDataFormat:g}),A=v({id:(0,c.generateHashId)(4),label:"new dataset",type:""},r),_=A.id,h=n.fields.map((function(e,t){return v(v({},e),{},{fieldIdx:t,id:e.name,displayName:e.displayName||e.name,valueAccessor:b(e,t,m)})})),P=m.getPlainIndex(),S={id:A.id,format:A.format||"",label:A.label||""};this.id=A.id,this.type=A.type,this.label=A.label,this.color=a,this.metadata=v(v({},S),i),this.dataContainer=m,this.allIndexes=P,this.filteredIndex=P,this.filteredIndexForDomain=P,this.fieldPairs=T(h),this.fields=h,this.gpuFilter=(0,f.getGpuFilterProps)([],_,h),this.supportedFilterTypes=d,this.disableDataOperation=p}return(0,i.default)(e,[{key:"update",value:function(e){var t,r,n=e.cols?e.cols:e.rows;null===(t=(r=this.dataContainer).update)||void 0===t||t.call(r,n),this.allIndexes=this.dataContainer.getPlainIndex(),this.filteredIndex=this.allIndexes,this.filteredIndexForDomain=this.allIndexes}},{key:"length",get:function(){return this.dataContainer.numRows()}},{key:"getColumnField",value:function(e){var t=this.fields.find((function(t){return t[g]===e}));return this._assetField(e,t),t}},{key:"getColumnFieldIdx",value:function(e){var t=this.fields.findIndex((function(t){return t[g]===e}));return this._assetField(e,Boolean(t>-1)),t}},{key:"getColumnDisplayFormat",value:function(e){var t=this.fields.find((function(t){return t[g]===e}));return this._assetField(e,t),null==t?void 0:t.displayFormat}},{key:"getValue",value:function(e,t){var r=this.getColumnField(e);return r?r.valueAccessor({index:t}):null}},{key:"updateColumnField",value:function(e,t){this.fields=Object.assign((0,a.default)(this.fields),(0,l.default)({},e,t))}},{key:"updateTableColor",value:function(e){this.color=e}},{key:"getColumnFilterProps",value:function(e){var t=this.getColumnFieldIdx(e);if(t<0)return null;var r=this.fields[t];if(r.hasOwnProperty("filterProps"))return r.filterProps;var n=this.getColumnFilterDomain(r);if(!n)return null;var a=(0,c.getFilterProps)(r,n),o=v(v({},r),{},{filterProps:a});return this.updateColumnField(t,o),a}},{key:"filterTable",value:function(e,t,r){var n=this,a=this.dataContainer,o=this.id,i=this.filterRecord,u=this.fields,d=(0,c.getFilterRecord)(o,e,r||{});if(this.filterRecord=d,this.gpuFilter=(0,f.getGpuFilterProps)(e,o,u),!e.length)return this.filteredIndex=this.allIndexes,this.filteredIndexForDomain=this.allIndexes,this;this.changedFilters=(0,c.diffFilters)(d,i);var s=Boolean(this.changedFilters.dynamicDomain),p=Boolean(this.changedFilters.cpu),y={};if(s||p){var g=s?d.dynamicDomain:null,m=p?d.cpu:null,A=e.reduce((function(e,r){var o=(0,f.getDatasetFieldIndexForFilter)(n.id,r),i=-1!==o?u[o]:null;return v(v({},e),{},(0,l.default)({},r.id,(0,c.getFilterFunction)(i,n.id,r,t,a)))}),{});y=(0,c.filterDataByFilterTypes)({dynamicDomainFilters:g,cpuFilters:m,filterFuncs:A},a)}return this.filteredIndex=y.filteredIndex||this.filteredIndex,this.filteredIndexForDomain=y.filteredIndexForDomain||this.filteredIndexForDomain,this}},{key:"filterTableCPU",value:function(e,t){var r={cpuOnly:!0,ignoreDomain:!0};if(!e.length)return this.filteredIdxCPU=this.allIndexes,this.filterRecordCPU=(0,c.getFilterRecord)(this.id,e,r),this;if(!e.find((function(e){return e.gpu})))return this.filteredIdxCPU=this.filteredIndex,this.filterRecordCPU=(0,c.getFilterRecord)(this.id,e,r),this;var n=h(this);n.filterRecord=this.filterRecordCPU,n.filteredIndex=this.filteredIdxCPU||[];var a=n.filterTable(e,t,r);return this.filteredIdxCPU=a.filteredIndex,this.filterRecordCPU=a.filterRecord,this}},{key:"getColumnFilterDomain",value:function(e){var t=this.dataContainer,r=e.valueAccessor;switch(e.type){case s.ALL_FIELD_TYPES.real:case s.ALL_FIELD_TYPES.integer:return(0,c.getNumericFieldDomain)(t,r);case s.ALL_FIELD_TYPES.boolean:return{domain:[!0,!1]};case s.ALL_FIELD_TYPES.string:case s.ALL_FIELD_TYPES.date:return{domain:(0,c.getOrdinalDomain)(t,r)};case s.ALL_FIELD_TYPES.timestamp:return(0,c.getTimestampFieldDomain)(t,r);default:return{domain:(0,c.getOrdinalDomain)(t,r)}}}},{key:"getColumnLayerDomain",value:function(e,t){var r=this.dataContainer,n=this.filteredIndexForDomain;if(!s.SCALE_TYPES[t])return u.console.error("scale type ".concat(t," not supported")),null;var a=e.valueAccessor,o=function(e){return a({index:e})},i=(0,c.getSortingFunction)(e.type);switch(t){case s.SCALE_TYPES.ordinal:case s.SCALE_TYPES.point:return(0,c.getOrdinalDomain)(r,a);case s.SCALE_TYPES.quantile:return(0,c.getQuantileDomain)(n,o,i);case s.SCALE_TYPES.log:return(0,c.getLogDomain)(n,o);case s.SCALE_TYPES.quantize:case s.SCALE_TYPES.linear:case s.SCALE_TYPES.sqrt:default:return(0,c.getLinearDomain)(n,o)}}},{key:"_assetField",value:function(e,t){t||u.console.error("".concat(e," doesnt exist in dataset ").concat(this.id))}}]),e}();t.default=S},16441:(e,t,r)=>{"use strict";var n=r(58784);Object.defineProperty(t,"__esModule",{value:!0}),t.UNWRAP_TASK=t.DELAY_TASK=t.ACTION_TASK=t.LOAD_CLOUD_MAP_TASK=t.EXPORT_FILE_TO_CLOUD_TASK=t.LOAD_MAP_STYLE_TASK=t.PROCESS_FILE_DATA=t.LOAD_FILE_TASK=void 0;var a=n(r(13370)),o=r(69323),i=r(6014),l=a.default.fromPromise((function(e){var t=e.file,r=e.fileCache,n=e.loaders,a=e.loadOptions;return(0,i.readFileInBatches)({file:t,fileCache:r,loaders:n,loadOptions:a})}),"LOAD_FILE_TASK");t.LOAD_FILE_TASK=l;var u=a.default.fromPromise(i.processFileData,"PROCESS_FILE_CONTENT");t.PROCESS_FILE_DATA=u;var d=(0,a.taskCreator)((function(e,t,r){var n=e.url,a=e.id;return(0,o.json)(n,(function(e,n){e?r(e):(n||r(new Error("Map style response is empty")),t({id:a,style:n}))}))}),"LOAD_MAP_STYLE_TASK");t.LOAD_MAP_STYLE_TASK=d;var s=a.default.fromPromise((function(e){var t=e.provider,r=e.payload;return t.uploadMap(r)}),"EXPORT_FILE_TO_CLOUD_TASK");t.EXPORT_FILE_TO_CLOUD_TASK=s;var f=a.default.fromPromise((function(e){var t=e.provider,r=e.payload;return t.downloadMap(r)}),"LOAD_CLOUD_MAP_TASK");t.LOAD_CLOUD_MAP_TASK=f;var c=a.default.fromCallback((function(e,t){return t()}),"ACTION_TASK");t.ACTION_TASK=c;var p=a.default.fromCallback((function(e,t){return window.setTimeout((function(){return t()}),e)}),"DELAY_TASK");t.DELAY_TASK=p;var y=a.default.fromPromise((function(e){return e}),"UNWRAP");t.UNWRAP_TASK=y},87883:(e,t,r)=>{"use strict";r.r(t),r.d(t,{_transform:()=>N.p,_warp:()=>U,assembleShaders:()=>n.P,brightnessContrast:()=>_,bulgePinch:()=>M,colorHalftone:()=>E,combineInjects:()=>a.Qt,convertToVec4:()=>i.hD,denoise:()=>T,dirlight:()=>c.C,dotScreen:()=>x,edgeWork:()=>F,fp32:()=>u.i,fp64:()=>d.vP,fp64arithmetic:()=>d.dI,fxaa:()=>D,getPassthroughFS:()=>i.Wk,getQualifierDetails:()=>i.$t,gouraudLighting:()=>y.K,hexagonalPixelate:()=>L,hueSaturation:()=>h,ink:()=>I,lights:()=>f._,magnify:()=>C,noise:()=>P,normalizeShaderModule:()=>o.b,pbr:()=>v.R,phongLighting:()=>y.p,picking:()=>p.q,project:()=>s.C,random:()=>l,sepia:()=>b,swirl:()=>w,tiltShift:()=>g,triangleBlur:()=>m,typeToChannelCount:()=>i._1,typeToChannelSuffix:()=>i.gC,vibrance:()=>S,vignette:()=>O,zoomBlur:()=>A});var n=r(34872),a=r(19568),o=r(78141),i=r(18378);const l={name:"random",fs:"float random(vec3 scale, float seed) {\n  return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);\n}\n"};var u=r(3612),d=r(98589),s=r(67180),f=r(83213),c=r(14176),p=r(37276),y=r(44123),v=r(64506);const g={name:"tiltShift",uniforms:{blurRadius:{value:15,min:0,max:50},gradientRadius:{value:200,min:0,max:400},start:[0,0],end:[1,1],invert:{value:!1,private:!0}},fs:"uniform float blurRadius;\nuniform float gradientRadius;\nuniform vec2 start;\nuniform vec2 end;\nuniform bool invert;\n\nvec2 tiltShift_getDelta(vec2 texSize) {\n  vec2 vector = normalize((end - start) * texSize);\n  return invert ? vec2(-vector.y, vector.x) : vector;\n}\n\nvec4 tiltShift_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {\n  vec4 color = vec4(0.0);\n  float total = 0.0;\n  float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\n\n  vec2 normal = normalize(vec2((start.y - end.y) * texSize.y, (end.x - start.x) * texSize.x));\n  float radius = smoothstep(0.0, 1.0,\n    abs(dot(texCoord * texSize - start * texSize, normal)) / gradientRadius) * blurRadius;\n\n  for (float t = -30.0; t <= 30.0; t++) {\n    float percent = (t + offset - 0.5) / 30.0;\n    float weight = 1.0 - abs(percent);\n    vec4 sample = texture2D(texture, texCoord + tiltShift_getDelta(texSize) / texSize * percent * radius);\n    sample.rgb *= sample.a;\n\n    color += sample * weight;\n    total += weight;\n  }\n\n  color = color / total;\n  color.rgb /= color.a + 0.00001;\n\n  return color;\n}\n",dependencies:[l],passes:[{sampler:!0,uniforms:{invert:!1}},{sampler:!0,uniforms:{invert:!0}}]},m={name:"triangleBlur",uniforms:{radius:{value:20,min:0,softMax:100},delta:{value:[1,0],private:!0}},fs:"uniform float radius;\nuniform vec2 delta;\n\nvec4 triangleBlur_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {\n  vec2 adjustedDelta = delta * radius / texSize;\n\n  vec4 color = vec4(0.0);\n  float total = 0.0;\n  float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\n\n  for (float t = -30.0; t <= 30.0; t++) {\n    float percent = (t + offset - 0.5) / 30.0;\n    float weight = 1.0 - abs(percent);\n    vec4 sample = texture2D(texture, texCoord + adjustedDelta * percent);\n    sample.rgb *= sample.a;\n\n    color += sample * weight;\n    total += weight;\n  }\n\n  color = color / total;\n  color.rgb /= color.a + 0.00001;\n\n  return color;\n}\n",dependencies:[l],passes:[{sampler:!0,uniforms:{delta:[1,0]}},{sampler:!0,uniforms:{delta:[0,1]}}]},A={name:"zoomBlur",uniforms:{center:[.5,.5],strength:{value:.3,min:0,softMax:1}},fs:"\nuniform vec2 center;\nuniform float strength;\n\nvec4 zoomBlur_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {\n  vec4 color = vec4(0.0);\n  float total = 0.0;\n  vec2 toCenter = center * texSize - texCoord * texSize;\n  float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\n\n  for (float t = 0.0; t <= 40.0; t++) {\n    float percent = (t + offset) / 40.0;\n    float weight = 4.0 * (percent - percent * percent);\n    vec4 sample = texture2D(texture, texCoord + toCenter * percent * strength / texSize);\n    sample.rgb *= sample.a;\n\n    color += sample * weight;\n    total += weight;\n  }\n\n  color = color / total;\n  color.rgb /= color.a + 0.00001;\n\n  return color;\n}\n",dependencies:[l],passes:[{sampler:!0}]},_={name:"brightnessContrast",uniforms:{brightness:{value:0,min:-1,max:1},contrast:{value:0,min:-1,max:1}},fs:"uniform float brightness;\nuniform float contrast;\n\nvec4 brightnessContrast_filterColor(vec4 color) {\n  color.rgb += brightness;\n  if (contrast > 0.0) {\n    color.rgb = (color.rgb - 0.5) / (1.0 - contrast) + 0.5;\n  } else {\n    color.rgb = (color.rgb - 0.5) * (1.0 + contrast) + 0.5;\n  }\n  return color;\n}\n\nvec4 brightnessContrast_filterColor(vec4 color, vec2 texSize, vec2 texCoords) {\n  return brightnessContrast_filterColor(color);\n}\n",passes:[{filter:!0}]},T={name:"denoise",uniforms:{strength:{value:.5,min:0,max:.1,adjust:e=>.53+200*Math.pow(1-e,4)}},fs:"uniform float strength;\n\nvec4 denoise_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {\n  float adjustedExponent = 3. + 200. * pow(1. - strength, 4.);\n\n  vec4 center = texture2D(texture, texCoord);\n  vec4 color = vec4(0.0);\n  float total = 0.0;\n  for (float x = -4.0; x <= 4.0; x += 1.0) {\n    for (float y = -4.0; y <= 4.0; y += 1.0) {\n      vec4 sample = texture2D(texture, texCoord + vec2(x, y) / texSize);\n      float weight = 1.0 - abs(dot(sample.rgb - center.rgb, vec3(0.25)));\n      weight = pow(weight, adjustedExponent);\n      color += sample * weight;\n      total += weight;\n    }\n  }\n\n  return color / total;\n}\n",passes:[{sampler:!0},{sampler:!0}]},h={name:"hueSaturation",uniforms:{hue:{value:0,min:-1,max:1},saturation:{value:0,min:-1,max:1}},fs:"uniform float hue;\nuniform float saturation;\n\nvec4 hueSaturation_filterColor(vec4 color) {\n  float angle = hue * 3.14159265;\n  float s = sin(angle), c = cos(angle);\n  vec3 weights = (vec3(2.0 * c, -sqrt(3.0) * s - c, sqrt(3.0) * s - c) + 1.0) / 3.0;\n  float len = length(color.rgb);\n  color.rgb = vec3(\n    dot(color.rgb, weights.xyz),\n    dot(color.rgb, weights.zxy),\n    dot(color.rgb, weights.yzx)\n  );\n  float average = (color.r + color.g + color.b) / 3.0;\n  if (saturation > 0.0) {\n    color.rgb += (average - color.rgb) * (1.0 - 1.0 / (1.001 - saturation));\n  } else {\n    color.rgb += (average - color.rgb) * (-saturation);\n  }\n\n  return color;\n}\n\nvec4 hueSaturation_filterColor(vec4 color, vec2 texSize, vec2 texCoord) {\n  return hueSaturation_filterColor(color);\n}\n",passes:[{filter:!0}]},P={name:"noise",uniforms:{amount:{value:.5,min:0,max:1}},fs:"uniform float amount;\n\nfloat rand(vec2 co) {\n  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\n}\n\nvec4 noise_filterColor(vec4 color, vec2 texCoord) {\n  float diff = (rand(texCoord) - 0.5) * amount;\n  color.r += diff;\n  color.g += diff;\n  color.b += diff;\n  return color;\n}\n\nvec4 noise_filterColor(vec4 color, vec2 texSize, vec2 texCoord) {\n  return noise_filterColor(color, texCoord);\n}\n",passes:[{filter:!0}]},b={name:"sepia",uniforms:{amount:{value:.5,min:0,max:1}},fs:"uniform float amount;\n\nvec4 sepia_filterColor(vec4 color) {\n  float r = color.r;\n  float g = color.g;\n  float b = color.b;\n\n  color.r =\n    min(1.0, (r * (1.0 - (0.607 * amount))) + (g * (0.769 * amount)) + (b * (0.189 * amount)));\n  color.g = min(1.0, (r * 0.349 * amount) + (g * (1.0 - (0.314 * amount))) + (b * 0.168 * amount));\n  color.b = min(1.0, (r * 0.272 * amount) + (g * 0.534 * amount) + (b * (1.0 - (0.869 * amount))));\n\n  return color;\n}\n\nvec4 sepia_filterColor(vec4 color, vec2 texSize, vec2 texCoord) {\n  return sepia_filterColor(color);\n}\n",passes:[{filter:!0}]},S={name:"vibrance",uniforms:{amount:{value:0,min:-1,max:1}},fs:"uniform float amount;\n\nvec4 vibrance_filterColor(vec4 color) {\n  float average = (color.r + color.g + color.b) / 3.0;\n  float mx = max(color.r, max(color.g, color.b));\n  float amt = (mx - average) * (-amount * 3.0);\n  color.rgb = mix(color.rgb, vec3(mx), amt);\n  return color;\n}\n\nvec4 vibrance_filterColor(vec4 color, vec2 texSize, vec2 texCoord) {\n  return vibrance_filterColor(color);\n}\n",passes:[{filter:!0}]},O={name:"vignette",fs:"uniform float radius;\nuniform float amount;\n\nvec4 vignette_filterColor(vec4 color, vec2 texCoord) {\n  float dist = distance(texCoord, vec2(0.5, 0.5));\n  float ratio = smoothstep(0.8, radius * 0.799, dist * (amount + radius));\n  return color.rgba * ratio + (1.0 - ratio)*vec4(0.0, 0.0, 0.0, 1.0);\n}\n\nvec4 vignette_filterColor(vec4 color, vec2 texSize, vec2 texCoord) {\n  return vignette_filterColor(color, texCoord);\n}\n",uniforms:{radius:{value:.5,min:0,max:1},amount:{value:.5,min:0,max:1}},passes:[{filter:!0}]},E={name:"colorHalftone",uniforms:{center:[.5,.5],angle:{value:1.1,softMin:0,softMax:Math.PI/2},size:{value:4,min:1,softMin:3,softMax:20}},fs:"uniform vec2 center;\nuniform float angle;\nuniform float size;\n\nfloat scale = 3.1514 / size;\n\nfloat pattern(float angle, vec2 texSize, vec2 texCoord) {\n  float s = sin(angle), c = cos(angle);\n  vec2 tex = texCoord * texSize - center * texSize;\n  vec2 point = vec2(\n\tc * tex.x - s * tex.y,\n\ts * tex.x + c * tex.y\n  ) * scale;\n  return (sin(point.x) * sin(point.y)) * 4.0;\n}\n\nvec4 colorHalftone_filterColor(vec4 color, vec2 texSize, vec2 texCoord) {\n  vec3 cmy = 1.0 - color.rgb;\n  float k = min(cmy.x, min(cmy.y, cmy.z));\n  cmy = (cmy - k) / (1.0 - k);\n  cmy = clamp(\n\tcmy * 10.0 - 3.0 + vec3(\n    pattern(angle + 0.26179, texSize, texCoord),\n\t  pattern(angle + 1.30899, texSize, texCoord),\n    pattern(angle, texSize, texCoord)\n  ),\n\t0.0,\n\t1.0\n  );\n  k = clamp(k * 10.0 - 5.0 + pattern(angle + 0.78539, texSize, texCoord), 0.0, 1.0);\n  return vec4(1.0 - cmy - k, color.a);\n}\n",passes:[{filter:!0}]},x={name:"dotScreen",uniforms:{center:[.5,.5],angle:{value:1.1,softMin:0,softMax:Math.PI/2},size:{value:3,min:1,softMin:3,softMax:20}},fs:"uniform vec2 center;\nuniform float angle;\nuniform float size;\n\nfloat pattern(vec2 texSize, vec2 texCoord) {\n  float scale = 3.1415 / size;\n\n  float s = sin(angle), c = cos(angle);\n  vec2 tex = texCoord * texSize - center * texSize;\n  vec2 point = vec2(\n    c * tex.x - s * tex.y,\n    s * tex.x + c * tex.y\n  ) * scale;\n  return (sin(point.x) * sin(point.y)) * 4.0;\n}\n\nvec4 dotScreen_filterColor(vec4 color, vec2 texSize, vec2 texCoord) {\n  float average = (color.r + color.g + color.b) / 3.0;\n  return vec4(vec3(average * 10.0 - 5.0 + pattern(texSize, texCoord)), color.a);\n}\n",passes:[{filter:!0}]},F={name:"edgeWork",uniforms:{radius:{value:2,min:1,softMax:50},delta:{value:[1,0],private:!0}},fs:"uniform float radius;\nuniform vec2 delta;\n\nvec4 edgeWork_sampleColor1(sampler2D source, vec2 texSize, vec2 texCoord) {\n  vec2 relativeDelta = radius * delta / texSize;\n\n  vec2 color = vec2(0.0);\n  vec2 total = vec2(0.0);\n  float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\n\n  for (float t = -30.0; t <= 30.0; t++) {\n    float percent = (t + offset - 0.5) / 30.0;\n    float weight = 1.0 - abs(percent);\n    vec3 sampleColor = texture2D(source, texCoord + relativeDelta * percent).rgb;\n    float average = (sampleColor.r + sampleColor.g + sampleColor.b) / 3.0;\n    color.x += average * weight;\n    total.x += weight;\n    if (abs(t) < 15.0) {\n      weight = weight * 2.0 - 1.0;\n      color.y += average * weight;\n      total.y += weight;\n    }\n  }\n  return vec4(color / total, 0.0, 1.0);\n}\n\nvec4 edgeWork_sampleColor2(sampler2D source, vec2 texSize, vec2 texCoord) {\n  vec2 relativeDelta = radius * delta / texSize;\n\n  vec2 color = vec2(0.0);\n  vec2 total = vec2(0.0);\n  float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\n\n  for (float t = -30.0; t <= 30.0; t++) {\n    float percent = (t + offset - 0.5) / 30.0;\n    float weight = 1.0 - abs(percent);\n    vec2 sampleColor = texture2D(source, texCoord + relativeDelta * percent).xy;\n    color.x += sampleColor.x * weight;\n    total.x += weight;\n    if (abs(t) < 15.0) {\n      weight = weight * 2.0 - 1.0;\n      color.y += sampleColor.y * weight;\n      total.y += weight;\n    }\n  }\n  float c = clamp(10000.0 * (color.y / total.y - color.x / total.x) + 0.5, 0.0, 1.0);\n  return vec4(c, c, c, 1.0);\n}\n",dependencies:[l],passes:[{sampler:"edgeWork_sampleColor1",uniforms:{delta:[1,0]}},{sampler:"edgeWork_sampleColor2",uniforms:{delta:[0,1]}}]},L={name:"hexagonalPixelate",uniforms:{center:{value:[.5,.5],hint:"screenspace"},scale:{value:10,min:1,softMin:5,softMax:50}},fs:"uniform vec2 center;\nuniform float scale;\n\nvec4 hexagonalPixelate_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {\n  vec2 tex = (texCoord * texSize - center * texSize) / scale;\n  tex.y /= 0.866025404;\n  tex.x -= tex.y * 0.5;\n\n  vec2 a;\n  if (tex.x + tex.y - floor(tex.x) - floor(tex.y) < 1.0) {\n    a = vec2(floor(tex.x), floor(tex.y));\n  }\n  else a = vec2(ceil(tex.x), ceil(tex.y));\n  vec2 b = vec2(ceil(tex.x), floor(tex.y));\n  vec2 c = vec2(floor(tex.x), ceil(tex.y));\n\n  vec3 TEX = vec3(tex.x, tex.y, 1.0 - tex.x - tex.y);\n  vec3 A = vec3(a.x, a.y, 1.0 - a.x - a.y);\n  vec3 B = vec3(b.x, b.y, 1.0 - b.x - b.y);\n  vec3 C = vec3(c.x, c.y, 1.0 - c.x - c.y);\n\n  float alen = length(TEX - A);\n  float blen = length(TEX - B);\n  float clen = length(TEX - C);\n\n  vec2 choice;\n  if (alen < blen) {\n    if (alen < clen) choice = a;\n    else choice = c;\n  } else {\n    if (blen < clen) choice = b;\n    else choice = c;\n  }\n\n  choice.x += choice.y * 0.5;\n  choice.y *= 0.866025404;\n  choice *= scale / texSize;\n\n  return texture2D(texture, choice + center);\n}\n",passes:[{sampler:!0}]},I={name:"ink",uniforms:{strength:{value:.25,min:0,softMax:1}},fs:"uniform float strength;\n\nvec4 ink_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {\n  vec2 dx = vec2(1.0 / texSize.x, 0.0);\n  vec2 dy = vec2(0.0, 1.0 / texSize.y);\n  vec4 color = texture2D(texture, texCoord);\n  float bigTotal = 0.0;\n  float smallTotal = 0.0;\n  vec3 bigAverage = vec3(0.0);\n  vec3 smallAverage = vec3(0.0);\n  for (float x = -2.0; x <= 2.0; x += 1.0) {\n    for (float y = -2.0; y <= 2.0; y += 1.0) {\n      vec3 sample = texture2D(texture, texCoord + dx * x + dy * y).rgb;\n      bigAverage += sample;\n      bigTotal += 1.0;\n      if (abs(x) + abs(y) < 2.0) {\n        smallAverage += sample;\n        smallTotal += 1.0;\n      }\n    }\n  }\n  vec3 edge = max(vec3(0.0), bigAverage / bigTotal - smallAverage / smallTotal);\n  float power = strength * strength * strength * strength * strength;\n  return vec4(color.rgb - dot(edge, edge) * power * 100000.0, color.a);\n}\n",passes:[{sampler:!0}]},C={name:"magnify",uniforms:{screenXY:[0,0],radiusPixels:200,zoom:2,borderWidthPixels:0,borderColor:[255,255,255,255]},fs:"uniform vec2 screenXY;\nuniform float radiusPixels;\nuniform float zoom;\nuniform float borderWidthPixels;\nuniform vec4 borderColor;\n\nvec4 magnify_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {\n  vec2 pos = vec2(screenXY.x, 1.0 - screenXY.y);\n  float dist = distance(texCoord * texSize, pos * texSize);\n  if (dist < radiusPixels) {\n    return texture2D(texture, (texCoord - pos) / zoom + pos);\n  }\n\n  if (dist <= radiusPixels + borderWidthPixels) {\n    return borderColor;\n  }\n  return texture2D(texture, texCoord);\n}\n",passes:[{sampler:!0}]},U={name:"warp",fs:"vec4 warp_sampleColor(sampler2D texture, vec2 texSize, vec2 coord) {\n  vec4 color = texture2D(texture, coord / texSize);\n  vec2 clampedCoord = clamp(coord, vec2(0.0), texSize);\n  if (coord != clampedCoord) {\n    color.a *= max(0.0, 1.0 - length(coord - clampedCoord));\n  }\n\n  return color;\n}\n"},M={name:"bulgePinch",fs:"uniform float radius;\nuniform float strength;\nuniform vec2 center;\n\nvec2 bulgePinch_warp(vec2 coord, vec2 texCenter) {\n  coord -= texCenter;\n  float distance = length(coord);\n  if (distance < radius) {\n    float percent = distance / radius;\n    if (strength > 0.0) {\n      coord *= mix(1.0, smoothstep(0.0, radius / distance, percent), strength * 0.75);\n    } else {\n      coord *= mix(1.0, pow(percent, 1.0 + strength * 0.75) * radius / distance, 1.0 - percent);\n    }\n  }\n  coord += texCenter;\n  return coord;\n}\n\nvec4 bulgePinch_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {\n  vec2 coord = texCoord * texSize;\n  coord = bulgePinch_warp(coord, center * texSize);\n\n  return warp_sampleColor(texture, texSize, coord);\n}\n",uniforms:{center:[.5,.5],radius:{value:200,min:1,softMax:600},strength:{value:.5,min:-1,max:1}},dependencies:[U],passes:[{sampler:!0}]},w={name:"swirl",fs:"uniform float radius;\nuniform float angle;\nuniform vec2 center;\n\nvec2 swirl_warp(vec2 coord, vec2 texCenter) {\n  coord -= texCenter;\n  float distance = length(coord);\n  if (distance < radius) {\n    float percent = (radius - distance) / radius;\n    float theta = percent * percent * angle;\n    float s = sin(theta);\n    float c = cos(theta);\n    coord = vec2(\n      coord.x * c - coord.y * s,\n      coord.x * s + coord.y * c\n    );\n  }\n  coord += texCenter;\n  return coord;\n}\n\nvec4 swirl_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {\n  vec2 coord = texCoord * texSize;\n  coord = swirl_warp(coord, center * texSize);\n\n  return warp_sampleColor(texture, texSize, coord);\n}\n",uniforms:{center:[.5,.5],radius:{value:200,min:1,softMax:600},angle:{value:3,softMin:-25,softMax:25}},dependencies:[U],passes:[{sampler:!0}]},D={name:"fxaa",uniforms:{},fs:"\n#define FXAA_QUALITY_PRESET 29\n\n#if (FXAA_QUALITY_PRESET == 10)\n    #define FXAA_QUALITY_PS 3\n    #define FXAA_QUALITY_P0 1.5\n    #define FXAA_QUALITY_P1 3.0\n    #define FXAA_QUALITY_P2 12.0\n#endif\n#if (FXAA_QUALITY_PRESET == 11)\n    #define FXAA_QUALITY_PS 4\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 3.0\n    #define FXAA_QUALITY_P3 12.0\n#endif\n#if (FXAA_QUALITY_PRESET == 12)\n    #define FXAA_QUALITY_PS 5\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 4.0\n    #define FXAA_QUALITY_P4 12.0\n#endif\n#if (FXAA_QUALITY_PRESET == 13)\n    #define FXAA_QUALITY_PS 6\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 4.0\n    #define FXAA_QUALITY_P5 12.0\n#endif\n#if (FXAA_QUALITY_PRESET == 14)\n    #define FXAA_QUALITY_PS 7\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 4.0\n    #define FXAA_QUALITY_P6 12.0\n#endif\n#if (FXAA_QUALITY_PRESET == 15)\n    #define FXAA_QUALITY_PS 8\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 2.0\n    #define FXAA_QUALITY_P6 4.0\n    #define FXAA_QUALITY_P7 12.0\n#endif\n#if (FXAA_QUALITY_PRESET == 20)\n    #define FXAA_QUALITY_PS 3\n    #define FXAA_QUALITY_P0 1.5\n    #define FXAA_QUALITY_P1 2.0\n    #define FXAA_QUALITY_P2 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 21)\n    #define FXAA_QUALITY_PS 4\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 22)\n    #define FXAA_QUALITY_PS 5\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 23)\n    #define FXAA_QUALITY_PS 6\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 24)\n    #define FXAA_QUALITY_PS 7\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 3.0\n    #define FXAA_QUALITY_P6 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 25)\n    #define FXAA_QUALITY_PS 8\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 2.0\n    #define FXAA_QUALITY_P6 4.0\n    #define FXAA_QUALITY_P7 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 26)\n    #define FXAA_QUALITY_PS 9\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 2.0\n    #define FXAA_QUALITY_P6 2.0\n    #define FXAA_QUALITY_P7 4.0\n    #define FXAA_QUALITY_P8 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 27)\n    #define FXAA_QUALITY_PS 10\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 2.0\n    #define FXAA_QUALITY_P6 2.0\n    #define FXAA_QUALITY_P7 2.0\n    #define FXAA_QUALITY_P8 4.0\n    #define FXAA_QUALITY_P9 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 28)\n    #define FXAA_QUALITY_PS 11\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 2.0\n    #define FXAA_QUALITY_P6 2.0\n    #define FXAA_QUALITY_P7 2.0\n    #define FXAA_QUALITY_P8 2.0\n    #define FXAA_QUALITY_P9 4.0\n    #define FXAA_QUALITY_P10 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 29)\n    #define FXAA_QUALITY_PS 12\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 2.0\n    #define FXAA_QUALITY_P6 2.0\n    #define FXAA_QUALITY_P7 2.0\n    #define FXAA_QUALITY_P8 2.0\n    #define FXAA_QUALITY_P9 2.0\n    #define FXAA_QUALITY_P10 4.0\n    #define FXAA_QUALITY_P11 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 39)\n    #define FXAA_QUALITY_PS 12\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.0\n    #define FXAA_QUALITY_P2 1.0\n    #define FXAA_QUALITY_P3 1.0\n    #define FXAA_QUALITY_P4 1.0\n    #define FXAA_QUALITY_P5 1.5\n    #define FXAA_QUALITY_P6 2.0\n    #define FXAA_QUALITY_P7 2.0\n    #define FXAA_QUALITY_P8 2.0\n    #define FXAA_QUALITY_P9 2.0\n    #define FXAA_QUALITY_P10 4.0\n    #define FXAA_QUALITY_P11 8.0\n#endif\n\n#define FxaaBool bool\n#define FxaaFloat float\n#define FxaaFloat2 vec2\n#define FxaaFloat3 vec3\n#define FxaaFloat4 vec4\n#define FxaaHalf float\n#define FxaaHalf2 vec2\n#define FxaaHalf3 vec3\n#define FxaaHalf4 vec4\n#define FxaaInt2 vec2\n#define FxaaTex sampler2D\n\n#define FxaaSat(x) clamp(x, 0.0, 1.0)\n#define FxaaTexTop(t, p) texture2D(t, p)\n#define FxaaTexOff(t, p, o, r) texture2D(t, p + (o * r))\n\nFxaaFloat FxaaLuma_(FxaaFloat4 rgba) { return dot(rgba.rgb, vec3(0.2126, 0.7152, 0.0722)); }\n\nFxaaFloat4 FxaaPixelShader_(\n\n\n    FxaaFloat2 pos,\n\n\n\n\n    FxaaTex tex,\n\n\n\n\n    FxaaFloat2 fxaaQualityRcpFrame,\n\n\n\n\n\n\n\n\n\n\n    FxaaFloat fxaaQualitySubpix,\n\n\n\n\n\n\n\n\n\n    FxaaFloat fxaaQualityEdgeThreshold,\n\n\n\n\n\n\n\n\n\n\n\n\n\n    FxaaFloat fxaaQualityEdgeThresholdMin\n) {\n    FxaaFloat2 posM;\n    posM.x = pos.x;\n    posM.y = pos.y;\n    FxaaFloat4 rgbyM = FxaaTexTop(tex, posM);\n    #define lumaM rgbyM.y\n    FxaaFloat lumaS = FxaaLuma_(FxaaTexOff(tex, posM, FxaaInt2( 0, 1), fxaaQualityRcpFrame.xy));\n    FxaaFloat lumaE = FxaaLuma_(FxaaTexOff(tex, posM, FxaaInt2( 1, 0), fxaaQualityRcpFrame.xy));\n    FxaaFloat lumaN = FxaaLuma_(FxaaTexOff(tex, posM, FxaaInt2( 0,-1), fxaaQualityRcpFrame.xy));\n    FxaaFloat lumaW = FxaaLuma_(FxaaTexOff(tex, posM, FxaaInt2(-1, 0), fxaaQualityRcpFrame.xy));\n    FxaaFloat maxSM = max(lumaS, lumaM);\n    FxaaFloat minSM = min(lumaS, lumaM);\n    FxaaFloat maxESM = max(lumaE, maxSM);\n    FxaaFloat minESM = min(lumaE, minSM);\n    FxaaFloat maxWN = max(lumaN, lumaW);\n    FxaaFloat minWN = min(lumaN, lumaW);\n    FxaaFloat rangeMax = max(maxWN, maxESM);\n    FxaaFloat rangeMin = min(minWN, minESM);\n    FxaaFloat rangeMaxScaled = rangeMax * fxaaQualityEdgeThreshold;\n    FxaaFloat range = rangeMax - rangeMin;\n    FxaaFloat rangeMaxClamped = max(fxaaQualityEdgeThresholdMin, rangeMaxScaled);\n    FxaaBool earlyExit = range < rangeMaxClamped;\n    if(earlyExit)\n        return rgbyM;\n    FxaaFloat lumaNW = FxaaLuma_(FxaaTexOff(tex, posM, FxaaInt2(-1,-1), fxaaQualityRcpFrame.xy));\n    FxaaFloat lumaSE = FxaaLuma_(FxaaTexOff(tex, posM, FxaaInt2( 1, 1), fxaaQualityRcpFrame.xy));\n    FxaaFloat lumaNE = FxaaLuma_(FxaaTexOff(tex, posM, FxaaInt2( 1,-1), fxaaQualityRcpFrame.xy));\n    FxaaFloat lumaSW = FxaaLuma_(FxaaTexOff(tex, posM, FxaaInt2(-1, 1), fxaaQualityRcpFrame.xy));\n    FxaaFloat lumaNS = lumaN + lumaS;\n    FxaaFloat lumaWE = lumaW + lumaE;\n    FxaaFloat subpixRcpRange = 1.0/range;\n    FxaaFloat subpixNSWE = lumaNS + lumaWE;\n    FxaaFloat edgeHorz1 = (-2.0 * lumaM) + lumaNS;\n    FxaaFloat edgeVert1 = (-2.0 * lumaM) + lumaWE;\n    FxaaFloat lumaNESE = lumaNE + lumaSE;\n    FxaaFloat lumaNWNE = lumaNW + lumaNE;\n    FxaaFloat edgeHorz2 = (-2.0 * lumaE) + lumaNESE;\n    FxaaFloat edgeVert2 = (-2.0 * lumaN) + lumaNWNE;\n    FxaaFloat lumaNWSW = lumaNW + lumaSW;\n    FxaaFloat lumaSWSE = lumaSW + lumaSE;\n    FxaaFloat edgeHorz4 = (abs(edgeHorz1) * 2.0) + abs(edgeHorz2);\n    FxaaFloat edgeVert4 = (abs(edgeVert1) * 2.0) + abs(edgeVert2);\n    FxaaFloat edgeHorz3 = (-2.0 * lumaW) + lumaNWSW;\n    FxaaFloat edgeVert3 = (-2.0 * lumaS) + lumaSWSE;\n    FxaaFloat edgeHorz = abs(edgeHorz3) + edgeHorz4;\n    FxaaFloat edgeVert = abs(edgeVert3) + edgeVert4;\n    FxaaFloat subpixNWSWNESE = lumaNWSW + lumaNESE;\n    FxaaFloat lengthSign = fxaaQualityRcpFrame.x;\n    FxaaBool horzSpan = edgeHorz >= edgeVert;\n    FxaaFloat subpixA = subpixNSWE * 2.0 + subpixNWSWNESE;\n    if(!horzSpan) lumaN = lumaW;\n    if(!horzSpan) lumaS = lumaE;\n    if(horzSpan) lengthSign = fxaaQualityRcpFrame.y;\n    FxaaFloat subpixB = (subpixA * (1.0/12.0)) - lumaM;\n    FxaaFloat gradientN = lumaN - lumaM;\n    FxaaFloat gradientS = lumaS - lumaM;\n    FxaaFloat lumaNN = lumaN + lumaM;\n    FxaaFloat lumaSS = lumaS + lumaM;\n    FxaaBool pairN = abs(gradientN) >= abs(gradientS);\n    FxaaFloat gradient = max(abs(gradientN), abs(gradientS));\n    if(pairN) lengthSign = -lengthSign;\n    FxaaFloat subpixC = FxaaSat(abs(subpixB) * subpixRcpRange);\n    FxaaFloat2 posB;\n    posB.x = posM.x;\n    posB.y = posM.y;\n    FxaaFloat2 offNP;\n    offNP.x = (!horzSpan) ? 0.0 : fxaaQualityRcpFrame.x;\n    offNP.y = ( horzSpan) ? 0.0 : fxaaQualityRcpFrame.y;\n    if(!horzSpan) posB.x += lengthSign * 0.5;\n    if( horzSpan) posB.y += lengthSign * 0.5;\n    FxaaFloat2 posN;\n    posN.x = posB.x - offNP.x * FXAA_QUALITY_P0;\n    posN.y = posB.y - offNP.y * FXAA_QUALITY_P0;\n    FxaaFloat2 posP;\n    posP.x = posB.x + offNP.x * FXAA_QUALITY_P0;\n    posP.y = posB.y + offNP.y * FXAA_QUALITY_P0;\n    FxaaFloat subpixD = ((-2.0)*subpixC) + 3.0;\n    FxaaFloat lumaEndN = FxaaLuma_(FxaaTexTop(tex, posN));\n    FxaaFloat subpixE = subpixC * subpixC;\n    FxaaFloat lumaEndP = FxaaLuma_(FxaaTexTop(tex, posP));\n    if(!pairN) lumaNN = lumaSS;\n    FxaaFloat gradientScaled = gradient * 1.0/4.0;\n    FxaaFloat lumaMM = lumaM - lumaNN * 0.5;\n    FxaaFloat subpixF = subpixD * subpixE;\n    FxaaBool lumaMLTZero = lumaMM < 0.0;\n    lumaEndN -= lumaNN * 0.5;\n    lumaEndP -= lumaNN * 0.5;\n    FxaaBool doneN = abs(lumaEndN) >= gradientScaled;\n    FxaaBool doneP = abs(lumaEndP) >= gradientScaled;\n    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P1;\n    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P1;\n    FxaaBool doneNP = (!doneN) || (!doneP);\n    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P1;\n    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P1;\n    if(doneNP) {\n        if(!doneN) lumaEndN = FxaaLuma_(FxaaTexTop(tex, posN.xy));\n        if(!doneP) lumaEndP = FxaaLuma_(FxaaTexTop(tex, posP.xy));\n        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n        doneN = abs(lumaEndN) >= gradientScaled;\n        doneP = abs(lumaEndP) >= gradientScaled;\n        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P2;\n        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P2;\n        doneNP = (!doneN) || (!doneP);\n        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P2;\n        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P2;\n        #if (FXAA_QUALITY_PS > 3)\n        if(doneNP) {\n            if(!doneN) lumaEndN = FxaaLuma_(FxaaTexTop(tex, posN.xy));\n            if(!doneP) lumaEndP = FxaaLuma_(FxaaTexTop(tex, posP.xy));\n            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n            doneN = abs(lumaEndN) >= gradientScaled;\n            doneP = abs(lumaEndP) >= gradientScaled;\n            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P3;\n            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P3;\n            doneNP = (!doneN) || (!doneP);\n            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P3;\n            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P3;\n            #if (FXAA_QUALITY_PS > 4)\n            if(doneNP) {\n                if(!doneN) lumaEndN = FxaaLuma_(FxaaTexTop(tex, posN.xy));\n                if(!doneP) lumaEndP = FxaaLuma_(FxaaTexTop(tex, posP.xy));\n                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n                doneN = abs(lumaEndN) >= gradientScaled;\n                doneP = abs(lumaEndP) >= gradientScaled;\n                if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P4;\n                if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P4;\n                doneNP = (!doneN) || (!doneP);\n                if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P4;\n                if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P4;\n                #if (FXAA_QUALITY_PS > 5)\n                if(doneNP) {\n                    if(!doneN) lumaEndN = FxaaLuma_(FxaaTexTop(tex, posN.xy));\n                    if(!doneP) lumaEndP = FxaaLuma_(FxaaTexTop(tex, posP.xy));\n                    if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n                    if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n                    doneN = abs(lumaEndN) >= gradientScaled;\n                    doneP = abs(lumaEndP) >= gradientScaled;\n                    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P5;\n                    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P5;\n                    doneNP = (!doneN) || (!doneP);\n                    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P5;\n                    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P5;\n                    #if (FXAA_QUALITY_PS > 6)\n                    if(doneNP) {\n                        if(!doneN) lumaEndN = FxaaLuma_(FxaaTexTop(tex, posN.xy));\n                        if(!doneP) lumaEndP = FxaaLuma_(FxaaTexTop(tex, posP.xy));\n                        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n                        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n                        doneN = abs(lumaEndN) >= gradientScaled;\n                        doneP = abs(lumaEndP) >= gradientScaled;\n                        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P6;\n                        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P6;\n                        doneNP = (!doneN) || (!doneP);\n                        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P6;\n                        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P6;\n                        #if (FXAA_QUALITY_PS > 7)\n                        if(doneNP) {\n                            if(!doneN) lumaEndN = FxaaLuma_(FxaaTexTop(tex, posN.xy));\n                            if(!doneP) lumaEndP = FxaaLuma_(FxaaTexTop(tex, posP.xy));\n                            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n                            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n                            doneN = abs(lumaEndN) >= gradientScaled;\n                            doneP = abs(lumaEndP) >= gradientScaled;\n                            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P7;\n                            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P7;\n                            doneNP = (!doneN) || (!doneP);\n                            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P7;\n                            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P7;\n    #if (FXAA_QUALITY_PS > 8)\n    if(doneNP) {\n        if(!doneN) lumaEndN = FxaaLuma_(FxaaTexTop(tex, posN.xy));\n        if(!doneP) lumaEndP = FxaaLuma_(FxaaTexTop(tex, posP.xy));\n        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n        doneN = abs(lumaEndN) >= gradientScaled;\n        doneP = abs(lumaEndP) >= gradientScaled;\n        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P8;\n        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P8;\n        doneNP = (!doneN) || (!doneP);\n        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P8;\n        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P8;\n        #if (FXAA_QUALITY_PS > 9)\n        if(doneNP) {\n            if(!doneN) lumaEndN = FxaaLuma_(FxaaTexTop(tex, posN.xy));\n            if(!doneP) lumaEndP = FxaaLuma_(FxaaTexTop(tex, posP.xy));\n            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n            doneN = abs(lumaEndN) >= gradientScaled;\n            doneP = abs(lumaEndP) >= gradientScaled;\n            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P9;\n            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P9;\n            doneNP = (!doneN) || (!doneP);\n            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P9;\n            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P9;\n            #if (FXAA_QUALITY_PS > 10)\n            if(doneNP) {\n                if(!doneN) lumaEndN = FxaaLuma_(FxaaTexTop(tex, posN.xy));\n                if(!doneP) lumaEndP = FxaaLuma_(FxaaTexTop(tex, posP.xy));\n                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n                doneN = abs(lumaEndN) >= gradientScaled;\n                doneP = abs(lumaEndP) >= gradientScaled;\n                if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P10;\n                if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P10;\n                doneNP = (!doneN) || (!doneP);\n                if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P10;\n                if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P10;\n                #if (FXAA_QUALITY_PS > 11)\n                if(doneNP) {\n                    if(!doneN) lumaEndN = FxaaLuma_(FxaaTexTop(tex, posN.xy));\n                    if(!doneP) lumaEndP = FxaaLuma_(FxaaTexTop(tex, posP.xy));\n                    if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n                    if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n                    doneN = abs(lumaEndN) >= gradientScaled;\n                    doneP = abs(lumaEndP) >= gradientScaled;\n                    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P11;\n                    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P11;\n                    doneNP = (!doneN) || (!doneP);\n                    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P11;\n                    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P11;\n                    #if (FXAA_QUALITY_PS > 12)\n                    if(doneNP) {\n                        if(!doneN) lumaEndN = FxaaLuma_(FxaaTexTop(tex, posN.xy));\n                        if(!doneP) lumaEndP = FxaaLuma_(FxaaTexTop(tex, posP.xy));\n                        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n                        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n                        doneN = abs(lumaEndN) >= gradientScaled;\n                        doneP = abs(lumaEndP) >= gradientScaled;\n                        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P12;\n                        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P12;\n                        doneNP = (!doneN) || (!doneP);\n                        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P12;\n                        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P12;\n                    }\n                    #endif\n                }\n                #endif\n            }\n            #endif\n        }\n        #endif\n    }\n    #endif\n                        }\n                        #endif\n                    }\n                    #endif\n                }\n                #endif\n            }\n            #endif\n        }\n        #endif\n    }\n    FxaaFloat dstN = posM.x - posN.x;\n    FxaaFloat dstP = posP.x - posM.x;\n    if(!horzSpan) dstN = posM.y - posN.y;\n    if(!horzSpan) dstP = posP.y - posM.y;\n    FxaaBool goodSpanN = (lumaEndN < 0.0) != lumaMLTZero;\n    FxaaFloat spanLength = (dstP + dstN);\n    FxaaBool goodSpanP = (lumaEndP < 0.0) != lumaMLTZero;\n    FxaaFloat spanLengthRcp = 1.0/spanLength;\n    FxaaBool directionN = dstN < dstP;\n    FxaaFloat dst = min(dstN, dstP);\n    FxaaBool goodSpan = directionN ? goodSpanN : goodSpanP;\n    FxaaFloat subpixG = subpixF * subpixF;\n    FxaaFloat pixelOffset = (dst * (-spanLengthRcp)) + 0.5;\n    FxaaFloat subpixH = subpixG * fxaaQualitySubpix;\n    FxaaFloat pixelOffsetGood = goodSpan ? pixelOffset : 0.0;\n    FxaaFloat pixelOffsetSubpix = max(pixelOffsetGood, subpixH);\n    if(!horzSpan) posM.x += pixelOffsetSubpix * lengthSign;\n    if( horzSpan) posM.y += pixelOffsetSubpix * lengthSign;\n    return FxaaTexTop(tex, posM);\n}\n\nvec4 fxaa_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {\n    const float fxaa_QualitySubpix = 0.5;\n    const float fxaa_QualityEdgeThreshold = 0.125;\n    const float fxaa_QualityEdgeThresholdMin = 0.0833;\n\n    return FxaaPixelShader_(\n        texCoord,\n        texture,\n        vec2(1.0) / texSize,\n        fxaa_QualitySubpix,\n        fxaa_QualityEdgeThreshold,\n        fxaa_QualityEdgeThresholdMin\n    );\n}\n",passes:[{sampler:!0}]};var N=r(21852)},7541:(e,t,r)=>{"use strict";r.d(t,{Un:()=>l,e2:()=>i,fy:()=>o,hG:()=>u,oz:()=>d,sw:()=>a,zB:()=>s});var n=(0,r(28996).A)(","),a=n.parse,o=n.parseRows,i=n.format,l=n.formatBody,u=n.formatRows,d=n.formatRow,s=n.formatValue},28996:(e,t,r)=>{"use strict";r.d(t,{A:()=>f});var n={},a={},o=34,i=10,l=13;function u(e){return new Function("d","return {"+e.map((function(e,t){return JSON.stringify(e)+": d["+t+'] || ""'})).join(",")+"}")}function d(e){var t=Object.create(null),r=[];return e.forEach((function(e){for(var n in e)n in t||r.push(t[n]=n)})),r}function s(e,t){var r=e+"",n=r.length;return n<t?new Array(t-n+1).join(0)+r:r}function f(e){var t=new RegExp('["'+e+"\n\r]"),r=e.charCodeAt(0);function f(e,t){var u,d=[],s=e.length,f=0,c=0,p=s<=0,y=!1;function v(){if(p)return a;if(y)return y=!1,n;var t,u,d=f;if(e.charCodeAt(d)===o){for(;f++<s&&e.charCodeAt(f)!==o||e.charCodeAt(++f)===o;);return(t=f)>=s?p=!0:(u=e.charCodeAt(f++))===i?y=!0:u===l&&(y=!0,e.charCodeAt(f)===i&&++f),e.slice(d+1,t-1).replace(/""/g,'"')}for(;f<s;){if((u=e.charCodeAt(t=f++))===i)y=!0;else if(u===l)y=!0,e.charCodeAt(f)===i&&++f;else if(u!==r)continue;return e.slice(d,t)}return p=!0,e.slice(d,s)}for(e.charCodeAt(s-1)===i&&--s,e.charCodeAt(s-1)===l&&--s;(u=v())!==a;){for(var g=[];u!==n&&u!==a;)g.push(u),u=v();t&&null==(g=t(g,c++))||d.push(g)}return d}function c(t,r){return t.map((function(t){return r.map((function(e){return y(t[e])})).join(e)}))}function p(t){return t.map(y).join(e)}function y(e){return null==e?"":e instanceof Date?(a=(r=e).getUTCHours(),o=r.getUTCMinutes(),i=r.getUTCSeconds(),l=r.getUTCMilliseconds(),isNaN(r)?"Invalid Date":((n=r.getUTCFullYear())<0?"-"+s(-n,6):n>9999?"+"+s(n,6):s(n,4))+"-"+s(r.getUTCMonth()+1,2)+"-"+s(r.getUTCDate(),2)+(l?"T"+s(a,2)+":"+s(o,2)+":"+s(i,2)+"."+s(l,3)+"Z":i?"T"+s(a,2)+":"+s(o,2)+":"+s(i,2)+"Z":o||a?"T"+s(a,2)+":"+s(o,2)+"Z":"")):t.test(e+="")?'"'+e.replace(/"/g,'""')+'"':e;var r,n,a,o,i,l}return{parse:function(e,t){var r,n,a=f(e,(function(e,a){if(r)return r(e,a-1);n=e,r=t?function(e,t){var r=u(e);return function(n,a){return t(r(n),a,e)}}(e,t):u(e)}));return a.columns=n||[],a},parseRows:f,format:function(t,r){return null==r&&(r=d(t)),[r.map(y).join(e)].concat(c(t,r)).join("\n")},formatBody:function(e,t){return null==t&&(t=d(e)),c(e,t).join("\n")},formatRows:function(e){return e.map(p).join("\n")},formatRow:p,formatValue:y}}},62085:(e,t,r)=>{"use strict";r.r(t),r.d(t,{autoType:()=>p,csvFormat:()=>a.e2,csvFormatBody:()=>a.Un,csvFormatRow:()=>a.oz,csvFormatRows:()=>a.hG,csvFormatValue:()=>a.zB,csvParse:()=>a.sw,csvParseRows:()=>a.fy,dsvFormat:()=>n.A,tsvFormat:()=>u,tsvFormatBody:()=>d,tsvFormatRow:()=>f,tsvFormatRows:()=>s,tsvFormatValue:()=>c,tsvParse:()=>i,tsvParseRows:()=>l});var n=r(28996),a=r(7541),o=(0,n.A)("\t"),i=o.parse,l=o.parseRows,u=o.format,d=o.formatBody,s=o.formatRows,f=o.formatRow,c=o.formatValue;function p(e){for(var t in e){var r,n,a=e[t].trim();if(a)if("true"===a)a=!0;else if("false"===a)a=!1;else if("NaN"===a)a=NaN;else if(isNaN(r=+a)){if(!(n=a.match(/^([-+]\d{2})?\d{4}(-\d{2}(-\d{2})?)?(T\d{2}:\d{2}(:\d{2}(\.\d{3})?)?(Z|[-+]\d{2}:\d{2})?)?$/)))continue;y&&n[4]&&!n[7]&&(a=a.replace(/-/g,"/").replace(/T/," ")),a=new Date(a)}else a=r;else a=null;e[t]=a}return e}const y=new Date("2019-01-01T00:00").getHours()||new Date("2019-07-01T00:00").getHours()},69323:(e,t,r)=>{"use strict";r.r(t),r.d(t,{csv:()=>O,html:()=>c,json:()=>p,request:()=>s,text:()=>y,tsv:()=>F,xml:()=>v});var n=r(15926),a={value:function(){}};function o(){for(var e,t=0,r=arguments.length,n={};t<r;++t){if(!(e=arguments[t]+"")||e in n||/[\s.]/.test(e))throw new Error("illegal type: "+e);n[e]=[]}return new i(n)}function i(e){this._=e}function l(e,t){for(var r,n=0,a=e.length;n<a;++n)if((r=e[n]).name===t)return r.value}function u(e,t,r){for(var n=0,o=e.length;n<o;++n)if(e[n].name===t){e[n]=a,e=e.slice(0,n).concat(e.slice(n+1));break}return null!=r&&e.push({name:t,value:r}),e}i.prototype=o.prototype={constructor:i,on:function(e,t){var r,n,a=this._,o=(n=a,(e+"").trim().split(/^|\s+/).map((function(e){var t="",r=e.indexOf(".");if(r>=0&&(t=e.slice(r+1),e=e.slice(0,r)),e&&!n.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:t}}))),i=-1,d=o.length;if(!(arguments.length<2)){if(null!=t&&"function"!=typeof t)throw new Error("invalid callback: "+t);for(;++i<d;)if(r=(e=o[i]).type)a[r]=u(a[r],e.name,t);else if(null==t)for(r in a)a[r]=u(a[r],e.name,null);return this}for(;++i<d;)if((r=(e=o[i]).type)&&(r=l(a[r],e.name)))return r},copy:function(){var e={},t=this._;for(var r in t)e[r]=t[r].slice();return new i(e)},call:function(e,t){if((r=arguments.length-2)>0)for(var r,n,a=new Array(r),o=0;o<r;++o)a[o]=arguments[o+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(o=0,r=(n=this._[e]).length;o<r;++o)n[o].value.apply(t,a)},apply:function(e,t,r){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var n=this._[e],a=0,o=n.length;a<o;++a)n[a].value.apply(t,r)}};const d=o;function s(e,t){var r,a,o,i,l=d("beforesend","progress","load","error"),u=(0,n.Tj)(),s=new XMLHttpRequest,f=null,c=null,p=0;function y(e){var t,n=s.status;if(!n&&function(e){var t=e.responseType;return t&&"text"!==t?e.response:e.responseText}(s)||n>=200&&n<300||304===n){if(o)try{t=o.call(r,s)}catch(e){return void l.call("error",r,e)}else t=s;l.call("load",r,t)}else l.call("error",r,e)}if("undefined"!=typeof XDomainRequest&&!("withCredentials"in s)&&/^(http(s)?:)?\/\//.test(e)&&(s=new XDomainRequest),"onload"in s?s.onload=s.onerror=s.ontimeout=y:s.onreadystatechange=function(e){s.readyState>3&&y(e)},s.onprogress=function(e){l.call("progress",r,e)},r={header:function(e,t){return e=(e+"").toLowerCase(),arguments.length<2?u.get(e):(null==t?u.remove(e):u.set(e,t+""),r)},mimeType:function(e){return arguments.length?(a=null==e?null:e+"",r):a},responseType:function(e){return arguments.length?(i=e,r):i},timeout:function(e){return arguments.length?(p=+e,r):p},user:function(e){return arguments.length<1?f:(f=null==e?null:e+"",r)},password:function(e){return arguments.length<1?c:(c=null==e?null:e+"",r)},response:function(e){return o=e,r},get:function(e,t){return r.send("GET",e,t)},post:function(e,t){return r.send("POST",e,t)},send:function(t,n,o){return s.open(t,e,!0,f,c),null==a||u.has("accept")||u.set("accept",a+",*/*"),s.setRequestHeader&&u.each((function(e,t){s.setRequestHeader(t,e)})),null!=a&&s.overrideMimeType&&s.overrideMimeType(a),null!=i&&(s.responseType=i),p>0&&(s.timeout=p),null==o&&"function"==typeof n&&(o=n,n=null),null!=o&&1===o.length&&(o=function(e){return function(t,r){e(null==t?r:null)}}(o)),null!=o&&r.on("error",o).on("load",(function(e){o(null,e)})),l.call("beforesend",r,s),s.send(null==n?null:n),r},abort:function(){return s.abort(),r},on:function(){var e=l.on.apply(l,arguments);return e===l?r:e}},null!=t){if("function"!=typeof t)throw new Error("invalid callback: "+t);return r.get(t)}return r}function f(e,t){return function(r,n){var a=s(r).mimeType(e).response(t);if(null!=n){if("function"!=typeof n)throw new Error("invalid callback: "+n);return a.get(n)}return a}}const c=f("text/html",(function(e){return document.createRange().createContextualFragment(e.responseText)})),p=f("application/json",(function(e){return JSON.parse(e.responseText)})),y=f("text/plain",(function(e){return e.responseText})),v=f("application/xml",(function(e){var t=e.responseXML;if(!t)throw new Error("parse error");return t}));var g={},m={};function A(e){return new Function("d","return {"+e.map((function(e,t){return JSON.stringify(e)+": d["+t+'] || ""'})).join(",")+"}")}function _(e){var t=Object.create(null),r=[];return e.forEach((function(e){for(var n in e)n in t||r.push(t[n]=n)})),r}function T(e,t){var r=e+"",n=r.length;return n<t?new Array(t-n+1).join(0)+r:r}function h(e){var t=new RegExp('["'+e+"\n\r]"),r=e.charCodeAt(0);function n(e,t){var n,a=[],o=e.length,i=0,l=0,u=o<=0,d=!1;function s(){if(u)return m;if(d)return d=!1,g;var t,n,a=i;if(34===e.charCodeAt(a)){for(;i++<o&&34!==e.charCodeAt(i)||34===e.charCodeAt(++i););return(t=i)>=o?u=!0:10===(n=e.charCodeAt(i++))?d=!0:13===n&&(d=!0,10===e.charCodeAt(i)&&++i),e.slice(a+1,t-1).replace(/""/g,'"')}for(;i<o;){if(10===(n=e.charCodeAt(t=i++)))d=!0;else if(13===n)d=!0,10===e.charCodeAt(i)&&++i;else if(n!==r)continue;return e.slice(a,t)}return u=!0,e.slice(a,o)}for(10===e.charCodeAt(o-1)&&--o,13===e.charCodeAt(o-1)&&--o;(n=s())!==m;){for(var f=[];n!==g&&n!==m;)f.push(n),n=s();t&&null==(f=t(f,l++))||a.push(f)}return a}function a(t,r){return t.map((function(t){return r.map((function(e){return i(t[e])})).join(e)}))}function o(t){return t.map(i).join(e)}function i(e){return null==e?"":e instanceof Date?(a=(r=e).getUTCHours(),o=r.getUTCMinutes(),i=r.getUTCSeconds(),l=r.getUTCMilliseconds(),isNaN(r)?"Invalid Date":((n=r.getUTCFullYear())<0?"-"+T(-n,6):n>9999?"+"+T(n,6):T(n,4))+"-"+T(r.getUTCMonth()+1,2)+"-"+T(r.getUTCDate(),2)+(l?"T"+T(a,2)+":"+T(o,2)+":"+T(i,2)+"."+T(l,3)+"Z":i?"T"+T(a,2)+":"+T(o,2)+":"+T(i,2)+"Z":o||a?"T"+T(a,2)+":"+T(o,2)+"Z":"")):t.test(e+="")?'"'+e.replace(/"/g,'""')+'"':e;var r,n,a,o,i,l}return{parse:function(e,t){var r,a,o=n(e,(function(e,n){if(r)return r(e,n-1);a=e,r=t?function(e,t){var r=A(e);return function(n,a){return t(r(n),a,e)}}(e,t):A(e)}));return o.columns=a||[],o},parseRows:n,format:function(t,r){return null==r&&(r=_(t)),[r.map(i).join(e)].concat(a(t,r)).join("\n")},formatBody:function(e,t){return null==t&&(t=_(e)),a(e,t).join("\n")},formatRows:function(e){return e.map(o).join("\n")},formatRow:o,formatValue:i}}var P=h(","),b=P.parse;function S(e,t){return function(r,n,a){arguments.length<3&&(a=n,n=null);var o=s(r).mimeType(e);return o.row=function(e){return arguments.length?o.response(function(e,t){return function(r){return e(r.responseText,t)}}(t,n=e)):n},o.row(n),a?o.get(a):o}}P.parseRows,P.format,P.formatBody,P.formatRows,P.formatRow,P.formatValue;const O=S("text/csv",b);var E=h("\t"),x=E.parse;E.parseRows,E.format,E.formatBody,E.formatRows,E.formatRow,E.formatValue;const F=S("text/tab-separated-values",x)},14744:e=>{"use strict";var t=function(e){return function(e){return!!e&&"object"==typeof e}(e)&&!function(e){var t=Object.prototype.toString.call(e);return"[object RegExp]"===t||"[object Date]"===t||function(e){return e.$$typeof===r}(e)}(e)},r="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function n(e,t){return!1!==t.clone&&t.isMergeableObject(e)?l((r=e,Array.isArray(r)?[]:{}),e,t):e;var r}function a(e,t,r){return e.concat(t).map((function(e){return n(e,r)}))}function o(e){return Object.keys(e).concat(function(e){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter((function(t){return Object.propertyIsEnumerable.call(e,t)})):[]}(e))}function i(e,t){try{return t in e}catch(e){return!1}}function l(e,r,u){(u=u||{}).arrayMerge=u.arrayMerge||a,u.isMergeableObject=u.isMergeableObject||t,u.cloneUnlessOtherwiseSpecified=n;var d=Array.isArray(r);return d===Array.isArray(e)?d?u.arrayMerge(e,r,u):function(e,t,r){var a={};return r.isMergeableObject(e)&&o(e).forEach((function(t){a[t]=n(e[t],r)})),o(t).forEach((function(o){(function(e,t){return i(e,t)&&!(Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t))})(e,o)||(i(e,o)&&r.isMergeableObject(t[o])?a[o]=function(e,t){if(!t.customMerge)return l;var r=t.customMerge(e);return"function"==typeof r?r:l}(o,r)(e[o],t[o],r):a[o]=n(t[o],r))})),a}(e,r,u):n(r,u)}l.all=function(e,t){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce((function(e,r){return l(e,r,t)}),{})};var u=l;e.exports=u},42622:(e,t,r)=>{var n=1/0,a=9007199254740991,o="[object Arguments]",i="[object Function]",l="[object GeneratorFunction]",u="object"==typeof r.g&&r.g&&r.g.Object===Object&&r.g,d="object"==typeof self&&self&&self.Object===Object&&self,s=u||d||Function("return this")();function f(e,t){for(var r=-1,n=t.length,a=e.length;++r<n;)e[a+r]=t[r];return e}var c=Object.prototype,p=c.hasOwnProperty,y=c.toString,v=s.Symbol,g=c.propertyIsEnumerable,m=v?v.isConcatSpreadable:void 0;function A(e,t,r,n,a){var o=-1,i=e.length;for(r||(r=_),a||(a=[]);++o<i;){var l=e[o];t>0&&r(l)?t>1?A(l,t-1,r,n,a):f(a,l):n||(a[a.length]=l)}return a}function _(e){return T(e)||function(e){return function(e){return function(e){return!!e&&"object"==typeof e}(e)&&function(e){return null!=e&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=a}(e.length)&&!function(e){var t=function(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}(e)?y.call(e):"";return t==i||t==l}(e)}(e)}(e)&&p.call(e,"callee")&&(!g.call(e,"callee")||y.call(e)==o)}(e)||!!(m&&e&&e[m])}var T=Array.isArray;e.exports=function(e){return e&&e.length?A(e,n):[]}},18039:(e,t,r)=>{var n=200,a="__lodash_hash_undefined__",o=9007199254740991,i="[object Function]",l="[object GeneratorFunction]",u=/^\[object .+?Constructor\]$/,d="object"==typeof r.g&&r.g&&r.g.Object===Object&&r.g,s="object"==typeof self&&self&&self.Object===Object&&self,f=d||s||Function("return this")();function c(e,t){return!(!e||!e.length)&&function(e,t){if(t!=t)return function(e,t){for(var r=e.length,n=-1;++n<r;)if(t(e[n],n,e))return n;return-1}(e,v);for(var r=-1,n=e.length;++r<n;)if(e[r]===t)return r;return-1}(e,t)>-1}function p(e,t,r){for(var n=-1,a=e?e.length:0;++n<a;)if(r(t,e[n]))return!0;return!1}function y(e,t){for(var r=-1,n=t.length,a=e.length;++r<n;)e[a+r]=t[r];return e}function v(e){return e!=e}function g(e,t){return e.has(t)}function m(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r}var A,_=Array.prototype,T=Function.prototype,h=Object.prototype,P=f["__core-js_shared__"],b=(A=/[^.]+$/.exec(P&&P.keys&&P.keys.IE_PROTO||""))?"Symbol(src)_1."+A:"",S=T.toString,O=h.hasOwnProperty,E=h.toString,x=RegExp("^"+S.call(O).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),F=_.splice,L=Math.max,I=X(f,"Map"),C=X(f,"Set"),U=X(Object,"create");function M(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function w(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function D(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function N(e){var t=-1,r=e?e.length:0;for(this.__data__=new D;++t<r;)this.add(e[t])}function j(e,t){for(var r,n,a=e.length;a--;)if((r=e[a][0])===(n=t)||r!=r&&n!=n)return a;return-1}function R(e,t,r,a){var o,i=-1,l=c,u=!0,d=e.length,s=[],f=t.length;if(!d)return s;r&&(t=function(e,t){for(var r=-1,n=e?e.length:0,a=Array(n);++r<n;)a[r]=t(e[r],r,e);return a}(t,(o=r,function(e){return o(e)}))),a?(l=p,u=!1):t.length>=n&&(l=g,u=!1,t=new N(t));e:for(;++i<d;){var y=e[i],v=r?r(y):y;if(y=a||0!==y?y:0,u&&v==v){for(var m=f;m--;)if(t[m]===v)continue e;s.push(y)}else l(t,v,a)||s.push(y)}return s}M.prototype.clear=function(){this.__data__=U?U(null):{}},M.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},M.prototype.get=function(e){var t=this.__data__;if(U){var r=t[e];return r===a?void 0:r}return O.call(t,e)?t[e]:void 0},M.prototype.has=function(e){var t=this.__data__;return U?void 0!==t[e]:O.call(t,e)},M.prototype.set=function(e,t){return this.__data__[e]=U&&void 0===t?a:t,this},w.prototype.clear=function(){this.__data__=[]},w.prototype.delete=function(e){var t=this.__data__,r=j(t,e);return!(r<0||(r==t.length-1?t.pop():F.call(t,r,1),0))},w.prototype.get=function(e){var t=this.__data__,r=j(t,e);return r<0?void 0:t[r][1]},w.prototype.has=function(e){return j(this.__data__,e)>-1},w.prototype.set=function(e,t){var r=this.__data__,n=j(r,e);return n<0?r.push([e,t]):r[n][1]=t,this},D.prototype.clear=function(){this.__data__={hash:new M,map:new(I||w),string:new M}},D.prototype.delete=function(e){return Y(this,e).delete(e)},D.prototype.get=function(e){return Y(this,e).get(e)},D.prototype.has=function(e){return Y(this,e).has(e)},D.prototype.set=function(e,t){return Y(this,e).set(e,t),this},N.prototype.add=N.prototype.push=function(e){return this.__data__.set(e,a),this},N.prototype.has=function(e){return this.__data__.has(e)};var k=C&&1/m(new C([,-0]))[1]==1/0?function(e){return new C(e)}:function(){};function Y(e,t){var r,n,a=e.__data__;return("string"==(n=typeof(r=t))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?a["string"==typeof t?"string":"hash"]:a.map}function X(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return function(e){if(!W(e)||b&&b in e)return!1;var t=z(e)||function(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}(e)?x:u;return t.test(function(e){if(null!=e){try{return S.call(e)}catch(e){}try{return e+""}catch(e){}}return""}(e))}(r)?r:void 0}var Q,B,G=(Q=function(e){return function(e,t,r){for(var a=-1,o=e.length;++a<o;)var i=i?y(R(i,e[a],t,r),R(e[a],i,t,r)):e[a];return i&&i.length?function(e,t,r){var a=-1,o=c,i=e.length,l=!0,u=[],d=u;if(r)l=!1,o=p;else if(i>=n){var s=t?null:k(e);if(s)return m(s);l=!1,o=g,d=new N}else d=t?[]:u;e:for(;++a<i;){var f=e[a],y=t?t(f):f;if(f=r||0!==f?f:0,l&&y==y){for(var v=d.length;v--;)if(d[v]===y)continue e;t&&d.push(y),u.push(f)}else o(d,y,r)||(d!==u&&d.push(y),u.push(f))}return u}(i,t,r):[]}(function(e,t){for(var r=-1,n=e?e.length:0,a=0,o=[];++r<n;){var i=e[r];t(i,r,e)&&(o[a++]=i)}return o}(e,V))},B=L(void 0===B?Q.length-1:B,0),function(){for(var e=arguments,t=-1,r=L(e.length-B,0),n=Array(r);++t<r;)n[t]=e[B+t];t=-1;for(var a=Array(B+1);++t<B;)a[t]=e[t];return a[B]=n,function(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}(Q,this,a)});function V(e){return function(e){return!!e&&"object"==typeof e}(e)&&function(e){return null!=e&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=o}(e.length)&&!z(e)}(e)}function z(e){var t=W(e)?E.call(e):"";return t==i||t==l}function W(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}e.exports=G},95087:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t._run=function(e,t,r,n,a){if("function"!=typeof e.run)throw new Error("Attempted to run something that is not a task.");return e.run(t,r,n,a)},t.fromPromise=function(e,t){var r=function(r){return n((function(t,n){return e(r).then(t,n)}),r,t)};return r.type=t,r},t.fromPromiseWithProgress=function(e,t){var a=function(a){var o=a.arg,i=a.onProgress;return n((function(t,n,a){return e({arg:o,onProgress:(a?function(e){return a.onProgress(i(e))}:r)||r}).then(t,n)}),{arg:o,onProgress:i},t)};return a.type=t,a},t.fromCallback=function(e,t){var r=function(r){return n((function(t,n){return e(r,(function(e,r){return e?n(e):t(r)}))}),r,t)};return r.type=t,r},t.taskCreator_=n,t.reportTasksForTesting=function(e){o=e},t.all=function(e){return a(e.map((function(e){return e.payload})),(function(t,r,n,a){if(0===e.length)return r([]);var o=Array(e.length),i=0,l=null;function u(e){if(e)return n(l=e)}return Promise.all(e.map((function(n,d){return n.run(t,function(t){return function(n){if(!l)return o[t]=n,(i+=1)===e.length?r(o):void 0}}(d),u,a)})))}),"Task.all("+e.map((function(e){return e.type})).join(", ")+")")},t.allSettled=function(e){return a(e.map((function(e){return e.payload})),(function(t,r,n,a){if(0===e.length)return r([]);var o=Array(e.length),i=0;function l(t,n){return function(a){if(o[t]={status:n,value:a},(i+=1)===e.length)return r(o)}}return Promise.allSettled(e.map((function(e,r){return e.run(t,l(r,"fulfilled"),l(r,"rejected"),a)})))}),"Task.allSettled("+e.map((function(e){return e.type})).join(", ")+")")};var r=function(){};function n(e,t,r){var n=function(r,n,a){return o("start",i,t),e((function(e){return o("success",i,e),r(e)}),(function(e){return o("error",i,e),n(e)}),a)};n.payload=t,n.type=r;var i=a(t,(function(e,t,r,a){return e(n,t,r,a)}),r);return i}function a(e,t,r){return{label:r,type:r,payload:e,run:t,chain:function(n){return a(e,(function(e,r,a,o){return t(e,(function(t){return n(t).run(e,r,a,o)}),a,o)}),"Chain(".concat(r,")"))},map:function(n){return a(e,(function(e,r,a,o){return t(e,(function(e){return r(n(e))}),a,o)}),r)},bimap:function(n,o){return a(e,(function(e,r,a,i){return t(e,(function(e){return r(n(e))}),(function(e){return a(o(e))}),i)}),r)}}}var o=function(e,t,r){}},60495:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getGlobalTaskQueue=function(){return a[n].tasks},t.updateGlobalTaskQueue=function(e){a[n].tasks=e},t.getLastWithTaskCall=function(){return a[n].lastWithTaskCall},t.setLastWithTaskCall=function(e){a[n].lastWithTaskCall=e},t.clearLastWithTaskCall=function(){a[n].lastWithTaskCall=null};var n="___GLOBAL_TASK_STATE_e3b0c442",a="undefined"!=typeof window?window:void 0!==r.g?r.g:{};void 0!==a[n]?console.warn("More than one copy of react-palm was loaded. This may cause problems."):Object.defineProperty(a,n,{ennumerable:!1,value:{tasks:[],lastWithTaskCall:null}})},13370:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={reportTasksForTesting:!0,taskCreator:!0,taskMiddleware:!0,withTask:!0,withTasks:!0,disableStackCapturing:!0,getGlobalTaskQueue:!0};Object.defineProperty(t,"reportTasksForTesting",{enumerable:!0,get:function(){return a.reportTasksForTesting}}),Object.defineProperty(t,"taskCreator",{enumerable:!0,get:function(){return o.taskCreator}}),Object.defineProperty(t,"taskMiddleware",{enumerable:!0,get:function(){return i.taskMiddleware}}),Object.defineProperty(t,"withTask",{enumerable:!0,get:function(){return i.withTask}}),Object.defineProperty(t,"withTasks",{enumerable:!0,get:function(){return i.withTasks}}),Object.defineProperty(t,"disableStackCapturing",{enumerable:!0,get:function(){return i.disableStackCapturing}}),Object.defineProperty(t,"getGlobalTaskQueue",{enumerable:!0,get:function(){return l.getGlobalTaskQueue}}),t.default=void 0;var a=r(95087),o=r(8603),i=r(1916),l=r(60495),u=r(18944);Object.keys(u).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(n,e)||Object.defineProperty(t,e,{enumerable:!0,get:function(){return u[e]}}))}));var d={all:a.all,allSettled:a.allSettled,fromCallback:a.fromCallback,fromPromise:a.fromPromise,fromPromiseWithProgress:a.fromPromiseWithProgress};t.default=d},8603:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.taskCreator=function(e,t){var r=function(r){return(0,n.taskCreator_)((function(t,n){return e(r,t,n)}),r,t)};return r.type=t,r};var n=r(95087)},1916:(e,t,r)=>{"use strict";e=r.nmd(e),Object.defineProperty(t,"__esModule",{value:!0}),t.withTasks=d,t.disableStackCapturing=function(){i=!1},t.withTask=t.taskMiddleware=void 0;var n=r(95087),a=r(60495),o=Promise.resolve(),i=!Boolean(e.hot),l="Tasks should not be added outside of reducers.";t.taskMiddleware=function(e){return function(t){return function(r){if(i&&(0,a.getGlobalTaskQueue)().length>0){var l=(0,a.getLastWithTaskCall)();throw(0,a.clearLastWithTaskCall)(),l}t(r);var d=function(e){return function(t){return o.then((function(){return e(t)}))}}(e.dispatch);if((0,a.getGlobalTaskQueue)().length>0){var s=(0,a.getGlobalTaskQueue)().map(function(e){return function(t){return(0,n._run)(t,u,e,e,{onProgress:e})}}(d));return(0,a.updateGlobalTaskQueue)([]),(0,a.clearLastWithTaskCall)(),Promise.all(s)}return o}}};var u=function(e,t,r,n){return e(t,r,n)};function d(e,t){return i&&!(0,a.getLastWithTaskCall)()&&(0,a.setLastWithTaskCall)(function(e){try{throw new Error(e)}catch(e){return e}}(l)),(0,a.updateGlobalTaskQueue)((0,a.getGlobalTaskQueue)().concat(t instanceof Array?t:[t])),e}var s=d;t.withTask=s},18944:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.succeedTaskInTest=function(e,t){return o(e,(function(e,r,n){return r(t)}))},t.errorTaskInTest=function(e,t){return o(e,(function(e,r,n){return n(t)}))},t.simulateTask=function(e,t){return o(e,t)},t.succeedTaskWithValues=function(e,t){var r=0;return o(e,(function(e,n){if(r>=t.length)throw new Error("Not enough values were provided!");var a=n(t[r]);return r+=1,a}))},t.drainTasksForTesting=function(){var e=(0,a.getGlobalTaskQueue)();return(0,a.updateGlobalTaskQueue)([]),(0,a.clearLastWithTaskCall)(),e};var n=r(95087),a=r(60495);function o(e,t){var r,a=function(e){r=e};if((0,n._run)(e,t,a,a),void 0===r)throw new Error("A success or error handler was never called!");return r}}}]);