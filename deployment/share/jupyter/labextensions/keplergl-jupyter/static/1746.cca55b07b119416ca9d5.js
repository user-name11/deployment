"use strict";(self.webpackChunkkeplergl_jupyter=self.webpackChunkkeplergl_jupyter||[]).push([[1746],{91746:(e,t,r)=>{r.r(t),r.d(t,{FetchError:()=>_,JSONLoader:()=>qt,NullLoader:()=>Nt,NullWorkerLoader:()=>Ct,RequestScheduler:()=>$t,_BrowserFileSystem:()=>Mt,_fetchProgress:()=>zt,_unregisterLoaders:()=>xe,assert:()=>_e,concatenateArrayBuffersAsync:()=>Ye,document:()=>ae,encode:()=>Tt,encodeInBatches:()=>St,encodeSync:()=>_t,encodeTable:()=>yt,encodeTableAsText:()=>pt,encodeTableInBatches:()=>gt,encodeText:()=>At,encodeTextSync:()=>vt,encodeURLtoURL:()=>Et,fetchFile:()=>$,forEach:()=>Ve,getLoaderOptions:()=>ye,getPathPrefix:()=>i,global:()=>ie,isAsyncIterable:()=>y,isBrowser:()=>ce,isIterable:()=>h,isIterator:()=>p,isPromise:()=>d,isPureObject:()=>f,isReadableStream:()=>b,isResponse:()=>g,isWorker:()=>ue,isWritableStream:()=>T,load:()=>ft,loadInBatches:()=>dt,makeIterator:()=>tt,makeLineIterator:()=>Ht,makeNumberedLineIterator:()=>Gt,makeStream:()=>It,makeTextDecoderIterator:()=>Pt,makeTextEncoderIterator:()=>Dt,parse:()=>at,parseInBatches:()=>lt,parseSync:()=>ct,readArrayBuffer:()=>I,registerLoaders:()=>Ee,resolvePath:()=>a,selectLoader:()=>Oe,selectLoaderSync:()=>$e,self:()=>se,setLoaderOptions:()=>pe,setPathPrefix:()=>o,window:()=>oe});let n="";const s={};function o(e){n=e}function i(){return n}function a(e){for(const t in s)if(e.startsWith(t)){const r=s[t];e=e.replace(t,r)}return e.startsWith("http://")||e.startsWith("https://")||(e=`${n}${e}`),e}const c=e=>"boolean"==typeof e,u=e=>"function"==typeof e,l=e=>null!==e&&"object"==typeof e,f=e=>l(e)&&e.constructor==={}.constructor,d=e=>l(e)&&u(e.then),h=e=>Boolean(e)&&"function"==typeof e[Symbol.iterator],y=e=>e&&"function"==typeof e[Symbol.asyncIterator],p=e=>e&&u(e.next),g=e=>"undefined"!=typeof Response&&e instanceof Response||e&&e.arrayBuffer&&e.text&&e.json,m=e=>"undefined"!=typeof Blob&&e instanceof Blob,w=e=>e&&"object"==typeof e&&e.isBuffer,b=e=>(e=>"undefined"!=typeof ReadableStream&&e instanceof ReadableStream||l(e)&&u(e.tee)&&u(e.cancel)&&u(e.getReader))(e)||(e=>l(e)&&u(e.read)&&u(e.pipe)&&c(e.readable))(e),T=e=>(e=>l(e)&&u(e.abort)&&u(e.getWriter))(e)||(e=>l(e)&&u(e.end)&&u(e.write)&&c(e.writable))(e);class _ extends Error{constructor(e,t){super(e),this.reason=t.reason,this.url=t.url,this.response=t.response}reason;url;response}const A=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,v=/^([-\w.]+\/[-\w.+]+)/;function S(e,t){return e.toLowerCase()===t.toLowerCase()}function E(e){const t=A.exec(e);return t?t[1]:""}const x=/\?.*/;function B(e){return e.replace(x,"")}function L(e){return g(e)?e.url:m(e)?e.name||"":"string"==typeof e?e:""}function R(e){if(g(e)){const t=e,r=t.headers.get("content-type")||"",n=B(t.url);return function(e){const t=v.exec(e);return t?t[1]:e}(r)||E(n)}return m(e)?e.type||"":"string"==typeof e?E(e):""}async function k(e){if(g(e))return e;const t={},r=function(e){return g(e)?e.headers["content-length"]||-1:m(e)?e.size:"string"==typeof e?e.length:e instanceof ArrayBuffer||ArrayBuffer.isView(e)?e.byteLength:-1}(e);r>=0&&(t["content-length"]=String(r));const n=L(e),s=R(e);s&&(t["content-type"]=s);const o=await async function(e){if("string"==typeof e)return`data:,${e.slice(0,5)}`;if(e instanceof Blob){const t=e.slice(0,5);return await new Promise((e=>{const r=new FileReader;r.onload=t=>e(t?.target?.result),r.readAsDataURL(t)}))}return e instanceof ArrayBuffer?`data:base64,${function(e){let t="";const r=new Uint8Array(e);for(let e=0;e<r.byteLength;e++)t+=String.fromCharCode(r[e]);return btoa(t)}(e.slice(0,5))}`:null}(e);o&&(t["x-first-bytes"]=o),"string"==typeof e&&(e=(new TextEncoder).encode(e));const i=new Response(e,{headers:t});return Object.defineProperty(i,"url",{value:n}),i}async function O(e){if(!e.ok){const t=await async function(e){const t=function(e){if(e.length<50)return e;const t=e.slice(e.length-15);return`${e.substr(0,32)}...${t}`}(e.url);let r=`Failed to fetch resource (${e.status}) ${e.statusText}: ${t}`;r=r.length>100?`${r.slice(0,100)}...`:r;const n={reason:e.statusText,url:e.url,response:e};try{const t=e.headers.get("Content-Type");n.reason=t?.includes("application/json")?await e.json():e.text()}catch(e){}return new _(r,n)}(e);throw t}}async function $(e,t){if("string"==typeof e){const r=a(e);return function(e){return!function(e){return e.startsWith("http:")||e.startsWith("https:")}(e)&&!function(e){return e.startsWith("data:")}(e)}(r)&&globalThis.loaders?.fetchNode?globalThis.loaders?.fetchNode(r,t):await fetch(r,t)}return await k(e)}async function I(e,t,r){e instanceof Blob||(e=new Blob([e]));const n=e.slice(t,t+r);return await async function(e){return await new Promise(((t,r)=>{const n=new FileReader;n.onload=e=>t(e?.target?.result),n.onerror=e=>r(e),n.readAsArrayBuffer(e)}))}(n)}var j=r(65606),C=r(65606);function N(){return!("object"==typeof C&&"[object process]"===String(C)&&!C?.browser)||function(){if("undefined"!=typeof window&&"renderer"===window.process?.type)return!0;if(void 0!==j&&Boolean(j.versions?.electron))return!0;const e="undefined"!=typeof navigator&&navigator.userAgent;return Boolean(e&&e.indexOf("Electron")>=0)}()}const q="4.0.7";class F{constructor(e,t,r="sessionStorage"){this.storage=function(e){try{const t=window[e],r="__storage_test__";return t.setItem(r,r),t.removeItem(r),t}catch(e){return null}}(r),this.id=e,this.config=t,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const e=JSON.stringify(this.config);this.storage.setItem(this.id,e)}}_loadConfiguration(){let e={};if(this.storage){const t=this.storage.getItem(this.id);e=t?JSON.parse(t):{}}return Object.assign(this.config,e),this}}var z;!function(e){e[e.BLACK=30]="BLACK",e[e.RED=31]="RED",e[e.GREEN=32]="GREEN",e[e.YELLOW=33]="YELLOW",e[e.BLUE=34]="BLUE",e[e.MAGENTA=35]="MAGENTA",e[e.CYAN=36]="CYAN",e[e.WHITE=37]="WHITE",e[e.BRIGHT_BLACK=90]="BRIGHT_BLACK",e[e.BRIGHT_RED=91]="BRIGHT_RED",e[e.BRIGHT_GREEN=92]="BRIGHT_GREEN",e[e.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",e[e.BRIGHT_BLUE=94]="BRIGHT_BLUE",e[e.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",e[e.BRIGHT_CYAN=96]="BRIGHT_CYAN",e[e.BRIGHT_WHITE=97]="BRIGHT_WHITE"}(z||(z={}));function W(e){return"string"!=typeof e?e:(e=e.toUpperCase(),z[e]||z.WHITE)}function U(e,t){if(!e)throw new Error(t||"Assertion failed")}const M=globalThis,P=(globalThis.document,globalThis.process||{});function D(){let e;if(N()&&M.performance)e=M?.performance?.now?.();else if("hrtime"in P){const t=P?.hrtime?.();e=1e3*t[0]+t[1]/1e6}else e=Date.now();return e}globalThis.console,globalThis.navigator;const H={debug:N()&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},G={enabled:!0,level:0};function J(){}const V={},Y={once:!0};class Q{constructor({id:e}={id:""}){this.VERSION=q,this._startTs=D(),this._deltaTs=D(),this.userData={},this.LOG_THROTTLE_TIMEOUT=0,this.id=e,this.userData={},this._storage=new F(`__probe-${this.id}__`,G),this.timeStamp(`${this.id} started`),function(e,t=["constructor"]){const r=Object.getPrototypeOf(e),n=Object.getOwnPropertyNames(r),s=e;for(const r of n){const n=s[r];"function"==typeof n&&(t.find((e=>r===e))||(s[r]=n.bind(e)))}}(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((D()-this._startTs).toPrecision(10))}getDelta(){return Number((D()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(e=!0){return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,t){this._storage.setConfiguration({[e]:t})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,t){if(!e)throw new Error(t||"Assertion failed")}warn(e){return this._getLogFunction(0,e,H.warn,arguments,Y)}error(e){return this._getLogFunction(0,e,H.error,arguments)}deprecated(e,t){return this.warn(`\`${e}\` is deprecated and will be removed in a later version. Use \`${t}\` instead`)}removed(e,t){return this.error(`\`${e}\` has been removed. Use \`${t}\` instead`)}probe(e,t){return this._getLogFunction(e,t,H.log,arguments,{time:!0,once:!0})}log(e,t){return this._getLogFunction(e,t,H.debug,arguments)}info(e,t){return this._getLogFunction(e,t,console.info,arguments)}once(e,t){return this._getLogFunction(e,t,H.debug||H.info,arguments,Y)}table(e,t,r){return t?this._getLogFunction(e,t,console.table||J,r&&[r],{tag:Z(t)}):J}time(e,t){return this._getLogFunction(e,t,console.time?console.time:console.info)}timeEnd(e,t){return this._getLogFunction(e,t,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,t){return this._getLogFunction(e,t,console.timeStamp||J)}group(e,t,r={collapsed:!1}){const n=X({logLevel:e,message:t,opts:r}),{collapsed:s}=r;return n.method=(s?console.groupCollapsed:console.group)||console.info,this._getLogFunction(n)}groupCollapsed(e,t,r={}){return this.group(e,t,Object.assign({},r,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||J)}withGroup(e,t,r){this.group(e,t)();try{r()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=K(e)}_getLogFunction(e,t,r,n,s){if(this._shouldLog(e)){s=X({logLevel:e,message:t,args:n,opts:s}),U(r=r||s.method),s.total=this.getTotal(),s.delta=this.getDelta(),this._deltaTs=D();const o=s.tag||s.message;if(s.once&&o){if(V[o])return J;V[o]=D()}return t=function(e,t,r){if("string"==typeof t){const i=r.time?function(e,t=8){const r=Math.max(t-e.length,0);return`${" ".repeat(r)}${e}`}(function(e){let t;return t=e<10?`${e.toFixed(2)}ms`:e<100?`${e.toFixed(1)}ms`:e<1e3?`${e.toFixed(0)}ms`:`${(e/1e3).toFixed(2)}s`,t}(r.total)):"";n=t=r.time?`${e}: ${i}  ${t}`:`${e}: ${t}`,s=r.color,o=r.background,N||"string"!=typeof n||(s&&(n=`[${W(s)}m${n}[39m`),o&&(n=`[${W(o)+10}m${n}[49m`)),t=n}var n,s,o;return t}(this.id,s.message,s),r.bind(console,t,...s.args)}return J}}function K(e){if(!e)return 0;let t;switch(typeof e){case"number":t=e;break;case"object":t=e.logLevel||e.priority||0;break;default:return 0}return U(Number.isFinite(t)&&t>=0),t}function X(e){const{logLevel:t,message:r}=e;e.logLevel=K(t);const n=e.args?Array.from(e.args):[];for(;n.length&&n.shift()!==r;);switch(typeof t){case"string":case"function":void 0!==r&&n.unshift(r),e.message=t;break;case"object":Object.assign(e,t)}"function"==typeof e.message&&(e.message=e.message());const s=typeof e.message;return U("string"===s||"object"===s),Object.assign(e,{args:n},e.opts)}function Z(e){for(const t in e)for(const r in e[t])return r||"untitled";return"empty"}Q.VERSION=q;const ee=new Q({id:"loaders.gl"});class te{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}var re=r(65606);const ne={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:void 0!==r.g&&r.g,document:"undefined"!=typeof document&&document},se=ne.self||ne.window||ne.global||{},oe=ne.window||ne.self||ne.global||{},ie=ne.global||ne.self||ne.window||{},ae=ne.document||{},ce=Boolean("object"!=typeof re||"[object process]"!==String(re)||re.browser),ue="function"==typeof importScripts,le=void 0!==re&&re.version&&/v([0-9]*)/.exec(re.version),fe=(le&&parseFloat(le[1]),{fetch:null,mimeType:void 0,nothrow:!1,log:new class{console;constructor(){this.console=console}log(...e){return this.console.log.bind(this.console,...e)}info(...e){return this.console.info.bind(this.console,...e)}warn(...e){return this.console.warn.bind(this.console,...e)}error(...e){return this.console.error.bind(this.console,...e)}},useLocalLibraries:!1,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:ce,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]}),de={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function he(){globalThis.loaders=globalThis.loaders||{};const{loaders:e}=globalThis;return e._state||(e._state={}),e._state}function ye(){const e=he();return e.globalOptions=e.globalOptions||{...fe},e.globalOptions}function pe(e){const t=he(),r=ye();var n;t.globalOptions=be(r,e),n=e.modules,globalThis.loaders||={},globalThis.loaders.modules||={},Object.assign(globalThis.loaders.modules,n)}function ge(e,t,r,n){return r=r||[],function(e,t){me(e,null,fe,de,t);for(const r of t){const n=e&&e[r.id]||{},s=r.options&&r.options[r.id]||{},o=r.deprecatedOptions&&r.deprecatedOptions[r.id]||{};me(n,r.id,s,o,t)}}(e,r=Array.isArray(r)?r:[r]),be(t,e,n)}function me(e,t,r,n,s){const o=t||"Top level",i=t?`${t}.`:"";for(const a in e){const c=!t&&l(e[a]);if(!(a in r)&&("baseUri"!==a||t)&&("workerUrl"!==a||!t))if(a in n)ee.warn(`${o} loader option '${i}${a}' no longer supported, use '${n[a]}'`)();else if(!c){const e=we(a,s);ee.warn(`${o} loader option '${i}${a}' not recognized. ${e}`)()}}}function we(e,t){const r=e.toLowerCase();let n="";for(const s of t)for(const t in s.options){if(e===t)return`Did you mean '${s.id}.${t}'?`;const o=t.toLowerCase();(r.startsWith(o)||o.startsWith(r))&&(n=n||`Did you mean '${s.id}.${t}'?`)}return n}function be(e,t,r){const n={...e.options||{}};return function(e,t){t&&!("baseUri"in e)&&(e.baseUri=t)}(n,r),null===n.log&&(n.log=new te),Te(n,ye()),Te(n,t),n}function Te(e,t){for(const r in t)if(r in t){const n=t[r];f(n)&&f(e[r])?e[r]={...e[r],...t[r]}:e[r]=t[r]}}function _e(e,t){if(!e)throw new Error(t||"loader assertion failed.")}function Ae(e){return!!e&&(Array.isArray(e)&&(e=e[0]),Array.isArray(e?.extensions))}function ve(e){let t;return _e(e,"null loader"),_e(Ae(e),"invalid loader"),Array.isArray(e)&&(t=e[1],e=e[0],e={...e,options:{...e.options,...t}}),(e?.parseTextSync||e?.parseText)&&(e.text=!0),e.text||(e.binary=!0),e}const Se=()=>{const e=he();return e.loaderRegistry=e.loaderRegistry||[],e.loaderRegistry};function Ee(e){const t=Se();e=Array.isArray(e)?e:[e];for(const r of e){const e=ve(r);t.find((t=>e===t))||t.unshift(e)}}function xe(){he().loaderRegistry=[]}function Be(e){const t=e?e.lastIndexOf("/"):-1;return t>=0?e.substr(t+1):""}function Le(...e){return function(e){const t=e.map((e=>e instanceof ArrayBuffer?new Uint8Array(e):e)),r=t.reduce(((e,t)=>e+t.byteLength),0),n=new Uint8Array(r);let s=0;for(const e of t)n.set(e,s),s+=e.byteLength;return n.buffer}(e)}const Re=new Q({id:"loaders.gl"}),ke=/\.([^.]+)$/;async function Oe(e,t=[],r,n){if(!Ie(e))return null;let s=$e(e,t,{...r,nothrow:!0},n);if(s)return s;if(m(e)&&(s=$e(e=await e.slice(0,10).arrayBuffer(),t,r,n)),!s&&!r?.nothrow)throw new Error(je(e));return s}function $e(e,t=[],r,n){if(!Ie(e))return null;if(t&&!Array.isArray(t))return ve(t);let s=[];t&&(s=s.concat(t)),r?.ignoreRegisteredLoaders||s.push(...Se()),function(e){for(const t of e)ve(t)}(s);const o=function(e,t,r,n){const s=L(e),o=R(e),i=B(s)||n?.url;let a=null,c="";return r?.mimeType&&(a=Ce(t,r?.mimeType),c=`match forced by supplied MIME type ${r?.mimeType}`),a=a||function(e,t){const r=t&&ke.exec(t),n=r&&r[1];return n?function(e,t){t=t.toLowerCase();for(const r of e)for(const e of r.extensions)if(e.toLowerCase()===t)return r;return null}(e,n):null}(t,i),c=c||(a?`matched url ${i}`:""),a=a||Ce(t,o),c=c||(a?`matched MIME type ${o}`:""),a=a||function(e,t){if(!t)return null;for(const r of e)if("string"==typeof t){if(Ne(t,r))return r}else if(ArrayBuffer.isView(t)){if(qe(t.buffer,t.byteOffset,r))return r}else if(t instanceof ArrayBuffer&&qe(t,0,r))return r;return null}(t,e),c=c||(a?`matched initial data ${Fe(e)}`:""),r?.fallbackMimeType&&(a=a||Ce(t,r?.fallbackMimeType),c=c||(a?`matched fallback MIME type ${o}`:"")),c&&Re.log(1,`selectLoader selected ${a?.name}: ${c}.`),a}(e,s,r,n);if(!o&&!r?.nothrow)throw new Error(je(e));return o}function Ie(e){return!(e instanceof Response&&204===e.status)}function je(e){const t=L(e),r=R(e);let n="No valid loader found (";n+=t?`${Be(t)}, `:"no url provided, ",n+=`MIME type: ${r?`"${r}"`:"not provided"}, `;const s=e?Fe(e):"";return n+=s?` first bytes: "${s}"`:"first bytes: not available",n+=")",n}function Ce(e,t){for(const r of e){if(r.mimeTypes?.some((e=>S(t,e))))return r;if(S(t,`application/x.${r.id}`))return r}return null}function Ne(e,t){return t.testText?t.testText(e):(Array.isArray(t.tests)?t.tests:[t.tests]).some((t=>e.startsWith(t)))}function qe(e,t,r){return(Array.isArray(r.tests)?r.tests:[r.tests]).some((r=>function(e,t,r,n){if(n instanceof ArrayBuffer)return function(e,t,r){if(r=r||e.byteLength,e.byteLength<r||t.byteLength<r)return!1;const n=new Uint8Array(e),s=new Uint8Array(t);for(let e=0;e<n.length;++e)if(n[e]!==s[e])return!1;return!0}(n,e,n.byteLength);switch(typeof n){case"function":return n(e);case"string":return n===ze(e,t,n.length);default:return!1}}(e,t,0,r)))}function Fe(e,t=5){return"string"==typeof e?e.slice(0,t):ArrayBuffer.isView(e)?ze(e.buffer,e.byteOffset,t):e instanceof ArrayBuffer?ze(e,0,t):""}function ze(e,t,r){if(e.byteLength<t+r)return"";const n=new DataView(e);let s="";for(let e=0;e<r;e++)s+=String.fromCharCode(n.getUint8(t+e));return s}var We=r(4654),Ue=r(53722),Me=r(66595);async function Pe(e,t,r,n,s){const o=e.id,i=(0,Me.q)(e,r),a=Ue.A.getWorkerFarm(r).getWorkerPool({name:o,url:i});r=JSON.parse(JSON.stringify(r)),n=JSON.parse(JSON.stringify(n||{}));const c=await a.startJob("process-on-worker",De.bind(null,s));c.postMessage("process",{input:t,options:r,context:n});const u=await c.result;return await u.result}async function De(e,t,r,n){switch(r){case"done":t.done(n);break;case"error":t.error(new Error(n.error));break;case"process":const{id:s,input:o,options:i}=n;try{const r=await e(o,i);t.postMessage("done",{id:s,result:r})}catch(e){const r=e instanceof Error?e.message:"unknown error";t.postMessage("error",{id:s,error:r})}break;default:console.warn(`parse-with-worker unknown message ${r}`)}}var He=r(47994);function Ge(e,t){return Je(e||{},t)}function Je(e,t,r=0){if(r>3)return t;const n={...e};for(const[e,s]of Object.entries(t))s&&"object"==typeof s&&!Array.isArray(s)?n[e]=Je(n[e]||{},t[e],r+1):n[e]=t[e];return n}async function Ve(e,t){for(;;){const{done:r,value:n}=await e.next();if(r)return void e.return();if(t(n))return}}async function Ye(e){const t=[];for await(const r of e)t.push(r);return Le(...t)}r(86306);const Qe=262144,Ke=262144,Xe=1048576;function Ze(e){if((t=e)&&"object"==typeof t&&t.isBuffer)return e;var t;if(e instanceof ArrayBuffer)return e;if(ArrayBuffer.isView(e))return 0===e.byteOffset&&e.byteLength===e.buffer.byteLength?e.buffer:e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength);if("string"==typeof e){const t=e;return(new TextEncoder).encode(t).buffer}if(e&&"object"==typeof e&&e._toArrayBuffer)return e._toArrayBuffer();throw new Error("toArrayBuffer")}function et(e,t){return ce?async function*(e,t){const r=e.getReader();let n;try{for(;;){const e=n||r.read();t?._streamReadAhead&&(n=r.read());const{done:s,value:o}=await e;if(s)return;yield Ze(o)}}catch(e){r.releaseLock()}}(e,t):async function*(e){for await(const t of e)yield Ze(t)}(e)}function tt(e,t){if("string"==typeof e)return function*(e,t){const r=t?.chunkSize||Qe;let n=0;const s=new TextEncoder;for(;n<e.length;){const t=Math.min(e.length-n,r),o=e.slice(n,n+t);n+=t,yield s.encode(o)}}(e,t);if(e instanceof ArrayBuffer)return function*(e,t={}){const{chunkSize:r=Ke}=t;let n=0;for(;n<e.byteLength;){const t=Math.min(e.byteLength-n,r),s=new ArrayBuffer(t),o=new Uint8Array(e,n,t);new Uint8Array(s).set(o),n+=t,yield s}}(e,t);if(m(e))return async function*(e,t){const r=t?.chunkSize||Xe;let n=0;for(;n<e.size;){const t=n+r,s=await e.slice(n,t).arrayBuffer();n=t,yield s}}(e,t);if(b(e))return et(e,t);if(g(e))return et(e.body,t);throw new Error("makeIterator")}const rt="Cannot convert supplied data type";function nt(e,t,r){if(t.text&&"string"==typeof e)return e;if(w(e)&&(e=e.buffer),e instanceof ArrayBuffer){const r=e;return t.text&&!t.binary?new TextDecoder("utf8").decode(r):r}if(ArrayBuffer.isView(e)){if(t.text&&!t.binary)return new TextDecoder("utf8").decode(e);let r=e.buffer;const n=e.byteLength||e.length;return 0===e.byteOffset&&n===r.byteLength||(r=r.slice(e.byteOffset,e.byteOffset+n)),r}throw new Error(rt)}function st(e,t){const r=ye(),n=e||r;return"function"==typeof n.fetch?n.fetch:l(n.fetch)?e=>$(e,n.fetch):t?.fetch?t?.fetch:$}function ot(e,t,r){if(r)return r;const n={fetch:st(t,e),...e};if(n.url){const e=B(n.url);n.baseUrl=e,n.queryString=function(e){const t=e.match(x);return t&&t[0]}(n.url),n.filename=Be(e),n.baseUrl=function(e){const t=e?e.lastIndexOf("/"):-1;return t>=0?e.substr(0,t):""}(e)}return Array.isArray(n.loaders)||(n.loaders=null),n}function it(e,t){if(e&&!Array.isArray(e))return e;let r;if(e&&(r=Array.isArray(e)?e:[e]),t&&t.loaders){const e=Array.isArray(t.loaders)?t.loaders:[t.loaders];r=r?[...r,...e]:e}return r&&r.length?r:void 0}async function at(e,t,r,n){!t||Array.isArray(t)||Ae(t)||(n=void 0,r=t,t=void 0),r=r||{};const s=L(e=await e),o=it(t,n),i=await Oe(e,o,r);return i?(n=ot({url:s,_parse:at,loaders:o},r=ge(r,i,o,s),n||null),await async function(e,t,r,n){if(function(e){(0,He.v)(e,"no worker provided");e.version}(e),r=Ge(e.options,r),g(t)){const e=t,{ok:r,redirected:s,status:o,statusText:i,type:a,url:c}=e,u=Object.fromEntries(e.headers.entries());n.response={headers:u,ok:r,redirected:s,status:o,statusText:i,type:a,url:c}}t=await async function(e,t,r){const n=e instanceof ArrayBuffer||ArrayBuffer.isView(e);if("string"==typeof e||n)return nt(e,t);if(m(e)&&(e=await k(e)),g(e)){const r=e;return await O(r),t.binary?await r.arrayBuffer():await r.text()}if(b(e)&&(e=tt(e,r)),h(e)||y(e))return Ye(e);throw new Error(rt)}(t,e,r);const s=e;if(s.parseTextSync&&"string"==typeof t)return s.parseTextSync(t,r,n);if(function(e,t){return!!Ue.A.isSupported()&&!(!We.Bd&&!t?._nodeWorkers)&&e.worker&&t?.worker}(e,r))return await Pe(e,t,r,n,at);if(s.parseText&&"string"==typeof t)return await s.parseText(t,r,n);if(s.parse)return await s.parse(t,r,n);throw(0,He.v)(!s.parseSync),new Error(`${e.id} loader - no parser found and worker is disabled`)}(i,e,r,n)):null}function ct(e,t,r,n){Array.isArray(t)||Ae(t)||(n=void 0,r=t,t=void 0),r=r||{};const s=it(t,n),o=$e(e,s,r);if(!o)return null;const i=()=>{throw new Error("parseSync called parse (which is async")};return function(e,t,r,n){if(t=nt(t,e),e.parseTextSync&&"string"==typeof t)return e.parseTextSync(t,r);if(e.parseSync&&t instanceof ArrayBuffer)return e.parseSync(t,r,n);throw new Error(`${e.name} loader: 'parseSync' not supported by this loader, use 'parse' instead. ${n.url||""}`)}(o,e,r=ge(r,o,s),n=ot({url:L(e),_parseSync:i,_parse:i,loaders:t},r,n||null))}var ut=r(21829);async function lt(e,t,r,n){const s=Array.isArray(t)?t:void 0;Array.isArray(t)||Ae(t)||(n=void 0,r=t,t=void 0),r=r||{};const o=L(e=await e),i=await Oe(e,t,r);return i?(n=ot({url:o,_parseInBatches:lt,_parse:at,loaders:s},r=ge(r,i,s,o),n||null),await async function(e,t,r,n){const s=await async function(e,t,r,n){const s=await async function(e,t){if(p(e))return e;if(g(e)){const r=e;return await O(r),tt(await r.body,t)}return m(e)||b(e)?tt(e,t):y(e)?e:function(e){if(ArrayBuffer.isView(e))return function*(){yield e.buffer}();if(e instanceof ArrayBuffer)return function*(){yield e}();if(p(e))return e;if(h(e))return e[Symbol.iterator]();throw new Error(rt)}(e)}(t,r),o=await async function(e,t=[]){let r=e;for await(const e of t)r=e(r);return r}(s,r?.transforms||[]);return e.parseInBatches?e.parseInBatches(o,r,n):async function*(e,t,r,n){const s=await Ye(e),o=function(e,t){const r=(0,ut.bI)(e)?(n=e,{...n,length:(0,ut.pg)(n),batchType:"data"}):{shape:"unknown",batchType:"data",data:e,length:Array.isArray(e)?e.length:1};var n;return r.mimeType=t.mimeTypes[0],r}(await at(s,t,{...r,mimeType:t.mimeTypes[0]},n),t);yield o}(o,e,r,n)}(e,t,r,n);if(!r.metadata)return s;const o={shape:"metadata",batchType:"metadata",metadata:{_loader:e,_context:n},data:[],bytesUsed:0};return async function*(e){yield o,yield*e}(s)}(i,e,r,n)):[]}async function ft(e,t,r,n){let s,o;Array.isArray(t)||Ae(t)?(s=t,o=r):(s=[],o=t);const i=st(o);let a=e;return"string"==typeof e&&(a=await i(e)),m(e)&&(a=await i(e)),Array.isArray(s),await at(a,s,o)}function dt(e,t,r,n){let s;Array.isArray(t)||Ae(t)?s=t:(r=t,s=void 0);const o=st(r||{});return Array.isArray(e)?e.map((e=>ht(e,s,r||{},o))):ht(e,s,r||{},o)}async function ht(e,t,r,n){if("string"==typeof e){const s=e,o=await n(s);return Array.isArray(t),await lt(o,t,r)}return Array.isArray(t),await lt(e,t,r)}async function yt(e,t,r){if(t.encode)return await t.encode(e,r);if(t.encodeText){const n=await t.encodeText(e,r);return(new TextEncoder).encode(n)}if(t.encodeInBatches){const n=gt(e,t,r),s=[];for await(const e of n)s.push(e);return Le(...s)}throw new Error("Writer could not encode data")}async function pt(e,t,r){if(t.text&&t.encodeText)return await t.encodeText(e,r);if(t.text){const n=await yt(e,t,r);return(new TextDecoder).decode(n)}throw new Error(`Writer ${t.name} could not encode data as text`)}function gt(e,t,r){if(t.encodeInBatches){const n=function(e){return[{...e,start:0,end:e.length}]}(e);return t.encodeInBatches(n,r)}throw new Error("Writer could not encode data in batches")}const mt=new Error("Not implemented");class wt{handle;size=0;bigsize=0n;url="";constructor(e,t,r){if(globalThis.loaders?.NodeFile)return new globalThis.loaders.NodeFile(e,t,r);if(ce)throw new Error("Can't instantiate NodeFile in browser.");throw new Error("Can't instantiate NodeFile. Make sure to import @loaders.gl/polyfills first.")}async read(e,t){throw mt}async write(e,t,r){throw mt}async stat(){throw mt}async truncate(e){throw mt}async append(e){throw mt}async close(){}}var bt=r(21146);async function Tt(e,t,r){return r={...ye(),...r},t.encodeURLtoURL?async function(e,t,r){if(ce)throw new Error(`Writer ${e.name} not supported in browser`);const n=xt("input"),s=new wt(n,"w");await s.write(t);const o=xt("output"),i=await Et(n,o,e,r);return(await $(i)).arrayBuffer()}(t,e,r):function(e,t){return!!Ue.A.isSupported()&&!(!ce&&!t?._nodeWorkers)&&e.worker&&t?.worker}(t,r)?await(0,bt.d)(t,e,r):await t.encode(e,r)}function _t(e,t,r){if(t.encodeSync)return t.encodeSync(e,r);if(t.encodeTextSync)return(new TextEncoder).encode(t.encodeTextSync(e,r));throw new Error(`Writer ${t.name} could not synchronously encode data`)}async function At(e,t,r){if(t.encodeText)return await t.encodeText(e,r);if(t.encodeTextSync)return t.encodeTextSync(e,r);if(t.text){const n=await t.encode(e,r);return(new TextDecoder).decode(n)}throw new Error(`Writer ${t.name} could not encode data as text`)}function vt(e,t,r){if(t.encodeTextSync)return t.encodeTextSync(e,r);if(t.text&&t.encodeSync){const n=_t(e,t,r);return(new TextDecoder).decode(n)}throw new Error(`Writer ${t.name} could not encode data as text`)}function St(e,t,r){if(t.encodeInBatches){const n=function(e){return[{...e,start:0,end:e.length}]}(e);return t.encodeInBatches(n,r)}throw new Error(`Writer ${t.name} could not encode in batches`)}async function Et(e,t,r,n){if(e=a(e),t=a(t),ce||!r.encodeURLtoURL)throw new Error;return await r.encodeURLtoURL(e,t,n)}function xt(e){return`/tmp/${e}`}var Bt=r(65606);function Lt(){let e;if("undefined"!=typeof window&&window.performance)e=window.performance.now();else if(void 0!==Bt&&Bt.hrtime){const t=Bt.hrtime();e=1e3*t[0]+t[1]/1e6}else e=Date.now();return e}class Rt{constructor(e,t){this.sampleSize=1,this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this.name=e,this.type=t,this.reset()}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=Lt(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(Lt()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class kt{constructor(e){this.stats={},this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e,t="count"){return this._getOrCreate({name:e,type:t})}get size(){return Object.keys(this.stats).length}reset(){for(const e of Object.values(this.stats))e.reset();return this}forEach(e){for(const t of Object.values(this.stats))e(t)}getTable(){const e={};return this.forEach((t=>{e[t.name]={time:t.time||0,count:t.count||0,average:t.getAverageTime()||0,hz:t.getHz()||0}})),e}_initializeStats(e=[]){e.forEach((e=>this._getOrCreate(e)))}_getOrCreate(e){const{name:t,type:r}=e;let n=this.stats[t];return n||(n=e instanceof Rt?e:new Rt(t,r),this.stats[t]=n),n}}const Ot={id:"request-scheduler",throttleRequests:!0,maxRequests:6,debounceTime:0};class $t{props;stats;activeRequestCount=0;requestQueue=[];requestMap=new Map;updateTimer=null;constructor(e={}){this.props={...Ot,...e},this.stats=new kt({id:this.props.id}),this.stats.get("Queued Requests"),this.stats.get("Active Requests"),this.stats.get("Cancelled Requests"),this.stats.get("Queued Requests Ever"),this.stats.get("Active Requests Ever")}scheduleRequest(e,t=()=>0){if(!this.props.throttleRequests)return Promise.resolve({done:()=>{}});if(this.requestMap.has(e))return this.requestMap.get(e);const r={handle:e,priority:0,getPriority:t},n=new Promise((e=>(r.resolve=e,r)));return this.requestQueue.push(r),this.requestMap.set(e,n),this._issueNewRequests(),n}_issueRequest(e){const{handle:t,resolve:r}=e;let n=!1;const s=()=>{n||(n=!0,this.requestMap.delete(t),this.activeRequestCount--,this._issueNewRequests())};return this.activeRequestCount++,r?r({done:s}):Promise.resolve({done:s})}_issueNewRequests(){null!==this.updateTimer&&clearTimeout(this.updateTimer),this.updateTimer=setTimeout((()=>this._issueNewRequestsAsync()),this.props.debounceTime)}_issueNewRequestsAsync(){null!==this.updateTimer&&clearTimeout(this.updateTimer),this.updateTimer=null;const e=Math.max(this.props.maxRequests-this.activeRequestCount,0);if(0!==e){this._updateAllRequests();for(let t=0;t<e;++t){const e=this.requestQueue.shift();e&&this._issueRequest(e)}}}_updateAllRequests(){const e=this.requestQueue;for(let t=0;t<e.length;++t){const r=e[t];this._updateRequest(r)||(e.splice(t,1),this.requestMap.delete(r.handle),t--)}e.sort(((e,t)=>e.priority-t.priority))}_updateRequest(e){return e.priority=e.getPriority(e.handle),!(e.priority<0&&(e.resolve(null),1))}}function It(e,t){if(globalThis.loaders.makeNodeStream)return globalThis.loaders.makeNodeStream(e,t);const r=e[Symbol.asyncIterator]?e[Symbol.asyncIterator]():e[Symbol.iterator]();return new ReadableStream({type:"bytes",async pull(e){try{const{done:t,value:n}=await r.next();t?e.close():e.enqueue(new Uint8Array(n))}catch(t){e.error(t)}},async cancel(){await(r?.return?.())}},{highWaterMark:2**24,...t})}const jt="4.2.1",Ct={dataType:null,batchType:null,name:"Null loader",id:"null",module:"core",version:jt,worker:!0,mimeTypes:["application/x.empty"],extensions:["null"],tests:[()=>!1],options:{null:{}}},Nt={dataType:null,batchType:null,name:"Null loader",id:"null",module:"core",version:jt,mimeTypes:["application/x.empty"],extensions:["null"],parse:async(e,t,r)=>null,parseSync:function(e,t,r){return null},parseInBatches:async function*(e,t,r){for await(const t of e)yield null},tests:[()=>!1],options:{null:{}}};const qt={dataType:null,batchType:null,name:"JSON",id:"json",module:"json",version:"4.2.1",extensions:["json","geojson"],mimeTypes:["application/json"],category:"json",text:!0,parseTextSync:Ft,parse:async e=>Ft((new TextDecoder).decode(e)),options:{}};function Ft(e){return JSON.parse(e)}async function zt(e,t,r=()=>{},n=()=>{}){if(!(e=await e).ok)return e;const s=e.body;if(!s)return e;const o=e.headers.get("content-length")||0,i=o?parseInt(o):0;if(!(i>0))return e;if("undefined"==typeof ReadableStream||!s.getReader)return e;const a=new ReadableStream({async start(e){const o=s.getReader();await Wt(e,o,0,i,t,r,n)}});return new Response(a)}async function Wt(e,t,r,n,s,o,i){try{const{done:a,value:c}=await t.read();if(a)return o(),void e.close();r+=c.byteLength,s(Math.round(r/n*100),{loadedBytes:r,totalBytes:n}),e.enqueue(c),await Wt(e,t,r,n,s,o,i)}catch(t){e.error(t),i(t)}}class Ut{handle;size;bigsize;url;constructor(e){this.handle=e instanceof ArrayBuffer?new Blob([e]):e,this.size=e instanceof ArrayBuffer?e.byteLength:e.size,this.bigsize=BigInt(this.size),this.url=e instanceof File?e.name:""}async close(){}async stat(){return{size:this.handle.size,bigsize:BigInt(this.handle.size),isDirectory:!1}}async read(e,t){return await this.handle.slice(e,e+t).arrayBuffer()}}class Mt{_fetch;files={};lowerCaseFiles={};usedFiles={};constructor(e,t){this._fetch=t?.fetch||fetch;for(let t=0;t<e.length;++t){const r=e[t];this.files[r.name]=r,this.lowerCaseFiles[r.name.toLowerCase()]=r,this.usedFiles[r.name]=!1}this.fetch=this.fetch.bind(this)}async fetch(e,t){if(e.includes("://"))return this._fetch(e,t);const r=this.files[e];if(!r)return new Response(e,{status:400,statusText:"NOT FOUND"});const n=new Headers(t?.headers).get("Range"),s=n&&/bytes=($1)-($2)/.exec(n);if(s){const t=parseInt(s[1]),n=parseInt(s[2]),o=await r.slice(t,n).arrayBuffer(),i=new Response(o);return Object.defineProperty(i,"url",{value:e}),i}const o=new Response(r);return Object.defineProperty(o,"url",{value:e}),o}async readdir(e){const t=[];for(const e in this.files)t.push(e);return t}async stat(e,t){const r=this.files[e];if(!r)throw new Error(e);return{size:r.size}}async unlink(e){delete this.files[e],delete this.lowerCaseFiles[e],this.usedFiles[e]=!0}async openReadableFile(e,t){return new Ut(this.files[e])}_getFile(e,t){const r=this.files[e]||this.lowerCaseFiles[e];return r&&t&&(this.usedFiles[e]=!0),r}}async function*Pt(e,t={}){const r=new TextDecoder(void 0,t);for await(const t of e)yield"string"==typeof t?t:r.decode(t,{stream:!0})}async function*Dt(e){const t=new TextEncoder;for await(const r of e)yield"string"==typeof r?t.encode(r):r}async function*Ht(e){let t="";for await(const r of e){let e;for(t+=r;(e=t.indexOf("\n"))>=0;){const r=t.slice(0,e+1);t=t.slice(e+1),yield r}}t.length>0&&(yield t)}async function*Gt(e){let t=1;for await(const r of e)yield{counter:t,line:r},t++}},21829:(e,t,r)=>{function n(e){switch("object"==typeof e&&e?.shape){case"array-row-table":case"object-row-table":return Array.isArray(e.data);case"geojson-table":return Array.isArray(e.features);case"columnar-table":return e.data&&"object"==typeof e.data;case"arrow-table":return Boolean(void 0!==e?.data?.numRows);default:return!1}}function s(e){switch(e.shape){case"array-row-table":case"object-row-table":return e.data.length;case"geojson-table":return e.features.length;case"arrow-table":return e.data.numRows;case"columnar-table":for(const t of Object.values(e.data))return t.length||0;return 0;default:throw new Error("table")}}function o(e){if(e.schema)return e.schema.fields.length;if(0===s(e))throw new Error("empty table");switch(e.shape){case"array-row-table":return e.data[0].length;case"object-row-table":return Object.keys(e.data[0]).length;case"geojson-table":return Object.keys(e.features[0]).length;case"columnar-table":return Object.keys(e.data).length;case"arrow-table":return e.data.numCols;default:throw new Error("table")}}function i(e,t,r){switch(e.shape){case"array-row-table":const n=function(e,t){const r=e.schema?.fields.findIndex((e=>e.name===t));if(void 0===r)throw new Error(t);return r}(e,r);return e.data[t][n];case"object-row-table":return e.data[t][r];case"geojson-table":return e.features[t][r];case"columnar-table":return e.data[r][t];case"arrow-table":const s=e.data,o=s.schema.fields.findIndex((e=>e.name===r));return s.getChildAt(o)?.get(t);default:throw new Error("todo")}}function a(e,t,r,n){switch(e.shape){case"object-row-table":return n?Object.fromEntries(Object.entries(e.data[t])):e.data[t];case"array-row-table":if(e.schema){const n=r||{};for(let r=0;r<e.schema.fields.length;r++)n[e.schema.fields[r].name]=e.data[t][r];return n}throw new Error("no schema");case"geojson-table":if(e.schema){const n=r||{};for(let r=0;r<e.schema.fields.length;r++)n[e.schema.fields[r].name]=e.features[t][r];return n}throw new Error("no schema");case"columnar-table":if(e.schema){const n=r||{};for(let r=0;r<e.schema.fields.length;r++)n[e.schema.fields[r].name]=e.data[e.schema.fields[r].name][t];return n}{const n=r||{};for(const[r,s]of Object.entries(e.data))n[r]=s[t];return n}case"arrow-table":const s=e.data,o=r||{},i=s.get(t),a=s.schema;for(let e=0;e<a.fields.length;e++)o[a.fields[e].name]=i?.[a.fields[e].name];return o;default:throw new Error("shape")}}function c(e,t,r,n){switch(e.shape){case"array-row-table":return n?Array.from(e.data[t]):e.data[t];case"object-row-table":if(e.schema){const n=r||[];for(let r=0;r<e.schema.fields.length;r++)n[r]=e.data[t][e.schema.fields[r].name];return n}return Object.values(e.data[t]);case"geojson-table":if(e.schema){const n=r||[];for(let r=0;r<e.schema.fields.length;r++)n[r]=e.features[t][e.schema.fields[r].name];return n}return Object.values(e.features[t]);case"columnar-table":if(e.schema){const n=r||[];for(let r=0;r<e.schema.fields.length;r++)n[r]=e.data[e.schema.fields[r].name][t];return n}{const n=r||[];let s=0;for(const r of Object.values(e.data))n[s]=r[t],s++;return n}case"arrow-table":const s=e.data,o=r||[],i=s.get(t),a=s.schema;for(let e=0;e<a.fields.length;e++)o[e]=i?.[a.fields[e].name];return o;default:throw new Error("shape")}}function*u(e,t){switch(t){case"array-row-table":yield*l(e);break;case"object-row-table":yield*function*(e,t={}){const r=s(e);for(let n=0;n<r;n++)yield a(e,n,t)}(e);break;default:throw new Error(`Unknown row type ${t}`)}}function*l(e,t=[]){const r=s(e);for(let n=0;n<r;n++)yield c(e,n,t)}r.d(t,{a5:()=>l,bI:()=>n,fD:()=>i,gt:()=>a,pg:()=>s,q0:()=>c,r2:()=>u,wH:()=>o})}}]);